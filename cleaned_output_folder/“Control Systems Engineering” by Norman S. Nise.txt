CONTROL SYSTEMS ENGINEERING Seventh EditionNorman S. Nise NiseCONTROL SYSTEMS ENGINEERINGSeventh EditionNOW WITH HARDWARE INTERFACE LABORATORY EXPERIMENTS USING NATIONAL INSTRUMENTS‚Ñ¢ myDAQ Close the loop between the lectures and lab. Integrated throughout the Nise text are 10 virtual experiments, which enable students to implement the design-simulate-prototype workflow of practicing engineers. Powered by LabVIEW‚Ñ¢ software and simulations of Quanser lab plants, the virtual labs enable students to apply concepts to virtual systems, implement control solutions and evaluate results. The virtual labs deepen the homework learning experience and prepare students to make more effective use of their time in the lab. IN ADDITION ¬∑ 20% new end-of-chapter problems that highlight biomedical, robotics, or other engineering applications, including a new progressive analysis and design problem‚Äîa solar energy parabolic trough collector. ¬∑ Greater emphasis on computer-aided analysis and design, including MA TLAB¬Æ, LabVIEW‚Ñ¢, and Simulink¬Æ. MATLAB¬Æ and Simulink¬Æ have has been updated to R2014a and a new section has been added: Using Simulink¬Æ for control system design. LabVIEW‚Ñ¢ has been updated to LabVIEW‚Ñ¢ 2013. ¬∑ Hardware Interface Laboratory experiments have been added to certain chapters. These experiments use National Instruments‚Ñ¢ m yDAQ to interface your computer with actual hardware to test control system principles in the real-world. An included tutorial on the use of myDAQ gives the students the background they need to do the experiments. 9 781118 17051990000ISBN 978-1-118-17051-9Cover Design: Wendy Lai Cover Image: Spencer Platt/Getty Images www.wiley.com/college/nise Nise_Control7e.indd 1 10/21/14 10:05 AMWEBFFIRS 10/29/2014 0:50:34 Page 2WEBFIFC 10/29/2014 0:32:32 Antenna Azimuth Position Control System Layout Motori(t) Desired azimuth angle input Differential amplifier and power amplifier Potentiometero(t)Potentiometer Azimuth angle outputAntenna Œ∏Œ∏ Schematic JL kg-m2Ja kg-m2 Da N-m s/rad Kb V-s/rad Kt N-m/A n-turn potentiometerDL N-m-s/radvi(t) vo(t) KK1 s + a+ ‚Äìvp(t) ea(t) Œ∏m(t)Œ∏i(t) Œ∏o(t)RaMotorFixed field‚ÄìV+V Power amplifierDifferential preamplifiern-turn potentiometer Armature +V‚ÄìVN1 Gear N2 Gear N3 GearWEBFFEP 10/29/2014 0:36:16 Block Diagram Potentiometer PreamplifierPower amplifierMotor and load GearsDesired azimuth angleAzimuth angle Œ∏i(s) Œ∏o(s) s + aK1K Kgs(s+am)K1 Potentiometer Kpot+ ‚ÄìŒ∏m(s) Ea(s) Ve(s) Vi(s) Vp(s) Kpot Schematic Parameters Parameter ConÔ¨Å guration 1 ConÔ¨Å guration 2 ConÔ¨Å guration 3 V 10 10 10 n 10 1 1 K ‚Äî‚Äî‚Äî K1 100 150 100 a 100 150 100 Ra 855 Ja 0.02 0.05 0.05 Da 0.01 0.01 0.01 Kb 0.5 1 1 Kt 0.5 1 1 N1 25 50 50 N2 250 250 250 N3 250 250 250 JL 155 DL 133 Block Diagram Parameters Parameter ConÔ¨Å guration 1 ConÔ¨Å guration 2 ConÔ¨Å guration 3 Kpot 0.318 K ‚Äî K1 100 a 100 Km 2.083 am 1.71 Kg 0.1 Note: reader may Ô¨Åll in Con Ô¨Åguration 2 and Con Ô¨Åguration 3 columns after completing the antenna control Case Study challenge problems in Chapters 2 and 10, respectively.WEBFFIRS 10/29/2014 0:50:33 WEBFFIRS 10/29/2014 0:50:34 Page 2WEBFFIRS 10/29/2014 0:50:34 CONTROL SYSTEMS ENGINEERING Seventh Edition Norman S. Nise California State Polytechnic University, PomonaWEBFFIRS 10/29/2014 0:50:34 To my wife, Ellen; sons, Benjamin and Alan; and daughter, Sharon, and their families. Vice President & Executive Publisher Don Fowley Executive Editor Dan Sayre Editorial Assistant Francesca Baratta Content Manager Ellinor Wagner Executive Marketing Manager Christopher Ruel Design Director Harry Nolan Senior Designer Wendy Lai Photo Editor Elizabeth Blomster Senior Product Designer Jenny Welter Associate Editor Wendy Ashenberg Cover Photo Credit Spencer Platt/Getty Images This book was set in 10/12 pt Lato Black by Thomson Digital and printed and bound by Courier Kendallville. The cover was printed by Courier Kendallville. The new Honda robot ASIMO walks up stairs during a North American educational tour designed to introduce the public to ASIMO and to encourage students to study robotics science. ASIMO (Advanced Step in Innovative Mobility) is a product of over 15 years of robotic development at Honda and was created for the purpose of helping people in need. (Photo by Spencer Platt/Getty Images). This book has not been approved, licensed, or sponsored by Honda. Copyright ÓÄÇ2015, 2011, 2008, 2004, 2000, 1999 John Wiley & Sons, Inc. All rights reserved. No part of this publication may be reproduced, stored in a retrieval system or transmitted in any form or by any means, electronic, mechanical, photocopying, recording, scanning or otherwise, except as permitted under Sections 107 or 108 of the 1976 United States Copyright Act, without either the prior written permission of the Publisher, or authorization through payment of the appropriate per-copy fee to the Copyright Clearance Center, Inc. 222 Rosewood Drive,Danvers, MA 01923, website www.copyright.com . Requests to the Publisher for permission should be addressed to the Permissions Department, John Wiley & Sons, Inc., 111 River Street, Hoboken, NJ 07030-5774, (201)748-6011,fax (201)748-6008, website http://www.wiley.com/go/permissions . Founded in 1807, John Wiley & Sons, Inc. has been a valued source of knowledge and understanding for more than 200 years, helping people around the world meet their needs and ful Ô¨Åll their aspirations. Our company is built on a foundation of principles that include responsibility to the communities we serve and where we live and work. In 2008, we launched aCorporate Citizenship Initiative, a global effort to address the environmental, social, economic, and ethical challenges we face in our business. Among the issues we are addressing are carbon impact, paper speci Ô¨Åcations and procurement, ethical conduct within our business and among our vendors, and community and charitable support. For more information, please visit our website: www.wiley.com/go/citizenship . The software programs and experiments available with this book have been included for their instructional value. Theyhave been tested with care but are not guaranteed for any particular purpose. The publisher and author do not offer any warranties or restrictions, nor do they accept any liabilities with respect to the programs and experiments. AMTRAK is a registered trademark of National Railroad Passenger Corporation. Adobe andAcrobat are trademarks of Adobe Systems, Inc. which may be registered in some jurisdictions. FANUC is a registered trademark of FANUC, Ltd.Microsoft, Visual Basic, andPowerPoint are registered trademarks of Microsoft Corporation. QuickBasic is a trademark of Microsoft Corporation. MATLAB andSIMULINK are registered trademarks of The MathWorks, Inc. The Control System Toolbox, LTI Viewer, Root Locus Design GUI, Symbolic Math Toolbox, Simulink Control Design, andMathWorks are trademarks of The MathWorks, Inc. LabVIEW is a registered trademark of National Instruments Corporation. Segway is a registered trademark of Segway, Inc. in the United States and/or other countries. Chevrolet Volt is a trademark of General Motors LLC. Virtual plant simulations pictured and referred to herein are trademarks or registered trademarks of Quanser Inc. and/or its af Ô¨Åliates.ÓÄÇ2010 Quanser Inc. All rights reserved. Quanser virtual plant simulations pictured and referred to herein may be subject to change without notice. ASIMO is a registered trademark of Honda. Evaluation copies are provided to quali Ô¨Åed academics and professionals for review purposes only, for use in their courses during the next academic year. These copies are licensed and may not be sold or transferred to a third party. Upon completion of the review period, please return the evaluation copy to Wiley. Return instructions and a free of charge return shipping label are available at www.wiley.com/go/returnlabel . Outside of the United States, please contact your local representative. Library of Congress Cataloging-in-Publication Data Nise, Norman S. Control systems engineering / Norman S. Nise, California State Polytechnic University, Pomona. ‚ÄîSeventh edition. 1 online resource. Includes bibliographical references and index. Description based on print version record and CIP data provided by publisher; resource not viewed. ISBN 978-1-118-80082-9 (pdf) ‚ÄîISBN 978-1-118-17051-9 (cloth : alk. paper) Automatic control ‚ÄìTextbooks. 2. Systems engineering ‚ÄìTextbooks. I. Title. TJ213629.8‚Äìdc23 2014037468 Printed in the United States of America 1 0987654321WEBFTOC 10/29/2014 0:28:41 Contents PREFACE, ix INTRODUCTION, 1 1.1 Introduction, 2 1.2 A History of Control Systems, 4 1.3 System Con Ô¨Ågurations, 6 1.4 Analysis and Design Objectives, 9 Case Study, 11 1.5 The Design Process, 14 1.6 Computer-Aided Design, 19 1.7 The Control Systems Engineer, 20 Summary, 21Review Questions, 22Problems, 22 Cyber Exploration Laboratory, 29 Bibliography, 30 MODELING IN THE FREQUENCY DOMAIN, 33 2.1 Introduction, 342.2 Laplace Transform Review, 35 2.3 The Transfer Function, 44 2.4 Electrical Network Transfer Functions, 472.5 Translational Mechanical System Transfer Functions, 61 2.6 Rotational Mechanical System Transfer Functions, 69 2.7 Transfer Functions for Systems with Gears, 732.8 Electromechanical System Transfer Functions, 77 2.9 Electric Circuit Analogs, 83 2.10 Nonlinearities, 86 2.11 Linearization, 87 Case Studies, 92Summary, 95 Review Questions, 95Problems, 96 Cyber Exploration Laboratory, 107 Hardware Interface Laboratory, 110 Bibliography, 112 MODELING IN THE TIME DOMAIN, 115 3.1 Introduction, 1163.2 Some Observations, 1163.3 The General State-Space Representation, 120 3.4 Applying the State-Space Representation, 122 3.5 Converting a Transfer Function to State Space, 130 3.6 Converting from State Space to a Transfer Function, 136 3.7 Linearization, 138 Case Studies, 141Summary, 145 Review Questions, 146 Problems, 146 Cyber Exploration Laboratory, 153 Bibliography, 155 TIME RESPONSE, 157 4.1 Introduction, 158 4.2 Poles, Zeros, and System Response, 158 4.3 First-Order Systems, 162 4.4 Second-Order Systems: Introduction, 164 4.5 The General Second-Order System, 1694.6 Underdamped Second-Order Systems, 173 4.7 System Response with Additional Poles, 182 4.8 System Response with Zeros, 1864.9 Effects of Nonlinearities upon Time Response, 192 vWEBFTOC 10/29/2014 0:28:41 4.10 Laplace Transform Solution of State Equations, 194 4.11 Time Domain Solution of State Equations, 198 Case Studies, 202 Summary, 208Review Questions, 209 Problems, 210 Cyber Exploration Laboratory, 223 Hardware Interface Laboratory, 226 Bibliography, 231 REDUCTION OF MULTIPLE SUBSYSTEMS, 235 5.1 Introduction, 236 5.2 Block Diagrams, 236 5.3 Analysis and Design of Feedback Systems, 245 5.4 Signal-Flow Graphs, 2485.5 Mason ‚Äôs Rule, 251 5.6 Signal-Flow Graphs of State Equations, 254 5.7 Alternative Representations in State Space, 256 5.8 Similarity Transformations, 265 Case Studies, 272Summary, 278 Review Questions, 278 Problems, 279 Cyber Exploration Laboratory, 295 Bibliography, 296 STABILITY, 299 6.1 Introduction, 300 6.2 Routh-Hurwitz Criterion, 303 6.3 Routh-Hurwitz Criterion: Special Cases, 305 6.4 Routh-Hurwitz Criterion: Additional Examples, 311 6.5 Stability in State Space, 318 Case Studies, 321 Summary, 323Review Questions, 323 Problems, 324 Cyber Exploration Laboratory, 332 Bibliography, 3337. STEADY-STATE ERRORS, 335 7.1 Introduction, 336 7.2 Steady-State Error for Unity Feedback Systems, 339 7.3 Static Error Constants and System Type, 3457.4 Steady-State Error Speci Ô¨Åcations, 348 7.5 Steady-State Error for Disturbances, 3517.6 Steady-State Error for Nonunity Feedback Systems, 353 7.7 Sensitivity, 3567.8 Steady-State Error for Systems in State Space, 359Case Studies, 362 Summary, 365 Review Questions, 366 Problems, 367 Cyber Exploration Laboratory, 377 Bibliography, 379 ROOT LOCUS TECHNIQUES, 381 8.1 Introduction, 382 8.2 De Ô¨Åning the Root Locus, 386 8.3 Properties of the Root Locus, 3888.4 Sketching the Root Locus, 390 8.5 Re Ô¨Åning the Sketch, 395 8.6 An Example, 404 8.7 Transient Response Design via Gain Adjustment, 407 8.8 Generalized Root Locus, 4118.9 Root Locus for Positive-Feedback Systems, 413 8.10 Pole Sensitivity, 415 Case Studies, 417 Summary, 422 Review Questions, 423Problems, 423 Cyber Exploration Laboratory, 439 Hardware Interface Laboratory, 441 Bibliography, 447 DESIGN VIA ROOT LOCUS, 449 9.1 Introduction, 450 9.2 Improving Steady-State Error via Cascade Compensation, 453vi ContentsWEBFTOC 10/29/2014 0:28:41 9.3 Improving Transient Response via Cascade Compensation, 462 9.4 Improving Steady-State Error and Transient Response, 474 9.5 Feedback Compensation, 487 9.6 Physical Realization of Compensation, 495 Case Studies, 500 Summary, 504 Review Questions, 505 Problems, 506 Cyber Exploration Laboratory, 519Hardware Interface Laboratory, 520 Bibliography, 523 FREQUENCY RESPONSE TECHNIQUES, 525 10.1 Introduction, 526 10.2 Asymptotic Approximations: Bode Plots, 531 10.3 Introduction to the Nyquist Criterion, 55010.4 Sketching the Nyquist Diagram, 555 10.5 Stability via the Nyquist Diagram, 560 10.6 Gain Margin and Phase Margin via the Nyquist Diagram, 564 10.7 Stability, Gain Margin, and Phase Margin via Bode Plots, 566 10.8 Relation Between Closed-Loop Transient and Closed-Loop Frequency Responses, 570 10.9 Relation Between Closed- and Open-Loop Frequency Responses, 573 10.10 Relation Between Closed-Loop Transient and Open-Loop Frequency Responses, 578 10.11 Steady-State Error Characteristics from Frequency Response, 582 10.12 Systems with Time Delay, 586 10.13 Obtaining Transfer Functions Experimentally, 591 Case Study, 595 Summary, 596 Review Questions, 597Problems, 598 Cyber Exploration Laboratory, 609 Bibliography, 610 DESIGN VIA FREQUENCY RESPONSE, 613 11.1 Introduction, 61411.2 Transient Response via Gain Adjustment, 615 11.3 Lag Compensation, 61811.4 Lead Compensation, 623 11.5 Lag-Lead Compensation, 629 Case Studies, 638Summary, 640 Review Questions, 640Problems, 641 Cyber Exploration Laboratory, 646 Bibliography, 647 DESIGN VIA STATE SPACE, 649 12.1 Introduction, 650 12.2 Controller Design, 651 12.3 Controllability, 658 12.4 Alternative Approaches to Controller Design, 661 12.5 Observer Design, 667 12.6 Observability, 674 12.7 Alternative Approaches to Observer Design, 677 12.8 Steady-State Error Design via Integral Control, 684 Case Study, 688Summary, 693 Review Questions, 694 Problems, 695 Cyber Exploration Laboratory, 703 Bibliography, 704 DIGITAL CONTROL SYSTEMS, 707 13.1 Introduction, 70813.2 Modeling the Digital Computer, 711 13.3 The z-Transform, 714 13.4 Transfer Functions, 71913.5 Block Diagram Reduction, 723 13.6 Stability, 72613.7 Steady-State Errors, 733 13.8 Transient Response on the z-Plane, 737 13.9 Gain Design on the z-Plane, 739 13.10 Cascade Compensation via the s-Plane, 742 13.11 Implementing the Digital Compensator, 746Contents viiWEBFTOC 10/29/2014 0:28:41 Case Studies, 749 Summary, 753 Review Questions, 754 Problems, 755 Cyber Exploration Laboratory, 762Bibliography, 764 APPENDIX A List of Symbols, 767 APPENDIX B MATLAB Tutorial, 771 B.1 Introduction, 771B.2 MATLAB Examples, 772B.3 Command Summary, 814 Bibliography, 817 APPENDIX C Simulink Tutorial, 819C.1 Introduction, 819C.2 Using Simulink, 819 C.3 Examples, 824 C.4 Using Simulink for Control System Design, 836Summary, 846Bibliography, 846 APPENDIX D LabVIEW Tutorial, 849D.1 Introduction, 849D.2 Control Systems Analysis, Design, and Simulation, 850 D.3 Using LabVIEW, 851D.4 Analysis and Design Examples, 853D.5 Simulation Examples, 865D.6 Interfacing with External Hardware, 875Summary, 879Bibliography, 879 Online location is www.wiley.com/college/niseGLOSSARY, 881 ANSWERS TO SELECTED PROBLEMS, 889 INDEX, 895 APPENDIX E MATLAB ‚Äôs GUI Tools Tutorial (Online) APPENDIX F MATLAB ‚Äôs Symbolic Math Toolbox Tutorial (Online) APPENDIX G Matrices, Determinants, and Systems of Equations (Online) APPENDIX H Control System Computational Aids (Online) APPENDIX I Derivation of a Schematic for a DC Motor (Online) APPENDIX J Derivation of the Time Domain Solution of State Equations (Online) APPENDIX K Solution of State Equations for t06¬à0 (Online) APPENDIX L Derivation of Similarity Transformations (Online) APPENDIX M Root Locus Rules: Derivations (Online) Control Systems Engineering Toolbox (Online) Cyber Exploration Laboratory Experiments Cover Sheets (Online) Hardware Interface Laboratory Experiments Cover Sheets (Online) Lecture Graphics (Online)Solutions to Skill-Assessment Exercises (Online)viii ContentsWEBFPREF 10/29/2014 0:22:8 Preface This book introduces students to the theory and practice of control systems engineering. The text emphasizes the practical application of the subject to the analysis and design offeedback systems. The study of control systems engineering is essential for students pursuing degrees in electrical, mechanical, aerospace, biomedical, or chemical engineering. Control systems arefound in a broad range of applications within these disciplines, from aircraft and spacecraftto robots and process control systems. Control Systems Engineering is suitable for upper-division college and university engineering students and for those who wish to master the subject matter through self-study.The student using this text should have completed typical lower-division courses inphysics and mathematics through differential equations. Other required background material, including Laplace transforms and linear algebra, is incorporated in the text, either within chapter discussions or separately in the appendixes or on the book's CompanionWeb site. This review material can be omitted without loss of continuity if the student does notrequire it. Key Features The key features of this seventh edition are: Standardized chapter organization Qualitative and quantitative explanations Examples, Skill-Assessment Exercises, andCase Studies throughout the text Cyber Exploration Laboratory, Hardware Interface Laboratory, and VirtualExperiments Abundant illustrations Numerous end-of-chapter problems Emphasis on design Flexible coverage Emphasis on computer-aided analysis and design including MATLAB ÓÄÑ1and LabVIEWÓÄÑ2 Icons identifying major topics Let us look at each feature in more detail. 1MATLAB is a registered trademark of The MathWorks, Inc. 2LabVIEW is a registered trademark of National Instruments Corporation. ixWEBFPREF 10/29/2014 0:22:8 Standardized Chapter Organization Each chapter begins with a list of chapter learning outcomes, followed by a list of case study learning outcomes that relate to speci Ô¨Åc student performance in solving a practical case study problem, such as an antenna azimuth position control system. Topics are then divided into clearly numbered and labeled sections containing explanations, examples, and, where appropriate, skill-assessment exercises with answers. These numbered sections are followed by one or more case studies, as will be outlined in afew paragraphs. Each chapter ends with a brief summary, several review questions requiringshort answers, a set of homework problems, and experiments. Qualitative and Quantitative Explanations Explanations are clear and complete and, where appropriate, include a brief review of requiredbackground material. Topics build upon and support one another in a logical fashion.Groundwork for new concepts and terminology is carefully laid to avoid overwhelmingthe student and to facilitate self-study. Although quantitative solutions are obviously important, a qua litative or intuitive understanding of problems and methods of solution is vital to producing the insight required to develop sound designs. Therefore, whenever possible, new concepts are discussed from a qualitative perspective before quantitative analysis and design areaddressed. For example, in Chapter 8 the student can simply look at the root locus anddescribe qualitatively the changes in transient response that will occur as a systemparameter, such as gain, is varied. This ability is developed with the help of a few simpleequations from Chapter 4. Examples, Skill-Assessment Exercises, and Case Studies Explanations are clearly illustrated by means of numerous numbered and labeled Examples throughout the text. Where appropriate, sections conclude with Skill-Assessment Exercises . These are computation drills, most with answers that test comprehension and provideimmediate feedback. Complete solutions can be found at www.wiley.com/college/nise . Broader examples in the form of Case Studies can be found after the last numbered section of every chapter, with the exception of Chapter 1. These case studies are practicalapplication problems that demonstrate the concepts introduced in the chapter. Each case study concludes with a ‚ÄúChallenge ‚Äùproblem that students may work in order to test their understanding of the material. One of the case studies, an antenna azimut h position control system, is carried throughout the book. The purpose is to illust rate the application of new material in each chapter to the same physical system, thus highlighting the continuity of the design process. Another, more challenging case study, involving an Unmannered Free-SwimmingSubmersible Vehicle, is developed over the course of Ô¨Åve chapters. Cyber Exploration Laboratory, Hardware Interface Laboratory, and Virtual Experiments Computer experiments using MATLAB, SimulinkÓÄÑ3and the Control System Toolbox are found at the end of the Problems sections under the sub-heading Cyber Exploration Laboratory . The experiments allow the reader to verify the concepts covered in the chapter via simulation. The reader also can change parameters and perform ‚Äúwhat if ‚Äùexploration to gain insight into the effect of parameter and con Ô¨Åguration changes. The experiments are written with stated Objectives, Minimum Required Software Packages, as well as Prelab, Lab, and Postlab tasks and questions. Thus, the experiments may be used for a laboratory course that accompanies the class. Cover sheets for these experiments are available atwww.wiley.com.college/nise . 3Simulink is a registered trademark of The MathWorks, Inc.x PrefaceWEBFPREF 10/29/2014 0:22:8 Subsequent to the Cyber Exploration Laboratory experiments, and new to this seventh edition, are Hardware Interface Laboratory experiments in some chapters. These experiments use National Instruments ‚ÄômyDAQ to interface your computer to actual hardware to test control system principles in the real world. Finally, in this seventh edition are Virtual Experiments. These experiments are more tightly focused than the Cyber Exploration Laboratory experiments as they let students interactwith virtual models of actual teaching lab equipment produced by Quanser. These experimentswill help students gain a more intuitive understanding of the physical implications of importantcontrol concepts. The experiments are referenced in sidebars throughout some chapters. Abundant Illustrations The ability to visualize concepts and processes is critical to the student's understanding. For this reason, approximately 800 photos, diagrams, graphs, and tables appear throughout the book to illustrate the topics under discussion. Numerous End-of-Chapter Problems Each chapter ends with a variety of homework problems that allow students to test theirunderstanding of the material presented in the chapter. Problems vary in degree of dif Ô¨Åculty and complexity, and most chapters include several practical, real-life problems to help maintainstudents ‚Äômotivation. Also, the homework problems contain progressive analysis and design problems that use the same practical systems to demonstrate the concepts of each chapter. Emphasis on Design This textbook places a heavy emphasis on design. Chapters 8, 9, 11, 12, and 13 focusprimarily on design. But. even in chapters that emphasize analysis, simple design examplesare included wherever possible. Throughout the book, design examples involving physical systems are identi Ô¨Åed by the icon shown in the margin. End-of-chapter problems that involve the design ofphysical systems are included under the separate heading Design Problems .D e s i g n Problems also can be found in chapters covering design, under the heading Progressive Analysis and Design Problems . In these examples and problems, a desired response is speci Ô¨Åed, and the student must evaluate certa in system parameters, such as gain, or specify a system con Ô¨Åguration along with parameter values. In addition, the text includes numerous design examples and problems (not identi Ô¨Åed by an icon) that involve purely mathematical systems. Because visualization is so vital to understanding design, this text carefully relates indirect design speci Ô¨Åcations to more familiar ones. For example, the less familiar and indirect phase margin is carefully related to the more direct and familiar percent overshootbefore being used as a design speci Ô¨Åcation. For each general type of design problem introduced in the text, a methodology for solving the problem is presented ‚Äîin many cases in the form of a step-by-step procedure, beginning with a statement of design objectives. Example problems serve to demonstrate themethodology by following the procedure, making simplifying assumptions, and presenting the results of the design in tables or plots that compare the performance of the original system to that of the improved system. This comparison also serves as a check on the simplifyingassumptions. Transient response design topics are covered comprehensively in the text. They include: Design via gain adjustment using the root locus Design of compensation and controllers via the root locus Design via gain adjustment using sinusoidal frequency response methods Design of compensation via sinusoidal frequency response methods Design of controllers in state space using pole-placement techniquesPreface xiWEBFPREF 10/29/2014 0:22:8 Design of observers in state-space using pole-placement techniques Design of digital control systems via gain adjustment on the root locus Design of digital control system compensation via s-plane design and the Tustin transformation Steady-state error design is covered comprehensively in this textbook and includes: Gain adjustment Design of compensation via the root locus Design of compensation via sinusoidal frequency response methods Design of integral control in state space Finally, the design of gain to yield stability is covered from the following perspectives: Routh-Hurwitz criterion Root locus Nyquist criterion Bode plots Flexible Coverage The material in this book can be adapted for a one-quarter or a one-semester course. The organization is Ô¨Çexible, allowing the instructor to select the material that best suits the requirements and time constraints of the class. Throughout the book, state-space methods are presented along with the classical approach. Chapters and sections (as well as examples, exercises, review questions, and problems) that cover state space are marked by the icon shown in the margin and can beomitted without any loss of continuity. Those wishing to add a basic introduction to state-spacemodeling can include Chapter 3 in the syllabus. In a one-semester course, the discussions of state-space analysis in Chapters 4, 5, 6 and 7, as well as state-space design in Chapter 12, can be covered along with the classical approach.Another option is to teach state space separately by gathering the appropriate chapters andsections marked with the State Space icon into a single unit that follows the classical approach. In a one-quarter course, Chapter 13, Digital Control Systems, could be eliminated. Emphasis on Computer-Aided Analysis and Design Control systems problems, particularly analysis and design problems using the root locus,can be tedious, since their solution involves trial and error. To solve these problems,students should be given access to computers or programmable calculators con Ô¨Ågured with appropriate software. In this seventh edition, MATLAB and LabVIEW continue to beintegrated into the text as an optional feature. Many problems in this text can be solved with either a computer or a hand-held programmable calculator. For example, students can use the programmable calculator to(1) determine whether a point on the s-plane is also on the root locus, (2) Ô¨Ånd magnitude and phase frequency response data for Nyquist and Bode diagrams, and (3) convert between thefollowing representations of a second-order system: Pole location in polar coordinates Pole location in Cartesian coordinates Characteristic polynomial Natural frequency and damping ratio Settling time and percent overshoot Peak time and percent overshoot Settling time and peak time Handheld calculators have the advantage of easy accessibility for homework and exams. Please consult Appendix H, located at www.wiley.com/college/nise , for a discussion of computational aids that can be adapted to handheld calculators.xii PrefaceWEBFPREF 10/29/2014 0:22:8 Personal computers are better suited for more computation-intensive applications, such as plotting time responses, root loci, and frequency response curves, as well as Ô¨Ånding state-transition matrices. These co mputers also give the student a real-world environment in which to analyze and design control systems. Those not using MATLABor LabVIEW can write their own programs o r use other programs, such as Program CC. Please consult Appendix H at www.wiley.com/college/nise for a discussion of computa- tional aids that can be adapted for use on computers that do not have MATLAB orLabVIEW installed. Without access to computers or programmable calculators, students cannot obtain meaningful analysis and design results and the learning experience will be limited. Icons Identifying Major Topics Several icons identify coverage and optional material. The icons are summarized as follows: The MATLAB icon identi Ô¨Åes MATLAB discussions, examples, exercises, and problems. MATLAB coverage is provided as an enhancement and is not required touse the text. The Simulink icon identi Ô¨Åes Simulink discussions, examples, exercises, and problems. Simulink coverage is provided as an enhancement and is not required to use the text. The GUI Tool icon identi Ô¨Åes MATLAB GUI Tools discussions, examples, exercises, and problems. The discussion of the tools, which includes the LTI Viewer, the Simulink LTIViewer, and the SISO Design Tool, is provided as an enhancement and is not required to usethe text. The Symbolic Math icon identi Ô¨Åes Symbolic Math Toolbox discussions, examples, exercises, and problems. Symbolic Math Toolbox coverage is provided as an enhancementand is not required to use the text. The LabVIEW icon identi Ô¨Åes LabVIEW discussions, examples, exercises, and problems. LabVIEW is provided as an enhancement and is not required to use the text. The State Space icon highlights state-space discussions, examples, exercises, and problems. State-space material is optional and can be omitted without loss of continuity. The Design icon clearly identi Ô¨Åes design problems involving physical systems. New to This Edition The following list describes the key changes in this seventh edition: End-of-chapter problems More than 20% of the end-of-chapter problems are either new or revised. Also, an additionalProgressive Analysis and Design Problem has been added at the end of the chapter problems. The new progressive problem analyzes and designs a solar energy parabolic trough collector. MATLAB The use of MATLAB for computer-aided analysis and design continues to be integrated intodiscussions and problems as an optional feature in the seventh edition. The MATLABtutorial has been updated to MATLAB Version 8.3 (R2014a), the Control System Toolbox Version 9.7, and the Symbolic Math Toolbox Version 6.0 In addition, MATLAB code continues to be incorporated in the chapters in the form of sidebar boxes entitled TryIt. Simulink The use of Simulink to show the effects of nonlinearities upon the time response of open- loop and closed-loop systems appears again in this seventh edition. We also continue to use Simulink to demonstrate how to simulate digital systems. Finally, the Simulink tutorial hasPreface xiiiWEBFPREF 10/29/2014 0:22:8 been updated to Simulink 8.3 and a new section has been added: Using Simulink for Control System Design . LabVIEW LabVIEW continues to be integrated in problems and experiments. LabVIEW has been updated to LabVIEW 2013. Hardware Interface Laboratory New to this edition are experiments that use National Instruments‚Äô myDAQ to control an actual motor. A tutorial to familiarize the reader with myDAQ is added to Appendix DLabVIEW Tutorial. Book Companion Site (BCS) at www.wiley.com/college/nise The BCS for the seventh edition includes various student and instructor resources. This freeresource can be accessed by going to www.wiley.com/college/nise and clicking on Student Companion Site. Professors also access their password-protected resources on the Instructor Companion Site available through this url. Instructors should contact their Wiley sales representative for access. For the Student: All M- Ô¨Åles used in the MATLAB, Simulink, GUI Tools, and Symbolic Math Toolbox tutorials, as well as the TryIt exercises Copies of the Cyber Exploration Laboratory experiments for use as experiment cover sheets Solutions to the Skill-Assessment Exercises in the text LabVIEW Virtual Experiments LabVIEW VIs used in Appendix D AllÔ¨Åles required to perform Hardware Interface Laboratory experiments using National Instruments myDAQ For the Instructor; PowerPoint ÓÄÑ4Ô¨Åles containing the Ô¨Ågures from the textbook Solutions to end-of-chapter problem sets Simulations, developed by JustAsk, for inclusion in lecture presentations Book Organization by Chapter Many times it is helpful lo understand an author's reasoning behind the organization of thecourse material. The following paragraphs hopefully shed light on this topic. The primary goal of Chapter 1 is to motivate students. In this chapter, students learn about the many applications of control systems in everyday life and about the advantages ofstudy and a career in this Ô¨Åeld. Control systems engineering design objectives, such as transient response, steady-state error, and stability, are introduced, as is the path to obtainingthese objectives. New and unfamiliar terms also are included in the Glossary. Many students have trouble with an early step in the analysis and design sequence: transforming a physical system into a schematic. This step requires many simplifyingassumptions based on experience the typical college student does not yet possess.Identifying some of these assumptions in Chapter 1 helps to Ô¨Åll the experience gap. Chapters 2, 3, and 5 address the representation of physical systems. Chapters 2 and 3 cover modeling of open-loop systems, using frequency response techniques and state-spacetechniques, respectively. Chapter 5 discusses the representation and reduction of systemsformed of interconnected open-loop subsystems. Only a representative sample of physical 4PowerPoint is a registered trademark of Microsoft Corporation.xiv PrefaceWEBFPREF 10/29/2014 0:22:8 systems can be covered in a textbook of this length. Electrical, mechanical (both translational and rotational), and electromechanical systems are used as examples of physical systems that are modeled, analyzed, and designed. Linearization of a nonlinear system ‚Äîone technique used by the engineer to simplify a system in order to represent it mathematically ‚Äîis also introduced. Chapter 4 provides an introduction to system analysis, that is, Ô¨Ånding and describing the output response of a system. It may seem more logical to reverse the order of Chapters 4 and 5,to present the material in Chapter 4 along with other chapters covering analysis. However,many years of teaching control systems have taught me that the sooner students see an application of the study of system representation, the higher their motivation levels remain. Chapters 6, 7, 8, and 9 return to control systems analysis and design with the study of stability (Chapter 6), steady-state errors (Chapter 7), and transient response of higher-order systems using root locus techniques (Chapter 8). Chapter 9 covers design of compensatorsand controllers using the root locus. Chapters 10 and 11 focus on sinusoidal frequency analysis and design. Chapter 10, like Chapter 8, covers basic concepts for stability, transient response, and steady-state-erroranalysis. However, Nyquist and Bode methods are used in place of root locus. Chapter 11, like Chapter 9, covers the design of compensators, but from the point of view of sinusoidal frequency techniques rather than root locus. An introduction to state-space design and digital control systems analysis and design completes the text in Chapters 12 and 13, respectively. Although these chapters can be used asan introduction for students who will be continuing their study of control systems engineering,they are useful by themselves and as a supplement to the discussion of analysis and design inthe previous chapters. The subject matter cannot be given a comprehensive treatment in twochapters, but the emphasis is clearly outlined and logically linked to the rest of the book. Acknowledgments The author would like to acknowledge the contributions of faculty and students, both atCalifornia State Polytechnic University, Pomona, and across the country, whose sugges-tions through all editions have made a positive impact on this new edition. I am deeply indebted to my colleagues, Drs. Elhami T. Ibrahim and Salomon Oldak at California State Polytechnic University, Pomona for authoring the creative new problems you will Ô¨Ånd at the end of every chapter. The new progressive problem, solar energy parabolic trough collector, that is at the end of every chapter is the creation of Dr Oldak. In addition, I am grateful to Dr. Oldak for creating the National InstrumentsmyDAQ experiments, which you will Ô¨Ånd in the Hardware Interface Laboratory section of many chapters. Finally, I want to thank Dr. Norali Pernalete, also of California StatePolytechnic University, Pomona, for her contribution of the LabVIEW experiments andproblems continuing in this edition. I would like to express my appreciation to those who participated in reviews of this seventh edition. They are: James R. McCusker, Wentworth Institute of Technology, and Ji-chulRyu, Northern Illinois University. The author would like to thank John Wiley & Sons, Inc. and its staff for once again providing professional support for this project through all phases of its development.SpeciÔ¨Å cally, the following are due recognition for their contributions: Don Fowley, Vice President and Publisher, who gave full corporate support to the project; Dan Sayre,Executive Editor, with whom I worked closely and who provided guidance and leadershipthroughout the development of the seventh edition; Francesca Baratta and Jessica Knecht, Editorial Assistants who were always there to answer my questions and respond to my concerns in a professional manner; and Anna Melhorn, Senior Production Editor, whoturned the seventh edition manuscript into the Ô¨Ånal product you are holding in your hands. Other contributors who worked hard behind the scenes are: Wendy Lai, Designer;Preface xvWEBFPREF 10/29/2014 0:22:8 Harry Nolan, Director of Design; Jennifer Welter, Senior Product Designer; Kevin Holm, Learning Space Content Manager; and Wendy Ashenberg, Content Editor. My sincere appreciation is extended to Erik Luther of National Instruments Corporation and Paul Gilbert, Michel Levis, and Tom Lee of Quanser for conceiving, coordinating, and developing the Virtual Experiments that I am sure will enhance your understanding of controlsystems. Others from National Instruments who contributed to the successful publication ofthis book are Margaret Barrett and Kathy Brown. Finally, last but certainly not least, I want to express my appreciation to my wife, Ellen, for her support in ways too numerous to mention during the writing of all editions. Speci Ô¨Åcally, though, thanks to her proo Ô¨Ång pages for this seventh edition, you, the reader, hopefully will Ô¨Ånd comprehension rather than apprehension in the pages that follow. Norman S. Nisexvi PrefaceWEBC01 10/28/2014 14:10:27 Introduction Chapter Learning Outcomes After completing this chapter, the student will be able to: ¬ÅDeÔ¨Åne a control system and describe some applications (Section 1.1) ¬ÅDescribe historical developments leading to modern day control theory (Section 1.2) ¬ÅDescribe the basic features and con Ô¨Ågurations of control systems (Section 1.3) ¬ÅDescribe control systems analysis and design objectives (Section 1.4) ¬ÅDescribe a control system ‚Äôs design process (Sections 1.5 ‚Äì1.6) ¬ÅDescribe the bene Ô¨Åt from studying control systems (Section 1.7) Case Study Learning Outcomes ¬ÅYou will be introduced to a running case study ‚Äîan antenna azimuth position control system ‚Äîthat will serve to illustrate the principles in each subsequent chapter. In this chapter, the system is used to demonstrate qualitatively how a control system works as well as to de Ô¨Åne performance criteria that are the basis for control systems analysis and design.1 1WEBC01 10/28/2014 14:10:27 1.1 Introduction Control systems are an integral part of modern society. Numerous applications are all around us: The rockets Ô¨Åre, and the space shuttle lifts off to earth orbit; in splashing cooling water, a metallic part is automatically machined; a self-guided vehicle delivering material toworkstations in an aerospace assembly plant glides along the Ô¨Çoor seeking its destination. These are just a few examples of the automatically controlled systems that we can create. We are not the only creators of automatically controlled systems; these systems also exist in nature. Within our own bodies are numerous control systems, such as the pancreas, which regulates our blood sugar. In time of ‚ÄúÔ¨Åght or Ô¨Çight,‚Äù our adrenaline increases along with our heart rate, causing more oxygen to be delivered to our cells. Our eyes follow a moving object to keep it in view; our hands grasp the object and place it precisely at apredetermined location. Even the nonphysical world appears to be automatically regulated. Models have been suggested showing automatic control of student performance. The input to the model is thestudent ‚Äôs available study time, and the output is the grade. The model can be used to predict the time required for the grade to rise if a sudden increase in study time is available. Using this model, you can determine whether increased study is worth the effort during the last week of the term. Control System DeÔ¨Å nition A control system consists of subsystems andprocesses (orplants) assembled for the purpose of obtaining a desired output with desired performance , given a speci Ô¨Åed input . Figure 1.1 shows a control system in its simplest form, where the input represents a desired output. For example, consider an elevator. When the fourth- Ô¨Çoor button is pressed on the Ô¨ÅrstÔ¨Çoor, the elevator rises to the fourth Ô¨Çoor with a speed and Ô¨Çoor- leveling accuracy designed for passenger comfort. The push of the fourth- Ô¨Çoor button is an input that represents our desired output , shown as a step function in Figure 1.2. The performance of the elevator can be seen from the elevator response curve in the Ô¨Ågure. Two major measures of performance are apparent: (1) the transient response and (2) the steady-state error. In our example, passenger comfort and passenger patience aredependent upon the transient response. If this response is too fast, passenger comfort issacriÔ¨Åced; if too slow, passenger patience is sacri Ô¨Åced. The steady-state error is another important performance speci Ô¨Åcation since passenger safety and convenience would be sacriÔ¨Åced if the elevator did not level properly. Advantages of Control Systems With control systems we can move large equipment with precision that would otherwisebe impossible. We can point huge antennas toward the farthest reaches of the universe topick up faint radio signals; controlling these antennas by hand would be impossible.Because of control systems, elevators carry us quickly to our destination, automatically stopping at the right Ô¨Çoor (Figure 1.3). We alone could not provide the power required for 4Input command Transient response TimeElevator location (floor)Steady-state errorSteady-state response Elevator response 1FIGURE 1.2 Elevator responseControl systemOutput; response Actual responseInput; stimulus Desired response FIGURE 1.1 Simpli Ô¨Åed description of a control system2 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:27 the load and the speed; motors provide the power, and control systems regulate the position and speed. We build control systems for four primary reasons: 1.Power ampli Ô¨Åcation 2.Remote control 3.Convenience of input form 4.Compensation for disturbances For example, a radar antenna, positioned by the low-power rotation ofa knob at the input, requires a large amount of power for its outputrotation. A control system can produce the needed power ampli Ô¨Åcation, or power gain. Robots designed by control system principles can compensate for human disabilities. Control systems are also useful in remote or dangerouslocations. For example, a remote-controlled robot arm can be used to pickup material in a radioactive environment. Figure 1.4 shows a robot armdesigned to work in contaminated environments. Control systems can also be used to provide convenience by changing the form of the input. For example, in a temperature control system, theinput is a position on a thermostat. The output is heat. Thus, a convenient position input yields a desired thermal output. Another advantage of a control system is the ability to compensate for disturbances. Typically, we control such variables as temperature in thermalsystems, position and velocity in mechanical systems, and voltage, current,or frequency in electrical systems. The system must be able to yield thecorrect output even with a disturbance. For example, consider an antennasystem that points in a commanded direction. If wind forces the antennafrom its commanded position, or if noise enters internally, the system must be able to detect the disturbance and correct the antenna ‚Äôs position. FIGURE 1.4 Rover was built to work in contaminated areas at Three Mile Island in Middleton, Pennsylvania, where a nuclear accident occurred in 1979. The remote-controlled robot ‚Äôs long arm can be seen at the front of the vehicle. FIGURE 1.3 a.Early elevators were controlled by hand ropes or an elevatoroperator. Here a rope is cut todemonstrate the safety brake, an innovation in early elevators; b.One of two modern Duo-lift elevators makes its way up the Grande Arche in Paris. Two elevators are driven by onemotor, with each car acting as a counterbalance to the other. Today, elevators are fullyautomatic, using controlsystems to regulate position and velocity.1.1 Introduction 3WEBC01 10/28/2014 14:10:27 Obviously, the system ‚Äôs input will not change to make the correction. Consequently, the system itself must measure the amount that the disturbance has repositioned the antenna and then return the antenna to the position commanded by the input. 1.2 A History of Control Systems Feedback control systems are older than humanity. Numerous biological control systemswere built into the earliest inhabitants of our planet. Let us now look at a brief history ofhuman-designed control systems. 1 Liquid-Level Control The Greeks began engineering feedback systems around 300 B.C. A water clock invented by Ktesibios operated by having water trickle into a measuring container ata constant rate. The level of water in the measuring container could be used to tell time. For water to trickle at a constant rate, the supply tank had to be kept at a constant level. This was accomplished using a Ô¨Çoat valve similar to the water-level control in today ‚Äôs Ô¨Çush toilets. Soon after Ktesibios, the idea of liquid-level control was applied to an oil lamp by Philon of Byzantium. The lamp consisted of two oil containers con Ô¨Ågured vertically. The lower pan was open at the top and was the fuel supply for the Ô¨Çame. The closed upper bowl was the fuel reservoir for the pan below. The containers were interconnected by twocapillary tubes and another tube, called a vertical riser , which was inserted into the oil in the lower pan just below the surface. As the oil burned, the base of the vertical riser was exposedto air, which forced oil in the reservoir above to Ô¨Çow through the capillary tubes and into the pan. The transfer of fuel from the upper reservoir to the pan stopped when the previous oillevel in the pan was reestablished, thus blocking the air from entering the vertical riser.Hence, the system kept the liquid level in the lower container constant. Steam Pressure and Temperature Controls Regulation of steam pressure began around 1681 with Denis Papin ‚Äôs invention of the safety valve. The concept was further elaborated on by weighting the valve top. If the upwardpressure from the boiler exceeded the weight, steam was released, and the pressuredecreased. If it did not exceed the weight, the valve did not open, and the pressure insidethe boiler increased. Thus, the weight on the valve top set the internal pressure of the boiler. Also in the seventeenth century, Cornelis Drebbel in Holland invented a purely mechanical temperature control system for hatching eggs. The device used a vial of alcohol and mercury with a Ô¨Çoater inserted in it. The Ô¨Çoater was connected to a damper that controlled a Ô¨Çame. A portion of the vial was inserted into the incubator to sense the heat generated by the Ô¨Åre. As the heat increased, the alcohol and mercury expanded, raising the Ô¨Çoater, closing the damper, and reducing the Ô¨Çame. Lower temperature caused the Ô¨Çoat to descend, opening the damper and increasing the Ô¨Çame. Speed Control In 1745, speed control was applied to a windmill by Edmund Lee. Increasing winds pitched the blades farther back, so that less area was available. As the wind decreased, more bladearea was available. William Cubitt improved on the idea in 1809 by dividing the windmillsail into movable louvers. Also in the eighteenth century, James Watt invented the Ô¨Çyball speed governor to control the speed of steam engines. In this device, two spinning Ô¨Çyballs rise as rotational speed increases. A steam valve connected to the Ô¨Çyball mechanism closes with the ascending Ô¨Çyballs and opens with the descending Ô¨Çyballs, thus regulating the speed. 1See ( Bennett ,1979 ) and ( Mayr ,1970 ) for de Ô¨Ånitive works on the history of control systems.4 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:27 Stability, Stabilization, and Steering Control systems theory as we know it today began to crystallize in the latter half of the nineteenth century. In 1868, James Clerk Maxwell published the stability criterion for a third-order system based on the coef Ô¨Åcients of the differential equation. In 1874, Edward John Routh, using a suggestion from William Kingdon Clifford that was ignored earlier byMaxwell, was able to extend the stability criterion to Ô¨Åfth-order systems. In 1877, the topic for the Adams Prize was ‚ÄúThe Criterion of Dynamical Stability. ‚ÄùIn response, Routh submitted a paper entitled A Treatise on the Stability of a Given State of Motion and won the prize. This paper contains what is now known as the Routh-Hurwitz criterion for stability,which we will study in Chapter 6. Alexandr Michailovich Lyapunov also contributed to the development and formulation of today ‚Äôs theories and practice of control system stability. A student of P. L. Chebyshev at the University of St. Petersburg in Russia, Lyapunov extended the work of Routh to nonlinear systems in his 1892 doctoral thesis, entitled The General Problem of Stability of Motion . During the second half of the 1800s, the development of control systems focused on the steering and stabilizing of ships. In 1874, Henry Bessemer, using a gyro to sense a ship ‚Äôs motion and applying power generated by the ship ‚Äôs hydraulic system, moved the ship ‚Äôs saloon to keep it stable (whether this made a difference to the patrons is doubtful). Other efforts were made to stabilize platforms for guns as well as to stabilize entire ships, using pendulums to sense the motion. Twentieth-Century Developments It was not until the early 1900s that automatic steering of ships was achieved. In 1922, theSperry Gyroscope Company installed an automatic steering system that used theelements of compensation and adaptive control to improve performance. However,much of the general theory used today to improve the performance of automatic controlsystems is attributed to Nicholas Minorsky, a Russian born in 1885. It was his theoreticaldevelopment applied to the automatic steering of ships that led to what we call todayproportional-plus-integral-pl us-derivative (PID), or three-mode, controllers, which we will study in Chapters 9 and 11. In the late 1920s and early 1930s, H. W. Bode and H. Nyquist at Bell Telephone Laboratories developed the analysis of feedback ampli Ô¨Åers. These contributions evolved into sinusoidal frequency analysis and design techniques currently used for feedback controlsystem, and are presented in Chapters 10 and 11. In 1948, Walter R. Evans, working in the aircraft industry, developed a graphical technique to plot the roots of a characteristic equation of a feedback system whose parameterschanged over a particular range of values. This technique, now known as the root locus, takes its place with the work of Bode and Nyquist in forming the foundation of linear control systems analysis and design theory. We will study root locus in Chapters 8, 9, and 13. Contemporary Applications Today, control systems Ô¨Ånd widespread application in the guidance, navigation, and control of missiles and spacecraft, as well as planes and ships at sea. For example, modern ships usea combination of electrical, mechanical, and hydraulic components to develop ruddercommands in response to desired heading commands. The rudder commands, in turn, resultin a rudder angle that steers the ship. WeÔ¨Ånd control systems throughout the process control industry, regulating liquid levels in tanks, chemical concentrations in vats, as well as the thickness of fabricatedmaterial. For example, consider a thickness control system for a steel plate Ô¨Ånishing mill. Steel enters the Ô¨Ånishing mill and passes through rollers. In the Ô¨Ånishing mill, X-rays measure the actual thickness and compare it to the desired thickness. Any difference isadjusted by a screw-down position control that changes the roll gap at the rollers throughwhich the steel passes. This change in roll gap regulates the thickness.1.2 A History of Control Systems 5WEBC01 10/28/2014 14:10:27 Modern developments have seen widespread use of the digital computer as part of control systems. For example, computers in control systems are for industrial robots, spacecraft, and the process control industry. It is hard to visualize a modern control systemthat does not use a digital computer. Although recently retired, the space shuttle provides an excellent example of the use of control systems because it contained numerous control systems operated by an onboardcomputer on a time-shared basis. Without control systems, it would be impossible to guidethe shuttle to and from earth ‚Äôs orbit or to adjust the orbit itself and support life on board. Navigation functions programmed into the shuttle ‚Äôs computers used data from the shuttle ‚Äôs hardware to estimate vehicle position and velocity. This information was fed to the guidanceequations that calculated commands for the shuttle ‚ÄôsÔ¨Çight control systems, which steered the spacecraft. In space, the Ô¨Çight control system gimbaled (rotated) the orbital maneuvering system (OMS) engines into a position that provided thrust in the commanded direction tosteer the spacecraft. Within the earth ‚Äôs atmosphere, the shuttle was steered by commands sent from the Ô¨Çight control system to the aerosurfaces, such as the elevons. Within this large control system represented by navigation, guidance, and control were numerous subsystems to control the vehicle ‚Äôs functions. For example, the elevons required a control system to ensure that their position was indeed that which was commanded, sincedisturbances such as wind could rotate the elevons away from the commanded position.Similarly, in space, the gimbaling of the orbital maneuvering engines required a similar controlsystem to ensure that the rotating engine can accomplish its function with speed and accuracy.Control systems were also used to control and stabilize the vehicle during its descent fromorbit. Numerous small jets that compose the reaction control system (RCS) were used initiallyin the exoatmosphere, where the aerosurfaces are ineffective. Control was passed to theaerosurfaces as the orbiter descended into the atmosphere. Inside the shuttle, numerous control systems were required for power and life support. For example, the orbiter had three fuel-cell power plants that converted hydrogen andoxygen (reactants) into electricity and water for use by the crew. The fuel cells involved theuse of control systems to regulate temperature and pressure. The reactant tanks were kept atconstant pressure as the quantity of reactant diminishes. Sensors in the tanks sent signals tothe control systems to turn heaters on or off to keep the tank pressure constant ( Rockwell International, 1984 ). Control systems are not limited to science and industry. For example, a home heating system is a simple control system consisting of a thermostat containing a bimetallic materialthat expands or contracts with changing temperature. This expansion or contraction moves avial of mercury that acts as a switch, turning the heater on or off. The amount of expansion orcontraction required to move the mercury switch is determined by the temperature setting. Home entertainment systems also have built-in control systems. For example, in an optical disk recording system microscopic pits representing the information are burned intothe disc by a laser during the recording process. During playback, a re Ô¨Çected laser beam focused on the pits changes intensity. The light intensity changes are converted to an electrical signal and processed as sound or picture. A control system keeps the laser beam positioned on the pits, which are cut as concentric circles. There are countless other examples of control systems, from the everyday to the extraordinary. As you begin your study of control systems engineering, you will becomemore aware of the wide variety of applications. 1.3 System Con Ô¨Ågurations In this section, we discuss two major con Ô¨Ågurations of control systems: open loop and closed loop. We can consider these con Ô¨Ågurations to be the internal architecture of the total system shown in Figure 1.1. Finally, we show how a digital computer forms part of a controlsystem ‚Äôs con Ô¨Åguration.6 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:28 Open-Loop Systems A generic open-loop system is shown in Figure 1.5( a). It starts with a subsystem called an input transducer , which converts the form of the input to that used by the controller . The controller drives a process or aplant . The input is sometimes called the reference , while the output can be called the controlled variable . Other signals, such as disturbances , are shown added to the controller and process outputs via summing junctions , which yield the algebraic sum of their input signals using associated signs. For example, the plant can be a furnace or air conditioning system, where the output variable is temperature. The controller in a heatingsystem consists of fuel valves and the electrical system that operates the valves. The distinguishing characteristic of an open-loop system is that it cannot compensate for any disturbances that add to the controller ‚Äôs driving signal (Disturbance 1 in Figure 1.5( a)). For example, if the controller is an electronic ampli Ô¨Åer and Disturbance 1 is noise, then any additive ampli Ô¨Åer noise at the Ô¨Årst summing junction will also drive the process, corrupting the output with the effect of the noise. The output of an open-loop system is corrupted not only bysignals that add to the controller ‚Äôs commands but also by disturbances at the output (Disturbance 2 in Figure 1.5( a)). The system cannot correct for these disturbances, either. Open-loop systems, then, do not correct for disturbances and are simply commanded by the input. For example, toasters are open-loop systems, as anyone with burnt toast can attest.The controlled variable (output) of a toaster is the color of the toast. The device is designed with the assumption that the toast will be darker the longer it is subjected to heat. The toaster does not measure the color of the toast; it does not correct for the fact that the toast is rye, white,or sourdough, nor does it correct for the fact that toast comes in different thicknesses. Other examples of open-loop systems are mechanical systems consisting of a mass, spring, and damper with a constant force positioning the mass. The greater the force, thegreater the displacement. Again, the system position will change with a disturbance, such asan additional force, and the system will not detect or correct for the disturbance. Or, assumethat you calculate the amount of time you need to study for an examination that covers three chapters in order to get an A. If the professor adds a fourth chapter ‚Äîa disturbance ‚Äîyou are an open-loop system if you do not detect the disturbance and add study time to that previously calculated. The result of this oversight would be a lower grade than youexpected.ControllerProcess or Plant++Output or Controlled variableDisturbance 1 Disturbance 2 Summing junctionSumming junction (a) ControllerProcess or Plant++Input or ReferenceOutput or Controlled variableDisturbance 1 Disturbance 2 Summing junctionSumming junction (b)Error or Actuating signal Summing junction+ Input transducer‚Äì Output transducer or Sensor+ ++ +Input or ReferenceInput transducer FIGURE 1.5 Block diagrams of control systems: a.open-loop system; b.closed-loop system1.3 System Con Ô¨Ågurations 7WEBC01 10/28/2014 14:10:28 Closed-Loop (Feedback Control) Systems The disadvantages of open-loop systems, namely sensitivity to disturbances and inability to correct for these disturbances, may be overcome in closed-loop systems . The generic architecture of a closed-loop system is shown in Figure 1.5( b). The input transducer converts the form of the input to the form used by the controller. An output transducer ,o rsensor , measures the output response and converts it into the form used by the controller. For example, if the controller uses electrical signals to operate the valves of a temperature control system, the input position and the outputtemperature are converted to electrical signals. The input position can be converted to avoltage by a potentiometer , a variable resistor, and the output temperature can be converted to a voltage by a thermistor , a device whose electrical resistance changes with temperature. TheÔ¨Årst summing junction algebraically adds the signal from the input to the signal from the output, which arrives via the feedback path , the return path from the output to the summing junction. In Figure 1.5( b), the output signal is subtracted from the input signal. The result is generally called the actuating signal . However, in systems where both the input and output transducers have unity gain (that is, the transducer ampli Ô¨Åes its input by 1), the actuating signal ‚Äôs value is equal to the actual difference between the input and the output. Under this condition, the actuating signal is called the error . The closed-loop system compensates for disturbances by measuring the output response, feeding that measurement back through a feedback path, and comparing thatresponse to the input at the summing junction. If there is any difference between the tworesponses, the system drives the plant, via the actuating signal, to make a correction. If thereis no difference, the system does not drive the plant, since the plant ‚Äôs response is already the desired response. Closed-loop systems, then, have the obvious advantage of greater accuracy than open-loop systems. They are less sensitive to noise, disturbances, and changes in theenvironment. Transient response and steady-state error can be controlled more convenientlyand with greater Ô¨Çexibility in closed-loop systems, often by a simple adjustment of gain (ampli Ô¨Åcation) in the loop and sometimes by redesigning the controller. We refer to the redesign as compensating the system and to the resulting hardware as a compensator . On the other hand, closed-loop systems are more complex and expensive than open-loop systems. Astandard, open-loop toaster serves as an example: It is simple and inexpensive. A closed-looptoaster oven is more complex and more expensive since it has to measure both color (through light re Ô¨Çectivity) and humidity inside the toaster oven. Thus, the control systems engineer must consider the trade-off between the simplicity and low cost of an open-loop system and the accuracy and higher cost of a closed-loop system. In summary, systems that perform the previously described measurement and correction are called closed-loop, or feedback control, systems. Systems that do nothave this property of measurement and correction are called open-loop systems. Computer-Controlled Systems In many modern systems, the controller (or compensator) is a digital computer. Theadvantage of using a computer is that many loops can be controlled or compensated by thesame computer through time sharing. Furthermore, any adjustments of the compensatorparameters required to yield a desired response can be made by changes in software ratherthan hardware. The computer can also perform supervisory functions, such as schedulingmany required applications. For example, the space shuttle main engine (SSME) controller,which contained two digital computers, alone controlled numerous engine functions. It monitored engine sensors that provided pressures, temperatures, Ô¨Çow rates, turbopump speed, valve positions, and engine servo valve actuator positions. The controller further provided closed-loop control of thrust and propellant mixture ratio, sensor excitation, valveactuators, spark igniters, as well as other functions ( Rockwell International ,1984 ).8 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:28 1.4 Analysis and Design Objectives In Section 1.1 we brie Ô¨Çy alluded to some control system performance speci Ô¨Åcations, such as transient response and steady-state error. We now expand upon the topic of performance and place it in perspective as we de Ô¨Åne our analysis and design objectives. Analysis is the process by which a system ‚Äôs performance is determined. For example, we evaluate its transient response and steady-state error to determine if they meet the desiredspeciÔ¨Åcations. Design is the process by which a system ‚Äôs performance is created or changed. For example, if a system ‚Äôs transient response and steady-state error are analyzed and found not to meet the speci Ô¨Åcations, then we change parameters or add additional components to meet the speci Ô¨Åcations. A control system is dynamic: It responds to an input by undergoing a transient response before reaching a steady-state response that generally resembles the input. Wehave already identi Ô¨Åed these two responses and cited a position control system (an elevator) as an example. In this section, we discuss three major objectives of systems analysis anddesign: producing the desired transient response, reducing steady-state error, and achievingstability. We also address some other design concerns, such as cost and the sensitivity of system performance to changes in parameters. Transient Response Transient response is important. In the case of an elevator, a slow transient response makes passengers impatient, whereas an excessively rapid response makes them uncomfortable.If the elevator oscillates about the arrival Ô¨Çoor for more than a second, a disconcerting feeling can result.Transient response is also important for structuralreasons: Too fast a transient response could causepermanent physical damage. In a computer, transientresponse contributes to the time required to read from or write to the computer ‚Äôs disk storage (see Figure 1.6). Since reading and writing cannot take place until the head stops, the speed of the read/write head ‚Äôs movement from one track on the disk to another in Ô¨Çuences the overall speed of the computer. In this book, we establish quantitative de Ô¨Ånitions for transient response. We then analyze the system for itsexisting transient response. Finally, we adjust parame- ters or design components to yield a desired transient response ‚ÄîourÔ¨Årst analysis and design objective. Steady-State Response Another analysis and design goal focuses on the steady-state response. As we have seen,this response resembles the input and is usually what remains after the transients havedecayed to zero. For example, this response may be an elevator stopped near the fourthÔ¨Çoor or the head of a disk drive Ô¨Ånally stopped at the correct track. We are concerned about the accuracy of the steady-state response. An elevator must be level enough withtheÔ¨Çoor for the passengers to exit, and a read/write head not positioned over the commanded track results in computer errors. An antenna tracking a satellite mustkeep the satellite well within its beamwidth in order not to lose track. In this text we deÔ¨Åne steady-state errors quantitatively, analyze a system‚Äô s steady-state error, and then design corrective action to reduce the steady-state error ‚Äîour second analysis and design objective. FIGURE 1.6 Computer hard disk drive, showing disks and read/write head1.4 Analysis and Design Objectives 9WEBC01 10/28/2014 14:10:28 Stability Discussion of transient response and steady-state error is moot if the system does not have stability . In order to explain stability, we start from the fact that the total response of a system is the sum of the natural response and the forced response . When you studied linear differential equations, you probably referred to these responses as the homogeneous and the particular solutions , respectively. Natural response describes the way the system dissipates or acquires energy. The form or nature of this response is dependent only on the system, not the input. On the other hand, the form or nature of the forced response is dependent on theinput. Thus, for a linear system, we can write Total response ¬àNatural response ¬áForced response 1.1¬Ü 2 For a control system to be useful, the natural response must (1) eventually approach zero, thus leaving only the forced response, or (2) oscillate. In some systems, however, thenatural response grows without bound rather than diminish to zero or oscillate. Eventually,the natural response is so much greater than the forced response that the system is no longer controlled. This condition, called instability , could lead to self-destruction of the physical device if limit stops are not part of the design. For example, the elevator would crash through theÔ¨Çoor or exit through the ceiling; an aircraft would go into an uncontrollable roll; or an antenna commanded to point to a target would rotate, line up with the target, but then beginto oscillate about the target with growing oscillations and increasing velocity until the motor or ampli Ô¨Åers reached their output limits or until the antenna was damaged structurally. A time plot of an unstable system would show a transient response that grows without boundand without any evidence of a steady-state response. Control systems must be designed to be stable. That is, their natural response must decay to zero as time approaches in Ô¨Ånity, or oscillate. In many systems the transient response you see on a time response plot can be directly related to the natural response.Thus, if the natural response decays to zero as time approaches in Ô¨Ånity, the transient response will also die out, leaving only the forced response. If the system is stable, theproper transient response and steady-state error characteristics can be designed. Stability isour third analysis and design objective. Other Considerations The three main objectives of control system analysis and design have already beenenumerated. However, other important considerations must be taken into account. Forexample, factors affecting hardware selection, such as motor sizing to ful Ô¨Åll power requirements and choice of sensors for accuracy, must be considered early in the design. Finances are another consideration. Control system designers cannot create designs without considering their economic impact. Such considerations as budget allocations andcompetitive pricing must guide the engineer. For example, if your product is one of akind, you may be able to create a design that uses more expensive components withoutappreciably increasing total cost. However, if your design will be used for many copies,slight increases in cost per copy can translate into many more dollars for your company topropose during contract bidding and to outlay before sales. 2You may be confused by the words transient vs.natural , and steady-state vs.forced . If you look at Figure 1.2, you can see the transient and steady-state portions of the total response as indicated. The transient response is the sum of the natural and forced responses, while the natural response is large. If we plotted the natural response by itself, wewould get a curve that is different from the transient portion of Figure 1.2. The steady-state response of Figure 1.2is also the sum of the natural and forced responses, but the natural response is small. Thus, the transient and steady-state responses are what you actually see on the plot; the natural and forced responses are the underlying mathematical components of those responses.10 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:28 Another consideration is robust design. System parameters considered constant during the design for transien t response, steady-state error s, and stability change over time when the actual system is built. Thus, the performance of the system also changes over time and will not be consistent with your design. Unfortunately, the relationshipbetween parameter changes and their effect on performance is not linear. In some cases,even in the same system, changes in parameter values can lead to small or large changesin performance, depending on the system ‚Äôs nominal operating point and the type of design used. Thus, the engineer wants to creat e a robust design so that the system will not be sensitive to parameter changes. We disc uss the concept of system sensitivity to parameter changes in Chapters 7 and 8. This concept, then, can be used to test a design forrobustness. Case Study Introduction to a Case StudyIntroduction to a Case Study Now that our objectives are stated, how do we meet them? In this section we will look at an example of a feedback control system. The system introduced here will be used in subsequent chapters as a running case study to demonstrate the objectives of those chapters. A colored background like this will identify the case study section at the end ofeach chapter. Section 1.5, which follows this Ô¨Årst case study, explores the design process that will help us build our system. Antenna Azimuth: An Introduction to Position Control Systems A position control system converts a position input command to a position output response. Position control systems Ô¨Ånd widespread applications in antennas, robot arms, and computer disk drives. The radio telescope antenna in Figure 1.7 is one exampleof a system that uses position control systems. In this section, we will look in detail at anantenna azimuth position control system that could be used to position a radio telescopeantenna. We will see how the system works and how we can effect changes in itsperformance. The discussion here will be on a qualitative level, with the objective of getting an intuitive feeling for the systems with which we will be dealing. An antenna azimuth position control system is shown in Figure 1.8( a), with a more detailed layout and schematic in Figures 1.8( b) and 1.8( c), respectively. Figure 1.8( d) shows a functional block diagram of the system. The functions are shown above the blocks, and the required hardware is indicated inside the blocks. Parts of Figure 1.8 are repeated on the front endpapers for future reference. The purpose of this system is to have the azimuth angle output of the antenna, Œ∏ o t¬Ü, follow the input angle of the potentiometer, Œ∏i t¬Ü. Let us look at Figure 1.8( d) and describe how this system works. The input command is an angular displacement. The potentiometerconverts the angular displacement into a voltage. Similarly, the output angular displacementis converted to a voltage by the potentiometer in the feedback path. The signal and powerampli Ô¨Åers boost the difference between the input and output voltages. This ampli Ô¨Åed actuating signal drives the plant. The system normally operates to drive the error to zero. When the input and output match, the error will be zero, and the motor will not turn. Thus, the motor isdriven only when the output and the input do not match. The greater the difference between the input and the output, the larger the motor input voltage, and the faster the motor will turn. Peter Menzel FIGURE 1.7 The search for extraterrestrial life is being carried out with radio antennaslike the one pictured here. A radio antenna is an example of a system with position controlsCase Study 11WEBC01 10/28/2014 14:10:28 FIGURE 1.8 Antenna azimuth position control system: a.system concept; b.detailed layout; c.schematic (Ô¨Ågure continues )(a)Œ∏i(t) Desired azimuth angle inputPotentiometer Œ∏o(t) Azimuth angle outputAntenna (b)MotorŒ∏i(t) Desired azimuth angle input Differential amplifier and power amplifier PotentiometerPotentiometer Œ∏o(t) Azimuth angle outputAntenna ‚Äì+ Differential and power amplifier KPotentiometer Armature resistance Armature Potentiometer GearŒ∏i(t) Œ∏o(t) Fixed field +‚ÄìInertia Viscous dampingGear GearMotor ‚Äì+Amplifiers (c)12 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:29 If we increase the gain of the signal ampliÔ¨Å er, will there be an increase in the steady-state value of the output? If the gain is increased, then for a given actuating signal, the motor will be driven harder. However, the motor will still stop when the actuating signal reaches zero, that is, when the output matches the input. The difference in the response, however, will be in the transients. Since the motor is driven harder, it turns faster toward its Ô¨Ånal position. Also, because of the increased speed, increased momentum could cause themotor to overshoot the Ô¨Ånal value and be forced by the system to return to the commanded position. Thus, the possibility exists for a transient response that consists of damped oscillations (that is, a sinusoidal response whose amplitude diminishes with time) about the steady-state value if the gain is high. The responses for low gain and high gain areshown in Figure 1.9. We have discussed the transient response of the position control system. Let us now direct our attention to the steady-state position to see how closely the output matches theinput after the transients disappear. We de Ô¨Åne steady-state error as the difference between the input and the output after the transients have effectively disappeared. The de Ô¨Ånition holds equally well for step, ramp, and other types of inputs. Typically, the steady-state error decreases with anincrease in gain and increases with a decrease in gain. Figure 1.9 shows zero error in thesteady-state response; that is, after the transients have disappeared, the output positionSignal and power amplifiersMotor, load, and gearsAngular inputAngular outputError or Actuating signalVoltage proportional to input + ‚ÄìInput transducer Summing junction Voltage proportional to outputControllerPlant or Process Sensor (output transducer) PotentiometerPotentiometer (d)FIGURE 1.8 (Continued ) d.functional block diagram Output with low gainOutput with high gain Input TimeResponse FIGURE 1.9 Response of a position control system, showing effect of high and low controller gain on the output responseCase Study 13WEBC01 10/28/2014 14:10:29 1.5 The Design Process In this section, we establish an orderly sequence for the design of feedback control systems that will be followed as we progress through the rest of the book. Figure 1.10 shows thedescribed process as well as the chapters in which the steps are discussed. The antenna azimuth position control system discussed in the last section is representative of control systems that must be analyzed and designed. Inherent inFigure 1.10 is feedback and communication during each phase. For example, if testing(Step 6) shows that requirements have not been met, the system must be redesigned andretested. Sometimes requirements are con Ô¨Çicting and the design cannot be attained. In these cases, the requirements have to be respeci Ô¨Åed and the design process repeated. Let us now elaborate on each block of Figure 1.10. Step 1: Transform Requirements Into a Physical System We begin by transforming the requirements into a physical system. For example, in theantenna azimuth position control system, the requirements would state the desire to position Determine a physical system and specifications from the requirements.Transform the physical system into a schematic.Use the schematic to obtain a block diagram, signal-flow diagram, or state-space representation.If multiple blocks, reduce the block diagram to a single block or closed-loop system.Analyze, design, and test to see that requirements and specifications are met. Chapter 1 Chapters 2, 3 Chapter 13Chapter 5 Chapter 13Chapters 4, 6‚Äì12 Chapter 13Analog: Digital:Draw a functional block diagram.Step 1 Step 2 Step 3 Step 4 Step 5 Step 6 FIGURE 1.10 The control system design processequals the commanded input position. In some systems, the steady-state error will not be zero; for these systems, a simple gain adjustment to regulate the transient response is either not effective or leads to a trade-off between the desired transient response and the desired steady-state accuracy. To solve this problem, a controller with a dynamic response, such as an electrical Ô¨Ålter, is used along with an ampli Ô¨Åer. With this type of controller, it is possible to design both the required transient response and the required steady-state accuracy without thetrade-off required by a simple setting of gain. However, the controller is now morecomplex. The Ô¨Ålter in this case is called a compensator. Many systems also use dynamic elements in the feedback path along with the output transducer to improve system performance. An animation PowerPoint presentation (PPT) demonstrating this system is available for instructors at www.wiley.com/college/nise . See Antenna (Ch. 1 ). In summary, then, our design objectives and the system‚Äô s performance revolve around the transient response, the steady-state error, and stability. Gain adjustments canaffect performance and sometimes lead to trade-offs between the performance criteria.Compensators can often be designed to achieve performance speci Ô¨Åcations without the need for trade-offs. Now that we have stated our objectives and some of the methodsavailable to meet those objectives, we describe the orderly progression that leads us to the Ô¨Ånal system design.14 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:29 the antenna from a remote location and describe such features as weight and physical dimensions. Using the requirements, design speci Ô¨Åcations, such as desired transient response and steady-state accuracy, are determined. Perhaps an overall concept, such as Figure 1.8( a), would result. Step 2: Draw a Functional Block Diagram The designer now translates a qualitative description of the system into a functional blockdiagram that describes the component parts of the system (that is, function and/or hardware)and shows their interconnection. Figure 1.8( d) is an example of a functional block diagram for the antenna azimuth position control system. It indicates functions such as inputtransducer and controller, as well as possible hardware descriptions such as ampli Ô¨Åers and motors. At this point the designer may produce a detailed layout of the system, such as that shown in Figure 1.8( b), from which the next phase of the analysis and design sequence, developing a schematic diagram, can be launched. Step 3: Create a Schematic As we have seen, position control system s consist of electrical, mechanical, and electromechanical components . After producing the description of a physical system, the control systems engineer transforms th e physical system into a schematic diagram. The control system designer can begin with t he physical description, as contained in Figure 1.8( a), to derive a schematic. The engineer must make approximations about the system and neglect certain phenomena, or else the schematic will be unwieldy, making it difÔ¨Åcult to extract a useful mathematical model during the next phase of the analysis and design sequence. The designer starts with a simple schematic representation and, at subsequent phases of the analysis and design sequence, checks the assumptions made about the physical system through analysis and computer simulation. If the schematic istoo simple and does not adequately account for observed behavior, the control systemsengineer adds phenomena to the schematic that were previously assumed negligible. Aschematic diagram for the antenna azimuth position control system is shown inFigure 1.8( c). When we draw the potentiometers, we make our Ô¨Årst simplifying assumption by neglecting their friction or inertia. These mechanical characteristics yield a dynamic, rather than an instantaneous, response in the output voltage. We assume that these mechanical effects are negligible and that the voltage across a potentiometer changes instantaneously asthe potentiometer shaft turns. A differential ampli Ô¨Åer and a power ampli Ô¨Åer are used as the controller to yield gain and power ampli Ô¨Åcation, respectively, to drive the motor. Again, we assume that the dynamics of the ampli Ô¨Åers are rapid compared to the response time of the motor; thus, we model them as a pure gain, K. A dc motor and equivalent load produce the output angular displacement. The speed of the motor is proportional to the voltage applied to the motor ‚Äôsarmature circuit . Both inductance and resistance are part of the armature circuit. In showing just the armatureresistance in Figure 1.8( c), we assume the effect of the armature inductance is negligible for a dc motor. The designer makes further assumptions about the load. The load consists of a rotating mass and bearing friction. Thus, the model consists of inertia andviscous damping whose resistive torque increases with speed, as in an automobile ‚Äôs shock absorber or a screen door damper. The decisions made in developing the schematic stem from knowledge of the physical system, the physical laws governing the system ‚Äôs behavior, and practical experience . These decisions are not easy; however, as you acquire more design experience, you will gain theinsight required for this dif Ô¨Åcult task.1.5 The Design Process 15WEBC01 10/28/2014 14:10:29 Step 4: Develop a Mathematical Model (Block Diagram) Once the schematic is drawn, the designer uses physical laws, such as Kirchhoff ‚Äôs laws for electrical networks and Newton‚Äô s law for mechanical systems, along with simplifying assumptions, to model the system mathematically. These laws are Kirchhoff ‚Äôs and Newton‚Äô s laws lead to mathematical models that describe the relationship between the input and output of dynamic systems. One such model is the linear, time-invariant differential equation , Eq. (1.2): dmc t¬Ü dtn¬ádn 1dm 1c t¬Ü dtn 1¬á‚àô‚àô‚àô¬ád0c t¬Ü¬àbmdmr t¬Ü dtm¬ábm 1dm 1r t¬Ü dtm 1¬á‚àô‚àô‚àô¬áb0r t¬Ü 1.2¬Ü4 Many systems can be approximately described by this equation, which relates the output, c(t), to the input, r(t), by way of the system parameters, aiandbj. We assume the reader is familiar with differential equations. Problems and a bibliography are provided at the end of the chapter for you to review this subject. Simplifying assumptions made in the process of obtaining a mathematical model usually leads to a low-order form of Eq. (1.2). Without the assumptions the system model could be of high order or described with nonlinear, time-varying, or partial differentialequations. These equations complicate the design process and reduce the designer ‚Äôs insight. Of course, all assumptions must be checked and all simpli Ô¨Åcations justi Ô¨Åed through analysis or testing. If the assumptions for simpli Ô¨Åcation cannot be justi Ô¨Åed, then the model cannot be simpli Ô¨Åed. We examine some of these simplifying assumptions in Chapter 2. In addition to the differential equation, the transfer function is another way of mathematically modeling a system. The model is derived from the linear, time-invariantdifferential equation using what we call the Laplace transform . Although the transfer function can be used only for linear systems, it yields more intuitive information than thedifferential equation. We will be able to change system parameters and rapidly sense theeffect of these changes on the system response. The transfer function is also useful inmodeling the interconnection of subsystems by forming a block diagram similar toFigure 1.8( d) but with a mathematical function inside each block. Still another model is the state-space representation . One advantage of state-space methods is that they can also be used for systems that cannot be described by lineardifferential equations. Further, state-space methods are used to model systems forsimulation on the digital computer. Basically, this representation turns an nth-order differential equation into nsimultaneous Ô¨Årst-order differential equations. Let this description sufÔ¨Å ce for now; we describe this approach in more detail in Chapter 3.Kirchhoff's voltage law The sum of voltages around a closed path equals zero. Kirchhoff's current law The sum of electric currents Ô¨Çowing from a node equals zero. Newton's laws The sum of forces on a body equals zero;3the sum of moments on a body equals zero. 3Alternately,Pforces ¬àMa. In this text the force, Ma, will be brought to the left-hand side of the equation to yieldPforces ¬à0( D‚ÄôAlembert ‚Äôs principle). We can then have a consistent analogy between force and voltage, and Kirchhoff ‚Äôs and Newton ‚Äôs laws (that is,Pforces ¬à0;Pvoltages ¬à0). 4The right-hand side of Eq. (1.2) indicates differentiation of the input, r(t). In physical systems, differentiation of the input introduces noise. In Chapters 3 and 5 we show implementations and interpretations of Eq. (1.2) that do not require differentiation of the input.16 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:30 Finally, we should mention that to produce the mathematical model for a system, we require knowledge of the parameter values, such as equivalent resistance, inductance, mass, and damping, which is often not eas y to obtain. Analysis, measurements, or speci Ô¨Åcations from vendors are sources that the control systems engineer may use to obtain the parameters. Step 5: Reduce the Block Diagram Subsystem models are interconnected to form block diagrams of larger systems, as in Figure 1.8( d), where each block has a mathematical description. Notice that many signals, such as proportional voltage s and error, are internal to the system. There are also two signals ‚Äîangular input and angular output ‚Äîthat are external to the system. In order to evaluate system response in this example, we need to reduce this large system ‚Äôs block diagram to a single block with a mathematical description that represents the system from its input to its output, as shown inFigure 1.11. Once the block diagram is reduced, we are ready to analyze anddesign the system. Step 6: Analyze and Design The next phase of the process, following block diagram reduction, is analysis and design. Ifyou are interested only in the performance of an individual subsystem, you can skip theblock diagram reduction and move immediately into analysis and design. In this phase, theengineer analyzes the system to see if the response speci Ô¨Åcations and performance requirements can be met by simple adjustments of system parameters. If speci Ô¨Åcations cannot be met, the designer then designs additional hardware in order to effect a desiredperformance. Test input signals are used, both analytically and during testing, to verify the design. It is neither necessarily practical nor illuminating to choose complicated inputsignals to analyze a system‚Äô s performance. Thus, the engineer usually selects standard test inputs. These inputs are impulses, steps, ramps, parabolas, and sinusoids, as shown inTable 1.1. Animpulse is inÔ¨Ånite at t¬à0 and zero elsewhere. The area under the unit impulse is 1. An approximation of this type of waveform is used to place initial energy into a system sothat the response due to that initial energy is only the transient response of a system. Fromthis response the designer can derive a mathematical model of the system. Astepinput represents a constant command , such as position, velocity, or acceleration. Typically, the step input command is of the same form as the output. For example, if thesystem ‚Äôs output is position, as it is for the antenna azimuth position control system, the step input represents a desired position, and the output represents the actual position. If the system ‚Äôs output is velocity, as is the spindle speed for a video disc player, the step input represents a constant desired speed, and the output represents the actual speed. The designer uses step inputs because both the transient response and the steady-state response are clearly visible andcan be evaluated. The ramp input represents a linearly increasing command . For example, if the system ‚Äôs output is position, the input ramp represents a linearly increasing position, such as that found when tracking a satellite moving across the sky at constant speed. If the system ‚Äôs output is velocity, the input ramp represents a linearly increasing velocity. The response toan input ramp test signal yields additional information about the steady-state error. The previous discussion can be extended to parabolic inputs, which are also used to evaluate a system ‚Äôs steady-state error. Sinusoidal inputs can also be used to test a physical system to arrive at a mathematical model. We discuss the use of this waveform in detail in Chapters 10 and 11.Mathematical descriptionAngular outputAngular input FIGURE 1.11 Equivalent block diagram for the antenna azimuth position control system1.5 The Design Process 17WEBC01 10/28/2014 14:10:32 We conclude that one of the basic analysis and design requirements is to evaluate the time response of a system for a given input. Throughout the book you will learn numerous methods for accomplishing this goal. The control systems engineer must take into consideration other characteristics about feedback control systems. For example, control system behavior is altered by Ô¨Çuctuations in component values or system parameters. These variations can be caused by temperature, pressure, or other environmental changes. Systems must be built so thatexpected Ô¨Çuctuations do not degrade performance beyond speci Ô¨Åed bounds. A sensitivity analysis can yield the percentage of change in a speci Ô¨Åcation as a function of a change in a system parameter. One of the designer ‚Äôs goals, then, is to build a system with minimum sensitivity over an expected range of environmental changes. In this section we looked at some control systems analysis and design considerations. We saw that the designer is concerned about transient response, steady-state error, stability, and sensitivity. The text pointed out that although the basis of evaluating system performance is the differential equation, other methods, such as transfer functions and statespace, will be used. The advantages of these new techniques over differential equations willbecome apparent as we discuss them in later chapters.TABLE 1.1 Test waveforms used in control systems Input Function Description Sketch Use Impulse Œ¥ t¬Ü Œ¥ t¬Ü¬à‚àûfor 0  <t<0¬á ¬à0 elsewhere Z0¬á 0 Œ¥ t¬Üdt¬à1f(t) tŒ¥(t)Transient response Modeling Step u t¬Ü u t¬Ü¬à1 for t>0 ¬à0 for t<0f(t) tTransient responseSteady-state error Ramp tu t¬Ü tu t¬Ü¬àtfort0 ¬à0 elsewheref(t) tSteady-state error Parabola 1 2t2u t¬Ü12t 2u t¬Ü¬à12t 2fort0 ¬à0 elsewheref(t) tSteady-state error Sinusoid sin œât f(t) tTransient response ModelingSteady-state error18 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:32 1.6 Computer-Aided Design Now that we have discussed the analysis and design sequence, let us discuss the use of the computer as a computational tool in this sequence. The computer plays an important role inthe design of modern control systems. In the past, control system design was labor intensive.Many of the tools we use today were implemented through hand calculations or, at best,using plastic graphical aid tools. The process was slow, and the results not always accurate.Large mainframe computers were then used to simulate the designs. Today we are fortunate to have computers and software that remove the drudgery from the task. At our own desktop computers, we can perform analysis, design, andsimulation with one program. With the ability to simulate a design rapidly, we can easilymake changes and immediately test a new d esign. We can play what-if games and try alternate solutions to see if they yield bett er results, such as reduced sensitivity to parameter changes. We can include nonlinear ities and other effects and test our models for accuracy. MATLAB The computer is an integral part of modern control system design, and many computationaltools are available for your use. In this book we use MATLAB and the MATLAB ControlSystem Toolbox, which expands MATLAB to include control system‚Äì speciÔ¨Åc commands. In addition, presented are several MATLAB enhancements that give added functionality toMATLAB and the Control Systems Toolbox. Included are (1) Simulink, which uses agraphical user interface (GUI); (2) the LTI Viewer, which permits measurements to be madedirectly from time and frequency response curves; (3) the SISO Design Tool, a convenientand intuitive analysis and design tool; and (4) the Symbolic Math Toolbox, which saves labor when making symbolic calculations required in control system analysis and design. Some of these enhancements may require additional software available fromThe MathWorks, Inc. MATLAB is presented as an alternate method of solving control system problems. You are encouraged to solve problems Ô¨Årst by hand and then by MATLAB so that insight is not lost through mechanized use of computer programs. To this end, many examplesthroughout the book are solved by hand, followed by suggested use of MATLAB. As an enticement to begin using MATLAB, simple program statements that you can try are suggested throughout the chapters at appropriate locations. Throughout the book,various icons appear in the margin to identify MATLAB references that direct you to theproper program in the proper appendix and tell you what you will learn. Selected end-of-chapter problems and Case Study Challenges to be solved using MATLAB have also beenmarked with appropriate icons. The following list itemizes the speci Ô¨Åc components of MATLAB used in this book, the icon used to identify each, and the appendix in which adescription can be found: MATLAB/Control System Toolbox tutorials and code are found in Appendix B and identiÔ¨Å ed in the text with the MATLAB icon shown in the margin. Simulink tutorials and diagrams are found in Appendix C andidenti Ô¨Åed in the text with the Simulink icon shown in the margin. MATLAB GUI tools, tutorials, and examples are in Appendix E atwww.wiley.com/college/nise and identi Ô¨Åed in the text with the GUI Tool icon shown in the margin. These tools consist of the LTIViewer and the SISO Design Tool.1.6 Computer-Aided Design 19WEBC01 10/28/2014 14:10:33 Symbolic Math Toolbox tutorials and code are found in Appendix F atwww.wiley.com/college/nise and identi Ô¨Åed in the text with the Symbolic Math icon shown in the margin. MATLAB code itself is not platform speci Ô¨Åc. The same code runs on PCs and workstations that support MATLAB. Although there are differences in installing and managing MATLAB Ô¨Åles, we do not address them in this book. Also, there are many more commands in MATLAB and the MATLAB toolboxes than are covered in the appendixes. Pleaseexplore the bibliographies at the end of the applicable appendixes to Ô¨Ånd out more about MATLAB Ô¨Åle management and MATLAB instructions not covered in this textbook. LabVIEW LabVIEW is a programming environment presented as an alternative to MATLAB. This graphical alternative produces front panels of virtual instruments on your computer that are pictorial reproductions of hardware instruments, such as waveform generators oroscilloscopes. Underlying the front panels are block diagrams. The blocks containunderlying code for the controls and indicators on the front panel. Thus, a knowledge ofcoding is not required. Also, parameters can be easily passed or viewed from the front panel. A LabVIEW tutorial is in Appendix D and all LabVIEW material is identiÔ¨Å ed with the LabVIEW icon shown in the margin. You are encouraged to use computational aids throughout this book. Those not using MATLAB or LabVIEW should consult Appendix H at www.wiley.com/college/nise for a discussion of other alternatives. Now that we have introduced control systems to you and established a need for computational aids to perform analysis and design, we will concludewith a discussion of your career as a control systems engineer and look at the opportunitiesand challenges that await you. 1.7 The Control Systems Engineer Control systems engineering is an exciting Ô¨Åeld in which to apply your engineering talents, because it cuts across numerous disciplines and numerous functions within thosedisciplines. The control engineer can be found at the top level of large projects, engaged atthe conceptual phase in determining or implementing overall system requirements. Theserequirements include total system performance speci Ô¨Åcations, subsystem functions, and the interconnection of these functions, including interface requirements, hardware andsoftware design, and test plans and procedures. Many engineers are engaged in only one area, such as circuit design or software development. However, as a control systems engineer, you may Ô¨Ånd yourself working in a broad arena and interacting with people from numerous branches of engineering and thesciences. For example, if you are working on a biological system, you will need to interactwith colleagues in the biological sciences, mechanical engineering, electrical engineering,and computer engineering, not to mention mathematics and physics. You will be workingwith these engineers at all levels of project development from concept through design and,Ô¨Ånally, testing. At the design level, the control systems engineer can be performinghardware selection, design, and interface, including total subsystem design to meet speci Ô¨Åed requirements. The control engineer can be working with sensors and motors as well as electronic, pneumatic, and hydraulic circuits. The space shuttle provides another example of the diversity required of the systems engineer. In the previous section, we showed that the space shuttle ‚Äôs control systems cut across many branches of science: orbital mechanics and propulsion, aerodynamics,20 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:33 electrical engineering, and mechanical engineering. Whether or not you work in the space program, as a control systems engineer you will apply broad-based knowledge to the solution of engineering control problems. You will have the opportunity to expand yourengineering horizons beyond your university curriculum. You are now aware of future opportunities. But for now, what advantages does this course offer to a student of control systems (other than the fact that you need it to graduate)?Engineering curricula tend to emphasize bottom-up design. That is, you start from the components, develop circuits, and then assemble a product. In top-down design, a high-level picture of the requirements is Ô¨Årst formulated; then the functions and hardware required to implement the system are determined. You will be able to take a top-down systems approachas a result of this course. A major reason for not teaching top-down design throughout the curriculum is the high level of mathematics initially required for the systems approach. For example, controlsystems theory, which requires differential equations, could not be taught as a lower-divisioncourse. However, while progressing through bottom-up design courses, it is dif Ô¨Åcult to see how such design Ô¨Åts logically into the large picture of the product development cycle. After completing this control systems course, you will be able to stand back and see how your previous studies Ô¨Åt into the large picture. Your ampli Ô¨Åer course or vibrations course will take on new meaning as you begin to see the role design work plays as part ofproduct development. For example, as engineers, we want to describe the physical worldmathematically so that we can create systems that will bene Ô¨Åt humanity. You will Ô¨Ånd that you have indeed acquired, through your previous courses, the ability to model physicalsystems mathematically, although at the time you might not have understood where in theproduct development cycle the modeling Ô¨Åts. This course will clarify the analysis and design procedures and show you how the knowledge you acquired Ô¨Åts into the total picture of system design. Understanding control systems enables students from all branches of engineering to speak a common language and develop an appreciation and working knowledge of the otherbranches. You will Ô¨Ånd that there really is not much difference among the branches of engineering as far as the goals and applications are concerned. As you study controlsystems, you will see this commonality. Summary Control systems contribute to every aspect of modern society. In our homes we Ô¨Ånd them in everything from toasters to heating systems to DVD players. Control systems also havewidespread applications in science and industry, from steering ships and planes to guidingmissiles. Control systems also exist naturally; our bodies contain numerous control systems.Even economic and psychological system representations have been proposed based oncontrol system theory. Control systems are used where power gain, remote control, orconversion of the form of the input is required. A control system has an input ,aprocess , and an output . Control systems can be open loop orclosed loop . Open-loop systems do not monitor or correct the output for disturbances; however, they are simpler and less expensive than closed-loop systems.Closed-loop systems monitor the output and compare it to the input. If an error is detected,the system corrects the output and hence corrects the effects of disturbances. Control systems analysis and design focuses on three primary objectives: 1.Producing the desired transient response 2.Reducing steady-state errors 3.Achieving stabilitySummary 21WEBC01 10/28/2014 14:10:33 A system must be stable in order to produce the proper transient and steady-state response. Transient response is important because it affects the speed of the system and inÔ¨Çuences human patience and comfort, not to mention mechanical stress. Steady-state response determines the accuracy of the control system; it governs how closely the outputmatches the desired response. The design of a control system follows these steps: Step 1 Determine a physical system and speci Ô¨Åcations from requirements. Step 2 Draw a functional block diagram. Step 3 Represent the physical system as a schematic. Step 4 Use the schematic to obtain a mathematical model, such as a block diagram. Step 5 Reduce the block diagram. Step 6 Analyze and design the system to meet speci Ô¨Åed requirements and speci Ô¨Åca- tions that include stability, transient response, and steady-state performance. In the next chapter we continue through the analysis and design sequence and learn how touse the schematic to obtain a mathematical model. Review Questions 1.Name three applications for feedback control systems. 2.Name three reasons for using feedback control systems and at least one reason for notusing them. 3.Give three examples of open-loop systems. 4.Functionally, how do closed-loop systems differ from open-loop systems? 5.State one condition under which the error signal of a feedback control system wouldnot be the difference between the input and the output. 6.If the error signal is not the difference between input and output, by what general namecan we describe the error signal? 7.Name two advantages of having a computer in the loop. 8.Name the three major design criteria for control systems. 9.Name the two parts of a system ‚Äôs response. 10.Physically, what happens to a system that is unstable? 11.Instability is attributable to what part of the total response? 12.Describe a typical control system analysis task. 13.Describe a typical control system design task. 14.Adjustments of the forward path gain can cause changes in the transient response.True or false? 15.Name three approaches to the mathematical modeling of control systems. 16.BrieÔ¨Çy describe each of your answers to Question 15. Problems 1.A variable resistor, called a potentiometer ,i ss h o w n in Figure P1.1. The resistance is varied by moving awiper arm along a Ô¨Åxed resistance. The resistance from AtoCisÔ¨Åxed, but the resistance from BtoC varies with the position of the wiper arm. If it takes 10turns to move the wiper arm from AtoC,d r a wa block diagram of the potentiometer showing the inputvariable, the output variable, and (inside the block)the gain, which is a constant and is the amountby which the input is multiplied to obtain the output.An animation PowerPoint presentation (PPT)demonstrating this system i s available for instructors atwww.wiley.com/college/nise .S e e Potentiometer . [Section 1.4: Introduction to a Case Study]22 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:33 ‚Äì+50 voltsŒ∏i(t) Input angle, Output voltage, v o(t)A C 50 voltsB FIGURE P1.1 Potentiometer 2.A temperature control system operates by sensing the difference between the thermostat setting and the actualtemperature and then opening a fuel valve an amount proportional to this difference. Draw a functional closed- loop block diagram similar to Figure 1.8( d) identifying the input and output transducers, the controller, and theplant. Further, identify the input and output signals of allsubsystems previously described. [Section 1.4: Introduc-tion to a Case Study] 3.An aircraft ‚Äôs attitude varies in roll, pitch, and yaw as deÔ¨Åned in Figure P1.2. Draw a functional block diagram for a closed-loop system that stabilizes the roll as follows:The system measures the actual roll angle with a gyro andcompares the actual roll angle with the desired roll angle.Theaileronsrespondtotheroll-angleerrorbyundergoinganangularde Ô¨Çection.Theaircraftrespondstothisangular deÔ¨Çection, producing a roll angle rate. Identify the input and output transducers, the controller, and the plant.Further, identify the nature of each signal. [Section 1.4:Introduction to a Case Study] Roll anglePitch angle Aileron deflection up Yaw angley zxAileron deflection down FIGURE P1.2 Aircraft attitude de Ô¨Åned 4.We can build a control system that will automaticallyadjustamotorcycle ‚Äôsradiovolumeasthenoisegenerated by the motorcycle changes. The noise generated by themotorcycle increases with speed. As the noise increases, the system increases the volume of the radio. Assume that the amount of noise can be represented by a voltagegenerated by the speedometer cable, and the volume of the radio is controlled by a dc voltage ( Hogan ,1988 ). If the dc voltage represents the desired volume disturbed by the motorcycle noise, draw the functional block diagramof the automatic volume control system, showing theinput transducer, the volume control circuit, and thespeed transducer as blocks. Also, show the followingsignals: the desired volume as an input, the actual volumeas an output, and voltages representing speed, desired volume, and actual volume. An animation PowerPoint presentation (PPT) demonstrating this system is availablefor instructors at www.wiley.com/college/nise . See Motorcycle . [Section 1.4: Introduction to a Case Study] 5.A dynamometer is a device used to measure torque and speed and to vary the load on rotating devices. The dynamometer operates as follows to control the amountoftorque:Ahydraulicactuatorattachedtotheaxlepressesa tire againsta rotating Ô¨Çywheel. The greater the displace- ment of the actuator, the greater the force that is applied tothe rotating Ô¨Çywheel. A strain gage load cell senses the force.Thedisplacementoftheactuatoriscontrolledbyanelectrically operated valve whose displacement regulates Ô¨ÇuidÔ¨Çowing into the actuator ( D‚ÄôSouza ,1988 ). Draw a functional block diagram of a closed-loop system that uses the described dynamometer to regulate the forceagainst the tire during testing. Show all signals andsystems. Include ampli Ô¨Åers that power the valve, the valve, the actuator and load, and the tire. [Section 1.4:Introduction to a Case Study] 6.During a medical operation an anesthesiologist controlsthe depth of unconsciousness by controlling the concen-tration of iso Ô¨Çurane in a vaporized mixture with oxygen and nitrous oxide. The depth of anesthesia is measured bythe patient ‚Äôs blood pressure. The anesthesiologist also regulates ventilation, Ô¨Çuid balance, and the administra- tion of other drugs. In order to free the anesthesiologist to devote more time to the latter tasks, and in the interest of the patient ‚Äôs safety, we wish to automate the depth of anesthesia by automating the control of iso Ô¨Çurane con- centration.Drawafunctionalblockdiagramofthesystemshowing pertinent signals and subsystems ( Meier ,1992 ). [Section 1.4: Introduction to a Case Study] 7.The vertical position, x(t), of a grinding wheel is controlled by a closed-loop system. The input to the system is thedesired depth of grind, and the output is the actual depth ofgrind. The difference between the desired depth and theactual depth drives the motor, resulting in a force appliedto the work. This force results in a feed velocity for thegrinding wheel (Jenkins, 1997 ). Draw a closed-loop functional block diagram for the grinding process, showing the input, output, force, and grinder feed rate. [Section 1.4: Introduction to a Case Study]Problems 23WEBC01 10/28/2014 14:10:33 8.You are given a high-speed proportional solenoid valve. A voltage proportional to the desired position of the spool is applied to the coil. The resulting magnetic Ô¨Åeld pro- duced by the current in the coil causes the armature tomove. A push pin connected to the armature moves thespool. A linear voltage differential transformer (LVDT)thatoutputsavoltageproportionaltodisplacementsensesthe spool ‚Äôs position. This voltage can be used in a feed- back path to implement closed-loop operation ( Vaughan , 1996 ). Draw a functional block diagram of the valve, showing input and output positions, coil voltage, coilcurrent, and spool force. [Section 1.4: Introduction to aCase Study] 9.The human eye has a biological control system that varies the pupil diameter to maintain constant light intensity to the retina. As the light intensity increases, the optical nervesends a signal to the brain, which commands internal eyemuscles to decrease the pupil ‚Äôs eye diameter. When the light intensity decreases, the pupil diameter increases. a.Draw a functional block diagram of the light-pupilsystem indicating the input, output, and intermediatesignals; the sensor; the controller; and the actuator.[Section 1.4: Introduction to a Case Study] b.Under normal conditions the incident light will belarger than the pupil. If the incident light is smaller than the diameter of the pupil, the feedback path is broken ( Bechhoefer ,2005). Modify your block diagram from Part a.to show where the loop is broken. What will happen if the narrow beam of light varies in intensity,such as in a sinusoidal fashion? c.It has been found ( Bechhoefer ,2005 ) that it takes the pupil about 300 milliseconds to react to a change in theincident light. If light shines off center to the retina,describe the response of the pupil with delay present and then without delay present. 10.A Segway ÓÄÑ5Personal Transporter (PT) (Figure P1.3) is a two-wheeled vehicle in which the human operator stands vertically on a platform. As the driver leans left, right,forward, or backward, a set of sensitive gyroscopicsensors sense the desired input. These signals are fed to a computer that ampli Ô¨Åes them and commands motors to propel the vehicle in the desired direction. One very important feature of the PT is its safety: The systemwill maintain its vertical position within a speci Ô¨Åed angle despite road disturbances, such as uphills and downhillsor even if the operator over-leans in any direction. Draw afunctional block diagram of the PT system that keepsthe system in a vertical position. Indicate the input and output signals, intermediate signals, and main subsys- tems. ( http://segway.com ) D.A. Winstein/Custom Medial Stock photo FIGURE P1.3 The Segway Personal Transporter (PT) 11.In humans, hormone levels, alertness, and core bodytemperature are synchronized through a 24-hourcircadian cycle. Daytime alertness is at its best whensleep/wake cycles are in sync with the circadian cycle.Thus alertness can be easily affected with a distributedwork schedule, such as the one to which astronauts are subjected. It has been shown that the human circadian cycle can be delayed or advanced through light stimulus.To ensure optimal alertness, a system is designed to trackastronauts ‚Äôcircadian cycles and increase the quality of sleepduringmissions.Corebodytemperaturecanbeusedas an indicator of the circadian cycle. A computer modelwith optimum circadian body temperature variations canbe compared to an astronaut ‚Äôs body temperatures. Whenever a difference is detected, the astronaut is sub-jected to a light stimulus to advance or delay the astro-naut‚Äôs circadian cycle ( Mott,2003 ). Draw a functional blockdiagramofthesystem.Indicatetheinputandoutputsignals, intermediate signals, and main subsystems. 12.Tactile feedback is an important component in the learning of motor skills such as dancing, sports, and physical rehabilitation. A suit with white dots recognizedby a vision system to determine arm joint positions withmillimetric precision was developed. This suit is worn byboth teacher and student to provide position information.(Lieberman, 2007 ). If there is a difference between the teacher ‚Äôs positions and that of the student, vibrational feedback is provided to the student through eight strategically placed vibrotactile actuators in the wrist and arm. This placement takes advantage of a sensoryeffect known as cutaneous rabbit that tricks the subject to feel uniformly spaced stimuli in places where the 5Segway is a registered trademark of Segway, Inc. in the United States and/ or other countries.24 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:34 actuators are not present. These stimuli help the student adjust to correct the motion. In summary, the system consists of an instructor and a student having theirmovements followed by the vision system. Their move-ments are fed into a computer that Ô¨Ånds the differences between their joint positions and provides proportionalvibrationalstrengthfeedback tothestudent.Drawablockdiagram describing the system design. 13.Some skillful drivers can drive and balance a four-wheeled vehicle on two wheels. To verify that a controlsystem can also drive a car in this fashion, a prototypeusing an RC (remote-controlled) car is equipped with afeedback control system ( Arndt ,2011 ). In a simpli Ô¨Åed systemmodel,theroll angle atwhich the carbalanceswas calculated a priori and found to be 52.3 ¬∞. This value was used as the desired input. The desired input is compared with the actual roll angle and the difference is fed to acontroller that feeds a servomotor indicating the desiredwheel steering angle that controls the vehicle ‚Äôs roll angle on two wheels. The car ‚Äôs actual roll angle is measured using a hinged linkage that rolls along the ground next tothe vehicle and is connected to a potentiometer. Draw a block diagram indicating the system functions. Draw blocks for the system controller, the steering servo, andthe car dynamics. Indicate in the diagram the followingsignals: the desired roll angle, the steering wheel angle,and the actual car roll angle. 14.Moored Ô¨Çoating platforms are subject to external disturbances such as waves, wind, and currents thatcause them to drift. There are certain applications,such as diving support, drilling pipe-laying, and tank-ing between ships in which precise positioning ofmoored platforms is very important ( Mu√±oz-Mansilla , 2011). Figure P1.4 illustrates a tethered platform inwhich side thrusters are used for positioning. A controlsystem is to be designed in which the objective is to minimize the drift, Y, and an angular deviation from the vertical axes, œï(not shown). The disturbances acting on the system ‚Äôs outputs are the force, F, and the torque, M, caused by the external environment. In thisproblem, the plant will have one input, the forced e l i v e r e db yt h et h r u s t e r s( F u) and two outputs, Y andœï. Note also that this is a disturbance attenuation problem, so there is no command input. Draw a block diagram of the system indicating the disturbances F and M, the control signal F u, and the outputs Y and œï. Your diagram should also have blocks for a controller,the one-input two-output plant, and a block indicatinghow the disturbances affect each of the outputs. 15.In the Case Study of Section 1.4, an antenna azimuth angleis controlled, and its corresponding block diagram is shownin Figure 1.8( d) in the text. There, the sensor used to measure the antenna ‚Äôs azimuth angle is a potentiometer. a.Modifytheblockdiagramifthesensorusedtomeasurethe antenna ‚Äôs angle is an accelerometer. b.Modifytheblockdiagramifthesensorusedtomeasurethe antenna ‚Äôs angle is a gyroscope. 16.Figure P1.5 shows the topology of a photo-voltaic (PV) system that uses solar cells to supply electrical power to a residence with hybrid electric vehicle loads ( Gurkavnak , 2009). The system consists of a PV array to collect the sun ‚Äôs rays, a battery pack to store energy during the day, a dc/ac inverter to supply ac power to the load, and a bidirectionaldc/dc converter to control the terminal voltage of the solararray according to a maximum power point tracking(MPPT) algorithm. In case of sufÔ¨Å cient solar power (solar insolation), the dc/dc converter charges the battery and thesolar array supplies power to the load through the dc/acinverter. With less or no solar energy (solar non-insolation),power is supplied from the battery to the load through thedc/dc converter and the dc/ac inverter. Thus, the dc/dcconverter must be bidirectional to be able to charge anddischarge the battery. With the MPPT controller providingthe reference voltage, the converter operates as a step-up converter (boost) to discharg e the battery if the battery is full or a step-down (buck) converter, which charges the battery if it is not full. 7 In Figure P1.5, the Inverter is controlled by the Power Manager and Controller through the CurrentController. The Power Manager and Controller directsthe Inverter to take power either from the battery,via the Bidirectional Converter, or the solar array, depending upon the time of day and the battery statesea levelY F sea floorthrusters FIGURE P1.4 Tethered platform using side thrusters for positioning6 6Mu√±oz-Mansilla, R., Aranda, J., Diaz, J. M., Chaos, D., and Reinoso, A. J., Applications of QFT Robust Control Techniques to Marine Systems. 9th IEEE International Conference on Control and Automation . December 19‚Äì21, 2011, pp. 378 ‚Äì385. (Figure 3, p. 382).7For a description of all other operational scenarios, refer to the above-listed reference.Problems 25WEBC01 10/28/2014 14:10:34 of charge (SOC). Draw the following two functional block diagrams for this system: a.A diagram that illustrates the conversion of solar irradiation into energy stored in the battery. In that diagram, the input is the solar irradiance, r(t), and the output is the battery voltage, vb(t). b.The main diagram, in which the input is the desiredoutput voltage, v r(t), and the output is the actual inverter output voltage, vo(t). Both of these functional block diagrams should show their major components, including the PV array,MPPT controller, dc/dc converter, battery pack, dc/acinverter, current controller, and the Power Manager andController. Show all signals, including intermediatevoltages and currents, time of day, and the SOC ofthe battery. 17.Oil drilling rigs are used for drilling holes for identi Ô¨Å- cation of oil or natural gas sources and for extraction.An oil drilling system can be thought of as a drillinside a straw, which is placed inside a glass. The straw assembly represents t he drill string, the drill surrounded by Ô¨Çuid, and the glass represents the volume, the annulus, around the drill string through which slurry and eventually oil will Ô¨Çow as the drilling progresses. Assume that we want to control the drill pres- sure output, P d(t), with a reference voltage input, Vd(t). A control loop model ( Zhao, 2007) consists of a drill-pressure controller, drill motor subsystem,pulley subsystem, and drill stick subsystem. Theoutput signal of the latter, the drill pressure, P d(t), is measured using a transducer, which transmits anegative feedback voltage signal, V b(t), to the drill pressure controller. That signal is compared at theinput of the controller to the reference voltage, V r(t), Based on the error, e(t)=Vr(t)‚ÄìVb(t), the drill pressure controller sets the desired drill speed, œâd, which is the input to the drill motor subsystem whoseoutput is the actual drill speed, œâ a, which is the input to the pulley subsystem. The output of the pulleysystem drives the drill stick subsystem. The drill stickHEV BD Converter Controller GD Bidirectional ConverterSOC TimePower Manager and ControllerCurrent ControllerIPV LP CcVcVo VuIoLo Iu IL Ib IO IL I* uVcIb VbIPVVPVVPV VPV*Q1 Q4 Q5 Q6Q3 Q2 GInverterPlug-in HEV ACLOADMPPT+ + ‚Äì++ ‚Äì‚Äì+ ‚Äì ‚Äì + FIGURE P1.5 Proposed solar powered residential home with plug-in hybrid electric vehicle (PHEV) loads8 8Gurkaynak, Y., Li, Z., and Khaligh, A. A Novel Grid-tied, Solar Powered Residential Home with Plug-in Hybrid Electric Vehicle (PHEV) Loads. IEEE Vehicle Power and Propulsion Conference 2009 , pp. 813 ‚Äì816. (Figure 1, p. 814).26 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:34 subsystem may be severely affected by environmental conditions, which may be represented as disturbances acting between the pulley and stick subsystems. Draw a functional block diagram for the above system, showing its major components as well as allsignals. 18.Given the electric network shown in Figure P1.6.[Review] a.Write the differential equation for the network ifv t¬Ü¬àu t¬Ü, a unit step. b.Solve the differential equation for the current, i(t), if there is no initial energy in the network. c.Make a plot of your solution if R=L¬à1. R L v(t) i(t)+‚Äì FIGURE P1.6 RLnetwork 19.Repeat Problem 18 using the network shown inFigure P1.7. Assume R¬à1Œ©;L¬à0:5H;and1=LC¬à16. [Review] R Cv(t) i(t)L +‚Äì FIGURE P1.7 RLC network 20.Solve the following differential equations using clas-sical methods. Assume zero initial conditions.[Review] a. dx dt¬á7x¬à5 cos 2 t b.d2x dt2¬á6dx dt¬á8x¬à5 sin 3 t c.d2x dt2¬á8dx dt¬á25x¬à10u t¬Ü 21.Solve the following differential equations usingclassical methods and the given initial conditions:[Review]a. d2x dt2¬á2dx dt¬á2x¬àsin2t x 0¬Ü¬à2;dx dt 0¬Ü¬à  3 b.d2x dt2¬á2dx dt¬áx¬à5e 2t¬át x 0¬Ü¬à2;dx dt 0¬Ü¬à1 c.d2x dt2¬á4x¬àt2 x 0¬Ü¬à1;dx dt 0¬Ü¬à2 PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 22.Contol of HIV/AIDS. As of 2012, the number of people living worldwide with Human Immunode Ô¨Åciency Virus/Acquired Immune De Ô¨Åciency Syndrome (HIV/ AIDS) was estimated at 35 million, with 2.3 million new infections per year and 1.6 million deaths due to t h ed i s e a s e( UNAIDS ,2013). Currently there is no known cure for the disease, and HIV cannot be com- pletely eliminated in an infected individual. Drugcombinations can be used to maintain the virus num-bers at low levels, which helps prevent AIDS fromdeveloping. A common treatment for HIV is the admin-istration of two types of drugs: reverse transcriptaseinhibitors (RTIs) and protease inhibitors (PIs). The amount in which each of these drugs is administered is varied according to the amount of HIV viruses in thebody ( Craig ,2004). Draw a block diagram of a feed- back system designed to control the amount of HIVviruses in an infected person. The plant input variablesare the amount of RTIs and PIs dispensed. Show blocksrepresenting the controller, the system under control,and the transducers. Label the corresponding variables at the input and output of every block. 23.Hybrid vehicle. The use of hybrid cars is becoming increasingly popular. A hybrid electric vehicle (HEV) combines electric machine(s) with an internal com-bustion engine (ICE), making it possible (along withother fuel consumption ‚Äìreducing measures, such as stopping the ICE at traf Ô¨Åc lights) to use smaller and more ef Ô¨Åcient gasoline engines. Thus, the ef Ô¨Åciency advantages of the electric drivetrain are obtained,while the energy needed to power the electric motoris stored in the onboard fuel tank and not in a largeand heavy battery pack. There are various ways to arrange the Ô¨Çow of power in a hybrid car. In a serial HEV (Figure P1.8),Problems 27WEBC01 10/28/2014 14:10:34 the ICE is not connected to the drive shaft. It drives only the generator, which charges the batteries and/orsupplies power to the electric motor(s) through aninverter or a converter. The HEVs sold today are primarily of the parallel or split-power variety. If the combustion engine canturn the drive wheels as well as the generator, then thevehicle is referred to as a parallel hybrid, because both an electric motor and the ICE can drive the vehicle. Aparallel hybrid car (Figure P1.9) includes a relativelysmall battery pack (electrical storage) to put out extrapower to the electric motor when fast acceleration is needed. See ( Bosch ,5th ed., 2000 ), (Bosch ,7th ed., 2007 ), (Edelson ,2008 ), (Anderson ,2009 ) for more detailed information about HEV. As shown in Figure P1.10, split-power hybrid cars utilize a combination of series and parallel drives (Bosch ,5th ed., 2007 ). These cars use a planetary gear (3) as a split-power transmission to allow someof the ICE power to be applied mechanically to the drive. The other part is converted into electrical energy through the alternator (7) and the inverter (5) to feed theelectric motor (downstream of the transmission) and/orto charge the high-voltage battery (6). Depending upondriving conditions, the ICE, the electric motor, or bothpropel the vehicle. Draw a functional block diagram for the cruise (speed) control system of: a.A serial hybrid vehicle, showing its major compo-nents, including the speed sensor, electronic controlunit (ECU), inverter, electric motor, and vehicledynamics; as well as all signals, including the desiredvehicle speed, actual speed, control command (ECUoutput), controlled voltage (inverter output), themotive force (provided by the electric motor), andrunning resistive force; 12 b.A parallel hybrid vehicle, showing its major compo- nents, which should include also a block that represents the accelerator, engine, and motor, as well as the signals(including accelerator displacement and combinedengine/motor motive force); c.A split-power HEV, showing its major componentsand signals, including, in addition to those listedin Parts aandb, a block representing the planetary gear and its control, which, depending upondriving conditions, would allow the ICE, the elec- tric motor, or both to propel the vehicle, that is, to provide the necessary total motive force.Fuel tank Electrical storageGeneratorCombustion engine Electric motor/generator FIGURE P1.8 Serial hybrid-electric vehicle912 +‚Äì1 . internal-combustion engine; 2. tank3. planet ar y gear; 4. electric motor; 5. inverter; battery; 7 . alternator. 7 6534 FIGURE P1.10 Split-power hybrid electric vehicle11 Fuel tank Electrical storageCombustion engine Electric motor/generator FIGURE P1.9 Parallel hybrid drive10 9Mark Looper, www.Altfuels.org. Alternative Drivetrains, July 2005, http://www.altfuels.org/backgrnd/altdrive.html. Last accessed 10/13/2009. 10Mark Looper, www.Altfuels.org. Alternative Drivetrains, July 2005, http://www.altfuels.org/backgrnd/altdrive.html. Last accessed 10/13/2009.11Robert Bosch GmbH, Bosch Automotive Handbook, 7th ed. John Wiley & Sons, Ltd., UK, 2007. 12These include the aerodynamic drag, rolling resistance, and climbing resistance. The aerodynamic drag is a function of car speed, whereas the other two are proportional to car weight.28 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:35 24.Parabolic trough collector. A set of parabolic mirrors can be used to concentrate the sun‚Äô sr a y st oh e a ta Ô¨ÇuidÔ¨Çowing in a pipe positioned at the mirrors ‚Äôfocal points ( Camacho ,2012). The heated Ô¨Çuid, such as oil, for example, is transported to a pressurized tank to be used to create steam to generate electricity or power an industrial process. Since the solar energy varieswith time of day, time of year, cloudiness, humidity,etc., a control system has to be developed in order tomaintain the Ô¨Çuid temperature constant. The temper- ature is mainly controlled by varying the amount ofÔ¨ÇuidÔ¨Çow through the pipes, but possibly also with asolar tracking mechanism that tilts the mirrors at appropriate angles. Assuming Ô¨Åxed mirror angles, draw the func- tional block diagram of a system to maintain the Ô¨Çuid temperature a constant. The desired and actual Ô¨Çuid temperature difference is fed to a controller followed by an ampliÔ¨Å er and signal conditioning circuit that varies the speed of a Ô¨Çuid circulating pump. Label the blocks and links of your diagram, indicating all the inputs to the system, including external disturbances such as solar variations, cloud-iness, humidity, etc. Cyber Exploration Laboratory Experiment 1.1 Objective To verify the behavior of closed-loop systems as described in the Chapter 1 Case Study. Minimum Required Software Packages LabVIEW and the LabVIEW Control Design and Simulation Module. Note: While no knowledge of LabVIEW is required for this experiment, see Appendix D to learn more about LabVIEW, which will be pursued in more detail in later chapters. Prelab 1.From the discussion in the Case Study, describe the effect of the gain of a closed-loopsystem upon transient response. 2.From the discussion in the Case Study about steady-state error, sketch a graph of a stepinput superimposed with a step response output and show the steady-state error. Assumeany transient response. Repeat for a ramp input and ramp output response. Describe theeffect of gain upon the steady-state error. Lab 1.Launch LabVIEW and open Find Examples . . . under the Help tab. 2.In the NI Example Finder window, open CDEx Effect of Controller Type.vi, found by navigating to it thourgh Toolkits and Modules/Control and Simulation/Control Design/Time Analysis/CDEx Effect of Controller Type vi. 3.On the tool bar click the circulating arrows located next to the solid arrow on the left. Theprogram is now running. 4.Move the slider Controller Gain and note the effect of high and low gains. 5.Change the controller by clicking the arrows for Controller Type and repeat Step 4. Postlab 1.Correlate the responses found in the experiment with those described in your Prelab.Explore other examples provided in the LabVIEW example folders.Cyber Exploration Laboratory 29C01 10/31/2014 10:23:46 Bibliography Alternative Drivetrains, July 2005. Available at www.altfuels.org/backgrnd/altdrive.html. Accessed October 13, 2009. Anderson, S. Field Guide: Hybrid Electric Powertrains, Part 4 of 5. Automotive Design & Production . Gardner Publication, Inc. Av ailable at http://www.auto Ô¨Åeldguide.com/articles/020904.html. Accessed October 13, 2009. Arndt, D., Bobrow, J. E., Peters, S., Iagnemma, K., and Dubowsky, S. Two-Wheel Self-Balancing of a Four-wheel Vehicle. IEEE Control Systems Magazine, April 2011, pp. 20 ‚Äì37. Bahill, A. T. Bioengineering: Biomedical, Medical, and Clinical Engineering . Prentice Hall, Englewood Cliffs, NJ, 1981. Bechhoefer, J. Feedback for Physicists: A Tutorial Essay on Control. To Appear in Review of Modern Physics , July 2005, pp. 42 ‚Äì45. Also available at http://www.sfu.ca/chaos/papers/2005/ rmp_reprint05.pdf. Bennett, S. A History of Control Engineering, 1800 ‚Äì1930 . Peter Peregrinus, Stevenage, UK, 1979. Bode, H. W. Network Analysis and Feedback Ampli Ô¨Åer Design . Van Nostrand, Princeton, NJ, 1945. Bosch, R. GmbH. Automotive Electrics and Automotive Electronics, 5th ed. John Wiley & Sons Ltd., UK, 2007. Bosch, R. GmbH. Bosch Automotive Handbook , 7th ed. John Wiley & Sons Ltd., UK, 2007. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems , Springer-Verlag, London, 2012. Cannon, R. H., Jr. Dynamics of Physical Systems . McGraw-Hill, New York, 1967. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. D‚ÄôAzzo, J. J., and Houpis, C. H. Feedback Control System Analysis and Synthesis ,2 de d . McGraw-Hill, New York, 1966. Doebelin, E. O. Measurement Systems Application and Design , 4th ed. McGraw-Hill, New York, Dorf, R. C. Modern Control Systems , 5th ed. Addison-Wesley, Reading, MA, 1989. D‚ÄôSouza, A. F. Design of Control Systems . Prentice Hall, Upper Saddle River, NJ, 1988. Edelson, J., et al. Facing the Challenges of the Current Hybrid Electric Drivetrain. SMMA Technical Conference of the Motor and Motion Association. Fall 2008. Available at www.ChorusCars.com. Franklin, G. F., Powell, J. D., and Emami-Naeini, A. Feedback Control of Dynamic Systems . Addison- Wesley, Reading, MA, 1986. Gurkaynak, Y., Li, Z., and Khaligh, A. A Novel Grid-tied, Solar Powered Residential Home with Plug-in Hybrid Electric Vehicle (PHEV) Loads. IEEE Vehicle Power and Propulsion Conference 2009, pp. 813 ‚Äì816. Heller, H. C., Crawshaw, L. I., and Hammel, H. T. The Thermostat of Vertebrate Animals . Scienti Ô¨Åc American, August 1978, pp. 102 ‚Äì113. Hogan, B. J. As Motorcycle ‚Äôs Speed Changes, Circuit Adjusts Radio ‚Äôs Volume . Design News , 18, August 1988, pp. 118 ‚Äì119. Hostetter, G. H., Savant, C. J., Jr., and Stefani, R. T. Design of Feedback Control Systems , 2d ed. Saunders College Publishing, New York, 1989. Jenkins, H. E., Kurfess, T. R., and Ludwick, S. J. Determination of a Dynamic Grinding Model. Journal of Dynamic Systems, Measurements, and Control , vol. 119, June 1997, pp. 289 ‚Äì293. Klapper, J., and Frankle, J. T. Phase-Locked and Frequency-Feedback Systems . Academic Press, New York, 1972. Lieberman, J., and Breazeal, C. Development of a Wearable Vibrotactile Feedback Suit for Accelerated Human Motor Learning. 2007 IEEE Int. Conf. on Robotics and Automation. Roma, Italy, April 2007.30 Chapter 1 IntroductionWEBC01 10/28/2014 14:10:35 Martin, R. H., Jr. Elementary Differential Equations with Boundary Value Problems. McGraw-Hill, New York, 1984. Mayr, O. The Origins of Feedback Control . Scienti Ô¨Åc American, October 1970, pp. 110 ‚Äì118. Mayr, O. The Origins of Feedback Control . MIT Press, Cambridge, MA, 1970. Meier, R., Nieuwland, J., Zbinden, A. M., and Hacisalihzade, S. S. Fuzzy Logic Control of Blood Pressure during Anesthesia . IEEE Control Systems , December 1992, pp. 12 ‚Äì17. Mott, C., et al. Modifying the Human Circadian Pacemaker Using Model-Based Predictive Control . Proceedings of the American Control Conference. Denver, CO, June 2003, pp. 453 ‚Äì458. Mu√±oz-Mansilla, R., Aranda, J., Diaz, J. M., Chaos, D., and Reinoso, A. J. Applications of QFT Robust Control Techniques to Marine Systems. 9th IEEE International Conference on Control and Automation , December 19 ‚Äì21, 2011, pp. 378 ‚Äì385. Novosad, J. P. Systems, Modeling, and Decision Making. Kendall/Hunt, Dubuque, IA, 1982. Nyquist, H. Regeneration Theory. Bell System Technical Journal, January 1932. Ogata, K. Modern Control Engineering , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1990. Overbye, D. The Big Ear. Omni, December 1990, pp. 41 ‚Äì48. Figure caption source for Figure 1.7. Rockwell International. Space Shuttle Transportation System , 1984 (press information). Shaw, D. A., and Turnbull, G. A. Modern Thickness Control for a Generation III Hot Strip Mill . The International Steel Rolling Conference ‚ÄîThe Science & Technology of Flat Rolling, vol. 1. Association Technique de la Siderurgie Francaise, Deauville, France, 1 ‚Äì3, June 1987. UNAIDS. GLOBAL REPORT: UNAIDS report on the global AIDS epidemic 2013. Joint United Nations Programme on HIV/AIDS (UNAIDS), 2013, p. 4. United Technologies Otis Elevator Co. The World of Otis. United Technologies Otis Elevator Co., p. 2, 1991. Figure caption source for Figure 1.3(b). United Technologies Otis Elevator Co. Tell Me About Elevators. United Technologies Otis Elevator Co., pp. 20 ‚Äì25, 1991. Figure caption source for Figure 1.3(b). Vaughan, N. D., and Gamble, J. B. The Modeling and Simulation of a Proportional Solenoid Valve. Journal of Dynamic Systems, Measurements, and Control , vol. 118, March 1996, pp. 120 ‚Äì125. Zhao, Q., Wang, F., Wang, W., and Deng, H. Adaptive Fuzzy Control Technology for Automatic Oil Drilling System. Proceedings of the IEEE International Conference on Automation and Logistics , China, August 18 ‚Äì21, 2007. Zhou, J., Nygaard, G., Godhaven, J., Bretholtz, √ò., and Ver Ô¨Ång, E. H. Adaptive Observer for Kick Detection and Switched Control for Bottom hole Pressure Regulation and Kick Attenuation during Managed Pressure Drilling. 2010 American Control Conference . Baltimore, MD, USA, June 30 ‚ÄìJuly 02, 2010.Bibliography 31WEBC01 10/28/2014 14:10:35 Page 32WEBC02 10/28/2014 16:18:2 Modeling in the Frequency Domain Chapter Learning Outcomes After completing this chapter, the student will be able to: ¬ÅFind the Laplace transform of time functions and the inverse Laplace transform (Sections 2.1 ‚Äì2.2) ¬ÅFind the transfer function from a differential equation and solve the differentialequation using the transfer function (Section 2.3) ¬ÅFind the transfer function for linear, time-invariant electrical networks(Section 2.4) ¬ÅFind the transfer function for linear, time-invariant translational mechanicalsystems (Section 2.5) ¬ÅFind the transfer function for linear, time-invariant rotational mechanicalsystems (Section 2.6) ¬ÅFind the transfer functions for gear systems with loss and for gear systems with no loss (Section 2.7) ¬ÅFind the transfer function for linear, time-invariant electromechanical systems (Section 2.8) ¬ÅProduce analogous electrical and mechanical circuits (Section 2.9) ¬ÅLinearize a nonlinear system in order to Ô¨Ånd the transfer function (Sections 2.10 ‚Äì2.11)2 33WEBC02 10/28/2014 16:18:2 Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with case studies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to Ô¨Ånd the transfer function of each subsystem. ¬ÅGiven a model of a human leg or a nonlinear electrical circuit, you will be able tolinearize the model and then Ô¨Ånd the transfer function. 2.1 Introduction In Chapter 1 we discussed the analysis and design sequence that included obtaining thesystem ‚Äôs schematic and demonstrated this step for a position control system. To obtain a schematic, the control systems engineer must often make many simplifying assumptions inorder to keep the ensuing model manageable and still approximate physical reality. The next step is to develop mathematical models from schematics of physical systems. We will discuss two methods: (1) transfer functions in the frequency domainand (2) state equations in the time domain. These topics are covered in this chapter and in Chapter 3, respectively. As we proceed, we will notice that in every case the Ô¨Årst step in developing a mathematical model is to apply the fundamental physical laws of science and engineering. For example, when we model electrical networks, Ohm ‚Äôs law and Kirchhoff ‚Äôs laws, which are basic laws of electric networks, will be applied initially. We will sumvoltages in a loop or sum currents at a node. When we study mechanical systems, we willuse Newton ‚Äôs laws as the fundamental guiding principles. Here we will sum forces or torques. From these equations we will obtain the relationship between the system‚Äô s output and input. In Chapter 1 we saw that a differential equation can describe the relationship between the input and output of a system. The form of the differential equation and its coef Ô¨Åcients are a formulation or description of the system. Although the differential equation relates thesystem to its input and output, it is not a satisfying representation from a system perspective.Looking at Eq. (1.2), a general, nth-order, linear, time-invariant differential equation, we see that the system parameters, which are the coef Ô¨Åcients, appear throughout the equation. In addition, the output, c(t), and the input, r(t), also appear throughout the equation. We would prefer a mathematical representation such as that shown in Figure 2.1( a), where the input, output, and system are distinct and separate parts. Also, we would liketo represent conveniently the interconnection of several subsystems. For example, wewould like to represent cascaded interconnections, as shown in Figure 2.1( b), where a mathematical function, called a transfer function, is inside each block, and block functions SystemInput Output ( ) Subsystem ( )SubsystemInputSubsystemOutputa br(t) r(t)c(t) c(t) Note: The input, r(t), stands for reference input. The out put, c(t), stands for controlled variable.FIGURE 2.1 a.Block diagram representation of a system; b.block diagram representation of aninterconnection of subsystems34 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:3 can easily be combined to yield Figure 2.1( a) for ease of analysis and design. This convenience cannot be obtained with the differential equation. 2.2 Laplace Transform Review A system represented by a differential equation is dif Ô¨Åcult to model as a block diagram. Thus, we now lay the groundwork for the Laplace transform, with which we can represent the input, output, and system as separate entities. Further, their interrelationship will besimply algebraic. Let us Ô¨Årst de Ô¨Åne the Laplace transform and then show how it simpli Ô¨Åes the representation of physical systems ( Nilsson ,1996 ). The Laplace transform is de Ô¨Åned as ‚Ñí¬âf t¬Ü¬ä ¬à F s¬Ü¬àZ‚àû 0 f t¬Üe stdt 2.1¬Ü where s¬àœÉ¬ájœâ, a complex variable. Thus, knowing f(t) and that the integral in Eq. (2.1) exists, we can Ô¨Ånd a function, F(s), that is called the Laplace transform off(t).1 The notation for the lower limit means that even if f(t) is discontinuous at t¬à0, we can start the integration prior to the discon tinuity as long as the i ntegral converges. Thus, we can Ô¨Ånd the Laplace transform of impulse fu nctions. This property has distinct advantages when applying the Laplace transform to the solution of differentialequations where the initial conditions are discontinuous at t¬à0. Using differential equations, we have to solve for the initial cond itions after the discontinuity knowing the initial conditions before the discontinuity. Using the Laplace transform we need onlyknow the initial conditions befo re the discontinuity. See Kailath (1980) for a more detailed discussion. The inverse Laplace transform, which allows us to Ô¨Ånd f(t) given F(s), is ‚Ñí 1¬âF s¬Ü¬ä ¬à1 2œÄjZœÉ¬áj‚àû œÉ j‚àûF s¬Üestds¬àf t¬Üu t¬Ü 2.2¬Ü where u t¬Ü¬à1 t>0 ¬à0 t<0 is the unit step function. Multiplication of f(t)b yu(t) yields a time function that is zero for t<0. Using Eq. (2.1), it is possible to derive a table relating f(t)t oF(s) for speci Ô¨Åc cases. Table 2.1 shows the results for a representative sample of functions. If we use the tables, we do not have to use Eq. (2.2), which requires complex integration, to Ô¨Ånd f(t) given F(s). 1The Laplace transform exists if the integral of Eq. (2.1) converges. The integral will converge ifR‚àû 0 jf t¬Üje œÉ1tdt<‚àû.I fjf t¬Üj<MeœÉ2t;0<t<‚àû, the integral will converge if ‚àû>œÉ1>œÉ2. We call œÉ2the abscissa of convergence , and it is the smallest value of œÉ, where s¬àœÉ¬ájœâ, for which the integral exists.2.2 Laplace Transform Review 35WEBC02 10/28/2014 16:18:5 In the following example we demonstrate the use of Eq. (2.1) to Ô¨Ånd the Laplace transform of a time function. In addition to the Laplace transform table, Table 2.1, we can use Laplace transform theorems, listed in Table 2.2, to assist in transforming between f(t) and F(s). In the next example, we demonstrate the use of the Laplace transform theorems shown in Table 2.2 to Ô¨Ånd f(t) given F(s).TABLE 2.1 Laplace transform table Item no. f(t) F(s) Œ¥(t) 1 u(t)1 s tu(t)1 s2 tnu t¬Ün! sn¬á1 e atu t¬Ü1 s¬áa sinœâtu t¬Üœâ s2¬áœâ2 cosœâtu t¬Üs s2¬áœâ2 Example 2.2 Inverse Laplace TransformInverse Laplace Transform PROBLEM: Find the inverse Laplace transform of F1 s¬Ü¬à1= s¬á3¬Ü2. SOLUTION: For this example we make use of the frequency shift theorem, Item 4 of Table 2.2, and the Laplace transform of f t¬Ü¬àtu t¬Ü, Item 3 of Table 2.1. If the inverse transform of F s¬Ü¬à1=s2istu(t), the inverse transform of F s¬áa¬Ü¬à1= s¬áa¬Ü2ise attu t¬Ü. Hence, f1 t¬Ü¬àe 3ttu t¬Ü.Example 2.1 Laplace Transform of a Time FunctionLaplace Transform of a Time Function PROBLEM: Find the Laplace transform of f t¬Ü¬àAe atu t¬Ü. SOLUTION: Since the time function does not contain an impulse function, we can replace the lower limit of Eq. (2.1) with 0. Hence, F s¬Ü¬àZ‚àû 0f t¬Üe stdt¬àZ‚àû 0Ae ate stdt¬àAZ‚àû 0e  s¬áa¬Ütdt ¬à A s¬áae  s¬áa¬Üt/C12/C12/C12‚àû t¬à0¬àA s¬áa 2.3¬Ü36 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:9 Partial-Fraction Expansion ToÔ¨Ånd the inverse Laplace transform of a complicated function, we can convert the function to a sum of simpler terms for which we know the Laplace transform of each term. The result is called a partial-fraction expansion .I fF1 s¬Ü¬àN s¬Ü=D s¬Ü, where the order of N(s) is less than the order of D(s), then a partial-fraction expansion can be made. If the order of N(s) is greater than or equal to the order of D(s), then N(s) must be divided by D(s) successively until the result has a remainder whose numerator is of order less than its denominator. For example, if F1 s¬Ü¬às3¬á2s2¬á6s¬á7 s2¬ás¬á5 2.4¬Ü we must perform the indicated division until we obtain a remainder whose numerator is oforder less than its denominator. Hence, F 1 s¬Ü¬às¬á1¬á2 s2¬ás¬á5 2.5¬Ü Taking the inverse Laplace transform, using Item 1 of Table 2.1, along with the differentiationtheorem (Item 7) and the linearity theorem (Item 3 of Table 2.2), we obtain f 1 t¬Ü¬àdŒ¥ t¬Ü dt¬áŒ¥ t¬Ü¬á‚Ñí 1 2 s2¬ás¬á5/C20/C21 2.6¬Ü Using partial-fraction e xpansion, we will be able to expand functions like F s¬Ü¬à 2= s2¬ás¬á5¬Üinto a sum of terms and then Ô¨Ånd the inverse Laplace transform for each term. We will now consider three cases and show for each case how an F(s)c a nb e expanded into partial fractions.TABLE 2.2 Laplace transform theorems Item no. Theorem Name ‚Ñí¬âf t¬Ü¬ä ¬à F s¬Ü¬àR‚àû 0 f t¬Üe stdt DeÔ¨Ånition ‚Ñí¬âkf t¬Ü¬ä ¬à kF s¬Ü Linearity theorem ‚Ñí¬âf1 t¬Ü¬áf2 t¬Ü¬ä ¬à F1 s¬Ü¬áF2 s¬Ü Linearity theorem ‚Ñí¬âe atf t¬Ü¬ä ¬à F s¬áa¬Ü Frequency shift theorem ‚Ñí¬âf t T¬Ü¬ä ¬à e sTF s¬Ü Time shift theorem ‚Ñí¬âf at¬Ü¬ä ¬à1 aFs a/C16/C17 Scaling theorem ‚Ñídf dt/C20/C21 ¬àsF s¬Ü f 0 ¬Ü Differentiation theorem 8.‚Ñíd2f dt2/C20/C21 ¬às2F s¬Ü sf 0 ¬Ü   f¬¥ 0 ¬Ü Differentiation theorem ‚Ñídnf dtn/C20/C21 ¬àsnF s¬Ü Xn k¬à1sn kfk 1 0 ¬Ü Differentiation theorem ‚ÑíRt 0 f œÑ¬ÜdœÑ/C2/C3 ¬àF s¬Ü sIntegration theorem f ‚àû¬Ü¬à lim s¬Æ0sF s¬Ü Final value theorem1 f 0¬á¬Ü ¬à lim s¬Æ‚àûsF s¬Ü Initial value theorem2 1For this theorem to yield correct Ô¨Ånite results, all roots of the denominator of F(s) must have negative real parts, and no more than one can be at the origin. 2For this theorem to be valid, f(t) must be continuous or have a step discontinuity at t¬à0 (that is, no impulses or their derivatives at t¬à0).2.2 Laplace Transform Review 37WEBC02 10/28/2014 16:18:10 Case 1. Roots of the Denominator of F(s) Are Real and Distinct An example of an F(s) with real and distinct roots in the denominator is F s¬Ü¬à2 s¬á1¬Ü s¬á2¬Ü 2.7¬Ü The roots of the denominator are distinct, since each factor is raised only to unity power. We can write the partial-fraction expansion as a sum of terms where each factor of the original denominator forms the denominator of each term, and constants, called residues , form the numerators. Hence, F s¬Ü¬à2 s¬á1¬Ü s¬á2¬Ü¬àK1 s¬á1¬Ü¬áK2 s¬á2¬Ü 2.8¬Ü ToÔ¨Ånd K1,w eÔ¨Årst multiply Eq. (2.8) by s¬á1¬Ü, which isolates K1. Thus, 2 s¬á2¬Ü¬àK1¬á s¬á1¬ÜK2 s¬á2¬Ü 2.9¬Ü Letting sapproach  1 eliminates the last term and yields K1¬à2. Similarly, K2can be found by multiplying Eq. (2.8) by s¬á2¬Üand then letting sapproach  2; hence, K2¬à 2. Each component part of Eq. (2.8) is an F(s) in Table 2.1. Hence, f(t) is the sum of the inverse Laplace transform of each term, or f t¬Ü¬à 2e t 2e 2t¬Üu t¬Ü 2.10¬Ü In general, then, given an F(s) whose denominator has real and distinct roots, a partial- fraction expansion, F s¬Ü¬àN s¬Ü D s¬Ü¬àN s¬Ü s¬áp1¬Ü s¬áp2¬Ü‚àô‚àô‚àô s¬ápm¬Ü‚àô‚àô‚àô s¬ápn¬Ü ¬àK1 s¬áp1¬Ü¬áK2 s¬áp2¬Ü¬á‚àô‚àô‚àô¬áKm s¬ápm¬Ü¬á‚àô‚àô‚àô¬áKn s¬ápn¬Ü 2.11¬Ü can be made if the order of N(s) is less than the order of D(s). To evaluate each residue, Ki, we multiply Eq. (2.11) by the denominator of the corresponding partial fraction. Thus, if wewant to Ô¨Ånd K m, we multiply Eq. (2.11) by s¬ápm¬Üand get s¬ápm¬ÜF s¬Ü¬à s¬ápm¬ÜN s¬Ü s¬áp1¬Ü s¬áp2¬Ü‚àô‚àô‚àô s¬ápm¬Ü‚àô‚àô‚àô s¬ápn¬Ü ¬à s¬ápm¬ÜK1 s¬áp1¬Ü¬á s¬ápm¬ÜK2 s¬áp2¬Ü¬á‚àô‚àô‚àô¬áKm¬á‚àô‚àô‚àô ¬á s¬ápm¬ÜKn s¬ápn¬Ü 2.12¬Ü If we let sapproach  pm, all terms on the right-hand side of Eq. (2.12) go to zero except the term Km, leaving s¬ápm¬ÜN s¬Ü s¬áp1¬Ü s¬áp2¬Ü‚àô‚àô‚àô s¬ápm¬Ü‚àô‚àô‚àô s¬ápn¬Ü/C12/C12/C12 s¬Æ pm¬àKm 2.13¬Ü The following example demonstrates the use of the partial-fraction expansion to solve a differential equation. We will see that the Laplace transform reduces the task of Ô¨Ånding the solution to simple algebra.38 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:11 Example 2.3 Laplace Transform Solution of a Differential EquationLaplace Transform Solution of a Differential Equation PROBLEM: Given the following differential equation, solve for y(t) if all initial conditions are zero. Use the Laplace transform. d2y dt2¬á12dy dt¬á32y¬à32u t¬Ü 2.14¬Ü SOLUTION: Substitute the corresponding F(s) for each term in Eq. (2.14), using Item 2 in Table 2.1, Items 7 and 8 in Table 2.2, and the initial conditions of y(t) and dy(t)/dtgiven byy 0 ¬Ü ¬à 0 and y: 0 ¬Ü ¬à 0, respectively. Hence, the Laplace transform of Eq. (2.14) is s2Y s¬Ü¬á12sY s¬Ü¬á32Y s¬Ü¬à32 s 2.15¬Ü Solving for the response, Y(s), yields Y s¬Ü¬à32 s s2¬á12s¬á32¬Ü¬à32 s s¬á4¬Ü s¬á8¬Ü 2.16¬Ü To solve for y(t), we notice that Eq. (2.16) does not match any of the terms in Table 2.1. Thus, we form the partial-fraction expansion of the right-hand term and match each of the resulting terms with F(s) in Table 2.1. Therefore, Y s¬Ü¬à32 s s¬á4¬Ü s¬á8¬Ü¬àK1 s¬áK2 s¬á4¬Ü¬áK3 s¬á8¬Ü 2.17¬Ü where, from Eq. (2.13), K1¬à32 s¬á4¬Ü s¬á8¬Ü/C12/C12/C12 s¬Æ0¬à1 (2.18a) K2¬à32 s s¬á8¬Ü/C12/C12/C12 s¬Æ 4¬à 2 (2.18b) K3¬à32 s s¬á4¬Ü/C12/C12/C12 s¬Æ 8¬à1 (2.18c) Hence, Y s¬Ü¬à1 s 2 s¬á4¬Ü¬á1 s¬á8¬Ü 2.19¬Ü Since each of the three component parts of Eq. (2.19) is represented as an F(s)i n Table 2.1, y(t) is the sum of the inverse Laplace transforms of each term. Hence, y t¬Ü¬à 1 2e 4t¬áe 8t¬Üu t¬Ü 2.20¬Ü Students who are using MATLAB should now run ch2p1 through ch2p8 in Appendix B. This is your Ô¨Årst MATLAB exercise. You will learn how to use MATLAB to (1) represent polynomials, (2) Ô¨Ånd roots of polynomials, (3) multiply polynomials, and (4) Ô¨Ånd partial- fraction expansions. Finally, Example 2.3 will be solved usingMATLAB.2.2 Laplace Transform Review 39WEBC02 10/28/2014 16:18:12 Theu(t) in Eq. (2.20) shows that the response is zero until t¬à0. Unless otherwise speciÔ¨Åed, all inputs to systems in the text will not start until t¬à0. Thus, output responses will also be zero until t¬à0. For convenience, we will leave off the u(t) notation from now on. Accordingly, we write the output response as y t¬Ü¬à1 2e 4t¬áe 8t 2.21¬Ü Case 2. Roots of the Denominator of F(s) Are Real and Repeated An example of an F(s) with real and repeated roots in the denominator is F s¬Ü¬à2 s¬á1¬Ü s¬á2¬Ü2 2.22¬Ü The roots of s¬á2¬Ü2in the denominator are repeated, since the factor is raised to an integer power higher than 1. In this case, the denominator root at  2i samultiple root of multiplicity 2. We can write the partial-fraction expansion as a sum of terms, where each factor of the denominator forms the denominator of each term. In addition, each multiple root generates additional terms consisting of denominator factors of reduced multiplicity. For example, if F s¬Ü¬à2 s¬á1¬Ü s¬á2¬Ü2¬àK1 s¬á1¬Ü¬áK2 s¬á2¬Ü2¬áK3 s¬á2¬Ü 2.23¬Ü then K1¬à2, which can be found as previously described. K2can be isolated by multiplying Eq. (2.23) by s¬á2¬Ü2, yielding 2 s¬á1¬à s¬á2¬Ü2K1 s¬á1¬Ü¬áK2¬á s¬á2¬ÜK3 2.24¬Ü Letting sapproach  2;K2¬à 2. To Ô¨ÅndK3we see that if we differentiate Eq. (2.24) with respect to s,  2 s¬á1¬Ü2¬à s¬á2¬Üs s¬á1¬Ü2K1¬áK3 2.25¬Ü K3is isolated and can be found if we let sapproach  2. Hence, K3¬à 2. Each component part of Eq. (2.23) is an F(s) in Table 2.1; hence, f(t) is the sum of the inverse Laplace transform of each term, or f t¬Ü¬à2e t 2te 2t 2e 2t 2.26¬Ü If the denominator root is of higher multiplicity than 2, successive differentiation wouldisolate each residue in the expansion of the multiple root. In general, then, given an F(s) whose denominator has real and repeated roots, a partial-fraction expansion F s¬Ü¬àN s¬Ü D s¬Ü ¬àN s¬Ü s¬áp1¬Ür s¬áp2¬Ü‚àô‚àô‚àô s¬ápn¬Ü ¬àK1 s¬áp1¬Ür¬áK2 s¬áp1¬Ür 1¬á‚àô‚àô‚àô¬áKr s¬áp1¬Ü¬áKr¬á1 s¬áp2¬Ü¬á‚àô‚àô‚àô¬áKn s¬ápn¬Ü 2.27¬ÜTryIt 2.2 Use the following MATLAB statements to help you get Eq. (2.26). numf=2; denf= poly( [ 1 2 2]) ; [K,p,k] =residue... (numf ,denf)TryIt 2.1 Use the following MATLAB and Control System Toolbox statement to form the linear, time-invariant (LTI) transferfunction of Eq. (2.22). F=zpk([],[ 1 2 2],2)40 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:13 can be made if the order of N(s) is less than the order of D(s) and the repeated roots are of multiplicity rat p1.T oÔ¨Ånd K1through Krfor the roots of multiplicity greater than unity, Ô¨Årst multiply Eq. (2.27) by s¬áp1¬Ürgetting F1 s¬Ü, which is F1 s¬Ü¬à s¬áp1¬ÜrF s¬Ü ¬à s¬áp1¬ÜrN s¬Ü s¬áp1¬Ür s¬áp2¬Ü‚àô‚àô‚àô s¬ápn¬Ü ¬àK1¬á s¬áp1¬ÜK2¬á s¬áp1¬Ü2K3¬á‚àô‚àô‚àô¬á s¬áp1¬Ür 1Kr ¬áKr¬á1 s¬áp1¬Ür s¬áp2¬Ü¬á‚àô‚àô‚àô¬áKn s¬áp1¬Ür s¬ápn¬Ü 2.28¬Ü Immediately, we can solve for K1if we let sapproach  p1. We can solve for K2if we differentiate Eq. (2.28) with respect to sand then let sapproach  p1. Subsequent differentiation will allow us to Ô¨ÅndK3through Kr. The general expression for K1through Krfor the multiple roots is Ki¬à1 i 1¬Ü!di 1F1 s¬Ü dsi 1/C12/C12/C12 s¬Æ p1i¬à1;2;...;r;0!¬à1 2.29¬Ü Case 3. Roots of the Denominator of F(s) Are Complex or Imaginary An example of F(s) with complex roots in the denominator is F s¬Ü¬à3 s s2¬á2s¬á5¬Ü 2.30¬Ü This function can be expanded in the following form: 3 s s2¬á2s¬á5¬Ü¬àK1 s¬áK2s¬áK3 s2¬á2s¬á5 2.31¬Ü K1is found in the usual way to be3 5.K2andK3can be found by Ô¨Årst multiplying Eq. (2.31) by the lowest common denominator, s s2¬á2s¬á5¬Ü, and clearing the fractions. After simpli Ô¨Åcation with K1¬à3 5, we obtain 3¬àK2¬á3 5/C18/C19 s2¬áK3¬á65/C18/C19 s¬á3 2.32¬Ü Balancing coef Ô¨Åcients, K 2¬á3 5/C0/C1 ¬à0 and K3¬á65/C0/C1 ¬à0. Hence K2¬à 35and K3¬à 65. Thus, F s¬Ü¬à3 s s2¬á2s¬á5¬Ü¬à3=5 s 3 5s¬á2 s2¬á2s¬á5 2.33¬Ü The last term can be shown to be the sum of the Laplace transforms of an exponentially damped sine and cosine. Using Item 7 in Table 2.1 and Items 2 and 4 in Table 2.2, we get ‚Ñí¬âAe atcosœât¬ä¬àA s¬áa¬Ü s¬áa¬Ü2¬áœâ2 2.34¬ÜTryIt 2.3 Use the following MATLAB and Control System Toolboxstatement to form the LTItransfer function of Eq. (2.30). F=tf( [3] ,[1 2 5 0] )2.2 Laplace Transform Review 41WEBC02 10/28/2014 16:18:13 Similarly, ‚Ñí¬âBe atsinœât¬ä¬àBœâ s¬áa¬Ü2¬áœâ2 2.35¬Ü Adding Eqs. (2.34) and (2.35), we get ‚Ñí¬âAe atcosœât¬áBe atsinœât¬ä¬àA s¬áa¬Ü¬áBœâ s¬áa¬Ü2¬áœâ2 2.36¬Ü We now convert the last term of Eq. (2.33) to the form suggested by Eq. (2.36) by completing the squares in the denominator and adjusting terms in the numerator without changing its value. Hence, F s¬Ü¬à3=5 s 3 5 s¬á1¬Ü¬á 1=2¬Ü 2¬Ü s¬á1¬Ü2¬á22 2.37¬Ü Comparing Eq. (2.37) to Table 2.1 and Eq. (2.36), we Ô¨Ånd f t¬Ü¬à35 35e  tcos 2 t¬á12sin 2t/C18/C19 2.38¬Ü In order to visualize the solution, an alternate form of f(t), obtained by trigonometric identities, is preferable. Using the amplitudes of the cos and sin terms, we factor outÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 2¬á 1=2¬Ü2q from the term in parentheses and obtain f t¬Ü¬à3 5 35Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 2¬á 1=2¬Ü2q e t 1Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 12¬á 1=2¬Ü2q cos 2 t¬á1=2Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É1 2¬á 1=2¬Ü2q sin 2 t0 B@1 CA 2.39¬Ü Letting 1 =Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 12¬á 1=2¬Ü2q ¬àcosœïand 1=2¬Ü=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É1 2¬á 1=2¬Ü2q ¬àsinœï, f t¬Ü¬à3 5 35Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 2¬á 1=2¬Ü2q e t cosœïcos 2 t¬ásinœïsin 2t¬Ü 2.40¬Ü or f t¬Ü¬à0:6 0:671e tcos 2t œï¬Ü 2.41¬Ü where œï¬àarctan 0 :5¬à26:57¬∞. Thus, f(t) is a constant plus an exponentially damped sinusoid. In general, then, given an F(s) whose denominator has complex or purely imaginary roots, a partial-fraction expansion, F s¬Ü¬àN s¬Ü D s¬Ü¬àN s¬Ü s¬áp1¬Ü s2¬áas¬áb¬Ü‚àô‚àô‚àô ¬àK1 s¬áp1¬Ü¬á K2s¬áK3¬Ü s2¬áas¬áb¬Ü¬á‚àô‚àô‚àô 2.42¬ÜTryIt 2.4 Use the following MATLAB and Symbolic Math Toolboxstatements to get Eq. (2.38) from Eq. (2.30). syms s f=ilaplace... (3/ (s* (s^2 +2*s+5)) ) ; pretty (f)42 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:14 can be made if the order of N(s) is less than the order of D(s)p1is real, and s2¬áas¬áb¬Ü has complex or purely imaginary roots. The complex or imaginary roots are expanded with K2s¬áK3¬Üterms in the numerator rather than just simply Ki, as in the case of real roots. The Ki‚Äôs in Eq. (2.42) are found through balancing the coef Ô¨Åcients of the equation after clearing fractions. After completing the squares on s2¬áas¬áb¬Üand adjusting the numerator, K2s¬áK3¬Ü= s2¬áas¬áb¬Ücan be put into the form shown on the right-hand side of Eq. (2.36). Finally, the case of purely imaginary roots arises if a¬à0 in Eq. (2.42). The calculations are the same. Another method that follows the technique used for the partial-fraction expansion of F(s) with real roots in the denominator can be used for complex and imaginary roots. However, the residues of the complex and imaginary roots are themselves complexconjugates. Then, after taking the inverse Laplace transform, the resulting terms can beidenti Ô¨Åed as ejŒ∏¬áe jŒ∏ 2¬àcosŒ∏ 2.43¬Ü and ejŒ∏ e jŒ∏ 2j¬àsinŒ∏ 2.44¬Ü For example, the previous F(s) can also be expanded in partial fractions as F s¬Ü¬à3 s s2¬á2s¬á5¬Ü¬à3 s s¬á1¬áj2¬Ü s¬á1 j2¬Ü ¬àK1 s¬áK2 s¬á1¬áj2¬áK3 s¬á1 j2 2.45¬Ü Finding K2, K2¬à3 s s¬á1 j2¬Ü/C12/C12/C12 s¬Æ 1 j2¬à 3 20 2¬áj1¬Ü 2.46¬Ü Similarly, K3is found to be the complex conjugate of K2, and K1is found as previously described. Hence, F s¬Ü¬à3=5 s 3 202¬áj1 s¬á1¬áj2¬á2 j1 s¬á1 j2/C18/C19 2.47¬Ü from which f t¬Ü¬à3 5 3 20 2¬áj1¬Üe  1¬áj2¬Üt¬á 2 j1¬Üe  1 j2¬Üt/C2/C3 ¬à35 3 20e t4ej2t¬áe j2t 2/C18/C19 ¬á2ej2t¬áe j2t 2j/C18/C19 /C20/C21 2.48¬Ü Using Eqs. (2.43) and (2.44), we get f t¬Ü¬à35 35e  tcos 2 t¬á12sin 2t/C18/C19 ¬à0:6 0:671e  tcos 2t œï¬Ü 2.49¬Ü where œï¬àarctan 0 :5¬à26:57¬∞.TryIt 2.5 Use the following MATLAB statements to help you get Eq. (2.47). numf=3 denf=[ 1250 ] [K,p,k] =residue... (numf, denf)2.2 Laplace Transform Review 43WEBC02 10/28/2014 16:18:15 Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch2sp1 and ch2sp2 in Appendix F at www.wiley.com/ college/nise . You will learn how to construct symbolic objects and then Ô¨Ånd the inverse Laplace and Laplace transforms of frequency and time functions, respectively. The examples in Case 2 and Case 3 in this section will be solved using the Symbolic Math Toolbox. 2.3 The Transfer Function In the previous section we de Ô¨Åned the Laplace transform and its inverse. We presented the idea of the partial-fraction expansion and applied the concepts to the solution of differentialequations. We are now ready to formulate the system representation shown in Figure 2.1 byestablishing a viable de Ô¨Ånition for a function that algebraically relates a system ‚Äôs output to its input. This function will allow separation of the input, system, and output into three separate and distinct parts, unlike the differential equation. The function will also allow us to algebraically combine mathematical representations of subsystems to yield a total system representation. Let us begin by writing a general nth-order, linear, time-invariant differential equation, a ndnc t¬Ü dtn¬áan 1dn 1c t¬Ü dtn 1¬á‚àô‚àô‚àô¬áa0c t¬Ü¬àbmdmr t¬Ü dtm¬ábm 1dm 1r t¬Ü dtm 1¬á‚àô‚àô‚àô¬áb0r t¬Ü 2.50¬Ü where c(t) is the output, r(t) is the input, and the ai‚Äôs,bi‚Äôs, and the form of the differential equation represent the system. Taking the Laplace transform of both sides, ansnC s¬Ü¬áan 1sn 1C s¬Ü¬á‚àô‚àô‚àô¬áa0C s¬Ü¬áinitial condition terms involving c t¬Ü ¬àbmsmR s¬Ü¬ábm 1sm 1R s¬Ü¬á‚àô‚àô‚àô¬áb0R s¬Ü¬áinitial condition terms involving r t¬Ü 2.51¬ÜSkill-Assessment Exercise 2.1 PROBLEM: Find the Laplace transform of f t¬Ü¬àte 5t. ANSWER: F s¬Ü¬à1= s¬á5¬Ü2 The complete solution is at www.wiley.com/college/nise . Skill-Assessment Exercise 2.2 PROBLEM: Find the inverse Laplace transform of F s¬Ü¬à10=¬âs s¬á2¬Ü s¬á3¬Ü2¬ä. ANSWER: f t¬Ü¬à5 9 5e 2t¬á10 3te 3t¬á40 9e 3t The complete solution is at www.wiley.com/college/nise .44 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:16 Equation (2.51) is a purely algebraic expression. If we assume that all initial conditions are zero, Eq. (2.51) reduces to ansn¬áan 1sn 1¬á‚àô‚àô‚àô¬áa0¬ÜC s¬Ü¬à bmsm¬ábm 1sm 1¬á‚àô‚àô‚àô¬áb0¬ÜR s¬Ü 2.52¬Ü Now form the ratio of the output transform, C(s), divided by the input transform, R(s): C s¬Ü R s¬Ü¬àG s¬Ü¬à bmsm¬ábm 1sm 1¬á‚àô‚àô‚àô¬áb0¬Ü ansn¬áan 1sn 1¬á‚àô‚àô‚àô¬áa0¬Ü 2.53¬Ü Notice that Eq. (2.53) separates the output, C(s), the input, R(s), and the system, which is the ratio of polynomials in son the right. We call this ratio, G(s), the transfer function and evaluate it with zero initial conditions . The transfer function can be represented as a block diagram, as shown in Figure 2.2, with the input on the left, the output on the right, and the system transfer function inside the block. Notice that the denominator of the transfer function is identical to the characteristic polynomial of thedifferential equation. Also, we can Ô¨Ånd the output, C(s) by using C s¬Ü¬àR s¬ÜG s¬Ü 2.54¬Ü Let us apply the concept of a transfer function to an example and then use the result to Ô¨Ånd the response of the system. Students who are using MATLAB should now run ch2p9 through ch2p12in Appendix B. You will learn how to use MATLAB to create transferfunctions with numerators and denominators in polynomial or fac- tored form. You will also learn how to convert between polynomial and factored forms. Finally, you will learn how to use MATLAB toplot time functions.Example 2.4 Transfer Function for a Differential EquationTransfer Function for a Differential Equation PROBLEM: Find the transfer function represented by dc t¬Ü dt¬á2c t¬Ü¬àr t¬Ü 2.55¬Ü SOLUTION: Taking the Laplace transform of both sides, assuming zero initial conditions, we have sC s¬Ü¬á2C s¬Ü¬àR s¬Ü 2.56¬Ü The transfer function, G(s), is G s¬Ü¬àC s¬Ü R s¬Ü¬à1 s¬á2 2.57¬ÜC(s) R(s) (bmsm + bm‚Äì1sm‚Äì1 + . . . + b 0) (ansn + an‚Äì1sn‚Äì1 + . . . + a0) FIGURE 2.2 Block diagram of a transfer function2.3 The Transfer Function 45WEBC02 10/28/2014 16:18:17 Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch2sp3 in Appendix F at www.wiley.com/college/nise . You will learn how to use the Symbolic Math Toolbox to simplify the input of complicated transfer functions as well as improvereadability. You will learn how to enter a symbolic transferfunction and convert it to a linear, time-invariant (LTI) object aspresented in Appendix B, ch2p9. Example 2.5 System Response from the Transfer FunctionSystem Response from the Transfer Function PROBLEM: Use the result of Example 2.4 to Ô¨Ånd the response, c(t) to an input, r t¬Ü¬àu t¬Ü, a unit step, assuming zero initial conditions. SOLUTION: To solve the problem, we use Eq. (2.54), where G s¬Ü¬à1= s¬á2¬Üas found in Example 2.4. Since r t¬Ü¬àu t¬Ü;R s¬Ü¬à1=s, from Table 2.1. Since the initial conditions are zero, C s¬Ü¬àR s¬ÜG s¬Ü¬à1 s s¬á2¬Ü 2.58¬Ü Expanding by partial fractions, we get C s¬Ü¬à1=2 s 1=2 s¬á2 2.59¬Ü Finally, taking the inverse Laplace transform of each term yields c t¬Ü¬à1 2 12e  2t 2.60¬ÜTryIt 2.7 Use the following MATLAB statements to plot Eq. (2.60) for t f r o m0t o1s a ti n t e r v a l so f0 . 0 1s . t=0:0.01:3; plot... (t,(1/2 -1/2*exp (-2*t) ) )TryIt 2.6 Use the following MATLAB and Symbolic Math Toolbox statements to help you get Eq. (2.60). syms s C=1/(s* (s +2) ) C=ilaplace(C) Skill-Assessment Exercise 2.3 PROBLEM: Find the transfer function, G s¬Ü¬àC s¬Ü=R s¬Ü, corresponding to the differential equationd3c dt3¬á3d2c dt2¬á7dc dt¬á5c¬àd2r dt2¬á4dr dt¬á3r. ANSWER: G s¬Ü¬àC s¬Ü R s¬Ü¬às2¬á4s¬á3 s3¬á3s2¬á7s¬á5 The complete solution is at www.wiley.com/college/nise . Skill-Assessment Exercise 2.4 PROBLEM: Find the differential equation corresponding to the transfer function, G s¬Ü¬à2s¬á1 s2¬á6s¬á2 ANSWER:d2c dt2¬á6dc dt¬á2c¬à2dr dt¬ár The complete solution is at www.wiley.com/college/nise .46 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:19 In general, a physical system that can be represented by a linear, time-invariant differential equation can be modeled as a transfer function. The rest of this chapter will be devoted to the task of modeling individual subsystems. We will learn how to represent electrical networks, translational mechanical systems, rotational mechanical systems, andelectromechanical systems as transfer functions. As the need arises, the reader can consultthe Bibliography at the end of the chapter for discussions of other types of systems, such aspneumatic, hydraulic, and heat-transfer systems ( Cannon ,1967 ). 2.4 Electrical Network Transfer Functions In this section, we formally apply the transfer function to the mathematical modeling ofelectric circuits including passive networks and operational ampli Ô¨Åer circuits. Subsequent sections cover mechanical and electromechanical systems. Equivalent circuits for the electric networks that we work with Ô¨Årst consist of three passive linear components: resistors, capacitors, and inductors. 2Table 2.3 summarizes the components and the relationships between voltage and current and between voltage andcharge under zero initial conditions. We now combine electrical components into circuits, decide on the input and output, andÔ¨Ånd the transfer function. Our guiding principles are Kirchhoff ‚Äôs laws. We sum voltages around loops or sum currents at nodes, depending on which technique involves the leastSkill-Assessment Exercise 2.5 PROBLEM: Find the ramp response for a system whose transfer function is G s¬Ü¬às s¬á4¬Ü s¬á8¬Ü ANSWER: c t¬Ü¬à1 32 1 16e 4t¬á1 32e 8t The complete solution is at www.wiley.com/college/nise . 2Passive means that there is no internal source of energy.TABLE 2.3 Voltage-current, voltage-charge, and impedance relationships for capacitors, resistors, and inductors Component Voltage-current Current-voltage Voltage-chargeImpedance Z s¬Ü¬àV s¬Ü=I s¬ÜAdmittance Y s¬Ü¬àI s¬Ü=V s¬Ü Capacito rv t¬Ü¬à1 CZ1 0i œÑ¬ÜdœÑ i t¬Ü¬àCdv t¬Ü dtv t¬Ü¬à1 Cq t¬Ü1 CsCs Resistorv t¬Ü¬àRi t¬Ü i t¬Ü¬à1 Rv t¬Ü v t¬Ü¬àRdq t¬Ü dtR1 R¬àG Inductorv t¬Ü¬àLdi t¬Ü dti t¬Ü¬à1 LZ1 0v œÑ¬ÜdœÑ v t¬Ü¬àLd2q t¬Ü dt2 Ls1 Ls Note: The following set of symbols and units is used throughout this book: v(t) V (volts), i(t) A (amps), q(t) Q (coulombs), C F (farads), R Œ©(ohms), G Œ©(mhos), L H(henries).2.4 Electrical Network Transfer Functions 47WEBC02 10/28/2014 16:18:20 effort in algebraic manipulation, and then equate the result to zero. From these relationships we can write the differential equations for the circuit. Then we can take the Laplace transforms of the differential equations and Ô¨Ånally solve for the transfer function. Simple Circuits via Mesh Analysis Transfer functions can be obtained using Kirchhoff ‚Äôs voltage law and summing voltages around loops or meshes.3We call this method loop ormesh analysis and demonstrate it in the following example. Example 2.6 Transfer Function ‚ÄîSingle Lo op via the Differential EquationTransfer Function ‚ÄîSingle Loop via the Differential Equation PROBLEM: Find the transfer function relating the capacitor voltage, VC s¬Ü,t o the input voltage, V(s) in Figure 2.3. SOLUTION: In any problem, the designer must Ô¨Årst decide what the input and output should be. In this network, several variables could have been chosen to be the output ‚Äîfor example, the inductor voltage, the capacitor voltage, the resistor voltage, or the current. The problem statement, however, is clear in this case: We are to treat thecapacitor voltage as the output and the applied voltage as the input. Summing the voltages around the loop, assuming zero initial conditions, yields the integro-differential equation for this network as Ldi t¬Ü dt¬áRi t¬Ü¬á1 CZt 0i œÑ¬ÜdœÑ¬àv t¬Ü 2.61¬Ü Changing variables from current to charge using i t¬Ü¬àdq t¬Ü=dtyields Ld2q t¬Ü dt2¬áRdq t¬Ü dt¬á1 Cq t¬Ü¬àv t¬Ü 2.62¬Ü From the voltage-charge relationship for a capacitor in Table 2.3, q t¬Ü¬àCvC t¬Ü 2.63¬Ü Substituting Eq. (2.63) into Eq. (2.62) yields LCd2vC t¬Ü dt2¬áRCdvC t¬Ü dt¬ávC t¬Ü¬àv t¬Ü 2.64¬Ü Taking the Laplace transform assuming zero initial conditions, rearranging terms, andsimplifying yields LCs 2¬áRCs ¬á1¬ÜVC s¬Ü¬àV s¬Ü 2.65¬Ü Solving for the transfer function, VC s¬Ü=V s¬Ü, we obtain VC s¬Ü V s¬Ü¬à1=LC s2¬áR Ls¬á1 LC 2.66¬Ü as shown in Figure 2.4. 3A particular loop that resembles the spaces in a screen or fence is called a mesh .R L ‚Äìv(t) i(t)vC(t) C+ +‚Äì FIGURE 2.3 RLC network 1 LCV(s) VC(s) s2 + R Ls + 1 LC FIGURE 2.4 Block diagram of series RLC electrical network48 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:21 Let us now develop a technique for simplifying the solution for future problems. First, take the Laplace transform of the equations in the voltage-current column of Table 2.3 assuming zero initial conditions. For the capacitor, V s¬Ü¬à1 CsI s¬Ü 2.67¬Ü For the resistor, V s¬Ü¬àRI s¬Ü 2.68¬Ü For the inductor, V s¬Ü¬àLsI s¬Ü 2.69¬Ü Now de Ô¨Åne the following transfer function: V s¬Ü I s¬Ü¬àZ s¬Ü 2.70¬Ü Notice that this function is similar to the de Ô¨Ånition of resistance, that is, the ratio of voltage to current. But, unlike resistance, this function is applicable to capacitors andinductors and carries information on the dynamic behavior of the component, since itrepresents an equivalent differential equation. We call this particular transfer functionimpedance . The impedance for each of the electrical elements is shown in Table 2.3. Let us now demonstrate how the concept of impedance simpli Ô¨Åes the solution for the transfer function. The Laplace transform of Eq. (2.61), assuming zero initial conditions, is Ls¬áR¬á 1 Cs/C18/C19 I s¬Ü¬àV s¬Ü 2.71¬Ü Notice that Eq. (2.71), which is in the form ¬âSum of impedances ¬äI s¬Ü¬à¬âSum of applied voltages ¬ä 2.72¬Ü suggests the series circuit shown in Figure 2.5. Also notice that the circuit of Figure 2.5could have been obtained immediately from the circuit of Figure 2.3 simply by replacingeach element with its impedance. We call this altered circuit the transformed circuit . Finally, notice that the transformed circuit leads immediately to Eq. (2.71) if we addimpedances in series as we add resistors in series. Thus, rather than writing the differentialequation Ô¨Årst and then taking the Laplace transform, we can draw the transformed circuit and obtain the Laplace transform of the differential equation simply by applying Kirchhoff ‚Äôs voltage law to the transformed circuit. We summarize the steps as follows: 1.Redraw the original network showing all time variables, such as v(t),i(t), and v C t¬Ü,a s Laplace transforms V(s),I(s), and VC s¬Ü, respectively. 2.Replace the component values with their impedance values. This replacement is similar to the case of dc circuits, where we represent resistors with their resistance values. We now redo Example 2.6 using the transform methods just described and bypass thewriting of the differential equation.R Ls I(s)1 CsV(s)+‚Äì‚ÄìVC(s)+ FIGURE 2.5 Laplace-transformed network2.4 Electrical Network Transfer Functions 49WEBC02 10/28/2014 16:18:22 Simple Circuits via Nodal Analysis Transfer functions also can be obtained using Kirchhoff ‚Äôs current law and summing currents Ô¨Çowing from nodes. We call this method nodal analysis . We now demonstrate this principle by redoing Example 2.6 using Kirchhoff ‚Äôs current law and the transform methods just described to bypass writing the differential equation. Example 2.8 Transfer Function ‚ÄîSingle Node via Transform Methods Transfer Function ‚ÄîSingle Node via Transform Methods PROBLEM: Repeat Example 2.6 using nodal analysis and without writing a differential equation. SOLUTION: The transfer function can be obtained by summing currents Ô¨Çowing out of the node whose voltage is VC s¬Üin Figure 2.5. We assume that currents leaving the node are positive and currents entering the node are negative. The currents consist of the current through the capacitor and the current Ô¨Çowing through the series resistor and inductor. From Eq. (2.70), each I s¬Ü¬àV s¬Ü=Z s¬Ü. Hence, VC s¬Ü 1=Cs¬áVC s¬Ü V s¬Ü R¬áLs¬à0 2.76¬Ü where VC s¬Ü= 1=Cs¬Üis the current Ô¨Çowing out of the node through the capacitor, and ¬âVC s¬Ü V s¬Ü¬ä= R¬áLs¬Üis the current Ô¨Çowing out of the node through the series resistor and inductor. Solving Eq. (2.76) for the transfer function, VC s¬Ü=V s¬Ü, we arrive at the same result as Eq. (2.66).Example 2.7 Transfer Function ‚ÄîSingle L oop via Transform Methods Transfer Function ‚ÄîSingle Loop via Transform Methods PROBLEM: Repeat Example 2.6 using mesh analysis and transform methods without writing a differential equation. SOLUTION: Using Figure 2.5 and writing a mesh equation using the impedances as we would use resistor values in a purely resistive circuit, we obtain Ls¬áR¬á1 Cs/C18/C19 I s¬Ü¬àV s¬Ü 2.73¬Ü Solving for I(s)/V(s), I s¬Ü V s¬Ü¬à1 Ls¬áR¬á1 Cs 2.74¬Ü But the voltage across the capacitor, VC s¬Ü, is the product of the current and the impedance of the capacitor. Thus, VC s¬Ü¬àI s¬Ü1 Cs 2.75¬Ü Solving Eq. (2.75) for I(s) substituting I(s) into Eq. (2.74), and simplifying yields the same result as Eq. (2.66).50 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:24 Simple Circuits via Voltage Division Example 2.6 can be solved directly by using voltage division on the transformed network. We now demonstrate this technique. The previous example involves a simple, single-loop electrical network. Many electrical networks consist of multiple loops and nodes, and for these circuits we mustwrite and solve simultaneous differential equations in order to Ô¨Ånd the transfer function, or solve for the output. Complex Circuits via Mesh Analysis To solve complex electrical networks‚Äî those with multiple loops and nodes ‚Äîusing mesh analysis, we can perform the following steps: 1.Replace passive element values with their impedances. 2.Replace all sources and time variables with their Laplace transform. 3.Assume a transform current and a current direction in each mesh. 4.Write Kirchhoff ‚Äôs voltage law around each mesh. 5.Solve the simultaneous equations for the output. 6.Form the transfer function. Let us look at an example. Example 2.10 Transfer Function ‚ÄîMultiple L oops Transfer Function ‚ÄîMultiple Loops PROBLEM: Given the network of Figure 2.6( a),Ô¨Ånd the transfer function, I2 s¬Ü=V s¬Ü. SOLUTION: TheÔ¨Årst step in the solution is to convert the network into Laplace transforms for impedances and circuit variables, assuming zero initial conditions. The result is shown in Figure 2.6( b). The circuit with which we are dealing requires two simultaneous equations to solve for the transfer function. These equations can be found by summing voltages aroundExample 2.9 Transfer Function ‚ÄîSingle L oop via Voltage Division Transfer Function ‚ÄîSingle Loop via Voltage Division PROBLEM: Repeat Example 2.6 using voltage division and the transformed circuit. SOLUTION: The voltage across the capacitor is some proportion of the input voltage, namely the impedance of the capacitor divided by the sum of the impedances. Thus, VC s¬Ü¬à1=Cs Ls¬áR¬á1 Cs/C18/C19 V s¬Ü 2.77¬Ü Solving for the transfer function, VC s¬Ü=V s¬Ü, yields the same result as Eq. (2.66). Review Examples 2.6 through 2.9. Which method do you think is easiest for this circuit?2.4 Electrical Network Transfer Functions 51WEBC02 10/28/2014 16:18:24 each mesh through which the assumed currents, I1 s¬ÜandI2 s¬Ü,Ô¨Çow. Around Mesh 1, where I1 s¬ÜÔ¨Çows, R1I1 s¬Ü¬áLsI 1 s¬Ü LsI 2 s¬Ü¬àV s¬Ü 2.78¬Ü Around Mesh 2, where I2 s¬ÜÔ¨Çows, LsI 2 s¬Ü¬áR2I2 s¬Ü¬á1 CsI2 s¬Ü LsI1 s¬Ü¬à0 2.79¬Ü Combining terms, Eqs. (2.78) and (2.79) become simultaneous equations in I1 s¬ÜandI2 s¬Ü: R1¬áLs¬ÜI1 s¬Ü  LsI 2 s¬Ü¬àV s¬Ü (2.80a)  LsI 1 s¬Ü¬á Ls¬áR2¬á1 Cs/C18/C19 I2 s¬Ü¬à0 (2.80b) We can use Cramer ‚Äôs rule (or any other method for solving simultaneous equations) to solve Eq. (2.80) for I2 s¬Ü.4Hence, I2 s¬Ü¬à/C12/C12/C12/C12 R 1¬áLs¬ÜV s¬Ü  Ls 0/C12/C12/C12/C12 Œî¬àLsV s¬Ü Œî 2.81¬Ü where Œî¬à/C12/C12/C12/C12/C12 R 1¬áLs¬Ü  Ls  Ls Ls ¬áR2¬á1 Cs/C18/C19/C12/C12/C12/C12/C12 4See Appendix G (Section G.4) at www.wiley.com/college/nise for Cramer ‚Äôs rule.FIGURE 2.6 a.Two-loop electrical network; b.transformed two-loop electrical network; c.block diagram52 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:25 Complex Circuits via Nodal Analysis Often, the easiest way to Ô¨Ånd the transfer function is to use nodal analysis rather than mesh analysis. The number of simultaneous differential equations that must be written is equal to the number of nodes whose voltage is unknown. In the previous example we wrotesimultaneous mesh equations using Kirchhoff ‚Äôs voltage law. For multiple nodes we use Kirchhoff ‚Äôs current law and sum currents Ô¨Çowing from each node. Again, as a convention, currents Ô¨Çowing from the node are assumed to be positive, and currents Ô¨Çowing into the node are assumed to be negative. Before progressing to an example, let us Ô¨Årst de Ô¨Åneadmittance ,Y(s), as the reciprocal of impedance, or Y s¬Ü¬à1 Z s¬Ü¬àI s¬Ü V s¬Ü 2.84¬Ü When writing nodal equations, it can be more convenient to represent circuit elements bytheir admittance. Admittances for the basic electrical components are shown in Table 2.3. Let us look at an example.Forming the transfer function, G(s), yields G s¬Ü¬àI2 s¬Ü V s¬Ü¬àLs Œî¬àLCs2 R1¬áR2¬ÜLCs2¬á R1R2C¬áL¬Üs¬áR1 2.82¬Ü as shown in Figure 2.6( c). We have succeeded in modeling a physical network as a transfer function: The network of Figure 2.6( a) is now modeled as the transfer function of Figure 2.6( c). Before leaving the example, we notice a pattern Ô¨Årst illustrated by Eq. (2.72). The form that Eqs. (2.80) take is Sum of impedances around Mesh 12 435I 1 s¬Ü Sum of impedances common to the two meshes2 66643 7775I 2 s¬Ü¬àSum of applied voltages around Mesh 12 435 (2.83a)  Sum of impedances common to the two meshes266643 7775I 1 s¬Ü¬áSum of impedances around Mesh 22 435I 2 s¬Ü¬àSum of applied voltages around Mesh 22435 (2.83b) Recognizing the form will help us write such equations rapidly; for example, mechanical equations of motion (covered in Sections 2.5 and 2.6) have the same form. Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch2sp4 in Appendix F at www.wiley.com/college/nise , where Example 2.10 is solved. You will learn how to use the Symbolic Math Toolbox to solve simultaneous equations using Cramer‚Äô s rule. SpeciÔ¨Å cally, the Symbolic Math Toolbox will be used to solve for the transfer function in Eq.(2.82)using Eq.(2.80).2.4 Electrical Network Transfer Functions 53WEBC02 10/28/2014 16:18:27 Another way to write node equations is to replace voltage sources by current sources. A voltage source presents a constant voltage to any load; conversely, a current source delivers a constant current to any load. Practically, a current source can be constructed froma voltage source by placing a large resistance in series with the voltage source. Thus,variations in the load do not appreciably change the current because the current isdetermined approximately by the large series resistor and the voltage source. Theoretically,we rely on Norton ‚Äôs theorem , which states that a voltage source, V(s), in series with an impedance, Z s s¬Ü, can be replaced by a current source, I s¬Ü¬àV s¬Ü=Zs s¬Ü, in parallel with Zs s¬Ü. In order to handle multiple-node electrical networks, we can perform the following steps: 1.Replace passive element values with their admittances. 2.Replace all sources and time variables with their Laplace transform. 3.Replace transformed voltage sources with transformed current sources.Example 2.11 Transfer Function ‚ÄîMultiple Nodes T ransfer Function ‚ÄîMultiple Nodes PROBLEM: Find the transfer function, VC s¬Ü=V s¬Ü, for the circuit in Figure 2.6( b). Use nodal analysis.SOLUTION: For this problem, we sum currents at the nodes rather than sum voltages around the meshes. From Figure 2.6(b ) the sum of currents Ô¨Çowing from the nodes marked V L s¬ÜandVC s¬Üare, respectively, VL s¬Ü V s¬Ü R1¬áVL s¬Ü Ls¬áVL s¬Ü VC s¬Ü R2¬à0( 2.85a) CsV C s¬Ü¬áVC s¬Ü VL s¬Ü R2¬à0 (2.85b) Rearranging and expressing the resistances as conductances,5G1¬à1=R1andG2¬à1=R2, we obtain, G1¬áG2¬á1 Ls/C18/C19 VL s¬Ü  G2VC s¬Ü¬àV s¬ÜG1 (2.86a)  G 2VL s¬Ü¬á G2¬áCs¬ÜVC s¬Ü¬à0 (2.86b) Solving for the transfer function, VC s¬Ü=V s¬Ü, yields Eq. (2.87) as shown in Figure 2.7. VC s¬Ü V s¬Ü¬àG1G2 Cs G1¬áG2¬Üs2¬áG1G2L¬áC LCs¬áG2 LC 2.87¬ÜG1G2 CV(s) VC(s) (G1 + G2)s2 + G1G2L + C s + LC G2 LCs FIGURE 2.7 Block diagram of the network of Figure 2.6 5In general, admittance is complex. The real part is called conductance and the imaginary part is called susceptance. But when we take the reciprocal of resistance to obtain the admittance, a purely real quantity results. The reciprocal of resistance is called conductance.54 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:28 4.Write Kirchhoff ‚Äôs current law at each node. 5.Solve the simultaneous equations for the output. 6.Form the transfer function. Let us look at an example. A Problem-Solving Technique In all of the previous examples, we have seen a repeating pattern in the equations that we can use to our advantage. If we recognize this pattern, we need not write the equations component bycomponent; we can sum impedances around a mesh in the case of mesh equations or sumadmittances at a node in the case of node equations. Let us now look at a three-loop electricalnetwork and write the mesh equations by inspection to demonstrate the process.Example 2.12 Transfer Function ‚ÄîMultiple Nodes with Current Sources Transfer Function ‚ÄîMultiple Nodes with Current Sources PROBLEM: For the network of Figure 2.6, Ô¨Ånd the transfer function, VC s¬Ü=V s¬Ü, using nodal analysis and a transformed circuit with current sources. SOLUTION: Convertallimpedancestoadmittancesandallvoltagesources in series with an impedance to current sources in parallel with an admittance using Norton's theorem. Redrawing Figure 2.6( b)t or e Ô¨Çect the changes, we obtain Figure 2.8, where G1¬à1=R1;G2¬à1=R2, and the node voltages ‚Äîthe voltages across the inductor and the capacitor ‚Äîhave been identi Ô¨Åed as VL s¬ÜandVC s¬Ü, respectively. Using the general relationship, I s¬Ü¬àY s¬ÜV s¬Ü,a n ds u m m i n g currents at the node VL s¬Ü, G1VL s¬Ü¬á1 LsVL s¬Ü¬áG2¬âVL s¬Ü VC s¬Ü¬ä ¬àV s¬ÜG1 2.88¬Ü Summing the currents at the node VC s¬Üyields CsVC s¬Ü¬áG2¬âVC s¬Ü VL s¬Ü¬ä ¬à0 2.89¬Ü Combining terms, Eqs. (2.88) and (2.89) become simultaneous equations in VC s¬Üand VL s¬Ü, which are identical to Eq. (2.86) and lead to the same solution as Eq. (2.87). An advantage of drawing this circuit lies in the form of Eq. (2.86) and its direct relationship to Figure 2.8, namely Sum of admittances connected to Node 1/C20/C21 VL s¬Ü Sum of admittances common to the two nodes2 435V C s¬Ü¬àSum of applied currents at Node 1/C20/C21 (2.90a)  Sum of admittances common to the two nodes2435V L s¬Ü¬áSum of admittances connected to Node 2/C20/C21 VC s¬Ü¬àSum of applied currents at Node 2/C20/C21 (2.90b)1 LsV(s)G1 G1 CsVL(s)G2VC(s) FIGURE 2.8 Transformed network ready for nodal analysis2.4 Electrical Network Transfer Functions 55WEBC02 10/28/2014 16:18:29 Example 2.13 Mesh Equations via InspectionMesh Equations via Inspection PROBLEM: Write, but do not solve, the mesh equations for the network shown in Figure 2.9. SOLUTION: Each of the previous problems has illustrated that the mesh equations and nodal equations have a predictable form. We use that knowledge to solve this three-loop problem. The equation for Mesh 1 will have the following form: Sum of impedances around Mesh 12 6643 775I 1 s¬Ü Sum of impedances common to Mesh 1 and Mesh 22 6666666643 777777775I 2 s¬Ü  Sum of impedances common to Mesh 1 and Mesh 32 6666666643 777777775I 3 s¬Ü¬àSum of applied voltages around Mesh 12 6643 775 2.91¬Ü Similarly, Meshes 2 and 3, respectively, are  Sum of impedances common to Mesh 1 and Mesh 22 66666643 7777775I 1 s¬Ü¬áSum of impedances around Mesh 22 643 75I2 s¬Ü Sum of impedances common to Mesh 2 and Mesh 32 66666643 7777775I 3 s¬Ü¬àSum of appied voltages around Mesh 22 643 75 2.92¬ÜV(s)14 s1s 2s1 I1(s) I2(s)I3(s) 3s+‚Äì FIGURE 2.9 Three-loop electrical network56 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:30 Passive electrical circuits were the topic of discussion up to this point. We now discuss a class of active circuits that can be used to implement transfer functions. These are circuits built around an operational ampli Ô¨Åer. Operational Ampli Ô¨Åers Anoperational ampli Ô¨Åer, pictured in Figure 2.10( a), is an electronic ampli Ô¨Åer used as a basic building block to implement transfer functions. It has the following characteristics: 1.Differential input, v2 t¬Ü v1 t¬Ü 2.High input impedance, Zi¬à‚àû(ideal) 3.Low output impedance, Zo¬à0 (ideal) 4.High constant gain ampli Ô¨Åcation, A¬à‚àû(ideal) The output, vo t¬Ü, is given by vo t¬Ü¬àAv 2 t¬Ü v1 t¬Ü ¬Ü 2.95¬Ü Inverting Operational Ampli Ô¨Åer Ifv2 t¬Üis grounded, the ampli Ô¨Åer is called an inverting operational ampli Ô¨Åer, as shown in Figure 2.10( b). For the inverting operational ampli Ô¨Åer, we have vo t¬Ü¬à  Av1 t¬Ü 2.96¬Üand  Sum of impedances common to Mesh 1 and Mesh 32 66666643 7777775I 1 s¬Ü Sum of impedances common to Mesh 2 and Mesh 32 66666643 7777775I 2 s¬Ü ¬áSum of impedances around Mesh 32 643 75I3 s¬Ü¬àSum of applied voltages around Mesh 32 643 75 2.93¬Ü Substituting the values from Figure 2.9 into Eqs. (2.91) through (2.93) yields ¬á 2s¬á2¬ÜI1 s¬Ü  2s¬á1¬ÜI2 s¬Ü  I3 s¬Ü¬àV s¬Ü (2.94a)   2s¬á1¬ÜI1 s¬Ü¬á 9s¬á1¬ÜI2 s¬Ü  4sI3 s¬Ü¬à0 (2.94b)  I1 s¬Ü  4sI2 s¬Ü¬á 4s¬á1¬á1 s/C18/C19 I3 s¬Ü¬à0 (2.94c) which can be solved simultaneously for any desired transfer function, for example, I3 s¬Ü=V s¬Ü.TryIt 2.8 Use the following MATLAB and Symbolic Math Toolbox statements to help you solve for the electrical currents inEq. (2.94). syms sI 1I 2I 3V A=[(2*s+2) (2*s+1) ...  1  (2*s +1) (9*s +1) ...  4*s  1 4*s... (4*s +1+1/s) ] ; B=[I1;I2;I3] ; C=[V;0;0] ; B=inv(A) *C; pretty(B)2.4 Electrical Network Transfer Functions 57WEBC02 10/28/2014 16:18:31 If two impedances are connected to the inverting operational ampli Ô¨Åer as shown in Figure 2.10( c), we can derive an interesting result if the ampli Ô¨Åer has the characteristics mentioned in the beginning of this subsection. If the input impedance to the ampli Ô¨Åer is high, then by Kirchhoff ‚Äôs current law Ia s¬Ü¬à0 and I1 s¬Ü¬à  I2 s¬Ü. Also, since the gain Ais large, v1 t¬Ü‚âà0. Thus, I1 s¬Ü¬àVi s¬Ü=Z1 s¬Ü, and  I2 s¬Ü¬à  Vo s¬Ü=Z2 s¬Ü. Equating the two currents, Vo s¬Ü=Z2 s¬Ü¬à  Vi s¬Ü=Z1 s¬Ü, or the transfer function of the inverting operational ampli Ô¨Åer con Ô¨Ågured as shown in Figure 2.10( c)i s Vo s¬Ü Vi s¬Ü¬à Z2 s¬Ü Z1 s¬Ü 2.97¬Ü Example 2.14 Transfer Function ‚ÄîInv erting Operational Ampli Ô¨Åer Circuit Transfer Function ‚ÄîInverting Operational Ampli Ô¨Åer Circuit PROBLEM: Find the transfer function, Vo s¬Ü=Vi s¬Ü, for the circuit given in Figure 2.11. R2 = 220 kŒ© vo(t)C2 = 0.1 ŒºFC1 = 5.6 ŒºF R1 = 360 kŒ©vi(t) v1(t) +‚Äì FIGURE 2.11 Inverting operational ampli Ô¨Åer circuit for Example 2.14A (a) (c)+v1(t) +v2(t)vo(t) Vi(s) I2(s) Vo(s) I1(s)Ia(s)Z1(s)A (b)vo(t)v1(t) V1(s)Z2(s)+V ‚ÄìV +‚Äì+‚Äì +‚Äì FIGURE 2.10 a.Operational ampli Ô¨Åer;b.schematic for an inverting operational ampli Ô¨Åer; c.inverting operational ampli Ô¨Åer con Ô¨Ågured for transfer function realization. Typically, the ampli Ô¨Åer gain, A, is omitted.58 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:32 Noninverting Operational AmpliÔ¨Å er Another circuit that can be analyzed for its transfer function is the noninverting operational ampli Ô¨Åer circuit shown in Figure 2.12. We now derive the transfer function. We see that Vo s¬Ü¬àAV i s¬Ü V1 s¬Ü ¬Ü 2.101 ¬Ü But, using voltage division, V1 s¬Ü¬àZ1 s¬Ü Z1 s¬Ü¬áZ2 s¬ÜVo s¬Ü 2.102 ¬Ü Substituting Eq. (2.102) into Eq. (2.101), rearranging, and simplifying, we obtain Vo s¬Ü Vi s¬Ü¬àA 1¬áAZ1 s¬Ü=Z1 s¬Ü¬áZ2 s¬Ü ¬Ü 2.103 ¬Ü For large A, we disregard unity in the denominator and Eq. (2.103) becomes Vo s¬Ü Vi s¬Ü¬àZ1 s¬Ü¬áZ2 s¬Ü Z1 s¬Ü 2.104 ¬Ü Let us now look at an example.SOLUTION: The transfer function of the operational ampli Ô¨Åer circuit is given by Eq. (2.97). Since the admittances of parallel components add, Z1 s¬Üis the reciprocal of the sum of the admittances, or Z1 s¬Ü¬à1 C1s¬á1 R1¬à1 5:6¬á10 6s¬á1 360103¬à360103 2:016s¬á1 2.98¬Ü ForZ2 s¬Üthe impedances add, or Z2 s¬Ü¬àR2¬á1 C2s¬à220103¬á107 s 2.99¬Ü Substituting Eqs. (2.98) and (2.99) into Eq. (2.97) and simplifying, we get Vo s¬Ü Vi s¬Ü¬à 1:232s2¬á45:95s¬á22:55 s 2.100 ¬Ü The resulting circuit is called a PID controller and can be used to improve the performance of a control system. We explore this possibility further in Chapter 9. ‚Äì +Z2(s) Z1(s)V1(s) Vi(s)Vo(s) FIGURE 2.12 General noninverting operational ampli Ô¨Åer circuit2.4 Electrical Network Transfer Functions 59WEBC02 10/28/2014 16:18:33 Skill-Assessment Exercise 2.6 PROBLEM: Find the transfer function, G s¬Ü¬àVL s¬Ü=V s¬Ü, for the circuit given in Figure 2.14. Solve the problem two ways ‚Äîmesh analysis and nodal analysis. Show that the two methods yield the same result. ANSWER: VL s¬Ü=V s¬Ü¬à s2¬á2s¬á1¬Ü= s2¬á5s¬á2¬Ü The complete solution is at www.wiley.com/college/nise .Example 2.15 Transfer Function ‚ÄîNonin v erting Operational Ampli Ô¨Åer CircuitTransfer Function ‚ÄîNoninverting Operational Ampli Ô¨Åer Circuit PROBLEM: Find the transfer function, Vo s¬Ü=Vi s¬Ü, for the circuit given in Figure 2.13. SOLUTION: WeÔ¨Ånd each of the impedance functions, Z1 s¬ÜandZ2 s¬Ü, and then substitute them into Eq. (2.104). Thus, Z1 s¬Ü¬àR1¬á1 C1s 2.105 ¬Ü and Z2 s¬Ü¬àR2 1=C2s¬Ü R2¬á 1=C2s¬Ü 2.106 ¬Ü Substituting Eqs. (2.105) and (2.106) into Eq. (2.104) yields Vo s¬Ü Vi s¬Ü¬àC2C1R2R1s2¬á C2R2¬áC1R2¬áC1R1¬Üs¬á1 C2C1R2R1s2¬á C2R2¬áC1R1¬Üs¬á1 2.107 ¬ÜR2 R1v1(t) vi(t)vo(t)C2 C1‚Äì + FIGURE 2.13 Noninverting operational ampli Ô¨Åer circuit for Example 2.15 + ‚Äìv(t) vL(t)1Œ© 1Œ©1H 1 H 1 H+‚Äì FIGURE 2.14 Electric circuit for Skill-Assessment Exercise 2.660 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:33 In this section, we found transfer functions for multiple-loop and multiple-node electrical networks, as well as operational ampli Ô¨Åer circuits. We developed mesh and nodal equations, noted their form, and wrote them by inspection. In the next section we begin our work with mechanical systems. We will see that many of the concepts applied to electricalnetworks can also be applied to mechanical systems via analogies ‚Äîfrom basic concepts to writing the describing equations by inspection. This revelation will give you the con Ô¨Ådence to move beyond this textbook and study systems not covered here, such as hydraulic orpneumatic systems. 2.5 Translational Mechanical System Transfer Functions We have shown that electrical networks can be modeled by a transfer function, G(s), that algebraically relates the Laplace transform of the output to the Laplace transform of theinput. Now we will do the same for mechanical systems. In this section we concentrate ontranslational mechanical systems. In the next section we extend the concepts to rotationalmechanical systems. Notice that the end product, shown in Figure 2.2, will be mathemati-cally indistinguishable from an electrical network. Hence, an electrical network can be interfaced to a mechanical system by cascading their transfer functions, provided that one system is not loaded by the other. 6 Mechanical systems parallel electrical networks to such an extent that there are analogies between electrical and mechanical components and variables. Mechanicalsystems, like electrical networks, have three passive, linear components. Two of them,the spring and the mass, are energy-storage elements; one of them, the viscous damper,dissipates energy. The two energy-storage elements are analogous to the two electricalenergy-storage elements, the inductor and capacitor. The energy dissipator is analogous to electrical resistance. Let us take a look at these mechanical elements, which are shown in Table 2.4. In the table, K,f v, and Mare called spring constant ,coefÔ¨Åcient of viscous friction , andmass , respectively. We now create analogies between electrical and mechanical systems by comparing Tables 2.3 and 2.4. Comparing the force-velocity column of Table 2.4 to the voltage-currentcolumn of Table 2.3, we see that mechanical force is analogous to electrical voltage andmechanical velocity is analogous to electrical current. Comparing the force-displacementcolumn of Table 2.4 with the voltage-charge column of Table 2.3 leads to the analogy between the mechanical displacement and electrical charge. We also see that the spring isSkill-Assessment Exercise 2.7 PROBLEM: IfZ1 s¬Üis the impedance of a 10 ŒºF capacitor and Z2 s¬Üis the impedance of a 100 k Œ©resistor, Ô¨Ånd the transfer function, G s¬Ü¬àVo s¬Ü=Vi s¬Ü, if these components are used with (a) an inverting operational ampli Ô¨Åer and (b) a noninverting ampli Ô¨Åer as shown in Figures 2.10(c) and 2.12, respectively. ANSWER: G s¬Ü¬à sfor an inverting operational ampli Ô¨Åer;G s¬Ü¬às¬á1 for a noninverting operational ampli Ô¨Åer. The complete solution is at www.wiley.com/college/nise . 6The concept of loading is explained further in Chapter 5.2.5 Translational Mechanical System Transfer Functions 61WEBC02 10/28/2014 16:18:34 analogous to the capacitor, the viscous damper is analogous to the resistor, and the mass is analogous to the inductor. Thus, summi ng forces written in t erms of velocity is analogous to summing vo ltages written in terms of current , and the resulting mechanical differential equations are analogous to mesh equations. If the forces are written in terms of displacement, the resulting m echanical equations resemb le, but are not analogous to, the mesh equations. We, however, will use t his model for mechanical systems so that we can write equations directly in terms of displacement. Another analogy can be drawn by comparing the force-velocity column of Table 2.4 to the current-voltage column of Table 2.3 in reverse order. Here the analogyis between force and current and between ve locity and voltage. Also, the spring is analogous to the inductor, the viscous damper is analogous to the resistor, and the massis analogous to the capacitor. Thus, summing forces written in terms of velocity isanalogous to summing currents written in te rms of voltage and the resulting mechanical differential equations are analogous to nodal equations. We will discuss these analogiesin more detail in Section 2.9. We are now ready to Ô¨Ånd transfer functions for trans lational mechanical systems. OurÔ¨Årst example, shown in Figure 2.15(a ), is similar to the simple RLC network of Example 2.6 (see Figure 2.3). The mechanical system requires just one differentialequation, called the equation of motion ,t od e s c r i b ei t .W ew i l lb e g i nb ya s s u m i n ga positive direction of motion, for example, to the right. This assumed positive direction ofmotion is similar to assuming a current direction in an electrical loop. Using our assumeddirection of positive motion, we Ô¨Årst draw a free-body diagram, placing on the body all forces that act on the body either in the direction of motion or opposite to it. Next we use Newton ‚Äôs law to form a differential equation of motion by summing the forces and setting the sum equal to zero. Finally, assuming zer o initial conditions, we take the Laplace transform of the differential equation, separa te the variables, and arrive at the transfer function. An example follows.TABLE 2.4 Force-velocity, force-displacement, and impedance translational relationships for springs, viscous dampers, and mass Component Force-velocity Force-displacementImpedence ZM s¬Ü¬àF s¬Ü=X s¬Ü KSpring x(t) f(t)f t¬Ü¬àKZt 0v œÑ¬ÜdœÑ f t¬Ü¬àKx t¬Ü K fvViscous damper x(t) f(t)f t¬Ü¬àfvv t¬Ü f t¬Ü¬àfvdx t¬Ü dtfvs Mass x(t) f(t) Mf t¬Ü¬àMdv t¬Ü dtf t¬Ü¬àMd2x t¬Ü dt2 Ms2 Note: The following set of symbols and units is used throughout this book: f t¬Ü¬àN newtons ¬Ü,x t¬Ü¬àm meters ¬Ü, v t¬Ü¬àm/s meters/second ¬Ü,K=N/m (newtons/meter), fv¬àN-s/m newton-seconds =meter ¬Ü,M¬àkg kilograms ¬à newton-seconds2/meter ¬Ü.62 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:35 Now can we parallel our work with electrical networks by circumventing the writing of differential equations and by de Ô¨Åning impedances for mechanical components? If so, we can apply to mechanical systems the problem-solving techniques learned in the previous section. Taking the Laplace transform of the force-displacement column in Table 2.4, weobtain for the spring, F s¬Ü¬àKX s¬Ü 2.112 ¬ÜExample 2.16 Transfer Function ‚ÄîOne Equation of Motion Transfer Function ‚ÄîOne Equation of Motion PROBLEM: Find the transfer function, X s¬Ü=F s¬Ü, for the system of Figure 2.15( a). SOLUTION: Begin the solution by drawing the free-body diagram shown in Figure 2.16( a). Place on the mass all forces felt by the mass. We assume the mass is traveling toward the right. Thus, only the applied force points to the right; all other forces impede the motionand act to oppose it. Hence, the spring, viscous damper, and the force due to accelerationpoint to the left. We now write the differential equation of motion using Newton‚Äô s law to sum to zero all of the forces shown on the mass in Figure 2.16( a): M d2x t¬Ü dt2¬áfvdx t¬Ü dt¬áKx t¬Ü¬àf t¬Ü 2.108 ¬Ü Taking the Laplace transform, assuming zero initial conditions, Ms2X s¬Ü¬áfvsX s¬Ü¬áKX s¬Ü¬àF s¬Ü 2.109 ¬Ü or Ms2¬áfvs¬áK¬ÜX s¬Ü¬àF s¬Ü 2.110 ¬Ü Solving for the transfer function yields G s¬Ü¬àX s¬Ü F s¬Ü¬à1 Ms2¬áfvs¬áK 2.111 ¬Ü which is represented in Figure 2.15( b).F(s) (b)fvsX(s) Ms2X(s)KX(s) f(t) (a)fv MKx(t) dx dt d2x dt2M MX(s) x(t) FIGURE 2.16 a.Free-body diagram of mass, spring, and damper system; b.transformed free-body diagram(a)( b)X(s) F(s)K f(t)x(t) fvM1 Ms2 + fvs + K FIGURE 2.15 a.Mass, spring, and damper system;b.block diagram2.5 Translational Mechanical System Transfer Functions 63WEBC02 10/28/2014 16:18:35 for the viscous damper, F s¬Ü¬àfvsX s¬Ü 2.113 ¬Ü and for the mass, F s¬Ü¬àMs2X s¬Ü 2.114 ¬Ü If we de Ô¨Åne impedance for mechanical components as ZM s¬Ü¬àF s¬Ü X s¬Ü 2.115 ¬Ü and apply the de Ô¨Ånition to Eqs. (2.112) through (2.114), we arrive at the impedances of each component as summarized in Table 2.4 ( Raven ,1995 ).7 Replacing each force in Figure 2.16( a) by its Laplace transform, which is in the format F s¬Ü¬àZM s¬ÜX s¬Ü 2.116 ¬Ü we obtain Figure 2.16( b), from which we could have obtained Eq. (2.109) immediately without writing the differential equation. From now on we use this approach. Finally, notice that Eq. (2.110) is of the form ¬âSum of impedances ¬äX s¬Ü¬à¬âSum of applied forces ¬ä 2.117 ¬Ü which is similar, but not analogous, to a mesh equation (see footnote 7). Many mechanical systems are similar to multiple-loop and multiple-node electrical networks, where more than one simultaneous differential equation is required to describe the system. In mechanical systems, the number of equations of motion required is equal to thenumber of linearly independent motions. Linear independence implies that a point of motion in a system can still move if all other points of motion are held still. Another namefor the number of linearly independent motions is the number of degrees of freedom . This discussion is not meant to imply that these motions are not coupled to one another; ingeneral, they are. For example, in a two-loop electrical network, each loop current depends on the other loop current, but if we open-circuit just one of the loops, the other current can still exist if there is a voltage source in that loop. Similarly, in a mechanical system with twodegrees of freedom, one point of motion can be held still while the other point of motionmoves under the in Ô¨Çuence of an applied force. In order to work such a problem, we draw the free-body diagram for each point of motion and then use superposition. For each free-body diagram we begin by holding allother points of motion still and Ô¨Ånding the forces acting on the body due only to its own motion. Then we hold the body still and activate the other points of motion one at a time, placing on the original body the forces created by the adjacent motion. Using Newton ‚Äôs law, we sum the forces on each body and set the sum to zero. The result is a system of simultaneous equations of motion. As Laplace transforms, these 7Notice that the impedance column of Table 2.4 is not a direct analogy to the impedance column of Tabel 2.3, since the denominator of Eq. (2.115) is displacement. A direct analogy could be derived by de Ô¨Åning mechanical impedance in terms of velocity as F s¬Ü=V s¬Ü. We chose Eq. (2.115) as a convenient de Ô¨Ånition for writing the equations of motion in terms of displacement, rather than velocity. The alternative, however, is available.64 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:37 equations are then solved for the output variable of interest in terms of the input variable from which the transfer function is evaluated. Example 2.17 demonstrates this problem-solving technique. Example 2.17 Transfer Function ‚ÄîTwo Degrees of Freedom Transfer Function ‚ÄîTwo Degrees of Freedom PROBLEM: Find the transfer function, X2 s¬Ü=F s¬Ü, for the system of Figure 2.17( a). SOLUTION: The system has two degrees of freedom, since each mass can be moved in the horizontal direction while the other is he ld still. Thus, two simu ltaneous equations of motion will be required to describe the sys tem. The two equations come from free-body diagrams of each mass. Superposition is used to draw the free-body diagrams. For example, the forces on M1are due to (1) its own motion and (2) the motion of M2 transmitted to M1through the system. We will consider these two sources separately. If we hold M2still and move M1to the right, we see the forces shown in Figure 2.18( a). If we hold M1still and move M2to the right, we see the forces shown in Figure 2.18( b). The total force on M1is the superposition, or sum, of the forces just discussed. This result is shown in Figure 2.18( c). For M2, we proceed in a similar fashion: First we move M2to the right while holding M1still; then we move M1to the right and hold M2still. For each case we evaluate the forces on M2. The results appear in Figure 2.19.K1 K3f(t)fv3 fv1fv2M1 M2 K2x1(t) x2(t) (a) (fv3s+K2) ŒîX2(s) F(s) (b)FIGURE 2.17 a.Two- degrees-of-freedom translational mechanical system;8b.block diagram K1X1(s) fv1sX1(s) F(s) M1s2X1(s) afv3sX1(s) K2X1(s) (b)fv3sX2(s)K2X2(s) (K1 + K 2)X1(s) F(s) M1s2X1(s)(fv1 + fv3)sX1(s) fv3sX2(s)K2X2(s) (c)( )M1 M1 M1FIGURE 2.18 a.Forces on M1due only to motion of M1; b.forces on M1due only to motion of M2;c.all forces onM1Virtual Experiment 2.1 Vehicle Suspension Put theory into practice exploring the dynamics ofanother two-degrees-of- freedom system ‚Äîa vehicle suspension system driving over a bumpy road anddemonstrated with the Quanser Active Suspension System modeled inLabVIEW. ¬© Debra Lex Virtual experiments are foundon Learning Space. 8Friction shown here and throughout the book, unless otherwise indicated, is viscous friction. Thus, fv1andfv2are not Coulomb friction, but arise because of a viscous interface.2.5 Translational Mechanical System Transfer Functions 65WEBC02 10/28/2014 16:18:37 Notice again, in Eq. (2.118), that the form of the equations is similar to electrical mesh equations: Sum of impedances connected to the motion atx12 66666643 7777775X 1 s¬Ü Sum of impedances between x1andx22 666643 77775X 2 s¬Ü¬àSum of applied forces atx12 643 75 (2.120a)  Sum of impedances between x1andx22 666643 77775X 1 s¬Ü¬áSum of impedances connected to the motion atx22 66666643 7777775X 2 s¬Ü¬àSum of applied forces atx22 643 75 (2.120b) The pattern shown in Eq. (2.120) should now be familiar to us. Let us use the concept to write the equations of motion of a three-degrees-of-freedom mechanical network byinspection, without drawing the free-body diagram.The Laplace transform of the equations of motion can now be written from Figures 2.18( c) and 2.19( c)a s ¬âM1s2 Fv1¬áfv3¬Üs¬á K1¬áK2¬Ü¬äX1 s¬Ü  fv3s¬áK2¬ÜX2 s¬Ü¬àF s¬Ü (2.118a)   fv3s¬áK2¬ÜX1 s¬Ü¬á¬âM2s2¬á fv2¬áfv3¬Üs¬á K2¬áK3¬Ü¬äX2 s¬Ü¬à0 (2.118b) From this, the transfer function, X2 s¬Ü=F s¬Ü,i s X2 s¬Ü F s¬Ü¬àG s¬Ü¬à fv3s¬áK2¬Ü Œî 2.119 ¬Ü as shown in Figure 2.17( b) where Œî¬à/C12/C12/C12/C12/C12¬âM 1s2¬á fv1¬áfv3¬Üs¬á K1¬áK2¬Ü¬ä   fv3s¬áK2¬Ü   fv3s¬áK2¬Ü¬â M2s2¬á fv2¬áfv3¬Üs¬á K2¬áK3¬Ü¬ä/C12/C12/C12/C12/C12K2X2(s) fv2sX2(s) M2s2X2(s)fv3sX2(s) (a)K3X2(s) (b)fv3sX1(s) (K2 + K3)X2(s) M2s2X2(s)(fv2 + fv3)sX2(s)fv3sX1(s)K2X1(s) (c)K2X1(s)M2 M2 M2FIGURE 2.19 a.Forces on M2due only to motion of M2; b.forces on M2due only to motion of M1;c.all forces onM266 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:39 Example 2.18 Equations of Motion by InspectionEquations of Motion by Inspection PROBLEM: Write, but do not solve, the equations of motion for the mechanical network of Figure 2.20. SOLUTION: The system has three degrees of freedom, since each of the three masses can be moved independently while the others are held still. The form of the equations will be similar to electrical mesh equations. For M1, Sum of impedances connected to the motion atx12 66666643 7777775X 1 s¬Ü Sum of impedances between x1andx22 666643 77775X 2 s¬Ü  Sum of impedances between x1andx32 666643 77775X 3 s¬Ü¬àSum of applied forces atx12 643 75 2.121 ¬Ü Similarly, for M2andM3, respectively,  Sum of impedances between x1andx22 666643 77775X 1 s¬Ü¬áSum of impedances connected to the motion atx22 66666643 7777775X 2 s¬Ü  Sum of impedances between x2andx32 666643 77775X 3 s¬Ü¬àSum of applied forces atx22 643 75 2.122 ¬Üx2(t)x3(t) f(t) fv1fv2K1 K2fv3 M2 M1fv4M3 x1(t) FIGURE 2.20 Three-degrees- of-freedom translational mechanical system2.5 Translational Mechanical System Transfer Functions 67WEBC02 10/28/2014 16:18:40  Sum of impedances between x1andx32 666643 77775X 1 s¬Ü Sum of impedances between x2andx32 666643 77775X 2 s¬Ü ¬áSum of impedances connected to the motion atx32 66666643 7777775X 3 s¬Ü¬àSum of applied forces atx32 643 75 2.123 ¬Ü M1has two springs, two viscous dampers, and mass associated with its motion. There is one spring between M1andM2and one viscous damper between M1andM3. Thus, using Eq. (2.121), ¬âM1s2¬á fv1¬áfv3¬Üs¬á K1¬áK2¬Ü¬äX1 s¬Ü K2X2 s¬Ü fv3sX3 s¬Ü¬à0 2.124 ¬Ü Similarly, using Eq. (2.122) for M2,  K 2X1 s¬Ü¬á¬âM2s2¬á fv2¬áfv4¬Üs¬áK2¬äX2 s¬Ü fv4sX3 s¬Ü¬àF s¬Ü 2.125 ¬Ü and using Eq. (2.123) for M3,  fv3sX1 s¬Ü fv4sX2 s¬Ü¬á¬âM3s2¬á fv3¬áfv4¬Üs¬äX3 s¬Ü¬à0 2.126 ¬Ü Equations (2.124) through (2.126) are the equations of motion. We can solve them for any displacement, X1 s¬Ü;X2 s¬Ü;orX3 s¬Ü, or transfer function. Skill-Assessment Exercise 2.8 PROBLEM: Find the transfer function, G s¬Ü¬àX2 s¬Ü=F s¬Ü, for the translational mechanical system shown in Figure 2.21. ANSWER: G s¬Ü¬à3s¬á1 s s3¬á7s2¬á5s¬á1¬Ü The complete solution is at www.wiley.com/college/nise .fv1= 1 N-s/m fv2= 1 N-s/m fv4=1 N - s / mfv3= 1 N-s/mK=1 N / m M1= 1 kg M2=1 k gx1(t) f(t)x2(t) FIGURE 2.21 Translational mechanical system for Skill- Assessment Exercise 2.868 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:41 2.6 Rotational Mechanical System Transfer Functions Having covered electrical and translational mechanical systems, we now move on to consider rotational mechanical systems. Rotational mechanical systems are handled thesame way as translational mechanical systems, except that torque replaces force and angulardisplacement replaces translational displacement. The mechanical components for rotationalsystems are the same as those for translational systems, except that the components undergorotation instead of translation. Table 2.5 shows the components along with the relationshipsbetween torque and angular velocity, as well as angular displacement. Notice that the symbols for the components look the same as translational symbols, but they are undergoing rotation and not translation. Also notice that the term associated w ith the mass is replaced by inertia. The values of K,D,a n dJ are called spring constant ,coefÔ¨Åcient of viscous friction ,a n d moment of inertia , respectively. The impedances of the mechanical components are also summarized in the last column of Table 2.5. The values can be found by taking theLaplace transform, assuming zero initial conditions, of the torque-angular displacementcolumn of Table 2.5. The concept of degrees of freedom carries over to rotational systems, except that we test a point of motion by rotating it while holding still all other points of motion. The number of points of motion that can be rotated while all others are held still equals thenumber of equations of motion required to describe the system. Writing the equations of motion for rotational systems is similar to writing them for translational systems; the only difference is that the free-body diagram consists of torquesrather than forces. We obtain these torques using superposition. First, we rotate a body whileholding all other points still and place on its free-body diagram all torques due to the body ‚Äôs own motion. Then, holding the body still, we rotate adjacent points of motion one at a timeand add the torques due to the adjacent motion to the free-body diagram. The process isrepeated for each point of motion. For each free-body diagram, these torques are summedand set equal to zero to form the equations of motion. TABLE 2.5 Torque-angular velocity, torque-angular displacement, and impedance rotational relationships for springs, viscous dampers, and inertia ComponentTorque-angular velocityTorque-angular displacementImpedence ZM s¬Ü¬àT s¬Ü=Œ∏ s¬Ü KSpringT(t) (t) Œ∏ T t¬Ü¬àKRt 0œâ œÑ¬ÜdœÑ T t¬Ü¬àKŒ∏ t¬Ü K DViscous damperT(t) (t) Œ∏ T t¬Ü¬àDœâ t¬Ü T t¬Ü¬àDdŒ∏ t¬Ü dtDs JInertiaT(t) (t) Œ∏ T t¬Ü¬àJdœâ t¬Ü dtT t¬Ü¬àJd2Œ∏ t¬Ü dt2Js2 Note: The following set of symbols and units is used throughout this book: T t¬Ü N-m newton-meters ¬Ü, Œ∏ t¬Ü rad radians ¬Ü,œâ t¬Ü rad/s radians/second ¬Ü,K N-m/rad newton-meters/radian ¬Ü,D N-m-s/rad newton- meters-seconds/radian ¬Ü:J kg-m2 kilograms-meters2 newton-meters-seconds2/radian ¬Ü.2.6 Rotational Mechanical System Transfer Functions 69WEBC02 10/28/2014 16:18:42 Two examples will demonstrate the solution of rotational systems. The Ô¨Årst one uses free-body diagrams; the second uses the concept of impedances to write the equations of motion by inspection. 9In this case the parameter is referred to as a distributed parameter. 10The parameter is now referred to as a lumped parameter.Example 2.19 Transfer Function ‚ÄîTwo Equations of Motion Transfer Function ‚ÄîTwo Equations of Motion PROBLEM: Find the transfer function, Œ∏2 s¬Ü=T s¬Ü, for the rotational system shown in Figure 2.22( a). The rod is supported by bearings at either end and is undergoing torsion. A torque is applied at the left, and the displacement is measured at the right. SOLUTION: First, obtain the schematic from the physical system. Even though torsion occurs throughout the rod in Figure 2.22( a),9we approximate the system by assuming that the torsion acts like a spring concentrated at one particular point in the rod, with an inertia J1to the left and an inertia J2to the right.10We also assume that the damping inside the Ô¨Çexible shaft is negligible. The schematic is shown in Figure 2.22( b). There are two degrees of freedom, since each inertia can be rotated while the other is held still.Hence, it will take two simultaneous equations to solve the system. Next, draw a free-body diagram of J 1, using superposition. Figure 2.23(a ) shows the torques on J1ifJ2is held still and J1rotated. Figure 2.23( b) shows the torques on J1ifJ1 is held still and J2rotated. Finally, the sum of Figures 2.23( a) and 2.23( b) is shown in Figure 2.23( c), the Ô¨Ånal free-body diagram for J1. The same process is repeated in Figure 2.24 for J2.Œ∏1(t) Œ∏2(t) D1 K D2T(t) (b)Œ∏1(t) T(t) Œ∏2(t) Bearing D1Bearing D2Torsion (a)J2J1 J2J1 K Œî (c)T(s) Œ∏2(s)FIGURE 2.22 a.Physical system; b.schematic; c.block diagram (a)J1 KT(s) (b)( c)D1sŒ∏1(s) Œ∏1(s) KŒ∏2(s)KŒ∏1(s)D1sŒ∏1(s)J1s2Œ∏1(s)T(s)Direction Œ∏1 Œ∏1 Œ∏1 (s) J1 J1J1s2Œ∏1(s) KŒ∏2(s)Direction(s) Direction(s) FIGURE 2.23 a.Torques on J1due only to the motion of J1; b.torques on J1due only to the motion of J2;c.Ô¨Ånal free-body diagram for J170 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:44 Summing torques, respectively, from Figures 2.23( c) and 2.24( c) we obtain the equations of motion, J1s2¬áD1s¬áK¬ÜŒ∏1 s¬Ü  KŒ∏2 s¬Ü¬àT s¬Ü (2.127a)  KŒ∏1 s¬Ü¬á J2s2¬áD2s¬áK¬ÜŒ∏2 s¬Ü¬à0 (2.127b) from which the required transfer function is found to be Œ∏2 s¬Ü T s¬Ü¬àK Œî 2.128 ¬Ü as shown in Figure 2.22( c), where Œî¬à/C12/C12/C12/C12/C12 J 1s2¬áD1s¬áK¬Ü  K  K J2s2¬áD2s¬áK¬Ü/C12/C12/C12/C12/C12 Notice that Eqs. (2.127) have that now well-known form Sum of impedances connected to the motion atŒ∏ 12 6666643 777775Œ∏ 1 s¬Ü Sum of impedances between Œ∏1andŒ∏22 66643 7775Œ∏ 2 s¬Ü¬àSum of applied torques atŒ∏12 435 (2.129a)  Sum of impedances between Œ∏ 1andŒ∏22 66643 7775Œ∏ 1 s¬Ü¬áSum of impedances connected to the motion atŒ∏22 6666643 777775Œ∏ 2 s¬Ü¬àSum of applied torques atŒ∏22 435 (2.129b)Œ∏2(s) D2s KJ2J2s2 (a)( b)( c)Œ∏2(s) Œ∏2(s) Œ∏2(s) Œ∏2(s) Œ∏2(s)KŒ∏1(s) J2KŒ∏1(s) Œ∏2(s) D2sJ2s2 Œ∏2(s) KŒ∏2(s)Direction Direction Direction J2 FIGURE 2.24 a.Torques on J2due only to the motion of J2; b.torques on J2due only to the motion of J1;c.Ô¨Ånal free-body diagram for J2 TryIt 2.9 Use the following MATLAB and Symbolic Math Toolbox statements to help you get Eq. (2.128). syms s J 1D 1KTJ 2D 2 . . . theta1 theta2 A=[ (J1*s^2 +D1*s+K) K  K (J2*s^2 +D2*s +K) ] ; B=[theta1 theta2] ; C=[T 0] ; B=inv(A) *C; theta2 =B(2) ; 'theta2' pretty (theta2) Example 2.20 Equations of Motion by InspectionEquations of Motion by Inspection PROBLEM: Write, but do not solve, the Laplace transform of the equations of motion for the system shown in Figure 2.25. Œ∏1(t) Œ∏2(t) Œ∏3(t) T(t) D1 KD 2 D3J2 J1 J3FIGURE 2.25 Three-degrees- of-freedom rotational system2.6 Rotational Mechanical System Transfer Functions 71WEBC02 10/28/2014 16:18:45 SOLUTION: The equations will take on the following form, similar to electrical mesh equations: Sum of impedances connected to the motion atŒ∏12 66666643 7777775Œ∏ 1 s¬Ü Sum of impedances between Œ∏1andŒ∏22 666643 77775Œ∏ 2 s¬Ü  Sum of impedances between Œ∏1andŒ∏32 666643 77775Œ∏ 3 s¬Ü¬àSum of applied torques atŒ∏12 643 75(2.130a)  Sum of impedances between Œ∏1andŒ∏22 666643 77775Œ∏ 1 s¬Ü¬áSum of impedances connected to the motion atŒ∏22 66666643 7777775Œ∏ 2 s¬Ü  Sum of impedances between Œ∏2andŒ∏32 666643 77775Œ∏ 3 s¬Ü¬àSum of applied torques atŒ∏22 643 75(2.130b)  Sum of impedances between Œ∏1andŒ∏32 666643 77775Œ∏ 1 s¬Ü Sum of impedances between Œ∏2andŒ∏32 666643 77775Œ∏ 2 s¬Ü ¬áSum of impedances connected to the motion atŒ∏32 66666643 7777775Œ∏ 3 s¬Ü¬àSum of applied torques atŒ∏32 643 75(2.130c) Hence, J1s2¬áD1s¬áK¬ÜŒ∏1 s¬Ü  KŒ∏2 s¬Ü  0Œ∏3 s¬Ü¬àT s¬Ü  KŒ∏1 s¬Ü¬á J2s2¬áD2s¬áK¬ÜŒ∏2 s¬Ü  D2sŒ∏3 s¬Ü¬à0  0Œ∏1 s¬Ü  D2sŒ∏2 s¬Ü¬á J3s2¬áD3s¬áD2s¬ÜŒ∏3 s¬Ü¬à0 (2.131a,b,c)72 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:45 2.7 Transfer Functions for Systems with Gears Now that we are able to Ô¨Ånd the transfer function for rotational systems, we realize that these systems, especially those driven by motors, are rarely seen without associated gear trains driving the load. This section covers this important topic. Gears provide mechanical advantage to rotational systems. Anyone who has ridden a 10-speed bicycle knows the effect of gearing. Going uphill, you shift to provide more torqueand less speed. On the straightaway, you shift to obtain more speed and less torque. Thus, gearsallow you to match the drive system and the load ‚Äîa trade-off between speed and torque. For many applications, gears exhibit backlash , which occurs because of the loose Ô¨Åt between two meshed gears. The drive gear rotates through a small angle before makingcontact with the meshed gear. The result is that the angular rotation of the output gear doesnot occur until a small angular rotation of the input gear has occurred. In this section, weidealize the behavior of gears and assume that there is no backlash. The linearized interaction between two gears is depicted in Figure 2.27. An input gear with radius r 1andN1teeth is rotated through angle Œ∏1 t¬Üdue to a torque, T1 t¬Ü. An output gear with radius r2andN2teeth responds by rotating through angle Œ∏2 t¬Üand delivering a torque, T2 t¬Ü. Let us now Ô¨Ånd the relationship between the rotation of Gear 1, Œ∏1 t¬Ü, and Gear 2, Œ∏2 t¬Ü. From Figure 2.27, as the gears turn, the distance traveled along each gear ‚Äôs circumference is the same. Thus, r1Œ∏1¬àr2Œ∏2 2.132 ¬Ü or Œ∏2 Œ∏1¬àr1 r2¬àN1 N2 2.133 ¬ÜSkill-Assessment Exercise 2.9 PROBLEM: Find the transfer function, G s¬Ü¬àŒ∏2 s¬Ü=T s¬Ü, for the rotational mechanical system shown in Figure 2.26. ANSWER: G s¬Ü¬à1 2s2¬ás¬á1 The complete solution is at www.wiley.com/college/nise .1 N-m/rad1 N-m/rad 1 N-m-s/rad 1 N-m-s/radŒ∏2(t)T(t) 1 kg-m 2 FIGURE 2.26 Rotational mechanical system for Skill-Assessment Exercise 2.9 r2 Input drive gear, Gear 1 Output driven gear, Gear 2r1N1N2T1(t) Œ∏1(t)T2(t) Œ∏2(t) FIGURE 2.27 A gear system2.7 Transfer Functions for Systems with Gears 73WEBC02 10/28/2014 16:18:46 since the ratio of the number of teeth along the circumference is in the same proportion as the ratio of the radii. We conclude that the ratio of the angular displacement of the gears is inversely proportional to the ratio of the number of teeth. What is the relationship between the input torque, T1, and the delivered torque, T2?I f we assume the gears are lossless , that is, they do not absorb or store energy, the energy into Gear 1 equals the energy out of Gear 2.11Since the translational energy of force times displacement becomes the rotational energy of torque times angular displacement, T1Œ∏1¬àT2Œ∏2 2.134 ¬Ü Solving Eq. (2.134) for the ratio of the torques and using Eq. (2.133), we get T2 T1¬àŒ∏1 Œ∏2¬àN2 N1 2.135 ¬Ü Thus, the torques are directly proportional to the ratio of the number ofteeth. All results are summarized in Figure 2.28. Let us see what happens to mechanical impedances that are driven by gears. Figure 2.29( a) shows gears driving a rotational inertia, spring, and viscous damper. For clarity, the gears are shown by an end-on view.We want to represent Figure 2.29( a) as an equivalent system at Œ∏ 1without the gears. In other words, can the mechanical impedances be re Ô¨Çected from the output to the input, thereby eliminating the gears? From Figure 2.28( b),T1can be re Ô¨Çected to the output by multiplying by N2=N1. The result is shown in Figure 2.29( b), from which we write the equation of motion as Js2¬áDs¬áK¬ÜŒ∏2 s¬Ü¬àT1 s¬ÜN2 N1 2.136 ¬Ü Now convert Œ∏2 s¬Üinto an equivalent Œ∏1 s¬Ü, so that Eq. (2.136) will look as if it were written at the input. Using Figure 2.28(a ) to obtain Œ∏2 s¬Üin terms of Œ∏1 s¬Ü, we get Js2¬áDs¬áK¬ÜN1 N2Œ∏1 s¬Ü¬àT1 s¬ÜN2 N1 2.137 ¬Ü 11This is equivalent to saying that the gears have negligible inertia and damping.JDŒ∏1(t) Œ∏1(t)Œ∏2(t) Œ∏2(t)T1(t) N1 N2 (a)D T1(t) N2 N1 K (b) T1(t) J2N1 N2 2N1 N2K (c)2N1 N2DJ K FIGURE 2.29 a.Rotational system driven by gears; b.equivalent system at the output after reÔ¨Ç ection of input torque; c.equivalent system at the input after reÔ¨Ç ection of impedancesŒ∏2 Œ∏1 N1 N2 (a)T1 T2 N2 N1 (b) FIGURE 2.28 Transfer functions for a.angular displacement in lossless gears and b.torque in lossless gears74 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:47 After simpli Ô¨Åcation, JN1 N2/C18/C192 s2¬áDN1 N2/C18/C192 s¬áKN1 N2/C18/C192"# Œ∏1 s¬Ü¬àT1 s¬Ü 2.138 ¬Ü which suggests the equivalent system at the input and without gears shown in Figure 2.29( c). Thus, the load can be thought of as having been re Ô¨Çected from the output to the input. Generalizing the results, we can make the following statement: Rotational mechanical impedances can be re Ô¨Çected through gear trains by multiplying the mechanical impedance by the ratio Number of teeth of gear on destination shaft Number of teeth of gear on source shaft0 BB@1 CCA2 where the impedance to be re Ô¨Çected is attached to the source shaft and is being re Ô¨Çected to the destination shaft. The next example demonstrates the application of the concept of reÔ¨Çected impedances as we Ô¨Ånd the transfer function of a rotational mechanical system with gears. Example 2.21 Transfer Function ‚ÄîSystem with Lossless Gears Transfer Function ‚ÄîSystem with Lossless Gears PROBLEM: Find the transfer function, Œ∏2 s¬Ü=T1 s¬Ü, for the system of Figure 2.30(a ). SOLUTION: It may be tempting at this point to search for two simultaneous equations corresponding to each inertia. The inertias, however, do not undergo linearly independent motion, since they are tied together by the gears. Thus, there is only one degree offreedom and hence one equation of motion. Let us Ô¨Årst re Ô¨Çect the impedances ( J 1andD1) and torque ( T1) on the input shaft to the output as shown in Figure 2.30( b), where the impedances are re Ô¨Çected by N2=N1¬Ü2 and the torque is re Ô¨Çected by ( N2=N1). The equation of motion can now be written as Jes2¬áDes¬áKe¬ÜŒ∏2 s¬Ü¬àT1 s¬ÜN2 N1 2.139 ¬ÜJ2Œ∏1(t) Œ∏2(t)Œ∏2(t) Œ∏2(s)T1(t) N1 N2 K2D2 JeT1(t) Ke = K2 (b)N2 N1De = D12 + D2 2 + J2D1 (a)Je = J1J1 Jes2 + D es + K e (c)T1(s)N2 N1 N2 N1N2/N1 FIGURE 2.30 a.Rotational mechanical system with gears; b.system after reÔ¨Ç ection of torques and impedances to the output shaft; c.block diagram2.7 Transfer Functions for Systems with Gears 75WEBC02 10/28/2014 16:18:48 In order to eliminate gears with large radii, a gear train is used to implement large gear ratios by cascading smaller gear ratios. A schematic diagram of a gear train is shown in Figure 2.31. Next to each rotation, theangular displacement relative to Œ∏ 1has been calculated. From Figure 2.31, Œ∏4¬àN1N3N5 N2N4N6Œ∏1 2.141 ¬Ü For gear trains, we conclude that the equivalent gear ratio is the product ofthe individual gear ratios. We now apply this result to solve for the transferfunction of a system that does not have lossless gears.where Je¬àJ1N2 N1/C18/C192 ¬áJ2;De¬àD1N2 N1/C18/C192 ¬áD2;Ke¬àK2 Solving for Œ∏2 s¬Ü=T1 s¬Ü, the transfer function is found to be G s¬Ü¬àŒ∏2 s¬Ü T1 s¬Ü¬àN2=N1 Jes2¬áDes¬áKe 2.140 ¬Ü as shown in Figure 2.30( c). N1 N3 N5N2 N4 N6=N5 N6=N1 N3 N5 N2 N4 N6=N3 N4=N1 N3 N2 N4=N1 N2Œ∏1 Œ∏1 Œ∏3 Œ∏4Œ∏3 Œ∏1Œ∏2 Œ∏1Œ∏2 FIGURE 2.31 Gear train Example 2.22 Transfer Function ‚ÄîGears with Loss Transfer Function ‚ÄîGears with Loss PROBLEM: Find the transfer function, Œ∏1 s¬Ü=T1 s¬Ü, for the system of Figure 2.32( a). SOLUTION: This system, which uses a gear train, does not have lossless gears. All of the gears have inertia, and for some shafts there is viscous friction. To solve theproblem, we want to re Ô¨Çect all of the impedances to the input shaft, Œ∏ The gear ratio is not the same for all impedances. For example, D2is reÔ¨Çected only through one gear ratio asD2 N1=N2¬Ü2, whereas J4plus J5is re Ô¨Çected through two gear ratios as J4¬áJ5¬Ü¬â N3=N4¬Ü N1=N2¬Ü¬ä2. The result of re Ô¨Çecting all impedances to Œ∏1is shownŒ∏1(t)Œ∏1(t) Œ∏1(s)T1(t) N1 J1, D1 N2 N3 D2, J2 J3 J5N4 J4Je De Je = J1 + (J2 + J3)N1 N22 + (J4 + J5)N1N3 N2N42 N1 N22 (a)( b)T1(t) De = D1 + D21 Jes2 + DesT1(s) (c) FIGURE 2.32 a.System using a gear train; b.equivalent system at the input; c.block diagram76 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:49 2.8 Electromechanical System Transfer Functions In the last section we talked about rotational systems with gears, which completed our discussion of purely mechanical systems. Now, we move to systems that are hybrids of electrical and mechanical variables, the electromechanical systems . We have seen one application of an electromechanical system in Chapter 1, the antenna azimuth positionin Figure 2.32( b), from which the equation of motion is Jes2¬áDes¬ÜŒ∏1 s¬Ü¬àT1 s¬Ü 2.142 ¬Ü where Je¬àJ1¬á J2¬áJ3¬ÜN1 N2/C18/C192 ¬á J4¬áJ5¬ÜN1N3 N2N4/C18/C192 and De¬àD1¬áD2N1 N2/C18/C192 From Eq. (2.142), the transfer function is G s¬Ü¬àŒ∏1 s¬Ü T1 s¬Ü¬à1 Jes2¬áDes 2.143 ¬Ü as shown in Figure 2.32( c). Skill-Assessment Exercise 2.10 PROBLEM: Find the transfer function, G s¬Ü¬àŒ∏2 s¬Ü=T s¬Ü, for the rotational mechanical system with gears shown in Figure 2.33. ANSWER: G s¬Ü¬à1=2 s2¬ás¬á1 The complete solution is at www.wiley.com/college/nise .1 N-m-s/rad 4 N-m/radŒ∏2(t)T(t) 1 kg-m 2 N2=5 0N1=2 5 FIGURE 2.33 Rotational mechanical system with gears for Skill-Assessment Exercise 2.102.8 Electromechanical System Transfer Functions 77WEBC02 10/28/2014 16:18:49 control system. Other applications for systems with electromechanical components are robot controls, sun and star trackers, and computer tape and disk-drive position controls. Anexample of a control system that uses electromechanical components is shown inFigure 2.34. A motor is an electromechanical component that yields a displacement output for a voltage input, that is, a mechanical output generated by an electrical input. We will derive thetransfer function for one particular kind of electromechanical system, the armature-controlleddc servomotor ( Mablekos ,1980 ). The motor ‚Äôs schematic is shown in Figure 2.35( a), and the transfer function we will derive appears in Figure 2.35( b). In Figure 2.35( a) a magnetic Ô¨Åeld is developed by stationary permanent magnets or a stationary electromagnet called the Ô¨ÅxedÔ¨Åeld. A rotating circuit called the armature , through which current i a t¬ÜÔ¨Çows, passes through this magnetic Ô¨Åeld at right angles and feels a force, F¬àBlia t¬Ü, where Bis the magnetic Ô¨Åeld strength and lis the length of the conductor. The resulting torque turns the rotor , the rotating member of the motor. There is another phenomenon that occurs in the motor: A conductor moving at right angles to a magnetic Ô¨Åeld generates a voltage at the terminals of the conductor equal to 12See Appendix I at www.wiley.com/college/nise for a derivation of this schematic and its parameters.Armature circuitvb(t)Ra La Rotor Tm(t)Fixed field G(s)Œ∏m(s) Œ∏m(t)Ea(s) (a)( b)ia(t)ea(t)++ ‚Äì‚Äì FIGURE 2.35 DC motor: a.schematic;12b.block diagram FIGURE 2.34 NASA Ô¨Çight simulator robot arm with electromechanical control system components78 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:50 e¬àBlv, where eis the voltage and vis the velocity of the conductor normal to the magnetic Ô¨Åeld. Since the current-carrying armature is rotating in a magnetic Ô¨Åeld, its voltage is proportional to speed. Thus, vb t¬Ü¬àKbdŒ∏m t¬Ü dt 2.144 ¬Ü We call vb t¬Ütheback electromotive force (back emf );Kbis a constant of proportionality called the back emf constant; and dŒ∏m t¬Ü=dt¬àœâm t¬Üis the angular velocity of the motor. Taking the Laplace transform, we get Vb s¬Ü¬àKbsŒ∏m s¬Ü 2.145 ¬Ü The relationship between the armature current, ia t¬Ü, the applied armature voltage, ea t¬Ü, and the back emf, vb t¬Ü, is found by writing a loop equation around the Laplace transformed armature circuit (see Figure 3.5( a)): RaIa s¬Ü¬áLasIa s¬Ü¬áVb s¬Ü¬àEa s¬Ü 2.146 ¬Ü The torque developed by the motor is proportional to the armature current; thus, Tm s¬Ü¬àKtIa s¬Ü 2.147 ¬Ü where Tmis the torque developed by the motor, and Ktis a constant of proportionality, called the motor torque constant, which depends on the motor and magnetic Ô¨Åeld characteristics. In a consistent set of units, the value of Ktis equal to the value of Kb. Rearranging Eq. (2.147) yields Ia s¬Ü¬à1 KtTm s¬Ü 2.148 ¬Ü ToÔ¨Ånd the transfer function of the motor, we Ô¨Årst substitute Eqs. (2.145) and (2.148) into (2.146), yielding Ra¬áLas¬ÜTm s¬Ü Kt¬áKbsŒ∏m s¬Ü¬àEa s¬Ü 2.149 ¬Ü Now we must Ô¨ÅndTm s¬Üin terms of Œ∏m s¬Üif we are to separate the input and output variables and obtain the transfer function, Œ∏m s¬Ü=Ea s¬Ü. Figure 2.36 shows a typical equivalent mechanical loading on a motor. Jmis the equivalent inertia at the armature and includes both the armature inertia and, as we will see later, the load inertia re Ô¨Çected to the armature. Dmis the equivalent viscous damping at the armature and includes both the armature viscous damping and, as we will see later, the load viscous damping re Ô¨Çected to the armature. From Figure 2.36, Tm s¬Ü¬à Jms2¬áDms¬ÜŒ∏m s¬Ü 2.150 ¬Ü Substituting Eq. (2.150) into Eq. (2.149) yields Ra¬áLas¬Ü Jms2¬áDms¬ÜŒ∏m s¬Ü Kt¬áKbsŒ∏m s¬Ü¬àEa s¬Ü 2.151 ¬ÜTm(t)Œ∏m(t) Jm Dm FIGURE 2.36 Typical equivalent mechanical loading on a motor2.8 Electromechanical System Transfer Functions 79WEBC02 10/28/2014 16:18:51 If we assume that the armature inductance, La, is small compared to the armature resistance, Ra, which is usual for a dc motor, Eq. (2.151) becomes Ra Kt Jms¬áDm¬Ü¬áKb/C20/C21 sŒ∏m s¬Ü¬àEa s¬Ü 2.152 ¬Ü After simpli Ô¨Åcation, the desired transfer function, Œ∏m s¬Ü=Ea s¬Ü, is found to be Œ∏m s¬Ü Ea s¬Ü¬àKt= RaJm¬Ü ss¬á1 JmDm¬áKtKb Ra/C18/C19 /C20/C21 2.153 ¬Ü Even though the form of Eq. (2.153) is relatively simple, namely Œ∏m s¬Ü Ea s¬Ü¬àK s s¬áŒ±¬Ü 2.154 ¬Ü the reader may be concerned about how to evaluate the constants. Let us Ô¨Årst discuss the mechanical constants, JmandDm. Consider Figure 2.37, which shows a motor with inertia Jaand damping Daat the armature driving a load consisting of inertia JLand damping DL. Assuming that all inertia and damping values shown are known, JLandDLcan be reÔ¨Çected back to the armature as some equivalent inertia and damping to be added to Jaand Da, respectively. Thus, the equivalent inertia, Jm, and equivalent damping, Dm, at the armature are Jm¬àJa¬áJLN1 N2/C18/C192 ;Dm¬àDa¬áDLN1 N2/C18/C192 2.155 ¬Ü Now that we have evaluated the mechanical constants, JmandDm, what about the electrical constants in the transfer function of Eq. (2.153)? We will show that these constants can be obtained through a dynamometer test of the motor, where a dynamometer measures the torque and speed of a motor under the condition of a constant applied voltage. Let us Ô¨Årst develop the relationships that dictate the use of a dynamometer. Substituting Eqs. (2.145) and (2.148) into Eq. (2.146), with La¬à0, yields Ra KtTm s¬Ü¬áKbsŒ∏m s¬Ü¬àEa s¬Ü 2.156 ¬Ü Taking the inverse Laplace transform, we get Ra KtTm t¬Ü¬áKbœâm t¬Ü¬àea t¬Ü 2.157 ¬Ü where the inverse Laplace transform of sŒ∏m s¬ÜisdŒ∏m t¬Ü=dtor, alternately, œâm t¬Ü. If a dc voltage, ea, is applied, the motor will turn at a constant angular velocity, œâm, with a constant torque, Tm. Hence, dropping the functional relationship based on time from Eq. (2.157), the following relationship exists when the motor is operating at steady statewith a dc voltage input: Ra KtTm¬áKbœâm¬àea 2.158 ¬ÜJL DLN2N1 Motor Ja, Da FIGURE 2.37 DC motor driving a rotational mechanical load13 14 13The units for the electrical constants are Kt=N-m-A (newton-meters/ampere), and Kb=V-s/rad (volt-seconds/radian). 14If the values of the mechanical constants are not known, motor constants can be determined through laboratory testing using transient response or frequency response data. The concept of transient response is covered in Chapter 4; frequency response is covered in Chapter 10.80 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:52 Solving for Tmyields Tm¬à KbKt Raœâm¬áKt Raea 2.159 ¬Ü Equation (2.159) is a straight line, Tmvs.œâm, and is shown in Figure 2.38. This plot is called the torque-speed curve . The torque axis intercept occurs when the angular velocity reaches zero. That value of torque is called the stall torque ,Tstall. Thus, Tstall¬àKt Raea 2.160 ¬Ü The angular velocity occurring when the torque is zero is called the no-load speed, œâno-load . Thus, œâno-load ¬àea Kb 2.161 ¬Ü The electrical constants of the motor ‚Äôs transfer function can now be found from Eqs. (2.160) and (2.161) as Kt Ra¬àTstall ea 2.162 ¬Ü and Kb¬àea œâno-load 2.163 ¬Ü The electrical constants, Kt=RaandKb, can be found from a dynamometer test of the motor, which would yield Tstallandœâno-load for a given ea.Tm ea1 ea2TstallTorque Speedœâno-loadœâm FIGURE 2.38 Torque-speed curves with an armature voltage, ea, as a parameter Example 2.23 Transfer Function ‚ÄîDC Motor and Load Transfer Function ‚ÄîDC Motor and Load PROBLEM: Given the system and torque-speed curve of Figure 2.39( a) and ( b),Ô¨Ånd the transfer function, Œ∏L s¬Ü=Ea s¬Ü. SOLUTION: Begin by Ô¨Ånding the mechanical constants, JmandDm, in Eq. (2.153). From Eq. (2.155), the total inertia at the armature of the motor is Jm¬àJa¬áJLN1 N2/C18/C192 ¬à5¬á7001 10/C18/C192 ¬à12 2.164 ¬Ü and the total damping at the armature of the motor is Dm¬àDa¬áDLN1 N2/C18/C192 ¬à2¬á8001 10/C18/C192 ¬à10 2.165 ¬ÜVirtual Experiment 2.2 Open-Loop Servo Motor Put theory into practice exploring the dynamics of theQuanser Rotary Servo System modeled in LabVIEW. It is particularly important toknow how a servo motorbehaves when using them in high-precision applications such as hard disk drives. Virtual experiments are foundon Learning Space.2.8 Electromechanical System Transfer Functions 81WEBC02 10/28/2014 16:18:53 Now we will Ô¨Ånd the electrical constants, Kt=RaandKb. From the torque-speed curve of Figure 2.39( b), Tstall¬à500 2.166 ¬Ü œâno-load ¬à50 2.167 ¬Ü ea¬à100 2.168 ¬Ü Hence the electrical constants are Kt Ra¬àTstall ea¬à500 100¬à5 2.169 ¬Ü and Kb¬àea œâno-load¬à100 50¬à2 2.170 ¬Ü Substituting Eqs. (2.164), (2.165), (2.169), and (2.170) into Eq. (2.153) yield Œ∏m s¬Ü Ea s¬Ü¬à5=12 ss¬á1 12¬â10¬á 5¬Ü 2¬Ü¬ä/C26/C27 ¬à0:417 s s¬á1:667¬Ü 2.171 ¬Ü In order to Ô¨ÅndŒ∏L s¬Ü=Ea s¬Ü, we use the gear ratio, N1=N2¬à1=10, and Ô¨Ånd Œ∏L s¬Ü Ea s¬Ü¬à0:0417 s s¬á1:667¬Ü 2.172 ¬Ü as shown in Figure 2.39( c).Tm ea = 100 V500Torque (N-m) 50 Speed (rad/s)ia(t)ea(t)Ra Œ∏m(t) Œ∏L(t)Fixed field (a)N1 = 100 N2 = 1000 Da = 2 N-m s/radJa = 5 kg-m2 JL = 700 kg-m2 DL = 800 N-m s/rad (b)œâm+ ‚Äì 0.0417 s(s + 1.667) (c)Ea (s) Œ∏L (s) FIGURE 2.39 a.DC motor and load; b.torque-speed curve; c.block diagram82 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:53 2.9 Electric Circuit Analogs In this section, we show the commonality of systems from the various disciplines by demonstrating that the mechanical systems with which we worked can be represented byequivalent electric circuits. We have pointed out the similarity between the equationsresulting from Kirchhoff ‚Äôs laws for electrical systems and the equations of motion of mechanical systems. We now show this commonality even more convincingly by producing electric circuit equivalents for mechanical systems. The variables of the electric circuits behave exactly as the analogous variables of the mechanical systems. In fact, convertingmechanical systems to electrical networks before writing the describing equations is aproblem-solving approach that you may want to pursue. An electric circuit that is analogous to a system from another discipline is called an electric circuit analog. Analogs can be obtained by comparing the describing equations, such as the equations of motion of a mechanical system, with either electrical mesh or nodal equations.When compared with mesh equations, the resulting electrical circuit is called a series analog . When compared with nodal equations, the resulting electrical circuit is called a parallel analog . Series Analog Consider the translational mechanical system shown in Figure 2.41( a), whose equation of motion is Ms2¬áfvs¬áK¬ÜX s¬Ü¬àF s¬Ü 2.173 ¬Ü Kirchhoff ‚Äôs mesh equation for the simple series RLC network shown in Figure 2.41( b)i s Ls¬áR¬á1 Cs/C18/C19 I s¬Ü¬àE s¬Ü 2.174 ¬Ü As we previously pointed out, Eq. (2.173) is not directly analogous to Eq. (2.174) because displacement and current are not analogous. We can create a direct analogy bySkill-Assessment Exercise 2.11 PROBLEM: Find the transfer function, G s¬Ü¬àŒ∏L s¬Ü=Ea s¬Ü, for the motor and load shown in Figure 2.40. The torque-speed curve is given by Tm¬à 8œâm¬á200 when the input voltage is 100 volts. ANSWER: G s¬Ü¬à1=20 s¬âs¬á 15=2¬Ü¬ä The complete solution is at www.wiley.com/college/nise .+ ‚Äìea(t) Ja=1 kg-m 2 Da=5 N-m- s/rad DL=800 N-m-s/rad JL=400 kg-m 2N2= 100N1=2 0 N4= 100N3=2 5 Œ∏L(t)Motor FIGURE 2.40 Electromechanical system forSkill-Assessment Exercise 2.112.9 Electric Circuit Analogs 83WEBC02 10/28/2014 16:18:54 operating on Eq. (2.173) to convert displacement to velocity by dividing and multiplying the left-hand side by s, yielding Ms2¬áfvs¬áK ssX s¬Ü¬à Ms¬áfv¬áK s/C18/C19 V s¬Ü¬àF s¬Ü 2.175 ¬Ü Comparing Eqs. 2.174 and 2.175, we recognize the sum of impedances and draw the circuitshown in Figure 2.41( c). The conversions are summarized in Figure 2.41( d). When we have more than one degree of freedom, the impedances associated with a motion appear as series electrical elements in a mesh, but the impedances between adjacentmotions are drawn as series electrical impedances between the two corresponding meshes.We demonstrate with an example.+fv M ‚Äìf(t) v(t)1 K+R L e(t) i(t)C (c)(b)f(t)K fv (a)x(t) (d)mass = M viscous damper = f v spring = K applied force = f(t) velocity = v(t)inductor = M henries resistor = fv ohms capacitor = 1 voltage source = f(t)mesh current = v(t)KM+‚Äì +‚Äì‚Äì farads FIGURE 2.41 Development of series analog: a.mechanical system; b.desired electrical representation; c.series analog; d.parameters for series analog Example 2.24 Converting a Mechanical System to a Series AnalogConverting a Mechanical System to a Series Analog PROBLEM: Draw a series analog for the mechanical system of Figure 2.17( a). SOLUTION: Equations (2.118) are analogous to electrical mesh equations after conversion to velocity. Thus, M1s¬á fv1¬áfv3¬Ü¬á K1¬áK2¬Ü s/C20/C21 V1 s¬Ü  fv3¬áK2 s/C18/C19 V2 s¬Ü¬àF s¬Ü (2.176a)  fv3¬áK2 s/C18/C19 V1 s¬Ü¬á M2s¬á fv2¬áfv3¬Ü¬á K2¬áK3¬Ü s/C20/C21 V2 s¬Ü¬à0 (2.176b) CoefÔ¨Åcients represent sums of electrical impedance. Mechanical impedances associated with M1form the Ô¨Årst mesh, where impedances between the two masses are common to the two loops. Impedances associated with M2form the second mesh. The result is shown in Figure 2.42, where v1 t¬Üandv2 t¬Üare the velocities of M1andM2, respectively.84 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:54 Parallel Analog A system can also be converted to an equivalent parallel analog. Consider the translational mechanical system shown in Figure 2.43(a ), whose equation of motion is given by Eq. (2.175). Kirchhoff ‚Äôs nodal equation for the simple parallel RLC network s h o w ni nF i g u r e2 . 4 3 ( b)i s Cs¬á1 R¬á1 Ls/C18/C19 E s¬Ü¬àI s¬Ü 2.177 ¬Ü Comparing Eqs. (2.175) and (2.177), we identify the sum of admittances and draw thecircuit shown in Figure 2.43( c). The conversions are summarized in Figure 2.43( d). When we have more than one degree of freedom, the components associated with a motion appear as parallel electrical elements connected to a node. The components ofadjacent motions are drawn as parallel electrical elements between two correspondingnodes. We demonstrate with an example. i(t) (c)(b) (d)mass = M viscous damper = f v spring = K applied force = f(t) velocity = v(t)capacitor = M farads resistor = fv ohms inductor = 1 henries current source = f(t)node voltage = v(t)1C RLe(t) f(t) Mv(t) 1 fv1 KKf(t)K fv (a)x(t) M FIGURE 2.43 Development of parallel analog: a.mechanical system; b.desired electrical representation; c.parallel analog; d.parameters for parallel analogv2(t)fv3 1 K2M11 K1 M2fv11 K3 fv2 v1(t)f(t)+‚Äì FIGURE 2.42 Series analog of mechanical system of Figure 2.17( a)2.9 Electric Circuit Analogs 85WEBC02 10/28/2014 16:18:55 2.10 Nonlinearities The models thus far are developed from systems that can be described approximately by linear, time-invariant differential equations. An assumption of linearity was implicit in the development of these models. In this section, we formally de Ô¨Åne the terms linear and nonlinear and show how to distinguish between the two. In Section 2.11, we show how to approximate a nonlinear system as a linear system so that we can use the modelingtechniques previously covered in this chapter ( Hsu,1968 ). A linear system possesses two properties: superposition and homogeneity. The property ofsuperposition means that the output response of a system to the sum of inputs is the sum of the responses to the individual inputs. Thus, if an input of r 1 t¬Ü yields an output of c1 t¬Üand an input of r2(t) yields an output of c2 t¬Ü, then an input of r1 t¬Ü¬ár2 t¬Üyields an output of c1 t¬Ü¬ác2 t¬Ü. The property of homogeneity describes the response of the system to a multiplication of the input by a scalar. Speci Ô¨Åcally, in a linear system, the property of homogeneity is demonstrated if for aninput of r 1 t¬Üthat yields an output of c1 t¬Ü, an input of Ar1 t¬Üyields an output of Ac1 t¬Ü; that is, multiplication of an input by a scalar yields a response that is multiplied by the same scalar. We can visualize linearity as shown in Figure 2.45. Figure 2.45( a) is a linear system where the output is alwaysExample 2.25 Converting a Mechanical System to a Parallel AnalogConverting a Mechanical System to a Parallel Analog PROBLEM: Draw a parallel analog for the mechanical system of Figure 2.17( a). SOLUTION: Equation (2.176) is also analogous to electrical node equations. Coef Ô¨Åcients represent sums of electrical admittances. Admittances associated with M1form the elements connected to the Ô¨Årst node, where mechanical admittances between the two masses are common to the two nodes. Mechanical admittances associated with M2form the elements connected to the second node. The result is shown in Figure 2.44, where v1 t¬Üandv2 t¬Üare the velocities of M1andM2, respectively. f(t) M1v1(t) 1 fv11 K1M21 fv3 1 K21 fv21 K3v2(t) FIGURE 2.44 Parallel analog of mechanical system of Figure 2.17( a) Skill-Assessment Exercise 2.12 PROBLEM: Draw a series and parallel analog for the rotational mechanical system of Figure 2.22. ANSWER: The complete solution is at www.wiley.com/college/nise .Output Inputx 01 2 3 412 Output Inputx 0 (a) (b)f(x) f(x) 12 1234 FIGURE 2.45 a.Linear system; b.nonlinear system86 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:55 one half the input, or f x¬Ü¬à0:5x, regardless of the value of x. Thus each of the two properties of linear systems applies. For example, an input of 1 yields an output of1 2and an input of 2 yields an output of 1. Using superposition, an input that is the sum of the original inputs, or 3, should yield an output that is the sum of the individual outputs, or 1.5. FromFigure 2.45( a), an input of 3 does indeed yield an output of 1.5. To test the property of homogeneity, assume an input of 2, which yields an output of 1. Multiplying this input by 2 should yield an output of twice as much, or 2. From Figure 2.45( a), an input of 4 does indeed yield an output of 2. The reader can verify that the properties oflinearity certainly do not apply to the relationship shown in Figure 2.45( b). Figure 2.46 shows some examples of physical nonlinearities. An electronic ampli Ô¨Åer is linear over a speci Ô¨Åc range but exhibits the nonlinearity called saturation at high input voltages. A motor that does not respond at very low input voltages due to frictional forcesexhibits a nonlinearity called dead zone . Gears that do not Ô¨Åt tightly exhibit a nonlinearity called backlash: The input moves over a small range without the output responding. The reader should verify that the curves shown in Figure 2.46 do not Ô¨Ått h ed e Ô¨Ånitions of linearity over their entire range. Another example of a nonlinear subsystem is a phase detector, used in aphase-locked loop in an FM radio receiver, whose output response is the sine of the input. A designer can often make a linear approximation to a nonlinear system. Linear approximations simplify the analysis and design of a system and are used as long as theresults yield a good approximation to reality. For example, a linear relationship can beestablished at a point on the nonlinear curve if the range of input values about that point issmall and the origin is translated to that point. Electronic ampli Ô¨Åers are an example of physical devices that perform linear ampli Ô¨Åcation with small excursions about a point. 2.11 Linearization The electrical and mechanical systems covered thus far were assumed to be linear. However,if any nonlinear components are present, we must linearize the system before we can Ô¨Ånd the transfer function. In the last section, we de Ô¨Åned and discussed nonlinearities; in this section, we show how to obtain linear approximations to nonlinear systems in order to obtaintransfer functions. TheÔ¨Årst step is to recognize the nonlinear component and write the nonlinear differential equation. When we linearize a nonlinear differential equation, we linearize itfor small-signal inputs about the steady-state solution when the small-signal input is equal tozero. This steady-state solution is called equilibrium and is selected as the second step in the linearization process. For example, when a pendulum is at rest, it is at equilibrium. The angulardisplacement is described by a nonlinear differential equation, but it can be expressed with alinear differential equation for small excursions about this equilibrium point. Next we linearize the nonlinear differential equation, and then we take the Laplace transform of the linearized differential equation, assuming zero initial conditions. Finally,we separate input and output variables and form the transfer function. Let us Ô¨Årst see how to linearize a function; later, we will apply the method to the linearization of a differentialequation. Output Inputx Output Inputx Output Inputxf(x) f(x) f(x)Amplifier saturation Motor dead zone Backlash in gears FIGURE 2.46 Some physical nonlinearities2.11 Linearization 87WEBC02 10/28/2014 16:18:56 If we assume a nonlinear system operating at point A,¬âx0;f x0¬Ü¬äin Figure 2.47, small changes in the input can be related to changes in the output about the point by way of the slope of the curve at the point A. Thus, if the slope of the curve at point Aisma, then small excursions of the input about point A,Œ¥x, yield small changes in the output, Œ¥f x¬Ü, related by the slope at point A. Thus, ¬âf x¬Ü f x0¬Ü¬ä‚âàma x x0¬Ü 2.178 ¬Ü from which Œ¥f x¬Ü‚âàmaŒ¥x 2.179 ¬Ü and f x¬Ü‚âàf x0¬Ü¬áma x x0¬Ü‚âàf x0¬Ü¬ámaŒ¥x 2.180 ¬Ü This relationship is shown graphically in Figure 2.47, where a new set of axes, Œ¥xand Œ¥f x¬Ü, is created at the point A,a n d f(x) is approximately equal to f x0¬Ü, the ordinate of the new origin, plus small excursions, maŒ¥x, away from point A. Let us look at an example. Example 2.26 Linearizing a FunctionLinearizing a Function PROBLEM: Linearize f x¬Ü¬à5 cos xabout x¬àœÄ=2. SOLUTION: WeÔ¨ÅrstÔ¨Ånd that the derivative of f(x)i sdf=dx¬à   5 sin x¬Ü.A tx¬àœÄ=2, the derivative is  5. Also f x0¬Ü¬àf œÄ=2¬Ü¬à5 cos œÄ=2¬Ü¬à0. Thus, from Eq. (2.180), the system can be represented as f x¬Ü¬à  5Œ¥xfor small excursions of xabout œÄ=2. The process is shown graphically in Figure 2.48, where the cosine curve does indeed look like a straight line of slope  5 near œÄ=2.Output Inputxx0 0 xŒ¥xf(x) ~f(x) f(x0)Œ¥f(x) A~ FIGURE 2.47 Linearization about point A x 4 3 2 1123 Œ¥xSlope = ‚Äì5 œÄ/205f(x) Œ¥f(x)‚Äì1‚Äì44 ‚Äì3 ‚Äì2 ‚Äì1 ‚Äì2 ‚Äì3 ‚Äì4 ‚Äì5FIGURE 2.48 Linearization of 5 cos xabout x¬àœÄ=288 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:18:57 The previous discussion can be formalized using the Taylor series expansion, which expresses the value of a function in terms of the value of that function at a particular point, the excursion away from that point, and derivatives evaluated at that point. The Taylor seriesis shown in Eq. (2.181). f x¬Ü¬àf x 0¬Ü¬ádf dx/C12/C12/C12 x¬àx0 x x0¬Ü 1!¬ád2f dx2/C12/C12/C12 x¬àx0 x x0¬Ü2 2!¬á‚àô‚àô‚àô 2.181 ¬Ü For small excursions of xfrom x0, we can neglect higher-order terms. The resulting approximation yields a straight-line relationship between the change in f(x) and the excursions away from x0. Neglecting the higher-order terms in Eq. (2.181), we get f x¬Ü f x0¬Ü‚âàdf dx/C12/C12/C12 x¬àx0 x x0¬Ü 2.182 ¬Ü or Œ¥f x¬Ü‚âàm/C12/C12 x¬àx0Œ¥x 2.183 ¬Ü which is a linear relationship between Œ¥f x¬ÜandŒ¥xfor small excursions away from x0.I ti s interesting to note that Eqs. (2.182) and (2.183) are identical to Eqs. (2.178) and (2.179), which we derived intuitively. The following examples illustrate linearization. The Ô¨Årst example demonstrates linearization of a differential equation, and the second exampleapplies linearization to Ô¨Ånding a transfer function. Example 2.27 Linearizing a Differential EquationLinearizing a Differential Equation PROBLEM: Linearize Eq. (2.184) for small excursions about x¬àœÄ=4. d2x dt2¬á2dx dt¬ácosx¬à0 2.184 ¬Ü SOLUTION: T h ep r e s e n c eo ft h et e r mc o s xmakes this equation nonlinear. Since we want to linearize the equation about x¬àœÄ=4, we let x¬àŒ¥x¬áœÄ=4, where Œ¥xis the small excursion about œÄ=4, and substitute xinto Eq. (2.184): d2Œ¥x¬áœÄ 4/C16/C17 dt2¬á2dŒ¥x¬áœÄ 4/C16/C17 dt¬ácos Œ¥x¬áœÄ 4/C16/C17 ¬à0 2.185 ¬Ü But d2Œ¥x¬áœÄ 4/C16/C17 dt2¬àd2Œ¥x dt2 2.186 ¬Ü and dŒ¥x¬áœÄ 4/C16/C17 dt¬àdŒ¥x dt 2.187 ¬Ü2.11 Linearization 89WEBC02 10/28/2014 16:19:2 Finally, the term cos Œ¥x¬á œÄ=4¬Ü ) can be linearized with the truncated Taylor series. Substituting f x¬Ü¬àcos Œ¥x¬á œÄ=4¬Ü¬Ü;f x0¬Ü¬àf œÄ=4¬Ü¬àcos œÄ=4¬Ü;and x x0¬Ü¬àŒ¥xinto Eq. (2.182) yields cosŒ¥x¬áœÄ 4/C16/C17  cosœÄ 4/C16/C17 ¬àdcosx dx/C12/C12/C12 x¬àœÄ 4Œ¥x¬à sinœÄ 4/C16/C17 Œ¥x 2.188 ¬Ü Solving Eq. (2.188) for cos Œ¥x¬á œÄ=4¬Ü¬Ü,w eg e t cosŒ¥x¬áœÄ 4/C16/C17 ¬àcosœÄ 4/C16/C17  sinœÄ 4/C16/C17 Œ¥x¬àÔ¨ÉÔ¨ÉÔ¨É 2p 2 Ô¨ÉÔ¨ÉÔ¨É2p 2Œ¥x 2.189 ¬Ü Substituting Eqs. (2.186), (2.187), and (2.189) into Eq. (2.185) yields the following linearized differential equation: d2Œ¥x dt2¬á2dŒ¥x dt Ô¨ÉÔ¨ÉÔ¨É 2p 2Œ¥x¬à Ô¨ÉÔ¨ÉÔ¨É2p 2 2.190 ¬Ü This equation can now be solved for Œ¥x, from which we can obtain x¬àŒ¥x¬á œÄ=4¬Ü. Even though the nonlinear Eq. (2.184) is homogeneous, the linearized Eq. (2.190) is not homogeneous. Eq. (2.190) has a forcing function on its right-hand side. This additional term can be thought of as an input to a system represented by Eq. (2.184). Another observation about Eq. (2.190) is the negative sign on the left-hand side. The study of differential equations tells us that since the roots of the characteristic equation are positive, the homogeneous solution grows without bound instead of diminishing to zero.Thus, this system, linearized around x¬àœÄ=4, is not stable. Example 2.28 Transfer Function ‚ÄîNonlinear Electrical Network Transfer Function ‚ÄîNonlinear Electrical Network PROBLEM: Find the transfer function, VL s¬Ü=V s¬Ü, for the electrical network shown in Figure 2.49, which contains a nonlinear resistor whose voltage-currentrelationship is de Ô¨Åned by i r¬à2e0:1vr, where irandvrare the resistor current and voltage, respectively. Also, v(t) in Figure 2.49 is a small-signal source. SOLUTION: We will use Kirchhoff ‚Äôs voltage law to sum the voltages in the loop to obtain the nonlinear differential equation, but Ô¨Årst we must solve for the voltage across the nonlinear resistor. Taking the natural log of the resistor's current-voltagerelationship, we get v r¬à10 ln1 2ir. Applying Kirchhoff ‚Äôs voltage law around the loop, where ir¬ài, yields Ldi dt¬á10 ln1 2i 20¬àv t¬Ü 2.191 ¬Ü Next, let us evaluate the equilibrium solution. First, set the small-signal source, v(t), equal to zero. Now evaluate the steady-state current. With v t¬Ü¬à0, the circuit consists of a 20 V battery in series with the inductor and nonlinear resistor. In the steady state, the voltage across the inductor will be zero, since vL t¬Ü¬àLdi=dtanddi=dtis zero in the steady state, given a constant battery source. Hence, the resistor voltage, vr, is 20 V. Using the characteristics of the resistor, ir¬à2e0:1vr,w eÔ¨Ånd that ir¬ài¬à14:78 amps. This current,vL(t) 1 H Nonlinear resistor 20 Vv(t)i(t)+ +‚Äì‚Äì r FIGURE 2.49 Nonlinear electrical network90 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:2 i0, is the equilibrium value of the network current. Hence i¬ài0¬áŒ¥i. Substituting this current into Eq. (2.191) yields Ld i0¬áŒ¥i¬Ü dt¬á10 ln1 2 i0¬áŒ¥i¬Ü 20¬àv t¬Ü 2.192 ¬Ü Using Eq. (2.182) to linearize ln1 2 i0¬áŒ¥i¬Ü, we get ln1 2 i0¬áŒ¥i¬Ü ln12i 0¬àdln12i/C16/C17 di/C12/C12/C12 i¬ài0Œ¥i¬à1 i/C12/C12/C12 i¬ài0Œ¥i¬à1 i0Œ¥i 2.193 ¬Ü or ln1 2 i0¬áŒ¥i¬Ü¬àlni0 2¬á1 i0Œ¥i 2.194 ¬Ü Substituting into Eq. (2.192), the linearized equation becomes LdŒ¥i dt¬á10 lni0 2¬á1 i0Œ¥i/C18/C19  20¬àv t¬Ü 2.195 ¬Ü Letting L¬à1 and i0¬à14:78, the Ô¨Ånal linearized differential equation is dŒ¥i dt¬á0:677Œ¥i¬àv t¬Ü 2.196 ¬Ü Taking the Laplace transform with zero initial conditions and solving for Œ¥i s¬Ü,w eg e t Œ¥i s¬Ü¬àV s¬Ü s¬á0:677 2.197 ¬Ü But the voltage across the inductor about the equilibrium point is vL t¬Ü¬àLd dt i0¬áŒ¥i¬Ü¬àLdŒ¥i dt 2.198 ¬Ü Taking the Laplace transform, VL s¬Ü¬àLsŒ¥i s¬Ü¬àsŒ¥i s¬Ü 2.199 ¬Ü Substituting Eq. (2.197) into Eq. (2.199) yields VL s¬Ü¬àsV s¬Ü s¬á0:677 2.200 ¬Ü from which the Ô¨Ånal transfer function is VL s¬Ü V s¬Ü¬às s¬á0:677 2.201 ¬Ü for small excursions about i¬à14:78 or, equivalently, about v t¬Ü¬à0. Skill-Assessment Exercise 2.13 PROBLEM: Find the linearized transfer function, G s¬Ü¬àV s¬Ü=I s¬Ü,f o rt h ee l e c t r i - cal network shown in Figure 2.50. The net work contains a nonlinear resistor whose voltage-current relationship is deÔ¨Å ned by ir¬àevr. The current source, i(t), is a small-signal generator.2.11 Linearization 91WEBC02 10/28/2014 16:19:6 ANSWER: G s¬Ü¬à1 s¬á2 The complete solution is at www.wiley.com/college/nise . 2 A i(t)v(t) Nonlinear resistorr 1 F FIGURE 2.50 Nonlinear electric circuit for Skill- Assessment Exercise 2.13 Case Studies Antenna Control: Transfer FunctionsAntenna Control: Transfer Functions This chapter showed that physical systems can be modeled mathematically with transfer functions. Typically, systems are composed of subsystems of different types, such aselectrical, mechanical, and electromechanical. TheÔ¨Årst case study uses our ongoing example of the antenna azimuth position control system to show how to represent each subsystem as a transfer function. PROBLEM: Find the transfer function for each subsystem of the antenna azimuth position control system schematic shown on the front endpapers. Use Con Ô¨Åguration 1. SOLUTION: First, we identify the individual subsystems for which we must Ô¨Ånd transfer functions; they are summarized in Table 2.6. We proceed to Ô¨Ånd the transfer function for each subsystem. Input Potentiometer; Output Potentiometer Since the input and output potentiometers are con Ô¨Ågured in the same way, their transfer functions will be the same. We neglect the dynamics for the potentiometers and simply Ô¨Ånd the relationship between the output voltage and the input angular displacement. In the center position the output voltage is zero. Five turns toward either the positive10 volts or the negative 10 volts yields a voltage change of 10 volts. Thus, the transferfunction, V i s¬Ü=Œ∏i s¬Ü, for the potentiometers is found by dividing the voltage change byTABLE 2.6 Subsystems of the antenna azimuth position control system Subsystem Input Output Input potentiometer Angular rotation from user, Œ∏i t¬Ü Voltage to preamp, vi t¬Ü Preamp Voltage from potentiometers, ve t¬Ü¬àvi t¬Ü v0 t¬ÜVoltage to power amp, vp t¬Ü Power amp Voltage from preamp, vp t¬Ü Voltage to motor, ea t¬Ü Motor Voltage from power amp, ea t¬Ü Angular rotation to load, Œ∏0 t¬Ü Output potentiometer Angular rotation from load, Œ∏0 t¬Ü Voltage to preamp, v0(t)92 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:7 the angular displacement: Vi s¬Ü Œ∏i s¬Ü¬à10 10œÄ¬à1 œÄ 2.202 ¬Ü Preampli Ô¨Åer; Power Ampli Ô¨Åer The transfer functions of the ampli Ô¨Åers are given in the problem statement. Two phenomena are neglected . First, we assume that saturation is never reached. Second, the dynamics of the preampli Ô¨Åer are neglected , since its speed of response is typically much greater than that of the power ampli Ô¨Åer. The transfer functions of both ampli Ô¨Åers are given in the problem statement and are the ratio of the Laplace transforms of the output voltage divided by the input voltage. Hence, for the preampli Ô¨Åer, Vp s¬Ü Ve s¬Ü¬àK 2.203 ¬Ü and for the power ampli Ô¨Åer, Ea s¬Ü Vp s¬Ü¬à100 s¬á100 2.204 ¬Ü Motor and Load The motor and its load are next. The transfer function relating the armature displacement to the armature voltage is given in Eq. (2.153). The equivalent inertia, Jm,i s Jm¬àJa¬áJL25 250/C18/C192 ¬à0:02¬á11 100¬à0:03 2.205 ¬Ü where JL¬à1 is the load inertia at Œ∏0. The equivalent viscous damping, Dm,a tt h e armature is Dm¬àDa¬áDL25 250/C18/C192 ¬à0:01¬á11 100¬à0:02 2.206 ¬Ü where DLis the load viscous damping at Œ∏0. From the problem statement, Kt¬à0:5 N-m/A, Kb¬à0:5 V-s/rad, and the armature resistance Ra¬à8 ohms. These quantities along with JmandDmare substituted into Eq. (2.153), yielding the transfer function of the motor from the armature voltage to the armature displacement, or Œ∏m s¬Ü Ea s¬Ü¬àKt= RaJm¬Ü ss¬á1 JmDm¬áKtKb Ra/C18/C19 /C20/C21 ¬à2:083 s s¬á1:71¬Ü 2.207 ¬Ü To complete the transfer function of the motor, we multiply by the gear ratio to arrive at thetransfer function relating load displacement to armature voltage: Œ∏0 s¬Ü Ea s¬Ü¬à0:1Œ∏m s¬Ü Ea s¬Ü¬à0:2083 s s¬á1:71¬Ü 2.208 ¬Ü The results are summarized in the block diagram and table of block diagram parameters(ConÔ¨Åguration 1) shown on the front endpapers. An animation PowerPoint presentation (PPT) demonstrating this system is available for instructors at www.wiley.com/college/nise . SeeAntenna (Ch. 2 ). CHALLENGE: We now give you a problem to test your knowledge of this chapter ‚Äôs objectives: Referring to the antenna azimuth position control system schematic shown on the front endpapers, evaluate the transfer function of each subsystem. UseCase Studies 93WEBC02 10/28/2014 16:19:8 ConÔ¨Åguration 2. Record your results in the tab le of block diagram parameters shown on the front endpapers for use in subsequent chapters ‚Äôcase study challenges. Transfer Function of a Human LegTransfer Function of a Human Leg In this case study we Ô¨Ånd the transfer function of a biological system. The system is a human leg, which pivots from the hip joint. In this problem, the component of weight is nonlinear, so the system requires linearization beforethe evaluation of the transfer function. PROBLEM: The transfer function of a human leg relates the output angular rotation about the hip joint to the input torque supplied by the leg muscle. A simpli Ô¨Åed model for the leg is shown in Figure 2.51. The model assumes an applied muscular torque, T m(t), viscous damping, D, at the hip joint, and inertia, J, around the hip joint.15Also, a component of the weight of the leg, Mg, where Mis the mass of the leg and gis the acceleration due to gravity, creates a nonlinear torque. If we assume that the leg is of uniform density, the weight can be applied at L/2, where Lis the length of the leg ( Milsum ,1966 ). Do the following: a.Evaluate the nonlinear torque. b.Find the transfer function, Œ∏ s¬Ü=Tm s¬Ü, for small angles of rotation, where Œ∏ s¬Üis the angular rotation of the leg about the hip joint. SOLUTION: First, calculate the torque due to the weight. The total weight of the legis Mgactingvertically.Thecomponentoftheweightinthedirectionofrotation isMgsinŒ∏. This force is applied at a distance L=2 from the hip joint. Hence the torque in the direction of rotation, TW(t),is Mg L=2¬ÜsinŒ∏. Next, draw a free-body diagram of the leg, showing the applied torque, Tm(t), the torque due to the weight, TW(t), and the opposing torques due to inertia and viscous damping (see Figure 2.52). Summing torques, we get Jd2Œ∏ dt2¬áDdŒ∏ dt¬áMgL 2sinŒ∏¬àTm t¬Ü 2.209 ¬Ü We linearize the system about the equilibrium point, Œ∏¬à0, the vertical position of the leg. Using Eq. (2.182), we get sinŒ∏ sin0 ¬à cos0¬Ü Œ¥Œ∏ 2.210 ¬Ü from which, sin Œ∏¬àŒ¥Œ∏. Also, Jd2Œ∏=dt2¬àJd2Œ¥Œ∏=dt2andDdŒ∏=dt¬àDdŒ¥Œ∏=dt. Hence Eq. (2.209) becomes Jd2Œ¥Œ∏ dt2¬áDdŒ¥Œ∏ dt¬áMgL 2Œ¥Œ∏¬àTm t¬Ü 2.211 ¬Ü Notice that the torque due to the weight approximates a spring torque on the leg. Taking the Laplace transform with zero initial conditions yields Js2¬áDs¬áMgL 2/C18/C19 Œ¥Œ∏ s¬Ü¬àTm s¬Ü 2.212 ¬Ü 15For emphasis, Jis not around the center of mass, as we previously assumed for inertia in mechanical rotation.LegTm(t)Œ∏d2Œ∏JD dt2 TW(t)dtdŒ∏ FIGURE 2.52 Free-body diagram of leg modelŒ∏Tm Mg sin Œ∏ MgLegHip joint L/2L/2 FIGURE 2.51 Cylinder model of a human leg94 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:8 Summary In this chapter, we discussed how to Ô¨Ånd a mathematical model, called a transfer function , for linear, time-invariant electrical, mechanical, and electromechanical systems. The transfer function is de Ô¨Åned as G s¬Ü¬àC s¬Ü=R s¬Ü, or the ratio of the Laplace transform of the output to the Laplace transform of the input. This relationship is algebraic and alsoadapts itself to modeling interconnected subsystems. We realize that the physical world consists of more systems than we illustrated in this chapter. For example, we could apply transfer function modeling to hydraulic, pneumatic,heat, and even economic systems. Of course, we must assume these systems to be linear, ormake linear approximations, in order to use this modeling technique. Now that we have our transfer function, we can evaluate its response to a speci Ô¨Åed input. System response will be covered in Chapter 4. For those pursuing the state-space approach, we continue our discussion of modeling in Chapter 3, where we use the time domain rather than the frequency domain. Review Questions 1.What mathematical model permits easy interconnection of physical systems? 2.To what classi Ô¨Åcation of systems can the transfer function be best applied? 3.What transformation turns the solution of d ifferential equations into algebraic manipulations? 4.DeÔ¨Åne the transfer function. 5.What assumption is made concerning initial conditions when dealing with transferfunctions? 6.What do we call the mechanical equations written in order to evaluate the transferfunction? 7.If we understand the form the mechanical equations take, what step do we avoid inevaluating the transfer function? 8.Why do transfer functions for mechanical networks look identical to transfer functions forelectrical networks? 9.What function do gears perform?from which the transfer function is Œ¥Œ∏ s¬Ü Tm s¬Ü¬à1=J s2¬áD Js¬áMgL 2J 2.213 ¬Ü for small excursions about the equilibrium point, Œ∏¬à0. CHALLENGE: We now introduce a case study challenge to test your knowledge of this chapter ‚Äôs objectives. Although the physical system is different from a human leg, the problem demonstrates the sameprinciples: linearization followed by transfer function evaluation. Given the nonlinear electrical network shown in Figure 2.53, Ô¨Ånd the transfer function relating the output nonlinear resistor voltage, V r(s), to the input source voltage, V(s).1 H 5 VNonlinear resistorv(t)i(t) vr(t) = 2 ir2(t)+ + ‚Äì ‚Äìr FIGURE 2.53 Nonlinear electric circuitReview Questions 95WEBC02 10/28/2014 16:19:10 10.What are the component parts of the mechanical constants of a motor ‚Äôs transfer function? 11.The motor ‚Äôs transfer function relates armature displacement to armature voltage. How can the transfer function that relates load displacement and armature voltage be determined? 12.Summarize the steps taken to linearize a nonlinear system. Problems 1.Derive the Laplace transform for the following timefunctions: [Section: 2.2] a.u(t) b.tu(t) c.sinœâtu t¬Ü d.cosœâtu t¬Ü 2.Using the Laplace transform pairs of Table 2.1 and theLaplace transform theorems of Table 2.2, derive theLaplace transforms for the following time functions:[Section: 2.2] a.e  atsinœâtu t¬Ü b.e atcosœâtu t¬Ü c.t3u t¬Ü 3.Repeat Problem 19 in Chapter 1, using Laplacetransforms. Assume zero initial conditions. [Sections:2.2; 2.3] 4.Repeat Problem 20 in Chapter 1, using Laplace trans- forms. Assume that the forcing functions are zero prior tot¬à0 . [Section: 2.2] 5.Repeat Problem 21 in Chapter 1, using Laplace trans-forms. Use the following initial conditions for each partas follows: (a) x 0¬Ü¬à4;x ¬¥ 0¬Ü¬à  4; (b) x 0¬Ü¬à4; x¬¥ 0¬Ü¬à1; (c) x 0¬Ü¬à2;x¬¥ 0¬Ü¬à3, where x¬¥ 0¬Ü¬àdx dt 0¬Ü. Assume that the forcing functions are zero prior tot¬à0 . [Section: 2.2] Use MATLAB and the Symbolic MathToolbox to Ô¨Ånd the Laplace transform of the following timefunctions: [Section: 2.2] a.f t¬Ü¬à8t 2cos 3t¬á45¬∞¬Ü b.f t¬Ü¬à3te 2tsin 4t¬á60¬∞¬Ü 7.Use MATLAB and the Symbolic MathToolbox to Ô¨Ånd the inverse Laplace transform of the followingfrequency functions: [Section: 2.2] a.G s¬Ü¬à s2¬á3s¬á10¬Ü s¬á5¬Ü s¬á3¬Ü s¬á4¬Ü s2¬á2s¬á100¬Ü b.G s¬Ü¬às3¬á4s2¬á2s¬á6 s¬á8¬Ü s2¬á8s¬á3¬Ü s2¬á5s¬á7¬Ü8.A system is described by the following differentialequation: d3y dt3¬á3d2y dt2¬á5dy dt¬áy¬àd3x dt3¬á4d2x dt2¬á6dx dt¬á8x Find the expression for the transfer function of thesystem, Y s¬Ü=X s¬Ü. [Section: 2.3] 9.For each of the following transfer functions, write thecorresponding differential equation. [Section: 2.3] a. X s¬Ü F s¬Ü¬à7 s2¬á5s¬á10 b.X s¬Ü F s¬Ü¬à15 s¬á10¬Ü s¬á11¬Ü c.X s¬Ü F s¬Ü¬às¬á3 s3¬á11s2¬á12s¬á18 10.Write the differential equation for the system shown inFigure P2.1. [Section: 2.3] s5 + 2s4 + 4s3 + s2 + 4 s6 + 7s5 + 3s4 + 2s3 + s2 + 5C(s) R(s) FIGURE P2.1 11.Write the differential equation that is mathematicallyequivalent to the block diagram shown in Figure P2.2.Assume that r t¬Ü¬à3t [Section: 2.3] s4 + 3s3 + 2s2 + s + 1 s5 + 4s4 + 3s3 + 2s2 + 3s + 2C(s) R(s) FIGURE P2.2 12.A system is described by the following differential equa-tion: [Section 2.3] d2x dt2¬á4dx dt¬á5x¬à1 with the initial conditions x 0¬Ü¬à1;x: 0¬Ü¬à  1. Show a block diagram of the system, giving its transfer functionand all pertinent inputs and outputs. (Hint: the initial96 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:10 conditions will show up as added inputs to an effective system with zero initial conditions.) 13.Use MATLAB to generate the transfer function: [Section: 2.3] G s¬Ü¬à5 s¬á15¬Ü s¬á26¬Ü s¬á72¬Ü s s¬á55¬Ü s2¬á5s¬á30¬Ü s¬á56¬Ü s2¬á27s¬á52¬Ü in the following ways: a.the ratio of factors; b.the ratio of polynomials. 14.Repeat Problem 13 for thefollowing transfer function:[Section: 2.3] G s¬Ü¬à s4¬á25s3¬á20s2¬á15s¬á42 s5¬á13s4¬á9s3¬á37s2¬á35s¬á50 15.Use MATLAB to generate the partial-fraction expansion of the followingfunction: [Section: 2.3] F s¬Ü¬à104 s¬á5¬Ü s¬á70¬Ü s s¬á45¬Ü s¬á55¬Ü s2¬á7s¬á110¬Ü s2¬á6s¬á95¬Ü 16.Use MATLAB and the Symbolic MathToolbox to input and form LTIobjects in polynomial and factored formfor the following frequency functions:[Section: 2.3] a. G s¬Ü¬à45 s2¬á37s¬á74¬Ü s3¬á28s2¬á32s¬á16¬Ü s¬á39¬Ü s¬á47¬Ü s2¬á2s¬á100¬Ü s3¬á27s2¬á18s¬á15¬Ü b.G s¬Ü¬à56 s¬á14¬Ü s3¬á49s2¬á62s¬á53¬Ü s3¬á81s2¬á76s¬á65¬Ü s2¬á88s¬á33¬Ü s2¬á56s¬á77¬Ü 17.Find the transfer function, G s¬Ü¬àVo s¬Ü=Vi s¬Ü, for each network shown in Figure P2.3. [Section: 2.4] 2 Œ© 1 Œ©+ 1H1 Œ© vo(t) vi(t)+‚Äì ‚Äì (a)+1 H 2 F vo(t)1 Œ© vi(t)+‚Äì ‚Äì (b) FIGURE P2.3 18.Find the transfer function, G s¬Ü¬àVL s¬Ü=V s¬Ü, for each network shown in Figure P2.4. [Section: 2.4]2 Œ©F vL(t)+ v(t)2 Œ©2 Œ© 2 H1 2 +‚Äì ‚ÄìvL(t)+ ‚Äì (b)v(t) 22 H 2 HŒ©2Œ© (a)+‚Äì F12 FIGURE P2.4 19.Find the transfer function, G s¬Ü¬àVo s¬Ü=Vi s¬Ü, for each network shown in Figure P2.5. Solve the problem using mesh analysis. [Section: 2.4] + ‚Äì vi(t)vo(t) 112 H 3 H 2F Œ© (a)+‚Äì 1 F 1 F vi(t) vo(t)+1 Œ© +‚Äì‚Äì (b)1 H 1 H1 H FIGURE P2.5 20.Repeat Problem 19 using nodal equations. [Section: 2.4] a. Write, but do not solve, the mesh and nodal equationsfor the network of Figure P2.6. [Section: 2.4] b. Use MATLAB, the Symbolic MathToolbox, and the equationsfound in part a to solve for thetransfer function, G s¬Ü¬àV o s¬Ü=V s¬Ü. Use both the mesh and nodal equations andshow that either set yields the sametransfer function. [Section: 2.4] 2 Œ© 4 Œ© 8 Œ©2 Œ© 4 H6 H1 9 F v(t) vo(t)+ ‚Äì+‚Äì FIGURE P2.6 22.Find the transfer function, G s¬Ü¬àVo s¬Ü=Vi s¬Ü, for each operational ampli Ô¨Åer circuit shown in Figure P2.7. [Section: 2.4]Problems 97WEBC02 10/28/2014 16:19:11 100 kŒ© 100 kŒ© 100 kŒ© 22 ŒºF vi(t) vo(t)v1(t) (b)+‚Äì100 kŒ© 500 kŒ©2 ŒºF2 ŒºF vi(t) vo(t)v1(t) (a)+‚Äì FIGURE P2.7 23.Find the transfer function, G s¬Ü¬àVo s¬Ü=Vi s¬Ü, for each operational ampli Ô¨Åer circuit shown in Figure P2.8. [Section: 2.4] v1(t) vi(t)vo(t) vi(t)110 kŒ© 400 kŒ©4 ŒºF 4 ŒºF 4 ŒºF(a) (b)+‚Äì 110 kŒ© 600 kŒ©600 kŒ© 400 kŒ©4 ŒºF vo(t)v1(t) +‚Äì FIGURE P2.824.Find the transfer function, G s¬Ü¬àX1 s¬Ü=F s¬Ü, for the translational mechanical system shown in Figure P2.9. [Section: 2.5] 4 N-s/m 5 N/m f(t) 5 kgx1(t) FIGURE P2.9 25.Find the transfer function, G s¬Ü¬àX2 s¬Ü=F s¬Ü, for the translational mechanical network shown in Figure P2.10.[Section: 2.5] f(t)x2(t) x1(t) Frictionless1 N/m 1 kg 1 kg 1 N-s/m FIGURE P2.10 26.Find the transfer function, G s¬Ü¬àX2 s¬Ü=F s¬Ü, for the translational mechanical system shown in Figure P2.11.(Hint: place a zero mass at x 2(t).) [Section: 2.5] 2 N-s/m 2 N/mf(t)x2(t) 4 N-s/m8 kg FIGURE P2.11 27.For the system of Figure P2.12 Ô¨Ånd the transfer function, G s¬Ü¬àX1 s¬Ü=F s¬Ü. [Section: 2.5] 4 N/m 3 N-s/m3 N-s/mf(t) 2 N-s/m5 N/mx1(t) x2(t) 1 kg 2 kg fv3= fv1=fv2=M1= M2=K1= K2= FIGURE P2.12 28.Find the transfer function, G s¬Ü¬àX3 s¬Ü=F s¬Ü, for the translational mechanical system shown in Figure P2.13.[Section: 2.5] 2 N-s/m2 N-s/m 6 N/m6 N/m Frictionlessf(t)2 N-s/m 4 kg4 kg 4 kgx2(t) x3(t) x1(t) FIGURE P2.1398 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:11 29.Find the transfer function, X3 s¬Ü=F s¬Ü, for each system shown in Figure P2.14. [Section: 2.5] fv1= 4 N-s/m fv2= 4 N-s/m fv4= 4 N-s/mfv3= 4 N-s/m K= 5 N/m M1= 4 kg M2= 4 kgx1(t) f(t)x2(t) x3(t) (a) 4 N-s/m1 N/mf(t) 16 N-s/m 15 N/mM1 = 8 kgx1(t) x2(t) x3(t) M2=3 kg FrictionlessFrictionlessFrictionless (b) FIGURE P2.14 30.Write, but do not solve, the equations of motion for the translational mechanical system shown in Figure P2.15. [Section: 2.5] f(t) x1(t) x2(t)x3(t) K1 = 5 N/m K2 = 4 N/m fv2 = 2 N-s/mfv1 = 2 N-s/m M1 = 4 kgfv3 = 3 N-s/ m K3= 4 N/mM3 = 5 kg M2 = 5 kg Frictionless FIGURE P2.15 31.For the unexcited (no external force applied) system ofFigure P2.16, do the following: a.Write the differential equation that describes thesystem. b.Assuming initial conditions x 0¬Ü¬àx 0and _x 0¬Ü¬àx1, write a Laplace transform expression for X s¬Ü. c.Find x t¬Üby obtaining the inverse Laplace transform from the result in Part c.d.What will be the oscillation frequency in Hz for this system? K Mx(t) FIGURE P2.16 32.For each of the rotational mechanical systems shown in Figure P2.17, write, but do not solve, the equationsof motion. [Section: 2.6] Œ∏1(t) Œ∏2(t) T(t) 5 kg-m2 3 kg-m 2 9 N-m/rad8 N-m-s/rad 3 N-m/rad1 N-m-s/rad (a) (b)J1 J2 J3D1 K1K3K2D2 T(t) FIGURE P2.17 33.For the rotational mechanical system shown inFigure P2.18, Ô¨Ånd the transfer function G s¬Ü¬à Œ∏ 2 s¬Ü=T s¬Ü[Section: 2.6] 1 N-m-s/rad 1 N-m-s/rad1 N-m/rad 1 N-m-s/radŒ∏2(t) T(t) 1 kg-m 2 FIGURE P2.18 34.Find the transfer function,Œ∏1 s¬Ü T s¬Ü, for the system shown in Figure P2.19. Œ∏1(t) T(t) 1 N-m-s/rad1 N-m/rad1 N-m/rad 1 kg-m21 kg-m2 FIGURE P2.19Problems 99WEBC02 10/28/2014 16:19:12 35.For the rotational mechanical system with gears shown in Figure P2.20, Ô¨Ånd the transfer function, G s¬Ü¬àŒ∏3 s¬Ü=T s¬Ü. The gears have inertia and bearing friction as shown. [Section: 2.7] N2 N4Œ∏3(t)N3N1T(t) J2, D2 J4, D4J1, D1 J3, D3 J5, D5 FIGURE P2.20 36.For the rotational system shown in Figure P2.21, Ô¨Ånd the transfer function, G s¬Ü¬àŒ∏2 s¬Ü=T s¬Ü. [Section: 2.7] J1 = 2 kg-m2 J2 = 1 kg-m2 J3 = 16 kg-m2K = 64 N-m/radN1 = 4T(t) D1 = 1 N-m-s/rad N2 = 12 D2 = 2 N-m-s/radN3 = 4 N4 = 16Œ∏2(t) D3 = 32 N-m-s/rad FIGURE P2.21 37.Find the transfer function, G s¬Ü¬àŒ∏2 s¬Ü=T s¬Ü, for the rotational mechanical system shown in Figure P2.22.[Section: 2.7] N1 = 5N3 = 25 N2 = 50500 N-m-s/rad 300 N-m/rad 150 kg-m23 kg-m2 Œ∏2(t)T(t)100 kg-m2 3 N-m/rad FIGURE P2.22 38.Find the transfer function, G s¬Ü¬àŒ∏4 s¬Ü=T s¬Ü, for the rotational system shown in Figure P2.23. [Section: 2.7] N3 = 23 N2 = 110 2 N-m/radN1 = 26 N4 = 12026 N-m-s/radT(t) Œ∏4(t) Œ∏1(t) Œ∏2(t) Œ∏3(t) FIGURE P2.2339.For the rotational system shown in Figure P2.24, Ô¨Ånd the transfer function, G s¬Ü¬àŒ∏L s¬Ü=T s¬Ü. [Section: 2.7] 2 N-m/rad 0.02 N-m-s/rad2 N-m-s/rad Œ∏L(t) T(t)1 kg-m 2 N2=2 0 N1=5 N4=1 0N3=4 0 FIGURE P2.24 40.For the rotational system shown in Figure P2.25, writethe equations of motion from which the transfer function,G s¬Ü¬àŒ∏ 1 s¬Ü=T s¬Ü, can be found. [Section: 2.7] KN1 N4 DLJ4J1DN3 J3N2 J2JaT(t)Œ∏1(t) JL FIGURE P2.25 41.Given the rotational system shown in Figure P2.26, Ô¨Ånd the transfer function, G s¬Ü¬àŒ∏6 s¬Ü=Œ∏1 s¬Ü. [Section: 2.7] N1 J1, D N2N3 J3K1 N4 K2D T(t)Œ∏6(t)Œ∏1(t) DJ2, D J4, DJ5 J6 FIGURE P2.26 42.In the system shown in Figure P2.27, the inertia, J,o f radius, r, is constrained to move only about the stationary axisA. A viscous damping force of translational value fv exists between the bodies JandM. If an external force, f(t), is applied to the mass, Ô¨Ånd the transfer function, G s¬Ü¬àŒ∏ s¬Ü=F s¬Ü. [Sections: 2.5; 2.6] Kfv f(t) MfvrJ A MŒ∏(t) FIGURE P2.27100 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:12 43.For the combined translational and rotational system shown in Figure P2.28, Ô¨Ånd the transfer function, G s¬Ü¬àX s¬Ü=T s¬Ü. [Sections: 2.5; 2.6; 2.7] D2 = 1 N-m-s/rad3 kg-m2N1 = 10 N4 = 60 N2 = 20Radius = 2 m1 N-m-s/rad J = 3 kg-m2 Idealgear 1:1 3 N/m 2 N-s/mT(t) x(t)N3 = 30 2 kg FIGURE P2.28 44.Given the combined translational and rotational system shown in Figure P2.29, Ô¨Ånd the transfer function, G s¬Ü¬àX s¬Ü=T s¬Ü. [Sections: 2.5; 2.6] D3J2 Radius = r K1Ideal gear 1:1 K2M fvJ1 J3T(t) x(t) FIGURE P2.29 45.For the motor, load, and torque-speed curve shown inFigure P2.30, Ô¨Ånd the transfer function, G s¬Ü¬àŒ∏ L s¬Ü= Ea s¬Ü. [Section: 2.8] J2 = 36 kg-m2N1 = 50 N2 = 150Ra ea(t) Œ∏L(t)+ D1 = 8 N -m-s/rad D2 = 36 N-m-s/rad T (N-m) 150 50 V 100œâ (rad/s)J1 = 4 kg-m2 ‚Äì FIGURE P2.30 46.The motor whose torque-speed characteristics are shownin Figure P2.31 drives the load shown in the diagram.Some of the gears have inertia. Find the transfer function,G s¬Ü¬àŒ∏ 2 s¬Ü=Ea s¬Ü. [Section: 2.8]J= 2 kg-m2 2N1 = 10 N2 = 20 N3 = 10 J 18 kg-m42D = 36 N-m-s/rad T(N-m) 5 RPM5 V 600œÄJ 1 kg-m1 = 2 J 2 kg-m32 = =Œ∏2(t) N4 = 20ea(t)Motor+ ‚Äì FIGURE P2.31 47.A dc motor develops 55 N-m of torque at a speed of 600 rad/s when 12 volts are applied. It stalls out at this voltagewith100N-moftorque.Iftheinertiaanddampingofthearmatureare7kg-m 2and3N-m-s/rad,respectively, Ô¨Ånd the transfer function, G s¬Ü¬àŒ∏L s¬Ü=Ea s¬Ü, of this motor if it drives an inertia load of 105 kg-m2through a gear train, as shown in Figure P2.32. [Section: 2.8] N1 = 12 N2 = 25 N3 = 25Œ∏m(t) Œ∏L(t) Load N4 = 72ea(t) Motor+ ‚Äì FIGURE P2.32 48.In this chapter, we derived the transfer function of a dcmotor relating the angular displacement output to the armature voltage input. Often we want to control the output torque rather than the displacement. Derivethetransferfunctionofthemotorthatrelatesoutputtorqueto input armature voltage. [Section: 2.8] 49.Find the transfer function, G s¬Ü¬àX s¬Ü=E a s¬Ü, for the system shown in Figure P2.33. [Sections: 2.5 ‚Äì2.8] N2 = 20 Radius = 2 m D = 1 N-m-s/radN1 = 10 ea(t) J = 1 kg-m2 Ideal gear 1:1 fv = 1 N-s/mx(t) Ja = 1 kg-m2 Da = 1 N-m-s/rad Ra = 1 Œ© Kb = 1 V-s/rad Kt = 1 N-m/A M = 1 kgMotor+ For the motor:‚Äì FIGURE P2.33Problems 101WEBC02 10/28/2014 16:19:13 50.Find the series and parallel analogs for the translational mechanical system shown in Figure 2.20 in the text. [Section: 2.9] 51.Find the series and parallel analogs for the rotationalmechanical systems shown in Figure P2.17( b) in the problems. [Section: 2.9] 52.A system ‚Äôs output, c, is related to the system ‚Äôs input, r,b y the straight-line relationship, c¬à5r¬á7. Is the system linear? [Section: 2.10] 53.Consider the differential equation d2x dt2¬á3dx dt¬á2x¬àf x¬Ü where f(x) is the input and is a function of the output, x.I f f x¬Ü¬àsinx, linearize the differential equation for small excursions. [Section: 2.10] a.x¬à0 b.x¬àœÄ 54.Consider the differential equation d3x dt3¬á10d2x dt2¬á20dx dt¬á15x¬àf x¬Ü where f(x) is the input and is a function of the output, x.I f f x¬Ü¬à3e 5x, linearize the differential equation for xnear [Section: 2.10] 55.Many systems are piecewise linear. That is, over a large range of variable values, the system can be describedlinearly. A system with ampli Ô¨Åer saturation is one such example. Given the differential equation d2x dt2¬á17dx dt¬á50x¬àf x¬Ü assume that f(x) is as shown in Figure P2.34. Write the differential equation for each of the following rangesofx: [Section: 2.10] a.  ‚àû<x< 3 b. 3<x<3 c.3<x<‚àû ‚Äì33 ‚Äì66 xf(x) FIGURE P2.3456.For the translational mechanical system with a nonlinear spring shown in Figure P2.35, Ô¨Ånd the transfer function, G s¬Ü¬àX s¬Ü=F s¬Ü, for small excursions around f t¬Ü¬à1. The spring is de Ô¨Åned by xs t¬Ü¬à1 e fs t¬Ü, where xs t¬Üis the spring displacement and fs t¬Üis the spring force. [Section: 2.10] x(t) f(t) 2 N-s/mNonlinear spring 2 kg FIGURE P2.35 57.Enzymes are large proteins that biological systems use to increasetherateatwhichreactionsoccur.Forexample,foodis usually composed of large molecules that are hard todigest; enzymes break down the large molecules into smallnutrientsaspartofthediges tiveprocess.Onesuchenzymeis amylase, contained in human saliva. It is commonly knownthat if you place a piece of un cooked pasta in your mouth its taste will changefrom paper-like to sweet as amylase breaks down the carbohydrates into sugars. Enzyme breakdown is often expressed by the following relation: S¬áE‚áÑ ks k1C¬Æk1P In this expression a substrate ( S) interacts with an enzyme ( E) to form a combined product ( C) at a rate k1. The intermediate compound is reversible and gets disassociated at a rate k 1. Simultaneously some of the compound is transformed into the Ô¨Ånal product ( P)a ta ratek2. The kinetics describing this reaction are known as the Michaelis-Menten equations and consist of fournonlinear differential equ ations. However, under some conditions these equations can be simpliÔ¨Å ed. Let E 0and S0be the initial concentrations of enzyme and substrate, respectively. It is generally accepted that under someenergetic conditions or when the enzyme concentrationis very big E 0 S0¬Ü, the kinetics for this reaction are given by dS dt¬àkœà K~ sC S¬Ü dC dt¬àkœà S K~ MC¬Ü dP dt¬àk2C where the following constant terms are used ( Schnell , 2004 ): kœà¬àk1E0 ~Ks¬àk 1 kœà102 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:14 and ~KM¬à~Ks¬ák2 kœà a.Assuming the initial conditions for the reaction are S 0¬Ü¬àS0;E 0¬Ü¬àE0;C 0¬Ü¬àP 0¬Ü¬à0,Ô¨Ånd the Laplace transform expressions for S,C, and P: ‚ÑífSg;‚ÑífCg, and‚ÑífPg, respectively. b.Use the Ô¨Ånal theorem to Ô¨ÅndS ‚àû¬Ü;C ‚àû¬Ü, and P ‚àû¬Ü. 58.Humans are able to stand on two legs through a complexfeedback system that includes several sensory inputs ‚Äî equilibrium and visual along with muscle actuation. Inorder to gain a better understanding of the workings ofthe postural feedback mechanism, an individual isasked to stand on a platform to which sensors areattached at the base. Vibration actuators are attachedwith straps to the individual ‚Äôs calves. As the vibration actuators are stimulated, the individual sways andmovements are recorded. It was hypothesized that the human postural dynamics are analogous to those of a cart with a balancing standing pole attached(inverted pendulum). In that case, the dynamics canbe described by the following two equations: J d2Œ∏ dt2¬àmglsinŒ∏ t¬Ü¬áTbal¬áTd t¬Ü Tbal t¬Ü¬à  mglsinŒ∏ t¬Ü¬ákJŒ∏ t¬Ü Œ∑JŒ∏_ t¬Ü  œÅJZt 0Œ∏ t¬Üdt where mis the individual ‚Äôs mass; lis the height of the individual ‚Äôs center of gravity; gis the gravitational constant; Jis the individual ‚Äôs equivalent moment of inertia; Œ∑;œÅ, and kare constants given by the body ‚Äôs postural control system; Œ∏ t¬Üis the individual ‚Äôs angle with respect to a vertical line; Tbal(t) is the torque generated by the body muscles to maintain balance;andT d t¬Üis the external torque input disturbance. Find the transfer functionŒò s¬Ü Td s¬Ü(Johansson ,1988 ). 59.Figure P2.36 shows a crane hoisting a load. Although theactual system ‚Äôs model is highly nonlinear, if the rope is considered to be stiff with a Ô¨Åxed length L, the system can be modeled using the following equations: m L‚Ç¨xLa¬àmLgœï mT‚Ç¨xT¬àfT mLgœï xLa¬àxT xL xL¬àLœï where mLis the mass of the load, mTis the mass of the cart, xTandxLare displacements as de Ô¨Ån e di nt h eÔ¨Å gure, œïis therope angle with respect to the vertical, and fTis the force a p p l i e dt ot h ec a r t( Marttinen ,1990 ). a.Obtain the transfer function from cart velocity to rope angleŒ¶ s¬Ü VT s¬Ü. b.Assume that the cart is driven at a constant velocity V0 and obtain an expression for the resulting œï t¬Ü. Show that under this condition, the load will sway with a frequency œâ0¬àÔ¨ÉÔ¨ÉÔ¨Ég Lr . c.Find the transfer function from the applied force to the cart‚Äôs position,XT s¬Ü FT s¬Ü. d.Show that if a constant force is applied to the cart, its velocity will increase without bound as t¬Æ‚àû. fT L œï mL xLaxLx mTT FIGURE P2.3616 60.In 1978, Malthus developed a model for humangrowth population that is also commonly used tomodel bacterial growth as follows. Let N(t)b et h e population density observed at time t.L e t Kbe the rate of reproduction per unit time. Neglecting populationdeaths, the population density at a time t¬áŒît(with small Œît)i sg i v e nb y N t¬áŒît¬Ü‚âàN t¬Ü¬áKN t¬ÜŒît which also can be written as N t¬áŒît¬Ü N t¬Ü Œît¬àKN t¬Ü Since N(t) can be considered to be a very large number, letting Œît¬Æ0 gives the following differential equation (Edelstein-Keshet ,2005 ): dN t¬Ü dt¬àKN t¬Ü 16Marttinen A., Virkkunen J., Salminen R.T. Control Study with Pilot Crane. IEEE Transactions on Education , Vol. 33, No.3, August 1990. Fig. 2. p. 300. IEEE Transactions on Education by Institute of Electrical and Electronics Engineers; IEEE Education Group; IEEE Education Society. Reproducedwith permission of Institute of Electrical and Electronics Engineers, in the format Republish in a book via Copyright Clearance Center.Problems 103WEBC02 10/28/2014 16:19:15 a.Assuming an initial population N 0¬Ü¬àN0, solve the differential equation by Ô¨Ånding N(t). b.Find the time at which the population is double the initial population. 61.In order to design an underwater vehicle that has thecharacteristics of both a long-range transit vehicle(torpedo-like) and a highly maneuverable low-speedvehicle (boxlike), researchers have developed a thruster that mimics that of squid jet locomotion ( Krieg ,2008 ). It has been demonstrated there that the average normalized thrust due to a command step input, U s¬Ü¬à Tref^ sis given by: T t¬Ü¬àTref^ 1 e Œªt¬Ü¬áasin 2œÄft¬Ü where Tref^is the reference or desired thrust, Œªis the system ‚Äôs damping constant, ais the amplitude of the oscillation caused by the pumping action of the actuator, fistheactuatorfrequency,and T(t)istheaverageresulting normalized thrust. Find the thruster ‚Äôs transfer function T s¬Ü U s¬Ü. Show all steps. 62.The Gompertz growth model is commonly used to model tumor cell growth. Let v(t) be the tumor ‚Äôs volume, then dv t¬Ü dt¬àŒªe Œ±tv t¬Ü where ŒªandŒ±are two appropriate constants ( Edelstein- Keshet ,2005 ). a.Verify that the solution to this equation is given by v t¬Ü¬àv0eŒª=Œ± 1 e Œ±t¬Ü, where v0is the initial tumor volume. b.This model takes into account the fact that when nutrients and oxygen are scarce at the tumor ‚Äôs core, its growth is impaired. Find the Ô¨Ånal predicted tumor volume (let t¬Æ‚àû). c.For a speci Ô¨Åc mouse tumor, it was experimentally found that Œª¬à2:5d a y s ;Œ±¬à0:1 days with v0¬à 5010 3mm3(Chignola ,2005). Use any method available to make a plot of v(t)v s . t. d.Check the result obtained in Part bwith the results from the graph found in Part c. 63.A muscle hanging from a beam is shown in Figure P2.37( a) (Lessard ,2009). The Œ±-motor neuron can be used to electrically stimulate the muscle to contract and pull themass, m, which under static conditions causes the muscle to stretch. An equivalent mechan ical system to this setup is shown in Figure P2.37( b). The force F isowill be exerted when the muscle contracts. Find an expression for thedisplacement X 1(s)i nt e r m so f F1(s)a n d Fiso(s).Load mvelocity F1Œ±-motor neuronReference Load m F1 (a) (b)xm Fiso kB vm v1x1 v1 FIGURE P2.37 a.Motor neuron stimulating a muscle;17 b.equivalent circuit18 64.A three-phase ac/dc converter supplies dc to a batterycharging system or dc motor ( Graovac ,2001 ). Each phase has an ac Ô¨Ålter represented by the equivalent circuit in Figure P2.38. Va(s)RIacR (s)IacF (s)Ls 1/Cs+ ‚Äì FIGURE P2.38 ACÔ¨Ålter equivalent circuit for a three-phase ac/dc converter Derive that the inductor current in terms of the two active sources is IacF s¬Ü¬à1¬áRCs LCs2¬áRCs ¬á1IacR s¬Ü¬áCs LCs2¬áRCs ¬á1Va s¬Ü 65.A photovoltaic system is used to capture solar energy to be converted to electrical energy. A control system is used to pivot the solar platform to track the sun ‚Äôs movements in order to maximize the captured energy.The system consists of a motor and load similar to thatdiscussed in Section 2.8. A model has been proposed(Agee ,2012) that is different from the model developed in the chapter in the following ways: (1) the motorinductance was not neglected and (2) the load, in addition to having inertia and damping, has a spring. Find the transfer function, Œ∏ m s¬Ü=Ea s¬Ü,f o rt h i s augmented system assuming all load impedanceshave already been reÔ¨Ç ected to the motor shaft. 17Lessard, C. D. Basic Feedback Controls in Biomedicine , Morgan & Claypool, San Rafael, CA, 2009. Figure 2.8, p. 12. 18Lessard, C. D. Basic Feedback Controls in Biomedicine , Morgan & Claypool, San Rafael, CA, 2009 Figure 2.9, p. 13.104 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:16 66.In a paint mixing plant, two tanks supply Ô¨Çuids to a mixing cistern. The height, h,o ft h eÔ¨Ç u i di nt h ec i s t e r n is dependent upon the difference between the input mass Ô¨Çow rate, q, and the output Ô¨Çow rate, qe.A nonlinear differential equation describing this depen-dency is given by ( Schiop, 2010) dh dt¬áAe AÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 2ghp ¬àq œÅA where A=cross-sectional area of the cistern, Ae= cross-sectional area of the exit pipe, g=acceleration due to gravity, and œÅ=liquid density. a.Linearize the nonlinear equation about the equilibrium point ( h0,q0)a n d Ô¨Ånd the transfer function relating the output cistern Ô¨Çuid level, H(s), to the input mass Ô¨Çow rate, Q(s). b.The color of the liquid in the cistern can be keptconstant by adjusting the input Ô¨Çow rate, q,a s s u m - ing the input Ô¨Çow‚Äôs color is speci Ô¨Åcally controlled. Assuming an average height, h av, of the liquid in the cistern, the following equation relates the netÔ¨Çow of color to the cistern to the color in the cistern. e 1q eqe¬àd dt œÅAeh av¬Ü where e1=fractional part of Ô¨Çow representing color into the cistern, and e=fractional part of the cistern representing color in the cistern. Assume that theÔ¨Çow out of the cistern is constant and use therelationship, q e¬àœÅAeÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 2ghavp , along with the given equation above to Ô¨Ånd the transfer function, E s¬Ü=Q s¬Ü, that relates the color in the cistern to the input Ô¨Çow rate. PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 67.Control of HIV/AIDS. HIV in Ô¨Çicts its damage by infecting healthy CD4 +T cells (a type of white blood cell) that are necessary to Ô¨Åght infection. As the virus embedsinaTcellandtheimmunesystemproducesmore of these cells to Ô¨Åght the infection, the virus propagates in an opportunistic fashion. As we now develop a simpleHIV model, refer to Figure P2.39. Normally T cells areproduced at a rate sand die at a rate d. The HIV virus is present in the bloodstream in the infected individual. These viruses in the bloodstream, called free viruses , infect healthy T cells at a rate Œ≤. Also, the viruses reproduce through the T cell multiplication process or otherwise at a rate k. Free viruses die at a rate c. Infected T cells die at a rate Œº.s Healthy cell Free virus Infected cell dk Œ≤ c Œº FIGURE P2.3919 A simple mathematical model that illustrates these interactions is given by the following equations(Craig, 2004 ): dT dt¬às dT Œ≤Tv dT dt¬àŒ≤Tv ŒºT dv dt¬àkT cv where T¬ànumber of healthy T cells T¬ànumber of infected T cells v¬ànumber of free viruses a.The system is nonlinear; thus linearization is necessary to Ô¨Ånd transfer functions as you will do in subsequent chapters. The nonlinear nature ofthis model can be seen from the above equations. Determine which of these equations are linear, which are nonlinear, and explain why. b.The system has two equilibrium points. Show thatthese are given by T 0;T 0;v0¬Ü¬às d;0;0/C16/C17 and T0;T 0;v0¬Ü¬àcŒº Œ≤k;s Œº cd Œ≤k;sk cŒº d Œ≤/C18/C19 68.Hybrid vehicle. Problem 23 in Chapter 1 discusses the cruise control of serial, parallel, and split-power hybrid electric vehicles (HEVs). The functional block diagramsdeveloped for these HEVs indicated that the speed of a 19Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education Into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. Fig. 1, p. 66. IEEE Transactions on Education by Institute of Electrical and Electronics Engineers; IEEE Education Group; IEEE Education Society.Reproduced with permission of Institute of Electrical and Electronics Engineers, in the format Republish in a book via Copyright Clearance Center.Problems 105WEBC02 10/28/2014 16:19:17 vehicle depends upon the balance between the motive forces (developed by the gasoline engine and/or the electric motor) and running resistive forces. The resistiveforces include the aerodynamic drag, rolling resistance,and climbing resistance. Figure P2.40 illustrates therunning resistances for a car moving uphill ( Bosch ,2007 ). FL S Œ± GFSt ¬Ω FRO ¬Ω FRO FIGURE P2.40 Running resistances20 The total running resistance, Fw, is calculated as Fw¬àFRo¬áFL¬áFSt, where FRois the rolling resistance, FLis the aerodynamic drag, and FStis the climbing resistance. The aerodynamic drag is proportional to the square of the sum of car velocity, v, and the head-wind velocity, vhw,o rv¬ávhw. The other two resistances are functions of car weight, G, and the gradient of the road (given by the gradient angle, Œ±), as seen from the following equations: FRo¬àfGcosŒ±¬àfm gcosŒ± where f¬àcoefficient of rolling resistance m¬àcar mass ;in kg g¬àgravitational acceleration ;in m/s2 FL¬à0:5œÅCwAv¬ávhw ¬Ü2: and œÅ¬àair density ;in kg/m3 Cw¬àcoefficient of aerodynamic drag A¬àlargest cross-section of the car ;in kg =m2 FSt¬àGsinŒ±¬àmgsinŒ±: T h em o t i v ef o r c e , F, available at the drive wheels is: F¬àTitot rŒ∑tot¬àPŒ∑tot vwhere T¬àmotive torque P¬àmotive power itot¬àtotal transmission ratio r¬àtire radius Œ∑tot¬àtotal drive-train efficiency : The surplus force, F Fw, accelerates the vehicle (or retards it when Fw>F). Letting a¬àF Fw kmm, where ais the acceleration and kmis a coef Ô¨Åcient that compensates for the apparent increase in vehicle mass due to rotating masses (wheels, Ô¨Çywheel, crankshaft, etc.): a.Show that car acceleration,21a, may be determined from the equation: F¬àfm gcosŒ±¬ámgsinŒ±¬á0:5œÅCwAv¬ávhw ¬Ü2¬ákmma b.Assuming constant acceleration and using the averagevalue for speed, Ô¨Ånd the average motive force, F av (in N), and power, Pav(in kW) the car needs to accelerate from 40 to 60 km/h in 4 seconds on a levelroad, Œ±¬à0¬∞ ¬Ü , under windless conditions, where v hw¬à0. You are given the following parameters: m¬à1590 kg, A ¬à2m2,f¬à0:011, œÅ¬à1:2 kg/m3, Cw¬à0:3,Œ∑tot¬à0:9;km¬à1:2. Furthermore, calcu- late the additional power, Padd, the car needs after reaching 60 km/h to maintain its speed while climbing a hill with a gradient Œ±¬à5¬∞. c.The equation derived in Part adescribes the non- linear car motion dynamics where Ft ¬Üis the input to the system, and vt ¬Üthe resulting output. Given that the aerodynamic drag is proportional to v2under windless conditions, linearize the resulting equation of motion around an average speed, vo¬à50 km/h, when the car travels on a level road,22where Œ±¬à0¬∞. (Hint: Expand v2 v2 0in a truncated Taylor series). Write that equation of motion and represent it with a block diagram in which the block Gvrepresents the vehicle dynamics. The output of that block is the car speed, v(t), and the input is the excess motive force, Fet ¬Ü,d eÔ¨Åned as: Fe¬àF FSt FRo¬áFo,w h e r e Fo is the constant component of the linearized aerody-namic drag. d.Use the equation in Part ctoÔ¨Ånd the vehicle transfer function: G vs ¬Ü¬à Vs ¬Ü=Fes ¬Ü. 69.Parabolic trough collector . In a signi Ô¨Åcant number of cases, the open-loop transfer function from Ô¨ÇuidÔ¨Çow to 20Robert Bosch GmbH, Bosch Automotive Handbook, 7th ed. John Wiley & Sons Ltd. UK, 2007. P. 430. Figure at bottom left.21Other quantities, such as top speed, climbing ability, etc., may also be calculated by manipulation from that equation. 22Note that on a level road the climbing resistance, Fst¬à0, since sinŒ±¬àsin 0 ¬∞¬à0.106 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:18 Ô¨Çuid temperature in a parabolic trough collector can be approximated ( Camacho ,2012 ) by: P s¬Ü¬àK 1¬áœÑs¬Üe sT a.Write an analytic expression for the unit step response of the open-loop system assuming that h t¬Ürepresents the output temperature and q t¬Üthe input Ô¨ÇuidÔ¨Çow.b.Make a sketch of the unit step response of the open-loop system. Indicate on your Ô¨Ågure the time delay, the settling time, the initial and Ô¨Ånal values of the response, and the value of the response when t¬àœÑ¬áT. c.Call the output temperature h t¬Üand the input Ô¨ÇuidÔ¨Çowq t¬Ü. Find the differential equation that represents the open-loop system. Cyber Exploration Laboratory Experiment 2.1 Objectives To learn to use MATLAB to (1) generate polynomials, (2) manipulate polynomials, (3) generate transfer functions, (4) manipulate transfer functions, and (5) perform partial-fraction expansions. Minimum Required Software Packages MATLAB and the Control System Toolbox Prelab 1.Calculate the following by hand or with a calculator: a.The roots of P1¬às6¬á7s5¬á2s4¬á9s3¬á10s2¬á12s¬á15 b.The roots of P2¬às6¬á9s5¬á8s4¬á9s3¬á12s2¬á15s¬á20 c.P3¬àP1¬áP2;P4¬àP1 P2;P5¬àP1P2 2.Calculate by hand or with a calculator the polynomial P6¬à s¬á7¬Ü s¬á8¬Ü s¬á3¬Ü s¬á5¬Ü s¬á9¬Ü s¬á10¬Ü 3.Calculate by hand or with a calculator the following transfer functions: a.G1 s¬Ü¬à20 s¬á2¬Ü s¬á3¬Ü s¬á6¬Ü s¬á8¬Ü s s¬á7¬Ü s¬á9¬Ü s¬á10¬Ü s¬á15¬Ü, represented as a numerator polynomial divided by a denominator polynomial. b.G2 s¬Ü¬às4¬á17s3¬á99s2¬á223s¬á140 s5¬á32s4¬á363s3¬á2092 s2¬á5052 s¬á4320, expressed as factors in the numerator divided by factors in the denominator, similar tothe form of G 1 s¬Üin Prelab 3a. c.G3 s¬Ü¬àG1 s¬Ü¬áG2 s¬Ü;G4 s¬Ü¬àG1 s¬Ü G2 s¬Ü;G5 s¬Ü¬àG1 s¬ÜG2 s¬Ü expressed as factors divided by factors and expressed as polynomials divided by polynomials. 4.Calculate by hand or with a calculator the partial-fraction expansion of the following transfer functions: a.G6¬à5 s¬á2¬Ü s s2¬á8s¬á15¬Ü b.G7¬à5 s¬á2¬Ü s s2¬á6s¬á9¬Ü c.G8¬à5 s¬á2¬Ü s s2¬á6s¬á34¬ÜCyber Exploration Laboratory 107WEBC02 10/28/2014 16:19:19 Lab 1.Use MATLAB to Ô¨ÅndP3,P4, and P5in Prelab 1. 2.Use only one MATLAB command to Ô¨ÅndP6in Prelab 2. 3.Use only two MATLAB commands to Ô¨Ånd G1 s¬Üin Prelab 3 arepresented as a polynomial divided by a polynomial. 4.Use only two MATLAB commands to Ô¨ÅndG2(s) expressed as factors in the numerator divided by factors in the denominator. 5.Using various combinations of G1 s¬ÜandG2(s),Ô¨ÅndG3(s),G4 s¬Ü, and G5 s¬Ü. Various combinations implies mixing and matching G1 s¬ÜandG2(s) expressed as factors and polynomials. For example, in Ô¨Ånding G3(s),G1 s¬Ücan be expressed in factored form and G2(s) can be expressed in polynomial form. Another combination is G1 s¬ÜandG2(s) both expressed as polynomials. Still another combination is G1 s¬Üand G2(s) both expressed in factored form. 6.Use MATLAB to evaluate the partial fraction expansions shown in Prelab 4. Postlab 1.Discuss your Ô¨Åndings for Lab 5. What can you conclude? 2.Discuss the use of MATLAB to manipulate transfer functions and polynomials. Discuss any shortcomings in using MATLAB to evaluate partial fraction expansions. Experiment 2.2 Objectives To learn to use MATLAB and the Symbolic Math Toolbox to (1) Ô¨Ånd Laplace transforms for time functions, (2) Ô¨Ånd time functions from Laplace transforms, (3) create LTI transfer functions from symbolic transfer functions, and (4) perform solutions of symbolic simultaneous equations. Minimum Required Software Packages MATLAB, the Symbolic Math Tool- box, and the Control System Toolbox Prelab 1.Using a hand calculation, Ô¨Ånd the Laplace transform of: f t¬Ü¬à0:0075  0:00034 e 2:5tcos 22t¬Ü¬á0:087e 2:5tsin 22t¬Ü 0:0072 e 8t 2.Using a hand calculation, Ô¨Ånd the inverse Laplace transform of F s¬Ü¬à2 s¬á3¬Ü s¬á5¬Ü s¬á7¬Ü s s¬á8¬Ü s2¬á10s¬á100¬Ü 3.Use a hand calculation to solve the circuit for the Laplace transforms of theloop currents shown in Figure P2.41. Lab 1.Use MATLAB and the Symbolic Math Toolbox to a.Generate symbolically the time function f(t) shown in Prelab 1. b.Generate symbolically F(s) shown in Prelab 2. Obtain your result symbolically in both factored and polynomial forms. c.Find the Laplace transform of f(t) shown in Prelab 1. d.Find the inverse Laplace transform of F(s) shown in Prelab 2. e.Generate an LTI transfer function for your symbolic representation of F(s) in Prelab 2 in both polynomial form and factored form. Start with the F(s) you generated symbolically. f.Solve for the Laplace transforms of the loop currents in Prelab 3.+ ‚Äì3u(t)1 F51 H1 H 2Œ© 2Œ©5Œ© 1 F 31Œ©1 F4 3(t)i 1(t)i2(t)i FIGURE P2.41108 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:19 Postlab 1.Discuss the advantages and disadvantages between the Symbolic Math Toolbox and MATLAB alone to convert a transfer function from factored form to polynomial formand vice versa. 2.Discuss the advantages and disadvantages of using the Symbolic Math Toolbox togenerate LTI transfer functions. 3.Discuss the advantages of using the Symbolic Math Toolbox to solve simultaneousequations of the type generated by the electrical network in Prelab 3. Is it possible tosolve the equations via MATLAB alone? Explain. 4.Discuss any other observations you had using the Symbolic Math Toolbox. Experiment 2.3 Objectives To learn to use LabVIEW to generate and manipulate polynomials and transfer functions. Minimum Required Software Packages LabVIEW and the LabVIEW Control Design and Simulation Module. Prelab 1.Study Appendix D, Sections D.1 through Section D.4, Example D.1. 2.Perform by hand the calculations stated in Prelab 1 of Experiment 2.1. 3.Find by a hand calculation the polynomial whose roots are:  7; 8; 3; 5; 9;and 10. 4.Perform by hand a partial-fraction expansion of Gs ¬Ü¬à5s¬á10 s3¬á8s2¬á15s. 5.Find by a hand calculation G1s ¬Ü ¬á G2s ¬Ü;G1s ¬Ü   G2s ¬Ü;andG1s ¬ÜG2s ¬Ü, where G1s ¬Ü¬à1 s2¬ás¬á2andG2s ¬Ü¬às¬á1 s2¬á4s¬á3. Lab 1.Open the LabVIEW functions palette and select the Mathematics/Polynomial palette. 2.Generate the polynomials enumerated in Prelab 1a and lb of Experiment 2.1. 3.Generate the polynomial operations stated in Prelab 1c of Experiment 2.1. 4.Generate a polynomial whose roots are those stated in Prelab 3 of this experiment. 5.Generate the partial-fraction expansion of the transfer function given in Prelab 4 of this experiment. 6.Using the Control Design and Simulation/Control Design/Model Construction palette, construct the two transfer functions enumerated in Prelab 5. 7.Using the Control Design and Simulation/Control Design/Model Interconnection palette, display the results of the mathematical operations enumerated in Prelab 5 of thisexperiment. Postlab 1.Compare the polynomial operations obtained in Lab 3 to those obtained in Prelab 2. 2.Compare the polynomial displayed in Lab 4 with that calculated in Prelab 3. 3.Compare the partial-fraction expansion obtained in Lab 5 with that calculated inPrelab 4. 4.Compare the results of the mathematical operations found in Lab 7 to those calculated in Prelab 5.Cyber Exploration Laboratory 109C02 10/31/2014 11:3:30 Hardware Interface Laboratory Note: Before performing experiments in this section, please study Appendix D ‚Äî LabVIEW Tutorial, including the section discussing myDAQ. When an experiment indicates a provided Ô¨Åle, the Ô¨Åle is obtained at www.wiley.com/college/nise. Experiment 2.4 Programming with LabVIEW Part 1 Objectives 1.To learn how to program LabVIEW, Part 1 2.To learn how to write basic LabVIEW programs and understand LabVIEW Ô¨Çow Material Required Computer with LabVIEW Installed Prelab Go to the website http://www.learnni.com/getting-started/. Complete modules 0-7. Lab 1.Write a LabVIEW program that executes an equivalent of the following C-like code, where xis an input and yis an output (Formula Nodes are not allowed): if(abs(x) <0.1) y=1 ; else if(x>=0) y=0 ; else y=2 ; Run your program for the following inputs: x¬à0:05; 0:05;1; 1. 2.Write a LabVIEW program that receives three colors representing a resistor ‚Äôs value and returns the numeric resistor value in ohms. Your interface should be similar to the oneshown in Figure P2.42. The third band should include silver and gold colors. FIGURE P2.42110 Chapter 2 Modeling in the Frequency DomainC02 10/31/2014 11:3:31 Run your program at least for the following inputs: Red Red Black Brown Black OrangeOrange White Gold Experiment 2.5 Programming with LabVIEW Part 2 Objectives 1.To learn how to program LabVIEW, Part 2 2.To learn how to use loops, do basic math inside loops, and graph numerical information using LabVIEW Material Required Computer with LabVIEW Installed Prelab Go to the website http://www.learnni.com/getting-started/ . Complete modules 8-10. Lab 1.It is well known that 1 ¬áx¬áx2¬áx3¬á‚àô‚àô‚àô¬à1 1 xwhen jxj<1: Write a LabVIEW program that takes as an input a value for x, and a number of iterations. The program will use a loop to calculate the sum of the geometric series forthe speci Ô¨Åed number of operations. It will also calculate the closed-form expression for the series. The program will display the two results, and will also display the absoluteerror of the difference. Demonstrate your program with x=0.5 and 3, 10, and 200 iterations. 2.Write a LabVIEW program that generates a 50% duty-cycle square-wave signal between0 and X maxvolts, where Xmax<10 V, with a nonzero variable frequency. The amplitude and frequency will be inputs. Display the waveform on a waveform chart,which will be an output. In this part you are not allowed to use the LabVIEW-provided function generation blocks. Demonstrate this program for amplitudes of 1, 5, and 10 V and for 1 Hz and 5 Hz. Experiment 2.6 MyDAQ Programming Objectives To become familiar with the data acquisition and signal generation capabilities of myDAQ Material Required Computer with LabVIEW installed, and myDAQ Files Provided at www.wiley.com/college/nise Battery Meter.ctl Prelab Go to the website https://decibel.ni.com/content/docs/DOC-11624. Go over Unit 4 ‚ÄîDAQ: Lesson 1. Then go over the measuring voltage tutorial in http://zone.ni.com/devzone/cda/ epd/p/id/6436 . Lab 1.Write a battery-tester program using LabVIEW and myDAQ as an acquisition device. The battery tester should work for three nominal values of batteries: 1.5 V, 6 V, and 9 V.Hardware Interface Laboratory 111WEBC02 10/28/2014 16:19:20 Bibliography Agee J. T., and Jimoh, A. A. Flat controller design for hardware-cost reduction in polar-axis photovoltaic systems. Solar Energy , vol. 86, pp. 452 ‚Äì462, 2012. Aggarwal, J. K. Notes on Nonlinear Systems . Van Nostrand Reinhold, New York, 1972. Bosch, R. GmbH, Bosch Automotive Handbook , 7th ed. John Wiley & Sons Ltd., UK, 2007. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Cannon, R. H., Jr., Dynamics of Physical Systems . McGraw-Hill, New York, 1967. Carlson, L. E., and Griggs, G. E. Aluminum Catenary System Quarterly Report . Technical Report Contract Number DOT-FR-9154, U.S. Department of Transportation, 1980. Chignola, R., and Foroni, R. I. Estimating the Growth Kinetics of Experimental Tumors from as Few as Two Determinations of Tumor Size: Implications for Clinical Oncology. IEEE Transactions on Biomedical Engineering , vol. 52, no. 5, May 2005, pp. 808 ‚Äì815. Cochin, I. Analysis and Design of Dynamic Systems . Harper and Row, New York, 1980. Cook, P. A. Nonlinear Dynamical Systems . Prentice Hall, United Kingdom, 1986.The batteries are considered dead for voltage values 20% or under the nominal. Between 20% and the nominal value the batteries are in a warning area, and for values above the nominal the batteries are OK. Your interface should be similar to the one shown Figure P2.43. A custom control accepting inputs from 0 to 120 has been created under the nameBattery Meter.ctl . 2.Use the LabVIEW program that you wrote in Experiment 2.5 to generate a 50% duty-cycle square-wave signal. Output your signal through one of the myDAQ‚Äô s analog channels and read the signal using the myDAQ oscilloscope function (available frommyDAQ Ô¨Åle:NI ELVISmx Instrument Launcher ) to verify the generated signal. Print two examples using the scope‚Äô s automatic measurements. FIGURE P2.43112 Chapter 2 Modeling in the Frequency DomainWEBC02 10/28/2014 16:19:20 Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. Davis, S. A., and Ledgerwood, B. K. Electromechanical Components for Servomechanisms . McGraw-Hill, New York, 1961. Doebelin, E. O. Measurement Systems Application and Design . McGraw-Hill, New York, 1983. Dorf, R. Introduction to Electric Circuits , 2d ed. Wiley, New York, 1993. D‚ÄôSouza, A. Design of Control Systems . Prentice Hall, Englewood Cliffs, NJ, 1988. Edelstein-Keshet, L. Mathematical Models in Biology . Society for Industrial and Applied Mathematics, Philadelphia, PA, 2005. Elkins, J. A. A Method for Predicting the Dynamic Response of a Pantograph Running at Constant Speed under a Finite Length of Overhead Equipment. Technical Report TN DA36, British Railways, 1976. Franklin, G. F., Powell, J. D., and Emami-Naeini, A. Feedback Control of Dynamic Systems . Addison-Wesley, Reading, MA, 1986. Graovac D., and Katic ÃÅV. Online Control of Current-Source-Type Active RectiÔ¨Å er Using Transfer Function Approach. IEEE Transactions on Industrial Electronics , vol. 48, no. 3, June 2001, pp. 526 ‚Äì535. Hsu, J. C., and Meyer, A. U. Modern Control Principles and Applications . McGraw-Hill, New York, Johansson, R., Magnusson, M., and Akesson, M. Identi Ô¨Åcation of Human Postural Dynamics. IEEE Transactions on Biomedical Engineering , vol. 35, no. 10, October 1988, pp. 858 ‚Äì869. Kailath, T. Linear Systems . Prentice Hall, Englewood Cliffs, NJ, 1980. Kermurjian, A. From the Moon Rover to the Mars Rover. The Planetary Report , July/August 1990, pp. 4‚Äì11. Krieg, M., and Mohseni, K. Developing a Transient Model for Squid Inspired Thrusters, and Incorporation into Underwater Robot Control Design. 2008 IEEE/RSJ Int. Conf. on Intelligent Robots and Systems, France , September 2008. Kuo, F. F. Network Analysis and Synthesis . Wiley, New York, 1966. Lago, G., and Benning Ô¨Åeld, L. M. Control System Theory . Ronald Press, New York, 1962. Lessard, C. D. Basic Feedback Controls in Biomedicine . Morgan & Claypool, San Rafael, CA, 2009. Mablekos, V E. Electric Machine Theory for Power Engineers . Harper & Row, Cambridge, MA, Marttinen, A., Virkkunen, J., and Salminen, R. T. Control Study with Pilot Crane. IEEE Transactions on Education , vol. 33, no. 3, August 1990, pp. 298 ‚Äì305. Minorsky, N. Theory of Nonlinear Control Systems . McGraw-Hill, New York, 1969. Nilsson, J. W., and Riedel, S. A. Electric Circuits , 5th ed. Addison-Wesley, Reading, MA, 1996. Ogata, K. Modern Control Engineering , 2d ed. Prentice Hall, Englewood Cliffs, NJ, 1990. Raven, F. H.Automatic Control Engineering , 5th ed. McGraw-Hill, New York, 1995. Schiop L., Gaiceanu M. Mathematical Modeling of Color Mixing Process and PLC Control Implementation by Using Human Machine Interface. IEEE International Symposium on Electrical and Electronics Engineering,2 0 1 0 . Van Valkenburg, M. E. Network Analysis . Prentice Hall, Englewood Cliffs, NJ, 1974. Vidyasagar, M. Nonlinear Systems Analysis. Prentice Hall, Englewood Cliffs, NJ, 1978.Bibliography 113WEBC02 10/28/2014 16:19:20 Page 114WEBC03 10/28/2014 16:49:41 Modeling in the Time Domain This chapter covers only state-space methods. Chapter Learning Outcomes After completing this chapter, the student will be able to: ¬ÅFind a mathematical model, called a state-space representation, for a linear, time- invariant system (Sections 3.1 ‚Äì3.3) ¬ÅModel electrical and mechanical systems in state space (Section 3.4) ¬ÅConvert a transfer function to state space (Section 3.5) ¬ÅConvert a state-space representation to a transfer function (Section 3.6) ¬ÅLinearize a state-space representation (Section 3.7) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with case studies as follows: ¬ÅGiven the antenna azimuth position control system shown on the front endpapers, you will be able to Ô¨Ånd the state-space representation of each subsystem. ¬ÅGiven a description of the way a pharmaceutical drug Ô¨Çows through a human being, you will be able to Ô¨Ånd the state-space representation to determine drug concentrations in speci Ô¨Åed compartmentalized blocks of the process and of the human body. You will also be able to apply the same concepts to an aquifer toÔ¨Ånd water level.3 115WEBC03 10/28/2014 16:49:42 3.1 Introduction Two approaches are available for the analysis and design of feedback control systems. The Ô¨Årst, which we began to study in Chapter 2, is known as the classical ,o rfrequency-domain , technique. This approach is based on converting a system‚Äô s differential equation to a transfer function, thus generating a mathematical model of the system that algebraically relates a representation of the output to a representation of the input. Replacing a differential equationwith an algebraic equation not only simpli Ô¨Åes the representation of individual subsystems but also simpli Ô¨Åes modeling interconnected subsystems. The primary disadvantage of the classical approach is its limited applicability: It can be applied only to linear, time-invariant systems or systems that can be approximatedas such. A major advantage of frequency-domain techniques is that they rapidly provide stability and transient response information. Thus, we can immediately see the effects ofvarying system parameters until an acceptable design is met. With the arrival of space exploration, requirements for control systems increased in scope. Modeling systems by using linear, time-invariant differential equations and subsequent transfer functions became inadequate. The state-space approach (also referred to as the modern ,o rtime-domain , approach) is a uni Ô¨Åed method for modeling, analyzing, and designing a wide range of systems. For example, the state-space approach can be used to represent nonlinear systems that have backlash, saturation, and dead zone. Also, it canhandle, conveniently, systems with nonzero initial conditions. Time-varying systems, (forexample, missiles with varying fuel levels or lift in an aircraft Ô¨Çying through a wide range of altitudes) can be represented in state space. Many systems do not have just a single input anda single output. Multiple-input, multiple-output systems (such as a vehicle with input direction and input velocity yielding an output direction and an output velocity) can be compactly represented in state space with a model similar in form and complexity to thatused for single-input, single-output systems. The time-domain approach can be used torepresent systems with a digital computer in the loop or to model systems for digitalsimulation. With a simulated system, system response can be obtained for changes in systemparameters ‚Äîan important design tool. The state-space approach is also attractive because of the availability of numerous state-space software packages for the personal computer. The time-domain approach can also be used for the same class of systems modeled by the classical approach. This alternate model gives the control systems designer anotherperspective from which to create a design. While the state-space approach can be applied toa wide range of systems, it is not as intuitive as the classical approach. The designer has toengage in several calculations before the physical interpretation of the model is apparent,whereas in classical control a few quick calculations or a graphic presentation of data rapidlyyields the physical interpretation. In this book, the coverage of state-space techniques is to be regarded as an introduction to the subject, a springboard to advanced studies, and an alternate approach to frequency-domain techniques. We will limit the state-space approach to linear, time-invariant systems or systems that can be linearized by the methods of Chapter 2.The study of other classes of systems is beyond the scope of this book. Since state-spaceanalysis and design rely on matrices and matrix operations, you may want to review thistopic in Appendix G, located at www.wiley.com/college/nise , before continuing. 3.2 Some Observations We proceed now to establish the state-space approach as an alternate method for representing physical systems. This section sets the stage for the formal de Ô¨Ånition of the state-space representation by making some observations about systems and their variables. In the discussion that follows, some of the development has been placed in116 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:42 footnotes to avoid clouding the main issues with an excess of equations and to ensure that the concept is clear. Although we use two electrical networks to illustrate the concepts, we could just as easily have used a mechanical or any other physical system. We now demonstrate that for a system with many variables, such as inductor voltage, resistor voltage, and capacitor charge, we need to use differential equations onlyto solve for a selected subset of system variables because all other remaining systemvariables can be evaluated algebraically from the variables in the subset. Our examplestake the following approach: 1.We select a particular subset of all possible system variables and call the variables in this subset state variables . 2.For an nth-order system, we write n simultaneous ,Ô¨Årst-order differential equations in terms of the state variables. We call this system of simultaneous differential equations state equations . 3.If we know the initial condition of all of the state variables at t 0as well as the system input fortt0, we can solve the simultaneous differential equations for the state variables for tt0. 4.Wealgebraically combine the state variables with the system ‚Äôs input and Ô¨Ånd all of the other system variables for tt0. We call this algebraic equation the output equation . 5.We consider the state equations and the output equations a viable representation of thesystem. We call this representation of the system a state-space representation . Let us now follow these steps through an example. Consider the RLnetwork shown in Figure 3.1 with an initial current of i(0). 1.We select the current, i(t), for which we will write and solve a differential equation using Laplace transforms. 2.We write the loop equation, Ldi dt¬áRi¬àv t¬Ü 3.1¬Ü 3.Taking the Laplace transform, using Tab le 2.2, Item 7, and including the initial conditions, yields L¬âsI s¬Ü i 0¬Ü¬ä ¬áRI s¬Ü¬àV s¬Ü 3.2¬Ü Assuming the input, v(t), to be a unit step, u(t), whose Laplace transform is V s¬Ü¬à1=s, we solve for I(s) and get I s¬Ü¬à1 R1 s 1 s¬áR L0 B@1 CA¬ái 0¬Ü s¬áR L 3.3¬Ü from which i t¬Ü¬à1 R/C16 1 e  R=L¬Üt/C17 ¬ái 0¬Üe  R=L¬Üt 3.4¬Ü The function i(t) is a subset of all possible network variables that we are able to Ô¨Ånd from Eq. (3.4) if we know its initial condition, i(0), and the input, v(t). Thus, i(t) is a state variable, and the differential equation (3.1) is a state equation .L v(t) i(t)R +‚Äì FIGURE 3.1 RLnetwork3.2 Some Observations 117WEBC03 10/28/2014 16:49:43 4.We can now solve for all of the other network variables algebraically in terms of i(t) and the applied voltage, v(t). For example, the voltage across the resistor is vR t¬Ü¬àRi t¬Ü 3.5¬Ü The voltage across the inductor is vL t¬Ü¬àv t¬Ü Ri t¬Ü 3.6¬Ü1 The derivative of the current is di dt¬à1 L¬âv t¬Ü Ri t¬Ü¬ä 3.7¬Ü2 Thus, knowing the state variable, i(t), and the input, v(t), we can Ô¨Ånd the value, or state,o f any network variable at any time, tt0. Hence, the algebraic equations, Eqs. (3.5) through (3.7), are output equations . 5.Since the variables of interest are completely described by Eq. (3.1) and Eqs. (3.5) through (3.7), we say that the combine d state equation (3.1) and the output equations (3.5 through 3.7) form a viable representation of the network, whichwe call a state-space representation . Equation (3.1), which describes the dynamics of the network, is not unique. This equation could be written in terms of any other network variable. For example, substitutingi¬àv R=Rinto Eq. (3.1) yields L RdvR dt¬ávR¬àv t¬Ü 3.8¬Ü which can be solved knowing that the initial condition vR 0¬Ü¬àRi 0¬Üand knowing v(t). In this case, the state variable is vR(t). Similarly, all other network variables can now be written in terms of the state variable, vR(t), and the input, v(t). Let us now extend our observations to a second-order system, such as that shown in Figure 3.2. 1.Since the network is of second order, two simultaneous, Ô¨Årst-order differential equations are needed to solve for two state variables. We select i(t) and q(t), the charge on the capacitor, as the two state variables. 2.Writing the loop equation yields Ldi dt¬áRi¬á1 CZ id t¬àv t¬Ü 3.9¬Ü Converting to charge, using i t¬Ü¬àdq=dt, we get Ld2q dt2¬áRdq dt¬á1 Cq¬àv t¬Ü 3.10¬ÜCL R v(t) i(t)+‚Äì FIGURE 3.2 RLC network 1Since vL t¬Ü¬àv t¬Ü vR t¬Ü¬àv t¬Ü Ri t¬Ü. 2Sincedi dt¬à1 LvL t¬Ü¬à1 L¬âv t¬Ü Ri t¬Ü¬ä.118 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:43 But an nth-order differential equ ation can be converted to nsimultaneous Ô¨Årst-order differential equatio ns, with each equation of the form dxi dt¬àai1x1¬áai2x2¬á‚àô‚àô‚àô¬áainxn¬ábif t¬Ü 3.11¬Ü where each xiis a state variable, and the aij‚Äôs and biare constants for linear, time- invariant systems. We say that the right-hand side of Eq. (3.11) is a linear combination of the state variables and the input, f(t). We can convert Eq. (3.10) into two simultaneous, Ô¨Årst-order differential equations in terms of i(t) and q(t). The Ô¨Årst equation can be dq=dt¬ài. The second equation can be formed by substitutingR id t¬àqinto Eq. (3.9) and solving for di/dt. Summarizing the two resulting equations, we get dq dt¬ài (3.12a) di dt¬à 1 LCq R Li¬á1 Lv t¬Ü (3.12b) 3.These equations are the state equations and can be solved simultaneously for the state variables, q(t) and i(t), using the Laplace transform and the methods of Chapter 2. In addition we must also know the input, v(t), and the initial conditions for q(t) and i(t). 4.From these two state variables, we can solve for all other network variables. For example,the voltage across the inductor can be written in terms of the solved state variables andthe input as v L t¬Ü¬à 1 Cq t¬Ü Ri t¬Ü¬áv t¬Ü 3.13¬Ü3 Equation (3.13) is an output equation ; we say that vL(t)i sa linear combination of the state variables, q(t) and i(t), and the input, v(t). 5.The combined state equations (3.12) and the output equation (3.13) form a viablerepresentation of the network, which we call a state-space representation . Another choice of two state variables can be made, for example, v R(t) and vC(t), the resistor and capacitor voltage, respectively. The resulting set of simultaneous, Ô¨Årst-order differential equations follows: dvR dt¬à R LvR R LvC¬áR Lv t¬Ü (3.14a)4 dvC dt¬à1 RCvR (3.14b) Again, these differential equations can be solved for the state variables if we know the initialconditions along with v(t). Further, all other network variables can be found as a linear combination of these state variables. Is there a restriction on the choice of state variables? Yes! Typically, the minimum number of state variables required to describe a system equals the order of the differentialequation. Thus, a second-order system requires a minimum of two state variables to describe it. 3Since vL t¬Ü¬àL di=dt¬Ü¬à  1=C¬Üq Ri¬áv t¬Ü, where di/dt can be found from Eq. (3.9), andRid t¬àq. 4Since vR t¬Ü¬ài t¬ÜR, and vC t¬Ü¬à 1=C¬ÜRid t, differentiating vR(t) yields dvR=dt¬àRd i =dt ¬Ü ¬à R=L ¬Ü vL¬à R=L ¬Ü vt ¬Ü  vR vC ¬â¬ä , and differentiating vC(t) yields dvC=dt¬à 1=C¬Üi¬à 1=RC¬ÜvR.3.2 Some Observations 119WEBC03 10/28/2014 16:49:44 We can de Ô¨Åne more state variables than the minimal set; however, within this minimal set the state variables must be linearly independent. For example, if vR(t) is chosen as a state variable, then i(t) cannot be chosen, because vR(t) can be written as a linear combination of i(t), namely vR t¬Ü¬àRi t¬Ü. Under these circumstances we say that the state variables are linearly dependent . State variables must be linearly independent ; that is, no state variable can be written as a linear combination of the other state variables, or else we would not have enough information to solve for all other system variables, and we could even havetrouble writing the simultaneous equations themselves. The state and output equations can be written in vector-matrix form if the system is linear. Thus, Eq. (3.12), the state equations, can be written as _x¬àAx¬áBu 3.15¬Ü where _x¬àdq=dt di=dt"# ; A¬à01  1=LC  R=L"# x¬àq i"# ; B¬à0 1=L"# ;u¬àvt ¬Ü Equation (3.13), the output equation, can be written as y¬àCx¬áDu 3.16¬Ü where y¬àv L t¬Ü;C¬à¬â  1=C R¬ä;x¬àq i"# ;D¬à1;u¬àv t¬Ü We call the combination of Eqs. (3.15) and (3.16) a state-space representation of the network of Figure 3.2. A state-space representation, therefore, consists of (1) the simultaneous,Ô¨Årst-order differential equations from which the state variables can be solved and (2) the algebraic output equation from which all other system variables can be found. A state-space representation is not unique, since a different choice of state variables leads to a different representation of the same system. In this section, we used two electrical networks to demonstrate some principles that are the foundation of the state-space representation. The representations developed in thissection were for single-input, single-output systems, where y,D, and uin Eqs. (3.15) and (3.16) are scalar quantities. In general, systems have multiple inputs and multipleoutputs. For these cases, yandubecome vector quantities, and Dbecomes a matrix. In Section 3.3 we will generalize the representation for multiple-input, multiple-output systems and summarize the concept of the state-space representation. 3.3 The General State-Space Representation Now that we have represented a physical network in state space and have a good idea of the terminology and the concept, let us summarize and generalize the representation for lineardifferential equations. First, we formalize some of the de Ô¨Ånitions that we came across in the last section. Linear combination . A linear combination of nvariables, x i, fori¬à1t on, is given by the following sum, S: S¬àKnxn¬áKn 1xn 1¬á‚àô‚àô‚àô¬áK1x1 3.17¬Ü where each Kiis a constant.120 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:44 Linear independence . A set of variables is said to be linearly independent if none of the variables can be written as a linear combination of the others. For example, given x1,x2, andx3,i fx 2¬à5x1¬á6x3, then the variables are not linearly independent, since one of them can be written as a linear combination of the other two. Now, what must be true so that one variable cannot be written as a linear combination of the other variables? Considerthe example K 2x2¬àK1x1¬áK3x3.I fn ox i¬à0, then any xican be written as a linear combination of other variables, unless all Ki¬à0. Formally, then, variables xi,f o r i¬à1t on, are said to be linearly independent if their linear combination, S, equals zero onlyif every Ki¬à0 andno x i¬à0f o ra l l t0. System variable . Any variable that responds to an input or initial conditions in a system. State variables . The smallest set of linearly independent system variables such that the values of the members of the set at time t0along with known forcing functions completely determine the value of all system variables for all tt0. State vector . A vector whose elements are the state variables. State space . The n-dimensional space whose axes are the state variables. This is a new term and is illustrated in Figure 3.3, where the state variables are assumed to be a resistor voltage, vR, and a capacitor voltage, vC. These variables form the axes of the state space . A trajectory can be thought of as being mapped out by the state vector, x(t), for a range oft. Also shown is the state vector at the particular time t¬à4. State equations . A set of nsimultaneous, Ô¨Årst-order differential equations with nvariables, where the nvariables to be solved are the state variables. Output equation . The algebraic equation that expresses the output variables of a system as linear combinations of the state variables and the inputs. Now that the de Ô¨Ånitions have been formally stated, we deÔ¨Å ne the state-space representation of a system. A system is represented in statespace by the following equations: _x¬àAx¬áBu 3.18¬Ü y¬àCx¬áDu 3.19¬Ü fortt0and initial conditions, x(t0), where x¬àstate vector _x¬àderivative of the state vector with respect to time y¬àoutput vector u¬àinput or control vector A¬àsystem matrix B¬àinput matrix C¬àoutput matrix D¬àfeedforward matrix Equation (3.18) is called the state equation , and the vector x, the state vector , contains the state variables. Equation (3.18) can be solved for the state variables, which wedemonstrate in Chapter 4. Equation (3.19) is called the output equation . This equation is used to calculate any other system variables. This representation of a system providescomplete knowledge of all variables of the system at any tt 0.vC vRState space State vector, x(t) State vector trajectoryState vector, x(4) FIGURE 3.3 Graphic representation of state space and a state vector3.3 The General State-Space Representation 121WEBC03 10/28/2014 16:49:44 As an example, for a linear, time-invariant, second-order system with a single input v(t), the state equations could take on the following form: dx1 dt¬àa11x1¬áa12x2¬áb1v t¬Ü (3.20a) dx2 dt¬àa21x1¬áa22x2¬áb2v t¬Ü (3.20b) where x1andx2are the state variables. If there is a single output, the output equation could take on the following form: y¬àc1x1¬ác2x2¬ád1v t¬Ü 3.21¬Ü The choice of state variables for a given system is not unique. The requirement in choosing the state variables is that they be linearly independent and that a minimum number of thembe chosen. 3.4 Applying the State-Space Representation In this section, we apply the state-space formulation to the representation of morecomplicated physical systems. The Ô¨Årst step in representing a system is to select the state vector, which must be chosen according to the following considerations: 1.A minimum number of state variables must be selected as components of the state vector. This minimum number of state variables is suf Ô¨Åcient to describe completely the state of the system. 2.The components of the state vector (that is, this minimum number of state variables) mustbe linearly independent. Let us review and clarify these statements. Linearly Independent State Variables The components of the state vector must be linearly independent. For example, following thedeÔ¨Ånition of linear independence in Section 3.3, if x 1,x2, and x3are chosen as state variables, butx3¬à5x1¬á4x2,t h e n x3is not linearly independent of x1andx2, since knowledge of the values of x1andx2will yield the value of x3. Variables and their successive derivatives are linearly independent. For example, the voltage across an inductor, vL, is linearly independent of the current through the inductor, iL, since vL¬àLdi L=dt. Thus, vLcannot be evaluated as a linear combination of the current, iL. Minimum Number of State Variables How do we know the minimum number of state variables to select? Typically, the minimumnumber required equals the order of the differential equation describing the system. For example, if a third-order differential equation describes the system, then three simultaneous, Ô¨Årst-order differential equations are required along with three state variables. From theperspective of the transfer function, the order of the differential equation is the order ofthe denominator of the transfer function after canceling common factors in the numeratorand denominator. In most cases, another way to determine the number of state variables is to count the number of independent energy-storage elements in the system. 5The number of 5Sometimes it is not apparent in a schematic how many independent energy-storage elements there are. It is possible that more than the minimum number of energy-storage elements could be selected, leading to a state vector whose components number more than the minimum required and are not linearly independent. Selecting additional dependent energy-storage elements results in a system matrix of higher order and more complexity than required for the solution of the state equations.122 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:44 these energy-storage elements equals the orde r of the differential equation and the number of state variables. In Figure 3.2 there are two energy-storage elements, the capacitor and the inductor. Hence, two state variables and two state equations are required for the system. If too few state variables are selected, it may be impossible to write particular output equations, since some system variables cannot be written as a linear combination of thereduced number of state variables. In many cases, it may be impossible even to complete thewriting of the state equations, since the derivatives of the state variables cannot be expressedas linear combinations of the reduced number of state variables. If you select the minimum number of state variables but they are not linearly independent, at best you may not be able to solve for all other system variables. At worstyou may not be able to complete the writing of the state equations. Often the state vector includes more than the minimum number of state variables required. Two possible cases exist. Often state variables are chosen to be physicalvariables of a system, such as position and ve locity in a mechanical system. Cases arise where these variables, although linearly independent, are also decoupled .T h a ti s ,s o m e linearly independent variables are not required in order to solve for any of the other linearly independent variables or any other dependent system variable. Consider the case of a mass and viscous damper whose differential equation is Md v =dt¬áDv¬àf t¬Ü,w h e r e v is the velocity of the mass. Since this is a Ô¨Årst-order equation, one state equation is all that is required to de Ô¨Åne this system in state space with velocity as the state variable. Also, since there is only one energy-storag e element, mass, only one state variable is required to represent this system in state space. However, the mass also has anassociated position, which is linearly independent of velocity. If we want to includeposition in the state vector along with velocity, then we add position as a state variable that is linearly independent of the other state variable, velocity. Figure 3.4 illustrates what is happening. The Ô¨Årst block is the transfer function equivalent to Mdv t¬Ü=dt¬áDv t¬Ü¬àf t¬Ü. The second block shows that we integrate the output velocity to yield output displacement (see Table 2.2,Item 10). Thus, if we want displacement as an output, the denominator, orcharacteristic equation, has increased in order to 2, the product of the two transferfunctions. Many times, the writing of the state equations is simpli Ô¨Åed by including additional state variables. Another case that increases the size of the state vector arises when the added variable is not linearly independent of the other members of the state vector. This usually occurs when a variable is selected as a state variable but its dependence on theother state variables is not immediately apparent. For example, energy-storage elementsmay be used to select the state variables, and the dependence of the variable associatedwith one energy-storage element on the variables of other energy-storage elements maynot be recognized. Thus, the dimension of the system matrix is increased unnecessarily,and the solution for the state vector, which we cover in Chapter 4, is more dif Ô¨Åcult. Also, adding dependent state variables affects the designer ‚Äôs ability to use state-space methods for design. 6 We saw in Section 3.2 that the state-space representation is not unique. The following example demonstrates one technique for selecting state variables and representing a systemin state space. Our approach is to write the simple derivative equation for each energy-storage element and solve for each derivative term as a linear combination of any of thesystem variables and the input that are present in the equation. Next we select eachdifferentiated variable as a state variable. Then we express all other system variables in the equations in terms of the state variables and the input. Finally, we write the output variables as linear combinations of the state variables and the input.F(s) V(s) X(s)1 M D Ms +1 s FIGURE 3.4 Block diagram of a mass and damper 6See Chapter 12 for state-space design techniques.3.4 Applying the State-Space Representation 123WEBC03 10/28/2014 16:49:46 Example 3.1 Representing an Electrical NetworkRepresenting an Electrical Network PROBLEM: Given the electrical network of Figure 3.5, Ô¨Ånd a state-space representation if the output is the current through the resistor. SOLUTION: The following steps will yield a viable representation of the network in state space. Step 1 Label all of the branch currents in the network. These include iL,iR, and iC,a s shown in Figure 3.5. Step 2 Select the state variables by writing the derivative equation for all energy-storage elements, that is, the inductor and the capacitor. Thus, CdvC dt¬àiC 3.22¬Ü LdiL dt¬àvL 3.23¬Ü From Eqs. (3.22) and (3.23), choose the state variables as the quantities that are differentiated, namely vCandiL. Using Eq. (3.20) as a guide, we see that the state-space representation is complete if the right-hand sides of Eqs. (3.22) and (3.23) can be writtenas linear combinations of the state variables and the input. Since i CandvLare not state variables, our next step is to express iCandvLas linear combinations of the state variables, vCandiL, and the input, v(t). Step 3 Apply network theory, such as Kirchhoff ‚Äôs voltage and current laws, to obtain iC andvLin terms of the state variables, vCandiL. At Node 1, iC¬à iR¬áiL ¬à 1 RvC¬áiL 3.24¬Ü which yields iCin terms of the state variables, vCandiL. Around the outer loop, vL¬à vC¬áv t¬Ü 3.25¬Ü which yields vLin terms of the state variable, vC, and the source, v(t). Step 4 Substitute the results of Eqs. (3.24) and (3.25) into Eqs. (3.22) and (3.23) toobtain the following state equations: CdvC dt¬à 1 RvC¬áiL (3.26a) LdiL dt¬à  vC¬áv t¬Ü (3.26b)Node 1 CL R iC(t)iR(t)iL v(t)(t) +‚Äì FIGURE 3.5 Electrical network for representation in state space124 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:49 In order to clarify the representation of physical systems in state space, we will look at two more examples. The Ô¨Årst is an electrical network with a dependent source. Although we will follow the same procedure as in the previous problem, this problem will yield increased complexity in applying network analysis to Ô¨Ånd the state equations. For the second example, weÔ¨Ånd the state-space representation of a mechanical system.or dvC dt¬à 1 RCvC¬á1 CiL (3.27a) diL dt¬à 1 LvC¬á1 Lv t¬Ü (3.27b) Step 5 Find the output equation. Since the output is iR(t), iR¬à1 RvC 3.28¬Ü TheÔ¨Ånal result for the state-space representation is found by representing Eqs. (3.27) and (3.28) in vector-matrix form as follows: _vC _iL"# ¬à 1= RC¬Ü 1=C  1=L 0"# vC iL"# ¬á0 1=L"# v t¬Ü (3.29a) iR¬à1=R0/C2/C3 vC iL/C20/C21 (3.29b) where the dot indicates differentiation with respect to time. Example 3.2 Representing an Electrical Network with a Dependent SourceRepresenting an Electrical Network with a Dependent Source PROBLEM: Find the state and output equations for the electrical network shown in Figure 3.6 if the output vector is y¬à¬âvR2iR2¬äT, where Tmeans transpose.7 SOLUTION: Immediately notice that this network has a voltage-dependent current source.C R1 iR1(t)LNode 1 Node 2 +‚Äì i(t) iL(t)iC(t) iR2(t)R24vL(t) FIGURE 3.6 Electrical network for Example 3.2 7See Appendix G for a discussion of the transpose. Appendix G is located at www.wiley.com/college/nise .3.4 Applying the State-Space Representation 125WEBC03 10/28/2014 16:49:50 Step 1 Label all of the branch currents on the network, as shown in Figure 3.6. Step 2 Select the state variables by listing the voltage-current relationships for all of the energy-storage elements: LdiL dt¬àvL (3.30a) CdvC dt¬àiC (3.30b) From Eqs. (3.30) select the state variables to be the differentiated variables. Thus, the statevariables, x 1andx2, are x1¬àiL;x2¬àvC 3.31¬Ü Step 3 Remembering that the form of the state equation is _x¬àAx¬áBu 3.32¬Ü we see that the remaining task is to transform the right-hand side of Eq. (3.30) into linear combinations of the state variables and input source current. Using Kirchhoff ‚Äôs voltage and current laws, we Ô¨ÅndvLandiCin terms of the state variables and the input current source. Around the mesh containing LandC, vL¬àvC¬ávR2¬àvC¬áiR2R2 3.33¬Ü But at Node 2, iR2¬àiC¬á4vL. Substituting this relationship for iR2into Eq. (3.33) yields vL¬àvC¬á iC¬á4vL¬ÜR2 3.34¬Ü Solving for vL, we get vL¬à1 1 4R2 vC¬áiCR2¬Ü 3.35¬Ü Notice that since vCis a state variable, we only need to Ô¨Ånd iCin terms of the state variables. We will then have obtained vLin terms of the state variables. Thus, at Node 1 we can write the sum of the currents as iC¬ài t¬Ü iR1 iL ¬ài t¬Ü vR1 R1 iL ¬ài t¬Ü vL R1 iL 3.36¬Ü where vR1¬àvL. Equations (3.35) and (3.36) are two equations relating vLandiCin terms of the state variables iLandvC. Rewriting Eqs. (3.35) and (3.36), we obtain two simultaneous equations yielding vLandiCas linear combinations of the state variables iLandvC: 1 4R2¬ÜvL R2iC¬àvC (3.37a)  1 R1vL iC¬àiL i t¬Ü (3.37b)126 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:50 In the next example, we Ô¨Ånd the state-space representation for a mechanical system. It is more convenient when working wi th mechanical systems to obtain the state equations directly from the equations of mot ion rather than from the energy-storage elements. For example, consider an energy-storage element such as a spring, where F¬àKx. This relationship does not contain the derivative of a physical variable as in the case of electrical networks, where i¬àCd v =dtfor capacitors, and v¬àLd i =dtfor inductors. Thus, in mechanical systems we change our selection of state variables to be the position and velocityof each point of linearly independent motion. In the example, we will see that although thereare three energy-storage elements, there will be four state variables; an additional linearlyindependent state variable is included for the convenience of writing the state equations. It isleft to the student to show that this system yields a fourth-order transfer function if we relate thedisplacement of either mass to the applied force, and a third-order transfer function if we relate the velocity of either mass to the applied force.Solving Eq. (3.37a) simultaneously for vLandiCyields vL¬à1 Œî¬âR2iL vC R2i t¬Ü¬ä 3.38¬Ü and iC¬à1 Œî 1 4R2¬ÜiL¬á1 R1vC  1 4R2¬Üi t¬Ü/C20/C21 3.39¬Ü where Œî¬à  1 4R2¬Ü¬áR2 R1/C20/C21 3.40¬Ü Substituting Eqs. (3.38) and (3.39) into (3.30), simplifying, and writing the result in vector-matrix form renders the following state equation: _iL _vC"# ¬àR2= LŒî¬Ü  1= LŒî¬Ü 1 4R2¬Ü= CŒî¬Ü1= R1CŒî¬Ü"#iL vC"# ¬á R2= LŒî¬Ü   1 4R2¬Ü= CŒî¬Ü"# i t¬Ü 3.41¬Ü Step 4 Derive the output equation. Since the speci Ô¨Åed output variables are vR2andiR2, we note that around the mesh containing C,L, and R2, vR2¬à vC¬ávL (3.42a) iR2¬àiC¬á4vL (3.42b) Substituting Eqs. (3.38) and (3.39) into Eq. (3.42), vR2andiR2are obtained as linear combinations of the state variables, iLandvC. In vector-matrix form, the output equation is vR2 iR2"# ¬àR2=Œî   1¬á1=Œî¬Ü 1=Œî 1 4R1¬Ü= ŒîR1¬Ü"# iL vC"# ¬á R2=Œî  1=Œî"# i t¬Ü 3.43¬Ü3.4 Applying the State-Space Representation 127WEBC03 10/28/2014 16:49:52 Example 3.3 Representing a Translational Mechanical SystemRepresenting a Translational Mechanical System PROBLEM: Find the state equations for the translational mechanical system shown in Figure 3.7. SOLUTION: First write the differential equations for the network in Figure 3.7, using the methods of Chapter 2 to Ô¨Ånd the Laplace-transformed equations of motion. Next take the inverse Laplace transform of these equations, assuming zero initial conditions, and obtain M1d2x1 dt2¬áDdx1 dt¬áKx1 Kx2¬à0 3.44¬Ü  Kx 1¬áM2d2x2 dt2¬áKx2¬àf t¬Ü 3.45¬Ü Now let d2x1/dt2¬àdv1/dt, and d2x2/dt2¬àdv2/dt, and then select x1,v1,x2, and v2as state variables. Next form two of the state equations by solving Eq. (3.44) for dv1/dtand Eq. (3.45) for dv2/dt. Finally, add dx1/dt¬àv1anddx2/dt¬àv2to complete the set of state equations. Hence, dx1 dt¬à¬á v1 (3.46a) dv1 dt¬à K M1x1 D M1v1¬áK M1x2 (3.46b) dx2 dt¬à¬á v2 (3.46c) dv2 dt¬à¬áK M2x1  K M2x2 ¬á1 M2f t¬Ü (3.46d) In vector-matrix form, _x1 _v1 _x2 _v22 666643 77775¬à010 0  K=M 1 D=M1K=M10 000 1 K=M2 0  K=M202 666643 77775x 1 v1 x2 v22 666643 77775¬á0 0 0 1=M 22 666643 77775f t¬Ü 3.47¬Ü where the dot indicates differentiation with respect to time. What is the output equation if the output is x(t)?D K f(t) FrictionlessM1 M2x1 x2 FIGURE 3.7 Translational mechanical system128 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:52 Skill-Assessment Exercise 3.1 PROBLEM: Find the state-space representation of the electrical network shown in Figure 3.8. The output is vo(t). ANSWER: _x¬à1=C11=C1 1=C1  1=L 00 1=C2 0  1=C22 6643 775x¬á0 102 6643 775v i t¬Ü y¬à001/C2/C3 x The complete solution is at www.wiley.com/college/nise . Skill-Assessment Exercise 3.2 PROBLEM: Represent the translational mechanical system shown in Figure 3.9 in state space, where x3(t) is the output. ANSWER: _z¬à010000  1 10100 000100 01  1 110 0000010010  1 12 66666666643 7777777775z¬á0 100 0 02 66666666643 7777777775f t¬Ü y¬à 000010/C2/C3 z where z¬àx 1 _x1x2 _x2x3 _x3/C2/C3T The complete solution is at www.wiley.com/college/nise .vi(t) vo(t) ++ ‚Äì‚ÄìL C2C1 R FIGURE 3.8 Electric circuit for Skill-Assessment Exercise 3.1 f(t)1 kg1 N/m 1 N-s/m 1 N/m 1 N-s/m 1 kg 1 kgx1(t) x2(t) x3(t) FIGURE 3.9 Translational mechanical system for Skill-Assessment Exercise 3.23.4 Applying the State-Space Representation 129WEBC03 10/28/2014 16:49:53 3.5 Converting a Transfer Function to State Space In the last section, we applied the state-space representation to electrical and mechanical systems. We learn how to convert a transfer function representation to a state-spacerepresentation in this section. One advantage of the state-space representation is that itcan be used for the simulation of physical systems on the digital computer. Thus, if we wantto simulate a system that is represented by a transfer function, we must Ô¨Årst convert the transfer function representation to state space. AtÔ¨Årst we select a set of state variables, called phase variables , where each subsequent state variable is de Ô¨Åned to be the derivative of the previous state variable. In Chapter 5 we show how to make other choices for the state variables. Let us begin by showing how to represent a general, nth-order, linear differential equation with constant coef Ô¨Åcients in state space in the phase-variable form. We will then show how to apply this representation to transfer functions. Consider the differential equation dny dtn¬áan 1dn 1y dtn 1¬á‚àô‚àô‚àô¬áa1dy dt¬áa0y¬àb0u 3.48¬Ü A convenient way to choose state variables is to choose the output, y(t), and its ( n 1) derivatives as the state variables. This choice is called the phase-variable choice . Choosing the state variables, xi, we get x1¬ày (3.49a) x2¬àdy dt(3.49b) x3¬àd2y dt2(3.49c) ... xn¬àdn 1y dtn 1(3.49d) and differentiating both sides yields _x1¬àdy dt(3.50a) _x2¬àd2y dt2(3.50b) _x3¬àd3y dt3(3.50c) ... _xn¬àdny dtn (3.50d) where the dot above the xsigniÔ¨Åes differentiation with respect to time. Substituting the de Ô¨Ånitions of Eq. (3.49) into Eq. (3.50), the state equations are evaluated as130 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:54 _x1¬àx2 (3.51a) _x2¬àx3 (3.51b) ... _xn 1¬àxn (3.51c) _xn¬à a0x1 a1x2‚àô‚àô‚àô an 1xn¬áb0u (3.51d) where Eq. (3.51d) was obtained from Eq. (3.48) by solving for dny/dtnand using Eq. (3.49). In vector-matrix form, Eq. (3.51) become _x1 _x2 _x3 ... _xn 1 _xn2 666666666643 77777777775¬à010000 ‚àô‚àô‚àô 0 001000 ‚àô‚àô‚àô 0 000100 ‚àô‚àô‚àô 0 ... 000000 ‚àô‚àô‚àô 1  a0 a1 a2 a3 a4 a5‚àô‚àô‚àô  an 12 666666666643 77777777775x 1 x2 x3 ... xn 1 xn2 666666666643 77777777775¬á0 0 0 ... 0 b 02 666666666643 77777777775u 3.52¬Ü Equation (3.52) is the phase-variable form of the state equations. This form is easily recognized by the unique pattern of 1 ‚Äôs and 0 ‚Äôs and the negative of the coefÔ¨Å cients of the differential equation written in reverse order in the last row of the system matrix. Finally, since the solution to the differential equation is y(t), or x 1, the output equation is y¬à100 ‚àô‚àô‚àô 0/C2/C3x1 x2 x3 ... xn 1 xn2 6666666643 777777775 3.53¬Ü In summary, then, to convert a transfer function into state equations in phase-variable form, we Ô¨Årst convert the transfer function to a differential equation by cross-multiplying and taking the inverse Laplace transform, assuming zero initial conditions. Then we represent the differential equation in state space in phase-variable form. An example illustrates the process. Example 3.4 Converting a Transfer Function with a Constant Term in theNumeratorConverting a Transfer Function with a Constant Term inthe Numerator PROBLEM: Find the state-space representation in phase-variable form for the transfer function shown in Figure 3.10( a). SOLUTION: Step 1 Find the associated differential equation. Since C s¬Ü R s¬Ü¬à24 s3¬á9s2¬á26s¬á24¬Ü 3.54¬Ü3.5 Converting a Transfer Function to State Space 131WEBC03 10/28/2014 16:49:55 cross-multiplying yields s3¬á9s2¬á26s¬á24¬ÜC s¬Ü¬à24R s¬Ü 3.55¬Ü The corresponding differential equation is found by taking the inverse Laplace transform, assuming zero initial conditions: ‚Ç¨c?¬á9‚Ç¨c¬á26_c¬á24c¬à24r 3.56¬Ü Step 2 Select the state variables. Choosing the state variables as successive derivatives, we get x1¬àc (3.57a) x2¬à_c (3.57b) x3¬à‚Ç¨c(3.57c) Differentiating both sides and making use of Eq. (3.57) to Ô¨Ånd _x1and _x2, and Eq. (3.56) to Ô¨Ånd~c¬à_x3, we obtain the state equations. Since the output is c¬àx1, the combined state and output equations are _x1¬à x2 (3.58a) _x2¬à x3 (3.58b) _x3¬à 24x1 26x2 9x3¬á24r (3.58c) y¬àc¬àx1 (3.58d) In vector-matrix form, _x1 _x2 _x32 643 75¬à01 0 00 1  24  26  92 643 75x1 x2 x32 643 75¬á0 0 242 643 75r (3.59a) y¬à100/C2/C3x1 x2 x32 435 (3.59b)R(s) C(s) 24 s3 + 9s2 + 26s + 24 (a) 24+ r(t) x3(t) x3(t) x2(t) x1(t)y(t) (b)9 26 24‚Äì‚Äì‚Äì FIGURE 3.10 a.Transfer function; b.equivalent block diagram showing phase variables. Note: y t¬Ü¬àc t¬Ü.132 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:55 The transfer function of Example 3.4 has a constant term in the numerator. If a transfer function has a polynomial in sin the numerator that is of order less than the polynomial in the denominator, as shown in Figure 3.11( a), the numerator and denominator can be handled separately. First separate the transfer function into two cascaded transfer functions, as shown in Figure 3.11( b); the Ô¨Årst is the denominator, and the second is just the numerator. TheÔ¨Årst transfer function with just the denominator is converted to the phase-variable representation in state space as demonstrated in the last example. Hence, phase variable x1 is the output, and the rest of the phase variables are the internal variables of the Ô¨Årst block, as shown in Figure 3.11( b). The second transfer function with just the numerator yields Y s¬Ü¬àC s¬Ü¬à b2s2¬áb1s¬áb0¬ÜX1 s¬Ü 3.60¬Ü where, after taking the inverse Laplace transform with zero initial conditions, y t¬Ü¬àb2d2x1 dt2¬áb1dx1 dt¬áb0x1 3.61¬ÜNotice that the third row of the system matrix has the same coef Ô¨Åcients as the denominator of the transfer function but negative and in reverse order. At this point, we can create an equivalent block diagram of the system of Figure 3.10( a) to help visualize the state variables. We draw three integral blocks as shown in Figure 3.10( b) and label each output as one of the state variables, xi(t), as shown. Since the input to each integrator is xi(t), use Eqs. (3.58a), (3.58b), and (3.58c) to determine the combination of input signals to each integrator. Form and label each input. Finally, use Eq. (3.58d) to formand label the output, y t¬Ü¬àc t¬Ü.T h e Ô¨Ånal result of Figure 3.10( b) is a system equivalent to Figure 3.10( a) that explicitly shows the state variables and gives a vivid picture of the state-space representation. Students who are using MATLAB should now run ch3p1 through ch3p4in Appendix B. You will learn how to represent the system matrix A, the input matrix B, and the output matrix Cusing MATLAB. You will learn how to convert a transfer function to the state-space representation in phase-variable form. Finally, Example 3.4 will be solved using MATLAB. R(s) X1(s) 1 a3s3 + a2s2 + a1s + a0b2s2 + b1s + b0b2s2 + b1s + b0 a3s3 + a2s2 + a1s + a0 (a) (b)Internal variables: X2(s), X 3(s)C(s)R(s) C(s) FIGURE 3.11 Decomposing a transfer function3.5 Converting a Transfer Function to State Space 133WEBC03 10/28/2014 16:49:56 But the derivative terms are the de Ô¨Ånitions of the phase variables obtained in the Ô¨Årst block. Thus, writing the terms in reverse order to conform to an output equation, y t¬Ü¬àb0x1¬áb1x2¬áb2x3 3.62¬Ü Hence, the second block simply forms a speci Ô¨Åed linear combination of the state variables developed in the Ô¨Årst block. From another perspective, the denominator of the transfer function yields the state equations, while the numerator yields the output equation. The next example demonstrates the process. Example 3.5 Converting a Transfer Function with a Polynomial in theNumeratorConverting a Transfer Function with a Polynomial inthe Numerator PROBLEM: Find the state-space representation of the transfer function shown in Figure 3.12( a). R(s) X1(s) s2 + 7s + 21 s3 + 9s2 + 26s + 24 (b)Internal variables: X2(s), X 3(s)C(s)s2 + 7s + 2 s3 + 9s2 + 26s + 24 (a)R(s) C(s) 1 9 26 24+ r(t) (c)x3(t) x3(t) x2(t) x1(t)y(t)1 7 2+ ++ ‚Äì‚Äì‚Äì FIGURE 3.12 a.Transfer function; b.decomposed transfer function; c.equivalent block diagram Note: y t¬Ü¬àc t¬Ü.134 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:57 SOLUTION: This problem differs from Example3.4, since the numerator has a polynomial insinstead of just a constant term. Step 1 Separate the system into two cascaded blocks, as shown in Figure 3.12( b). The Ô¨Årst block contains the denominator and the second block contains the numerator. Step 2 Find the state equations for the block containing the denominator. We notice that the Ô¨Årst block ‚Äôs numerator is 1/24 that of Example 3.4. Thus, the state equations are the same except that this system‚Äô s input matrix is 1/24 that of Example 3.4. Hence, the state equation is _x1 _x2 _x32 643 75¬à01 0 00 1  24  26  92 643 75x1 x2 x32 643 75¬á0 0 12 643 75r 3.63¬Ü Step 3 Introduce the effect of the block with the numerator. The second block of Figure 3.12( b), where b2¬à1;b1¬à7, and b0¬à2, states that C s¬Ü¬à b2s2¬áb1s¬áb0¬ÜX1 s¬Ü¬à s2¬á7s¬á2¬ÜX1 s¬Ü 3.64¬Ü Taking the inverse Laplace transform with zero initial conditions, we get c¬à‚Ç¨x1¬á7_x1¬á2x1 3.65¬Ü But, x1¬àx1 _x1¬àx2 ‚Ç¨x1¬àx3 Hence, y¬àc t¬Ü¬àb2x3¬áb1x2¬áb0x1¬àx3¬áx2¬á2x1 3.66¬Ü Thus, the last box of Figure 3.11( b)‚Äúcollects ‚Äùthe states and generates the output equation. From Eq. (3.66), y¬àb0b1b2/C2/C3x1 x2 x32 435¬à271/C2/C3x 1 x2 x32435 3.67¬Ü Although the second block of Figure 3.12( b) shows differentiation, this block was implemented without differentiation because of the partitioning that was applied to the transfer function. The last block simply collected derivatives that were already formed by theÔ¨Årst block. Once again we can produce an equivalent block diagram that vividly represents our state-space model. The Ô¨Årst block of Figure 3.12( b) is the same as Figure 3.10( a) except for the different constant in the numerator. Thus, in Figure 3.12( c) we reproduce Figure 3.10( b) except for the change in the numerator constant, which appears as a change in the input multiplying factor. The second block of Figure 3.12( b) is represented using Eq. (3.66), which forms the output from a linear combination of the state variables, as shown in Figure 3.12( c).TryIt 3.1 Use the following MATLAB statements to form an LTIstate-space representation from the transfer function shown in Figure 3.12(a). TheAmatrix and Bvector are shown in Eq. (3.63). The C vector is shown in Eq. (3.67). num=[1 7 2] ; den=[1 9 26 24] ; [A,B,C,D] =tf2ss... (num, den) ; P=[ 001 ; 010 ; 100 ] ; A=inv(P) *A*P B=inv(P) *B C=C*P3.5 Converting a Transfer Function to State Space 135WEBC03 10/28/2014 16:49:58 3.6 Converting from State Space to a Transfer Function In Chapters 2 and 3, we have explored two methods of representing systems: the transfer function representation and the state-space representation. In the last section, we united the two representations by converting transfer functions into state-space representations.Now we move in the opposite direction and convert the state-space representation into atransfer function. Given the state and output equations _x¬àAx¬áBu (3.68a) y¬àCx¬áDu (3.68b) take the Laplace transform assuming zero initial conditions: 8 sX s¬Ü¬àAX s¬Ü¬áBU s¬Ü (3.69a) Y s¬Ü¬àCX s¬Ü¬áDU s¬Ü (3.69b) Solving for X(s) in Eq. (3.69a), sI A¬ÜX s¬Ü¬àBU s¬Ü 3.70¬Ü or X s¬Ü¬à sI A¬Ü 1BU s¬Ü 3.71¬Ü where Iis the identity matrix. Substituting Eq. (3.71) into Eq. (3.69b) yields Y s¬Ü¬àC sI A¬Ü 1BU s¬Ü¬áDU s¬Ü¬àC sI A¬Ü 1B¬áD/C2/C3 U s¬Ü 3.72¬Ü We call the matrix C sI A¬Ü 1B¬áD/C2/C3 the transfer function matrix, since it relates the output vector, Y(s), to the input vector, U(s). However, if U s¬Ü¬àU s¬ÜandY s¬Ü¬àY s¬Ü are scalars, we can Ô¨Ånd the transfer function, Thus,Skill-Assessment Exercise 3.3 PROBLEM: Find the state equations and output equation for the phase-variable repre- sentation of the transfer function G s¬Ü¬à2s¬á1 s2¬á7s¬á9. ANSWER: _x¬à01  9  7/C20/C21 x¬á0 1/C20/C21 r t¬Ü y¬à12/C2/C3 x The complete solution is at www.wiley.com/college.nise . 8The Laplace transform of a vector is found by taking the Laplace transform of each component. Since _xconsists of the derivatives of the state variables, the Laplace transform of _xwith zero initial conditions yields each component with the form sXi(s), where Xi(s) is the Laplace transform of the state variable. Factoring out the complex variable, s,i ne a c h component yields the Laplace transform of _xassX(s), where X(s) is a column vector with components Xi(s).136 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:49:59 T s¬Ü¬àY s¬Ü U s¬Ü¬àC sI A¬Ü 1B¬áD 3.73¬Ü Let us look at an example. Example 3.6 State-Space Representation to Transfer FunctionState-Space Representation to Transfer Function PROBLEM: Given the system de Ô¨Åned by Eq. (3.74), Ô¨Ånd the transfer function, T s¬Ü¬àY s¬Ü=U s¬Ü, where U(s) is the input and Y(s) is the output. _x¬à010 001  1  2  32 435x¬á10 0 02 435u (3.74a) y¬à100/C2/C3 x (3.74b) SOLUTION: The solution revolves around Ô¨Ånding the term sI A¬Ü  1in Eq. (3.73).9All other terms are already de Ô¨Åned. Hence, Ô¨ÅrstÔ¨Ånd sI A¬Ü: sI A¬Ü¬às00 0s0 00 s2 643 75 010 001  1  2  32 643 75¬às 10 0 s 1 12 s¬á32 643 75 (3.75) Now form sI A¬Ü 1: sI A¬Ü 1¬àadj sI A¬Ü det sI A¬Ü¬à s2¬á3s¬á2¬Ü s¬á31  1 s s¬á3¬Ü s  s   2s¬á1¬Üs22 643 75 s3¬á3s2¬á2s¬á1(3.76) Substituting sI A¬Ü 1,B,C, and Dinto Eq. (3.73), where B¬à10 0 02 6643 775 C¬à100/C2/C3 D¬à0 we obtain the Ô¨Ånal result for the transfer function: T s¬Ü¬à10 s2¬á3s¬á2¬Ü s3¬á3s2¬á2s¬á1(3.77) 9See Appendix G. It is located at www.wiley.com/college/nise and discusses the evaluation of the matrix inverse.3.6 Converting from State Space to a Transfer Function 137WEBC03 10/28/2014 16:50:0 In Example 3.6, the state equations in phase-variable form were converted to transfer functions. In Chapter 5, we will see that other forms besides the phase-variable form can be used to represent a system in state space. The method of Ô¨Ånding the transfer function representation for these other forms is the same as that presented in this section. 3.7 Linearization A prime advantage of the state-space representation over the transfer function representationis the ability to represent systems with nonlinearities, such as the one shown in Figure 3.13. The ability to represent nonlinear systems does not imply the ability to solve their state equations for the state variables and the output. Techniques do exist for the solution of somenonlinear state equations, but this study is beyond the scope of this course. However, inAppendix H, located at www.wiley.com/college/nise , you can see how to use the digital computer to solve state equations. This method also can be used for nonlinear state equations. If we are interested in small perturbations about an equilibrium point, as we were when we studied linearization in Chapter 2, we can also linearize the state equations aboutthe equilibrium point. The key to linearization about an equilibrium point is, once again, the Taylor series. In the following example, we write the state equations for a simple pendulum, showing that we can represent a nonlinear system in state space; then we linearize thependulum about its equilibrium point, the vertical position with zero velocity.Students who are using MATLAB should now run ch3p5 in Appendix B.You will learn how to convert a state-space representation to a transfer function using MATLAB. You can practice by writing a MATLAB program to solve Example 3.6. Students who are performing the MATLAB exercises and want toexplore the added capability of MATLAB‚Äô s Symbolic Math Toolbox should now run ch3sp1 in Appendix F located at www.wiley.com/ college/nise . You will learn how to use the Symbolic Math Toolbox to write matrices and vectors. You will see that the SymbolicMath Toolbox yields an alternative way to use MATLAB to solveExample 3.6. Skill-Assessment Exercise 3.4 PROBLEM: Convert the state and output equations shown in Eq. (3.78) to a transfer function. _x¬à 4 1:5 40/C20/C21 x¬á2 0/C20/C21 u t¬Ü (3.78a) y¬à1:50 :625/C2/C3 x (3.78b) ANSWER: G s¬Ü¬à3s¬á5 s2¬á4s¬á6 The complete solution is located at www.wiley.com/college/nise .TryIt 3.2 Use the following MATLAB and the Control SystemToolbox statements to obtainthe transfer function shown in Skill-Assessment Exercise 3.4 from the state-spacerepresentation of Eq. (3.78). A=[ 4 1.5;4 0] ; B=[2 0] ‚Äô; C=[1.5 0.625] ; D=0; T=ss(A,B,C,D) ; T=tf(T)138 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:1 Bruce Frisch/S.S./Photo Researchers, Inc.FIGURE 3.13 Walking robots, such as Hannibal shown here, can be used to explore hostile environments and rough terrain, such as that found onother planets or inside volcanoes Example 3.7 Representing a Nonlinear SystemRepresenting a Nonlinear System PROBLEM: First represent the simple pendulum shown in Figure 3.14(a ) (which could be a simple model for the leg of the robot shown in Figure 3.13) in state space: Mgis the weight, Tis an applied torque in the Œ∏direction, and Lis the length of the pendulum. Assume the mass is evenly distributed, with the center of mass at L/2. Then linearize the state equations about the pendulum ‚Äôs equilibrium point ‚Äîthe vertical position with zero angular velocity. SOLUTION: First draw a free-body diagram as shown in Figure 3.14( c). Summing the torques, we get Jd2Œ∏ dt2¬áMgL 2sinŒ∏¬àT 3.79¬Ü where Jis the moment of inertia of the pendulum around the point of rotation. Select the state variables x1andx2as phase variables. Letting x1¬àŒ∏andx2¬àdŒ∏/dt, we write the state equations as( ) ( )( )MgT Œ∏ L2 Mg sin Œ∏TMgL 2d2Œ∏ dt2J ab cL2 Œ∏ Œ∏Mg cos Œ∏sinŒ∏ Mg FIGURE 3.14 a.Simple pendulum; b.force components of Mg;c.free-body diagramVirtual Experiment 3.1 Rotary Inverted Pendulum Put theory into practice by simulating the linear and non-linearmodel of the Quanser Rotary Inverted Pendulum in LabVIEW. The behavior of an invertedpendulum is similar to a variety ofsystems, such as Segway transporters and human posture. Virtual experiments are found on Learning Space.3.7 Linearization 139WEBC03 10/28/2014 16:50:2 _x1¬àx2 (3.80a) _x2¬à MgL 2Jsinx1¬áT J(3.80b) where _x2¬àd2Œ∏/dt2is evaluated from Eq. (3.79). Thus, we have represented a nonlinear system in state space. It is interesting to note that the nonlinear Eqs. (3.80) represent a valid and complete model of the pendulum in state space even under nonzero initial conditions and even if parameters are time varying.However, if we want to apply classical techniques and convert these state equations to atransfer function, we must linearize them. Let us proceed now to linearize the equation about the equilibrium point, x 1¬à0;x2¬à0, that is, Œ∏¬à0a n d dŒ∏/dt¬à0. Let x1andx2be perturbed about the equilibrium point, or x1¬à0¬áŒ¥x1 (3.81a) x2¬à0¬áŒ¥x2 (3.81b) Using Eq. (2.182), we obtain sinx1 sin0¬àd sinx1¬Ü dx1/C12/C12/C12/C12 x1¬à0Œ¥x1¬àŒ¥x1 3.82¬Ü from which sinx1¬àŒ¥x1 3.83¬Ü Substituting Eqs. (3.81) and (3.83) into Eq. (3.80) yields the following state equations: _Œ¥x1¬àŒ¥x2 (3.84a) _Œ¥x2¬à MgL 2JŒ¥x1¬áT J(3.84b) which are linear and a good approximation to Eq. (3.80) for small excursions away from the equilibrium point. What is the output equation? Skill-Assessment Exercise 3.5 PROBLEM: Represent the translational mechanical system shown in Figure 3.15 in state space about the equilibrium displacement. The spring is nonlinear, where the relationshipbetween the spring force, f s(t), and the spring displacement, xs(t), is fs t¬Ü¬à2x2 s t¬Ü. The applied force is f t¬Ü¬à10¬áŒ¥f t¬Ü,w h e r e Œ¥f(t) is a small force about the 10 N constant value. Assume the output to be the displacement of the mass, x(t). ANSWER: _x¬à01  4Ô¨ÉÔ¨ÉÔ¨É 5p 0"# x¬á0 1"# Œ¥f t¬Ü y¬à10/C2/C3 x The complete solution is located at www.wiley.com/college/nise .x(t) f(t)Nonlinear spring 1 kg FIGURE 3.15 Nonlinear translational mechanical system for Skill-Assessment Exercise 3.5140 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:6 Case Studies Antenna Control: State-Space RepresentationAntenna Control: State-Space Representation We have covered the state-space representation of individual physical subsystems in this chapter. In Chapter 5, we will assemble individual subsystems into feedback controlsystems and represent the entire feedback system in state space. Chapter 5 also shows howthe state-space representation, via signal-Ô¨Çow diagrams, can be used to interconnect these subsystems and permit the state-space representation of the whole closed-loop system. In the following case study, we look at the antenna azimuth position control system anddemonstrate the concepts of this chapter by representing each subsystem in state space. PROBLEM: Find the state-space representation in phase-variable form for each dynamic subsystem in the antenna azimuth position control system shown on the front endpapers, ConÔ¨Åguration 1 .B y dynamic , we mean that the system does not reach the steady state instantaneously. For example, a system described by a differential equation of Ô¨Årst order or higher is a dynamic system. A pure gain, on the other hand, is an example of anondynamic system, since the steady state is reached instantaneously. SOLUTION: In the case study problem of Chapter 2, each subsystem of the antenna azimuth position control system was identi Ô¨Åed. We found that the power ampli Ô¨Åer and the motor and load were dynamic systems. The preampli Ô¨Åer and the potentiometers are pure gains and so respond instantaneously. Hence, we will Ô¨Ånd the state-space representations only of the power ampli Ô¨Åer and of the motor and load. Power ampli Ô¨Åer: The transfer function of the power ampli Ô¨Åer is given on the front endpapers as G s¬Ü¬à100 = s¬á100¬Ü. We will convert this transfer function to its state-space representation. Letting v p(t) represent the power ampli Ô¨Åer input and ea(t)r e p r e s e n t the power ampliÔ¨Å er output, G s¬Ü¬àEa s¬Ü Vp s¬Ü¬à100 s¬á100¬Ü 3.85¬Ü Cross-multiplying, s¬á100¬ÜEa s¬Ü¬à100Vp s¬Ü, from which the differential equation can be written as dea dt¬á100ea¬à100vp t¬Ü 3.86¬Ü Rearranging Eq. (3.86) leads to the state equation with eaas the state variable: dea dt¬à 100ea¬á100vp t¬Ü 3.87¬Ü Since the output of the power ampli Ô¨Åer is ea(t), the output equation is y¬àea 3.88¬Ü Motor and load: We now Ô¨Ånd the state-space representation for the motor and load. We could of course use the motor and load block shown in the block diagram on the front endpapers to obtain theresult. However, it is more informative to derive the state-space representation directlyfrom the physics of the motor without Ô¨Årst deriving the transfer function. The elements ofCase Studies 141WEBC03 10/28/2014 16:50:7 the derivation were covered in Section 2.8 but are repeated here for continuity. Starting with Kirchhoff ‚Äôs voltage equation around the armature circuit, we Ô¨Ånd ea t¬Ü¬àia t¬ÜRa¬áKbdŒ∏m dt 3.89¬Ü where ea(t) is the armature input voltage, ia(t) is the armature current, Rais the armature resistance, Kbis the armature constant, and Œ∏mis the angular displacement of the armature. The torque, Tm(t), delivered by the motor is related separately to the armature current and the load seen by the armature. From Section 2.8, Tm t¬Ü¬àKtia t¬Ü¬àJmd2Œ∏m dt2¬áDmdŒ∏m dt 3.90¬Ü where Jmis the equivalent inertia as seen by the armature, and Dmis the equivalent viscous damping as seen by the armature. Solving Eq. (3.90) for ia(t) and substituting the result into Eq. (3.89) yields ea t¬Ü¬àRaJm Kt/C18/C19d2Œ∏m dt2¬áDmRa Kt¬áKb/C18/C19dŒ∏m dt 3.91¬Ü DeÔ¨Åning the state variables x1andx2as x1¬àŒ∏m (3.92a) x2¬àdŒ∏m dt(3.92b) and substituting into Eq. (3.91), we get ea t¬Ü¬àRaJm Kt/C18/C19dx2 dt¬áDmRa Kt¬áKb/C18/C19 x2 3.93¬Ü Solving for dx2/dtyields dx2 dt¬à 1 JmDm¬áKtKb Ra/C18/C19 x2¬áKt RaJm/C18/C19 ea t¬Ü 3.94¬Ü Using Eqs. (3.92) and (3.94), the state equations are written as dx1 dt¬àx2 (3.95a) dx2 dt¬à 1 JmDm¬áKtKb Ra/C18/C19 x2¬áKt RaJm/C18/C19 ea t¬Ü (3.95b) The output, Œ∏o(t), is 1/10 the displacement of the armature, which is x1. Hence, the output equation is y¬à0:1x1 3.96¬Ü In vector-matrix form, _x¬à01 0 1 JmDm¬áKtKb Ra/C18/C192 643 75x¬á0 Kt RaJm"# ea t¬Ü (3.97a) y¬à0:10/C2/C3 x (3.97b)142 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:8 But from the case study problem in Chapter 2, Jm¬à0:03 and Dm¬à0:02. Also, Kt=Ra¬à0:0625 and Kb¬à0:5. Substituting the values into Eq. (3.97a), we obtain the Ô¨Ånal state-space representation: _x¬à01 0 1:71/C20/C21 x¬á0 2:083/C20/C21 ea t¬Ü (3.98a) y¬à0:10/C2/C3 x (3.98b) CHALLENGE: You are now given a problem to test your knowledge of this chapter‚Äô s objectives. Referring to th e antenna azimuth position control system shown on the front endpapers, Ô¨Ånd the state-space representati on of each dynamic subsystem. Use ConÔ¨Åguration 2. Pharmaceutical Drug AbsorptionPharmaceutical Drug Absorption An advantage of state-space representation over the transfer function representation is the ability to focus on component parts of a system and write nsimultaneous, Ô¨Årst-order differential equations rather than attempt to represent the system as a single, nth-order differential equation, as we have done with the transfer function.Also, multiple-input, multiple-output systems can be conveniently represented in state space. This case study demonstrates both of these concepts. PROBLEM: In the pharmaceutical industry we want to describe the distribution of a drug in the body. A simple model divides the process into compartments: the dosage, the absorption site,the blood, the peripheral compartment, and the urine. The rate ofchange of the amount of a drug in a compartment is equal to theinput Ô¨Çow rate diminished by the output Ô¨Çow rate. Figure 3.16 summarizes the system. Here each x iis the amount of drug in that particular compartment ( Lordi ,1972 ). Represent the system in state space, where the outputs are the amounts of drug in each compartment. SOLUTION: TheÔ¨Çow rate of the drug into any given compartment is proportional to the concentration of the drug in the previous compartment, and the Ô¨Çow rate out of a given compartment is proportional to the concentration of the drug in its own compartment. We now write the Ô¨Çow rate for each compartment. The dosage is released to the absorption site at a rate proportional to the dosage concentration, or dx1 dt¬à K1x1 3.99¬Ü TheÔ¨Çow into the absorption site is proportional to the concentration of the drug at the dosage site. The Ô¨Çow from the absorption site into the blood is proportional to the concentration of the drug at the absorption site. Hence, dx2 dt¬àK1x1 K2x2 3.100 ¬Ü Similarly, the net Ô¨Çow rate into the blood and peripheral compartment is dx3 dt¬àK2x2 K3x3¬áK4x4 K5x3 3.101 ¬Ü dx4 dt¬à K5x3 K4x4 3.102 ¬Üx1DosageAbsorption site Blood Urine x2 x3 x5 x4 Peripheral compartment FIGURE 3.16 Pharmaceutical drug-level concentrations in a humanCase Studies 143WEBC03 10/28/2014 16:50:9 where K4x4 K5x3¬Üis the net Ô¨Çow rate into the blood from the peripheral compartment. Finally, the amount of the drug in the urine is increased as the blood releases the drug to the urine at a rate proportional to the concentration of the drug in the blood. Thus, dx5 dt¬àK3x3 3.103 ¬Ü Equations (3.99) through (3.103) are the state equations. The output equation is a vector that contains each of the amounts, xi. Thus, in vector-matrix form, _x¬à K 1 000 0 K1 K 2 00 0 0 K2  K3¬áK5¬Ü K40 00 K5  K 40 00 K3 002 66666643 7777775x (3.104a) y¬à10000 010000010000010 000012 66666643 7777775x (3.104b) You may wonder how there can be a solution to these equations if there is no input. In Chapter 4, when we study how to solve the state equations, we will see that initial conditions will yield solutions without forcing functions. For this problem, an initial condition on theamount of dosage, x 1, will generate drug quantities in all other compartments. CHALLENGE: We now give you a problem to test your knowledge of this chapter ‚Äôs objectives. The problem concerns the storage of water in aquifers. The principles are similarto those used to model pharmaceutical drug absorption. Underground water supplies, called aquifers, are used in many areas for agricultural, industrial, and residential purposes. An aquifer system consists of a number of interconnectednatural storage tanks. Natural water Ô¨Çows through the sand and sandstone of the aquifer system, changing the water levels in the tanks on its way to the sea. A water conservation policycan be established whereby water is pumped between tanks to prevent its loss to the sea. A model for the aquifer system is shown in Figure 3.17. In this model, the aquifer is represented by three tanks, with water level h icalled the head . Each qnis the natural water q21 = G21(H1‚Äìh1) q2 = G2(h2‚Äìh1) q3 = G3(h3‚Äìh2)q1 = G1h1qi1 qi2 qo2 qi3 qo3 h3 h2 h1 FIGURE 3.17 Aquifer system model144 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:9 Summary This chapter has dealt with the state-space representation of physical systems, which took the form of a state equation, _x¬àAx¬áBu 3.105 ¬Ü and an output equation, y¬àCx¬áDu 3.106 ¬Ü fortt0, and initial conditions x(t0). Vector xis called the state vector and contains variables, called state variables . The state variables can be combined algebraically with the input to form the output equation, Eq. (3.106), from which any other system variables can befound. State variables, which can represent physical quantities such as current or voltage, arechosen to be linearly independent. The choice of state variables is not unique and affectshow the matrices A, B, C , and Dlook. We will solve the state and output equations for xand yin Chapter 4. In this chapter, transfer functions were represented in state space. The form selected was the phase-variable form, which consists of state variables that are successive derivativesof each other. In three-dimensional state space, the resulting system matrix, A,f o rt h e phase-variable representation is of the form 010 001  a 0 a1 a22 435 3.107 ¬Ü where the a i‚Äôs are the coef Ô¨Åcients of the characteristic polynomial or denominator of the system transfer function. We also discussed how to convert from a state-space representation to a transfer function. In conclusion, then, for linear, time-invari ant systems, the state-space representation is simply another way of mathematically modeling them. One major advantage of applyingÔ¨Çow to the sea and is proportional to the difference in head between two adjoining tanks, orq n¬àGn hn hn 1¬Ü, where Gnis a constant of proportionality and the units of qnare m3/yr. The engineered Ô¨Çow consists of three components, also measured in m3/yr: (1) Ô¨Çow from the tanks for irrigation, industry, and homes, qon; (2) replenishing of the tanks from wells, qin; and (3) Ô¨Çow, q21, created by the water conservation policy to prevent loss to the sea. In this model, water for irrigation and industry will be taken only from Tank 2 andTank 3. Water conservation will take place only between Tank 1 and Tank 2, as follows. LetH 1be a reference head for Tank 1. If the water level in Tank 1 falls below H1, water will be pumped from Tank 2 to Tank 1 to replenish the head. If h1is higher than H1, water will be pumped back to Tank 2 to prevent loss to the sea. Calling this Ô¨Çow for conservation q21, we can say this Ô¨Çow is proportional to the difference between the head of Tank 1, h1, and the reference head, H1,o rq21¬àG21 H1 h1¬Ü. The net Ô¨Çow into a tank is proportional to the rate of change of head in each tank. Thus, Cndhn=dt¬àqin qon¬áqn¬á1 qn¬áq n¬á1¬Ün qn n 1¬Ü (Kandel ,1973 ). Represent the aquifer system in state space, where the state variables and the outputs are the heads of each tank.Summary 145WEBC03 10/28/2014 16:50:9 the state-space representation to such linear systems is that it allows computer simulation. Programming the system on the digital computer and watching the system ‚Äôs response is an invaluable analysis and design tool. Simulation is covered in Appendix H located at www.wiley.com/college/nise . Review Questions 1.Give two reasons for modeling systems in state space. 2.State an advantage of the transfer function approach over the state-space approach. 3.DeÔ¨Åne state variables . 4.DeÔ¨Åne state. 5.DeÔ¨Åne state vector . 6.DeÔ¨Åne state space . 7.What is required to represent a system in state space? 8.An eighth-order system would be represented in state space with how many stateequations? 9.If the state equations are a system of Ô¨Årst-order differential equations whose solution yields the state variables, then the output equation performs what function? 10.What is meant by linear independence ? 11.What factors in Ô¨Çuence the choice of state variables in any system? 12.What is a convenient choice of state variables for electrical networks? 13.If an electrical network has three energy-storage elements, is it possible to have a state-space representation with more than three state variables? Explain. 14.What is meant by the phase-variable form of the state equation? Problems 1.Represent the electrical network shown in Figure P3.1 in state space, where vo(t) is the output. [Section: 3.4] 1 Œ© + vi(t) 0.5 F vo(t) ‚Äì+‚Äì3 Œ© 1 Œ© 2 H 1 H FIGURE P3.1 2.Represent the electrical network shown in Figure P3.2 instate space, where i R(t) is the output. [Section: 3.4] 3 Œ© 3 Fv1(t) 4v1(t)3 Œ© vi(t)2 H iR(t)+‚Äì FIGURE P3.23.Find the state-space representation of the network shownin Figure P3.3 if the output is v o(t). [Section: 3.4] vo(t)+ vi(t) 1 F1 H2 Œ© 2 Œ© ‚Äìi3(t) i2(t) i1(t)+‚Äì1 F FIGURE P3.3 4.Represent the system shown in Figure P3.4 in state spacewhere the output is x 3(t). [Section: 3.4]146 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:10 fv2 = 1 N-s/mfv3 = 1 N-s/m fv1 = 1 N-s/mfv4 = 1 N-s/m fv5 = 1 N-s/ m K = 2 N/mM3 = 1 kg M2 = 1 kg M1 = 2 kg x1(t) x2(t)f (t)x3(t) Frictionless FIGURE P3.4 5.Represent the translational mechanical system shown in Figure P3.5 in state space, where x1(t) is the output. [Section: 3.4] f(t)x2(t) x3(t) x1(t)fv1= 1 N-s/m fv2=1 N - s / m M1=1 k gM2= 2 kgM3= 1 kg K1= 1 N/m K2= 1 N/m fv3= 1 N-s/m FIGURE P3.5 6.Represent the rotational mechanical system shown in Figure P3.6 in state space, where Œ∏1(t) is the output. [Section: 3.4] N2 = 100 100 N-m/rad 100 N-m-s/rad100 kg-m2N1 = 30T(t) Œ∏1(t) 50 kg-m2 FIGURE P3.6 7.Represent the system shown in Figure P3.7 in state space where the output is Œ∏L(t). [Section: 3.4] 2 N-m/rad 3 N-m-s/rad N-m/rad 200 N-m-s/radT(t) Œ∏L(t) N4= 100N2= 300N1=3 0 N3=1 0 1 10 FIGURE P3.78.Show that the system of Figure 3.7 in the text yields a fourth-order transfer function if we relate the displacement of either mass to the applied force, and athird-order one if we relate the velocity of either mass tothe applied force. [Section: 3.4] 9.Find the state-space representation in phase-variable form for each of the systems shown in Figure P3.8. [Section: 3.5] R(s) 30 s5 + 8s4 + 9s3 + 6s2 + s + 30 C(s) (b)100 s4+2 0s3+1 0s2+7s+ 100C(s) R(s) (a) FIGURE P3.8 10.Repeat Problem 9 using MATLAB.[Section: 3.5] 11.For each system shown in Figure P3.9, write the stateequations and the output equation for the phase-variablerepresentation. [Section: 3.5] s5+9s4+1 3s3+8s2s4+2s3+1 2s2+7s+6C(s) R(s) (b)R(s) 8s + 10 s4 + 5s3 + s2 + 5s + 13C(s) (a) FIGURE P3.9 12.Repeat Problem 11 using MATLAB.[Section: 3.5] 13.Represent the following transfer function in state space. Give your answer in vector-matrix form. [Section: 3.5] T s¬Ü¬às s¬á2¬Ü s¬á1¬Ü s2¬á2s¬á5¬Ü 14.Find the transfer function G s¬Ü¬àY s¬Ü=R s¬Üfor each of the following systems represented in state space:[Section: 3.6] a._x¬à010 001  3  2  52 66643 7775x¬á0 0 102 66643 7775r y¬à100/C2/C3 xProblems 147WEBC03 10/28/2014 16:50:10 b. _x¬à2 3  8 053  3  5  42 6643 775x¬á1 4 62 6643 775r y¬à136/C2/C3 x c. _x¬à3 52 1 87  3  622 6643 775x¬á5  3 22 6643 775r y¬à1 43/C2/C3 x Use MATLAB to Ô¨Ånd the transfer function, G(s)=Y(s)/R(s), for eachofthefollowingsystemsrepresented in state space: [Section: 3.6] a._x¬à0150 00100001  7  9  2  32 6666643 777775x¬á0 58 22 6666643 777775r y¬à1366/C2/C3 x b. _x¬à31 0 4  2  35  52  1 01  128  76  3 40  60 4 312 6666666643 777777775x¬á2 7 85 42 6666666643 777777775r y¬à1 2  97 6/C2/C3 x Repeat Problem 15 using MATLAB, the Symbolic Math Toolbox, andEq. (3.73). [Section: 3.6] 17.A missile in Ô¨Çight, as shown in Figure P3.10, is subject to four forces: thrust, lift, drag, and gravity. Themissile Ô¨Çies at an angle of attack, Œ±, from its longitu- dinal axis, creating lift. For steering, the body anglefrom vertical, œï, is controlled by rotating the engine at the tail. The transfer function relating the body angle,œï, to the angular displacement, Œ¥, of the engine is of the form Œ¶ s¬Ü Œ¥ s¬Ü¬àKas¬áKb K3s3¬áK2s2¬áK1s¬áK0ThrustLift DragVertical Velocity c. g.œï Œ± Œ¥ FIGURE P3.10 Missile Represent the missile steering control in state space. [Section: 3.5] 18.Given the dc servomotor and load shown in Figure P3.11,represent the system in state space, where the statevariables are the armature current, i a, load displacement, Œ∏L, and load angular velocity, œâL. Assume that the output is the angular displacement of the armature. Do notneglect armature inductance. [Section: 3.4] N2 DLArmatureFixed field JLŒ∏L(t)N1Œ∏m(t)La Ra ea(t) ia(t)+ ‚Äì FIGURE P3.11 Motor and load 19.Consider the mechanical system of Figure P3.12. If thespring is nonlinear, and the force, F s, required to stretch the spring is Fs¬à2x2 1, represent the system in state space linearized about x1¬à1 if the output is x2. [Section: 3.7] 2 N-s/m f(t) 1 kg 2 kgFs = 2x 12 Nx2(t) x1(t) FIGURE P3.12 Nonlinear mechanical system 20.Image-based homing for robots can be implemented by generating heading command inputs to a steering systembased on the following guidance algorithm. Suppose therobot shown in Figure P3.13( a) is to go from point Rto a target, point T, as shown in Figure P3.13( b). IfR x,Ry, and Rzare vectors from the robot to each landmark, X,Y,Z, respectively,and Tx,Ty,andTzarevectorsfromthetarget to each landmark, respectively, then heading commands148 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:11 would drive the robot to minimize Rx Tx;Ry Ty; andRz Tzsimultaneously, since the differences will be zero when the robot arrives at the target ( Hong ,1992 ). If Figure P3.13( c) represents the control system that steers the robot, represent each block ‚Äîthe controller, wheels, and vehicle ‚Äîin state space. An animation PowerPoint presentation (PPT) demonstrating this system is available for instructors at www.wiley.com/college/nise. SeeRobot . [Section: 3.5] X ZY Heading commandHeading errorSteering commandWheel angleActual headingController + ‚ÄìK1(s + a) (s + b)Wheels c s + cVehicle (c)(b)RT Rx RzRy TzTxTy RobotCameraSpherical mirror (a) 1 s FIGURE P3.13 a.Robot with television imaging system;10 b.vector diagram showing concept behind image-based homing;10 c.heading control system 21.Modern robotic manipulators that act directly upon their target environments must be controlled so that impact forces as well as steady-state forces do not damage thetargets. At the same time, the manipulator must providesufÔ¨Åcient force to perform the task. In order to develop a controlsystemtoregulatetheseforces,theroboticmanip-ulator and target environment must be modeled. Assum-ing the model shown in Figure P3.14, represent in statespace the manipulator and its environment under the following conditions ( Chiu ,1997 ). [Section: 3.5] 1 N/m 1 N/m1 N/m 1 N-s/m 1 N-s/m 1 N-s/m 1 N-s/m1 N/m 1 N/m u(t) 1 kg 1 kg 1 kgContact point Manipulator Sensor Internal force modelEnvironment FIGURE P3.14 Robotic manipulator and target environment11a.The manipulator is not in contact with its targetenvironment. b.The manipulator is in constant contact with its target environment. 22.In the past, Type-1 diabetes patients had to injectthemselves with insulin three to four times a day.New delayed-action insulin analogues such as insulinGlargine require a single daily dose. A similar procedure to the one described in the Pharmaceutical Drug Absorption case study of this chapter is used to Ô¨Ånd a model for the concentration-time evolution of plasma for insulinGlargine. For a speci Ô¨Åc patient, state-space model matrices are given by ( Tar√≠n ,2007 ) A¬à 0:435 0 :209 0 :02 0:268  0:394 0 0:227 0  0:022 643 75;B¬à1 002 643 75; C¬à0:0003 0 0/C2/C3 ;D¬à0 where the state vector is given by x¬àx 1 x2 x32 435: The state variables are x 1¬àinsulin amount in plasma compartment x2¬àinsulin amount in liver compartment x3¬àinsulin amount in interstitial in body tissue ¬Ü compartment The system ‚Äôs input is u¬àexternal insulin flow. The system ‚Äôs output is y¬àplasma insulin concentration. a.Find the system ‚Äôs transfer function. b.Verify your result using MATLAB. 23.A linear, time-invariant model of the hypothalamic-pituitary-adrenal axis of the endocrine system withÔ¨Åve state variables has been proposed as follows(Kyrylov ,2005 ): dx0 dt¬àa00x0¬áa02x2¬ád0 dx1 dt¬àa10x0¬áa11x1¬áa12x2 dx2 dt¬àa20x0¬áa21x1¬áa22x2¬áa23x3¬áa24x4 dx3 dt¬àa32x2¬áa33x3 dx4 dt¬àa42x2¬áa44x410Hong, J.; Tan, X.; Pinette, B.; Weiss, R.; and Riseman, E. M. Image-Based Homing, IEEE Control Systems , Feb. 1992, pp. 38 ‚Äì45.ÓÄÇ1992 IEEE. 11Based on Chiu, D. K., and Lee, S. Design and Experimentation of a Jump Impact Controller. IEEE Control Systems , June 1997, Figure 1, p. 99. 1997 IEEE.Problems 149WEBC03 10/28/2014 16:50:12 where each of the state variables represents circulatory concentrations as follows: x0¬àcorticotropin-releasing hormone x1¬àcorticotropin x2¬àfree cortisol x3¬àalbumin-bound cortisol x4¬àcorticosteroid-binding globulin d0¬àan external generating factor Express the system in the form _x¬àAx¬áBu. 24.In this chapter, we described the state-space representationof single-input, single-output systems. In general, systems can have multiple inputs and multiple outputs. An autopilotis to be designed for a submarine as shown in Figure P3.15to maintain a constant depth under severe wave distur- bances. We will see that this system has two inputs and twooutputs and thus the scaler ubecomes a vector, u,a n dt h e scaler ybecomes a vector, y, in the state equations. FIGURE P3.1512 It has been shown that the system ‚Äôs linearized dynamics under neutral buoyancy and at a given constant speedare given by ( Liceaga-Castro, 2009 ): _x¬àAx¬áBu y¬àCx where x¬àw q z Œ∏2 666643 77775;y¬àz Œ∏"# ;u¬àŒ¥ B Œ¥S"#A¬à 0:038 0 :896 0 0 :0015 0:0017  0:092 0  0:0056 10 0  3:086 01 0 02 66666643 7777775; B¬à 0:0075  0:023 0:0017  0:0022 00 002 66666643 7777775;C¬à0010 0001"# and where w¬àthe heave velocity q¬àthe pitch rate z¬àthe submarine depth Œ∏¬àthe pitch angle Œ¥ B¬àthe bow hydroplane angle Œ¥S¬àthe stern hydroplane angle Since this system has two inputs and two outputs, four transfer functions are possible. a.Use MATLAB to calculate the system ‚Äôs matrix transfer function. b.Using the results from Part a, write the transfer functionz s¬Ü Œ¥B s¬Ü;z s¬Ü Œ¥S s¬Ü;Œ∏ s¬Ü Œ¥B s¬Ü;andŒ∏ s¬Ü Œ¥S s¬Ü. 25.Experiments to identify p recision grip dynamics between the index Ô¨Ånger and thumb have been performed using a ball-drop experiment. A subjectholds a device with a small receptacle into which anobject is dropped, and the response is measured(Fagergren ,2000 ). Assuming a step input, it has been found that the response of the motor subsystemtogether with the sensory system is of the form G s¬Ü¬à Y s¬Ü R s¬Ü¬às¬ác s2¬áas¬áb¬Ü s¬ád¬Ü Convert this transfer function to a state-space representation. 26.State-space representations are, in general, not unique. One system can be represented in several possible ways. For example, consider the following systems: a. _x¬à 5x¬á3u y¬à7x12Liceaga-Castro E., van der Molen G.M. Submarine H ‚àûDepth Control Under Wave Disturbances. IEEE Trans. on Control Systems Technology , Vol. 3 No. 3, 1995. Figure 1, p. 339.150 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:13 b. _x1 _x2"# ¬à 50 0 1"# x1 x2"# ¬á31"# u y¬à70/C2/C3 x 1 x2"# c. _x1 _x2"# ¬à 50 0 1"# x1 x2"# ¬á30"# u y¬à73/C2/C3 x 1 x2"# Show that these systems will result in the same transfer function. We will explore this phenomenon in more detail in Chapter 5. 27.Figure P3.16 shows a schematic description of the globalcarbon cycle ( Li,). In the Ô¨Ågure, m A(t)r e p r e s e n t st h e amount of carbon in gigatons (GtC) present in theatmosphere of earth; m V(t) the amount in vegetation; ms(t) the amount in soil; mSO(t) the amount in surface ocean; and mIDO(t) the amount in intermediate and deep- ocean reservoirs. Let uE(t) stand for the human generated CO 2emissions (GtC/yr). From the Ô¨Ågure, the atmospheric mass balance in the atmosphere can be expressed as: dmA dt t¬Ü¬àuE t¬Ü  kO1¬ákL1¬ÜmA t¬Ü¬ákL2mV t¬Ü ¬ákO2mSO t¬Ü¬ákL4mS t¬Ü where the k ‚Äôs are exchange coefÔ¨Å cients (yr 1). a.Write the remaining reservoir mass balances. Namely, write equations fordmSO t¬Ü dt;dmIDO t¬Ü dt;dmV t¬Ü dt; anddmS t¬Ü dt b.Express the system in state-space form. Atmosphere Surface ocean Intermediate and deep ocean Ocean sinkVegetation Soil Land sinkmV mSmA mSO mIDOkL2 kL1 kL4 kO1 kO2 kO3 kO4kL3uE (t ) FIGURE P3.16 Global carban cycle1328.Given the photovoltaic system described in Problem 65 in Chapter 2 ( Agee, 2012 ) and de Ô¨Åning the following state variables, system input and output as y¬àx1¬àŒ∏m; x2¬à_Œ∏m;x3¬àia,a n du ¬àea, write a state-space representation of the system in the form _x¬àAx¬áBu; y¬àCx. 29.A single-pole oil cylinder valve contains a spool that regulates hydraulic pressure, which is then applied to apiston that drives a load. The transfer function relatingpiston displacement, X p s¬Üto spool displacement from equilibrium, Xv s¬Ü, is given by ( Qu, 2010 ): G s¬Ü¬àXp s¬Ü Xv s¬Ü¬àKqœâ2 h=A1 s s2¬á2œÇœâhs¬áœâ2 h¬Ü where A1¬àeffective area of a the valve ‚Äôsc h a m b e r , Kq¬àrate of change of the load Ô¨Çow rate with a change in displacement, and œâh¬àthe natural fre- quency of the hydraulic system. Find the state-space representation of the system , where the state variables are the phase variables associated with the piston. 30.Figure P3.17 shows a free-body diagram of aninverted pendulum, mounted on a cart with a mass,M. The pendulum has a point mass, m, concentrated at the upper end of a rod with zero mass, a length, l,a n da frictionless hinge. A motor drives the cart, applying ahorizontal force, u(t). A gravity force, mg,a c t so n mat all times. The pendulum angle relative to the y-axis, Œ∏, its angular speed, _Œ∏ ¬¥, the horizontal position of the cart, x,a n di t ss p e e d , x¬¥, were selected to be the state variables. The state-space equations derived wereheavily nonlinear. 14They were then linearized around the stationary point, x0=0andu0=0, and manipulated to yield the following open-loop model written inperturbation form: d dtŒ¥x¬àAŒ¥x¬áBŒ¥u However, since x0=0andu0=0, then let: x¬àx0¬áŒ¥x¬à Œ¥xandu¬àu0¬áŒ¥u¬àŒ¥u. Thus the state equation may be rewritten as ( Prasad ,2012 ): _x¬àAx¬áBu where A¬à01 0 0 M¬ám¬Üg Ml000 00 0 1  mg M0002 666643 77775andB¬à0  1 Ml 0 1 M2 6666643 777775 14As noted in the introduction to Section 3.7, the techniques for solving such nonlinear state equations are beyond the scope of this course.13Li, S., Jarvis, A.J., and Leedal, D.T. Are response function representa- tions of the global carbon cycle ever interpretable? Tellus , vol. 61B, 2009, pp. 361 ‚Äì371. (Fig. 1 p. 363).Problems 151WEBC03 10/28/2014 16:50:16 Assuming the output to be the horizontal position of m¬àxm¬àx¬álsinŒ∏¬àx¬álŒ∏for a small angle, Œ∏, the output equation becomes: y¬àlŒ∏¬áx¬àCx¬àl010/C2/C3Œ∏ _Œ∏ x _x2 66643 7775 Given that: M=2.4 kg, m=0.23 kg, l=0.36 m, g=9.81 m/s2, use MATLAB to Ô¨Ånd the transfer function, G(s)= Y( s)/U(s)=Xm(s)/U(s). lsinŒ∏ lcosŒ∏Œ∏m mg 0xy x u MPl FIGURE P3.17 Motor-driven inverted pendulum cart system15 PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 31.Control of HIV/AIDS. Problem 67 in Chapter 2 introduced a model for HIV infection. If retroviral drugs, RTIsandPIs asdiscussed in Problem22in Chapter1,areused, the model is modi Ô¨Åed as follows ( Craig ,2004 ): dT dt¬às dT  1 u1¬ÜŒ≤Tv dT* dt¬à 1 u1¬ÜŒ≤Tv ŒºT* dv dt¬à 1 u2¬ÜkT* cv where 0 u11, 0u21 represent the effectiveness of the RTI and PI medication, respectively. a.Obtain a state-space representation of the HIV/AIDSmodel by linearizing the equations about the T 0;T* 0;v0¬Ü¬àcŒº Œ≤k;s Œº cd Œ≤k;sk cŒº d Œ≤/C18/C19equilibrium with u10¬àu20¬à0. This equilibrium represents the asymptomatic HIV-infected patient. Note that each one of the above equations is of theform _x i¬àfi xi;u1;u2¬Ü;i¬à1;2;3. b.If Matrices AandBare given by A¬à@f1 @x1@f1 @x2@f1 @x3 @f2 @x1@f2 @x2@f2 @x3 @f3 @x1@f3 @x2@f3 @x32 6666666643 777777775 T0;T* 0;v0; B¬à@f1 @u1@f1 @u2 @f2 @u1@f2 @u2 @f3 @u1@f3 @u22 6666666643 777777775 T0;T* 0;v0 and we are interested in the number of free HIV viruses as the system ‚Äôs output, C¬à001/C2/C3 show that A¬à  d¬áŒ≤v0¬Ü 0 Œ≤T0 Œ≤v0  ŒºŒ≤ T0 0 k  c2 643 75;B¬àŒ≤T0v0 0  Œ≤T0v0 0 0  kT* 02 643 75 c.Typical parameter values and descriptions for the HIV/AIDS model are shown in the following table. Substitute the values from the table into your model and write as _x¬àAx¬áBu y¬àCx Table of HIV/AIDS Model Parameters16 32.Hybrid vehicle. For Problem 23 in Chapter 1 we developed the functional block diagrams for thecruise control of serial, parallel, and split-powertTime days dDeath of uninfected T cells 0.02/day kRate of free viruses produced per infected T cell100 counts/cell sSource term for uninfected T cells 10/mm3/day Œ≤Infectivity rate of free virus particles 2: 410 5/mm3/day cDeath rate of viruses 2.4/day ŒºDeath rate of infected T cells 0.24/day 15Prasad, L., Tyagi, B.,and Gupta, H. Modeling & Simulation for Optimal Control of Nonlinear Inverted Pendulum Dynamical System using PID Controller & LQR. IEEE Computer Society Sixth Asia Modeling Sympo- sium, 2012, pp. 138 ‚Äì143. Figure 1 p. 139. Reproduced with permission of IEEE in the format Republish in a book via Copyright Clearance Center.16Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education Into the Electrical Engineering Curriculum at the University of Pretoria.IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. Table II, p. 67. Modelling Symposium (AMS), 2012 Sixth Asia by IEEE. Reproduced with permission of IEEE in the format Republish in a book via Copyright Clearance Center.152 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:16 hybrid electric vehicles (HEV). Those diagrams showed that the engine or electric motor or bothmay propel the vehicle. When electric motors are thesole providers of the motive force, the forward paths of all HEV topologies are similar. In general, such a forward path can be represented ( Preitl, 2007)b ya block diagram similar to the one of Figure P3.18. Assume the motor to be an armature-controlled dc motor. In this diagram, K Ais the power ampli Ô¨Åer gain; Ge(s) is the transfer function of the motor electric circuit and consists of a series inductor and resistor, LaandRa, respectively; Ktis the motor torque constant; Jtot, is the sum of the motor inertia, Jm, the inertias of the vehicle, Jveh, and the two driven wheels, Jw, both of which are re Ô¨Çected to the motor shaft; kfis the coef Ô¨Åcient of viscous friction; and kbis the back emf constant. The input variables are uc(t), the command voltage from the electronic control unit and Tc(t), the load torque. The output variables in this blockdiagram are the motor angular speed, œâ(t), and its armature current, I a(t).a.Write the basic time-domain equations that charac-terize the relationships between the state, input, andoutput variables for the block diagram of FigureP3.18, given that the state variables are the motor armature current, I a(t), and angular speed, œâ(t). b.Write the resulting state-space equations and then represent them in matrix form. Regard the loadtorque T c(t) as an extra input to the system. Thus, in your resulting state-space representation, the systemwill have two inputs and two outputs. 33.Parabolic trough collector. A transfer function model fromÔ¨ÇuidÔ¨Çow to Ô¨Çuid temperature for a parabolic trough collector was introduced in Problem 69, Chapter 2. A moredetailed model for the response of this system is givenunder speci Ô¨Åc operation conditions ( Camacho, 2012 )b y : H Q s¬Ü¬à137:210 6 s2¬á0:0224 s¬á19610 6e 39s Find an appropriate state-space representation for thesystem.Angular speed, œâ(t)Motive torque, T(t) s Jtot1 +_ _Vehicle dynamics kfLoad torque, Tc(t) kbFrictiontorque, Tf(t)Œîu(t) Ge(s) KAControl command, uc(t) KtArmature current, Ia(t) Ia(t)Amplifier output voltage, ua(t) Back emf, eb(t)_+ FIGURE P3.18 Block diagram representation of an HEV forward path17 Cyber Exploration Laboratory Experiment 3.1 Objectives To learn to use MATLAB to (1) generate an LTI state-space representation of a system and (2) convert an LTI state-space representation of a system to an LTI transfer function. Minimum Required Software Packages MATLAB and the Control System Toolbox17Preitl, Z., Bauer, P., and J. Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. 4th International Symposium on Applied Computational Intelligence and Informatics. IEEE, 2007. Adapted from Figure 2, p. 2Cyber Exploration Laboratory 153WEBC03 10/28/2014 16:50:16 Prelab 1.Derive the state-space representation of the translational mechanical system shown in Skill-Assessment Exercise 3.2 if you have not already done so. Consider the output tobex 3(t). 2.Derive the transfer function,X3 s¬Ü F s¬Ü, from the equations of motion for the translational mechanical system shown in Skill-Assessment Exercise 3.2. Lab 1.Use MATLAB to generate the LTI state-space representation derived in Prelab 1. 2.Use MATLAB to convert the LTI state-space representation found in Lab 1 to the LTItransfer function found in Prelab 2. Postlab 1.Compare your transfer functions as found from Prelab 2 and Lab 2. 2.Discuss the use of MATLAB to create LTI state-space representations and the use of MATLAB to convert these representations to transfer functions. Experiment 3.2 Objectives To learn to use MATLAB and the Symbolic Math Toolbox to (1) Ô¨Ånd a symbolic transfer function from the state-space representation and (2) Ô¨Ånd a state-space representation from the equations of motion. Minimum Required Software Packages MATLAB, the Symbolic Math Toolbox, and the Control System Toolbox Prelab 1.Perform Prelab 1 and Prelab 2 of Experiment 3.1 if you have not already done so. 2.Using the equation T s¬Ü¬àC sI A¬Ü 1BtoÔ¨Ånd a transfer function from a state-space representation, write a MATLAB progr am using the Symbolic Math Toolbox to Ô¨Ånd the symbolic transfer function from the state-s pace representation o f the translational mechanical system shown in Skill-Assess ment Exercise 3.2 and found as a step in Prelab 1. 3.Using the equations of motion of the translational mechanical system shown in Skill-Assessment Exercise 3.2 and found in Prelab 1, write a symbolic MATLABprogram to Ô¨Ånd the transfer function, X3 s¬Ü F s¬Ü, for this system. Lab 1.Run the programs composed in Prelabs 2 and 3 and obtain the symbolic transferfunctions by the two methods. Postlab 1.Compare the symbolic transfer function obtained from T s¬Ü¬àC sI A¬Ü 1Bwith the symbolic transfer function obtained from the equations of motion. 2.Discuss the advantages and disadvantages between the two methods. 3.Describe how you would obtain an LTI state-space representation and an LTI transferfunction from your symbolic transfer function. Experiment 3.3 Objectives To learn to use LabVIEW to (1) generate state-space representations of transfer functions, (2) generate transfer f unctions from state-space representations, and (3) verify that there are mu ltiple state-space representa tions for a transfer function.154 Chapter 3 Modeling in the Time DomainWEBC03 10/28/2014 16:50:16 Bibliography Agee, J. T., and Jimoh, A. A. Flat controller design for hardware-cost reduction in polar-axis photovoltaic systems. Solar Energy , vol. 86, pp. 452 ‚Äì462, 2012. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Carlson, L. E., and Griggs, G. E. Aluminum Catenary System Quarterly Report . Technical Report Contract Number DOT-FR-9154, U.S. Department of Transportation, 1980. Cereijo, M. R. State Variable Formulations. Instruments and Control Systems , December 1969, pp. 87 ‚Äì88. Chiu, D. K., and Lee, S. Design and Experimentation of a Jump Impact Controller. IEEE Control Systems , June 1997, pp. 99 ‚Äì106. Cochin, I. Analysis and Design of Dynamic Systems . Harper & Row, New York, 1980. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no.1, February 2004, pp. 65 ‚Äì73. Elkins, J. A. A Method for Predicting the Dynamic Response of a Pantograph Running at Constant Speed under a Finite Length of Overhead Equipment . Technical Report TN DA36, British Railways, 1976. Fagergren, A., Ekeberg, √ñ., and Forssberg, H. Precision Grip Force Dynamics: A System Identi Ô¨Åcation Approach. IEEE Transactions on Biomedical Engineering , vol. 47, no.10, 2000, pp. 1366 ‚Äì1375.Minimum Required Software Packages LabVIEW, the LabVIEW Control Design and Simulation Module, and the MathScript RT Module. Prelab 1.Study Appendix D, Sections D.1 through D.4, Example D.1. 2.Solve Skill-Assessment Exercise 3.3. 3.Use your solution to Prelab 2 and convert back to the transfer function. Lab 1.Use LabVIEW to convert the transfer function, G s¬Ü¬à2s¬á1 s2¬á7s¬á9, into a state-space representation using both the graphical and MathScript approaches. The front panel will contain controls for the entry of the transfer function and indicators of the transferfunction and the two state-space results. Functions for this experiment can be found inthe following palettes: (1) Control Design and Simulation/Control Design/Model Construction, (2)Control Design and Simulation/Control Design/Model Conversion, and (3) Programming/Structures Hint: Coef Ô¨Åcients are entered in reverse order when using MathScript with MATLAB. 2.Use LabVIEW to convert all state-space representations found in Lab 1 to a transferfunction. All state-space conversions should yield the transfer function given in Lab 1.The front panel will contain controls for entering state-space representations andindicators of the transfer function results as well as the state equations used. Postlab 1.Describe any correlation found between the results of Lab 1 and calculations made in thePrelab. 2.Describe and account for any differences between the results of Lab 1 and calculationsmade in the Prelab. 3.Explain the results of Lab 2 and draw conclusions from the results.Bibliography 155WEBC03 10/28/2014 16:50:17 F r a n k l i n ,G .F . ,P o w e l l ,J .D . ,a n dE m a m i - N a e i n i ,A . Feedback Control of Dynamic Systems . Addison-Wesley, Reading, MA, 1986. Hong, J., Tan, X., Pinette, B., Weiss, R., and Riseman, E. M. Image-Based Homing. IEEE Control Systems , February 1992, pp. 38 ‚Äì45. Inigo, R. M. Observer and Controller Desig n for D.C. Positional Control Systems Using State Variables. Transactions, Analog/Hybrid Computer Educational Society , December 1974, pp. 177 ‚Äì189. Kailath, T. Linear Systems . Prentice Hall, Upper Saddle River, NJ, 1980. Kandel, A. Analog Simulation of Groundwater Mining in Coastal Aquifers. Transactions, Analog/ Hybrid Computer Educational Society , November 1973, pp. 175 ‚Äì183. Kyrylov, V., Severyanova, L. A., and Vieira, A. Modeling Robust Oscillatory Behavior of the Hypothalamic-Pituitary-Adrenal Axis. IEEE Transactions on Biomedical Engineering , vol. 52, no.12, 2005, pp. 1977 ‚Äì1983. Li, S., Jarvis, A.J., and Leedal, D.T., Are Response Function Representations of the Global Carbon Cycle Ever Interpretable? Tellus , vol. 61B, 2009, pp. 361 ‚Äì371. Liceaga-Castro, E., van der Molen, G. M. Submarine H ‚àûDepth Control Under Wave Disturbances. IEEE Transactions on Control Systems Technology , vol. 3, no.3, 1995, pp. 338 ‚Äì346. Lordi, N. G. Analog Computer Generated Lecture Demonstrations in Pharmacokinetics. Transactions, Analog/Hybrid Computer Educational Society , November 1972, pp. 217 ‚Äì222. Philco Technological Center. Servomechanism Fundamentals and Experiments . Prentice Hall, Upper Saddle River, NJ, 1980. Prasad, L., Tyagi, B., and Gupta, H. Modeling & Simulation for Optimal Control of Nonlinear Inverted Pendulum Dynamical System using PID Controller & LQR. IEEE Computer Society Sixth Asia Modeling Symposium, 2012, pp. 138 ‚Äì143. Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Intelligence and Informatics . IEEE . 2007. Qu, S-G., Zhang, Y., Ye, Z., Shao, M., and Xia, W. Modeling and Simulation of the Proportional Valve Control System for the Turbocharger. IEEE , 2010. Riegelman, S. et al. Shortcomings in Pharmacokinetic Analysis by Conceiving the Body to Exhibit Properties of a Single Compartment. Journal of Pharmaceutical Sciences , vol. 57, no.1, 1968, pp. 117 ‚Äì123. Tarin, C., Teufel, E., Pic√≥, J., Bondia, J., and P Ô¨Çeiderer, H. J. Comprehensive Pharmacokinetic Model of Insulin Glargine and Other Insulin Formulations. IEEE Transactions on Biomedical Engineering , vol. 52, no.12, 2005, pp. 1994 ‚Äì2005. Timothy, L. K., and Bona, B. E. State Space Analysis: An Introduction . McGraw-Hill, New York, 1968.156 Chapter 3 Modeling in the Time DomainWEBC04 10/28/2014 16:58:7 Time Response Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅUse poles and zeros of transfer functions to determine the time response of a control system (Sections 4.1 ‚Äì4.2) ¬ÅDescribe quantitatively the transient response of Ô¨Årst-order systems (Section 4.3) ¬ÅWrite the general response of second-order systems given the pole location (Section 4.4) ¬ÅFind the damping ratio and natural frequency of a second-order system (Section 4.5) ¬ÅFind the settling time, peak time, percent overshoot, and rise time for anunderdamped second-orde r system (Section 4.6) ¬ÅApproximate higher-order systems and systems with zeros as Ô¨Årst- or second- order systems (Sections 4.7 ‚Äì4.8) ¬ÅDescribe the effects of nonlinearities on the system time response (Section 4.9) ¬ÅFind the time response from the state-space representation (Sections 4.10 ‚Äì4.11) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with casestudies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to (1) predict, by inspection, the form of theopen-loop angular velocity response of the load to a step voltage input to4 157WEBC04 10/28/2014 16:58:7 the power ampli Ô¨Åer; (2) describe quantitatively the transient response of the open-loop system; (3) derive the expression for the open-loop angular velocity output for a step voltage input; (4) obtain the open-loopstate-space representation; (5) plot the open-loop velocity step responseusing a computer simulation. ¬ÅGiven the block diagram for the Unmanned Free-Swimming Submersible (UFSS) vehicle ‚Äôs pitch control system shown on the back endpapers, you will be able to predict, Ô¨Ånd, and plot the response of the vehicle dynamics to a step input command. Further, you will be able to evaluate the effect of system zeros and higher-order poles on the response. You also will be able to evaluate the rollresponse of a ship at sea. 4.1 Introduction In Chapter 2, we saw how transfer functions can represent linear, time-invariant systems.In Chapter 3, systems were represented directly in the time domain via the state and output equations. After the engineer obtains a mathematical representation of a subsystem, the subsystem is analyzed for its transient and steady-state responses to see if thesecharacteristics yield the desired behavior. This chapter is devoted to the analysis of systemtransient response. It may appear more logical to continue with Chapter 5, which covers the modeling of closed-loop systems, rather than to break the modeling sequence with the analysispresented here in Chapter 4. However, the student should not continue too far into systemrepresentation without knowing the applicatio n for the effort expended. Thus, this chapter demonstrates applications of the system rep r e s e n t a t i o nb ye v a l u a t i n gt h et r a n s i e n t response from the system model. Logically, this approach is not far from reality, sincethe engineer may indeed want to evaluate the res ponse of a subsystem prior to inserting it into the closed-loop system. After describing a valuable analysis and design tool, poles and zeros, we begin analyzing our models to Ô¨Ånd the step response of Ô¨Årst- and second-order systems. The order refers to the order of the equivalent differential equation representing the system ‚Äîthe order of the denominator of the transfer function after cancellation of common factors in the numerator or the number of simultaneous Ô¨Årst-order equations required for the state-space representation. 4.2 Poles, Zeros, and System Response The output response of a system is the sum of two responses: the forced response and the natural response .1Although many techniques, such as solving a differential equation or taking the inverse Laplace transform, enable us to evaluate this output response, these techniques are laborious and time-consuming. Productivity is aided by analysis and design techniques that yield results in a minimum of time. If the technique is so rapid that we feel we derive the desired result by inspection, we sometimes use the attribute qualitative to describe the method. The use of poles and zeros and their relationship to the time response ofa system is such a technique. Learning this relationship gives us a qualitative ‚Äúhandle ‚Äùon problems. The concept of poles and zeros, fundamental to the analysis and design of control 1The forced response is also called the steady-state response orparticular solution . The natural response is also called the homogeneous solution .158 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:7 systems, simpli Ô¨Åes the evaluation of a system‚Äô s response. The reader is encouraged to master the concepts of poles and zeros and their application to problems throughout this book. Let us begin with two de Ô¨Ånitions. Poles of a Transfer Function The poles of a transfer function are (1) the values of the Laplace transform variable, s,that cause the transfer function to become in Ô¨Ånite or (2) any roots of the denominator of the transfer function that are common to roots of the numerator. Strictly speaking, the poles of a transfer function satisfy part (1) of the de Ô¨Ånition. For example, the roots of the characteristic polynomial in the denominator are values of sthat make the transfer function inÔ¨Å nite, so they are thus poles. However, if a factor of the denominator can be canceled by the same factor in the numerator, the root of thisfactor no longer causes the transfer function to become in Ô¨Ånite. In control systems, we often refer to the root of the canceled factor in the denominator as a pole even thoughthe transfer function will not be inÔ¨Å nite at this value. Hence, we include part (2) of the deÔ¨Ånition. Zeros of a Transfer Function The zeros of a transfer function are (1) the values of the Laplace transform variable, s, that cause the transfer function to become zero, or (2) any roots of the numerator of the transferfunction that are common to roots of the denominator. Strictly speaking, the zeros of a transfer function satisfy part (1) of this de Ô¨Ånition. For example, the roots of the numerator are values of sthat make the transfer function zero and are thus zeros. However, if a factor of the numerator can be canceled by the same factor inthe denominator, the root of this factor no longer causes the transfer function to becomezero. In control systems, we often refer to the root of the canceled factor in the numerator asa zero even though the transfer function will not be zero at this value. Hence, we include part(2) of the de Ô¨Ånition. Poles and Zeros of a First-Order System: An Example Given the transfer function G(s) in Figure 4.1( a), a pole exists at s¬à 5, and a zero exists at  2. These values are plotted on the complex s-plane in Figure 4.1( b), using an √ófor the pole and a‚óãfor the zero. To show the properties of the poles and zeros, let us Ô¨Ånd the unit step response of the system. Multiplying the transfer function of Figure 4.1( a) by a step function yields C s¬Ü¬à s¬á2¬Ü s s¬á5¬Ü¬àA s¬áB s¬á5¬à2=5 s¬á3=5 s¬á5 4.1¬Ü where A¬à s¬á2¬Ü s¬á5¬Ü/C12/C12/C12/C12 s¬Æ0¬à2 5 B¬à s¬á2¬Ü s/C12/C12/C12/C12 s¬Æ 5¬à3 5 Thus, c t¬Ü¬à2 5¬á35e  5t 4.2¬Ü4.2 Poles, Zeros, and System Response 159WEBC04 10/28/2014 16:58:7 From the development summarized in Figure 4.1(c ), we draw the following conclusions: 1.A pole of the input function generates the form of the forced response (that is, the pole at the origin generated a step function at the output). 2.A pole of the transfer function generates the form of the natural response (that is, the pole at 5 generated e 5t). 3.A pole on the real axis generates an exponential response of the form e Œ±t, where  Œ±is the pole location on the real axis. Thus, the farther to the left a pole is on the negative real axis, the faster the exponential transient response will decay to zero (again, the pole at  5 generated e 5t; see Figure 4.2 for the general case).G(s) C(s)1 s (b) (a)jœâ s-plane 1 ss + 2 jœâ jœâ jœâInput pole System zero System pole Output transform2/5+3/5 s + 5 2 535e ‚Äì5tOutput time response+ Forced response Natural response (c)‚Äì5R(s) = s + 2 1 s + 5 C(s) = c(t) =s‚Äì2 ‚Äì5s-plane s-plane s-planes + 5‚Äì2 œÉœÉ œÉ œÉ FIGURE 4.1 a.System showing input and output; b.pole-zero plot of the system; c.evolution of a system response. Follow blue arrows to see the evolution of the response component generated by the pole or zero. Pole at ‚ÄìŒ± generates response Ke ‚ÄìŒ±ts-planejœâ ‚ÄìŒ±œÉ FIGURE 4.2 Effect of a real-axis pole upon transient response.160 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:8 4.The zeros and poles generate the amplitudes for both the forced and natural responses (this can be seen from the calculation of AandBin Eq. (4.1)). Let us now look at an example that demonstrates the technique of using poles to obtain the form of the system response. We will learn to write the form of the response by inspection. Each pole of the system transfer function that is on the real axis generates anexponential response that is a component of the natural response. The input pole generatesthe forced response. Example 4.1 Evaluating Response Using PolesEvaluating Response Using Poles PROBLEM: Given the system of Figure 4.3, write the output, c(t), in general terms. Specify the forced and natural parts of the solution. SOLUTION: By inspection, each system pole generates an exponential as part of the natural response. The input ‚Äôs pole generates the forced response. Thus, Cs ¬ÜK1 s Forced response¬áK2 s¬á2¬áK3 s¬á4¬áK4 s¬á5 Natural response 4.3¬Ü Taking the inverse Laplace transform, we get c t¬Ü K1 Forced response¬áK2e 2t¬áK3e 4t¬áK4e 5t Natural response 4.4¬Ü(s + 2)(s + 4)(s + 5)C(s)1 sR(s) = (s + 3) FIGURE 4.3 System for Example 4.1 Skill-Assessment Exercise 4.1 PROBLEM: A system has a transfer function, G s¬Ü¬à10 s¬á4¬Ü s¬á6¬Ü s¬á1¬Ü s¬á7¬Ü s¬á8¬Ü s¬á10¬Ü. Write, by inspection, the output, c(t), in general terms if the input is a unit step. ANSWER: c t¬ÜA¬áBe t¬áCe 7t¬áDe 8t¬áEe 10t In this section, we learned that poles determine the nature of the time response: Poles of the input function determine the form of the forced response, and poles of the transfer function determine the form of the natural response. Zeros and polesof the input or transfer function contribute to the amplitudes of the componentparts of the total response. Finally, poles on the real axis generate exponentialresponses.4.2 Poles, Zeros, and System Response 161WEBC04 10/28/2014 16:58:8 4.3 First-Order Systems We now discuss Ô¨Årst-order systems without zeros to de Ô¨Åne a performance speciÔ¨Åcation for such a system. A Ô¨Årst-order system without zeros can be described by the transfer function shown in Figure 4.4(a ). If the input is a unit step, where R s¬Ü¬à1=s, the Laplace transform of the step response is C(s), where C s¬Ü¬àR s¬ÜG s¬Ü¬àa s s¬áa¬Ü 4.5¬Ü Taking the inverse transform, the step response is given by c t¬Ü¬àcf t¬Ü¬ácn t¬Ü¬à1 e at 4.6¬Ü where the input pole at the origin generated the forced response cf t¬Ü¬à1, and the system pole at  a, as shown in Figure 4.4( b), generated the natural response cn t¬Ü¬à  e at. Equation (4.6) is plotted in Figure 4.5. Let us examine the signi Ô¨Åcance of parameter a, the only parameter needed to describe the transient response. When t¬à1=a, e atjt¬à1=a¬àe 1¬à0:37 4.7¬Ü or c t¬Üjt¬à1=a¬à1 e atjt¬à1=a¬à1 0:37¬à0:63 4.8¬Ü We now use Eqs. (4.6), (4.7), and (4.8) to de Ô¨Åne three transient response performance speciÔ¨Åcations. Time Constant We call 1/ athetime constant of the response. From Eq. (4.7), the time constant can be described as the time for e atto decay to 37% of its initial value. Alternately, from Eq. (4.8) the time constant is the time it takes for the step response to rise to 63% of its Ô¨Ånal value (see Figure 4.5).a R(s) (a)jœâ ‚Äìa (b)s + aG(s) C(s)s-plane œÉ FIGURE 4.4 a.First-order system; b.pole plot Virtual Experiment 4.1 First-Order Transfer Function Put theory into practice and Ô¨Ånd aÔ¨Årst-order transfer function representing the Quanser Rotary Servo. Then validate the model by simulating it in LabVIEW. Such a servo motoris used in mechatronic gadgetssuch as cameras. Virtual experiments are foundon Learning Space. t1.0 0.90.80.70.60.50.40.30.20.1 0 TsTra1 a2 a3 a4 a5Initial slope =c(t) 1 time constant 63% of final value at t = one time constant= a FIGURE 4.5 First-order system response to a unit step162 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:9 The reciprocal of the time constant has the units (1/seconds), or frequency. Thus, we can call the parameter atheexponential frequency . Since the derivative of e atis awhen t¬à0,ais the initial rate of change of the exponential at t¬à0. Thus, the time constant can be considered a transient response speci Ô¨Åcation for a Ô¨Årst-order system, since it is related to the speed at which the system responds to a step input. The time constant can also be evaluated from the pole plot (see Figure 4.4( b)). Since the pole of the transfer function is at  a, we can say the pole is located at the reciprocal of the time constant, and the farther the pole from the imaginary axis, the faster the transient response. Let us look at other transient response speci Ô¨Åcations, such as rise time, Tr, and settling time, Ts, as shown in Figure 4.5. Rise Time, Tr Rise time is deÔ¨Åned as the time for the waveform to go from 0.1 to 0.9 of its Ô¨Ånal value. Rise time is found by solving Eq. (4.6) for the difference in time at c t¬Ü¬à0:9 and c t¬Ü¬à0:1. Hence, Tr¬à2:31 a 0:11 a¬à2:2 a 4.9¬Ü Settling Time, Ts Settling time is deÔ¨Åned as the time for the response to reach, and stay within, 2% of its Ô¨Ånal value.2Letting c t¬Ü¬à0:98 in Eq. (4.6) and solving for time, t,weÔ¨Ånd the settling time to be Ts¬à4 a 4.10¬Ü First-Order Transfer Functions via Testing Often it is not possible or practical to obtain a system ‚Äôs transfer function analytically. Perhaps the system is closed, and the component parts are not easily identi Ô¨Åable. Since the transfer function is a representation of the system from input to output, the system‚Äô s step response can lead to a representation even though the inner construction is not known. With a step input, we can measure the time constant and the steady-state value, from which thetransfer function can be calculated. Consider a simple Ô¨Årst-order system, G s¬Ü¬àK= s¬áa¬Ü, whose step response is C s¬Ü¬àK s s¬áa¬Ü¬àK=a s K=a s¬áa¬Ü 4.11¬Ü If we can identify Kandafrom laboratory testing, we can obtain the transfer function of the system. For example, assume the unit step response given in Figure 4.6. We determine that it has the Ô¨Årst-order characteristics we have seen thus far, such as no overshoot and nonzero initial slope. From the response, we measure the time constant, that is, the time for the amplitude to reach 63% of its Ô¨Ånal value. Since the Ô¨Ånal value is about 0.72, the time constant is evaluated where the curve reaches 0 :630:72¬à0:45, or about 0.13 second. Hence, a¬à1=0:13¬à7:7. 2Strictly speaking, this is the de Ô¨Ånition of the 2% setting time . Other percentages, for example 5%, also can be used. We will use settling time throughout the book to mean 2% settling time.4.3 First-Order Systems 163WEBC04 10/28/2014 16:58:9 ToÔ¨Ånd K, we realize from Eq. (4.11) that the forced response reaches a steady-state value of K=a¬à0:72. Substituting the value of a,weÔ¨Ånd K¬à5:54. Thus, the transfer function for the system is G s¬Ü¬à5:54= s¬á7:7¬Ü. It is interesting to note that the response of Figure 4.6 was generated using the transfer function G s¬Ü¬à5= s¬á7¬Ü. 4.4 Second-Order Systems: Introduction Let us now extend the concepts of poles and zeros and transient response to second-order systems. Compared to the simplicity of a Ô¨Årst-order system, a second-order system exhibits a wide range of responses that must be analyzed and described. Whereas varying aÔ¨Årst-order system ‚Äôs parameter simply changes the speed of the response, changes in the parameters of a second-order system can change the form of the response. For example, a second-order system can display characteristics much like a Ô¨Årst-order system, or, depending on component values, display damped or pure oscillations for its transient response. To become familiar with the wide range of responses before formalizing our discussion in the next section, we take a look at numerical examples of the second-ordersystem responses shown in Figure 4.7. All examples are derived from Figure 4.7( a), the general case, which has two Ô¨Ånite poles and no zeros. The term in the numerator is simply a scale or input multiplying factor that can take on any value without affecting the form of the derived results. By assigning appropriate values to parameters aand b,we can show all possible second-order transient responses. The unit step response then can be found using0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.80.10.20.30.40.50.60.70.8 Time (seconds)Amplitude FIGURE 4.6 Laboratory results of a system step response test Skill-Assessment Exercise 4.2 PROBLEM: A system has a transfer function, G s¬Ü¬à50 s¬á50. Find the time constant, Tc, settling time, Ts, and rise time, Tr. ANSWER: Tc¬à0:02 s;Ts¬à0:08 s;andTr¬à0:044 s : The complete solution is located at www.wiley.com/college/nise .164 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:10 C s¬Ü¬àR s¬ÜG s¬Ü, where R s¬Ü¬à1=s, followed by a partial-fraction expansion and the inverse Laplace transform. Details are left as an end-of-chapter problem, for which you may want to review Section 2.2. We now explain each response and show how we can use the poles to determine the nature of the response without going through the procedure of a partial-fraction expansion followed by the inverse Laplace transform. Overdamped Response, Figure 4.7( b) For this response, C s¬Ü¬à9 s s2¬á9s¬á9¬Ü¬à9 s s¬á7:854¬Ü s¬á1:146¬Ü 4.12¬Ü This function has a pole at the origin that comes from the unit step input and two real poles that come from the system. The input pole at the origin generates the constant forcedresponse; each of the two system poles on the real axis generates an exponential naturalresponse whose exponential frequency is equal to the pole location. Hence, the output initially could have been written as c t¬Ü¬àK 1¬áK2e 7:854t¬áK3e 1:146t. This response,b s2 + as + b 12345t0.51.0c(t) c(t) = 1 + 0.171e‚Äì7.854t ‚Äì 9G(s) C(s)GeneralSystem (a) (b) (c) (d) (e)OverdampedPole-zero plot G(s) ‚Äì7.854 ‚Äì1.146 00.81.2c(t) = 1‚Äìe‚Äìt(cos 8t + sin 8t) 9G(s) C(s) Underdamped s-plane ‚Äì10.4=1‚Äì1.06e‚Äìt cos( 8t ‚Äì19.47¬∞) 12345t012c(t) c(t) = 1 ‚Äì cos 3t 9G(s) C(s) Undampedj3 12345t01.0c(t) c(t) = 1 ‚Äì 3te‚Äì3t ‚Äì e‚Äì3t 9G(s) C(s) Critically damped‚Äì30.8 0.6 0.4 0.2Response jœâ jœâ jœâ s-plane s-plane s-planes2 + 9s + 9 s2 + 2s + 9 s2 + 9 s2 + 6s + 9jœâ ‚Äìj3c(t)C(s) 8 8 0.21.01.4 0.6R(s) =1 s R(s) =1 s R(s) =1 s R(s) =1 s R(s) =1 s 8 8 12345tj j01.171e‚Äì1.146t ‚ÄìœÉ œÉ œÉ œÉ FIGURE 4.7 Second-order systems, pole plots, and step responses4.4 Second-Order Systems: Introduction 165WEBC04 10/28/2014 16:58:10 shown in Figure 4.7( b), is called overdamped .3We see that the poles tell us the form of the response without the tedious calculation of the inverse Laplace transform. Underdamped Response, Figure 4.7 ( c) For this response, C s¬Ü¬à9 s s2¬á2s¬á9¬Ü 4.13¬Ü This function has a pole at the origin that comes from the unit step input and two complex poles that come from the system. We now compare the response of the second-order system to thepoles that generated it. First we will compare the pole location to the time function, and then we will compare the pole location to the plot. From Figure 4.7( c), the poles that generate the natural response are at s¬à 1jÔ¨ÉÔ¨ÉÔ¨É 8p . Comparing these values to c(t) in the same Ô¨Ågure, we see that the real part of the pole matches the exponential decay frequency of the sinusoid ‚Äôs amplitude, while the imaginary part of the pole matches the frequency of the sinusoidal oscillation. Let us now compare the pole location to the plot. Figure 4.8 shows a general, damped sinusoidal response for a second-order system. The transient response consists of an exponentially decayingamplitudegeneratedbytherealpartofthesystempoletimesasinusoidal waveform generated by the imaginary part of the system pole. The time constant of the exponential decay is equal to the reciprocal of the realpart of the system pole. The value of the imaginary part is the actualfrequency of the sinusoid, as depicted in Figure 4.8. This sinusoidalfrequency is given the name damped frequency of oscillation ,œâ d. Finally, the steady-state response (unit step) was generated by theinput pole located at the origin. We call the type of response shown inFigure 4.8 an underdamped response, one which approaches a steady- state value via a transient response that is a damped oscillation. The following example demonstrates how a knowledge of the relationship between the pole location and the transient responsecan lead rapidly to the response form without calculating the inverseLaplace transform.c(t) Exponential decay generated by real part of complex pole pair Sinusoidal oscillation generated by imaginary part of complex pole pair t FIGURE 4.8 Second-order step response components generated by complex poles Example 4.2 Form of Underdamped Response Using PolesForm of Underdamped Response Using Poles PROBLEM: By inspection, write the form of the step response of the system in Figure 4.9. SOLUTION: First we determine that the form of the forced response is a step. Next we Ô¨Ånd the form of the natural response. Factoring the denominator of the transfer function in Figure 4.9, we Ô¨Ånd the poles to be s¬à 5j13:23. The real part,  5, is the exponential frequency for the damping. It is also the reciprocal of the time constant of the decay of the oscillations. The imaginary part, 13.23, is the radian frequency for the sinusoidal oscillations. Using our previous discussion and Figure 4.7( c) as a guide, we obtain c t¬Ü¬àK1¬áe 5t K2cos 13 :23t¬áK3sin 13 :23t¬Ü¬à K1¬áK4e 5t cos 13 :23t œï¬Ü,w h e r e œï¬àtan 1K3=K2;K4¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É K2 2¬áK23p ,a n d c(t)i sa constant plus an exponentially damped sinusoid.200C(s) s2 + 10s + 2001 sR(s) = FIGURE 4.9 System for Example 4.2 3So named because overdamped refers to a large amount of energy absorption in the system, which inhibits the transient response from overshooting and oscillating about the steady-state value for a step input. As the energy absorption is reduced, an overdamped system will become underdamped and exhibit overshoot.166 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:11 We will revisit the second-order underdamped response in Sections 4.5 and 4.6, where we generalize the discussion and derive some results that relate the pole position to other parameters of the response. Undamped Response, Figure 4.7( d) For this response, C s¬Ü¬à9 s s2¬á9¬Ü 4.14¬Ü This function has a pole at the origin that comes from the unit step input and two imaginarypoles that come from the system. The input pole at the origin generates the constant forcedresponse, and the two system poles on the imaginary axis at j3 generate a sinusoidal natural response whose frequency is equal to the location of the imaginary poles. Hence, the output can be estimated as c t¬Ü¬àK 1¬áK4cos 3t œï¬Ü. This type of response, shown in Figure 4.7( d), is called undamped . Note that the absence of a real part in the pole pair corresponds to an exponential that does not decay. Mathematically, the exponential is e 0t¬à1. Critically Damped Response, Figure 4.7 ( e) For this response, C s¬Ü¬à9 s s2¬á6s¬á9¬Ü¬à9 s s¬á3¬Ü2 4.15¬Ü This function has a pole at the origin that comes from the unit step input and two multiplereal poles that come from the system. The input pole at the origin generates the constantforced response, and the two poles on the real axis at  3 generate a natural response consisting of an exponential and an exponential multiplied by time, where the exponentialfrequency is equal to the location of the real poles. Hence, the output can be estimated asc t¬Ü¬àK 1¬áK2e 3t¬áK3te 3t. This type of response, shown in Figure 4.7( e), is called critically damped . Critically damped responses are the fastest possible without the over- shoot that is characteristic of the underdamped response. We now summarize our observations. In this section we de Ô¨Åned the following natural responses and found their characteristics: 1.Overdamped responses Poles: Two real at  œÉ1; œÉ2 Natural response: Two exponentials with time constants equal to the reciprocal of the pole locations, or c t¬Ü¬àK1e œÉ1t¬áK2e œÉ2t 2.Underdamped responses Poles: Two complex at  œÉdjœâd Natural response: Damped sinusoid with an exponential envelope whose time constant is equal to the reciprocal of the pole ‚Äôs real part. The radian frequency of the sinusoid, the damped frequency of oscillation, is equal to the imaginary part of the poles, or c t¬Ü¬àAe œÉdtcos œâdt œï¬Ü4.4 Second-Order Systems: Introduction 167WEBC04 10/28/2014 16:58:12 3.Undamped responses Poles: Two imaginary at jœâ1 Natural response: Undamped sinusoid with radian frequency equal to the imaginary part of the poles, or c t¬Ü¬àA cos œâ1t œï¬Ü 4.Critically damped responses Poles: Two real at  œÉ1 Natural response: One term is an exponential whose time constant is equal to the reciprocal of the pole location. Another term is the product of time, t, and an exponential with time constant equal to the reciprocal of the pole location, or c t¬Ü¬àK1e œÉ1t¬áK2te œÉ1t The step responses for the four cases of damping discussed in this section are superimposed in Figure 4.10. Notice that the critically damped case is the division betweenthe overdamped cases and the underdamped cases and is the fastest response without overshoot.0.5 1 1.5 2 2.5 3 3.5 4 00.20.40.60.81.01.21.41.61.82.0 Under- damped Critically damped Overdampedc(t) tUndamped FIGURE 4.10 Step responses for second-order system damping cases Skill-Assessment Exercise 4.3 PROBLEM: For each of the following transfer functions, write, by inspection, the general form of the step response: a.G s¬Ü¬à400 s2¬á12s¬á400 b.G s¬Ü¬à900 s2¬á90s¬á900 c.G s¬Ü¬à225 s2¬á30s¬á225 d.G s¬Ü¬à625 s2¬á625168 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:12 In the next section, we will formalize and generalize our discussion of second- order responses and deÔ¨Å ne two speci Ô¨Åcations used for the analysis and design of second-order systems. In Section 4.6, we will focus on the underdamped case and derive some speci Ô¨Åcations unique to this response that we will use later for analysis and design. 4.5 The General Second-Order System Now that we have become familiar with second-order systems and their responses, we generalize the discussion and establish quantitative speci Ô¨Åcations de Ô¨Åned in such a way that the response of a second-order system can be described to a designer without the need forsketching the response. In this section, we de Ô¨Åne two physically meaningful speci Ô¨Åcations for second-order systems. These quantities can be used to describe the characteristics of thesecond-order transient response just as time constants describe the Ô¨Årst-order system response. The two quantities are called natural frequency and damping ratio. Let usformally de Ô¨Åne them. Natural Frequency, œân Thenatural frequency of a second-order system is the frequency of oscillation of the system without damping. For example, the frequency of oscillation of a series RLC circuit with the resistance shorted would be the natural frequency. Damping Ratio, Œ∂ Before we state our next de Ô¨Ånition, some explanation is i n order. We have already seen that a second-order system ‚Äôs underdamped step response is characterized by damped oscillations. Our de Ô¨Ånition is derived from the need to quantitatively describe this damped oscillation regardless of the time s cale. Thus, a system whose transient response goes through three cycles in a millisecond before reaching the steady statewould have the same measure as a system that went through three cycles in amillennium before rea ching the steady state. For example, the underdamped curve in Figure 4.10 has an associated measure that de Ô¨Ånes its shape. This measure remains the same even if we change the time base from seconds to microseconds orto millennia. Av i a b l ed e Ô¨Ånition for this quantity is one that compares the exponential decay frequency of the envelope to the natural frequency. This ratio is constant regardless of thetime scale of the response. Also, the recipr ocal, which is proportional to the ratio of the natural period to the exponential time constant, remains the same regardless of thetime base.ANSWERS: a.c t¬Ü¬àA¬áBe 6tcos 19:08t¬áœï¬Ü b.c t¬Ü¬àA¬áBe 78:54t¬áCe 11:46t c.c t¬Ü¬àA¬áBe 15t¬áCte 15t d.c t¬Ü¬àA¬áBcos 25t¬áœï¬Ü The complete solution is located at www.wiley.com/college/nise .4.5 The General Second-Order System 169WEBC04 10/28/2014 16:58:12 We de Ô¨Åne the damping ratio, Œ∂,t ob e Œ∂¬àExponential decay frequency Natural frequency rad=second ¬Ü¬à1 2œÄNatural period seconds ¬Ü Exponential time constant Let us now revise our description of the second-order system to re Ô¨Çect the new deÔ¨Ånitions. The general second-order system shown in Figure 4.7( a) can be transformed to show the quantities Œ∂andœân. Consider the general system G s¬Ü¬àb s2¬áas¬áb 4.16¬Ü Without damping, the poles would be on the jœâ-axis, and the response would be an undamped sinusoid. For the poles to be purely imaginary, a¬à0. Hence, G s¬Ü¬àb s2¬áb 4.17¬Ü By de Ô¨Ånition, the natural frequency, œân, is the frequency of oscillation of this system. Since the poles of this system are on the jœâ-axis at jÔ¨ÉÔ¨ÉÔ¨É bp , œân¬àÔ¨ÉÔ¨ÉÔ¨É bp 4.18¬Ü Hence, b¬àœâ2 n 4.19¬Ü Now what is the term ain Eq. (4.16)? Assuming an underdamped system, the complex poles have a real part, œÉ, equal to  a=2. The magnitude of this value is then the exponential decay frequency described in Section 4.4. Hence, Œ∂¬àExponential decay frequency Natural frequency rad=second ¬Ü¬àjœÉj œân¬àa=2 œân 4.20¬Ü from which a¬à2Œ∂œân 4.21¬Ü Our general second-order transfer function Ô¨Ånally looks like this: G s¬Ü¬àœâ2 n s2¬á2Œ∂œâns¬áœâ2 n 4.22¬Ü In the following example we Ô¨Ånd numerical values for Œ∂andœânby matching the transfer function to Eq. (4.22).170 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:13 Now that we have de Ô¨Åned Œ∂andœân, let us relate these quantities to the pole location. Solving for the poles of the transfer function in Eq. (4.22) yields s1;2¬à Œ∂œânœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Œ∂2 1q 4.24¬Ü From Eq. (4.24) we see that the various cases of second-order response are a function of Œ∂; they are summarized in Figure 4.11.4Example 4.3 Finding Œ∂andœânFor a Second-Order System Finding Œ∂andœânFor a Second-Order System PROBLEM: Given the transfer function of Eq. (4.23), Ô¨ÅndŒ∂andœân. G s¬Ü¬à36 s2¬á4:2s¬á36 4.23¬Ü SOLUTION: Comparing Eq. (4.23) to (4.22), œâ2 n¬à36, from which œân¬à6. Also, 2Œ∂œân¬à4:2. Substituting the value of œân;Œ∂¬à0:35. Poles Step response FIGURE 4.11 Second-order response as a function of damping ratio 4The student should verify Figure 4.11 as an exercise.4.5 The General Second-Order System 171WEBC04 10/28/2014 16:58:14 In the following example we Ô¨Ånd the numerical value of Œ∂and determine the nature of the transient response. This section de Ô¨Åned two speci Ô¨Åcations, or parameters, of second-order systems: natural frequency, œân, and damping ratio, Œ∂. We saw that the nature of the response obtained was related to the value of Œ∂. Variations of damping ratio alone yield the complete range of overdamped, critically damped, underdamped, and undamped responses.Skill-Assessment Exercise 4.4 PROBLEM: For each of the transfer functions in Skill-Assessment Exercise 4.3, do the following: (1) Find the values of Œ∂andœân; (2) characterize the nature of the response. ANSWERS: a.Œ∂¬à0:3;œân¬à20; system is underdamped b.Œ∂¬à1:5;œân¬à30; system is overdamped c.Œ∂¬à1;œân¬à15; system is critically damped d.Œ∂¬à0;œân¬à25; system is undamped The complete solution is located at www.wiley.com/college/nise .Example 4.4 Characterizing Response from the Value of Œ∂ Characterizing Response from the Value of Œ∂ PROBLEM: For each of the systems shown in Figure 4.12, Ô¨Ånd the value of Œ∂and report the kind of response expected. SOLUTION: First match the form of these systems to the forms shown in Eqs. (4.16) and (4.22). Since a¬à2Œ∂œânandœân¬àÔ¨ÉÔ¨ÉÔ¨É bp , Œ∂¬àa 2Ô¨ÉÔ¨ÉÔ¨Ébp 4.25¬Ü Using the values of aandbfrom each of the systems of Figure 4.12, we Ô¨Ånd Œ∂¬à1:155 for system ( a), which is thus overdamped, since Œ∂>1;Œ∂¬à1 for system ( b), which is thus critically damped; and Œ∂¬à0:894 for system ( c), which is thus underdamped, since Œ∂<1.12 (a)16 (b) 20 C(s) (c)s2 + 8s + 12C(s) C(s) R(s)R(s) R(s) s2 + 8s + 16 s2 + 8s + 20 FIGURE 4.12 Systems for Example 4.4172 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:14 4.6 Underdamped Second-Order Systems Now that we have generalized the second-order transfer function in terms of Œ∂andœân, let us analyze the step response of an underdamped second-order system. Not only will this response be found in terms of Œ∂and œân, but more speci Ô¨Åcations indigenous to the underdamped case will be de Ô¨Åned. The underdamped second-order system, a common model for physical problems, displays unique behavior that must be itemized; a detailed description of the underdamped response is necessary for both analysis and design. Our Ô¨Årst objective is to de Ô¨Åne transient speci Ô¨Åcations associated with underdamped responses. Next we relate these speci Ô¨Åcations to the pole location, drawing an association between pole location and the form of the underdamped second-order response. Finally, we tie the polelocation to system parameters, thus closing the loop: Desired response generates requiredsystem components. Let us begin by Ô¨Ånding the step response for the general second-order system of Eq. (4.22). The transform of the response, C(s), is the transform of the input times the transfer function, or C s¬Ü¬à œâ2 n s s2¬á2Œ∂œâns¬áœâ2 n¬Ü¬àK1 s¬áK2s¬áK3 s2¬á2Œ∂œâns¬áœâ2n 4.26¬Ü where it is assumed that Œ∂<1 (the underdamped case). Expanding by partial fractions, using the methods described in Section 2.2, Case 3, yields C s¬Ü¬à1 s  s¬áŒ∂œân¬Ü¬áŒ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2q s¬áŒ∂œân¬Ü2¬áœâ2 n 1 Œ∂2¬Ü 4.27¬Ü Taking the inverse Laplace transform, which is left as an exercise for the student, produces c t¬Ü¬à1 e Œ∂œântcosœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p t¬áŒ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É1 Œ∂2p sinœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2q t ! ¬à1 1Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p e Œ∂œântcos œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2q t œï¬Ü 4.28¬Ü where œï¬àtan 1 Œ∂=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬Ü. A plot of this response appears in Figure 4.13 for various values of Œ∂, plotted along a time axis normalized to the natural frequency. We now see the relationship between the value of Œ∂and the type of response obtained: The lower the value of Œ∂, the more oscillatory the response. The natural frequency is a time-axis scale factor and does not affect the natureof the response other than to scale it in time. We have de Ô¨Åned two parameters associated with second-order systems, Œ∂andœâ n. Other parameters associated with the underdamped response are rise time, peak time,percent overshoot, and settling time. These speci Ô¨Åcations are de Ô¨Åned as follows (see also Figure 4.14): 1.Rise time ,T r. The time required for the waveform to go from 0.1 of the Ô¨Ånal value to 0.9 of the Ô¨Ånal value. 2.Peak time ,TP. The time required to reach the Ô¨Årst, or maximum, peak.4.6 Underdamped Second-Order Systems 173WEBC04 10/28/2014 16:58:14 3.Percent overshoot, %OS . The amount that the waveform overshoots the steady-state, or Ô¨Ånal, value at the peak time, expressed as a percentage of the steady-state value. 4.Settling time ,Ts. The time required for the transient ‚Äôs damped oscillations to reach and stay within 2%of the steady-state value. Notice that the de Ô¨Ånitions for settling time and rise time are basically the same as the deÔ¨Ånitions for the Ô¨Årst-order response. All de Ô¨Ånitions are also valid for systems of order higher than 2, although analytical expressions for these parameters cannot be found unless the response of the higher-order system can be approximated as a second-order system, which we do in Sections 4.7 and 4.8. Rise time, peak time, and settling time yield information about the speed of the transient response. This information can help a designer determine if the speed and the nature of the response do or do not degrade the performance of the system. Forexample, the speed of an entire computer system depends on the time it takes for a harddrive head to reach steady state and read data; passenger comfort depends in part on the1 2 3 4 5 6 7 8 9 1 01 11 21 31 41 51 61 70.20.40.60.81.01.21.41.61.8c(œânt) ntŒ∂ = .1 0.2 .4 .5 .6 .8 œâ FIGURE 4.13 Second-order underdamped responses for damping ratio values Tr Tp Tst0.1c final0.9c final0.98c finalcfinal1.02c finalcmaxc(t) FIGURE 4.14 Second-order underdamped response speci Ô¨Åcations174 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:15 suspension system of a car and the number o f oscillations it goes through after hitting a bump. We now evaluate Tp,%OS , and Tsas functions of Œ∂andœân. Later in this chapter we relate these speci Ô¨Åcations to the location of the system poles. A precise analytical expression for rise time cannot be obtained; thus, we present a plot and a table showing the relationship between Œ∂and rise time. Evaluation of Tp Tpis found by differentiating c(t) in Eq. (4.28) and Ô¨Ånding the Ô¨Årst zero crossing after t¬à0. This task is simpli Ô¨Åed by ‚Äúdifferentiating ‚Äùin the frequency domain by using Item 7 of Table 2.2. Assuming zero initial conditions and using Eq. (4.26), we get ‚Ñí¬â_c t¬Ü¬ä ¬àsC s¬Ü¬àœâ2 n s2¬á2Œ∂œâns¬áœâ2 n 4.29¬Ü Completing squares in the denominator, we have ‚Ñí¬â_c t¬Ü¬ä ¬àœâ2 n s¬áŒ∂œân¬Ü2¬áœâ2 n 1 Œ∂2¬Ü¬àœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2q s¬áŒ∂œân¬Ü2¬áœâ2 n 1 Œ∂2¬Ü 4.30¬Ü Therefore, _c t¬Ü¬àœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p e Œ∂œântsinœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2q t 4.31¬Ü Setting the derivative equal to zero yields œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2q t¬ànœÄ 4.32¬Ü or t¬ànœÄ œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p 4.33¬Ü Each value of nyields the time for local maxima or minima. Letting n¬à0 yields t¬à0, the Ô¨Årst point on the curve in Figure 4.14 that has zero slope. The Ô¨Årst peak, which occurs at the peak time, Tp, is found by letting n¬à1 in Eq. (4.33): Tp¬àœÄ œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É1 Œ∂2p 4.34¬Ü Evaluation of % OS From Figure 4.14 the percent overshoot, %OS , is given by %OS¬àcmax cfinal cfinal100 4.35¬Ü The term cmaxis found by evaluating c(t) at the peak time, c(Tp). Using Eq. (4.34) for Tpand substituting into Eq. (4.28) yields cmax¬àc Tp¬Ü¬à1 e  Œ∂œÄ=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬ÜcosœÄ¬áŒ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p sinœÄ ! ¬à1¬áe  Œ∂œÄ=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬Ü 4.36¬Ü For the unit step used for Eq. (4.28), cfinal¬à1 4.37¬Ü4.6 Underdamped Second-Order Systems 175WEBC04 10/28/2014 16:58:16 Substituting Eqs. (4.36) and (4.37) into Eq. (4.35), we Ô¨Ånally obtain %OS¬àe  Œ∂œÄ=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬Ü100 4.38¬Ü Notice that the percent overshoot is a function only of the damping ratio, Œ∂. Whereas Eq. (4.38) allows one to Ô¨Ånd%OS given Œ∂, the inverse of the equation allows one to solve for Œ∂given %OS . The inverse is given by Œ∂¬à ln %OS=100¬ÜÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É œÄ2¬áln2 %OS=100¬Üq 4.39¬Ü The derivation of Eq. (4.39) is left as an exercise for the student. Equation (4.38) (or, equivalently, (4.39)) is plotted in Figure 4.15. Evaluation of Ts In order to Ô¨Ånd the settling time, we must Ô¨Ånd the time for which c(t) in Eq. (4.28) reaches and stays within 2%of the steady-state value, cfinal. Using our de Ô¨Ånition, the settling time is the time it takes for the amplitude of the decaying sinusoid in Eq. (4.28) to reach 0.02, or e Œ∂œânt1Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬à0:02 4.40¬Ü T h i se q u a t i o ni sac o n s e r v a t i v ee s t i m a t e ,s i n c ew ea r ea s s u m i n gt h a t cos œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É1 Œ∂2p t œï¬Ü¬à1 at the settling time. Solving Eq. (4.40) for t, the settling time is Ts¬à ln 0:02Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É1 Œ∂2p ¬Ü Œ∂œân 4.41¬Ü You can verify that the numerator of Eq. (4.41) varies from 3.91 to 4.74 as Œ∂varies from 0 to 0.9. Let us agree on an approximation for the settling time that will be used for all values ofŒ∂; let it be Ts¬à4 Œ∂œân 4.42¬Ü Evaluation of Tr A precise analytical relationship between rise time and damping ratio, Œ∂, cannot be found. However, using a computer and Eq. (4.28), the rise time can be found. We Ô¨Årst designate œânt0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0102030405060708090100 Damping ratio, Œ∂Percent overshoot, %OS FIGURE 4.15 Percent overshoot versus damping ratio176 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:17 as the normalized time variable and select a value for Œ∂. Using the computer, we solve for the values of œântthat yield c t¬Ü¬à0:9 and c t¬Ü¬à0:1. Subtracting the two values of œântyields the normalized rise time, œânTr, for that value of Œ∂. Continuing in like fashion with other values of Œ∂, we obtain the results plotted in Figure 4.16.5Let us look at an example. 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 0.11.01.21.41.61.82.02.22.42.62.83.0 Dam ping ratioDamping ratioNormalized rise time 0.1 0.20.30.40.50.60.70.80.91.1041.2031.3211.4631.6381.8542.1262.4672.883Rise time √ó Natural frequency FIGURE 4.16 Normalized rise time versus damping ratio for a second-order underdamped response Example 4.5 Finding Tp,%OS,Ts, and Trfrom a Transfer Function Finding Tp,%OS,Ts, and Trfrom a Transfer Function PROBLEM: Given the transfer function G s¬Ü¬à100 s2¬á15s¬á100 4.43¬Ü Ô¨ÅndTp,%OS ,Ts, and Tr. SOLUTION: œânandŒ∂are calculated as 10 and 0.75, respectively. Now substitute Œ∂andœâninto Eqs. (4.34), (4.38), and (4.42) and Ô¨Ånd, respectively, that Tp¬à0:475 second, %OS¬à2:838, and Ts¬à0:533 second. Using the table in Figure 4.16, the normalized rise time is approximately 2.3 seconds. Dividing by œânyields Tr¬à0:23 second. This problem demonstrates that we can Ô¨ÅndTp,%OS ,Ts,a n dT rwithout the t e d i o u st a s ko ft a k i n ga ni n v e r s eL a p l a c et r a nsform, plotting the output response, and taking measurements from the plot.Virtual Experiment 4.2 Second-Order System Response Put theory into practice studying the effect that natural frequencyand damping ratio have oncontrolling the speed response of the Quanser Linear Servo in LabVIEW. This concept isapplicable to automobile cruisecontrols or speed controls of subways or trucks. Virtual experiments are found on Learning Space. 5Figure 4.16 can be approximated by the following polynomials: œânTr¬à1:76Œ∂3 0:417Œ∂2¬á1:039Œ∂¬á1 (maximum error less than1 2%for 0 <Œ∂<0:9), and Œ∂¬à0:115 œânTr¬Ü3 0:883 œânTr¬Ü2¬á2:504 œânTr¬Ü 1:738 (maximum error less than 5% for 0 :1<Œ∂<0:9). The polynomials were obtained using MATLAB ‚ÄôspolyÔ¨Åtfunction.4.6 Underdamped Second-Order Systems 177WEBC04 10/28/2014 16:58:17 We now have expressions that relate peak time, percent overshoot, and settling time to the natural frequency and the damping ratio. Now let us relate these quantities to the location of the poles that generate thesecharacteristics. The pole plot for a general, underdamped second-order system, previously shown in Figure 4.11, is reproduced and expanded inFigure 4.17 for focus. We see from the Pythagorean theorem that theradial distance from the origin to the pole is the natural frequency, œâ n, and the cos Œ∏¬àŒ∂. Now, comparing Eqs. (4.34) and (4.42) with the pole location, we evaluate peak time and settling time in terms of the pole location. Thus, Tp¬àœÄ œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬àœÄ œâd 4.44¬Ü Ts¬à4 Œ∂œân¬àœÄ œÉd 4.45¬Ü where œâdis the imaginary part of the pole and is called the damped frequency of oscillation ,a n dœÉ dis the magnitude of the real part of the pole and is the exponential damping frequency . Equation (4.44) shows that Tpis inversely proportional to the imaginary part of the pole. Since horizontal lines on the s-plane are lines of consta nt imaginary value, they are also lines of constant peak time. Simila rly, Eq. (4.45) tells us that settling time is inversely proportional to the real part of the pole. Since vertical lines on the s-plane are lines of constant real value, th ey are also lines of constant settling time. Finally, since Œ∂¬àcosŒ∏, radial lines are lines of constant Œ∂. Since percent overshoot is only a function ofŒ∂, radial lines are thus lines of constant percent overshoot, %OS. These concepts a r ed e p i c t e di nF i g u r e4 . 1 8, where lines of constant Tp,Ts,a n d %OS are labeled on the s-plane. At this point, we can understand the signi Ô¨Åcance of Figure 4.18 by examining the actual step response of comparative systems. Depicted in Figure 4.19( a) are the step responses as the poles are moved in a vertical direction, keeping the real part the same.n dœÉœân Œ∏ Œ∂‚Äì ‚Äìjœâ1 ‚ÄìŒ∂2njœâ1 ‚ÄìŒ∂2n œÉjœâ s-plane+ = ‚Äì = ‚Äìjœâd= jœâd œâ FIGURE 4.17 Pole plot for an underdamped second-order system %OS 2 %OS 1jœâ s-plane Ts2Ts1Tp2 Tp1 œÉ FIGURE 4.18 Lines of constant peak time, Tp, settling time, Ts, and percent overshoot, %OS . Note: Ts2<Ts1; Tp2<Tp1;%OS1<%OS 2.178 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:17 As the poles move in a vertical direction, the frequency increases, but the envelope remains the same since the real part of the pole is not changing. The Ô¨Ågure shows a constant exponential envelope, even though the sinusoidal response is changing frequency. Since allcurves Ô¨Åt under the same exponential decay curve, the settling time is virtually the same for all waveforms. Note that as overshoot increases, the rise time decreases. Let us move the poles to the right or left. Since the imaginary part is now constant, movement of the poles yi elds the responses of Figure 4.19( b). Here the frequency is constant over the range of variation of the real part. As the poles move tothe left, the response damps out more rapidly, while the frequency remains the same.Notice that the peak time is the same for all waveforms because the imaginary partremains the same. Moving the poles along a constant radial line yields the responses shown in Figure 4.19( c). Here the percent overshoot remains the same. Notice also that the responses look exactly alike, except for their speed. The farther the poles are from the origin, the morerapid the response. We conclude this section with some exampl es that demonstrate the relationship between the pole location and the speci Ô¨Åcations of the second-order underdamped response. The Ô¨Årst example covers analysis. The second example is a simple design problem consisting of a physical system whose component values we want to design to meet a transientFrequency the same 12tc(t) Pole motion tc(t) Pole motion tc(t) Same overshoot Pole motions-plane s-plane s-plane(a) (c)jœâ jœâ jœâ(b) 1233 2 1 12 121 2 3 1 2 3123Envelope the same 123 œÉ œÉ œÉFIGURE 4.19 Step responses of second-order underdamped systems as poles move: a.with constant real part; b.with constant imaginary part; c.with constant damping ratio4.6 Underdamped Second-Order Systems 179WEBC04 10/28/2014 16:58:19 response speci Ô¨Åcation. An animation PowerPoint presentation (PPT) demonstrating second-order principles is available for instructors at www.wiley.com/college/nise .S e e Second-Order Step Response. Example 4.6 Finding Tp,%OS, and Tsfrom Pole Location Finding Tp,%OS, and Tsfrom Pole Location PROBLEM: Given the pole plot shown in Figure 4.20, Ô¨Ånd Œ∂;œân;Tp;%OS, and Ts. SOLUTION: The damping ratio is given by Œ∂¬àcosŒ∏¬àcos¬âarctan 7=3¬Ü¬ä ¬à 0:394. The natural frequency, œân, is the radial distance from the origin to the pole, or œân¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 72¬á32p ¬à7:616. The peak time is Tp¬àœÄ œâd¬àœÄ 7¬à0:449 second 4.46¬Ü The percent overshoot is %OS¬àe  Œ∂œÄ=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬Ü100¬à26% 4.47¬Ü The approximate settling time is Ts¬à4 œÉd¬à4 3¬à1:333 seconds 4.48¬Ü Students who are using MATLAB should now run ch4p1 in Appendix B. You will learn how to generate a second-order polynomial from twocomplex poles as well as extract and use the coef Ô¨Åcients of the polynomial to calculate T p,%OS,a n d Ts. This exercise uses MATLAB to solve the problem in Example 4.6.s-plane Œ∏ dj7 = jœâd ‚Äìj7 = ‚Äìjœâdjœâ 3‚Äì= ‚ÄìœÉ œÉ FIGURE 4.20 Pole plot for Example 4.6 Example 4.7 Transient Response Through Component DesignTransient Response Through Component Design PROBLEM: Given the system shown in Figure 4.21, Ô¨ÅndJand Dto yield 20% overshoot and a settling time of 2 se conds for a step input of torque T(t). J DT(t) Œ∏ K = 5 N-m/rad(t) FIGURE 4.21 Rotational mechanical system for Example 4.7180 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:19 Second-Order Transfer Functions via Testing Just as we obtained the transfer function of a Ô¨Årst-order system experimentally, we can do the same for a system that exhibits a typical underdamped second-order response. Again, we can measure the laboratory response curve for percent overshoot and settling time, from which we can Ô¨Ånd the poles and hence the denominator. The numerator can be found, as in theÔ¨Årst-order system, from a knowledge of the measured and expected steady-state values. A problem at the end of the chapter illustrates the estimation of a second-order transfer function from the step response.SOLUTION: First, the transfer function for the system is G s¬Ü¬à1=J s2¬áD Js¬áK J 4.49¬Ü From the transfer function, œân¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É K Jr 4.50¬Ü and 2Œ∂œân¬àD J 4.51¬Ü But, from the problem statement, Ts¬à2¬à4 Œ∂œân 4.52¬Ü orŒ∂œân¬à2. Hence, 2Œ∂œân¬à4¬àD J 4.53¬Ü Also, from Eqs. (4.50) and (4.52), Œ∂¬à4 2œân¬à2Ô¨ÉÔ¨ÉÔ¨ÉÔ¨É J Kr 4.54¬Ü From Eq. (4.39), a 20% overshoot implies Œ∂¬à0:456. Therefore, from Eq. (4.54), Œ∂¬à2Ô¨ÉÔ¨ÉÔ¨ÉÔ¨É J Kr ¬à0:456 4.55¬Ü Hence, J K¬à0:052 4.56¬Ü From the problem statement, K¬à5 N-m/rad. Combining this value with Eqs. (4.53) and (4.56), D=1.04 N-m-s/rad, and J¬à0:26 kg-m2.4.6 Underdamped Second-Order Systems 181WEBC04 10/28/2014 16:58:20 Now that we have analyzed systems with two poles, how does the addition of another pole affect the response? We answer this question in the next section. 4.7 System Response with Additional Poles In the last section, we analyzed systems with one or two poles. It must be emphasized that the formulas describing percent overshoot, settling time, and peak time were derived only for a system with two complex poles and no zeros. If a system such as that shown inFigure 4.22 has more than two poles or has zeros, we cannot use the formulas to calculate theperformance speci Ô¨Åcations that we derived. However, under certain conditions, a system with more than two poles or with zeros can be approximated as a second-order system thathas just two complex dominant poles . Once we justify this approximation, the formulas for percent overshoot, settling time, and peak time can be applied to these higher-order systemsby using the location of the dominant poles. In this section, we investigate the effect of an additional pole on the second-order response. In the next section, we analyze the effect of adding a zero to a two-pole system. Let us now look at the conditions that would have to exist in order to approximate the behavior of a three-pole system as that of a two-pole system. Consider a three-pole systemwith complex poles and a third pole on the real axis. Assuming that the complex poles are at  Œ∂œâ njœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p and the real pole is at  Œ±r, the step response of the system can be determined from a partial-fraction expansion. Thus, the output transform is C s¬Ü¬àA s¬áB s¬áŒ∂œân¬Ü¬áCœâd s¬áŒ∂œân¬Ü2¬áœâ2 d¬áD s¬áŒ±r 4.57¬Ü or, in the time domain, c t¬Ü¬àAu t¬Ü¬áe Œ∂œânt Bcosœâdt¬áCsinœâdt¬Ü¬áDe Œ±rt 4.58¬Ü The component parts of c(t) are shown in Figure 4.23 for three cases of Œ±r. For Case I, Œ±r¬àŒ±r1and is not much larger than Œ∂œân; for Case II, Œ±r¬àŒ±r2and is much larger than Œ∂œân; and for Case III, Œ±r¬à‚àû:Skill-Assessment Exercise 4.5 PROBLEM: Find Œ∂;œân;Ts;Tp;Tr,a n d%OS for a system whose transfer function is G s¬Ü¬à361 s2¬á16s¬á361. ANSWERS: Œ∂¬à0:421;œân¬à19;Ts¬à0:5s;Tp¬à0:182 s ;Tr¬à0:079 s ;and%OS¬à23:3%: The complete solution is located at www.wiley.com/college/nise .TryIt 4.1 Use the following MATLAB statements to calculate the answers to Skill-Assessment Exercise 4.5. Ellipses meancode continues on next line. numg=361; deng=[1 16 361] ; omegan =sqrt(deng(3) ... /deng(1) ) zeta=(deng(2) /deng(1) ) ... / (2*omegan) Ts=4/ (zeta*omegan) Tp=pi/ (omegan*sqrt... (1-zeta^2) ) pos=100*exp(-zeta* ... pi/sqrt(1-zeta^2) ) Tr=(1.768*zeta^3 - ... 0.417*zeta^2 +1.039* ... zeta +1) /omegan182 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:20 FIGURE 4.22 Robot follows input commands from a human trainer Au(t) + e‚Äì nt(B cos dt + C sin dt)Œ±‚Äìr1‚Äìn p2p1 p3s-plane Case I Case II (a)Case IIIŒ±‚Äìr2Œ∂‚Äìn p2p1 p3 Œ∂‚Äìn p2p1 s-plane s-plane II Case IIII II Case IResponse Time (b)0jœâ jœâ jœâ De‚ÄìŒ±ritŒ∂œâœâ œâ Œ∂œâœâœâœÉœÉ œÉ FIGURE 4.23 Component responses of a three-polesystem: a.pole plot; b.component responses: Nondominant pole is neardominant second-orderpair (Case I), far from the pair (Case II), and at in Ô¨Ånity (Case III)4.7 System Response with Additional Poles 183WEBC04 10/28/2014 16:58:21 Let us direct our attention to Eq. (4.58) and Figure 4.23. If Œ±r Œ∂œân(Case II), the pure exponential will die out much more rapidly than the second-order underdamped step response. If the pure exponential term decays to an insigni Ô¨Åcant value at the time of the Ô¨Årst overshoot, such parameters as percent overshoot, settling time, and peak time will be generated by the second-order underdamped step response component. Thus, the totalresponse will approach that of a pure second-order system (Case III). IfŒ± ris not much greater than Œ∂œân(Case I), the real pole‚Äô s transient response will not decay to insigni Ô¨Åcance at the peak time or settling time generated by the second-order pair. In this case, the exponential decay is signi Ô¨Åcant, and the system cannot be represented as a second-order system. The next question is, How much farther from the dominant poles does the third pole have to be for its effect on the second-order response to be negligible? The answer of coursedepends on the accuracy for which you are looking. However, this book assumes that theexponential decay is negligible after Ô¨Åve time constants. Thus, if the real pole is Ô¨Åve times farther to the left than the dominant poles, we assume that the system is represented by itsdominant second-order pair of poles. What about the magnitude of the exponential decay? Can it be so large that its contribution at the peak time is not negligible? We can show, through a partial-fractionexpansion, that the residue of the third po le, in a three-pole system with dominant second-order poles and no zeros, will actuall y decrease in magnitude as the third pole is moved farther into the left half-plane. Assume a step response, C(s), of a three-pole system: C s¬Ü¬à bc s s2¬áas¬áb¬Ü s¬ác¬Ü¬àA s¬áBs¬áC s2¬áas¬áb¬áD s¬ác 4.59¬Ü where we assume that the nondominant pole is located at  con the real axis and that the steady-state response approaches unity. Evaluating the constants in the numerator ofeach term, A¬à1; B¬àca c2 c2¬áb ca(4.60a) C¬àca2 c2a bc c2¬áb ca;D¬à b c2¬áb ca(4.60b) As the nondominant pole approaches ‚àû;orc¬Æ‚àû, A¬à1;B¬à 1;C¬à a;D¬à0 4.61¬Ü Thus, for this example, D, the residue of the nondominant pole and its response, becomes zero as the nondominant pole approaches in Ô¨Ånity. The designer can also choose to forgo extensive residue analysis, since all system designs should be simulated to determine Ô¨Ånal acceptance. In this case, the control systems engineer can use the ‚ÄúÔ¨Åve times ‚Äùrule of thumb as a necessary but not suf Ô¨Åcient condition to increase the con Ô¨Ådence in the second-order approximation during design, but then simulate the completed design. Let us look at an example that compares the responses of two different three-pole systems with that of a second-order system.184 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:22 Example 4.8 Comparing Responses of Three-Pole SystemsComparing Responses of Three-Pole Systems PROBLEM: Find the step response of each of the transfer functions shown in Eqs. (4.62) through (4.64) and compare them. T1 s¬Ü¬à24:542 s2¬á4s¬á24:542(4.62) T2 s¬Ü¬à245:42 s¬á10¬Ü s2¬á4s¬á24:542¬Ü 4.63¬Ü T3 s¬Ü¬à73:626 s¬á3¬Ü s2¬á4s¬á24:542¬Ü 4.64¬Ü SOLUTION: The step response, Ci s¬Ü, for the transfer function, Ti s¬Ü,c a nb ef o u n db y multiplying the transfer function by 1/ s, a step input, and using par tial-fraction expansion followed by the inverse Laplace transform to Ô¨Ånd the response, ci t¬Ü. With the details left as an exercise for the student, the results are c1 t¬Ü¬à1 1:09e 2tcos 4:532t 23:8¬∞¬Ü 4.65¬Ü c2 t¬Ü¬à1 0:29e 10t 1:189e 2tcos 4:532t 53:34¬∞¬Ü 4.66¬Ü c3 t¬Ü¬à1 1:14e 3t¬á0:707e 2tcos 4:532t¬á78:63¬∞¬Ü 4.67¬Ü The three responses are plotted in Figure 4.24. Notice that c2 t¬Ü, with its third pole at  10 and farthest from the dominant poles, is the better approximation of c1 t¬Ü,t h ep u r e second-order system response; c3 t¬Ü, with a third pole close to the dominant poles, yields the most error. 1.4 1.21.00.80.60.40.2 0 0.5 2.0 2.5 3.0 Time (seconds)Normalized responsec1(t) c2(t) c3(t) 1.0 1.5 FIGURE 4.24 Step responses of system T1 s¬Ü, system T2 s¬Ü, and system T3 s¬Ü4.7 System Response with Additional Poles 185WEBC04 10/28/2014 16:58:22 4.8 System Response with Zeros Now that we have seen the effect of an additional pole, let us add a zero to the second-order system. In Section 4.2, we saw that the zeros of a response affect the residue, or amplitude,of a response component but do not affect the nature of the response ‚Äîexponential, damped sinusoid, and so on. In this section, we add a real-axis zero to a two-pole system. The zeroStudents who are using MATLAB should now run ch4p2 in Appendix B.You will learn how to generate a step response for a transferfunction and how to plot the response directly or collect the points for future use. The example shows how to collect the points and then use them to create a multiple plot, title the graph, andlabel the axes and curves to produce the graph in Figure 4.24 tosolve Example 4.8. System responses can alternately be obtained using Simulink.Simulink is a software package that is integrated with MATLABto provide a graphical user interface (GUI) for de Ô¨Åning systems and generating responses. The reader is encouraged to studyAppendix C, which contains a tutorial on Simulink as well as someexamples. One of the illustrative examples, Example C.1, solvesExample 4.8 using Simulink. Another method to obtain systems responses is through the use ofMATLAB's LTI Viewer. An advantage of the LTI Viewer is that itdisplays the values of settling time, peak time, rise time, maximumresponse, and the Ô¨Ånal value on the step response plot. The reader is encouraged to study Appendix E at www.wiley.com/college/nise , which contains a tutorial on the LTI Viewer as well as someexamples. Example E.1 solves Example 4.8 using the LTI Viewer. Skill-Assessment Exercise 4.6 PROBLEM: Determine the validity of a second-order approximation for each of these two transfer functions: a.G s¬Ü¬à700 s¬á15¬Ü s2¬á4s¬á100¬Ü b.G s¬Ü¬à360 s¬á4¬Ü s2¬á2s¬á90¬Ü ANSWERS: a.The second-order approximation is valid. b.The second-order approximation is not valid. The complete solution is located at www.wiley.com/college/nise .TryIt 4.2 Use the following MATLAB and Control System Toolboxstatements to investigate the effect of the additional pole in Skill-AssessmentExercise 4.6( a). Move the higher-order pole originally at 15 to other values by changing ‚Äúa‚Äùin the code. a=15 numga =100*a; denga =conv( [1 a] , ... [1 4 100] ) ; Ta=tf (numga,denga) ; numg=100; deng=[1 4 100] ; T=tf (numg,deng) ; step(Ta, '.',T,'-')186 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:22 will be added Ô¨Årst in the left half-plane and then in the right half-plane and its effects noted and analyzed. We conclude the section by talking about pole-zero cancellation. Starting with a two-pole system with poles at  1j2:828¬Ü, we consecutively add zeros at  3, 5, and  10. The results, normalized to the steady-state value, are plotted in Figure 4.25. We can see that the closer the zero is to the dominant poles, the greater its effect on the transient response. As the zero moves away from the dominant poles, the responseapproaches that of the two-pole system. This analysis can be reasoned via the partial-fractionexpansion. If we assume a group of poles and a zero far from the poles, the residue of each polewill be affected the same by the zero. Hence, the relative amplitudes remain appreciably the same. For example, assume the partial-fraction expansion shown in Eq. (4.68): T s¬Ü¬à s¬áa¬Ü s¬áb¬Ü s¬ác¬Ü¬àA s¬áb¬áB s¬ác ¬à  b¬áa¬Ü=  b¬ác¬Ü s¬áb¬á  c¬áa¬Ü=  c¬áb¬Ü s¬ác 4.68¬Ü If the zero is far from the poles, then ais large compared to bandc, and T s¬Ü‚âàa1=  b¬ác¬Ü s¬áb¬á1=  c¬áb¬Ü s¬ác/C20/C21 ¬àa s¬áb¬Ü s¬ác¬Ü 4.69¬Ü Hence, the zero looks like a simple gain factor and does not change the relative amplitudes of the components of the response. Another way to look at the effect of a zero, which is more general, is as follows (Franklin ,1991 ): Let C(s) be the response of a system, T(s), with unity in the numerator. If we add a zero to the transfer function, yielding s¬áa¬ÜT s¬Ü, the Laplace transform of the response will be s¬áa¬ÜC s¬Ü¬àsC s¬Ü¬áaC s¬Ü 4.70¬Ü Thus, the response of a system with a zero consists of two parts: the derivative of the originalresponse and a scaled version of the original response. If a, the negative of the zero, is very large, the Laplace transform of the response is approximately aC(s), or a scaled version of the original response. If ais not very large, the response has an additional component consisting of the derivative of the original response. As abecomes smaller, the derivative term contributes more to the response and has a greater effect. For step responses, thederivative is typically positive at the start of a step response. Thus, for small values of a, we can expect more overshoot in second-order systems because the derivative term will beadditive around the Ô¨Årst overshoot. This reasoning is borne out by Figure 4.25. TryIt 4.3 Use the following MATLAB and Control System Toolboxstatements to generate Figure 4.25. deng=[1 2 9] ; Ta=tf( [1 3] *9/3,deng) ; Tb=tf( [1 5] *9/5,deng) ; Tc=tf( [1 10] *9/10,deng) ; T=tf(9,deng) ; step(T,Ta,Tb,Tc) text(0.5,0.6, 'no zero' ) text(0.4,0.7, ... 'zero at  10') text(0.35,0.8, ... ' zero at  5 ') text(0.3,0.9, 'zero at  3 ')1.4 1.2 1.0 0.80.60.40.2 0 2.0 4.0 6.0 Time (seconds)1.6 zero at ‚Äì3 zero at ‚Äì5 zero at ‚Äì10 no zero Normalized c(t) FIGURE 4.25 Effect of adding a zero to a two-pole system4.8 System Response with Zeros 187WEBC04 10/28/2014 16:58:24 An interesting phenomenon occurs if ais negative, placing the zero in the right half-plane. From Eq. (4.70) we see that the derivative term, which is typically positive initially, will be of opposite sign from the scaled response term. Thus, if the derivative term,sC(s), is larger than the scaled response, aC(s), the response will initially follow the derivative in the opposite direction from the scaled response. The result for a second-ordersystem is shown in Figure 4.26, where the sign of the input was reversed to yield a positive steady-state value. Notice that the response begins to turn toward the negative direction even though the Ô¨Ånal value is positive. A system that exhibits this phenomenon is known as a nonminimum-phase system. If a motorcycle or airplane was a nonminimum-phase system, it would initially veer left when commanded to steer right. Let us now look at an example of an electrical nonminimum-phase network.1.5 1.0 3.0 4.0 5.0 Time (seconds)c(t) ‚Äì0.52.0 6.01.0 0.5 0 FIGURE 4.26 Step response of a nonminimum-phase system Example 4.9 Transfer Function of a Nonminimum-Phase SystemTransfer Function of a Nonminimum-Phase System PROBLEM: a.Find the transfer function, Vo s¬Ü=Vi s¬Üfor the operational ampli Ô¨Åer circuit shown in Figure 4.27. b.IfR1¬àR2, this circuit is known as an all-pass Ô¨Ålter, since it passes sine waves of a wide range of frequencies without attenuating or amplifying their magnitude ( Dorf,1993 ). We will learn more about frequency response in Chapter 10. Fornow, let R 1¬àR2;R3C¬à1=10, and Ô¨Ånd the step response of the Ô¨Ålter. Show that component parts of the response can beidenti Ô¨Åed with those in Eq. (4.70). SOLUTION: a.Remembering from Chapter 2 that the operational ampli Ô¨Åer has a high input impedance, the current, I(s), through R 1andR2, is the same and is equal to I s¬Ü¬àVi s¬Ü Vo s¬Ü R1¬áR2 4.71¬ÜVi(s)R2V1(s)R1 I(s) R3V2(s)Vo(s) C+‚Äì FIGURE 4.27 Nonminimum-phase electric circuit6 6Adapted from Dorf, R. C. Introduction to Electric Circuits, 2nd ed. (New York: John Wiley & Sons, 1989, 1993), p. 583. ÓÄÇ1989, 1993 John Wiley & Sons. Reprinted by permission of the publisher.188 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:25 Also, Vo s¬Ü¬àAV 2 s¬Ü V1 s¬Ü ¬Ü 4.72¬Ü But, V1 s¬Ü¬àI s¬ÜR1¬áVo s¬Ü 4.73¬Ü Substituting Eq. (4.71) into (4.73), V1 s¬Ü¬à1 R1¬áR2R1Vi s¬Ü¬áR2V0 s¬Ü ¬Ü 4.74¬Ü Using voltage division, V2 s¬Ü¬àVi s¬Ü1=Cs R3¬á1 Cs 4.75¬Ü Substituting Eqs. (4.74) and (4.75) into Eq. (4.72) and simplifying yields Vo s¬Ü Vi s¬Ü¬àA R2 R1R3Cs¬Ü R3Cs¬á1¬Ü R1¬áR2 1¬áA¬Ü¬Ü 4.76¬Ü Since the operational ampli Ô¨Åer has a large gain, A, letAapproach in Ô¨Ånity. Thus, after simpli Ô¨Åcation Vo s¬Ü Vi s¬Ü¬àR2 R1R3Cs R2R3Cs¬áR2¬à R1 R2s R2 R1R3C/C18/C19 s¬á1 R3C/C18/C19 4.77¬Ü b.Letting R1¬àR2andR3C¬à1=10, Vo s¬Ü Vi s¬Ü¬às 1 R3C/C18/C19 s¬á1 R3C/C18/C19 ¬à  s 10¬Ü s¬á10¬Ü 4.78¬Ü For a step input, we evaluate the response as suggested by Eq. (4.70): C s¬Ü¬à  s 10¬Ü s s¬á10¬Ü¬à 1 s¬á10¬á101 s s¬á10¬Ü¬àsCo s¬Ü 10Co s¬Ü 4.79¬Ü where Co s¬Ü¬à 1 s s¬á10¬Ü 4.80¬Ü is the Laplace transform of the response without a zero. Expanding Eq. (4.79) into partial fractions, C s¬Ü¬à 1 s¬á10¬á101 s s¬á10¬Ü¬à 1 s¬á10¬á1 s 1 s¬á10¬à1 s 2 s¬á10 4.81¬Ü4.8 System Response with Zeros 189WEBC04 10/28/2014 16:58:26 We conclude this section by talking about pole-zero cancellation and its effect on our ability to make second-order approximations to a system. Assume a three-pole system with a zero as shown in Eq. (4.85). If the pole term, s¬áp3¬Ü, and the zero term, s¬áz¬Ü, cancel out, we are left with T s¬Ü¬àK s¬áz¬Ü s¬áp3¬Ü s2¬áas¬áb¬Ü 4.85¬Ü as a second-order transfer function. From another perspective, if the zero at  zis very close to the pole at  p3, then a partial-fraction expansion of Eq. (4.85) will show that the residue of the exponential decay is much smaller than the amplitude of the second-order response.Let us look at an example.or the response with a zero is c t¬Ü¬à  e 10t¬á1 e 10t¬à1 2e 10t 4.82¬Ü Also, from Eq. (4.80), Co s¬Ü¬à 1=10 s¬á1=10 s¬á10 4.83¬Ü or the response without a zero is co t¬Ü¬à 1 10¬á1 10e 10t 4.84¬Ü The normalized responses are plotted in Figure 4.28. Notice the immediate reversalof the nonminimum-phase response, c(t). ‚Äì0.5 ‚Äì1.00.1 0.2 0.3 0.4 0.5 Time (seconds)Response‚Äì10c o(t) c (t)1.0 0.5 0 0 FIGURE 4.28 Step response of the nonminimum-phase network of Figure 4.27 ( c(t)) and normalized step response of an equivalent network without the zero ( 10 co t¬Ü) Example 4.10 Evaluating Pole-Zero Cancellation Using ResiduesEvaluating Pole-Zero Cancellation Using Residues PROBLEM: For each of the response functions in Eqs. (4.86) and (4.87), determine whether there is cancellation between the zero and the pole closest to the zero. For any function for which pole-zero cancellation is valid, Ô¨Ånd the approximate response. C1 s¬Ü¬à26:25 s¬á4¬Ü s s¬á3:5¬Ü s¬á5¬Ü s¬á6¬Ü 4.86¬Ü190 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:27 In this section, we have examined the effects of additional transfer function poles and zeros upon the response. In the next section we add nonlinearities of the type discussed in Section 2.10 and see what effects they have on system response.C2 s¬Ü¬à26:25 s¬á4¬Ü s s¬á4:01¬Ü s¬á5¬Ü s¬á6¬Ü 4.87¬Ü SOLUTION: The partial-fraction expansion of Eq. (4.86) is C1 s¬Ü¬à1 s 3:5 s¬á5¬á3:5 s¬á6 1 s¬á3:5 4.88¬Ü The residue of the pole at  3.5, which is closest to the zero at  4, is equal to 1 and is not negligible compared to the other residues . Thus, a second-order step response approxi- mation cannot be made for C1 s¬Ü. The partial-fraction expansion for C2 s¬Üis C2 s¬Ü¬à0:87 s 5:3 s¬á5¬á4:4 s¬á6¬á0:033 s¬á4:01 4.89¬Ü The residue of the pole at  4.01, which is closest to the zero at  4, is equal to 0.033, about two orders of magnitude below any of the other residues. Hence, we make a second-orderapproximation by neglecting the response generated by the pole at  4.01: C 2 s¬Ü‚âà0:87 s 5:3 s¬á5¬á4:4 s¬á6 4.90¬Ü and the response c2 t¬Üis approximately c2 t¬Ü‚âà0:87 5:3e 5t¬á4:4e 6t 4.91¬ÜTryIt 4.4 Use the following MATLAB and Symbolic Math Toolbox statements to evaluate the effect of higher-order poles by Ô¨Ånding the component parts of the time response of c1 t¬Üandc2 t¬Üin Example 4.10. syms s C1=26.25* (s+4) /... (s* (s +3.5)*... (s+5) *(s+6) ) ; C2=26.25* (s+4) /... (s* (s+4.01) *... (s+5) *(s+6)) ; c1=ilaplace(C1) ; 'c1' c1=vpa(c1,3)c2=ilaplace(C2) ; 'c2'c2=vpa(c2,3) Skill-Assessment Exercise 4.7 PROBLEM: Determine the validity of a second-order step-response approximation for each transfer function shown below. a.G s¬Ü¬à185:71 s¬á7¬Ü s¬á6:5¬Ü s¬á10¬Ü s¬á20¬Ü b.G s¬Ü¬à197:14 s¬á7¬Ü s¬á6:9¬Ü s¬á10¬Ü s¬á20¬Ü ANSWERS: a.A second-order approximation is not valid. b.A second-order approximation is valid. The complete solution is located at www.wiley.com/college/nise .4.8 System Response with Zeros 191WEBC04 10/28/2014 16:58:27 4.9 Effects of Nonlinearities upon Time Response In this section, we qualitatively examine the effects of nonlinearities upon the time response of physical systems. In the following examples, we insert nonlinearities, such as saturation,dead zone, and backlash, as shown in Figure 2.46, into a system to show the effects of thesenonlinearities upon the linear responses. The responses were obtained using Simulink, a simulation software package that is integrated with MATLAB to provide a graphical user interface (GUI). Readers who wouldlike to learn how to use Simulink to generate nonlinear responses should consult the Simulink tutorial in Appendix C. Simulink block diagrams are included with all responses that follow. Let us assume the motor and load from the Antenna Control Case Study of Chapter 2 and look at the load angular velocity, œâ o s¬Ü, where œâo s¬Ü¬à0:1sŒ∏m s¬Ü¬à0:2083 E a s¬Ü= s¬á1:71¬Üfrom Eq. (2.208). If we drive the motor with a step input through an ampli Ô¨Åer of unity gain that saturates at 5 volts, Figure 4.29 shows that the effect of ampli Ô¨Åer saturation is to limit the obtained velocity. Load angular velocity (rad/second) 0 2 468 1 000.511.5 With saturationWithout saturation Time (seconds) (a) Step 10 voltsSaturation ¬±5 voltsMotor, load, & gears MuxScope Motor, load, & gears(b)0.2083 s + 1.71 0.2083 s + 1.71 FIGURE 4.29 a.Effect of ampli Ô¨Åer saturation on load angular velocity response; b.Simulink block diagram192 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:27 The effect of dead zone on the output shaft driven by a motor and gears is shown in Figure 4.30. Here we once again assume the motor, load, and gears from Antenna Control Case Study of Chapter 2. Dead zone is present when the motor cannot respond to small voltages.The motor input is a sinusoidal waveform chosen to allow us to see the effects of dead zonevividly. The response begins when the input voltage to the motor exceeds a threshold. Wenotice a lower amplitude when dead zone is present. The effect of backlash on the output shaft driven by a motor and gears is shown in Figure 4.31. Again we assume the motor, load, and gears from the Antenna Control CaseStudy of Chapter 2. The motor input is again a sinusoidal waveform, which is chosen to allow us to see vividly the effects of backlash in the gears driven by the motor. As the motor reverses direction, the output shaft remains stationary while the motor begins to reverse. When thegears Ô¨Ånally connect, the output shaft itself begins to turn in the reverse direction. The resulting response is quite different from the linear response without backlash.0 5 10 15 20 2500.20.40.60.811.2 Time (seconds) (a)Load angular displacement (radians)Without dead zone With dead zone MuxScopeSine wave Amplitude = 5 Frequency = 1 rad/sDead zone ‚Äì2 to +2 (b)Motor, load, & gears Motor, load, & gearsIntegrator Integrator1 s 1 s0.2083 s + 1.71 0.2083 s + 1.71 FIGURE 4.30 a.Effect of dead zone on load angular displacement response; b.Simulink block diagram4.9 Effects of Nonlinearities upon Time Response 193WEBC04 10/28/2014 16:58:28 Now that we have seen the effects of nonlinearities on the time response, let us return to linear systems. Our coverage so far for linear systems has dealt with Ô¨Ånding the time response by using the Laplace transform in the frequency domain. Another way to solve for the response is to use state-space techniques in the time domain. This topic is the subject ofthe next two sections. 4.10 Laplace Transform Solution of State Equations In Chapter 3, systems were modeled in state space, where the state-space representationconsisted of a state equation and an output equation. In this section, we use the Laplacetransform to solve the state equations for the state and output vectors.0 5 10 15 20 2500.050.10.150.20.25 Time (seconds) (a)Load angular displacement (radians)With backlashWithout backlash (b)0.2083 s + 1.71 0.2083 s + 1.71Motor, load, and gears Motor, load, and gearsScope1 s 1 sIntegrator IntegratorSine wave Amplitude = 5 Frequency = 1 rad/sBacklash deadband width 0.15Mux FIGURE 4.31 a.Effect of backlash on load angular displacement response; b.Simulink block diagram Skill-Assessment Exercise 4.8 PROBLEM: Use MATLAB's Simulink to reproduce Figure 4.31. ANSWER: See Figure 4.31.194 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:28 Consider the state equation _x¬àAx¬áBu 4.92¬Ü and the output equation y¬àCx¬áDu 4.93¬Ü Taking the Laplace transform of both sides of the state equation yields sX s¬Ü x 0¬Ü¬àAX s¬Ü¬áBU s¬Ü 4.94¬Ü In order to separate X(s), replace sX(s)w i t h sIX(s), where Iis an nnidentity matrix, and n is the order of the system. Combining all of the X(s) terms, we get sI A¬ÜX s¬Ü¬àx 0¬Ü¬áBU s¬Ü 4.95¬Ü Solving for X(s) by premultiplying both sides of Eq. (4.95) by sI A¬Ü 1, theÔ¨Ånal solution forX(s)i s X s¬Ü¬à sI A¬Ü 1x 0¬Ü¬á sI A¬Ü 1BU s¬Ü ¬àadj sI A¬Ü det sI A¬Ü¬âx 0¬Ü¬áBU s¬Ü¬ä 4.96¬Ü Taking the Laplace transform of the output equation yields Y s¬Ü¬àCX s¬Ü¬áDU s¬Ü 4.97¬Ü Eigenvalues and Transfer Function Poles We saw that the poles of the transfer function determine the nature of the transient response of the system. Is there an equivalent quantity in the state-space representation that yields the same information? Section 5.8 formally de Ô¨Ån e st h er o o t so fd e t sI A¬Ü¬à0 (see the denominator of Eq. (4.96) to be eigenvalues of the system matrix, A.7Let us show that the eigenvalues are equal to the poles of the system ‚Äôs transfer function. Let the output, Y(s), and the input, U(s), be scalar quantities Y(s)a n d U(s), respectively. Further, to conform to the de Ô¨Ånition of a transfer function, let x(0), the initial state vector, equal 0, the null vector. Substituting Eq. (4.96) into Eq. (4.97) and solving for the transferfunction, Y s¬Ü=U s¬Ü,y i e l d s Y s¬Ü U s¬Ü¬àCadj sI A¬Ü det sI A¬Ü/C20/C21 B¬áD ¬àCadj sI A¬ÜB¬áDdet sI A¬Ü det sI A¬Ü 4.98¬Ü The roots of the denominator of Eq. (4.98) are the poles of the system. Since the denominatorsof Eqs. (4.96) and (4.98) are identical, the system poles equal the eigenvalues. Hence, if asystem is represented in state-space, we can Ô¨Ånd the poles from det sI A¬Ü¬à0. We will be more formal about these facts when we discuss stability in Chapter 6. The following example demonstrates solving the state equations using the Laplace transform as well as Ô¨Ånding the eigenvalues and system poles. 7Sometimes the symbol Œªis used in place of the complex variable swhen solving the state equations without using the Laplace transform. Thus, it is common to see the characteristic equation also written as det ŒªI A¬Ü¬à 0.4.10 Laplace Transform Solution of State Equations 195WEBC04 10/28/2014 16:58:30 Example 4.11 Laplace Transform Solution; Eigenvalues and PolesLaplace Transform Solution; Eigenvalues and Poles PROBLEM: Given the system represented in state space by Eqs. (4.99), _x¬à01 0 00 1  24  26  92 435x¬á0 012 435e  t(4.99a) y¬à¬â110 ¬äx (4.99b) x 0¬Ü¬à1 022 435 (4.99c) do the following: a.Solve the preceding state equation and obtain the output for the given exponential input. b.Find the eigenvalues and the system poles. SOLUTION: a.We will solve the problem by Ô¨Ånding the component parts of Eq. (4.96), followed by substitution into Eq. (4.97). First obtain AandBby comparing Eq. (4.99a) to Eq. (4.92). Since sI¬às00 0s0 00 s2 435 4.100 ¬Ü then sI A¬Ü¬às 10 0 s  1 24 26 s¬á92 435 4.101 ¬Ü and sI A¬Ü  1¬à s2¬á9s¬á26¬Ü s¬á9¬Ü 1  24 s2¬á9ss  24s   26s¬á24¬Üs22 643 75 s3¬á9s2¬á26s¬á24 4.102 ¬Ü Since U(s)i s1 = s¬á1¬Ü(the Laplace transform for e t),X s¬Ücan be calculated. Rewriting Eq. (4.96) as X s¬Ü¬à sI A¬Ü 1¬âx 0¬Ü¬áBU s¬Ü¬ä 4.103 ¬Ü and using Bandx(0) from Eqs. (4.99a) and (4.99c), respectively, we get X1 s¬Ü¬à s3¬á10s2¬á37s¬á29¬Ü s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü(4.104a)196 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:31 X2 s¬Ü¬à 2s2 21s 24¬Ü s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü(4.104b) X3 s¬Ü¬às 2s2 21s 24¬Ü s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü(4.104c) The output equation is found from Eq. (4.99b). Performing the indicated addition yields Y s¬Ü¬à 110/C2/C3X1 s¬Ü X2 s¬Ü X3 s¬Ü2 435¬àX 1 s¬Ü¬áX2 s¬Ü 4.105 ¬Ü or Y s¬Ü¬à s3¬á12s2¬á16s¬á5¬Ü s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü ¬à 6:5 s¬á2¬á19 s¬á3 11:5 s¬á4 4.106 ¬Ü where the pole at  1 canceled a zero at  1. Taking the inverse Laplace transform, y t¬Ü¬à  6:5e 2t¬á19e 3t 11:5e 4t 4.107 ¬Ü b.The denominator of Eq. (4.102), which is det sI A¬Ü, is also the denominator of the system ‚Äôs transfer function. Thus, det sI A¬Ü¬à0 furnishes both the poles of the system and the eigenvalues  2; 3, and  4. Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB's Symbolic Math Toolboxshould now run ch4sp1 in Appendix F at www.wiley.com/college/ nise . You will learn how to solve state equations for the output response using the Laplace transform. Example 4.11 will be solved using MATLAB and the Symbolic Math Toolbox. Skill-Assessment Exercise 4.9 PROBLEM: Given the system represented in state space by Eqs. (4.108), _x¬à02  3  5/C20/C21 x¬á0 1/C20/C21 e t(4.108a) y¬à¬â13 ¬äx (4.108b) x 0¬Ü¬à21/C20/C21 (4.108c) do the following: a.Solve for y(t) using state-space and Laplace transform techniques. b.Find the eigenvalues and the system poles.TryIt 4.5 Use the following MATLAB and Symbolic Math Toolbox statements to solve Skill-Assessment Exercise 4.9 . syms s A= [0 2;  3 5] ; B= [0 ;1] ; C=[1 3] ;X0 =[2;1] ; U=1/ (s+1) ; I=[1 0;0 1] ; X=( (s*I-A)^  1) *... (X0+B*U) ; Y=C*X; Y=simplify(Y) ; y=ilaplace(Y) ; pretty(y) eig(A)4.10 Laplace Transform Solution of State Equations 197WEBC04 10/28/2014 16:58:32 4.11 Time Domain Solution of State Equations We now look at another technique for solving the state equations. Rather than using the Laplace transform, we solve the equations directly in the time domain using a method closely allied to the classical solution of differential equations. We will Ô¨Ånd that the Ô¨Ånal solution consists of two parts that are different from the forced and natural responses. The solution in the time domain is given directly by x t¬Ü¬àeAtx 0¬Ü¬áZt 0eA t œÑ¬ÜBu œÑ¬ÜdœÑ ¬àŒ¶ t¬Üx 0¬Ü¬áZt 0Œ¶ t œÑ¬ÜBu œÑ¬ÜdœÑ 4.109 ¬Ü where Œ¶ t¬Ü¬àeAtby de Ô¨Ånition, and which is called the state-transition matrix . Eq. (4.109) is derived in Appendix I located at www.wiley.com/college/nise . Readers who are not familiar with this equation or who may want to refresh their memory should consult Appendix I before proceeding. Notice that the Ô¨Årst term on the right-hand side of the equation is the response due to the initial state vector, x(0). Notice also that it is the only term dependent on the initial state vector and not the input. We call this part of the response the zero-input response , since it is the total response if the input is zero. The second term, called the convolution integral ,i s dependent only on the input, u, and the input matrix, B, not the initial state vector. We call this part of the response the zero-state response , since it is the total response if the initial state vector is zero. Thus, there is a partitioning of the response different from the forced/natural response we have seen when solving differential equations. In differential equations,the arbitrary constants of the natural response are evaluated based on the initial conditionsand the initial values of the forced response and its derivatives. Thus, the natural response ‚Äôs amplitudes are a function of the initial conditions of the output and the input. In Eq. (4.109), the zero-input response is not dependent on the initial values of the input and its derivatives. It is dependent only on the initial conditions of the state vector. The next example vividlyshows the difference in partitioning. Pay close attention to the fact that in the Ô¨Ånal result the zero-state response contains not only the forced solution but also pieces of what wepreviously called the natural response. We will see in the solution that the natural response isdistributed through the zero-input response and the zero-state response. Before proceeding with the example, let us examine the form the elements of Œ¶ t¬Ü take for linear, time-invariant systems. The Ô¨Årst term of Eq. (4.96), the Laplace transform of the response for unforced systems, is the transform of Œ¶ t¬Üx 0¬Ü, the zero-input response from Eq. (4.109). Thus, for the unforced system ‚Ñí¬âx t¬Ü¬ä ¬à‚Ñí¬âŒ¶ t¬Üx 0¬Ü¬ä ¬à sI A¬Ü  1x 0¬Ü 4.110 ¬Ü from which we can see that sI A¬Ü 1is the Laplace transform of the state-transition matrix ,Œ¶ t¬Ü. We have already seen that the denominator of sI A¬Ü 1is a polynomialANSWERS: a.y t¬Ü¬à  0:5e t 12e 2t¬á17:5e 3t b. 2; 3 The complete solution is located at www.wiley.com/college/nise .198 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:34 inswhose roots are the system poles. This polynomial is found from the equation det sI A¬Ü¬à0. Since ‚Ñí 1¬â sI A¬Ü 1¬ä¬à‚Ñí 1adj sI A¬Ü det sI A¬Ü/C20/C21 ¬àŒ¶ t¬Ü 4.111 ¬Ü each term of Œ¶ t¬Üwould be the sum of exponentials generated by the system ‚Äôs poles. Let us summarize the concepts with two numerical examples. The Ô¨Årst example solves the state equations directly in the time domain. The second example uses the Laplace transform to solve for the state-transition matrix by Ô¨Ånding the inverse Laplace transform of sI A¬Ü 1. Example 4.12 Time Domain SolutionTime Domain Solution PROBLEM: For the state equation and initial state vector shown in Eqs. (4.112), where u(t) is a unit step, Ô¨Ånd the state-transition matrix and then solve for x(t). _x t¬Ü¬à01  8  6/C20/C21 x t¬Ü¬á0 1/C20/C21 u t¬Ü (4.112a) x 0¬Ü¬à10/C20/C21 (4.112b) SOLUTION: Since the state equation is in the form _x t¬Ü¬àAx t¬Ü¬áBu t¬Ü 4.113 ¬Ü Ô¨Ånd the eigenvalues using det sI A¬Ü¬à0. Hence, s 2¬á6s¬á8¬à0, from which s1¬à 2a n ds 2¬à 4. Since each term of the state-transition matrix is the sum of responses generated by the poles (eigenvalues), we assume a state-transition matrix of the form Œ¶ t¬Ü¬à K1e 2t¬áK2e 4t¬Ü K3e 2t¬áK4e 4t¬Ü K5e 2t¬áK6e 4t¬Ü K7e 2t¬áK8e 4t¬Ü"# 4.114 ¬Ü In order to Ô¨Ånd the values of the constants, we make use of the properties of the state-transition matrix derived in Appendix J located at www.wiley.com/college/nise . Since Œ¶ 0¬Ü¬àI 4.115 ¬Ü then K1¬áK2¬à1 (4.116a) K3¬áK4¬à0 (4.116b) K5¬áK6¬à0 (4.116c) K7¬áK8¬à1 (4.116d)4.11 Time Domain Solution of State Equations 199WEBC04 10/28/2014 16:58:35 And, since _Œ¶ 0¬Ü¬àA 4.117 ¬Ü then  2K1 4K2¬à0 (4.118a)  2K3 4K4¬à1 (4.118b)  2K5 4K6¬à 8 (4.118c)  2K7 4K8¬à 6 (4.118d) The constants are solved by taking two simultaneous equations four times. For example, Eq. (4.116a) can be solved simultaneously with Eq. (4.118 a) to yield the values of K1andK2. Proceeding similarly, all of the constants can be found. Therefore, Œ¶ t¬Ü¬à 2e 2t e 4t¬Ü1 2e 2t 12e  4t/C18/C19  4e 2t¬á4e 4t¬Ü   e 2t¬á2e 4t¬Ü2 435 4.119 ¬Ü Also, Œ¶ t œÑ¬ÜB¬à 1 2e 2 t œÑ¬Ü 12e  4 t œÑ¬Ü/C18/C19 /C16  e 2 t œÑ¬Ü¬á2e 4 t œÑ¬Ü/C172 643 75 4.120 ¬Ü Hence, the Ô¨Årst term of Eq. (4.109) is Œ¶ t¬Üx 0¬Ü¬à 2e 2t e 4t¬Ü  4e 2t¬á4e 4t¬Ü/C20/C21 4.121 ¬Ü The last term of Eq. (4.109) is Zt 0Œ¶ t œÑ¬ÜBu œÑ¬ÜdœÑ¬à1 2e 2tZt 0e2œÑdœÑ 12e  4tZt 0e4œÑdœÑ  e 2tZt 0e2œÑdœÑ¬á2e 4tZt 0e4œÑdœÑ2 66643 7775 ¬à1 8 14e  2t¬á18e  4t 12e  2t 12e  4t2 6643 775 4.122 ¬Ü Notice, as promised, that Eq. (4.122), the zero-state response, contains not only the forced response, 1/8, but also terms of the form Ae  2tand Be 4tthat are part of what we previously called the natural response. However, the coef Ô¨Åcients, Aand B, are not dependent on the initial conditions. TheÔ¨Ånal result is found by adding Eqs. (4.121) and (4.122). Hence, x t¬Ü¬àŒ¶ t¬Üx 0¬Ü¬áZt 0Œ¶ t œÑ¬ÜBu œÑ¬ÜdœÑ¬à1 8¬á74e  2t 78e  4t  72e  2t¬á72e  4t2 6643 775 4.123 ¬Ü200 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:36 Systems represented in state space can be simulated on the digital computer. Programs such as MATLAB can be used for this purpose. Alternately, the user can write specialized programs, as discussed in Appendix H.1 at www.wiley.com/college/nise . Students who are using MATLAB should now run ch4p3 in Appendix B.This exercise uses MATLAB to simulate the step response of systemsrepresented in state space. In addition to generating the stepresponse, you will learn how to specify the range on the time axisfor the plot.Example 4.13 State-Transition Matrix via Laplace TransformState-Transition Matrix via Laplace Transform PROBLEM: Find the state-transition matrix of Example 4.12, using sI A¬Ü 1. SOLUTION: We use the fact that Œ¶ t¬Üis the inverse Laplace transform of sI A¬Ü 1. Thus, Ô¨ÅrstÔ¨Ånd sI A¬Üas sI A¬Ü¬às  1 8 s¬á6¬Ü"# 4.124 ¬Ü from which sI A¬Ü 1¬às¬á61  8 s"# s2¬á6s¬á8¬às¬á6 s2¬á6s¬á81 s2¬á6s¬á8  8 s2¬á6s¬á8s s2¬á6s¬á82 6643 775 4.125 ¬Ü Expanding each term in the matrix on the right by partial fractions yields sI A¬Ü  1¬à2 s¬á2 1 s¬á4/C18/C191=2 s¬á2 1=2 s¬á4/C18/C19  4 s¬á2¬á4 s¬á4/C18/C19 1 s¬á2¬á2 s¬á4/C18/C192 66643 7775 4.126 ¬Ü Finally, taking the inverse Laplace transform of each term, we obtain Œ¶ t¬Ü¬à 2e  2t e 4t¬Ü1 2e 2t 12e  4t/C18/C19  4e 2t¬á4e 4t¬Ü   e 2t¬á2e 4t¬Ü2 643 75 4.127 ¬Ü Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB's Symbolic Math Toolbox should now run ch4sp2 in Appendix F at www.wiley.com/college/ nise . You will learn how to solve state equations for the output response using the convolution integral. Examples 4.12 and 4.13 will be solved using MATLAB and the Symbolic Math Toolbox.4.11 Time Domain Solution of State Equations 201WEBC04 10/28/2014 16:58:40 Skill-Assessment Exercise 4.10 PROBLEM: Given the system represented in state space by Eqs. (4.128a): _x¬à02  2  5/C20/C21 x¬á0 1/C20/C21 e 2t(4.128a) y¬à21/C2/C3 x (4.128b) x 0¬Ü¬à12/C20/C21 (4.128c) do the following: a.Solve for the state-transition matrix. b.Solve for the state vector using the convolution integral. c.Find the output, y(t). ANSWERS: a.Œ¶ t¬Ü¬à4 3e t 13e  4t/C18/C1923e  t 23e  4t/C18/C19  23e  t¬á23e  4t/C18/C19  13e  t¬á43e  4t/C18/C192 66643 7775 b.x t¬Ü¬à10 3e t e 2t 4 3e 4t/C18/C19  53e  t¬áe 2t¬á83e  4t/C18/C192 66643 7775 c.y t¬Ü¬à5e  t e 2t The complete solution is located at www.wiley.com/college/nise . Case Studies Antenna Control: Open-Loop ResponseAntenna Control: Open-Loop Response In this chapter, we have made use of the transfer functions derived in Chapter 2 and the state equations derived in Chapter 3 to obtain the output response of an open-loop system.We also showed the importance of the poles of a system in determining the transientresponse. The following case study uses these concepts to analyze an open-loop portion ofthe antenna azimuth position control system. The open-loop function that we will dealwith consists of a power ampli Ô¨Åer and motor with load. PROBLEM: For the schematic of the azimuth positi on control system shown on the front endpapers, Con Ô¨Åguration 1, assume an open-loop system (feedback path disconnected).202 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:41 a.Predict, by inspection, the form of the open-loop angular velocity response of the load to a step-voltage input to the power ampli Ô¨Åer. b.Find the damping ratio and natural frequency of the open-loop system. c.Derive the complete analytical expression for the open-loop angular velocity responseof the load to a step-voltage input to the power ampli Ô¨Åer, using transfer functions. d. Obtain the open-loop state and output equations. e.Use MATLAB to obtain a plot of the open-loop angular velocityresponse to a step-voltage input. SOLUTION: The transfer functions of the power ampli Ô¨Åer, motor, and load as shown on the front endpapers, Con Ô¨Åguration 1, were discussed in the Chapter 2 case study. The two subsystems are shown interconnected in Figure 4.32( a). Differentiating the angular position ofthemotorandloadoutputbymultiplyingby s,weobtaintheoutputangularvelocity, œâ o,as shown in Figure 4.32( a). The equivalent transfer function representing the three blocks in Figure 4.32( a) is the product of the individual transfer functions and is shown in Figure 4.32(b).8 a.Using the transfer function shown in Figure 4.32( b), we can predict the nature of the step response. The step response consists of the steady-state response generated by thestep input and the transient response, which is the sum of two exponentials generatedby each pole of the transfer function. Hence, the form of the response is œâ o t¬Ü¬àA¬áBe 100t¬áCe 1:71t 4.129 ¬Ü b.The damping ratio and natural frequency of the open-loop system can be found byexpanding the denominator of the transfer function. Since the open-loop transferfunction is G s¬Ü¬à 20:83 s2¬á101:71s¬á171 4.130 ¬Ü œân¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 171p ¬à13:08;andŒ∂¬à3:89 (overdamped). c.In order to derive the angular velocity response to a step input, we multiply the transfer function of Eq. (4.130) by a step input, 1/ s, and obtain œâo s¬Ü¬à20:83 s s¬á100¬Ü s¬á1:71¬Ü 4.131 ¬Ü Motor and load sPower ampConvert to angular velocity Vp(s) 0.2083 s(s+1.71) ( ) ( )Œ∏ a bEa(s) o(s) œâo(s) 100 (s+100) 20.83 ( s+100)(s +1.71)Vp(s) œâo(s) FIGURE 4.32 Antenna azimuth position control system for angular velocity: a.forward path; b.equivalent forward path 8This product relationship will be derived in Chapter 5.Case Studies 203WEBC04 10/28/2014 16:58:43 Expanding into partial fractions, we get œâo s¬Ü¬à0:122 s¬á2:1210 3 s¬á100 0:124 s¬á1:71 4.132 ¬Ü Transforming to the time domain yields œâo t¬Ü¬à0:122¬á 2:1210 3¬Üe 100t 0:124e 1:71t 4.133 ¬Ü d.First convert the transfer function into the state-space representation. Using Eq. (4.130), we have œâo s¬Ü Vp s¬Ü¬à20:83 s2¬á101:71s¬á171 4.134 ¬Ü Cross-multiplying and taking the inver se Laplace transform with zero initial conditions, we have _œâo¬á101:71_œâo¬á171œâo¬à20:83vp 4.135 ¬Ü DeÔ¨Åning the phase variables as x1¬àœâo (4.136a) x2¬à_œâo (4.136b) and using Eq. (4.135), the state equations are written as _x1¬àx2 (4.137a) _x2¬à 171x1 101:71x2¬á20:83vp (4.137b) where vp¬à1, a unit step. Since x1¬àœâois the output, the output equation is y¬àx1 4.138 ¬Ü Equations (4.137) and (4.138) can be programmed to obtain the step responseusing MATLAB or alternative methods described in Appendix H.1 at www.wiley .com/college/nise . e. Students who are using MATLAB should now run ch4p4 in Appendix B. This exercise uses MATLAB to plot the step response. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. Refer to the antenna azimuth pos ition control system shown on the front endpapers, ConÔ¨Å guration 2. Assume an open-loop system (feedback path disconnected) a n dd ot h ef o l l o w i n g : a.Predict the open-loop angular velocity response of the power ampli Ô¨Åer, motor, and load to a step voltage at the input to the power ampli Ô¨Åer. b.Find the damping ratio and natural frequency of the open-loop system.204 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:44 c.Derive the open-loop angular velocity response of the power ampli Ô¨Åer, motor, and load to a step-voltage input using transfer functions. d.Obtain the open-loop state and output equations. e.Use MATLAB to obtain a plot of the open-loop angular velocity response to a step-voltage input. Unmanned Free-Swimming Submersible Vehicle: Open-Loop Pitch ResponseUnmanned Free-Swimming Submersible Vehicle: Open-Loop Pitch Response An Unmanned Free-Swimming Submersible (UFSS) vehicle is shown in Figure 4.33. The depth of the vehicle is controlled as follows. During forward motion, an elevator surface on the vehicle is de Ô¨Çected by a selected amount. This de Ô¨Çection causes the vehicle to rotate about the pitch axis. The pitch of the vehicle creates a vertical force that causes thevehicle to submerge or rise. The pitch control system for the vehicle is used here and insubsequent chapters as a case study to demonstrate the covered concepts. The blockdiagram for the pitch control system is shown in Figure 4.34 and on the back endpapers forfuture reference ( Johnson ,1980 ). In this case study, we investigate the time response of the vehicle dynamics that relate the pitch angle output to the elevator de Ô¨Çection input. Courtes y of the Naval Research Laborator y. FIGURE 4.33 Unmanned Free-Swimming Submersible (UFSS) vehicle Pitch gain ‚ÄìK1Pitch command Œ∏c(s)Commanded elevator deflection ec(s) 2 s+2Elevator actuatorElevator deflection e(s)Vehicle dynamics ‚Äì0.125(s +0.435) (s+1.23)(s2+ 0.226s + 0.0169)Pitch Œ∏(s) Pitch rate sensor ‚ÄìK2s+ ‚Äì+ ‚ÄìŒ¥ Œ¥ FIGURE 4.34 Pitch control loop for the UFSS vehicleCase Studies 205WEBC04 10/28/2014 16:58:45 PROBLEM: The transfer function relating pitch angle, Œ∏ s¬Ü, to elevator surface angle, Œ¥e s¬Ü, for the UFSS vehicle is Œ∏ s¬Ü Œ¥e s¬Ü¬à 0:125 s¬á0:435¬Ü s¬á1:23¬Ü s2¬á0:226s¬á0:0169 ¬Ü 4.139 ¬Ü a.Using only the second-order poles shown in the transfer function, predict percent overshoot, rise time, peak time, and settling time. b.Using Laplace transforms, Ô¨Ånd the analytical expression for the response of the pitch angle to a step input in elevator surface de Ô¨Çection. c.Evaluate the effect of the additional pole and zero on the validity of the second-orderapproximation. d.Plot the step response of the vehicle dynamics and verify your conclusions found in (c). An animation PowerPoint presentation (PPT) demonstrating this system is available for instructors at www.wiley.com/college/nise .S e e UFSS Vehicle . SOLUTION: a.Using the polynomial s 2¬á0:226s¬á0:0169, we Ô¨Ånd that œâ2 n¬à0:0169 and 2 Œ∂œân¬à0:226. Thus, œân¬à0:13 rad/s and Œ∂¬à0:869. Hence, %OS¬àe Œ∂œÄ=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p 100 ¬à0:399%. From Figure 4.16, œânTr¬à2:75, or Tr¬à21:2s . T o Ô¨Ånd peak time, we use Tp¬àœÄ=œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬à48:9 s. Finally, settling time is Ts¬à4=Œ∂œân¬à35:4s . b.In order to display a positive Ô¨Ånal value in Part d.w e Ô¨Ånd the response of the system to a negative unit step, compensating for the negative sign in the transfer function. Using partial-fraction expansion, the Laplace transform of the response, Œ∏ s¬Ü,i s Œ∏s ¬Ü¬à0:125s¬á0:435 ¬Ü ss¬á1:23 ¬Ü s2¬á0:226s¬á0:0169 ¬Ü ¬à2:6161 s¬á0:06451 s¬á1:23  2:68s¬á0:113 ¬Ü ¬á 3:478Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 0:00413p s¬á0:113 ¬Ü2¬á0:00413 4.140 ¬Ü Taking the inverse Laplace transform, Œ∏ t¬Ü¬à2:616¬á0:0645 e 1:23t  e 0:113t 2:68 cos 0 :0643 t¬á3:478 sin 0 :0643 t¬Ü ¬à2:616¬á0:0645 e 1:23t 4:39e 0:113tcos 0:0643 t¬á52:38¬∞¬Ü 4.141 ¬Ü c.Looking at the relative amplitudes between the coef Ô¨Åcient of the e 1:23tterm and the cosine term in Eq. (4.165), we see that there is pole-zero cancellation between the pole at  1.23 and the zero at  0.435. Further, the pole at  1.23 is more than Ô¨Åve times farther from the jœâaxis than the second-order dominant poles at  0:113j0:0643. We conclude that the response will be close to that predicted. d.Plotting Eq. (4.141) or using a computer simulation, we obtain the step response shownin Figure 4.35. We indeed see a response close to that predicted.206 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:45 Students who are using MATLAB should now run ch4p5 in Appendix B. This exercise uses MATLAB to Ô¨ÅndŒ∂,œâ,Ts,Tp, and Trand plot a step response. Table lookup is used to Ô¨ÅndTr. The exercise applies the concepts to the problem above. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. This problem uses the same principles that were applied to the Unmanned Free-Swimming Submersible ve hicle: Ships at sea undergo motion about their roll axis, as shown in Figure 4.36. Finscalled stabilizers are used to reduce this rolling motion. The stabilizers can be positioned by a closed-loop roll controlsystem that consists of components, such as Ô¨Ån actuators and sensors, as well as the ship ‚Äôs roll dynamics. Assume the roll dynamics, which relates the roll-angle output, Œ∏ s¬Ü, to a disturbance-torque input, T D(s), is Œ∏ s¬Ü TD s¬Ü¬à2:25 s2¬á0:5s¬á2:25¬Ü 4.142 ¬Ü Do the following: a.Find the natural frequency, damping ratio, peak time, settling time, rise time, and percentovershoot. b.Find the analytical expression for the output response to a unit step input in voltage. c. Use MATLAB to solve aandband to plot the response found in b.51 0 1 5 20 25 30 35 40 45 5000.51.01.52.02.53.0Negative pitch angle response (radians) Time (seconds) FIGURE 4.35 Negative step response of pitch control for UFSS vehicle Œ∏ TD(t) Roll axis(t) FIGURE 4.36 A ship at sea, showing roll axisCase Studies 207WEBC04 10/28/2014 16:58:45 Summary In this chapter, we took the system models developed in Chapters 2 and 3 and found the output response for a given input, usually a step. The step response yields a clear picture of the system ‚Äôs transient response. We performed this analysis for two types of systems, Ô¨Årst order andsecond order , which are representative of many physical systems. We then formalized our Ô¨Åndings and arrived at numerical speci Ô¨Åcations describing the responses. ForÔ¨Årst-order systems having a single pole on the real axis, the speci Ô¨Åcation of transient response that we derived was the time constant , which is the reciprocal of the real-axis pole location. This speci Ô¨Åcation gives us an indication of the speed of the transient response. In particular, the time constant is the time for the step response to reach 63% of itsÔ¨Ånal value. Second-order systems are more complex. Depending on the values of system components, a second-order system can exhibit four kinds of behavior: 1.Overdamped 2.Underdamped 3.Undamped 4.Critically damped We found that the poles of the input generate the forced response, whereas the system poles generate the transient response. If the system poles are real, the system exhibits overdamped behavior. These exponential responses have time constants equal to the reciprocals of the pole locations. Purely imaginary poles yield undamped sinusoidal oscillations whose radian frequency is equal to the magnitude of the imaginary pole. Systems with complex poles display underdamped responses. The real part of the complex pole dictates the exponential decay envelope, and the imaginary part dictates the sinusoidal radian frequency. The exponentialdecay envelope has a time constant equal to the reciprocal of the real part of the pole, and thesinusoid has a radian frequency equal to the imaginary part of the pole. For all second-order cases, we developed speci Ô¨Åcations called the damping ratio ,Œ∂, andnatural frequency ,œâ n. The damping ratio gives us an idea about the nature of the transient response and how much overshoot and oscillation it undergoes, regardless of timescaling. The natural frequency gives an indication of the speed of the response. We found that the value of Œ∂determines the form of the second-order natural response: IfŒ∂¬à0, the response is undamped. IfŒ∂<1, the response is underdamped. IfŒ∂¬à1, the response is critically damped. IfŒ∂>1, the response is overdamped. The natural frequency is the frequency of oscillation if all damping is removed. It acts as a scaling factor for the response, as can be seen from Eq. (4.28), in which the independentvariable can be considered to be œâ nt. For the underdamped case we de Ô¨Åned several transient response speci Ô¨Åcations, including these: Percent overshoot, %OS Peak time, Tp Settling time, Ts Rise time, Tr208 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:46 The peak time is inversely proportional to the imaginary part of the complex pole. Thus, horizontal lines on the s-plane are lines of constant peak time. Percent overshoot is a function of only the damping ratio. Consequently, radial lines are lines of constant percent overshoot. Finally, settling time is inversely proportional to the real part of the complexpole. Hence, vertical lines on the s-plane are lines of constant settling time. We found that peak time, percent overshoot, and settling time are related to pole location. Thus, we can design transient responses by relating a desired response to a pole location and thenrelating that pole location to a transfer function and the system ‚Äôs components. The effects of nonlinearities, such as saturation, dead zone, and backlash, were explored using MATLAB‚Äô s Simulink. In this chapter, we also evaluated the time response using the state-space approach. The response found in this way was separated into the zero-input response ,a n dt h e zero-state response , whereas the frequency response method yielded a total response divided into natural response andforced response components. In the next chapter we will use the transient response speci Ô¨Åcations developed here to analyze and design systems that consist of the interconnection of multiple subsystems.We will see how to reduce these systems to a single transfer function in order to apply the concepts developed in Chapter 4. Review Questions 1.Name the performance speci Ô¨Åcation for Ô¨Årst-order systems. 2.What does the performance speci Ô¨Åcation for a Ô¨Årst-order system tell us? 3.In a system with an input and an output, what poles generate the steady-state response? 4.In a system with an input and an output, what poles generate the transient response? 5.The imaginary part of a pole generates what part of a response? 6.The real part of a pole generates what part of a response? 7.What is the difference between the natural frequency and the damped frequency of oscillation? 8.If a pole is moved with a constant imaginary part, what will the responses have incommon? 9.If a pole is moved with a constant real part, what will the responses have in common? 10.If a pole is moved along a radial line extending from the origin, what will the responseshave in common? 11.ListÔ¨Åve speci Ô¨Åcations for a second-order underdamped system. 12.For Question 11 how many speci Ô¨Åcations completely determine the response? 13.What pole locations characterize (1) the underdamped system, (2) the overdampedsystem, and (3) the critically damped system? 14.Name two conditions under which the response generated by a pole can be neglected. 15.How can you justify pole-zero cancellation? Does the solution of the state equation yield the output response of the system? Explain. 17.What is the relationship between sI A¬Ü, which appeared during the Laplace transfor- mation solution of the state equations, and the state-transition matrix, which appearedduring the classical solution of the state equation? Name a major advantage of using time-domain techniques for the solution of the response. 19.Name a major advantage of using frequency-domain techniques for the solution of the response.Review Questions 209WEBC04 10/28/2014 16:58:46 20.What three pieces of information must be given in order to solve for the output response of a system using state-space techniques? 21.How can the poles of a system be found from the state equations? Problems 1.Derive the output responses for all parts of Figure 4.7. [Section: 4.4] 2.Find the output response, c(t), for each of the systems shown in Figure P4.1. Also Ô¨Ånd the time constant, rise time, and settling time for each case. [Sections: 4.2, 4.3] (a)5 s + 51 C(s) 20 s + 201 ss C(s) (b)‚Äì ‚Äì FIGURE P4.1 3.Plot the step responses for Problem 2 using MATLAB. 4.Find the capacitor voltage in the network shown in Figure P4.2 if the switch closes at t¬à0. Assume zero initial conditions. Also Ô¨Ånd the time constant, rise time, and settling time for the capacitor voltage.[Sections: 4.2, 4.3] 5 Vt= 02 Œ© 0.5 F FIGURE P4.2 5.Plot the step response for Problem 4 using MATLAB. Fromyour plots, Ô¨Ånd the time constant, rise time, and settling time. 6.For the system shown in Figure P4.3, (a) Ô¨Ånd an equation that relates settling time of the velocity of the mass to M; (b)Ô¨Ånd an equation that relates rise time of the velocity of the mass to M. [Sections: 4.2, 4.3]f(t)x(t) M6 N-s/m FIGURE P4.3 7.Plot the step response for Problem 6 using MATLAB. From yourplots, Ô¨Ånd the time constant, rise time, and settling time. Use M= 1 and M=2 . 8.For each of the transfer functions shown below, Ô¨Ånd the locations of the poles and zeros, plot them on thes-plane, and then write an expression for the general form of the step response without solving for theinverse Laplace transform. State the nature of eachresponse (overdamped, underdamped, and so on). [Sections: 4.3, 4.4] a.T s¬Ü¬à 2 s¬á2 b.T s¬Ü¬à5 s¬á3¬Ü s¬á6¬Ü c.T s¬Ü¬à10 s¬á7¬Ü s¬á10¬Ü s¬á20¬Ü d.T s¬Ü¬à20 s2¬á6s¬á144 e.T s¬Ü¬às¬á2 s2¬á9 f.T s¬Ü¬à s¬á5¬Ü s¬á10¬Ü2 9.Use MATLAB to Ô¨Ånd the poles of [Section: 4.2] T s¬Ü¬às2¬á2s¬á2 s4¬á6s3¬á4s2¬á7s¬á2 10.Find the transfer function and poles of the system represented in state space here. [Section: 4.10]210 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:47 _x¬à3 42  201 47  52 6643 775x¬á 1  2 32 6643 775u t¬Ü y¬à¬â171 ¬äx;x 0¬Ü¬à0 0 02 66643 7775 Repeat Problem 10 using MATLAB. [Section: 4.10] 12.Write the general form of the capacitor voltage for the electrical network shown in Figure P4.4.[Section: 4.4] R1 = 10 kŒ© L = 200 H C = 10 ŒºF v(t) = u(t) R2 = 10 kŒ©+‚Äì FIGURE P4.4 13.Use MATLAB to plot the capacitor voltage in Problem 12.[Section: 4.4] 14.Solve for x(t) in the system shown in Figure P4.5 iff(t) is a unit step. [Section: 4.4] ( ) Ks fvM Ks fv ft( )2 kg = 6 N/m 2 N-s/m ut( ) Nft( ) Mxt == = FIGURE P4.5 15.The system shown in Figure P4.6 has a unit step input. Find the output response as a function of time. Assumethe system is underdamped. Notice that the result will beEq. (4.28). [Section: 4.6] œân2 œân2 s2 + 2Œ∂œâns + R(s) C(s) FIGURE P4.6 16.Derive the relationship for damping ratio as a function of percent overshoot, Eq. (4.39). [Section: 4.6] 17.Calculate the exact response of each system ofProblem 8 using Laplace tr ansform techniques, andcompare the results to those obtained in that problem. [Sections: 4.3, 4.4] 18.Find the damping ratio and natural frequency for each second-order system of Problem 8 and show that thevalue of the damping ratio conforms to the type ofresponse (underdamped, overdamped, and so on) predicted in that problem. [Section: 4.5] 19.A system has a damping ratio of 0.15, a natural f r e q u e n c yo f2 0r a d / s ,a n dad cg a i no f1 .U s ei n v e r s eLaplace transforms to Ô¨Ånd an analytic expression of the response of the system to a unit-step input.[Section: 4.6] 20.For each of the second-order systems that follow, Ô¨Ånd Œ∂;œâ n;Ts;Tp;Tr, and %OS . [Section: 4.6] a.T s¬Ü¬à16 s2¬á3s¬á16 b.T s¬Ü¬à0:04 s2¬á0:02s¬á0:04 c.T s¬Ü¬à1:05107 s2¬á1:6103s¬á1:05107 21.Repeat Problem 20 using MATLAB. Have the computerprogram estimate the given speciÔ¨Å ca- tions and plot the step responses.Estimate the rise time from the plots. [Section: 4.6] Use MATLAB ‚Äôs LTI Viewer and obtain settling time, peak time, rise time, and percent overshoot for each of the systems in Problem 20. [Section: 4.6] 23.For each pair of second-order system speci Ô¨Åcations that follow, Ô¨Ånd the location of the second-order pair of poles. [Section: 4.6] a.%OS¬à12%;Ts¬à0:6 second b.%OS¬à10%;Tp¬à5 seconds c.Ts¬à7 seconds ;Tp¬à3 seconds 24.Find the transfer function of a second-order systemthat yields a 15% overshoot and a settling time of0.7 second. [Section: 4.6] 25.For the system shown in Figure P4.7, do the following:[Section: 4.6] a.Find the transfer function G s¬Ü¬àX s¬Ü=F s¬Ü. b.Find Œ∂;œâ n;%OS;Ts;Tp,Tr, and CÔ¨Ånalfor a unit-step input.Problems 211WEBC04 10/28/2014 16:58:48 20 N/m 2 N-s/mf(t)x(t) 5 kg FIGURE P4.7 26.For the system shown in Figure P4.8, a step torque is applied at Œ∏1 t¬Ü. Find: a.The transfer function, G s¬Ü¬àŒ∏2 s¬Ü=T s¬Ü b.The percent overshoot, settling time, and peak timeforŒ∏ 2 t¬Ü. [Section: 4.6] 2 kg-m 2T(t)1(t) 2(t) 1 N-m-s/rad 1 N-m/radŒ∏ Œ∏ FIGURE P4.8 27.The derivation of Eq. (4.42) to calculate the settling time for a second-order system assumed an under-damped system Œ∂<1¬Ü. In this problem you will calculate a similar result for a critically damped system Œ∂¬à1¬Ü. a.Show that the unit-step response for a system with transfer functionC s¬Ü R s¬Ü¬àa2 s¬áa¬Ü2isc t¬Ü¬à1 e at 1¬áat¬Ü. (Note:‚Ñí1 s¬áa¬Ü2/C26/C27 ¬àte at. Optional: You can derive this result similarly to Example 2.2.) b.Show that the settling time can be found by solving forTsine aTs 1¬áaTs¬Ü¬à0:02. c.Use MATLAB to plot e x 1¬áx¬Ü¬à 0:02 vs. x. Use the plot to show that Ts¬à5:834 a. 28.An autonomous robot to pick asparagus ( Dong, 2011 ) capable of following planting rows has an orientation system with transfer function Œ∏ Œ∏ref¬à53:176 4:6s2¬á31:281s¬á53:176 Make a sketch of Œ∏ t¬Üin response to Œ∏ref t¬Ü¬à3u t¬Ü. Indicate in your plot Cfinal;Cmax;Tp, and Ts. (Hint: You may use the result of Problem 27 c).29.Figure P4.9 shows Ô¨Åve step responses of an auto- matic voltage regulation system as one of the system parameters varies ( Gozde, 2011). Assume for all Ô¨Åve responses that they are those of a second-ordersystem with an overshoot of 20%. Make a sketchof the positions of the poles in the complex plane foreach one of the responses. Label the curves A throughE from left to right. 0 0.5 1 .0 1 .51. 4 2 0 0.8 0.6 0.4 0.2 0 Time (seconds)Voltage change Vt(s) (V) FIGURE P4.9 Time responses for an automatic voltage regulation system 30.Derive the unit step response for each transfer function in Example 4.8. [Section: 4.7] 31.Find the percent overshoo t, settling time, rise time, and peak time for T s¬Ü¬à14:65 s2¬á0:842s¬á2:93¬Ü s¬á5¬Ü [Section: 4.7] 32.For each of the three unit step responses shown inFigure P4.10, Ô¨Ånd the transfer function of the system. [Sections: 4.3, 4.6] 0.05 0 0.1 0.15 0.2 0.25 Time (seconds)Response (a)0123 FIGURE P4.10 (Ô¨Ågure continues )212 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:48 1 02 3 4 50510152025 Time (seconds)Response (b) 5 01 0 1 5 2 0 2 5 Time (seconds)Response (c)0.2 00.40.60.81.01.21.4 FIGURE P4.10 (Continued ) 33.For the following response functions, determine if pole- zero cancellation can be approximated. If it can, Ô¨Ånd percent overshoot, settling time, rise time, and peak time. [Section: 4.8]. a.C s¬Ü¬à s¬á4¬Ü s s¬á2¬Ü s2¬á3s¬á10¬Ü b.C s¬Ü¬à s¬á2:5¬Ü s s¬á2¬Ü s2¬á4s¬á20¬Ü c.C s¬Ü¬à s¬á2:2¬Ü s s¬á2¬Ü s2¬ás¬á5¬Ü d.C s¬Ü¬à s¬á2:01¬Ü s s¬á2¬Ü s2¬á5s¬á20¬Ü 34.Using MATLAB, plot the time response of Problem 33 aand from the plot determine percent overshoot, settling time, rise time, and peak time.[Section: 4.8] 35.Find peak time, settling time, and percent overshoot foronly those responses below that can be approximated as second-order responses. [Section: 4.8]a.c t¬Ü¬à0:003500  0:001524 e  4t  0:001976 e 3tcos 22:16t¬Ü  0:0005427 e 3tsin 22:16t¬Ü b.c t¬Ü¬à0:05100  0:007353 e 8t  0:007647 e 6tcos 8t¬Ü  0:01309 e 6tsin 8t¬Ü c.c t¬Ü¬à0:009804  0:0001857 e 5:1t  0:009990 e 2tcos 9:796t¬Ü  0:001942 e 2tsin 9:796t¬Ü d.c t¬Ü¬à0:007000  0:001667 e 10t  0:008667 e 2tcos 9:951t¬Ü  0:0008040 e 2tsin 9:951t¬Ü 36.For each of the following transfer functions with zeros, Ô¨Ånd the component parts of the unit step response:(1) the derivative of the response without a zero and (2) the response without a zero, scaled to the negative of the zero value. Also, Ô¨Ånd and plot the total response. Describe any nonminimum-phase behavior. [Section: 4.8] a.G s¬Ü¬às¬á2 s2¬á3s¬á36 b.G s¬Ü¬às 2 s2¬á3s¬á36 37.Use MATLAB ‚Äôs Simulink to obtain the step response of a system, G s¬Ü¬à1 s2¬á3s¬á10 under the following conditions: [Sec-tion: 4.9] a.The system is linear and driven by anampli Ô¨Åer whose gain is 10. b.An ampli Ô¨Åer whose gain is 10 drives the system. The ampli Ô¨Åer saturates at 0:25 volts. Describe the effect of the saturation on the system‚Äô s output. c.An ampli Ô¨Åer whose gain is 10 drives the system. The ampli Ô¨Åer saturates at 0:25 volts. The system drives a 1:1 gear train that has backlash. The dead-band width of the backlash is 0.02 rad.Describe the effect of saturation andbacklash on the system ‚Äôs output. A system is represented by the state and output equations that follow. Without solving the state equation, Ô¨Ånd the poles of the system. [Section: 4.10] (Problem continues )Problems 213WEBC04 10/28/2014 16:58:49 (Continued ) _x¬à 13  4 2"# x¬á3 1"# u t¬Ü y¬à51/C2/C3 x 39.A system is represented by the state and output equations that follow. Withoutsolving the state equation, Ô¨Ånd [Section: 4.10] a.the characteristic equation; b.the poles of the system _x¬à023 0651422 6643 775x¬á0 112 6643 775u t¬Ü y¬à¬â120 ¬äx Given the following state-space representation of a system, Ô¨ÅndY(s): [Section: 4.10] _x¬à12  3 1"# x¬á1 1"# sin 3t y¬à12/C2/C3 x;x 0¬Ü¬à3 1"# 41.Given the following system represented in state space, solve for Y(s) using the Laplace transform method for solution of the stateequation: [Section: 4.10] _x¬à010  2  41 00  62 6643 775x¬á0 012 6643 775e  t y¬à001/C2/C3 x;x 0¬Ü¬à0 002 6643 775 Solve the following state equation and output equation for y(t), where u(t) is the unit step. Use the Laplace transform method. [Section: 4.10] _x¬à 30  1 1"# x¬á2 1"# u t¬Ü y¬à10/C2/C3 x;x 0¬Ü¬à2 0/C20/C21 43.Solve for y(t) for the following system represented in state space, where u(t) is the unit step. Use theLaplace transform approach to solve the state equation. [Section: 4.10] _x¬à 310 0 61 00  52 6643 775x¬á0 112 6643 775u t¬Ü y¬à011/C2/C3 x;x 0¬Ü¬à0 002 66643 7775 Use MATLAB to plot the step response of Problem 43. [Section: 4.10] 45.Repeat Problem 43 usingMATLAB ‚Äôs Symbolic Math Toolbox and Eq. (4.96). In addition, runyour program with an initial condition, x 0¬Ü¬à1 102 435:¬âSection : 4 :10¬ä Using classical (not Laplace) methods only, solve for the state-transition matrix, the statevector, and the output of the system represented here.[Section: 4.11] _x¬à01  1  5"# x;y¬à12/C2/C3 x; x 0¬Ü¬à1 0"# Using classical (not Laplace) methods only, solve for the state-transition matrix, the statevector, and the output of the system represented here,where u(t) is the unit step: [Section: 4.11] _x¬à01  10"# x¬á0 1"# u t¬Ü y¬à34/C2/C3 x;x 0¬Ü¬à00"# Solve for y(t)f o rt h ef o l l o w i n gs y s t e m represented in state space, where u(t)i s214 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:50 the unit step. Use the classical approach to solve the state equation. [Section: 4.11] _x¬à 210 001 0 6  12 6643 775x¬á1 0 02 6643 775u t¬Ü y¬à100/C2/C3 x;x 0¬Ü¬à0 002 66643 7775 Repeat Problem 48 using MATLAB‚Äô s Symbolic Math Toolbox and Eq.(4.109) . In addition, run your programwith an initial condition, x 0¬Ü¬à1 1 02 435:¬âSection : 4 :11¬ä Using methods described in Appendix H.1 located at www.wiley.com/college/nise , simulate the following system and plot the stepresponse. Verify the expected values of percent over-shoot, peak time, and settling time. T s¬Ü¬à 1 s2¬á0:8s¬á1 51.Use MATLAB to simulate thefollowing system and plot theoutput, y(t), for a step input. Mark on the plot the steady-state value, percent overshoot, and the rise time, peak time, and settling time._x¬à010  12  81 00  22 643 75x¬á0 012 643 75u t¬Ü y t¬Ü¬à 11 0/C2/C3 x;x 0¬Ü¬à0 0 02 643 75 52.Ahuman responds to a visual cue with a physical re sponse, as shown in Figure P 4.11. The transfer function that relates the output physical response, P(s), to the input visual command, V(s), is ( Stefani ,1973 ). G s¬Ü¬àP s¬Ü V s¬Ü¬à s¬á0:5¬Ü s¬á2¬Ü s¬á5¬Ü Do the following: a.Evaluate the output response for a unit step input using the Laplace transform. b.Represent the transfer function in statespace. c. Use MATLAB to simulate thesystem and obtain a plot ofthe step response. 53.Upper motor neuron disorder patients can bene Ô¨Åta n d regain useful function through the use of functionalneuroprostheses. The design requires a good under-standing of muscle dynamics. In an experiment todetermine muscle responses, the identi Ô¨Åed transfer function was ( Zhou ,1995) M s¬Ü¬à 2:5e 0:008s 1¬á0:172s¬Ü 1¬á0:008s¬Ü 1¬á0:07s¬Ü2 1¬á0:05s¬Ü2 Find the unit step response of this transfer function. Step 1: Li ght source on Ste p 2: Reco gnize li ght source Ste p 3: Res pond to li ght sourceP(t) FIGURE P4.11 Steps in determining the transfer function relating output physical response to the input visual commandProblems 215WEBC04 10/28/2014 16:58:50 54.When electrodes are attached to the mastoid bones (right behind the ears) and current pulses are applied, a person will sway forward and backward. It has been foundthat the transfer function from the current to thesubject ‚Äôs angle (in degrees) with respect to the vertical is given by ( Nashner ,1974 ) Œ∏ s¬Ü I s¬Ü¬à5:8 0:3s¬á1¬Üe 0:1s s¬á1¬Ü s2=1:22¬á0:6s=1:2¬á1¬Ü a.Determine whether a dominant pole approximationcan be applied to this transfer function. b.Find the body sway caused by a 250 ŒºA pulse of 150 msec duration. 55.A MOEMS (optical MEMS) is a MEMS (MicroElectromechanical Systems) with an optical Ô¨Åber channel that takes light generated from a laser diode.It also has a photodetector that measures light intensityvariations and outputs voltage variations proportionalto small mechanical device de Ô¨Çections. Additionally, a voltage input is capable of de Ô¨Çecting the device. The apparatus can be used as an optical switch or as a variable optical attenuator, and it does not exceed 2000 Œºm in any dimension. Figure P4.12 shows input-output signal pairs used to identify the parametersof the system. Assume a second-order transfer functionandÔ¨Ånd the system ‚Äôs transfer function ( Borovic ,2005).Open-Loop Responses 10 8 6 4 2 0‚Äì2V olt.x[nm]: V[V]Open-Loop Response (simulated, d = 0.8) 0 500 1000 1500t[us]Open-Loop Response(experimental) FIGURE P4.129 56.The response of the de Ô¨Çection of a Ô¨Çuid- Ô¨Ålled catheter to changes in pressure can be modeled using a second-order model. Knowledge of the parameters of the model isimportant because in cardiovascular applications theundamped natural frequency should be close to Ô¨Åve times the heart rate. However, due to sterility and otherconsiderations, measurement of the parameters isdifÔ¨Åcult. A method to obtain transfer functions using measurementsoftheamplitudesoftwoconsecutivepeaksof the response and their timing has been developed(Glantz ,1979 ). Assume that Figure P4.13 is obtained from catheter measurements. Using the informationshown and assuming a second-order model excited by a unit step input, Ô¨Ånd the corresponding transfer function. System: T Time (sec): 0.0505 Amplitude: 1.15Step Response Time (sec)Amplitude 0 0.05 0.1 0.1500.20.40.60.811.21.41.6 System: TTime (sec): 0.0674 Amplitude: 0.923 FIGURE P4.13 9Borovic B., Liu A.Q., Popa D., Lewis F.L. Open-loop versus closed-loop control of MEMS devices: choices and issues J. Micromech. Microeng . Vol. 15, 2005. Figure 4, p. 1919.216 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:50 57.Several factors affect the workings of the kidneys. For example, Figure P4.14 shows how a step change in arterial Ô¨Çow pressure affects renal blood Ô¨Çow in rats. In the‚Äúhot tail ‚Äùpart of the experiment, peripheral thermal receptor stimulation is achieved by inserting the rat‚Äô s tail in heated water. Variations between different test subjectsare indicated by the vertical lines. It has been argued thatthe‚Äúcontrol ‚Äùand‚Äúhot tail ‚Äùresponses are identical except for their steady-state values ( DiBona ,2005 ). a.Using Figure P4.14, obtain the normalized C final¬à1¬Ü transfer functions for both responses. b.Use MATLAB to prove or disprovethe assertion about the‚Äúcontrol ‚Äùand‚Äúhot tail ‚Äùresponses. HOT TAIL CONTROL Time (sec)0.030 0.0250.0200.0150.0100.0050.000Step response ‚Äì1 0 1 2 3 4 5 6 FIGURE P4.1410 58.The transfer function of a nano-positioning device capable of translating biological samples within a fewŒºm uses a piezoelectric actuator and a linear variable differential transformer (LDVT) as a displacement sensor.The transfer function from input to displacement has beenfound to be (Salapaka ,2002) G s¬Ü¬à9:7104 s2 14400 s¬á106:6106¬Ü s2¬á3800 s¬á23:86106¬Ü s2¬á240s¬á2324 :8103¬Ü Use a dominant-pole argument to Ô¨Ånd an equivalent transfer function with the same numerator but only threepoles. Use MATLAB to Ô¨Ånd the actual size and approximate systemunit step responses, plottingthem on the same graph. Explain the differences between both responses given that both pairs of poles are so far apart.59.Atsomepoint intheir livesmost peoplewillsufferfrom at least one onset of low back pain. This disorder can trigger excruciating pain and temporary disability, but its causesare hard to diagnose. It is well known that low back painalters motor trunk patterns; thus it is of interest to studythe causes for these alterations and their extent. Due to thedifferent possible causes of this type of pain, a ‚Äúcontrol ‚Äù group of people is hard to obtain for laboratory studies.However, pain can be stimulated in healthy people and muscle movement ranges can be compared. Controlled back pain can be induced by injecting saline solutiondirectly into related muscles or ligaments. The transferfunction from infusion rate to pain response wasobtained experimentally by injecting a 5% saline solutionat six different infusion rates over a period of 12 minutes.Subjects verbally rated their pain every 15 seconds on ascale from 0 to 10, with 0 indicating no pain and 10 unbearable pain. Several trials were averaged and the data was Ô¨Åtted to the following transfer function: G s¬Ü¬à 9:7210 8 s¬á0:0001 ¬Ü s¬á0:009¬Ü2 s2¬á0:018s¬á0:0001 ¬Ü For experimentation, it is desired to build an automaticdispensing system to make the pain level constant asshown in Figure P4.15. It follows that ideally the injection system transfer function has to be M s¬Ü¬à 1 G s¬Ü to obtain an overall transfer function M s¬ÜG s¬Ü‚âà1. However, for implementation purposes M(s)m u s t have at least one more pole than zeros ( Zedka ,1999 ). Find a suitable transfer function, M(s) by inverting G(s) and adding poles that are far from the imaginary axis. ()GsConstant infusion rate Constant back painHuman Response Infusion Pump ()Ms FIGURE P4.15 60.An arti Ô¨Åcial heart works in closed loop by varying its pumping rate according to changes in signals from the recipient ‚Äôs nervous system. For feedback compensation design it is important to know the heart ‚Äôs open-loop transfer function. To identify this transfer function, an artiÔ¨Å cial heart is implanted in a calf while the main parts of theoriginal heart are left in place. Then the atrial pumping ratein the original heart is measured while step input changes are effected on the arti Ô¨Åcial heart. It has been found that, in general, the obtained response closely resembles that of a second-order system. In one such experiment it wasfound that the step response has a %OS =30% and a time of Ô¨Årst peak T p¬à127 sec ( Nakamura ,2002 ). Find the corresponding transfer function.10DiBona, G.F. Physiology in perspective: The Wisdom of the Body. Neural control of the kidney. Am. J. Physiol. Regul. Integr. Comp. Physiol Vol. 289, 2005. Fig. 6, p. R639. Used with permission.Problems 217WEBC04 10/28/2014 16:58:51 61.An observed transfer function from voltage potential to force in skeletal muscles is given by ( Ionescu ,2005 ) T s¬Ü¬à450 s¬á5¬Ü s¬á20¬Ü a.Obtain the system ‚Äôs impulse response. b.Integrate the impulse response to Ô¨Ånd the step response. c.Verify the result in Part bby obtaining the step response using Laplace transform techniques. 62.In typical conventional aircraft, longitudinal Ô¨Çight model linearization results in transfer functions with two pairs of complex conjugate poles. Consequently,the natural response for these airplanes has two modesin their natural response. The ‚Äúshort period ‚Äùmode is relatively well-damped and has a high-frequency oscilla-tion. The ‚Äúplugoid mode ‚Äùis lightly damped and its oscillation frequency is relatively low. For example, inas p e c i Ô¨Åc aircraft the transfer function from wing elevator deÔ¨Çection to nose angle (angle of attack) is (McRuer ,1973) Œ∏ s¬Ü Œ¥e s¬Ü¬à  26:12 s¬á0:0098 ¬Ü s¬á1:371¬Ü s2¬á8:9910 3s¬á3:9710 3¬Ü s2¬á4:21s¬á18:23¬Ü a.Find which of the poles correspond to the shortperiod mode and which to the phugoid mode. b.Peform a ‚Äúphugoid approximation ‚Äù(dominant-pole approximation), retaining the two poles and the zeroclosest to the; œâ-axis. c. Use MATLAB to compare the stepresponses of the original transfer function and the approximation. A crosslapper is a machine that takes as an input a light Ô¨Åber fabric and produces a heavier fabric bylaying the original fabric in layersrotated by 90 degrees. A feedbacksystem is required in order to maintain consistent product width and thickness by controlling its carriage velocity.The transfer function from servomotortorque, T m(s), to carriage velocity, Y(s) , was developed for such a machine (Kuo, 2008 ). Assume that the transfer function is: G s¬Ü¬àY s¬Ü Tm s¬Ü ¬à33s4¬á202s3¬á10061 s2¬á24332 s¬á170704 s7¬á8s6¬á464s5¬á2411 s4¬á52899 s3¬á167829 s2¬á913599 s¬á1076555 a.Use MATLAB to Ô¨Ånd the partial fraction residues and poles of G(s).b.Find an approximation to G(s)b y neglecting the second-order termsfound in a. c.Use MATLAB to plot on one graph thestep response of the transfer functiongiven above and the approximationfound in b.Explain the differences between the two plots. Although the use of fractional calculus in control systems isnot new, in the last decade there isincreased interest in its use forseveral reasons. The most relevant arethat fractional calculus differentialequations may model certain systemswith higher accuracy than integer differential equations, and that fractional calculus compensators mightexhibit advantageous properties forcontrol system design. An example of atransfer function obtained throughfractional calculus is: G s¬Ü¬à 1 s2:5¬á4s1:7¬á3s0:5¬á5 This function can be approximated withan integer rational transfer function(integer powers of s) using Oustaloup ‚Äôs method ( Xue, 2005 ). We ask you now to do a little research and consult the afore-mentioned reference to Ô¨Ånd and run an M-Ô¨Åle that will calculate the integer rational transfer function approxima- tion to G(s) and plot its step response. 65.Mathematical modeling and control of pH processes are quite challenging since the processes are highlynonlinear, due to the logarithmic relationship betweenthe concentration of hydrogen ions [H +] and pH level. The transfer function from input pH to output pH is G a s¬Ü¬àYa s¬Ü Ya s¬Ü¬à14:49e 3:3s 1478 :26s¬á1, where we assumea delay of 3.3 seconds. Ga s¬Üis a model for the anaerobic process in a wastewater treatment system in which methane bacteria need the pH to be maintained in its optimal range from 6.8 to 7.2 ( Jiayu, 2009 ). Similarly, ( Elara Ô¨Å,2008) used empirical techniques to model a pH neutralization plant as a second-order system with a pure delay, yieldingthe following transfer function relating output pH toinput pH: G p s¬Ü¬àYp s¬Ü Xp s¬Ü¬à1:71610 5e 25s s2¬á6:98910 3s¬á1:18510 6 where we assume a delay of 25 seconds.218 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:52 a.Find analytical expressions for the unit-step responses ya(t) and yp(t) for the two processes, Ga(s) and Gp(s). (Hint: Use the time shift theorem in Table 2.2). b.Use Simulink to plot ya(t) and yp(t) on a single graph. 66.Using wind tunnel tests, insect Ô¨Çight dynamics can be studied in a very similar fashion to that of man-made aircraft. Linearized longitudinal Ô¨Çight equations for a bumblebee have been found in the unforced case to be _u _w _q _Œ∏2 666643 77775¬à 8:79210  30:5610 3 1:010 3 13:7910 3  0:34710 3 11:710 3 0:34710 30 0:261  20:810 3 96:610 30 001 02 666643 77775u w q Œ∏2 666643 77775 where u=forward velocity; w=vertical velocity, q= a n g u l a rp i t c hr a t ea tc e n t e ro fm a s s ,a n d Œ∏¬àpitch angle between the Ô¨Çight direction and the horizontal ( Sun,2005 ). a.Use MATLAB to obtain the system ‚Äôs eigenvalues. b.Write the general form of thestate-transition matrix. How manyconstants would have to be found? A dc-dc converter is a device that takes as aninput an unregulated dc voltage and provides a regulated dc voltage as its output. The output voltage may be lower (buck converter), higher (boost converter),or the same as the input voltage. Switching dc-dcconverters have a semiconductor active switch (BJT orFET) that is closed periodically with a duty cycle din a pulse width modulated (PWM) manner. For a boostconverter, averaging techniques can be used to arriveat the following state equations ( Van Dijk ,1995 ): L diL dt¬à  1 d¬Üuc¬áEs CduC dt¬à 1 d¬ÜiL uC R where LandCare, respectively, the values of internal inductance and capacitance; iLis the current through the internal inductor; Ris the resistive load connected to the converter; Esis the dc input voltage; and the capacitor voltage, uC, is the converter ‚Äôs output. a.Write the converter ‚Äôs equations in the form _x¬àAx¬áBu y¬àCx assuming dis a constant. b.Using the A,B, and Cmatrices of Part a, obtain the converter ‚Äôs transfer functionUC s¬Ü Es s¬Ü: 68.An IPMC (ionic polymer-metal composite)is a Na Ô¨Åon sheet plated with gold on both sides. An IPMC bends when an electric Ô¨Åeld is appliedacross its thickness. IPMCs have been used as robotic actuators in several applications and as active catheters in biomedical applications. With the aim of improvingactuator settling times, a state-space model has beendeveloped for a 20 mm 10 mm 0:2 mm polymer sample ( Mallavarapu ,2001 ): _x 1 _x2"# ¬à 8:34  2:26 10"# x1 x2"# ¬á1 0"# u y¬à12:54 2 :26/C2/C3 x1 x2"# where uis the applied input voltage and yis the de Ô¨Çection at one of the material ‚Äôs tips when the sample is tested in a cantilever arrangement. a.Find the state-transition matrix for the system. b.From Eq. (4.109) in the text, it follows that if a system has zero initial conditions, the system output for anyinput can be directly calculated from the state-spacerepresentation and the state-transition matrix using y t¬Ü¬àCx t¬Ü¬àZ CŒ¶ t œÑ¬ÜBu œÑ¬ÜdœÑ Use this equation to Ô¨Ånd the zero initial condition unit step response of the IPMC material sample. c. Use MATLAB to verify that yourstep response calculation inPart b is correct. 69.Figure P4.16 shows the step response of an electricvehicle ‚Äôs mechanical brakes when the input is the drive torque (N-m) and the output is the hydraulic brakepressure (bar) ( Ringdorfer, 2011 ). 40600 0200400 Traction motor drive torque TEM [Nm] 20 0 0.8 0.9 1 .1 1 .2 t [s]Hydraulic brake pressure p (bar) 3 1. 4 1. 5 1. 6 1 FIGURE P4.16 Step response of an electric vehicle ‚Äôs mechanical brake11 11Ringdorfer M., and Horn M. Development of a Wheel Slip Actuator Controller for Electric Vehicles using Energy Recuperation and Hydraulic Brake Control, 2011 IEEE International Conference on Control Applica- tions (CCA) , Denver, CO, USA. September 28 ‚Äì30, 2011, pp. 313 ‚Äì318. Figure 4, p. 315. Modelling Symposium (AMS), 2012 Sixth Asia by IEEE. Reproduced with permission of IEEE in the format Republish in a book via Copyright Clearance Center.Problems 219WEBC04 10/28/2014 16:58:52 a.Find the transfer function of the system. b.Use the values of the parameters for the transfer function obtained in Part atoÔ¨Ånd an expression for the brake pressure as a function of time. c.Find the output in bars of the system 0.2 sec after the input is applied. Check your result against Figure P4.16. 70.Figure P4.17 shows the free-body diagrams for planetarygear components used in the variable valve timing (VVT)system of an internal combustion engine ( Ren,2011 ). Here an electric motor is used to drive the carrier. Analysisshowed that the electric motor with planetary gearload (Figure P4.17) may be represented by the followingequation: Œ© c s¬Ü¬àGe s¬ÜEa s¬Ü¬áGm s¬ÜTcam s¬Ü where Œ©c s¬Üis the output carrier angular speed in rad/s, Ea(s) is the input voltage applied to the armature, and Tcam s¬Üis the input load torque. The voltage input transfer function, Ge(s), is Ge s¬Ü‚âÖKœÑ Rm Js¬áD¬Ü¬áKœÑKm¬à45 0:2s¬á1 and the load torque input transfer function, Gm(s), is Gm s¬Ü‚âÖ Rmk Rm Js¬áD¬Ü¬áKœÑKm¬à 5 0:2s¬á1 Find an analytical expression for the output carrier angular speed, œâc t¬Ü,i fas t e pv o l t a g eo f1 0 0v o l t si s applied at t=0 followed by an equivalent load torque of 10 N-m, applied at t=0.4 sec. 23rp Tcam TloadF34 F13 F23F32 F43Œ∏=20¬∞ Œ∏Œ∏Œ± Œ±œâr œâpœâs œâcrp rs1 (a) Planetary System (b) Sun Gear 4 (d) Carrier 2 (c) Planet Gear 34 FIGURE P4.17 Free-body diagrams of planetary gear system components1271.A drive system with elastically coupled load (Figure P4.18) has a motor that is connected to the load via a gearbox and a long shaft. The system parameters are: JM=drive-side inertia = 0.0338 kg-m2,JL=load-side inertia =0.1287 kg-m2, K=CT=torsional spring constant =1700 N-m/rad, and D=damping coef Ô¨Åcient=0.15 N-m-s/rad. This system can be reduced to a simple two- inertia model that may be represented by the following transfer function, relating motor shaft speed output, Œ© s¬Ü, to electromagnetic torque input ( Thomsen, 2011 ): G s¬Ü¬àŒ© s¬Ü Tem s¬Ü¬à1 s JM¬áJL¬ÜJL CTs2¬áD CTs¬á1 JMJL CT JM¬áJL¬Üs2¬áD CTs¬á1 Assume the system is at standstill att=0, when the electromagnetic torque, Tem, developed by the motor changes from zero to 50 N-m. Find and ploton one graph, using MATLAB or any otherprogram, the motor shaft speed, œâ t¬Ü, rad/sec, for the following two cases: a.No load torque is applied and, thus,œâ¬àœâ nl. b.A load torque, TL¬à0:2œâ t¬ÜN-m is applied and œâ¬àœâL. Drive motorGear box Speed signalInertia Load Torsional driveshaftStator currents SM FIGURE P4.18 Partial topology of a typical motor drive system13 72.An inverted pendulum mounted on a motor-driven cartwas presented in Problem 30 of Chapter 3. The nonlinearstate-space equations representing that system werelinearized (Prasad, 2012) around a stationary point corresponding to the pendulum point-mass, m, being in the upright position x 0¬à0a t t=0), when the force 12Ren Z., and Zhu G. G. Modeling and Control of an Electric Variable Valve Timing System for SI and HCCI Combustion Mode Transition. American Control Conference , San Francisco, CA, 2011, pp. 979 ‚Äì984. Figure 2, p. 980. Reproduced with permission of IEEE in the formatRepublish in a book via Copyright Clearance Center.13Thomsen, S., Hoffmann, N., and Fuchs, F. W. PI Control, PI-Based State Space Control, and Model-Based Predictive Control for DriveSystems With Elastically Coupled Loads ‚ÄîA Comparative Study. IEEE Transactions On Industrial Electronics , Vol. 58, No. 8, August 2011, pp. 3647 ‚Äì3657. Portion of Figure 1, p. 3648. American Control Conference (ACC), 2011 by IEEE. Reproduced with permission of IEEE in the formatRepublish in a book via Copyright Clearance Center.220 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:53 applied to the cart was zero ( u0¬à0). The state-space model developed in that problem is _x¬àAx¬áBu The state variables are the pendulum angle relative to the y-axis, Œ∏, its angular speed, Œ∏¬¥, the horizontal position of the cart, x, and its speed, x¬¥. The horizontal position ofm(for a small angle, Œ∏),xm¬àx¬álsinŒ∏¬àx¬álŒ∏, was selected to be the output variable. Given the state-space model developed in that problem alongwith the output equation you developed inthat problem, use MATLAB (or any other com- puter program) to Ô¨Ånd and plot the output, x m(t) , in meters, for an input force, u(t), equal to a unit impulse, Œ¥(t),in Newtons.14 DESIGN PROBLEMSDESIGN PROBLEMS 73.Find an equation that relates 2% settling time to the value of fvfor the translational mechanical system shown in Figure P4.19. Neglect the mass of all compo- nents. [Section: 4.6] fv 2 N/mf(t) FIGURE P4.19 74.Consider the translational mechanical system shown in Figure P4.20. A 1-pound force, f(t), is applied at t¬à0. Iffv¬à1,Ô¨ÅndKandMsuch that the response is character- ized by a 4-second settling time and a 1-second peak time. Also, what is the resulting percent overshoot? [Section: 4.6] fv Kf(t)x(t) M FIGURE P4.20 75.Given the translational mechanical system of Figure P4.20, where K¬à1 and f(t) is a unit step, Ô¨Ånd the values ofMandfvto yield a response with 17% overshoot and a settling time of 10 seconds. [Section: 4.6] 76.Find Jand Kin the rotational system shown in Figure P4.21 to yield a 30% overshoot and a settlingtime of 3 seconds for a step input in torque. [Section: 4.6] 1 KT(t) J FIGURE P4.2177.Given the system shown in Figure P4.22, Ô¨Ånd the damping, D, to yield a 30% overshoot in output angular displacement for a step input in torque. [Section: 4.6] DŒ∏ 2T(t) 1 N2 = 5N1 = 25 N4 = 5N3 = 10 1 4N-m/rad1 kg-m (t) FIGURE P4.22 78.For the system shown in Figure P4.23, Ô¨Ånd N1=N2so that the settling time for a step torque input is 16 seconds. [Section: 4.6] T(t) 1 N-m/rad 1 N-m-s/rad 1 kg-m2N1 N2 1 kg-m2 FIGURE P4.23 79.Find MandK, shown in the system of Figure P4.24, to yield x(t)with16%overshootand20secondssettlingtime for a step input in motor torque, Tm t¬Ü. [Section: 4.6] For the motor: Ja= 1 kg -m2 Da= 1 N-m-s/rad Ra=1 Œ© Kb= 1 V-s/rad Kt= 1 N-m/AN2 = 20N1 = 10 K J = 1 kg-m2 Ideal gear 1:1 fv = 1 N-s/mM x(t)MotorTm(t) Radius = 2 m FIGURE P4.24 80.Ifvi t¬Üis a step voltage in the network shown in Figure P4.25, Ô¨Ånd the value of the resistor such that a 20% overshoot in voltage will be seen across the capacitor if C¬à10 6F and L¬à1 H. [Section: 4.6] R CL +‚Äì vi(t) FIGURE P4.2514Hint: Use the command ‚Äúimpulseplot ‚Äùover a time period from 0 to 11.0 seconds with a step of 0.1 seconds.Problems 221WEBC04 10/28/2014 16:58:53 81.Ifvi t¬Üis a step voltage in the network shown in Figure P4.25, Ô¨Ånd the values of RandCto yield a 20% overshoot and a 1 ms settling time for vc t¬ÜifL¬à1H . [Section: 4.6] 82.Given the circuit of Figure P 4.25, where C¬à10ŒºF,Ô¨Ånd RandLto yield 15% overshoot with a settling time of 7msforthecapacitorvoltage.Theinput, v(t),isaunitstep. [Section: 4.6] 83.For the circuit shown in Figure P4.26, Ô¨Ånd the values of R2andCto yield 8% overshoot with a settling time of 1 ms for the voltage across the capacitor, with vi t¬Üas a step input. [Section: 4.6] 1 H + + ‚Äì‚ÄìR2 1 MŒ© vi(t) vc(t) C FIGURE P4.26 PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 84.Control of HIV/AIDS . In Chapter 3, Problem 31, we developed a linearized state-space model of HIV infection. The model assumedthat two different drugs were used to combat the spread ofthe HIV virus. Since this book focuses on single-input,single-output systems, only one of the two drugs will be considered. We will assume that only RTIs are used as an input. Thus, in the equations of Chapter 3, Problem 31,u 2¬à0(Craig, 2004 ). a.Show that when using only RTIs in the linearizedsystem of Problem 31, Chapter 3, and substitutingthe typical parameter values given in the table ofProblem 31 c, Chapter 3, the resulting state-space representation for the system is given by _T _T * _v2 6643 775¬à 0:04167 0  0:0058 0:0217  0:24 0 :0058 0 100  2:42 643 75 T T* v2 643 75¬á5:2  5:2 02 643 75u1 y¬à001/C2/C3T T* v2 643 75 b.Obtain the transfer function from RTI ef Ô¨Åciency to virus count; namely, Ô¨ÅndY s¬Ü U1 s¬Ü.c.Assuming RTIs are 100% effective, what will be the steady-state change of virus count in a given infected patient? Express your answer in virus copies per mlof plasma. Approximately how much time will themedicine take to reach its maximum possibleeffectiveness? 85.Hybrid vehicle. Assume that the car motive dynamics for a hybrid electric vehicle (HEV) can be described bythe transfer function ŒîV s¬Ü ŒîFe s¬Ü¬à1 1908 s¬á10 where AVis the change of velocity in m/sec and ŒîFeis the change in excess motive force in Nnecessary to propel the vehicle. a.Find an analytical expression for Œîv(t)for a step change in excess motive force ŒîFe=2650 N. b.Simulate the system usingMATLAB. Plot the expressionfound in Part atogether with your simulated plot. 86.Parabolic trough collector. Figure P4.27 illustrates the results of an open-loop step-response experimentperformed on a parabolic trough collector setup(Camacho, 2012 ). In this experiment, the Ô¨Çuid Ô¨Çow on the system is suddenly decreased 1 liter/sec at t=0 hours, resulting in a temperature increase as shown inFigure P4.27. Use the Ô¨Ågure to Ô¨Ånd an approximate transfer function for the system. (Note: Since no furtherinformation is given on the system dynamics and due tovisual approximations, several solutions are possible.) 8 7 6 5 4 3 2 1 00 0.02 0.04 0.06 0.08 0.1 0.12 0.14 Time (hours)Outlet Oil Temperature Change (C) FIGURE P4.27222 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:54 Cyber Exploration Laboratory Experiment 4.1 Objective To evaluate the effect of pole and zero location upon the time response of Ô¨Årst- and second-order systems. Minimum Required Software Packages MATLAB, Simulink, and the Control System Toolbox Prelab 1.Given the transfer function G s¬Ü¬àa s¬áa, evaluate settling time and rise time for the following values of a: 1, 2, 3, 4. Also, plot the poles. 2.Given the transfer function G s¬Ü¬àb s2¬áas¬áb: a.Evaluate percent overshoot, settling time, peak time, and rise time for the following values: a¬à4;b¬à25. Also, plot the poles. b.Calculate the values of aandbso that the imaginary part of the poles remains the same but the real part is increased two times over that of Prelab 2 a, and repeat Prelab 2a . c.Calculate the values of aandbso that the imaginary part of the poles remains the same but the real part is decreased by one half over that of Prelab 2 a, and repeat Prelab 2a . a. For the system of Prelab 2a , calculate the values of aandbso that the real part of the poles remains the same but the imaginary part is increased two times over that of Prelab 2a , and repeat Prelab 2 a. b.For the system of Prelab 2a , calculate the values of aandbso that the real part of the poles remains the same but the imaginary part is increased four times over that ofPrelab 2a , and repeat Prelab 2 a. a. For the system of Prelab 2 a, calculate the values of aandbso that the damping ratio remains the same but the natural frequency is increased two times over that of Prelab2a, and repeat Prelab 2 a. b.For the system of Prelab 2 a, calculate the values of aandbso that the damping ratio remains the same but the natural frequency is increased four times over that of Prelab2a, and repeat Prelab 2 a. 5.BrieÔ¨Çy describe the effects on the time response as the poles are changed in each of Prelabs 2, 3, and 4. Lab 1.Using Simulink, set up the systems of Prelab 1 and plot the step response of each of thefour transfer functions on a single graph by using the Simulink LTI Viewer (See Appendix E.6 online for tutorial). Also, record the values of settling time and rise time for each step response. 2.Using Simulink, set up the systems of Prelab 2 . Using the Simulink LTI Viewer, plot thestep response of each of the three transfer functions on a single graph. Also, record thevalues of percent overshoot, settling time, peak time, and rise time for each step response. 3.Using Simulink, set up the systems of Prelab 2a and Prelab 3. Using the Simulink LTI Viewer, plot the step response of each of the three transfer functions on a single graph.Also, record the values of percent overshoot, settling time, peak time, and rise time foreach step response.Cyber Exploration Laboratory 223WEBC04 10/28/2014 16:58:54 4.Using Simulink, set up the systems of Prelab 2a and Prelab 4. Using the Simulink LTI Viewer, plot the step response of each of the three transfer functions on a single graph. Also, record the values of percent overshoot, settling time, peak time, and rise time foreach step response. Postlab 1.For the Ô¨Årst-order systems, make a table of calculated and experimental values of settling time, rise time, and pole location. 2.For the second-order systems of Prelab 2, make a table of calculated and exper-imental values of percent overshoot, se ttling time, peak time, rise time, and pole location. 3.For the second-order systems of Prelab 2 aand Prelab 3, make a table of calculated and experimental values of percent overshoot, settling time, peak time, rise time, and polelocation. 4.For the second-order systems of Prelab 2 aand Prelab 4, make a table of calculated and experimental values of percent overshoot, settling time, peak time, rise time, and polelocation. 5.Discuss the effects of pole location upon the time response for both Ô¨Årst- and second- order systems. Discuss any discrepancies between your calculated and experimentalvalues. Experiment 4.2 Objective To evaluate the effect of additional poles and zeros upon the time response of second-order systems. Minimum Required Software Packages MATLAB, Simulink, and the Control System Toolbox Prelab 1.a.Given the transfer function G s¬Ü¬à25 s2¬á4s¬á25, evaluate the percent overshoot, settling time, peak time, and rise time. Also, plot the poles. b.Add a pole at  200 to the system of Prelab 1 a. Estimate whether the transient response in Prelab 1 awill be appreciably affected. c.Repeat Prelab 1b with the pole successively placed at  20; 10, and  2. 2.A zero is added to the system of Prelab 1 aat 200 and then moved to  50; 20; 10; 5, and  2. List the values of zero location in the order of the greatest to the least effect upon the pure second-order transient response. 3.Given the transfer function G s¬Ü¬à 25b=a¬Ü s¬áa¬Ü s¬áb¬Ü s2¬á4s¬á25¬Ü, let a¬à3 and b¬à3:01, 3.1, 3.3, 3.5, and 4.0. Which values of bwill have minimal effect upon the pure second-order transient response? 4.Given the transfer function G s¬Ü¬à 2500 b=a¬Ü s¬áa¬Ü s¬áb¬Ü s2¬á40s¬á2500 ¬Ü, leta¬à30 and b¬à30:01, 30.1, 30.5, 31, 35, and 40. Which values of bwill have minimal effect upon the pure second-order transient response? Lab 1.Using Simulink, add a pole to the second-order system of Prelab 1 aand plot the step responses of the system when the higher-order pole is nonexistent, at  200 ; 20; 10,224 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:54 and  2. Make your plots on a single graph, using the Simulink LTI Viewer. Normalize all plots to a steady-state value of unity. Record percent overshoot, settling time, peak time, and rise time for each response. 2.Using Simulink, add a zero to the second-order system of Prelab 1 aand plot the step responses of the system when the zero is nonexistent, at  200 ; 50; 20; 10; 5, and  2. Make your plots on a single graph, using the Simulink LTI Viewer. Normalize all plots to a steady-state value of unity. Record percent overshoot, settling time, peak time, and rise time for each response. 3.Using Simulink and the transfer function of Prelab 3 with a¬à3, plot the step responses of the system when the value of bis 3, 3.01, 3.1, 3.3, 3.5, and 4.0. Make your plots on a single graph using the Simulink LTI Viewer. Record percent overshoot, settling time, peak time, and rise time for each response. 4.Using Simulink and the transfer function of Prelab 4 with a¬à30, plot the step responses of the system when the value of bis 30, 30.01, 30.1, 30.5, 31, 35, and 40. Make your plots on a single graph, using the Simulink LTI Viewer. Record percent overshoot,settling time, peak time, and rise time for each response. Postlab 1.Discuss the effect upon the transient response of the proximity of a higher-order pole tothe dominant second-order pole pair. 2.Discuss the effect upon the transient response of the proximity of a zero to the dominantsecond-order pole pair. Explore the relationship between the length of the vector fromthe zero to the dominant pole and the zero ‚Äôs effect upon the pure second-order step response. 3.Discuss the effect of pole-zero cancellation upon the transient response of a dominant second-order pole pair. Allude to how close the canceling pole and zero should be and the relationships of (1) the distance between them and (2) the distance between the zeroand the dominant second-order poles. Experiment 4.3 Objective To use LabVIEW Control Design and Simulation Module for time performance analysis of systems. Minimum Required Software Packages LabVIEW with the Control Design and Simulation Module Prelab One of the experimental direct drive robotic arms built at the MTT Arti Ô¨Åcial Intelligence Laboratory and the CMU Robotics Institute can be represented as a feedback control system with a desired angular position input for the robot ‚Äôs joint position and an angular position output representing the actual robot ‚Äôs joint position. The forward path consists of three transfe r functions in cascade; (1) a compensator, Gcs ¬Ü, to improve performance; (2) a power ampli Ô¨Åer of gain, Ka=1; and (3) the transfer function of the motor and load, Gs ¬Ü¬à 2292 =ss¬á75:6 ¬Ü . Assume a unity-feedback system. Initially the system will be controlled with Gcs ¬Ü=0.6234, which is called a proportional controller ( McKerrow ,1991 ). 1.Obtain the closed-loop system transfer function and use MATLAB to make a plot ofthe resulting unit step response. 2.Repeat with G c s¬Ü¬à3:05¬á0:04s, which is called a PD controller. 3.Compare both responses and draw conclusions regarding their time domainspeciÔ¨Åcations.Cyber Exploration Laboratory 225WEBC04 10/28/2014 16:58:55 Lab Create a LabVIEW VI that uses a simulation loop to implement both controllers given in the Prelab. Plot the responses on the same graph for comparison purposes. Postlab Compare the responses obtained using your LabVIEW VI with those obtained in the Prelab. Experiment 4.4 Objective To use the LabVIEW Control Design and Simulation Module to evaluate the effect of pole location upon the time response of second-order systems. Minimum Required Software Packages LabVIEW with the Control Design and Simulation Module. Prelab Solve the Cyber Exploration Laboratory Experiment 4.1 Prelab, Part 2. Lab Build a LabVIEW VI to implement the functions studied in the Prelab of Cyber Exploration Laboratory 4.1, Part 2. Speci Ô¨Åcally for Prelab Part 2a , your front panel will have the coef Ô¨Åcients of the second- order transfer function as inputs. The front panel will also have the following indicators: (1) the transfer function; (2) the state-space representation; (3) the pole locations; (4) the stepresponse graph; (5) the time response of the two states on the same graph; (6) the timeresponse parametric data including rise time, peak time, settling time, percent overshoot,peak value, and Ô¨Ånal value. For Prelab, Part 2 b, your front panel will also have the following indicators: (1) the step response graph, and (2) the parametric data listed above for Prelab, Part 2 a, but speci Ô¨Åct o Part 2 b. For Prelab, Part 2c , your front panel will also have the following indicators: (1) the step response graph, and (2) the parametric data listed above for Prelab, Part 2 a, but speci Ô¨Åct o Part 2 c. Run the VI to obtain the data from the indicators. Postlab Use your results to discuss the effect of pole location upon the step response. Hardware Interface Laboratory Experiment 4.5 Open-Loop Speed Control of a Motor Objectives To control the speed of a motor in open-loop fashion and verify the functions of the motor control setup as preparation for future experiments. Material Required Computer with LabVIEW Installed; myDAQ; dc brushed gear- motor with Hall Sensor quadrature encoder ( ‚Äì10 V to +10 V normal operation range); and motor control chip BA6886N or a transistor circuit substitute. (Note: For simplicity the input to the motor will be analog. PWM will be avoided as it adds an additional layer of complexity to these experiments. Plan accordingly if you decide to substitute the motor control chip.) File Provided at www.wiley.com/college/nise Open Loop Control.vi Prelab Plan how you will wire your motor to the breadboard. A possibility is to solder a header to six matching color wires that will allow you to connect and disconnect the motorfrom the myDAQ in an ef Ô¨Åcient manner. You can also solder wires to the motor ‚Äôs cables.226 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:55 Lab Software: The front panel for the Open Loop Control VI is shown in Figure P4.28( a). The input to the system is the voltage applied to the motor. The output is the motor speed in revolutions per second (rps). The corresponding block diagram is shown inFigure P4.28( b). Note the value indicated by the blue arrow in Figure P4.28( b). In order to get a meaningful reading for the speed of the motor, this value needs to be modi Ô¨Åed depending on the gear ratio of your motor and the counts of your encoder. To understand how this value is calculated, notethat the DAQ Assistant block on top of the diagram reads the encoder input from the myDAQ.One would reasonably assume that the frequency of this signal is proportional to the speed ofthe motor, which is theoretically true. However, at very low speeds the DAQ assistant ‚Äútimes out‚Äùand fails to provide a reading if frequency is measured directly. To avoid this problem, a different method is used to calculate the signal frequency. The DAQ assistant measures therising edges of the encoder signal every 100 msec and subtracts that number from the onesaccumulated during the previous 100 msec period. The frequency of the encoder signal(in edges/msec) is found by dividing the value of this subtraction by the period (100 msec).See the Block Diagram to understand how this algorithm was implemented. We use an example to illustrate the calculation of the constant pointed to with the red arrow. If a 9.7:1 gear ratio is used with a 48 CPR encoder, with each revolution the encoder will (b) FIGURE P4.28 Open loop control.vi: a.Front Panel; b.Block DiagramHardware Interface Laboratory 227WEBC04 10/28/2014 16:58:55 generate a total of 48 edges in each of the encoder channels. Using one channel only and positive edges, there are 12 positive edges/rev of the motor shaft. The total number of counts (positive edges) generated by each revolution of the external shaft is 9.7 √ó12=116.4 positive edges/rev. In order to Ô¨Ånd the rotational speed, the frequency (edges/msec) of the signal is divided by the total number of counts generated by the external shaft, adjusting the units for time from msec to sec: Rotational Speed (rps) =Freq√ó1000/(9.7 √ó12)=Freq√ó8.591. This value has to be set as illustrated in the Block Diagram. The DAQ Assistant2 block transmits the voltage from the control slider to the myDAQ and to the motor control chip. The DAQ Assistant3 block makes sure that the output to the chip is zeroed when the VI terminates. Hardware: Connect the myDAQ, the motor, and the motor controller as shown in Figure P4.29. Procedure: 1.Verify the operation of your circuit by running the VI and changing the position of the slider. If everything is correct, the motor speed will vary as the slider ‚Äôs position changes. 2.Verify that you are using the correct scaling factor for your motor by setting yourmotor to rotate at 0.5 rps. Count the number of rotations in the shaft of the motor over 10 sec using a stopwatch. Repeat by setting the rotational speed at 1 rps. Your measurements must be consistent. MyDAQ12 34567 8 9 10BA6886N 10Œ© 9VMotor white FIGURE P4.29 Wiring diagram15 15MyDAQ right slot shown on left is taken from Multisim program module NI myDAQ design and also reproduced in White-Paper 11423, Figure 2. Both Multisim and the White Paper are from National Instruments.228 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:55 3.Perform the following measurements moving the slider: a.Increase the voltage starting at zero and record the minimum voltage for the motor to start rotating. b.Starting the slider at a rotating speed, reduce the voltage until the motor stops.Record this voltage.Are these values equal? These values are important and will be used in future labs.Keep them in a safe place so that you don ‚Äôt have to repeat these measurements again. 4.Make a graph where the x-axis is the input voltage, and the y-axis is the speed in rps. Include the results in Part 3. 5.Draw a functional block diagram of the system (similar to Chapter 1), labeling eachof the components in the diagram. 6.The circuit and the VI above allow the motor to rotate in one direction only. Modifythe VI and the circuit so that the motor direction and speed can be controlledfrom the VI. Note that the reference input to the chip can only accept positive voltage values. The motor control data sheet indicates that direction of rotation must be changed byÔ¨Çipping the logical values of Pin 2 and Pin 10 on the motor control chip. However, a careful reading of the data sheet indicates that there must be an instant of time (ofunspeci Ô¨Åed duration) in which both inputs must be False before switching direction. You may want to use a LabVIEW ring to simulate a three-way switch. Use two of theselections of the ring to control the motor ‚Äôs rotation direction. The third selection in the ring should provide low inputs to the motor controller logical inputs to be able to stopthe motor before switching direction. Experiment 4.6 Transfer Function Identi Ô¨Åcation Objective To identify the transfer function of a motor from voltage input to angular motor speed using myDAQ and LabView. Material Required Computer with LabVIEW Installed; myDAQ; dc brushed gearmotor with Hall sensor quadrature encoder ( ‚Äì10 to+10 V normal operation range); and motor control chip B6886N (or a transistor circuit substitute). File Provided at www.wiley.com/college/nise Plant Identi Ô¨Åcation 2.vi Prelab Answer the following questions: 1.What is the unit-step response of a system with transfer function G s¬Ü¬àK sœÑ¬á1, where KandœÑare constants >0? 2.Make a hand-sketch of the response of the unit-step response of the system in Part 1. 3.What is the value of the step response of the system in Part 1 when t=œÑ? 4.Find or derive the expression for the transfer function from voltage to angular speedof an unloaded permanent magnet dc motor. Compare this transfer function to theÔ¨Årst-order system in Part 1. Lab Connect the myDAQ, the motor, and the motor controller as shown in Figure P4.30. This setup is identical to the one that was used initially in Experiment 4.5, except that wehave connected the two analog input channels to the two analog output channels. This willallow us to use the myDAQ oscilloscope for measurements. If you decide to use an externaloscilloscope, these connections are not necessary. 1.Open the Oscilloscope and Plant Identi Ô¨Åcation 2.vi shown in Figures P4.31 and P4.32, respectively. You can also choose to use an external oscilloscope. Usesettings similar to the ones shown in Figure P4.31.Hardware Interface Laboratory 229WEBC04 10/28/2014 16:58:55 MyDAQ12345678 9 10BA6886N 10Œ© 9VMotor white FIGURE P4.30 Wiring diagram16 FIGURE P4.31 LabVIEW Oscilloscope ‚ÄîNI ELVISmx 16MyDAQ right slot shown on left is taken from Multisim program module NI myDAQ design and also reproduced in White-Paper 11423, Figure 2. Both Multisim and the White Paper are from National Instruments.230 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:55 2.In your Plant Identi Ô¨Åcation 2.vi choose the value of amplitude and offset shown in Figure P4.32. A LabView error will be generated if the square wave generates negative values as these are not allowed as inputs to the chip. The value of thefrequency is irrelevant; you just have to make sure the input is slow enough so thatthe motor speed reaches steady state as shown in Figure P4.32. 3.Run the Plant Identi Ô¨Åcation 2.vi and the Oscilloscope. Press the Stop button on the Oscilloscope as soon as it shows a full semi-cycle of positive speed, similar to Figure P4.31. 4.Click on the Log button in the Oscilloscope, give the Ô¨Åle a name, and save it to disk. Open the Ô¨Åle using a spreadsheet program. 5.Note that the response of the system in the Oscilloscope is in all likelihood that of aÔ¨Årst-order system, consistent with theoretical expectations. Thus, the transfer function will be of the form: Œ© s¬Ü Ei s¬Ü¬àK sœÑ¬á1. Kcan readily be found from the Oscilloscope or the Plant Identi Ô¨Åcation 2.vi. In the example shown, K¬à9:71 9¬à1:079. We will use the spreadsheet data to Ô¨Ånd the time constant, œÑ. 6.Use your spreadsheet data to Ô¨Ånd the time constant. For help on completing this task, go to www.wiley.com/college/nise . 7.Repeat the experiment for input voltages of 2 V, 5 V, and 9 V. Postlab 1.Is your system linear? How do you know? 2.If your system is linear for a range of inputs, Ô¨Ånd a judicious interpolation between the three transfer functions you found in Part 7 of the lab. Write down your Ô¨Ånal transfer function result and save it for use in subsequent experiments. Bibliography Borovic, B., Liu, A. Q., Popa, D., and Lewis, F. L. Open-loop versus closed-loop control of MEMS devices: choices and issues. Journal of Micromechanics, Microengineering , vol. 15, 2005, pp. 1917 ‚Äì1924. FIGURE P4.32 Plant Identi Ô¨Åcation 2.vi Front PanelBibliography 231WEBC04 10/28/2014 16:58:56 Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Craig, I. K., Xia, X., and Venter, J. W.; Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. DiBona, G. F. Physiology in perspective: The Wisdom of the Body. Neural control of the kidney. American Journal of Physiology ‚ÄìRegulatory, Integrative and Comparative Physiology , vol. 289, 2005, pp. R633 ‚ÄìR641. Dong, F., Heinemann, W., and Kasper, R. Development of a Row Guidance System for an Autonomous Robot for White Asparagus Harvesting. Computers and Electronics in Agriculture, vol. 79, pp. 216 ‚Äì225, 2011. Dorf, R. C. Introduction to Electric Circuits , 2d ed. Wiley, New York, 1993. ElaraÔ¨Å, M. G. M. K., and Hisham, S. B. Modeling and Control of pH Neutralization Using Neural Network Predictive Controller. International Conference on Control, Automation and Systems 2008, Seoul, Korea. Oct. pp. 14 ‚Äì17, 2008. Franklin, G. F., Powell, J. D., and Emami-Naeini, A. Feedback Control of Dynamic Systems , 2d ed. Addison-Wesley, Reading, MA, 1991. Glantz, A. S., and Tyberg, V. J. Determination of Frequency Response from Step Response: Application to Fluid-Filled Catheters. American Journal of Physiology , vol. 2, 1979, pp. H376 ‚ÄìH378. Good, M. C., Sweet, L. M., and Strobel, K. L. Dynamic Models for Control System Design of Integrated Robot and Drive Systems. Journal of Dynamic Systems, Measurement, and Control , March 1985, pp. 53 ‚Äì59. Gozde, H., and Taplamacioglu, M. C. Comparative performance analysis of arti Ô¨Åcial bee colony algorithm for automatic voltage regulator (AVR) system. Journal of the Franklin Institute , vol. 348, pp. 1927 ‚Äì1946, 2011. Ionescu, C., and De Keyser, R. Adaptive Closed-Loop Strategy for Paralyzed Skeletal Muscles. Proceedings of the IASTED International Conference on Biomedical Engineering , 2005. Jiayu, K., Mengxiao, W., Linan, M., and Zhongjun, X. Cascade Control of pH in an Anaerobic Waste Water Treatment System, 3d International Conference on Bioinformatics and Biomedical Engineering , 2009. Johnson, H. et al. Unmanned Free-Swimming Submersible (UFSS) System Description . NRL Memorandum Report 4393. Naval Research Laboratory, Washington, D.C. 1980. Kuo, B. C. Automatic Control Systems , 5th ed. Prentice Hall, Upper Saddle River, NJ, 1987. Kuo, C-F. J., Tsai, C-C., and Tu, H-M. Carriage Speed Control of a Cross-lapper System for Nonwoven Web Quality. Fibers and Polymers , vol. 9, no. 4, 2008, pp. 495 ‚Äì502. Mallavarapu, K., Newbury, K., and Leo, D. J. Feedback Control of the Bending Response of Ionic Polymer-Metal Composite Actuators. Proceedings of the SPIE, vol. 4329, 2001, pp. 301 ‚Äì310. McKerrow, P. J. Introduction to Robotics. Addison-Wesley, Singapore, 1991. McRuer, D., Ashkenas, I., and Graham, D. Aircraft Dynamics and Automatic Control . Princeton University Press, 1973. Nakamura, M. et al. Transient Response of Remnant Atrial Heart Rate to Step Changes in Total ArtiÔ¨Åcial Heart Output. Journal of ArtiÔ¨Åcial Organs , vol. 5, 2002, pp. 6‚Äì 12. Nashner, L. M., and Wolfson, P. In Ô¨Çuence of Head Position and Proprioceptive Cues on Short Latency Postural Re Ô¨Çexes Evoked by Galvanic Stimulation of the Human Labyrinth. Brain Research, vol. 67, 1974, pp. 255 ‚Äì268. Ogata, K. Modern Control Engineering , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1990. Philips, C. L., and Nagle, H. T. Digital Control Systems Analysis and Design . Prentice Hall, Upper Saddle River, NJ, 1984. Prasad, L., Tyagi, B., and Gupta, H. Modelling & Simulation for Optimal Control of Nonlinear Inverted Pendulum Dynamical System using PID Controller & LQR. IEEE Computer Society Sixth Asia Modeling Symposium , 2012, pp. 138 ‚Äì143.232 Chapter 4 Time ResponseWEBC04 10/28/2014 16:58:56 Ren, Z., and Zhu, G. G. Modeling and Control of an Electric Variable Valve Timing System for SI and HCCI Combustion Mode Transition. American Control Conference, San Francisco, CA, 2011, pp. 979 ‚Äì984. Ringdorfer M., and Horn M. Development of a Wheel Slip Actuator Controller for Electric Vehicles using Energy Recuperation and Hydraulic Brake Control. 2011 IEEE International Conference on Control Applications (CCA), Denver, CO, September 28 ‚Äì30, 2011, pp. 313 ‚Äì318. Salapaka, S., Sebastian, A., Cleveland, J. P., and Salapaka, M. V. High Bandwidth Nano-Positioner: A Robust Control Approach. Review of Scienti Ô¨Åc Instruments , vol. 73, No. 9, 2002, pp. 3232 ‚Äì3241. Sawusch, M. R., and Summers, T. A. 1001 Things to Do with Your Macintosh . TAB Books, Blue Ridge Summit, PA, 1984. Stefani, R. T. Modeling Human Response Characteristics . COED Application Note No. 33. Computers in Education Division of ASEE, 1973. Sun, M., and Xiong, Y. Dynamic Flight Stability of a Hovering Bumblebee. Journal of Experimental Biology , vol. 208, 2005, pp. 447 ‚Äì459. Thomsen, S., Hoffmann, N., and Fuchs, F. W. PI Control, PI-Based State Space Control, and Model-Based Predictive Control for Driv e Systems With Elastically Coupled Loads ‚ÄîA Comparative Study. IEEE Transactions on Industrial Electronics , vol. 58, no. 8, August 2011, pp. 3647 ‚Äì3657. Timothy, L. K., and Bona, B. E. State Space Analysis: An Introduction . McGraw-Hill, New York, Van Dijk, E., Spruijt, J. N., O ‚ÄôSullivan, D. M., and Klaasens, J. B. PWM-Switch Modeling of DC-DC Converters. IEEE Transactions on Power Electronics , vol. 10, 1995, pp. 659 ‚Äì665. X u e ,D . ,a n dC h e n ,Y .D .S u b - O p t i m u m H2Rational Approximations to Fractional Order Linear Systems. Proceedings of IDET/CIE 2005 . ASME 2005 International Design Engineering Technical Conferences & Computers and Information in Engineering Conference, Long Beach. CA, 2005. pp. 1 ‚Äì10. Zedka, M., Prochazka, A., Knight, B., Gillard, D., and Gauthier, M. Voluntary and Re Ô¨Çex Control of Human Back Muscles During Induced Pain. Journal of Physiology , vol. 520, 1999, pp. 591 ‚Äì604. Zhou, B. H., Baratta, R. V., Solomonow, M., and D ‚ÄôAmbrosia, R. D. The Dynamic Response of the Cat Ankle Joint During Load-Moving Contractions. IEEE Transactions on Biomedical Engineering , vol. 42, no. 4, 1995, pp. 386 ‚Äì393.Bibliography 233WEBC04 10/28/2014 16:58:56 Page 234WEBC05 10/28/2014 17:35:46 Reduction of Multiple Subsystems Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅReduce a block diagram of multiple subsystems to a single block representing the transfer function from input to output (Sections 5.1 ‚Äì5.2) ¬ÅAnalyze and design transient response for a system consisting of multiple subsystems (Section 5.3) ¬ÅConvert block diagrams to signal-Ô¨Ç ow diagrams (Section 5.4) ¬ÅFind the transfer function of multiple subsystems using Mason ‚Äôsr u l e( S e c t i o n5 . 5 ) ¬ÅRepresent state equations as signal- Ô¨Çow graphs (Section 5.6) ¬ÅRepresent multiple subsystems in state space in cascade, parallel, controllercanonical, and observer canonical forms (Section 5.7) ¬ÅPerform transformations between similar systems using transformationmatrices; and diagonalize a system matrix (Section 5.8) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with casestudies as follows: ¬ÅGiven the antenna azimuth position control system shown on the front endpapers, you will be able to (a) Ô¨Ånd the closed-loop transfer function that represents the system from input to output; (b) Ô¨Ånd a state-space representation for the closed-loop system; (c) predict, for a simpli Ô¨Åed system5 235WEBC05 10/28/2014 17:35:46 model, the percent overshoot, settling time, and peak time of the closed-loop system for a step input; (d) calculate the step response for the closed-loop system; and (e) for the simpli Ô¨Åed model, design the system gain to meet a transient response requirement. ¬ÅGiven the block diagrams for the Unmanned Free-Swimming Submersible(UFSS) vehicle ‚Äôs pitch and heading control systems on the back endpapers, you will be able to represent each control system in state space. 5.1 Introduction We have been working with individual subsystems represented by a block with its input andoutput. More complicated systems, however, are represented by the interconnection of many subsystems. Since the response of a single transfer function can be calculated, we want to represent multiple subsystems as a single transfer function. We can then apply theanalytical techniques of the previous chapters and obtain transient response informationabout the entire system. In this chapter, multiple subsystems are represented in two ways: as block diagrams and as signal-Ô¨Ç ow graphs. Although neither representation is limited to a particular analysis and design technique, block diagrams are usually used for frequency-domain analysis anddesign, and signal- Ô¨Çow graphs for state-space analysis. Signal- Ô¨Çow graphs represent transfer functions as lines, and signals as small-circular nodes. Summing is implicit. To show why it is convenient to use signal- Ô¨Çow graphs for state-space analysis and design, consider Figure 3.10. A graphical representation of a system ‚Äôs transfer function is as simple as Figure 3.10( a). However, a graphical representation of a system in state space requires representation of each state variable, as in Figure 3.10( b). In that example, a single-block transfer function requires seven blocks and a summingjunction to show the state variables explicitly. Thus, signal- Ô¨Çow graphs have advantages over block diagrams, such as Figure 3.10( b): They can be drawn more quickly, they are more compact, and they emphasize the state variables. We will develop techniques to reduce each representation to a single transfer function. Block diagram algebra will be used to reduce block diagrams and Mason ‚Äôs rule to reduce signal- Ô¨Çow graphs. Again, it must be emphasized that these methods are typically used as described. As we shall see, however, either method can be used for frequency-domain orstate-space analysis and design. 5.2 Block Diagrams As you already know, a subsystem is represented as a block with an input, an output, anda transfer function. Many systems are composed of multiple subsystems, as in Figure 5.1.When multiple subsystems are interconnected, a few more schematic elements must beadded to the block diagram. These new elements are summing junctions and pickoff points . All component parts of a block diagram f or a linear, time-invariant system are shown in Figure 5.2. The characteristic of the summing junction shown in Figure 5.2( c) is that the output signal, C(s), is the algebraic sum of the input signals, R 1(s),R2(s), and R3(s). The Ô¨Ågure shows three inputs, but any number can be present. A pickoff point, as shown in Figure 5.2( d), distributes the input signal, R(s), undiminished, to several output points. We will now examine some common topologies for interconnecting subsystems and derive the single transfer function representation for each of them. These common topologies will form the basis for reducing more complicated systems to a single block.236 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:47 Cascade Form Figure 5.3( a) shows an example of cascaded subsystems. Intermediate signal values are shown at the output of each subsystem. Each signal is derived from the product of the input times the transfer function. The equivalent transfer function, Ge(s), shown in Figure 5.3( b), is the output Laplace transform divided by the input Laplace transform from Figure 5.3( a), or Ge s¬Ü¬àG3 s¬ÜG2 s¬ÜG1 s¬Ü (5.1) which is the product of the subsystems ‚Äôtransfer functions. Equation (5.1) was derived under the assumption that interconnected subsystems do not load adjacent subsystems. That is, a subsystem ‚Äôs output remains the same whether or notR1(s)R(s) Signals System Summing junction (c)Pickoff point (d)+ + ‚Äì(a) (b)C(s) C(s) = R 1(s) + R2(s) ‚Äì R3(s) R2(s) R3(s)R(s) C(s)G(s) R(s)R(s) R(s) R(s)Input Output FIGURE 5.2 Components of a block diagram for a linear, time-invariant system Pressurized crewcompartmentForwardreactioncontrolsystem FlightdeckCryogenic oxygen/hydrogentanks and fuel cells (oxygen for crew and compartment) Deployable radiator panels Payload bay doors Payload bay FixedradiatorpanelsVertical tail Elevon rub panels Rudder/speed brake Elevons Space shuttlemain engines(3) OMSengines (2)Bodyflap RCS engines (38 primary, 6 vernier) SRB nozzle SRB separation motorsSRB holddownposts (4)Wing OMSfueltankOMSoxidizertankRCSoxidizertankRCSfueltankSRBpropellantand casingRemotemanipulatorsystemLiquidhydrogentankSRBrecoverysystemSRBseparationmotorsMid-deckand crewside hatchET liquidoxygen tank NASA-Houston. FIGURE 5.1 The recently retired space shuttle consisted of multiple subsystems. Can you identify those that are control systems or parts of control systems?5.2 Block Diagrams 237WEBC05 10/28/2014 17:35:47 the subsequent subsystem is connected. If there is a change in the output, the subsequent subsystem loads the previous subsystem, and the equivalent transfer function is not theproduct of the individual transfer functions. The network of Figure 5.4( a) demonstrates this concept. Its transfer function is G 1 s¬Ü¬àV1 s¬Ü Vi s¬Ü¬à1 R1C1 s¬á1 R1C1(5.2) Similarly, the network of Figure 5.4( b) has the following transfer function: G2 s¬Ü¬àV2 s¬Ü V1 s¬Ü¬à1 R2C2 s¬á1 R2C2(5.3) If the networks are placed in cascade, as in Figure 5.4( c), you can verify that the transfer function found using loop or node equations is G s¬Ü¬àV2 s¬Ü Vi s¬Ü¬à1 R1C1R2C2 s2¬á1 R1C1¬á1 R2C2¬á1 R2C1/C18/C19 s¬á1 R1C1R2C2(5.4) (a)Vi(s)R1 G1(s)=V1(s) V1(s)C1+ (c)R1 R2 C1 C2 V2(s) = G 2(s)G 1(s) GT(s) = V2(s) Vi(s) Vi(s)Vi(s) Vi(s)+(b)R2 V1(s) V2(s) G2(s) = V2(s) V1(s)C2+ = KG 2(s)G 1(s)K (d)R1 R2 C1 C2 V2(s) GT(s) = V2(s)Vi(s)+ ‚Äì‚Äì+ ‚Äì ‚Äì+ ‚Äì ‚Äì + ‚Äì+‚Äì FIGURE 5.4 Loading in cascaded systems(a)G1(s)R(s) X2(s) = G1(s)R(s) G2(s)X1(s) = G2(s)G 1(s)R(s) G3(s)C(s) = G3(s)G 2(s)G 1(s)R(s) R(s) G3(s)G 2(s)G 1(s)C(s) (b)FIGURE 5.3 a.Cascaded subsystems; b.equivalent transfer function238 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:47 But, using Eq. (5.1), G s¬Ü¬àG2 s¬ÜG1 s¬Ü¬à1 R1C1R2C2 s2¬á1 R1C1¬á1 R2C2/C18/C19 s¬á1 R1C1R2C2(5.5) Equations (5.4) and (5.5) are not the same: Eq. (5.4) has one more term for the coef Ô¨Åcient of sin the denominator and is correct. One way to prevent loading is to use an ampli Ô¨Åer between the two networks, as s h o w ni nF i g u r e5 . 4 ( d). The ampli Ô¨Åer has a high-impedance input, so that it does not load the previous network. At the same time it has a low-impedance output, so that it looks like a pure voltage source to the subsequent network. With the ampliÔ¨Å er included, the equivalent transfer function is the product of the transfer functions and the gain, K,o f the ampli Ô¨Åer. Parallel Form Figure 5.5 shows an example of parallel subsystems. Again, by writing the output of each subsystem, we can Ô¨Ånd the equivalent transfer function. Parallel subsystems have a common input and an output formed by the algebraic sum of the outputs from all of the subsystems.The equivalent transfer function, G e(s), is the output transform divided by the input transform from Figure 5.5( a), or Ge s¬Ü¬àG1 s¬ÜG2 s¬ÜG3 s¬Ü (5.6) which is the algebraic sum of the subsystems ‚Äôtransfer functions; it appears in Figure 5.5( b). ¬± (a) (b)R(s)G1(s) G2(s) G3(s)X1(s) = R(s)G 1(s) X2(s) = R(s)G 2(s) X3(s) = R(s)G 3(s)C(s) = [ ¬± G1(s) ¬± G2(s) ¬± G3(s)]R(s) C(s)¬± G1(s) ¬± G2(s) ¬± G3(s)¬± R(s)¬± FIGURE 5.5 a.Parallel subsystems; b.equivalent transfer function5.2 Block Diagrams 239WEBC05 10/28/2014 17:35:48 Feedback Form The third topology is the feedback form, which will be seen repeatedly in subsequent chapters. The feedback system forms the basis for our study of control systems engineering. In Chapter 1, we de Ô¨Åned open-loop and closed-loop systems and pointed out the advantage of closed-loop, or feedback control, systems over open-loop systems. As we move ahead,we will focus on the analysis and design of feedback systems. Let us derive the transfer function that represents the system from its input to its output. The typical feedback system, described in detail in Chapter 1, is shown inFigure 5.6( a); a simpli Ô¨Åed model is shown in Figure 5.6( b). 1Directing our attention to the simpli Ô¨Åed model, E s¬Ü¬àR s¬ÜC s¬ÜH s¬Ü (5.7) But since C s¬Ü¬àE s¬ÜG s¬Ü, E s¬Ü¬àC s¬Ü G s¬Ü(5.8) InputR(s) ++ ‚ÄìActuating signal (error)Controller Plant Output Output transducerFeedback (a) Input++ ‚ÄìActuating signal (error)Plant and controller Output Feedback (b) Output Input (c)Input transducer G1(s)E(s)G2(s) G3(s)C(s) H2(s) H1(s) R(s) E(s)G(s)C(s) H(s) R(s) G(s) C(s) 1 G(s)H(s)+‚ÄìFIGURE 5.6 a.Feedback control system; b.simpli Ô¨Åed model; c.equivalent transfer function 1The system is said to have negative feedback if the sign at the summing junction is negative and positive feedback if the sign is positive.240 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:48 Substituting Eq. (5.8) into Eq. (5.7) and solving for the transfer function, C s¬Ü=R s¬Ü¬àGe s¬Ü, we obtain the equivalent, or closed-loop , transfer function shown in Figure 5.6( c), Ge s¬Ü¬àG s¬Ü 1G s¬ÜH s¬Ü(5.9) The product, G(s)H(s), in Eq. (5.9) is called the open-loop transfer function,o r loop gain . So far, we have explored three different con Ô¨Ågurations for multiple subsystems. For each, we found the equivalent transfer function. Since these three forms are combined into complex arrangements in physical systems, recognizing these topologies is aprerequisite to obtaining the equivalent transfer function of a complex system. In thissection, we will reduce complex systems composed of multiple subsystems to singletransfer functions. Moving Blocks to Create Familiar Forms Before we begin to reduce block diagrams, it must be explained that the familiar forms (cascade, parallel, and feedback) are not always apparent in a block diagram. For example, in the feedback form, if there is a pickoff point after the summing junction,you cannot use the feedback formula to reduce the feedback system to a single block.That signal disappears, and there is no place to reestablish the pickoff point. This subsection will discuss basic block moves that can be made in order to establish familiar forms when they almost exist. In particular, it will explain how to move blocks leftand right past summing junctions and pickoff points. Figure 5.7 shows equivalent block diagrams formed when transfer functions are moved left or right past a summing junction, and Figure 5.8 shows equivalent blockdiagrams formed when transfer functions are moved left or right past a pickoff point. Inthe diagrams the symbol means ‚Äúequivalent to.‚Äù These equivalences, along with the forms studied earlier in this section, can be used to reduce a block diagram to a singletransfer function. In each case of Figures 5.7 and 5.8, the equivalence can be veriÔ¨Å ed by tracing the signals at the input through to the output and recognizing that the output R(s) ++ ‚Äì+ +‚Äì (a)X(s)G(s)C(s) R(s) G(s)C(s) G(s) X(s) ++ ‚Äì 1 (b)++ ‚ÄìR(s) G(s)C(s) R(s) G(s)C(s) G(s)X(s) X(s)FIGURE 5.7 Block diagram algebra for summing junctions ‚Äîequivalent forms for moving a block a.to the left past a summing junction; b.to the right past a summing junction5.2 Block Diagrams 241WEBC05 10/28/2014 17:35:48 signals are identical. For example, in Figure 5.7( a), signals R(s)a n d X(s) are multiplied by G(s) before reaching the output. Hence, both block diagrams are equivalent, with C s¬Ü¬àR s¬ÜG s¬ÜX s¬ÜG s¬Ü.I nF i g u r e5 . 7 ( b),R(s) is multiplied by G(s) before reaching the output, but X(s) is not. Hence, both block diagrams in Figure 5.7( b)a r ee q u i v a l e n t , with C s¬Ü¬àR s¬ÜG s¬ÜX s¬Ü. For pickoff points, similar reasoning yields similar results for the block diagrams of Figure 5.8(a )a n d( b). Let us now put the whole story together with examples of block diagram reduction.(b)G(s)R(s)G(s) R(s) R(s) R(s) G(s)R(s)G(s) R(s)G(s) R(s)G(s)(a) R(s) R(s)R(s) G(s) G(s) G(s)R(s)G(s) R(s)G(s) R(s)G(s)R(s)G(s) R(s) R(s)G(s)G(s)1 G(s)1 FIGURE 5.8 Block diagram algebra for pickoff points ‚Äî equivalent forms for moving a block a.to the left past a pickoff point; b.to the right past a pickoff point Example 5.1 Block Diagram Reduction via Familiar FormsBlock Diagram Reduction via Familiar Forms PROBLEM: Reduce the block diagram shown in Figure 5.9 to a single transfer function. SOLUTION: We solve the problem by following the steps in Figure 5.10. First, the three summing junctions can be collapsed in to a single summing junction, as shown in Figure 5.10( a).+ ‚Äì+ ++ ‚ÄìR(s)G1(s) G2(s) H1(s) H2(s) H3(s)G3(s)C(s) FIGURE 5.9 Block diagram for Example 5.1242 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:49 Second, recognize that the three feedback functions, H1(s),H2(s), and H3(s), are connected in parallel. They are fed from a common signal source, and their outputs are summed. The equivalent function is H1 s¬Ü H2 s¬Ü¬áH3 s¬Ü. Also recognize that G2(s) andG3(s) are connected in cascade. Thus, the equivalent transfer function is the product, G3(s)G2(s). The results of these steps are shown in Figure 5.10( b). Finally, the feedback system is reduced and multiplied by G1(s) to yield the equivalent transfer function shown in Figure 5.10( c). (c)R(s) G3(s)G 2(s)G 1(s) C(s) 1 + G3(s)G 2(s)[H 1(s) ‚Äì H2(s) + H3(s)]+ ‚Äì (b)R(s)G1(s) G3(s)G 2(s)C(s) H1(s) ‚Äì H2(s) + H3(s)+‚Äì (a)R(s) +G1(s) G2(s) G3(s) H1(s) H2(s) H3(s)+ C(s) ‚Äì FIGURE 5.10 Steps in solving Example 5.1: a.Collapse summing junctions; b.form equivalent cascaded system in the forward path andequivalent parallel system in thefeedback path; c.form equivalent feedback system and multiply by cascaded G 1(s) Example 5.2 Block Diagram Reduction by Moving BlocksBlock Diagram Reduction by Moving Blocks PROBLEM: Reduce the system shown in Figure 5.11 to a single transfer function. R(s) V1(s) V2(s) V3(s) V4(s) V5(s) V8(s) V7(s) V6(s)G1(s) G2(s) G3(s) H3(s) H2(s) H1(s)C(s) + ‚Äì+ ‚Äì+ ‚Äì+ FIGURE 5.11 Block diagram for Example 5.25.2 Block Diagrams 243WEBC05 10/28/2014 17:35:49 SOLUTION: In this example we make use of the equivalent forms shown in Figures 5.7 a n d5 . 8 .F i r s t ,m o v e G2(s) to the left past the pickoff point to create parallel subsystems, and reduce the feedback system consisting of G3(s)a n d H3(s). This result is shown in Figure 5.12(a ). Second, reduce the parallel pair consisting of 1/ G2(s) and unity, and push G1(s)t o the right past the summing junction, creating parallel subsystems in the feedback. These results are shown in Figure 5.12( b). Third, collapse the summing junctions, add the two feedback elements together, and combine the last two cascaded blocks. Figure 5.12( c) shows these results. Fourth, use the feedback formula to obtain Figure 5.12( d). Finally, multiply the two cascaded blocks and obtain the Ô¨Ånal result, shown in Figure 5.12(e ). (e)R(s) [1 + G2(s)H 2(s) + G1(s)G 2(s)H 1(s)][1 + G3(s)H 3(s)]G1(s)G 3(s)[1 + G2(s)] C(s)(d)R(s) G1(s)G 2(s) V4(s) 1 + G3(s)H 3(s)1 + 1 G2(s)G3(s) 1 + G2(s)H 2(s) + G1(s)G 2(s)H 1(s)C(s) + H1(s)+ ‚Äì1 + G3(s)H 3(s) (c)V4(s) 1 + 1 G2(s)G3(s) H2(s) G1(s)+ ‚ÄìR(s) C(s)G1(s)G 2(s)1 + 1+ ‚Äì+ ‚Äì (b)V1(s)G1(s)G 2(s)V4(s) G2(s) 1 + G3(s)H 3(s)G3(s) C(s) H2(s) G1(s) H1(s)R(s)1 + G3(s)H 3(s)+ ‚Äì+ ‚Äì+ R(s) (a)V2(s) V3(s) V7(s) V6(s)G3(s)G1(s) H1(s)H2(s)1 G2(s) G2(s)V1(s) V4(s) C(s)+ FIGURE 5.12 Steps in the block diagram reduction for Example 5.2244 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:49 Students who are using MATLAB should now run ch5p1 in Appendix B to perform block diagram reduction. In this section, we examined the equivalence of several block diagram con Ô¨Ågurations containing signals, systems, summing junctions, and pickoff points. These con Ô¨Ågurations were the cascade, parallel, and feedback forms. During block diagram reduction, we attempt to produce these easily recognized forms and then reduce the block diagram to a single transferfunction. In the next section, we will examine some applications of block diagram reduction. 5.3 Analysis and Design of Feedback Systems An immediate application of the principles of Section 5.2 is the analysis anddesign of feedback systems that reduce to second-order systems. Percentovershoot, settling time, peak time, and rise time can then be found from theequivalent transfer function. Consider the system shown in Figure 5.14, which can model a control system such as the antenna azimuth position control system. For example, thetransfer function, K=s s¬áa¬Ü, can model the ampli Ô¨Åers, motor, load, and gears. From Eq. (5.9), the closed-loop transfer function, T(s), for this system is T s¬Ü¬à K s2¬áas¬áK(5.10) where Kmodels the ampli Ô¨Åer gain, that is, the ratio of the output voltage to the input voltage. AsKvaries, the poles move through the three ranges of operation of a second-order system:Skill-Assessment Exercise 5.1 PROBLEM: Find the equivalent transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü, for the system shown in Figure 5.13. ANSWER: T s¬Ü¬às3¬á1 2s4¬ás2¬á2s The complete solution is at www.wiley.com/college/nise .++ + ‚Äì‚ÄìR(s) sssC(s) 1 s1 s FIGURE 5.13 Block diagram for Skill-Assessment Exercise 5.1TryIt 5.1 Use the following MATLAB and Control System Toolbox statements to Ô¨Ånd the closed- loop transfer function of thesystem in Example 5.2 if all G i s¬Ü¬à1= s¬á1¬Üand all Hi s¬Ü¬à1=s. G1=tf (1, [1 1] ) ; G2=G1;G3=G1;H1=tf (1, [1 0] ) ; H2=H1;H3=H1; System=append... (G1,G2,G3,H1,H2,H3) ; input=1;output=3; Q= [1  4000 21  500 321  5 6 42000 5200063000 ] ; T=connect(System,... Q,input,output) ; T=tf(T) ;T=minreal (T) K + ‚Äìs(s + a)R(s) C(s) FIGURE 5.14 Second-order feedback control system5.3 Analysis and Design of Feedback Systems 245WEBC05 10/28/2014 17:35:50 overdamped, critically damped, and underdamped. For example, for Kbetween 0 and a2=4, the poles of the system are real and are located at s1;2¬à a 2Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É a2 4Kp 2(5.11) AsKincreases, the poles move along the real axis, and the system remains overdamped until K¬àa2=4. At that gain, or ampli Ô¨Åcation, both poles are real and equal, and the system is critically damped. For gains above a2=4, the system is underdamped, with complex poles located at s1;2¬à a 2jÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 4K a2p 2(5.12) Now as Kincreases, the real part remains constant and the imaginary part increases. Thus, the peak time decreases and the percent overshoot increases, while the settling time remains constant. Let us look at two examples that apply the concepts to feedback control systems. In theÔ¨Årst example, we determine a system ‚Äôs transient response. In the second example, we design the gain to meet a transient response requirement. Example 5.3 Finding Transient ResponseFinding Transient Response PROBLEM: For the system shown in Figure 5.15, Ô¨Ånd the peak time, percent overshoot, and settling time. SOLUTION: The closed-loop transfer function found from Eq. (5.9) is T s¬Ü¬à25 s2¬á5s¬á25(5.13) From Eq. (4.18), œân¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 25p ¬à5 (5.14) From Eq. (4.21), 2Œ∂œân¬à5 (5.15) Substituting Eq. (5.14) into (5.15) and solving for Œ∂yields Œ∂¬à0:5 (5.16) Using the values for Œ∂and œânalong with Eqs (4.34), (4.38), and (4.42), we Ô¨Ånd, respectively, Tp¬àœÄ œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬à0:726 second (5.17) %OS¬àe Œ∂œÄ=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Ô¨É 1 Œ∂2p 100¬à16:303 (5.18) Ts¬à4 Œ∂œân¬à1:6 seconds (5.19)‚Äì25 + s(s + 5)R(s) C(s) FIGURE 5.15 Feedback system for Example 5.3246 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:51 MATLAB ‚Äôs Simulink provides an alternative method of simulating feedback systems to obtain the time response. Students who are performing the MATLAB exercises and want to explore the addedcapability of MATLAB ‚Äôs Simulink should now consult Appendix C. Example C.3 includes a discussion about, and an example of, the useof Simulink to simulate feedback systems with nonlinearities.Students who are using MATLAB should now run ch5p2 in Appendix B.You will learn how to perform block diagram reduction followed byan evaluation of the closed-loop system's transient response by Ô¨Ånding, T p,%OS , and Ts. Finally, you will learn how to use MATLAB to generate a closed-loop step response. This exercise uses MATLAB to do Example 5.3. Example 5.4 Gain Design for Transient ResponseGain Design for Transient Response PROBLEM: Design the value of gain. K, for the feedback control system of Figure 5.16 so that the system will respond with a 10% overshoot. SOLUTION: The closed-loop transfer function of the system is T s¬Ü¬àK s2¬á5s¬áK(5.20) From Eq. (5.20), 2Œ∂œân¬à5 (5.21) and œân¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Kp (5.22) Thus, Œ∂¬à5 2Ô¨ÉÔ¨ÉÔ¨ÉÔ¨É Kp (5.23) Since percent overshoot is a function only of Œ∂, Eq. (5.23) shows that the percent overshoot is a function of K. A 10% overshoot implies that Œ∂¬à0:591. Substituting this value for the damping ratio into Eq. (5.23) and solving for Kyields K¬à17:9 (5.24) Although we are able to design for percent overshoot in this problem, we could not have selected settling time as a design criterion because, regardless of the value of K, the real parts,  2.5, of the poles of Eq. (5.20) remain the same.‚Äìs(s + 5)K + R(s) C(s) FIGURE 5.16 Feedback system for Example 5.4Virtual Experiment 5.1 Gain Design Put theory into practice designing the position control gain for theQuanser Linear Servo and simulating its closed-loop response in LabVIEW. Thisconcept is used, for instance, tocontrol a rover exploring the terrain of a planet. Virtual experiments are found on Learning Space.5.3 Analysis and Design of Feedback Systems 247WEBC05 10/28/2014 17:35:52 5.4 Signal-Flow Graphs Signal- Ô¨Çow graphs are an alternative to block diagrams. Unlike block diagrams, which consist of blocks, signals, summing junctions, and pickoff points, a signal-Ô¨Çow graph consists only of branches , which represent systems, and nodes , which represent signals. These elements are shown in Figures 5.17( a) and ( b), respectively. A system is represented by a line with an arrow showing the direction of signal Ô¨Çow through the system. Adjacent to the line we write the transfer function. A signal is a node with the signal ‚Äôs name written adjacent to the node. Figure 5.17(c ) shows the interconnection of the systems and the signals. Each signal is the sum of signals Ô¨Çowing into it. For example, we see that the signal V s¬Ü¬àR1 s¬ÜG1 s¬Ü R2 s¬ÜG2 s¬Ü¬áR3 s¬ÜG3 s¬Ü; the signal C2 s¬Ü¬àV s¬ÜG5 s¬Ü¬àSkill-Assessment Exercise 5.2 PROBLEM: For a unity feedback control system with a forward-path transfer function G s¬Ü¬à16 s s¬áa¬Ü, design the value of ato yield a closed-loop step response that has 5% overshoot. ANSWER: a¬à5:52 The complete solution is at www.wiley.com/college/nise . TryIt 5.2 Use the following MATLAB and Control System Toolbox statements to Ô¨ÅndŒ∂,œân,%OS , Ts,Tp, and Trfor the closed-loop unity feedback system described in Skill-Assessment Exercise 5.2. Start with a¬à2 and try some other values. A step response for the closed-loop system willalso be produced. a=2; numg=16; deng=poly ( [0  a] ) ; G=tf (numg, deng) ; T=feedback (G, 1) ;[numt, dent] =... tfdata (T, 'v') ; wn=sqrt (dent (3) ) z=dent(2) / (2*wn) Ts=4/ (z*wn) Tp=pi/ (wn*... sqrt (1 -z^2) ) pos=exp (-z*pi... /sqrt (1 -z^2) ) *100 Tr=(1.76*z^3-... 0.417*z^2 +1.039*... z+1) /wn step (T) R1(s) R2(s)G1(s) ‚ÄìG2(s) R3(s)G3(s) ‚ÄìG6(s)G5(s)G4(s) V(s)C1(s) C2(s) C3(s) (c) (b)V(s) (a)G(s) FIGURE 5.17 Signal- Ô¨Çow graph components: a.system; b.signal; c.interconnection of systems and signals248 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:53 R1 s¬ÜG1 s¬ÜG5 s¬Ü R2 s¬ÜG2 s¬ÜG5 s¬Ü¬áR3 s¬ÜG3 s¬ÜG5 s¬Ü; and the signal C3 s¬Ü¬à  V s¬ÜG6 s¬Ü¬à  R1 s¬ÜG1 s¬ÜG6 s¬Ü¬áR2 s¬ÜG2 s¬ÜG6 s¬Ü R3 s¬ÜG3 s¬ÜG6 s¬Ü. Notice that in summing negative signals we associate the negative sign with the system and not with a summing junction, as in t h ec a s eo fb l o c kd i a g r a m s . To show the parallel between block diagrams and signal- Ô¨Çow graphs, we will take some of the block diagram forms from Section 5.2 and convert them to signal- Ô¨Çow graphs in Example 5.5. In each case, we will Ô¨Årst convert the signals to nodes and then interconnect the nodes with system branches. In Example 5.6, we will convert an intricate block diagramto a signal- Ô¨Çow graph. Example 5.5 Converting Common Block Diagrams to Signal-Flow GraphsConverting Common Block Diagrams to Signal-Flow Graphs PROBLEM: Convert the cascaded, parallel, and feedback forms of the block diagrams shown in Figures 5.3( a), 5.5( a), and 5.6( b), respectively, into signal- Ô¨Çow graphs. SOLUTION: In each case, we start by drawing the signal nodes for that system. Next we interconnect the signal nodes with system branches. The signal nodes for the cascaded, parallel, and feedback forms are shown in Figure 5.18( a), (c), and (e ), respectively. The interconnection of the nodes with branches that represent the subsystems is shown in Figure 5.18( b), (d), and (f ) for the cascaded, parallel, and feedback forms, respectively. 1 ( f)R(s) E(s)G(s) C(s) ‚ÄìH(s) (e)R(s) E(s)C(s)(d)1 11V1(s)G1(s) V2(s)R(s) C(s)G2(s) V3(s)G3(s) (c)V2(s)R(s) C(s) V3(s)(b)R(s)G1(s) V2(s)G2(s) V1(s)G3(s) C(s) (a)V2(s) V1(s)C(s) R(s) V1(s) FIGURE 5.18 Building signal- Ô¨Çow graphs: a.cascaded system nodes (from Figure 5.3(a ));b.cascaded system signal- Ô¨Çow graph; c.parallel system nodes (from Figure 5.5(a ));d.parallel system signal- Ô¨Çow graph; e.feedback system nodes (from Figure 5.6( b)); f.feedback system signal-Ô¨Ç ow graph5.4 Signal-Flow Graphs 249WEBC05 10/28/2014 17:35:53 Example 5.6 Converting a Block Diagram to a Signal-Flow GraphConverting a Block Diagram to a Signal-Flow Graph PROBLEM: Convert the block diagram of Figure 5.11 to a signal- Ô¨Çow graph. SOLUTION: Begin by drawing the signal nodes, as shown in Figure 5.19( a). Next, interconnect the nodes, showing the direction of signal Ô¨Çow and identifying each transfer function. The result is shown in Figure 5.19( b). Notice that the negative signs at the summing junctions of the block diagram are represented by the negative transfer functions of the signal- Ô¨Çow graph. Finally, if desired, simplify the signal- Ô¨Çow graph to the one shown in Figure 5.19( c) by eliminating signals that have a single Ô¨Çow in and a single Ô¨Çow out, such as V2(s),V6(s),V7(s), and V8(s). (b)1111 ‚Äì1R(s)G1(s) V2(s) V6(s) H1(s)V7(s)G2(s) V5(s)G3(s) V8(s)H3(s) ‚Äì1V4(s)C(s) V3(s) V1(s) ‚Äì1H2(s)(a)R(s) V1(s) V2(s) V3(s) V4(s) V5(s)C(s) V8(s) V7(s) V6(s) (c)111 R(s)G1(s) V3(s)G2(s) V5(s)G3(s) ‚ÄìH2(s) ‚ÄìH3(s) ‚ÄìH1(s)V1(s)C(s) V4(s) FIGURE 5.19 Signal- Ô¨Çow graph development: a.signal nodes; b.signal- Ô¨Çow graph; c.simpli Ô¨Åed signal- Ô¨Çow graph250 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:53 5.5 Mason ‚Äôs Rule Earlier in this chapter, we discussed how to reduce block diagrams to single transfer functions. Now we are ready to discuss a technique for reducing signal-Ô¨Ç ow graphs to single transfer functions that relate the output of a system to its input. The block diagram reduction technique we studied in Section 5.2 requires successive application of fundamental relationships in order to arrive at the system transfer function. On the other hand, Mason ‚Äôs rule for reducing a signal- Ô¨Çow graph to a single transfer function requires the application of one formula. The formula was derived by S. J. Mason when herelated the signal- Ô¨Çow graph to the simultaneous equations that can be written from the graph ( Mason ,1953 ). In general, it can be complicated to implement the formula without making mistakes. Speci Ô¨Åcally, the existence of what we will later call nontouching loops increases the complexity of the formula. However, many systems do not have non-touching loops. For these systems, you may Ô¨Ånd Mason‚Äô s rule easier to use than block diagram reduction. Mason ‚Äôs formula has several components that must be evaluated. First, we must be sure that the de Ô¨Ånitions of the components are well understood. Then we must exert care in evaluating the components. To that end, we discuss some basic de Ô¨Ånitions applicable to signal- Ô¨Çow graphs; then we state Mason ‚Äôs rule and do an example. Definitions Loop gain . The product of branch gains found by traversing a path that starts at a node and ends at the same node, following the direction of the signal Ô¨Çow, without passing through any other node more than once. For examples of loop gains, see Figure 5.20. There are four loop gains: 1.G2 s¬ÜH1 s¬Ü (5.25a) 2.G4 s¬ÜH2 s¬Ü (5.25b) 3.G4 s¬ÜG5 s¬ÜH3 s¬Ü (5.25c) 4.G4 s¬ÜG6 s¬ÜH3 s¬Ü (5.25d) Forward-path gain . The product of gains found by traversing a path from the input node to the output node of the signal-Ô¨Çow graph in the direction of signal Ô¨Çow. Examples of forward-path gains are also shown in Figure 5.20. There are two forward-path gains: 1.G1 s¬ÜG2 s¬ÜG3 s¬ÜG4 s¬ÜG5 s¬ÜG7 s¬Ü (5.26a) 2.G1 s¬ÜG2 s¬ÜG3 s¬ÜG4 s¬ÜG6 s¬ÜG7 s¬Ü (5.26b) Nontouching loops . Loops that do not have any nodes in common. In Figure 5.20, loop G2(s)H1(s) does not touch loops G4(s)H2(s),G4(s)G5(s)H3(s), and G4(s)G6(s)H3(s). Nontouching-loop gain . The product of loop gains from nontouching loops taken two, three, four, or more at a time. In Figure 5.20 the product of loop gain G2(s)H1(s) and loop gainSkill-Assessment Exercise 5.3 PROBLEM: Convert the block diagram of Figure 5.13 to a signal- Ô¨Çow graph. ANSWER: The complete solution is at www.wiley.com/college/nise . R(s)G1(s) G2(s) G3(s) G4(s) V5(s) V4(s) H1(s) H2(s)V3(s)G5(s) V2(s)G6(s) G7(s) V1(s)C(s) H3(s) FIGURE 5.20 Signal- Ô¨Çow graph for demonstrating Mason‚Äô s rule5.5 Mason ‚Äôs Rule 251WEBC05 10/28/2014 17:35:55 G4(s)H2(s) is a nontouching-loop gain taken two at a time. In summary, all three of the nontouching-loop gains taken two at a time are 1.¬âG2 s¬ÜH1 s¬Ü¬ä¬âG4 s¬ÜH2 s¬Ü¬ä (5.27a) 2.¬âG2 s¬ÜH1 s¬Ü¬ä¬âG4 s¬ÜG5 s¬ÜH3 s¬Ü¬ä (5.27b) 3.¬âG2 s¬ÜH1 s¬Ü¬ä¬âG4 s¬ÜG6 s¬ÜH3 s¬Ü¬ä (5.27c) The product of loop gains ¬âG4 s¬ÜG5 s¬ÜH3 s¬Ü¬ä¬âG4 s¬ÜG6 s¬ÜH3 s¬Ü¬äis not a nontouching-loop gain since these two loops have nodes in common. In our example there are no nontouching- loop gains taken three at a time since three nontouching loops do not exist in the example. We are now ready to state Mason ‚Äôs rule. Mason ‚Äôs Rule The transfer function, C s¬Ü=R s¬Ü, of a system represented by a signal-Ô¨Ç ow graph is G s¬Ü¬àC s¬Ü R s¬Ü¬àP kTkŒîk Œî(5.28) where k¬ànumber of forward paths Tk¬àthekth forward-path gain Œî¬à1 Œ£loop gains ¬áŒ£nontouching-loop gains taken two at a time  Œ£ nontouching-loop gains taken three at a time ¬áŒ£nontouching-loop gains taken four at a time  ... Œîk¬àŒî Œ£loop gain terms in Œîthat touch the kth forward path: In other words ;Œîk is formed by eliminating from Œîthose loop gains that touch the kth forward path : Notice the alternating signs for the components of Œî. The following example will help clarify Mason ‚Äôs rule. Example 5.7 Transfer Function via Mason ‚ÄôsRule T ransfer Function via Mason ‚Äôs Rule PROBLEM: Find the transfer function, C(s)/R(s), for the signal- Ô¨Çow graph in Figure 5.21. R(s)G1(s) G2(s) V4(s) H1(s)G3(s) V3(s) G8(s)V2(s)G4(s) V1(s)G5(s) H2(s)C(s) G6(s) G7(s) H4(s)V5(s) V6(s) FIGURE 5.21 Signal- Ô¨Çow graph for Example 5.7252 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:57 SOLUTION: First, identify the forward-path gains . In this example there is only one: G1 s¬ÜG2 s¬ÜG3 s¬ÜG4 s¬ÜG5 s¬Ü (5.29) Second, identify the loop gains . There are four, as follows: 1.G2 s¬ÜH1 s¬Ü (5.30a) 2.G4 s¬ÜH2 s¬Ü (5.30b) 3.G7 s¬ÜH4 s¬Ü (5.30c) 4.G2 s¬ÜG3 s¬ÜG4 s¬ÜG5 s¬ÜG6 s¬ÜG7 s¬ÜG8 s¬Ü (5.30d) Third, identify the nontouching loops taken two at a time . From Eqs. (5.30) and Figure 5.21, we can see that loop 1 does not touch loop 2, loop 1 does not touch loop 3, and loop 2 does not touch loop 3. Notice that loops 1, 2, and 3 all touch loop 4.Thus, the combinations of nontouching l oops taken two at a time are as follows: Loop 1 and loop 2 :G 2 s¬ÜH1 s¬ÜG4 s¬ÜH2 s¬Ü (5.31a) Loop 1 and loop 3 :G2 s¬ÜH1 s¬ÜG7 s¬ÜH4 s¬Ü (5.31b) Loop 2 and loop 3 :G4 s¬ÜH2 s¬ÜG7 s¬ÜH4 s¬Ü (5.31c) Finally, the nontouching loops taken three at a time are as follows: Loops 1; 2;and 3 :G2 s¬ÜH1 s¬ÜG4 s¬ÜH2 s¬ÜG7 s¬ÜH4 s¬Ü (5.32) Now, from Eq. (5.28) and its de Ô¨Ånitions, we form ŒîandŒîk. Hence, Œî¬à1 ¬âG2 s¬ÜH1 s¬Ü¬áG4 s¬ÜH2 s¬Ü¬áG7 s¬ÜH4 s¬Ü ¬áG2 s¬ÜG3 s¬ÜG4 s¬ÜG5 s¬ÜG6 s¬ÜG7 s¬ÜG8 s¬Ü¬ä ¬á¬âG2 s¬ÜH1 s¬ÜG4 s¬ÜH2 s¬Ü¬áG2 s¬ÜH1 s¬ÜG7 s¬ÜH4 s¬Ü ¬áG4 s¬ÜH2 s¬ÜG7 s¬ÜH4 s¬Ü¬ä  ¬âG2 s¬ÜH1 s¬ÜG4 s¬ÜH2 s¬ÜG7 s¬ÜH4 s¬Ü¬ä (5.33) We form Œîkby eliminating from Œîthe loop gains that touch the kth forward path: Œî1¬à1 G7 s¬ÜH4 s¬Ü (5.34) Expressions (5.29), (5.33), and (5.34) are now substituted into Eq. (5.28), yielding the transfer function: G s¬Ü¬àT1Œî1 Œî¬à¬âG1 s¬ÜG2 s¬ÜG3 s¬ÜG4 s¬ÜG5 s¬Ü¬ä¬â1 G7 s¬ÜH4 s¬Ü¬ä Œî(5.35) Since there is only one forward path, G(s) consists of only one term, rather than a sum of terms, each coming from a forward path. Skill-Assessment Exercise 5.4 PROBLEM: Use Mason ‚Äôs rule to Ô¨Ånd the transfer function of the signal-Ô¨Ç ow diagram shown in Figure 5.19( c). Notice that this is the same system used in Example 5.2 to Ô¨Ånd the transfer function via block diagram reduction. ANSWER: T s¬Ü¬àG1 s¬ÜG3 s¬Ü¬â1¬áG2 s¬Ü¬ä 1¬áG2 s¬ÜH2 s¬Ü¬áG1 s¬ÜG2 s¬ÜH1 s¬Ü ¬â¬ä ¬â1¬áG3 s¬ÜH3 s¬Ü¬ä The complete solution is at www.wiley.com/college/nise .5.5 Mason ‚Äôs Rule 253WEBC05 10/28/2014 17:35:57 5.6 Signal-Flow Graphs of State Equations In this section, we draw signal- Ô¨Çow graphs from state equations. At Ô¨Årst this process will help us visualize state variables. Later we will draw signal- Ô¨Çow graphs and then write alternate representations of a system in state space. Consider the following state and output equations: _x1¬à2x1 5x2¬á3x3¬á2r (5.36a) _x2¬à 6x1 2x2¬á2x3¬á5r (5.36b) _x3¬àx1 3x2 4x3¬á7r (5.36c) y¬à 4x1¬á6x2¬á9x3 (5.36d) First, identify three nodes to be the three state variables, x1,x2, and x3; also identify three nodes, placed to the left of each respective state variable, to be the derivatives of the state variables, as in Figure 5.22( a). Also identify a node as the input, r, and another node as the output, y. Next interconnect the state variables and their derivatives with the de Ô¨Åning integration, 1/ s, as shown in Figure 5.22( b). Then using Eqs. (5.36), feed to each node the indicated signals. For example, from Eq. (5.36 a),_x1receives 2 x1 5x2¬á3x3¬á2r,a s shown in Figure 5.22( c). Similarly, _x2receives  6x1 2x2¬á2x3¬á5r, as shown in Figure 5.22( d), and _x3receives x1 3x2 4x3¬á7r, as shown in Figure 5.22( e). Finally, using Eq. (5.36 d), the output, y, receives  4x1¬á6x2¬á9x3, as shown in Figure 5.19( f), the Ô¨Ånal phase-variable representation, where the state variables are the outputs of theintegrators. R(s)R(s) Y(s) sX3(s) sX2(s) sX1(s) X3(s) X2(s) X1(s)Y(s) (a)sX3(s) sX2(s) sX1(s) X3(s) X2(s) X1(s) (b)1 s1 s1 s (c)sX3(s) sX2(s) sX1(s) X3(s) X2(s) X1(s) 2 32 Y(s) R(s)1s1s ‚Äì51s FIGURE 5.22 Stages of development of a signal- Ô¨Çow graph for the system of Eqs. (5.36): a.Place nodes; b.interconnect state variables and derivatives; c.form dx1/dt;(Ô¨Ågure continues )254 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:57 Y(s) sX3(s) (f)sX2(s) sX1(s) X3(s) X2(s) X1(s)69 R(s)72 ‚Äì5 ‚Äì4 32 ‚Äì6‚Äì45 ‚Äì2 ‚Äì3 121 s1 s1 sY(s) sX3(s) (e)sX2(s) sX1(s) X3(s) X2(s) X1(s) 32 ‚Äì6‚Äì45 ‚Äì2 ‚Äì3 1R(s)72 ‚Äì5 21 s1 s1 sY(s) sX3(s) (d)sX2(s) sX1(s) X3(s) X2(s) X1(s) 2 32 ‚Äì65 ‚Äì2R(s)‚Äì51s1s1s 2 FIGURE 5.22 (Continued )d.form dx2/dt;e.form dx3/dt;f.form output5.6 Signal-Flow Graphs of State Equations 255WEBC05 10/28/2014 17:35:57 In the next section, the signal- Ô¨Çow model will help us visualize the process of determining alternative representations in state space of the same system. We will see that even though a system can be the same with respect to its input and output terminals, the state-space representations can be many and varied. 5.7 Alternative Representations in State Space In Chapter 3, systems were represented in state space in phase-variable form. However, system modeling in state space can take on many representations other than the phase-variable form. Although each of these models yields the same output for a given input, an engineer may prefer a particular one for several reasons. For example, one set of state variables, with its unique representation, can model actual physical variables of a system,such as ampli Ô¨Åer and Ô¨Ålter outputs. Another motive for choosing a particular set of state variables and state-space model is ease of solution. As we will see, a particular choice of state variables can decouple thesystem of simultaneous differential equations. Here each equation is written in terms of onlyone state variable, and the solution is effected by solving nÔ¨Årst-order differential equations individually. Ease of modeling is another reason for a particular choice of state variables. Certain choices may facilitate converting the subsystem to the state-variable representation by usingrecognizable features of the model. The engineer learns quickly how to write the state andoutput equations and draw the signal- Ô¨Çow graph, both by inspection. These converted subsystems generate the de Ô¨Ånition of the state variables. We will now look at a few representative forms and show how to generate the state- space representation for each. Cascade Form We have seen that systems can be represented in state space with the state variables chosento be the phase variables, that is, variables that are successive derivatives of each other. Thisis by no means the only choice. Returning to the system of Figure 3.10( a), the transfer function can be represented alternately as C s¬Ü R s¬Ü¬à24 s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü(5.37) Figure 5.23 shows a block diagram representation of this system formed by cascading each term of Eq. (5.37). The output of each Ô¨Årst-order system block has been labeled as a state variable. These state variables are not the phase variables. We now show how the signal-Ô¨Ç ow graph can be used to obtain a state-space representation of this system. In order to write the state equations with our new set ofSkill-Assessment Exercise 5.5 PROBLEM: Draw a signal- Ô¨Çow graph for the following state and output equations: _x¬à 210 0 31  3 4 52 643 75x¬á0 0 12 643 75r y¬à¬â010 ¬äx ANSWER: The complete solution is at www.wiley.com/college/nise .256 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:58 state variables, it is helpful to draw a signal- Ô¨Çow graph Ô¨Årst, using Figure 5.23 as a guide. The signal Ô¨Çow for each Ô¨Årst-order system of Figure 5.23 can be found by transforming each block into an equivalent differential equation. Each Ô¨Årst-order block is of the form Ci s¬Ü Ri s¬Ü¬à1 s¬áai¬Ü(5.38) Cross-multiplying, we get s¬áai¬ÜCi s¬Ü¬àRi s¬Ü (5.39) After taking the inverse Laplace transform, we have dci t¬Ü dt¬áaici t¬Ü¬àri t¬Ü (5.40) Solving for dci(t)/dtyields dci t¬Ü dt¬à aici t¬Ü¬ári t¬Ü (5.41) Figure 5.24( a) shows the implementation of Eq. (5.41) as a signal-Ô¨Çow graph. Here again, a node was assumed for ci(t) at the output of an integrator, and its derivative was formed at the input. Cascading the transfer functions shown in Figure 5.24( a), we arrive at the system representation shown in Figure 5.24( b).2Now write the state equations for the new representation of the system. Remember that the derivative of a state variable will be at the input to each integrator: _x1¬à 4x1¬áx2 (5.42a) _x2¬à  3x2¬áx3 (5.42b) _x3¬à  2x3¬á24r (5.42c) ‚Äì2 ‚Äì3 ‚Äì424 1 1 1 (b)R(s) C(s)1 s1 s1 s X3(s) X2(s) X1(s)‚ÄìaiRi(s)1 (a)1 s sCi(s)Ci(s) FIGURE 5.24 a.First-order subsystem; b.Signal- Ô¨Çow graph for Figure 5.23 systemR(s) X3(s)C(s) s + 211124s + 3 s + 4 X2(s) X1(s)FIGURE 5.23 Representation of Figure 3.10 system as cascaded Ô¨Årst-order systems 2Note that node X3(s) and the following node cannot be merged, or else the input to the Ô¨Årst integrator would be changed by the feedback from X2(s), and the signal X3(s) would be lost. A similar argument can be made for X2(s) and the following node.5.7 Alternative Representations in State Space 257WEBC05 10/28/2014 17:35:58 The output equation is written by inspection from Figure 5.24( b): y¬àc t¬Ü¬àx1 (5.43) The state-space representation is completed by rewriting Eqs. (5.42) and (5.43) in vector- matrix form: _x¬à 410 0 31 00  22 435x¬á0 0 242 435r (5.44a) y¬à100/C2/C3 x (5.44b) Comparing Eqs. (5.44) with Figure 5.24( b), you can form a vivid picture of the meaning of some of the components of the state equation. For the following discussion, please refer back to the general form of the state and output equations, Eqs. (3.18) and (3.19). For example, the Bmatrix is the input matrix since it contains the terms that couple the input, r(t), to the system. In particular, the constant 24 appears in both the signal- Ô¨Çow graph at the input, as shown in Figure 5.24( b), and the input matrix in Eqs. (5.44). The Cmatrix is the output matrix since it contains the constant that couples the state variable, x 1, to the output, c(t). Finally, the Amatrix is the system matrix since it contains the terms relative to the internal system itself. In the form of Eqs. (5.44), the system matrix actually contains the system poles along the diagonal. Compare Eqs. (5.44) to the phase-variable representation in Eqs. (3.59). In that representation, the coef Ô¨Åcients of the system ‚Äôs characteristic polynomial appeared along the last row, whereas in our current representation, the roots of the characteristic equation, the system poles, appear along the diagonal. Parallel Form Another form that can be used to represent a system is the parallel form. This form leads toanAmatrix that is purely diagonal, provided that no system pole is a repeated root of the characteristic equation. Whereas the previous form was arrived at by cascading the individual Ô¨Årst-order subsystems, the parallel form is derived fro m a partial-fraction ex pansion of the system transfer function. Performing a partial-fraction expansion on our example system,we get C s¬Ü R s¬Ü¬à24 s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü¬à12 s¬á2¬Ü 24 s¬á3¬Ü¬á12 s¬á4¬Ü(5.45) Equation (5.45) represents the sum of the individual Ô¨Årst-order subsystems. To arrive at a signal- Ô¨Çow graph, Ô¨Årst solve for C(s), C s¬Ü¬àR s¬Ü12 s¬á2¬Ü R s¬Ü24 s¬á3¬Ü¬áR s¬Ü12 s¬á4¬Ü(5.46) and recognize that C(s) is the sum of three terms. Each term is a Ô¨Årst- order subsystem with R(s) as the input. Formulating this idea as a signal-Ô¨Çow graph renders the representation shown in Figure 5.25. Once again, we use the signal- Ô¨Çow graph as an aid to obtaining the state equations. By inspection the state variablesare the outputs of each integrator, where the derivatives of the statevariables exist at the integrator inputs. We write the state equations‚Äì2 ‚Äì3 ‚Äì4R(s)‚Äì24 112 121 1C(s)1 s 1 sX1(s) X2(s) X3(s)1 s FIGURE 5.25 Signal- Ô¨Çow representation of Eq. (5.45)258 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:35:59 by summing the signals at the integrator inputs: _x1¬à 2x1 ¬á12r (5.47a) _x2¬à  3x2  24r (5.47b) _x3¬à  4x3¬á12r (5.47c) The output equation is found by summing the signals that give c(t): y¬àc t¬Ü¬àx1¬áx2¬áx3 (5.48) In vector-matrix form, Eqs. (5.47) and (5.48) become _x¬à 200 0 30 00  42 435x¬á12  24 122 435r (5.49) and y¬à¬â111 ¬äx (5.50) Thus, our third representation of the system of Figure 3.10( a) yields a diagonal system matrix. What is the advantage of this representation? Each equation is a Ô¨Årst-order differential equation in only one variable. Thus, we would solve these equations independently. The equations are said to be decoupled . Students who are using MATLAB should now run ch5p3 in Appendix B.You will learn how to use MATLAB to convert a transfer function tostate space in a speci Ô¨Åed form. The exercise solves the previous example by representing the transfer function in Eq.(5.45)by thestate-space representation in parallel form of Eq.(5.49) . If the denominator of the transfer function has repeated real roots, the parallel form can still be derived from a partial-fraction expansion. However, the system matrix will notbe diagonal. For example, assume the system C s¬Ü R s¬Ü¬à s¬á3¬Ü s¬á1¬Ü2 s¬á2¬Ü(5.51) which can be expanded as partial fractions: C s¬Ü R s¬Ü¬à2 s¬á1¬Ü2 1 s¬á1¬Ü¬á1 s¬á2¬Ü(5.52) Proceeding as before, the signal-Ô¨Ç ow graph for Eq. (5.52) is shown in Figure 5.26. The term  1= s¬á1¬Üwas formed by creating the signal Ô¨Çow from X2(s)t oC(s). Now the state and output equations can be written by inspection from Figure 5.26 as follows: _x1¬à x1¬áx2 (5.53a) _x2¬à  x2 ¬á2r (5.53b) _x3¬à  2x3¬ár (5.53c) y¬àc t¬Ü¬à x1 1 2x2¬áx3 (5.53d)‚Äì1 ‚Äì11 1 2‚Äì21 1 1 ‚Äì2R(s) C(s) X3(s)1 s X2(s) X1(s) 1 s1 s FIGURE 5.26 Signal- Ô¨Çow representation of Eq. (5.52)5.7 Alternative Representations in State Space 259WEBC05 10/28/2014 17:35:59 or, in vector-matrix form, _x¬à 110 0 10 00  22 435x¬á0 212 435r (5.54a) y¬à1  1 21/C20/C21 x (5.54b) This system matrix, although not diagonal, has the system poles along the diagonal. Notice the 1 off the diagonal for the case of the repeated root. The form of the system matrix isknown as the Jordan canonical form . Controller Canonical Form Another representation that uses phase variables is called the controller canonical form ,s o named for its use in the design of controllers, which is covered in Chapter 12. This form isobtained from the phase-variable form simply by ordering the phase variables in the reverseorder. For example, consider the transfer function G s¬Ü¬à C s¬Ü R s¬Ü¬às2¬á7s¬á2 s3¬á9s2¬á26s¬á24(5.55) The phase-variable form was derived in Example 3.5 as _x1 _x2 _x32 643 75¬à01 0 00 1  24  26  92 643 75x1 x2 x32 643 75¬á0 0 12 643 75r (5.56a) y¬à271/C2/C3x1 x2 x32 435 (5.56b) where y¬àc t¬Ü. Renumbering the phase variables in reverse order yields _x 3 _x2 _x12 643 75¬à01 0 00 1  24  26  92 643 75x3 x2 x12 643 75¬á0 0 12 643 75r (5.57a) y¬à271/C2/C3x3 x2 x12 435 (5.57b) Finally, rearranging Eqs. (5.57) in ascending numerical order yields the controller canonical form 3as _x1 _x2 _x32 643 75¬à 9 26  24 100 0102 643 75x1 x2 x32 643 75¬á1 0 02 643 75r (5.58a) y¬à172/C2/C3x1 x2 x32 435 (5.58b)TryIt 5.3 Use the following MATLAB and Control System Toolboxstatements to convert the transferfunction of Eq. (5.55) to the controller canonical state-space representation of Eqs. (5.58). numg= [1 7 2] ; deng= [1 9 26 24] ;[Acc, Bcc, Ccc, Dcc] ... =tf2ss (numg, deng) 3Students who are using MATLAB to convert from transfer functions to state space using the command tf2ss will notice that MATLAB reports the results in controller canonical form.260 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:0 Figure 5.27 shows the steps we have taken on a signal-Ô¨Çow graph. Notice that the controller canonical form is obtained simply by renumbering the phase variables in the opposite order.Equations (5.56) can be obtained from Figure 5.27( a), and Eqs. (5.58) from Figure 5.27( b). Notice that the phase-variable form and the controller canonical form contain the coefÔ¨Åcients of the characteristic polynomial in the bottom row and in the top row, respectively. System matrices that contain the coef Ô¨Åcients of the characteristic polynomial are called companion matrices to the characteristic polynomial. The phase-variable and controller canonical forms result in a lower and an upper companion system matrix,respectively. Companion matrices can also have the coef Ô¨Åcients of the characteristic polynomial in the left or right column. In the next subsection, we discuss one of theserepresentations. Observer Canonical Form Theobserver canonical form , so named for its use in the design of observers (covered in Chapter 12), is a representation that yields a left companion system matrix. As an example,the system modeled by Eq. (5.55) will be represented in this form. Begin by dividing allterms in the numerator and denominator by the highest power of s,s 3, and obtain C s¬Ü R s¬Ü¬à1 s¬á7 s2¬á2 s3 1¬á9 s¬á26 s2¬á24 s3(5.59) Cross-multiplying yields 1 s¬á7 s2¬á2 s3/C20/C21 R s¬Ü¬à 1¬á9 s¬á26 s2¬á24 s3/C20/C21 C s¬Ü (5.60) Combining terms of like powers of integration gives C s¬Ü¬à1 s¬âR s¬Ü 9C s¬Ü¬ä ¬á1 s2¬â7R s¬Ü 26C s¬Ü¬ä ¬á1 s3¬â2R s¬Ü 24C s¬Ü¬ä (5.61) or C s¬Ü¬à1 s¬âR s¬Ü 9C s¬Ü¬ä ¬á1 s¬â7R s¬Ü 26C s¬Ü¬ä ¬á1 s¬â2R s¬Ü 24C s¬Ü¬ä/C18/C19 /C20/C21 (5.62)R(s) C(s)1 X3(s) X2(s) X1(s)1 21 7 ‚Äì9 ‚Äì26 ‚Äì24R(s) C(s) X1(s) X2(s) X3(s)1 21 7 ‚Äì9 ‚Äì26 ‚Äì24 (a)( b)s1 s1 s1 s1 s1 s FIGURE 5.27 Signal- Ô¨Çow graphs for obtaining forms for G s¬Ü¬àC s¬Ü=R s¬Ü¬à s2¬á7s¬á2¬Ü= s3¬á9s2¬á26s¬á24¬Ü:a.phase-variable form; b.controller canonical form5.7 Alternative Representations in State Space 261WEBC05 10/28/2014 17:36:0 Equation (5.61) or (5.62) can be used to draw the signal- Ô¨Çow graph. Start with three integrations, as shown in Figure 5.28( a). Using Eq. (5.61), the Ô¨Årst term tells us that output C(s) is formed, in part, by integrating ¬âR s¬Ü 9C s¬Ü¬ä. We thus form ¬âR s¬Ü 9C s¬Ü¬äat the input to the integrator closest to the output, C(s), as shown in Figure 5.28( b). The second term tells us that the term ¬â7R s¬Ü 26C s¬Ü¬ämust be integrated twice. Now form ¬â7R s¬Ü 26C s¬Ü¬äat the input to the second integrator. Finally, the last term of Eq. (5.61) says ¬â2R s¬Ü 24C s¬Ü¬ämust be integrated three times. Form ¬â2R s¬Ü 24C s¬Ü¬äat the input to the Ô¨Årst integrator. Identifying the state variables as the outputs of the integrators, we write the following state equations: _x1¬à  9x1¬áx2 ¬ár (5.63a) _x2¬à 26x1 ¬áx3¬á7r (5.63b) _x3¬à 24x1 ¬á2r (5.63c) The output equation from Figure 5.28( b)i s y¬àc t¬Ü¬àx1 (5.64) In vector-matrix form, Eqs. (5.63) and (5.64) become _x¬à 910  26 0 1  24 0 02 435x¬á1 722 435r (5.65a) y¬à¬â100 ¬äx (5.65b) Notice that the form of Eqs. (5.65) is similar to the phase-variable form, except that the coefÔ¨Åcients of the denominator of the transfer function are in the Ô¨Årst column, and the coefÔ¨Åcients of the numerator form the input matrix, B. Also notice that the observer canonical form has an Amatrix that is the transpose of the controller canonical form, a B vector that is the transpose of the controller canonical form ‚ÄôsCvector, and a Cvector that is the transpose of the controller canonical form ‚ÄôsBvector. We therefore say that these two forms are duals . Thus, if a system is described by A, B, andC, its dual is described by‚Äì9 ‚Äì26111 ‚Äì24271 (b)X3(s) X2(s) X1(s)C(s)111 (a)R(s) R(s)X3(s) X2(s) X1(s)C(s)1 s1 s1 s 1 s1 s1 s FIGURE 5.28 Signal- Ô¨Çow graph for observer canonical form variables: a.planning; b.implementation TryIt 5.4 Use the following MATLAB and Control System Toolbox statements to convert the transfer function of Eq. (5.55) to theobserver canonical state-spacerepresentation of Eqs. (5.65). numg= [1 7 2] ; deng= [1 9 26 24] ; [Acc, Bcc, Ccc, Dcc] ... =tf2ss (numg, deng) ; Aoc=transpose(Acc) Boc=transpose(Ccc) Coc=transpose(Bcc)262 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:1 AD¬àAT;BD¬àCT;CD¬àBT. You can verify the signi Ô¨Åcance of duality by comparing the signal- Ô¨Çow graphs of a system and its dual, Figures 5.27( b) and 5.28( b), respectively. The signal- Ô¨Çow graph of the dual can be obtained from that of the original by reversing all arrows, changing state variables to their derivatives and vice versa, and interchanging C(s) andR(s), thus reversing the roles of the input and the output. We conclude this section with an example that demonstrates the application of the previously discussed forms to a feedback control system. Example 5.8 State-Space Representation of Feedback SystemsState-Space Representation of Feedback Systems PROBLEM: Represent the feedback control system shown in Figure 5.29 in state space. Model the forward tr ansfer function in cascade form. SOLUTION: First we model the forward transfer function in cascade form. The gain of 100, the pole at  2, and the pole at  3 are shown cascaded in Figure 5.30( a). The zero at  5 was obtained using the method for implementing zeros for a system represented in phase-variable form, as discussed in Section 3.5. Next add the feedback and input paths, as shown in Figure 5.30( b). Now, by inspection, write the state equations: _x1¬à 3x1¬áx2 (5.66a) _x2¬à  2x2¬á100 r c¬Ü (5.66b) But, from Figure 5.30 (b), c¬à5x1¬á x2 3x1¬Ü¬à2x1¬áx2 (5.67) Substituting Eq. (5.67) into Eq. (5.66b), we Ô¨Ånd the state equations for the system: _x1¬à  3x1 ¬áx2 (5.68a) _x2¬à 200x1 102x2¬á100r (5.68b) R(s)100 11 5 C(s) ‚Äì1 (b)1 s1 s ‚Äì2 ‚Äì31 X1(s) X2(s) E(s)E(s)100 ‚Äì21 ‚Äì351 1 s ( )(a)1 s C(s) X2(s) X1(s) FIGURE 5.30 Creating a signal- Ô¨Çow graph for the Figure 5.29 system: a.forward transfer function; b.complete systemR(s) + ‚ÄìE(s) C(s) (s + 2)(s + 3)100(s + 5) FIGURE 5.29 Feedback control system for Example 5.85.7 Alternative Representations in State Space 263WEBC05 10/28/2014 17:36:2 In this section, we used transfer functions and signal-Ô¨Çow graphs to represent systems in parallel, cascade, controller canonical, and observer canonical forms, in addition to the phase-variable form. Using the transfer function C s¬Ü=R s¬Ü¬à s¬á3¬Ü=¬â s¬á4¬Ü s¬á6¬Ü¬äas an example, Figure 5.31 compares the aforementioned forms. Notice the duality of the controllerand observer canonical forms, as demonstrated by their respective signal- Ô¨Çow graphs and stateThe output equation is the same as Eq. (5.67), or y¬àc t¬Ü¬à2x1¬áx2 (5.69) In vector-matrix form _x¬à 31  200  102/C20/C21 x¬á0 100/C20/C21 r (5.70a) y¬à¬â21 ¬äx (5.70b) Skill-Assessment Exercise 5.6 PROBLEM: Represent the feedback control system shown in Figure 5.29 in state space. Model the forward transfer function in controller canonical form. ANSWER: _x¬à 105  506 10/C20/C21 x¬á1 0/C20/C21 r y¬à¬â100 500 ¬äx The complete solution is at www.wiley.com/college/nise . R(s) C(s) X2(s)1 s X1(s)1 ‚Äì10 ‚Äì24Phase variableForm Transfer function Signal-flow diagram State equations 31 s1 (s2 + 10s + 24)(s + 3) Parallel1 ‚Äì62 X2(s)X1(s) C(s) R(s)1 1‚Äì41 s 1 s1 2‚Äì 23(s + 4) s + 6+* x = y = [1 1] xx + ‚Äì41 2 00 ‚Äì 6x = r ry = [3 1] xx + 00 ‚Äì241 . .1 ‚Äì 10 3 2‚Äì FIGURE 5.31 State-space forms for C s¬Ü=R s¬Ü¬à s¬á3¬Ü=¬â s¬á4¬Ü s¬á6¬Ü¬ä. Note: y¬àc t¬Ü(Ô¨Ågure continues )264 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:2 equations. In the next section, we will explore the possibility of transforming between representations without using transfer functions and signal- Ô¨Çow graphs. 5.8 Similarity Transformations In Section 5.7, we saw that systems can be represented with different state variables eventhough the transfer function relating the output to the input remains the same. The variousforms of the state equations were found by manipulating the transfer function, drawing asignal- Ô¨Çow graph, and then writing the state equations from the signal-Ô¨Ç ow graph. These systems are called similar systems . Although their state-space representations are different, similar systems have the same transfer function and hence the same poles and eigenvalues. We can make transformations between similar systems from one set of state equations to another without using the transfer function and signal-Ô¨Ç ow graphs. The results are presented in this section along with examples. Students who have not broached this subjectin the past or who wish to refresh their memories are encouraged to study Appendix L atwww.wiley.com/college/nise for the derivation. The result of the derivation states: A system represented in state space as x¬àAx¬áBu (5.71a) y¬àCx¬áDu (5.71b) can be transformed to a similar system, z¬àP 1APz ¬áP 1Bu (5.72a) y¬àCPz ¬áDu (5.72b)C(s) X1(s) X2(s) ‚Äì4 ‚Äì6 131 1 s1 s C(s) X1(s)R(s) X2(s)s1 1 3 1 s1 ‚Äì10 ‚Äì241 C(s) R(s) X2(s)3 s1 ‚Äì241 1 s1 1 X1(s) ‚Äì10Cascade1 (s + 4) (s + 6)(s + 3) * Observer canonicalController canonical1 (s2 + 10s + 24)(s + 3)*. . .x = r y = [‚Äì3 1] xx + ‚Äì6 0 01 1 ‚Äì4 x = r y = [1 3] xx + ‚Äì10 1 1‚Äì24 0 0 x = r y = [1 0] xx + ‚Äì10 1 ‚Äì241 3 0Form Transfer function Signal-flow diagram State equations s10 s241 +2+s1 s3 2+R(s)1 FIGURE 5.31 (Continued )5.8 Similarity Transformations 265WEBC05 10/28/2014 17:36:3 where, for 2-space, P¬à¬âUz1Uz2¬ä¬àp11p12 p21p22"# (5.72c) x¬àp11p12 p21p22"# z1 z2"# ¬àPz (5.72d) and z¬àP 1x (5.72e) Thus, Pis a transformation matrix whose columns are the coordinates of the basis vectors of the z1z2space expressed as linear combinations of the x1x2space. Let us look at an example. Example 5.9 Similarity Transformations on State EquationsSimilarity Transformations on State Equations PROBLEM: Given the system represented in state space by Eqs. (5.73), _x¬à010 001  2 5 72 435x¬á0 012 435u (5.73a) y¬à¬â100 ¬äx (5.73b) transform the system to a new set of state variables, z, where the new state variables are related to the original state variables, x, as follows: z 1¬à2x1 (5.74a) z2¬à3x1¬á2x2 (5.74b) z3¬àx1¬á4x2¬á5x3 (5.74c) SOLUTION: Expressing Eqs. (5.74) in vector-matrix form, z¬à200 3201452 435x¬àP  1x (5.75) Using Eqs. (5.72) as a guide, P 1AP¬à200 3201452 643 75010 001  2  5  72 643 750:500  0:75 0 :50 0:5  0:40 :22 643 75 ¬à 1:51 0  1:25 0 :70 :4  2:50 :4  6:22 643 75 (5.76)266 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:4 Thus far we have talked about transforming systems between basis vectors in a different state space. One major advantage of Ô¨Ånding these similar systems is apparent in the transformation to a system that has a diagonal matrix. Diagonalizing a System Matrix In Section 5.7, we saw that the parallel form of a signal- Ô¨Çow graph can yield a diagonal system matrix. A diagonal system matrix has the advantage that each state equation is a function of only one state variable. Hence, each differential equation can be solved independently of the other equations. We say that the equations are decoupled. Rather than using partial fraction expansion and signal- Ô¨Çow graphs, we can decouple a system using matrix transformations. If we Ô¨Ånd the correct matrix, P, the transformed system matrix, P 1AP, will be a diagonal matrix. Thus, we are looking for a transformation to another state space that yields a diagonal matrix in that space. This new state space also has basisvectors that lie along its state variables. We give a special name to any vectors that are collinearwith the basis vectors of the new system that yields a diagonal system matrix: they are called eigenvectors . Thus, the coordinates of the eigenvectors form the columns of the transformation matrix, P, as we demonstrate in Eq. L.7 in Appendix L at www.wiley.com/college/nise . First, let us formally de Ô¨Åne eigenvectors from another perspective and then show that they have the property just described. Then we will de Ô¨Åne eigenvalues. Finally, we will show how to diagonalize a matrix. DeÔ¨Ånitions Eigenvector . The eigenvectors of the matrix Aare all vectors, xi6¬à0, which under the transformation Abecome multiples of themselves; that is, Axi¬àŒªixi (5.80) where Œªi‚Äôs are constants. Figure 5.32 shows this de Ô¨Ånition of eigenvectors. If Axis not collinear with xafter the transformation, as in Figure 5.32( a),xis not an eigenvector. If Axis collinear with xafter the transformation, as in Figure 5.32( b),xis an eigenvector.P 1B¬à200 320 1452 643 750 0 12 643 75¬à0 0 52 643 75 (5.77) CP¬à100/C2/C30:50 0  0:75 0 :50 0:5  0:40 :22 643 75¬à0:500/C2/C3 (5.78) Therefore, the transformed system is _z¬à 1:51 0  1:25 0 :70 :4  2:55 0 :4  6:22 643 75z¬á0 0 52 643 75u (5.79a) y¬à¬â0:50 0¬äz (5.79b) Students who are using MATLAB should now run ch5p4 in Appendix B. You will learn how to perform similarity transformations. This exercise uses MATLAB to do Example 5.9.5.8 Similarity Transformations 267WEBC05 10/28/2014 17:36:5 Eigenvalue . The eigenvalues of the matrix Aare the values of Œªithat satisfy Eq. (5.80) for xi6¬à0. ToÔ¨Ånd the eigenvectors, we rearrange Eq. (5.80). Eigenvectors, xi, satisfy 0¬à ŒªiI A¬Üxi (5.81) Solving for xiby premultiplying both sides by ŒªiI A¬Ü 1yields xi¬à ŒªiI A¬Ü 10¬àadj ŒªiI A¬Ü det ŒªiI A¬Ü0 (5.82) Since xi6¬à0, a nonzero solution exists if det ŒªiI A¬Ü¬à0 (5.83) from which Œªi, the eigenvalues, can be found. We are now ready to show how to Ô¨Ånd the eigenvectors, xi. First we Ô¨Ånd the eigenvalues, Œªi, using det ŒªiI A¬Ü¬à0, and then we use Eq. (5.80) to Ô¨Ånd the eigenvectors.(b)Axxx2 x1x2 Ax x (a)x1FIGURE 5.32 To be an eigenvector, the transformation Axmust be collinear with x; thus, in (a), xis not an eigenvector; in (b), it is. Example 5.10 Finding EigenvectorsFinding Eigenvectors PROBLEM: Find the eigenvectors of the matrix A¬à 31 1 3/C20/C21 (5.84) SOLUTION: The eigenvectors, xi, satisfy Eq. (5.81). First, use det ŒªiI A¬Ü¬à0t oÔ¨Ånd the eigenvalues, Œªi, for Eq. (5.81): det ŒªI A¬Ü¬à/C12/C12/C12/C12/C12Œª0 0Œª"#   31 1 3"# /C12/C12/C12/C12/C12 ¬à/C12/C12/C12/C12/C12Œª¬á3  1  1 Œª¬á3/C12/C12/C12/C12/C12 ¬àŒª 2¬á6Œª¬á8 (5.85) from which the eigenvalues are Œª¬à 2, and  4. Using Eq. (5.80) successively with each eigenvalue, we have Axi¬àŒªxi  31 1 3"#x1 x2"# ¬à 2"x1 x2# (5.86)268 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:6 We now show that if the eigenvectors of the matrix Aare chosen as the basis vectors of a transformation, P, the resulting system matrix will be diagonal. Let the transformation matrix Pconsist of the eigenvectors of A, x i. P¬à¬âx1;x2;x3;... ;xn¬ä (5.91) Since xiare eigenvectors, Axi¬àŒªixi, which can be written equivalently as a set of equations expressed by AP¬àPD (5.92) where Dis a diagonal matrix consisting of Œªi‚Äôs, the eigenvalues, along the diagonal, and Pis as de Ô¨Åned in Eq. (5.91). Solving Eq. (5.92) for Dby premultiplying by P 1, we get D¬àP 1AP (5.93) which is the system matrix of Eq. (5.72). In summary, under the transformation P, consisting of the eigenvectors of the system matrix, the transformed system is diagonal, with the eigenvalues of the system along the diagonal. The transformed system is identical to that obtained using partial-fraction expansion of the transfer function with distinct real roots. In Example 5.10, we found eigenvectors of a second-order system. Let us continue with this problem and diagonalize the system matrix.or  3x1¬áx2¬à 2x1 (5.87a) x1 3x2¬à 2x2 (5.87b) from which x1¬àx2. Thus, x¬àc c/C20/C21 (5.88) Using the other eigenvalue,  4, we have x¬à" c  c# (5.89) Using Eqs. (5.88) and (5.89), one choice of eigenvectors is x1¬à1 1"# and x2¬à1  1"# (5.90) Example 5.11 Diagonalizing a System in State SpaceDiagonalizing a System in State Space PROBLEM: Given the system of Eqs. (5.94), Ô¨Ånd the diagonal system that is similar. _x¬à 31 1 3/C20/C21 x¬á1 2/C20/C21 u (5.94a) y¬à¬â23 ¬äx (5.94b)5.8 Similarity Transformations 269WEBC05 10/28/2014 17:36:7 Students who are using MATLAB should now run ch5p5 in Appendix B. This problem, which uses MATLAB to diagonalize a system, is similar (but not identical)to Example 5.11.SOLUTION: FirstÔ¨Ånd the eigenvalues and the eigenvectors. This step was performed in Example 5.10. Next form the transformation matrix P, whose columns consist of the eigenvectors. P¬à11 1 1/C20/C21 (5.95) Finally, form the similar system ‚Äôs system matrix, input matrix, and output matrix, respectively. P 1AP¬à1=21 =2 1=2 1=2/C20/C21 31 1 3/C20/C21111 1/C20/C21 ¬à 20 0 4/C20/C21 (5.96a) P  1B¬à1=21 =2 1=2 1=2/C20/C2112/C20/C21 ¬à3=2  1=2/C20/C21 (5.96b) CP¬à23/C2/C3 111 1/C20/C21 ¬à5 1/C2/C3 (5.96c) Substituting Eqs. (5.96) into Eqs. (5.72), we get _z¬à 20 0 4"# z¬á3=2  1=2"# u (5.97a) y¬à¬â5 1¬äz (5.97b) Notice that the system matrix is diagonal, with the eigenvalues along the diagonal. Skill-Assessment Exercise 5.7 PROBLEM: For the system represented in state space as follows: _x¬à13  4  6"# x¬á1 3"# u y¬à14/C2/C3 x convert the system to one where the new state vector, z,i s z¬à3 2 1 4/C20/C21 x ANSWER: _z¬à6:5 8:5 9:5 11 :5"# z¬á 3  11"# u y¬à0:8 1:4/C2/C3 z The complete solution is at www.wiley.com/college/nise .270 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:7 In this section, we learned how to move between different state-space representations of the same system via matrix transformations rather than transfer function manipulation and signal- Ô¨Çow graphs. These different representations are called similar . The characteristics of similar systems are that the transfer functions relating the output to the input are the same,as are the eigenvalues and poles. A particularly useful transformation was converting asystem with distinct, real eigenvalues to a diagonal system matrix. We now summarize the concepts of block diagram and signal- Ô¨Çow representations of systems, Ô¨Årst through case study problems an dt h e ni naw r i t t e ns u m m a r y .O u r case studies include the antenna azimuth position control system and the UnmannedFree-Swimming Submersible vehicle (UFSS). B lock diagram reduction is important for the analysis and design of these systems as well as the control systems on board Alvin (Figure 5.33), used to explore the wreckage of the Titanic 13,000 feet under the Atlantic in July 1986 ( Ballard ,1987 ).Skill-Assessment Exercise 5.8 PROBLEM: For the original system of Skill-Assessment Exercise 5.7, Ô¨Ånd the diagonal system that is similar. ANSWER: _z¬à 20 0 3"# z¬á18:39 20"# u y¬à  2:121 2 :6/C2/C3 z The complete solution is at www.wiley.com/college/nise .TryIt 5.5 Use the following MATLAB and Control System Toolbox statementsto do Skill-Assessment Exercise 5.8. A=[1 3;  4 6] ; B=[1; 3] ; C=[1 4] ; D=0;S=ss(A, B, C, D) ; Sd=canon(S, 'modal ' )¬© Rob Catanach, Woods Hole Oceano graphic Institution. FIGURE 5.33 Alvin , a manned submersible, explored the wreckage of the Titanic with a tethered robot, Jason Junior.5.8 Similarity Transformations 271WEBC05 10/28/2014 17:36:11 Case Studies Antenna Control: Designing a Closed-Loop ResponseAntenna Control: Designing a Closed-Loop Response This chapter has shown that physical subsystems can be modeled mathematically with transfer functions and then interconnected to form a feedback system. The interconnectedmathematical models can be reduced to a single transfer function representing the systemfrom input to output. This transfer function, the closed-loop transfer function, is then usedto determine the system response. The following case study shows how to reduce the subsystems of the antenna azimuth position control system to a single, closed-loop transfer function in order toanalyze and design the transient response characteristics. PROBLEM: Given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 1, do the following: a.Find the closed-loop transfer function using block diagram reduction. b.Represent each subsystem with a signal- Ô¨Çow graph and Ô¨Ånd the state-space representation of the closed-loop system from the signal- Ô¨Çow graph. c.Use the signal- Ô¨Çow graph found in balong with Mason ‚Äôs rule to Ô¨Ånd the closed-loop transfer function. d.Replace the power ampli Ô¨Åer with a transfer function of unity and evaluate the closed-loop peak time, percent overshoot, and settling time for K¬à1000. e.For the system of d, derive the expression for the closed-loop step response of the system. f.For the simpli Ô¨Åed model of d,Ô¨Ånd the value of Kthat yields a 10% overshoot. SOLUTION: Each subsystem ‚Äôs transfer function was evaluated in the case study in Chapter 2. We Ô¨Årst assemble them into the closed-loop, feedback control system block diagram shown in Figure 5.34( a). a.The steps taken to reduce the block diagram to a single, closed-loop transfer function relating the output angular displacement to the input angular displacement are shown inFigure 5.34( a‚Äìd). In Figure 5.34( b), the input potentiometer was pushed to the right past the summing junction, creating a unity feedback system. In Figure 5.34( c), all the blocks of the forward transfer function are multiplied together, forming the equivalentforward transfer function. Finally, the feedback formula is applied, yielding the closed-loop transfer function in Figure 5.34( d). b.In order to obtain the signal- Ô¨Çow graph of each subsystem, we use the state equations derived in the case study of Chapter 3. The signal- Ô¨Çow graph for the power ampli Ô¨Åer is drawn from the state equations of Eqs. (3.87) and (3.88), and the signal-Ô¨Çow graph of the motor and load is drawn from the state equation of Eq. (3.98). Other subsystems arepure gains. The signal- Ô¨Çow graph for Figure 5.34( a) is shown in Figure 5.35 and consists of the interconnected subsystems. The state equations are written from Figure 5.35. First de Ô¨Åne the state variables as the outputs of the integrators. Hence, the state vector is x¬àx 1 x2 ea2 435 (5.98)272 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:17 Using Figure 5.35, we write the state equations by inspection: _x1¬à¬á x2 (5.99a) _x2¬à  1:71x2¬á2:083ea (5.99b) _ea¬à 3:18Kx1  100ea¬á31:8KŒ∏i (5.99c) along with the output equation, y¬àŒ∏o¬à0:1x1 (5.100) where 1 =œÄ¬à0:318. In vector-matrix form, _x¬à01 0 0  1:71 2 :083  3:18K 0  1002 643 75x¬á0 0 31:8K2 643 75Œ∏i (5.101a) y¬à¬â0:100 ¬äx (5.101b)K Vp(s)100 s1 s1 s1 0.1 ‚Äì100 ‚Äì1.71 1X1(s)2.083 ‚ÄìŒ∏o (s) Œ∏i (s) Ea(s) X2(s) œÄ1 œÄ FIGURE 5.35 Signal- Ô¨Çow graph for the antenna azimuth position control system(d)6.63 K s3 + 101.71s2 + 171s + 6.63 K‚Äì+ (c)6.63 K s(s + 1.71)(s + 100)(b)‚Äì+ KPreamplifier and potentiometersPower amplifierMotor, load, and gears 100 s + 1000.2083 s(s + 1.71)Ea(s) Vp(s)1 ‚Äì+Input potentiometer KPreamplifier 100 s + 100Power amplifier 0.2083Motor, load, and gears 1 Output potentiometer (a)s(s + 1.71)Ea(s) Vp(s) Œ∏i(s) Œ∏i(s) Œ∏i(s)Œ∏o(s) Œ∏o(s) Œ∏i(s) Œ∏o(s)Œ∏o(s) œÄœÄ œÄ FIGURE 5.34 Block diagram reduction for the antennaazimuth position controlsystem: a.original; b.pushing input potentiometer to the rightpast the summing junction;c.showing equivalent forward transfer function; d.Ô¨Ånal closed-loop transfer functionCase Studies 273WEBC05 10/28/2014 17:36:18 c.We now apply Mason ‚Äôs rule to Figure 5.35 to derive the closed-loop transfer function of the antenna azimuth position control system. First Ô¨Ånd the forward-path gains. From Figure 5.35 there is only one forward-path gain: T1¬à1 œÄ/C18/C19 K¬Ü 100¬Ü1 s/C18/C19 2:083¬Ü1 s/C18/C191 s/C18/C19 0:1¬Ü¬à6:63K s3(5.102) Next identify the closed-loop gains. There are three: the power ampli Ô¨Åer loop, GL1(s), with eaat the output; the motor loop, GL2(s), with x2at the output; and the entire system loop, GL3(s), with Œ∏0at the output. GL1 s¬Ü¬à 100 s(5.103a) GL2 s¬Ü¬à 1:71 s(5.103b) GL3 s¬Ü¬à K¬Ü 100¬Ü1 s/C18/C19 2:083¬Ü1 s/C18/C191 s/C18/C19 0:1¬Ü 1 œÄ/C18/C19 ¬à 6:63K s3(5.103c) Only GL1(s) and GL2(s) are nontouching loops. Thus, the nontouching-loop gain is GL1 s¬ÜGL2 s¬Ü¬à171 s2(5.104) Forming ŒîandŒîkin Eq. (5.28), we have Œî¬à1 ¬âGL1 s¬Ü¬áGL2 s¬Ü¬áGL3 s¬Ü¬ä ¬á ¬â GL1 s¬ÜGL2 s¬Ü¬ä ¬à1¬á100 s¬á1:71 s¬á6:63K s3¬á171 s2(5.105) and Œî1¬à1 (5.106) Substituting Eqs. (5.102), (5.105), and (5.106) into Eq. (5.28), we obtain the closed- loop transfer function as T s¬Ü¬àC s¬Ü R s¬Ü¬àT1Œî1 Œî¬à6:63K s3¬á101 :71s2¬á171s¬á6:63K(5.107) d.Replacing the power ampli Ô¨Åer with unity gain and letting the preampli Ô¨Åer gain, K,i n Figure 5.34( b) equal 1,000 yield a forward transfer function, G(s), of G s¬Ü¬à66:3 s s¬á1:71¬Ü(5.108) Using the feedback formula to evaluate the closed-loop transfer function, we obtain T s¬Ü¬à66:3 s2¬á1:71s¬á66:3(5.109) From the denominator, œân¬à8:14;Œ∂¬à0:105. Using Eqs. (4.34), (4.38), and (4.42), the peak time ¬à0:388 second, the percent overshoot ¬à71:77%, and the settling time ¬à4:68 seconds.274 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:19 e.The Laplace transform of the step response is found by Ô¨Årst multiplying Eq. (5.109) by 1/ s, a unit-step input, and expanding into partial fractions: C s¬Ü¬à66:3 s s2¬á1:71s¬á66:3¬Ü¬à1 s s¬á1:71 s2¬á1:71s¬á66:3 ¬à1 s  s¬á0:855¬Ü¬á0:106 8:097¬Ü s¬á0:855¬Ü2¬á 8:097¬Ü2(5.110) Taking the inverse Laplace transform, we Ô¨Ånd c t¬Ü¬à1 e 0:855r cos 8 :097t¬á0:106 sin 8 :097t¬Ü (5.111) f.For the simpli Ô¨Åed model we have G s¬Ü¬à0:0663 K s s¬á1:71¬Ü(5.112) from which the closed-loop transfer function is calculated to be T s¬Ü¬à0:0663 K s2¬á1:71s¬á0:0663 K(5.113) From Eq.(4.39) a 10% overshoot yields Œ∂¬à0:591. Using the denominator of Eq. (5.113), œân¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 0:0663 Kp and 2 Œ∂œân¬à1:71. Thus, Œ∂¬à1:71 2Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 0:0663 Kp ¬à0:591 (5.114) from which K¬à31:6. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives: Referring to the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 2, do the following: a.Find the closed-loop transfer function using block diagram reduction. b.Represent each subsystem with a signal- Ô¨Çow graph and Ô¨Ånd the state-space representation of the closed- loop system from the signal- Ô¨Çow graph. c.Use the signal- Ô¨Çow graph found in (b) along with Mason ‚Äôs rule to Ô¨Ånd the closed-loop transfer function. d.Replace the power ampli Ô¨Åer with a transfer function of unity and evaluate the closed-loop percent overshoot, settling time, and peak time for K¬à5. e.For the system used for (d), derive the expression for the closed-loop step response. f.For the simpli Ô¨Åed model in (d), Ô¨Ånd the value of preampli Ô¨Åer gain, K, to yield 15% overshoot. UFSS Vehicle: Pitch-Angle Control RepresentationUFSS Vehicle: Pitch-Angle Control Representation We return to the Unmanned Free-Swimming Submersible (UFSS) vehicle introduced in the case studies in Chapter 5 ( Johnson ,1980 ). We will represent in state space the pitch- angle control system that is used for depth control. PROBLEM: Consider the block diagram of the pitch control loop of the UFSS vehicle shown on the back endpapers. The pitch angle, Œ∏, is controlled by a commanded pitch angle, Œ∏e, which along with pitch-angle and pitch-rate feedback determines the elevatorCase Studies 275WEBC05 10/28/2014 17:36:21 deÔ¨Çection, Œ¥e, which acts through the vehicle dynamics to determine the pitch angle. Let K1¬àK2¬à1 and do the following: a.Draw the signal-Ô¨Ç ow graph for each subsystem, making sure that pitch angle, pitch rate, and elevator de Ô¨Çection are represented as state variables. Then interconnect the subsystems. b.Use the signal-Ô¨Ç ow graph obtained in ato represent the pitch control loop in state space. SOLUTION: a.The vehicle dynamics are split into two transfer functions, from which the signal- Ô¨Çow graph is drawn. Figure 5.36 shows the division along with the elevator actuator. Each block is drawn in phase-variable form to meet the requirement thatparticular system variables be state vari ables. This result is shown in Figure 5.37( a). The feedback paths are then added to complete the signal- Ô¨Çow graph, which is shown in Figure 5.37( b). ‚Äì1 21s1s 11s1s ‚Äì2 ‚Äì1.23‚Äì0.226 ‚Äì0.0169 ‚Äì1 21 s1s 11 s1 s11 1(a) (b)X1(s) ‚Äì2 ‚Äì1.23‚Äì0.226 ‚Äì0.0169X1(s)ec0.435 0.435‚Äì0.125 ‚Äì0.1251 (s)X2(s) X3(s) X4(s) X4(s) X3(s) X2(s)Œ∏c(s) Œ∏c(s)Œ¥ ec(s)Œ¥ FIGURE 5.37 Signal- Ô¨Çow graph representation of the UFSS vehicle ‚Äôs pitch control system: a.without position and rate feedback; b.with position and rate feedback.(Note: Explicitly required variables are x 1¬àŒ∏; x2¬àdŒ∏=dt, and x4¬àŒ¥e.)ec 2 s + 2eElevator actuator 1Vehicle dynamics (s + 1.23)‚Äì0.125(s + 0.435) s2 + 0.226s + 0.0169(s) (s) Œ∏(s) Œ¥ Œ¥FIGURE 5.36 Block diagram of the UFSS vehicle's elevator and vehicle dynamics, from which a signal- Ô¨Çow graph can be drawn276 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:22 b.By inspection, the derivatives of state variables x1through x4are written as _x1¬à x2 (5.115a) _x2¬à 0:0169 x1 0:226x2¬á0:435x3 1:23x3 0:125x4 (5.115b) _x3¬à  1:23x3 0:125x4 (5.115c) _x4¬à 2x1 ¬á2x2  2x4 2Œ∏c (5.115d) Finally, the output y¬àx1. In vector-matrix form the state and output equations are _x¬à01 0 0  0:0169  0:226  0:795  0:125 00  1:23  0:125 22 0  22 666643 77775x¬á0 00  22 666643 77775Œ∏ c (5.116a) y¬à¬â1000 ¬äx (5.116b) CHALLENGE: We now give you a problem to test your knowledge of this chapter‚Äô s objectives. The UFSS vehicle steers via the heading control system shown in Figure 5.38 and repeated on the back endpapers. A heading command is the input.The input and feedback from the submersible ‚Äôs heading and yaw rate are used to generate a rudder command that steers the submersible ( Johnson ,1980). Let K 1¬à K2¬à1 and do the following: a.Draw the signal- Ô¨Çow graph for each subsystem, making sure that heading angle, yaw rate, and rudder de Ô¨Çection are represented as state variables. Then interconnect the subsystems. b.Use the signal-Ô¨Çow graph obtained in ato represent the heading control loop in state space. c.Use MATLAB to represent the closed-loop UFSS heading controlsystem in state space in controller canonical form. Heading gainHeading commandCommanded rudder deflectionRudder actuatorVehicle dynamics Yaw rate sensorHeadingHeading (yaw) rate ‚ÄìK1 ‚Äì ‚ÄìK2s2 s + 2+ ‚Äì+ ‚Äì0.125(s + 0.437) (s + 1.29)( s + 0.193)œàc(s) Œ¥rc(s) Œ¥r(s) œà(s) œà(s)Rudder deflection 1s FIGURE 5.38 Block diagram of the heading control system for the UFSS vehicleCase Studies 277WEBC05 10/28/2014 17:36:22 Summary One objective of this chapter has been for you to learn how to represent multiple subsystems via block diagrams or signal- Ô¨Çow graphs. Another objective has been to be able to reduce either the block diagram representation or the signal- Ô¨Çow graph representation to a single transfer function. We saw that the block diagram of a linear, time-invariant system consisted of four elements: signals ,systems ,summing junctions , and pickoff points . These elements were assembled into three basic forms: cascade ,parallel , and feedback . Some basic operations were then derived: moving systems across summing junctions and across pickoff points. Once we recognized the basic forms and operations, we could reduce a complicated block diagram to a single transfer function relating input to output. Then we applied themethods of Chapter 4 for analyzing and designing a second-order system for transientbehavior. We saw that adjusting the gain of a feedback control system gave us partial controlof the transient response. The signal- Ô¨Çow representation of linear, time-invariant systems consists of two elements: nodes, which represent signals, and lines with arrows, which represent subsystems. Summing junctions and pickoff points are implicit in signal- Ô¨Çow graphs. These graphs are helpful in visualizing the meaning of the state variables. Also, they can be drawn Ô¨Årst as an aid to obtaining the state equations for a system. Mason ‚Äôs rule was used to derive the system‚Äô s transfer function from the signal-Ô¨Çow graph. This formula replaced block diagram reduction techniques. Mason ‚Äôs rule seems complicated, but its use is simpli Ô¨Åed if there are no nontouching loops. In many of these cases, the transfer function can be written by inspection, with less labor than in the blockdiagram reduction technique. Finally, we saw that systems in state space can be represented using different sets of variables. In the last three chapters, we have covered phase-variable ,cascade ,parallel , controller canonical, and observer canonical forms. A particular representation may be chosen because one set of state variables has a different physical meaning than another set,or because of the ease with which particular state equations can be solved. In the next chapter, we discuss system stability. Without stability we cannot begin to design a system for the desired transient response. We will Ô¨Ånd out how to tell whether a system is stable and what effect parameter values have on a system‚Äô s stability. Review Questions 1.Name the four components of a block diagram for a linear, time-invariant system. 2.Name three basic forms for interconnecting subsystems. 3.For each of the forms in Question 2, state (respectively) how the equivalent transferfunction is found. 4.Besides knowing the basic forms as discussed in Questions 2 and 3, what otherequivalents must you know in order to perform block diagram reduction? 5.For a simple, second-order feedback control system of the type shown in Figure 5.14,describe the effect that variations of forward-path gain, K, have on the transient response. 6.For a simple, second-order feedback control system of the type shown in Figure 5.14, describe the changes in damping ratio as the gain, K, is increased over the underdamped region. 7.Name the two components of a signal- Ô¨Çow graph. 8.How are summing junctions shown on a signal- Ô¨Çow graph?278 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:22 9.If a forward path touched all closed loops, what would be the value of Œîk? 10.Name Ô¨Åve representations of systems in state space. 11.Which two forms of the state-space representation are found using the same method? 12.Which form of the state-space representation leads to a diagonal matrix? 13.When the system matrix is diagonal, what quantities lie along the diagonal? 14.What terms lie along the diagonal for a system represented in Jordan canonical form? 15.What is the advantage of having a system represented in a form that has a diagonal system matrix? 16.Give two reasons for wanting to represent a system by alternative forms. 17.For what kind of system would you use the observer canonical form? 18.Describe state-vector transformations from the perspective of different bases. 19.What is the de Ô¨Ånition of an eigenvector? 20.Based upon your de Ô¨Ånition of an eigenvector, what is an eigenvalue? 21.What is the signi Ô¨Åcance of using eigenvectors as basis vectors for a system transformation? Problems 1.Reduce the block diagram shown in Figure P5.1 to a single transfer function, T s¬Ü¬àC s¬Ü=R s¬ÜUse the following methods: a.Block diagram reduction [Section: 5.2] b.MATLAB s+ ‚ÄìR(s) + 2C(s)s s21 s + 150 + 2‚Äì ‚Äì FIGURE P5.1 2.Find the closed-loop transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü for the system shown in Figure P5.2, using block diagramreduction. [Section: 5.2]H1 R(s) + + +‚Äì G1 G2 G3 C(s) FIGURE P5.2 3.Find the equivalent transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü, for the system shown in Figure P5.3. [Section: 5.2] G1 G4+‚Äì ‚ÄìR(s) + ++‚Äì +G2 G3G5 G6C(s) G7++ FIGURE P5.3Problems 279WEBC05 10/28/2014 17:36:23 4.Reduce the system shown in Figure P5.4 to a single transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü. [Section: 5.2] + ‚ÄìR(s) + ++ ‚ÄìG2 G1G3 G4 HC(s) FIGURE P5.4 5.Find the transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü,f o rt h e system shown in Figure P5.5. Use the following methods: a.Block diagram reduction [Section: 5.2] b.MATLAB. Use the followingtransfer functions:G 1 s¬Ü¬à1= s¬á7¬Ü;G2 s¬Ü¬à1= s2¬á2s¬á3¬Ü, G3 s¬Ü¬à1= s¬á4¬Ü;G4 s¬Ü¬à1=s, G5 s¬Ü¬à5= s¬á7¬Ü;G6 s¬Ü¬à1= s2¬á5s¬á10¬Ü, G7 s¬Ü¬à3= s¬á2¬Ü;G8 s¬Ü¬à1= s¬á6¬Ü. Hint: Use the append andconnect com- mands in MATLAB‚Äô s Control System Toolbox. + ‚ÄìR(s)+ G1+ +++ ++‚Äì G2G3 G4 G5G8 G6 G7C(s) FIGURE P5.56.Reduce the block diagram shown in Figure P5.6 to a single block, T s¬Ü¬àC s¬Ü=R s¬Ü. [Section: 5.2] + ‚ÄìR(s)C(s) G1 G5 G3‚Äì G6 G2 G4 G7 ++ ++G8 FIGURE P5.6 7.Find the unity feedback system that is equivalent to the system shown in Figure P5.7. [Section: 5.2] R(s) +‚Äì ‚Äìs 2s+ +s ++ 1‚Äì ‚Äì+s+1C(s) 4 FIGURE P5.7 8.Given the block diagram of a system shown in Figure P5.8, Ô¨Ånd the transfer function G s¬Ü¬àŒ∏22 s¬Ü= Œ∏11 s¬Ü. [Section: 5.2] +‚Äì G1(s) G2(s) ‚ÄìG3(s) +G7(s) + ++G4(s) G5(s) G6(s)(s)Œ∏21 Œ∏22 Œ∏12Œ∏11 (s) (s) (s) FIGURE P5.8280 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:23 9.Reduce the block diagram shown in Figure P5.9 to a single transfer function, T s¬Ü¬à C s¬Ü=R s¬Ü. [Section: 5.2] R(s) +‚Äì G2 G5 G6 G3G1 ‚Äì+ G4+ G7+ +‚ÄìC(s) FIGURE P5.9 10.Reduce the block diagram shown in Figure P5.10 to a single block representing the transfer function,T s¬Ü¬àC s¬Ü=R s¬Ü. [Section: 5.2] + ‚Äì‚Äì‚Äì R(s) + ‚Äì‚ÄìG2(s) G3(s) G1(s)H1(s)H3(s) H2(s) H4(s)C(s) FIGURE P5.10 11.For the system shown in Figure P5.11, Ô¨Ånd the percent overshoot, settling time, and peak time for a step input ifthe system ‚Äôs response is underdamped. (Is it? Why?) [Section: 5.3] R(s) + E(s) ‚Äì225 s(s + 15)C(s) FIGURE P5.11 12.For the system shown in Figure P5.12, Ô¨Ånd the output, c(t), if the input, r(t), is a unit step. [Section: 5.3] R(s) + E(s) ‚Äì4 s(s + 3)C(s) FIGURE P5.1213.For the system shown in Figure P5.13, Ô¨Ånd the poles of the closed-loop transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü. [Section: 5.3] R(s)3 C(s) + ‚Äì‚Äì+ ‚Äì5ss +1 4 FIGURE P5.13 14.For the system of Figure P5.14, Ô¨Ånd the value of Kthat yields 10% overshoot for a step input. [Section: 5.3] R(s) C(s) + ‚Äìs(s+30)K FIGURE P5.14 15.For the system shown in Figure P5.15, Ô¨ÅndKandŒ± to yield a settling time of 0.12 second and a 20% overshoot. [Section: 5.3] R(s) + E(s) ‚ÄìK s(s + Œ±)C(s) FIGURE P5.15 16.For the system of Figure P5.16, Ô¨Ånd the values of K1 andK2to yield a peak time of 1 second and a settling time of 2 seconds for the closed-loop system ‚Äôs step response. [Section: 5.3] + + ‚Äì ‚ÄìR(s) C(s) 50 s(s+1) K2sK1 FIGURE P5.16 17.Find the following for the system shown in Figure P5.17:[Section: 5.3] a.The equivalent single block th at represents the transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü. (problem continues )Problems 281WEBC05 10/28/2014 17:36:24 (Continued ) b.The damping ratio, natural frequency, percent overshoot, settling time, peak time, rise time, and damped frequency of oscillation. R(s) +‚Äì + s+121C(s) ‚Äì+10 10 0.2ss20 FIGURE P5.17 18.For the system shown in Figure P5.18, Ô¨ÅndŒ∂,œân, percent overshoot, peak time, rise time, and settling time. [Section: 5.3] R(s) 7350 s(s + 100)E(s) C(s) ‚Äì+ FIGURE P5.18 19.A motor and generator are set up to drive a load as shownin Figure P5.19. If the generator output voltage ise g t¬Ü¬àKfif t¬Ü, where if(t) is the generator ‚ÄôsÔ¨Åeld current, Ô¨Ånd the transfer function G s¬Ü¬àŒ∏o s¬Ü=Ei s¬Ü. For the generator, Kf¬à2Œ©. For the motor, Kt¬à2 N-m/A, andKb¬à2 V-s/rad. 1 Œ© if(t) ei(t) 1 HGenerator Ja = 0.75 kg-m2eg(t) 10 20 4 kg-m2 4 N-m-s/rado(t)1 Œ© 1 Œ©Motor + ‚Äì+ ‚ÄìŒ∏ FIGURE P5.19 20.Find G s¬Ü¬àE0 s¬Ü=T s¬Üfor the system shown in Figure P5.20. J Buffer amplifier gain = 1e1(t)N2N1T(t) 10 V 1 Turn pot + e0(t) RC FIGURE P5.2021.Find the transfer function G s¬Ü¬àEo s¬Ü=T s¬Üfor the system shown in Figure P5.21. +Buffer amplifier gain = 1J1 = 0.25 kg-m 2 J2 = 32 kg-m 2K = 5 N-m/rad D=2 N-m-s/rad5 20 401025 V ‚Äì25 V10 Turn pot 10 ŒºF eo(t)200K Œ©T(t) FIGURE P5.21 22.Label signals and draw a signal-Ô¨Ç ow graph for each of the block diagrams shown in the following problems:[Section: 5.4] a.Problem 1 b.Problem 3 c.Problem 5 Draw a signal- Ô¨Çow graph for each of the following state equations: [Section: 5.6] a. _x¬à010 001  2  4  62 6643 775x¬á0 012 6643 775r y¬à110/C2/C3 x b. _x¬à010 0 31  3  4  52 6643 775x¬á0 112 6643 775r y¬à120/C2/C3 x c. _x¬à71 0  32  1  10 22 6643 775x¬á1 212 6643 775r y¬à13 2/C2/C3 x Given the system below, draw a signal- Ô¨Çow graph and represent the system in state space in the following forms: [Section: 5.7] a.Phase-variable form b.Cascade form G s¬Ü¬à200 s¬á10¬Ü s¬á20¬Ü s¬á30¬Ü282 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:25 25.Repeat Problem 24 for G s¬Ü¬à20 s s 2¬Ü s¬á5¬Ü s¬á8¬Ü [Section: 5.7] 26.Using Mason ‚Äôs rule, Ô¨Ånd the transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü, for the system represented in Figure P5.22. [Section: 5.5] G1(s) R(s)G2(s) G3(s) G4(s) C(s) ‚Äì1 ‚Äì1‚Äì1‚Äì1 FIGURE P5.22 27.Using Mason ‚Äôs rule, Ô¨Ånd the transfer function, T s¬Ü¬àC s¬Ü=R s¬Ü, for the system represented by Figure P5.23. [Section: 5.5] G1(s) R(s)G2(s) G4(s) G6(s) G7(s) 1 C(s) H2(s) H1(s) G5(s) G3(s) H3(s) FIGURE P5.23 28.Use Mason ‚Äôs rule to Ô¨Ånd the transfer function of Figure 5.13 in the text. [Section: 5.5] 29.Use block diagram reduction to Ô¨Ånd the transfer function of Figure 5.21 in the text, and compare your answer with that obtained by Mason ‚Äôs rule. [Section: 5.5] 30.Represent the following systems in statespace in Jordan canonical form. Draw thesignal- Ô¨Çow graphs. [Section: 5.7] a.G s¬Ü¬à s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü2 s¬á4¬Ü b.G s¬Ü¬à s¬á2¬Ü s¬á5¬Ü2 s¬á7¬Ü2 c.G s¬Ü¬à s¬á4¬Ü s¬á2¬Ü2 s¬á5¬Ü s¬á6¬Ü 31.Represent the systems below in state spacein phase-variable form. Draw the signal- Ô¨Çow graphs. [Section: 5.7] a.G s¬Ü¬às¬á3 s2¬á2s¬á7 b.G s¬Ü¬às2¬á2s¬á6 s3¬á5s2¬á2s¬á1 c.G s¬Ü¬às3¬á2s2¬á7s¬á1 s4¬á3s3¬á5s2¬á6s¬á432.Repeat Problem 31 and represent each system in controller canonical and observer canonical forms. [Section: 5.7] 33.Represent the feedback control systemsshown in Figure P5.24 in state space. Whenpossible, represent the open-loop transfer functions sep- aratelyincascadeandcompletethefeedbackloopwiththe signal path from output to input. Draw your signal-Ô¨Çowgraph to be in one-to-one correspondence to the blockdiagrams (as close as possible). [Section: 5.7] R(s) + E(s) ‚Äì16(s + 2) C(s) (d)(s + 1)2R(s) + E(s) ‚Äì1 s(s + 1)C(s) (c)160+ ‚Äì sR(s) + ‚Äì10 s(s2 + 6s + 24)C(s) (b)R(s) + E(s) ‚Äì50 (s + 9)(s + 8)(s + 2)C(s) (a) FIGURE P5.24 34.You are given the system shown inFigure P5.25. [Section: 5.7] a.Represent the system in state space in phase-variable form. b.Represent the system in state space in any other form besides phase-variable. R(s) + E(s) ‚Äì30 s(s + 3)(s + 5)C(s) FIGURE P5.25Problems 283WEBC05 10/28/2014 17:36:26 35.Repeat Problem 34 for the system shown in Figure P5.26. [Section: 5.7] + ‚ÄìR(s) C(s) 10(s + 2)(s +3 ) (s+1)(s + 4)(s + 5)(s +6 ) FIGURE P5.26 36.Use MATLAB to solve Problem 35. 37.Represent the system shown in Figure P5.27 in state space where x1 t¬Ü;x3 t¬Ü;andx4 t¬Ü,a s shown, are among the state variables, c(t) is the output, andx2 t¬Üis internal to X1 s¬Ü=X3 s¬Ü. [Section: 5.7] R(s) + E(s) ‚ÄìC(s) X4(s) X3(s) X1(s) 1s1s1 s2+2s‚Äì5 FIGURE P5.27 38.Consider the rotational mechanical systemshown in Figure P5.28. a.Represent the system as a signal-Ô¨Ç ow graph. b.Represent the system in state space if the outputisŒ∏ 2 t¬Ü. 1 kg-m21(t) 2(t) 2 N-m-s/rad 3 N-m-s/rad 2 N-m/rad 4 N-m/radT(t) 1 N-m/rad2 N-m-s/rad 1 kg-m2Œ∏ Œ∏ FIGURE P5.28 39.Given a unity feedback system with the forward-path transfer function G s¬Ü¬à8 s s¬á8¬Ü s¬á10¬Ü use MATLAB to represent the closed-loopsystem in state space in a.phase-variable form; b.parallel form. 40.Consider the cascaded subsystems shownin Figure P5.29. If G 1(s) is represented in state space as _x1¬àA1x1¬áB1r y1¬àC1x1andG2(s) is represented in state space as _x2¬àA2x2¬áB2y1 y2¬àC2x2 show that the entire system can be represented in statespace as _x 1‚àô‚àô‚àô _x2"# ¬àA1 0 B2C1A22 643 75x1‚àô‚àô‚àô x2"# ¬áB1‚àô‚àô‚àô 0"# r y2 ¬à/C20 0... ?C2/C21x1‚àô‚àô‚àô x2"# G1(s) G2(s)Y2(s) Y1(s) R(s) FIGURE P5.29 41.Consider the parallel subsystems shown in Figure P5.30. If G1(s) is represented in state space as _x1¬àA1x1¬áB1r y1¬àC1x1 andG2(s) is represented in state space as _x2¬àA2x2¬áB2r y2¬àC2x2 show that the entire system can be represented in statespace as _x 1‚àô‚àô‚àô _x2"# ¬àA1 0 0A 22 643 75x1‚àô‚àô‚àô x2"# ¬áB1‚àô‚àô‚àô B2"# r y ¬àC1... ?C2/C20/C21x1‚àô‚àô‚àô x2"# G2(s)G1(s) Y(s) ++Y1(s) Y2(s)R(s) FIGURE P5.30 42.Consider the subsystems shown in F i g u r eP 5 . 3 1a n dc o n n e c t e dt of o r ma284 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:27 feedback system. If G(s) is represented in state space as _x1¬àA1x1¬áB1e y¬àC1x1 andH2(s) is represented in state space as _x2¬àA2x2¬áB2y œÅ¬àC2x2 show that the closed-loop system can be represented in state space as _x1‚àô‚àô‚àô _x2"# ¬àA1 B1C2 B2C1A22 6643 775x1‚àô‚àô‚àô x2"# ¬áB1‚àô‚àô‚àô 0"# r y¬à C1... ?0/C20/C21x1‚àô‚àô‚àô x2"# G(s)E(s) + R(s) ‚Äì H(s)P(s)Y(s) FIGURE P5.31 43.Given the system represented in state space as follows: [Section: 5.8] _x¬à 1 76  848 47  82 6643 775x¬á 5  7 52 6643 775r y¬à  9 9 8/C2/C3 x convert the system to one where the new state vector, z,i s z¬à 49  3 0 47  1 4 92 435x Repeat Problem 43 for the following system: [Section: 5.8] _x¬à 511 9 9 9  9 182 6643 775x¬á9  4 02 6643 775r y¬à  2 41/C2/C3 xand the following state-vector transformation: z¬à5 49 6 76 6 5 32 435x Diagonalize the following system: [Section: 5.8] _x¬à 5  54 20  2 0 2  12 6643 775x¬á 1 2  22 6643 775r y¬à  112/C2/C3 x 46.Repeat Problem 45 for the following system: [Section: 5.8] _x¬à 10  37 18:25 6 :25  11:75  7:25  2:25 5 :752 6643 775x¬á1 322 6643 775r y¬à1 24/C2/C3 x Diagonalize the system in Problem 46 using MATLAB. 48.Find the closed-loop transfer function of theUnmanned Free-Swimming Submersible vehicle ‚Äôs pitch control system shown on the back endpapers(Johnson, 1980 ). Repeat Problem 48 using MATLAB. 50.Use Simulink to plot the effectsof nonlinearities upon the closed-loop step response of the antennaazimuth position control system shownon the front endpapers, Con Ô¨Åguration 1. In particular, consider individuallyeach of the following nonlinearities: saturation 5 volts ¬Ü, backlash (dead- band width 0.15), deadzone (  2t o +2), as well as the linear response. Assume the preampli Ô¨Åer gain is 100 and the step input is 2 radians. 51.Problem 8 in Chapter 1 describes a high-speed pro- portional solenoid valve. A subsystem of the valve is the solenoid coil shown in Figure P5.32. Currentthrough the coil, L, generates a magnetic Ô¨Åeld that produces a force to operate the valve. Figure P5.32 canbe represented as a block diagram (Vaughan ,1996).Problems 285WEBC05 10/28/2014 17:36:27 + RL vg(t)i(t)vL(t) vR(t)+‚Äì ‚Äì+ ‚Äì FIGURE P5.32 Solenoid coil circuit a.Derive a block diagram of a feedback system that represents the coil circuit, where the applied voltage, vg(t), is the input, the coil voltage, vL(t), is the error voltage, and the current, i(t), is the output. b.For the block diagram found in Part a,Ô¨Ånd the Laplace transform of the output current, I(s). c.Solve the circuit of Figure P5.32 for I(s), and com- pare to your result in Part b. 52.Figure P5.33 shows a noninverting operational ampli Ô¨Åer. vov1 v1 viviRi Rf (a) (b) ‚Äì+ voA i fi R RR ++‚Äì FIGURE P5.33 a.Noninverting ampli Ô¨Åer;b.block diagram Assuming the operational ampli Ô¨Åer is ideal, a.Verify that the system can be described by thefollowing two equations: v o¬àA vi vo¬Ü v1¬àRi Ri¬áRfvo b.Check that these equations can be described by the block diagram of Figure P5.33( b). c.Use Mason ‚Äôs rule to obtain the closed-loop system transfer functionVo s¬Ü Vi s¬Ü: d.Show that when A¬Æ‚àû;Vo s¬Ü Vi s¬Ü¬à1¬áRf Ri: 53.Figure P5.34 shows the diagram of an inverting operational ampliÔ¨Å er. vov1 viRi Rf +‚Äì + ‚Äì FIGURE P5.34 Inverting operational ampli Ô¨Åera.Assuming an ideal operational ampli Ô¨Åer, use a simi- lar procedure to the one outlined in Problem 52 toÔ¨Ånd the system equations. b.Draw a corresponding block diagram and obtain the transfer functionVo s¬Ü Vi s¬Ü: c.Show that when A¬Æ‚àû;Vo s¬Ü Vi s¬Ü¬à Rf Ri. 54.Figure P5.35( a) shows an n-channel enhancement-mode MOSFET source follower circuit. Figure P5.35( b) shows its small-signal equivalent (where Ri¬àR1jjR2) (Neamen ,2001 ). a.Verify that the equations governing this circuit are vin vi¬àRi Ri¬áRs;vgs¬àvin vo;vo¬àgm Rsjjro¬Üvgs b.Draw a block diagram showing the relations between the equations. c.Use the block diagram in Part btoÔ¨ÅndVo s¬Ü Vi s¬Ü. vo RsVDD R2R1 +‚ÄìviRs (a)( b)+vo‚Äì vgsvin gmVgs roRs RiRs vi+‚Äì FIGURE P5.35 a.Ann-channel enhancement-mode MOSFET source follower circuit; b.small-signal equivalent 55.A car active suspension system adds an active hydraulicactuator in parallel with the passive damper and springto create a dynamic impedance that responds to roadvariations. The block diagram of Figure P5.36 depictssuch an actuator with closed-loop control. Kte r++‚Äì +1 s2 + œâ x1 = x3 x3Mus mr1 02 s + ŒµŒµŒ∂1 FIGURE P5.364 In the Ô¨Ågure, Ktis the spring constant of the tire, MUS is the wheel mass, ris the road disturbance, x1is 4Lin, J.-S., Kanellakopoulos, I. ‚ÄúNonlinear Design of Active Suspensions. ‚Äù IEEE Control Systems Magazine , Vol. 17, Issue 3, June 1997 pp. 45 ‚Äì59. Figure 3, p. 48. IEEE Control Systems by IEEE Control Systems Society. Reproduced with permission of Institute of Electrical and Electronics Engineers, in the format Republish in a book via Copyright Clearance Center.286 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:28 the vertical car displacement, x3is the wheel vertical displacement, œâ2 0¬àKt MUSis the natural frequency of the unsprung system and Œµis aÔ¨Åltering parameter to be judiciously chosen ( Lin,1997 ). Find the two transfer functions of interest: a.X3 s¬Ü R s¬Ü b.X1 s¬Ü R s¬Ü 56.The basic unit of skeletal and cardiac muscle cells is a sarcomere, which is what gives such cells a striated (parallel line) appearance. For example, one bicep cell has about 105sarcomeres. In turn, sarcomeres are composed of protein complexes. Feedback mechanismsplay an important role in sarcomeres and thus musclecontraction. Namely, Fenn ‚Äôs law says that the energy liberated during muscle contraction depends on the initialconditions and the load encountered. The followinglinearized model describing sarcomere contraction has been developed for cardiac muscle: _A _T _U _SL2 666643 77775¬à 100 :2 20:7 30:7 200 :3 40  20:22 49 :95 526 :1 01 0 :22 59:95 526 :1 00 0 02 666643 77775A T U SL2 666643 77775¬á208  208  108 :8  12 666643 77775u t¬Ü y¬à 0157 0 1570 59400/C2/C3A T U SL2 666643 77775 6240 u t¬Ü where A¬àdensity of regulatory units with bound calcium and adjacent weak cross bridges ŒºM¬Ü T¬àdensity of regulatory units with bound calciumand adjacent strong cross bridges M¬Ü U¬àdensity of regulatory units without boundcalcium and adjacent strong cross bridges M¬Ü SL¬àsarcomere length m¬Ü The system ‚Äôs input is u t¬Ü¬àthe shortening muscle velocity in meters/second and the output is y t¬Ü¬à muscle force output in Newtons ( Yaniv ,2006 ). Do the following: a. Use MATLAB to obtain the transfer functionY s¬Ü U s¬Ü. b.Use MATLAB to obtain a partial-fraction expansion for Y s¬Ü U s¬Ü.c.Draw a signal-Ô¨Ç ow diagram of the system in parallel form. d.Use the diagram of Part cto express the system in state-variable form with decoupled equations. 57.An electric ventricular assist device (EVAD) has beendesigned to help patients with diminished but stillfunctional heart pumping action to work in parallel with the natural heart. The device consists of a brushless dc electric motor that actuates on a pusherplate. The plate movements help the ejection of bloodin systole and sac Ô¨Ålling in diastole. System dynamics during systolic mode have been found to be: _x _v _P ao2 435¬à01 0 0 68 :3 7:2 03 :2 0:72 435x v P ao2 435¬á0 425 :4 02435e m The state variables in this model are x, the pusher plate position, v, the pusher plate velocity, and Pao, the aortic blood pressure. The input to the system is em, the motor voltage ( Tasch ,1990 ). a.Use MATLAB to Ô¨Ånd a similarity transformation to diagonalize the system. b.Use MATLAB and the obtainedsimilarity transformation ofPart a to obtain a diagonalized expres- sion for the system. 58.In an experiment to measure and identify postural arm reÔ¨Çexes, subjects hold in their hands a linear hydraulic manipulator. A load cell is attached to the actuatorhandle to measure resulting forces. At the application of a force, subjects try to maintain a Ô¨Åxed posture. Figure P5.37 shows a block diagram for the combinedarm-environment system. D(s)He(s)Xh(s) Xa(s)Hh(s) Hi(s) Hr(s) Hact(s)A(s)Fh(s) Fint(s) Fref(s)+ + +‚Äì ‚Äì Arm Environment‚Äì FIGURE P5.37 In the diagram, Hr(s) represents the re Ô¨Çexive length and velocity feedback dynamics; Hact(s) the activation dynamics, Hi(s) the intrinsic act dynamics; Hh(s) the hand dynamics; He(s) the environmental dynam- ics;Xa(s) the position of the arm; Xh(s) the measuredProblems 287WEBC05 10/28/2014 17:36:29 position of the hand; Fh(s) the measured interaction force applied by the hand; Fint(s) the intrinsic force; Fref(s)t h er e Ô¨Çexive force; A(s)t h er e Ô¨Çexive activation; and D(s) the external force perturbation ( de Vlugt , 2002). a.Obtain a signal-Ô¨Ç ow diagram from the block diagram. b.FindFh s¬Ü D s¬Ü. 59.Use LabVIEW ‚Äôs Control Design and Simulation Module to obtain the controller and the observercanonical forms for: G s¬Ü¬às2¬á7s¬á2 s3¬á9s2¬á26s¬á24 60.A virtual reality simulator with haptic (sense of touch)feedback was developed to simulate the control of asubmarine driven through a joystick input. Operatorhaptic feedback is provided through joystick positionconstraints and simulator movement ( Karkoub ,2010). Figure P5.38 shows the block diagram of the hapticfeedback system in which the input u his the force exerted by the muscle of the human arm; and theoutputs are y s, the position of the simulator, and yj,t h e position of the joystick. Ths Tes Tej ThjKej- -- +++- Fj1/s 1/s Khs Csys KhFhyj uhCjKesFs FIGURE P5.385 a.Find the transfer functionYs s¬Ü Uh s¬Ü: b.Find the transfer functionYj s¬Ü Uh s¬Ü: 61.Some medical procedures require the insertion of a needle under a patient‚Äô s skin using CT scan monitoringguidance for precision. CT scans emit radiation, posing some cumulative risks for medical personnel. To avoid this problem, a remote control robot has been developed(Piccin ,2009 ). The robot controls the needle in position and angle in the constraint space of a CT scan machineand also provides the physician with force feedbackcommensurate with the insertion opposition encounteredby the type of tissue in which the needle is inserted. Therobot has other features that give the operator the similar sensations and maneuverability as if the needle was inserted directly. Figure P5.39 shows the block diagramof the force insertion mechanism, where F his the input force and Xhis the output displacement. Summing junction inputs are positive unless indicated with anegative sign. By way of explanation, Z=impedance; G=transfer function; C i=communication channel transfer functions; F=force; X=position. Subscripts h andmrefer to the master manipulator. Subscripts sand erefer to the slave manipulator. a.Assuming Zh¬à0;C1¬àCs;C2¬à1¬áC6andC4¬à  C muse Mason ‚Äôs Rule to show that the transfer function from the operators force input Fhto needle displacement Xhis given by Y s¬Ü¬àXh s¬Ü Fh s¬Ü¬àZ 1 mC2 1¬áGsCs¬Ü 1¬áGsCs¬áZ 1 m cm¬áC2ZeGsCs¬Ü b.Now with Zh‚â†0 show thatXh s¬Ü Fh s¬Ü¬àY s¬Ü 1¬áY s¬ÜZh Fe Ze Gs Cs Zm‚Äì1 ZhXh Fm FhVsc C4 C2C1 Cm C6XeSlave manipulator ‚Äì‚Äì ‚Äì Master manipulato r FIGURE P5.396 5Karkoub, M., Her, M-G., and Chen, J. M. Design and Control of a Haptic Interactive Motion Simulator for Virtual Entertainment Systems. Robotica , vol. 28, 2010, Figure 8, p. 53. Reproduced by permission of Cambridge University Press.6Piccin, O., Barb√©, L., Bayle, B., and Mathelin, M. A Force Feedback Teleoperated Needle Insertion Device for Percutaneous Procedures. Int. J. of Robotics Research , vol. 28, p. 1154. Figure 14. Copyright ÓÄÇ2009. Reprinted by Permission of SAGE.288 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:29 1 Lfs Rf1 Cfs VLoad‚àíIDist+ + ‚àí++ + ‚àí ‚àíKi1Kp1 +sKp21 ÀÜCfsICfÀÜ ÀÜ Lfs + Rf FIGURE P5.40 62.A hybrid solar cell and diesel power distribution system has been proposed and tested ( Lee, 2007 ). The system has been shown to have a very good uninterruptible power supply as well as line voltage regulation capabilities. Figure P5.40 shows a signal-Ô¨Çow diagram of the system. The output, V Load,i st h e voltage across the load. The two inputs are ICf,t h e reference current, and IDist, the disturbance represent- ing current changes in the supply. a.Refer to Figure P5.40 and Ô¨Ånd the transfer function VLoad s¬Ü ICf s¬Ü: b.Find the transfer functionVLoad s¬Ü IDist s¬Ü: 63.Continuous casting in steel production is essentially asolidi Ô¨Åcation process by which molten steel is solidi Ô¨Åed into a steel slab after passing through a mold, as shownin Figure P5.41( a). Final product dimensions depend mainly on the casting speed V p(in m/min), and on the stopper position X(in %) that controls the Ô¨Çow of molten material into the mold ( Kong ,1993 ). A simpli Ô¨Åed model of a casting system is shown in Figure P5.41(b)(Kong ,1993 )a n d( Graebe ,1995 ). In the model, H m=mold level (in mm); Ht=assumed constant height of molten steel in the tundish; Dz=mold thickness = depth of nozzle immerged into molten steel; and Wt= weight of molten steel in the tundish. For a speci Ô¨Åc setting let Am=0.5 and Gx s¬Ü¬à0:63 s¬á0:926 Also assume that the valve positioning loop may be modeled by the following second-order transfer function: GV s¬Ü¬àX s¬Ü YC s¬Ü¬à100 s2¬á10s¬á100and the controller is modeled by the following transfer function: GC s¬Ü¬à1:6 s2¬á1:25s¬á0:25¬Ü s LADLE SLABTUNDISH Ht Dz HmHm 11 12M1Vp Vs M2X HYDRAULIC UNIT ELECTRONIC UNITNKK MOLD SEGMENT 1 SEGMENT 2 SEGMENT 3REGULATOR UNITSET- POINT r (a) ++ ‚Äì‚ÄìE(s)GC(s) GV(s)Qo(s) Qi(s)Vp(s) Hm(s) R(s)YC(s) X(s)Gx(s) m(s) FIGURE P5.41 Steel mold process: a.process;7b.block diagram The sensitivity of the mold level sensor is Œ≤=0.5 and the initial values of the system variables at t=0  are: R 0 ¬Ü ¬à 0;YC 0 ¬Ü ¬à X 0 ¬Ü ¬à 41:2;ŒîHm 0 ¬Ü ¬à 0; (problem continues ) 7Kong, F., and de Keyser, R. Identi Ô¨Åcation and Control of the Mould Level in a Continuous Casting Machine. Second IEEE Conference on Control Applications , Vancouver, B.C., 1993. pp. 53 ‚Äì58. Figure 1. p. 53.Problems 289WEBC05 10/28/2014 17:36:30 (Continued ) Hm 0 ¬Ü ¬à  75 ;ŒîVp 0 ¬Ü ¬à 0;andVp 0 ¬Ü ¬à 0. Do the following: a.Assuming vp t¬Üis constant Œîvp¬à0/C2/C3 ,Ô¨Ånd the closed-loop transfer function T s¬Ü¬àŒîHm s¬Ü=R s¬Ü. b.Forr t¬Ü¬à5u t¬Ü;vp t¬Ü¬à0:97u t¬Ü; andHm 0 ¬Ü ¬à   75 mm, use Simulink to simulate the system. Record the time and mold level (in arrayformat) by connecting them to Work- space sinks, each of which should carry the respective variable name. Afterthe simulation ends, utilize MATLABplot commands to obtain and edit the graph of h m(t) from t=0 to 80 seconds. 64.A simpliÔ¨Åed second-order transfer function model for bicycle dynamics is given by œÜ s¬Ü Œ¥ s¬Ü¬àaV bhs¬áV a/C18/C19 s2 g h/C16/C17 The input is Œ¥(s), the steering angle, and the output is œÜ(s), the tilt angle (between the Ô¨Çoor and the bicycle longitudinal plane). In the model parameter ais the hori- zontal distance from the center of the back wheel to the bicycle center of mass; bis the horizontal distance between the centers of both wheels; his the vertical distance from the c e n t e ro fm a s st ot h e Ô¨Çoor;Vis the rear wheel velocity (assumed constant); and gis the gravity constant. It is also assumed that the rider remains at a Ô¨Åxed position with respect to the bicycle so that the steer axis is vertical and thatall angle deviations are small ( √Östrom ,2005 ). a.Obtain a state-space representation for the bicyclemodel in phase-variable form. b.Find system eigenvalues and eigenvectors. c.Find an appropriate similarity transformation matrixto diagonalize the system and obtain the state-spacesystem ‚Äôs diagonal representation. 65.It is shown in Figure 5.6( c) that when negative feedback is used, the overall transfer function for the system ofFigure 5.6( b)i s C s¬Ü R s¬Ü¬àG s¬Ü 1¬áG s¬ÜH s¬Ü Develop the block diagram of an alternative feedbacksystem that will result in the same closed-looptransfer function, C s¬Ü=R s¬Ü, with G(s) unchanged and unmoved. In addition, your new block diagram must have unity gain in the feedback path. You can add input transducers and/or controllers in the mainforward path as required. 66.The purpose of an Automatic Voltage Regulator is tomaintain constant the voltage generated in an electricalpower system, despite load and line variations, in an electrical power distribution system ( Gozde ,2011 ). Figure P5.42 shows the block ŒîVref(s) ŒîVt(s) ŒîVe(s) ŒîVs(s)u(s)GPID(s)Ka Ke Kg Ta Te Tg 1 TaPlant s + Amplifier, Exciter, GeneratorController + ‚Äì SensorFeedbackPID Compensator1 Tes +1 Tgs + Ks Ts 1 Tss + FIGURE P5.42 diagram of such a system. Assuming Ka=10,Ta=0.1, Ke=1,Te=0.4,Kg=1,Tg=1,Ks=1,Ts=0.001, and the controller, GPID s¬Ü¬à1:6¬á0:4 s¬á0:3s,Ô¨Ånd the closed-loop transfer function, T s¬Ü¬àŒîVt s¬Ü ŒîVref s¬Ü, of the system, expressing it as a rational function. 67.A drive system with an elastically coupled load was presented in Problem 71, Chapter 4. The mechanicalpart of this drive (Thomsen ,2011) was reduced to a two-inertia model. Using slightly different parameters,the following transfer function results: G s¬Ü¬à Œ©L s¬Ü T s¬Ü¬à25 s2¬á1:2s¬á12500 ¬Ü s s2¬á5:6s¬á62000 ¬Ü Here, T(s)=Tem(s) TL(s), where Tem(s)=the electro- magnetic torque developed by the motor, TL(s)=the load torque, and Œ©L s¬Ü¬àthe load speed. The drive is shown in Figure P5.43 as the con- trolled unit in a feedback control loop, where Œ©r s¬Ü¬àthe desired reference ¬Üspeed. The controller transfer function is GC s¬Ü¬àKp¬áKI s¬à4¬á0:5 sand provides an output voltage =0‚Äì5.0 volts. The motor and its power ampli Ô¨Åer have a gain, KM=10 N-m/volt. a.Find the minor-loop transfer function, D s¬Ü¬àŒ©L s¬Ü Tem s¬Ü analytically or using MATLAB. b.Given that at t=0, the load speed œâL(t)=0 rad/sec and a step reference input œâr(t)=260 u(t) , rad/sec, is applied, use MATLAB (or any other pro- gram) to Ô¨Ånd and plot œâL t¬Ü. Mark on the graph all of the important character- istics, such as percent overshoot,peak time, rise time, settling time,andÔ¨Ånal steady-state value.290 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:30 Œ©r(s)+ +Œ©L(s) ‚Äì‚Äì GC(s)Tem(s)TL G(s) KM0.1 FIGURE P5.43 68.Integrated circuits are manufactured through a litho- graphic process on a semiconductor wafer. In lithography,similarly to chemical photography, a semiconductorwafer is covered with a photosensitive emulsion andthen selectively exposed to light to form the electronic components. Due to miniaturization, this process is to be performed with nanometer accuracy and at the highestpossible speed. Sophisticated apparatus and methodshave been developed for this purpose. Figure P5.44 showsthe block diagram of a scanner dedicated to this purpose(Butler, 2011 ). Use Mason ‚ÄôsR u l et o Ô¨Ånd: a.The transfer function Xss s¬Ü R s¬Ü. b.The transfer functionXls s¬Ü R s¬Ü. ++++ + ‚Äì ‚Äì + ‚ÄìCss(s)mssmss + mls Esss2 RHss(s) XssCls(s)ElsHls(s) DiffXls FIGURE P5.44869.A boost converter is a dc-to-dc switched power supply in which the voltage output is larger than the voltage input. A block diagram for a peak current mode controlledconverter ( Chen ,2013 ) is shown in Figure P5.45. Find the transfer function^vo s¬Ü ^vi s¬Ü. 70.In Problem 64 of Chapter 2, a three-phase ac/dc converterthat supplies dc to a battery charging system ( Graovac , 2001 ) was introduced. Each phase had an ac Ô¨Ålter represented by the equivalent circuit of Figure P2.38.Youwereasked toshowthatthefollowingequationgivesthes-domain relationship between the inductor current, I acF(s), and two active sources: a current source, IacR(s), representing a phase of the ac/dc converter, and thesupply phase voltage, V a(s): IacF s¬Ü¬àIacF1 s¬Ü¬áIacF2 s¬Ü¬à1¬áRCs LCs2¬áRCs ¬á1IacR s¬Ü ¬áCs LCs2¬áRCs ¬á1Va s¬Ü a.Derive an s-domain equation for Vc(s). b.Given that R¬à1Œ©;L¬à1 mH, and C=20ŒºF,i acR(t)=10u(t)amps, va(t)=20t u(t) volts,10and assuming zero initial conditions, use Simulinkto model this system and plottheinduc-tor current, i acF(t) , and the capacitor voltage, vc(t), over a period from 0 to 15 ms. DESIGN PROBLEMSDESIGN PROBLEMS The motor and load shown in Figure P5.46( a)a r eu s e d as part of the unity feedback system shown in Figure P5.46( b). Find the value of the coef Ô¨Åcient of FmTpa(s)Tfa(s) vo vii‚ÑìKf Tpi(s) Tma(s) Hc(s) Ri Kr++ ++ +++ ‚Äì FIGURE P5.459 8Butler, H. Position Control in Lithographic Equipment. IEEE Control Systems Magazine , October 2011, pp. 28 ‚Äì47. Figure 18, p. 37. 9Chen, S.-Y. Block diagrams and transfer functions of control-to-output and line-to-output for peak current-mode controlled boost converters. IET Power Electron , Vol. 6, Iss. 1, pp. 60 ‚Äì66, 2013. Figure 4, p. 62. ÓÄÇThe Institution of Engineering and Technology.10Noting that a ramp is the integration of a step, we used an integrator with limits.Problems 291WEBC05 10/28/2014 17:36:31 viscous damping, DL, that must be used in order to yield a closed-loop transient response having a 20% overshoot. R(s) + E(s) ‚Äì1000Motor & loadGear trainŒ∏M(s) Œ∏L(s) (b)Kt = 2 N-m/A Kb = 2 V-s/rad Ja = 2 kg-m2 Da = 2 N-m-s/rad Ra = 2Œ©1Œ∏M(s) 1 2Œ∏L(s) JL = 800 kg-m2 (a)DL10 FIGURE P5.46 Position control: a.motor and load; b.block diagram Assume that the motor whose transfer function isshown in Figure P5.47( a)i su s e da st h ef o r w a r d path of a closed-loop, unity feedback system. a.Calculate the percent overshoot and settling time that could be expected. b.You want to improve the response found in Part a. Since the motor and the motor constants cannot be changed, an ampli Ô¨Åer and a tachometer (voltage generator) are inserted into the loop, as shown inFigure P5.47. Find the values of K 1and K2to yield a 20% overshoot and a settling time of0.25 second. R(s) + E(s) ‚Äì25K1AmpMotor s(s + 1)C(s) + ‚Äì K2s Tachometer (b)R(s) + E(s) ‚Äì251s(s + 1)C(s) (a)Motor FIGURE P5.47 a.Position control; b.position control with tachometer The system shown in Figure P5.48 will have its transientresponse altered by adding a tachometer. Design KandK 2in the system to yield a damping ratio of 0.69. The natural frequency of the system before the addition of thetachometer is 10 rad/s. R(s) + E(s) ‚Äì1 s(s + 1)C(s)K+K2s ‚ÄìTachometer Power amplifier and motorPreamplifier FIGURE P5.48 Position control Themechanical system shownin Figure P5.49( a) isused as part of the unity feedback system shown inFigure P5.49( b). Find the values of MandDto yield 20% overshoot and 2 seconds settling time. R(s) X(s) E(s) Ea(s) + ‚Äì500Motor & loadGearFor the motor: Ja= 1 kg-m 2 Da= 1 N-m-s/rad Ra=1 Œ© Kb= 1 V-s/rad Kt= 1 N-m/AN2 = 20N1 = 10 D J = 1 kg-m 2Ideal gear 1:1 fv=1 N-s/mx(t)ea(t)Motor Radius = 2 m+ ‚Äì (a) (b)M FIGURE P5.49 a.Motor and load; b.motor and load in feedback system Assume ideal operational ampli Ô¨Åers in the circuit of Figure P5.50. a.Show that the leftmost operational ampli Ô¨Åer works as a subtracting ampli Ô¨Åer. Namely, v1¬àvo vin. b.Draw a block diagram of the system, with the subtracting ampli Ô¨Åer represented with a summing junction, and the circuit of the rightmost operationalampli Ô¨Åer with a transfer function in the forward path. Keep Ras a variable. c.Obtain the system ‚Äôs closed-loop transfer function. d.For a unit step input, obtain the value of Rthat will result in a settling time T s¬à1 msec.292 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:31 e.Using the value of Rcalculated in Part d, make a sketch of the resulting unit step response. vovinv1 10 k0.1 F R10 k 10 k‚Äì + ‚Äì+10 k FIGURE P5.50 Given the rotational system shown in Figure P4.23 (Problem 78 of Chapter 4), do the following: a.Using the transfer function you derived for thatsystem, G(s)=Œò 1(s)/T(s), where Œò1(s)i st h e angular displacement of the Ô¨Årst shaft, Ô¨Ånd the value of n=N1/N2that yields a settling time of 10 seconds for a step input in torque. b.If this rotational system is the controlled unit, G(s), in the feedback system of Figure P5.51, Ô¨Ånd the values of Œ∂;œân,%O.S., and Tsfor a controller gain K=4 N-m/rad and r(t)=u(t) radians. R(s) E(s) + ‚ÄìKC(s) G(s) FIGURE P5.51 A process is simulated by the second-order passivecircuit, shown in Figure P5.52, where the feedbackampli Ô¨Åer, controller, and Ô¨Ånal control element are r e p r e s e n t e db yo p - a m pc i r c u i t s . a.Denoting the input and output as R(s)=V i(s) and C(s)=Vo(s), with R(s) C(s)=E(s), and noting that the feedback ampli Ô¨Åer has a unity gain, draw a block diagram for this feedback control system, whereG C(s),GF(s), and GP(s) are the transfer functions of the controller, Ô¨Ånal control element, and the process, respectively. b.Find the value of RPthat makes the circuit repre- senting the process critically damped. c.Noting that the proportional controller is simply anampli Ô¨Åer,G C(s)=KP,Ô¨Ånd the value of its gain KPthat results in dominant closed-loop poles with a dampingratio, Œ∂¬à0:5, and a settling time, T s=4 ms. Verify that the other pole is nondominant. What would be theappropriate value of the controller potentiometer, R F, given that its tolerance is ¬±10%?+‚Äì+‚Äì +‚ÄìVo(t) VC(t)‚ÄìVo(t)VR(t) Vf(t)Proportional controllerFinal contr o l element Feedback amplifierProcess 100 mH 10 ŒºF0.018 ŒºF 10 KŒ© 10 KŒ©10 KŒ© 10 KŒ© 100 KŒ© 100 KŒ©4.7 KŒ©RPRF FIGURE P5.52 PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 78.Control of HIV/AIDS. Given the HIV system of Problem 84 in Chapter 4 and repeated here for convenience ( Craig ,2004 ): _T _T* _v2 6643 775¬à 0:04167 0  0:0058 0:0217  0:24 0 :0058 0 100  2:42 643 75T T* v2 643 75 ¬á5:2  5:2 02 6643 775u1 y¬à001/C2/C3T T* v2 643 75 Express the system in the following forms: a.Phase-variable form b.Controller canonical form c.Observer canonical form Finally, d.Use MATLAB to obtain the system ‚Äôs diagonalized representation. 79.Hybrid vehicle. Figure P5.53 shows the block diagram of a possible cascade control scheme for an HEV drivenby a dc motor ( Preitl ,2007 ). Let the speed controller G SC s¬Ü¬à100¬á40 s, the torque controller and power amp KAGTC s¬Ü¬à10¬á6 s, the current sensor sensitivity KCS=0.5, the speed sensor sensitivity KSS=0.0433. Also, following the development in previous chapters1 Ra¬à1;Œ∑totKt¬à1:8; kb¬à2;D¬àkf¬à0:1;1 Jtot¬à1 7:226;r itot¬à0:0615 ; andœÅCwAv0r itot¬à0:6154.Problems 293WEBC05 10/28/2014 17:36:32 a.Substitute these values in the block diagram, and Ô¨Ånd the transfer function, T(s)=V(s)/Rv(s), using block- diagram reduction rules. [Hint: Start by moving the lastr itotblock to the right past the pickoff point.] b.Develop a Simulink model for the original system inFigure P5.53. Set the reference signal input, r v(t)=4u(t), as a step input with a zero initial value, a step time =0 seconds, and a Ô¨Ånal value of 4 volts. Use X-Y graphs to display (over the periodfrom 0 to 8 seconds) the response ofthe following variables to the stepinput: (1) change in car speed (m/s), (2) car acceleration (m/s 2), and (3) motor armature current (A). To record the time and the above three variables (in array format) , connect them to four Workspace sinks, each of which carries the respective variable name. After the simulation ends, uti-lize MATLAB plot commands to obtainand edit the three graphs of interest. 80.Parabolic trough collector. Effective controller design for parabolic trough collector setups is an active area of research. One of the techniques used for controller design ( Camacho ,2012) is Internal Model Control (IMC). Although complete details of IMC will notbe presented here, Figure P5.54( a)s h o w sab l o c k diagram for the IMC setup. Use of IMC assumes avery good knowledge of the plant dynamics. InFigure P5.54( a), the actual plant is P(s).~P s¬Üis a software model that mimics the plant functions. G(s)is the controller to be designed. It is also assumed thatall blocks represent linear time-invariant systems andthus the superposition theorem applies to the system. a.Use superposition (by assuming D(s)=0) and Mason ‚Äôsg a i nf o r m u l at o Ô¨Ånd the transfer function C s¬Ü R s¬Üfrom command input to system output. b.Use superposition (by assuming R(s)=0) and Mason ‚Äôs gain formula to Ô¨Ånd the transfer function C s¬Ü D s¬Üfrom disturbance input to system output. c.Use the results of Parts aandbtoÔ¨Ånd the combined output C(s) due to both system inputs. d.Show that the system of Figure P5.54( a)h a s the same transfer function as the system in Figure P5.54( b)w h e n GC s¬Ü¬àG s¬Ü 1 G s¬Ü~P s¬Ü. +++ +‚ÄìG(s) P(s) P~(s)C(s)D(s) R(s) ‚Äì (a) +++ ‚ÄìGc(s) P(s) C(s)D(s) R(s) (b) FIGURE P5.54Œ©(s)Ev(s) Eb(s) Ia(s)RaGSC(s) GTC(s)UC(s)Ua(s) Ia(s)TL(s) Tf(s)T(s)GTC(s)Angular speed, Œ©(s)Vehicle speed, V (s)Rv(s) FIGURE P5.53294 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:32 Cyber Exploration Laboratory Experiment 5.1 Objectives To verify the equivalency of the basic forms, including cascade, parallel, and feedback forms. To verify the equivalency of the basic moves, including moving blocks past summing junctions, and moving blocks past pickoff points. Minimum Required Software Packages MATLAB, Simulink, and the Control System Toolbox Prelab 1.Find the equivalent transfer function of three cascaded blocks, G1 s¬Ü¬à1 s¬á1. G2 s¬Ü¬à1 s¬á4, and G3 s¬Ü¬às¬á3 s¬á5. 2.Find the equivalent transfer function of three parallel blocks, G1 s¬Ü¬à1 s¬á4. G2 s¬Ü¬à1 s¬á4, and G3 s¬Ü¬às¬á3 s¬á5. 3.Find the equivalent transfer function of the negative feedback system of Figure P5.55 if G s¬Ü¬às¬á1 s s¬á2¬Ü, and H s¬Ü¬às¬á3 s¬á4. 4.For the system of Prelab 3, push H(s) to the left past the summing junction and draw the equivalent system. 5.For the system of Prelab 3, push H(s) to the right past the pickoff point and draw the equivalent system. Lab 1.Using Simulink, set up the cascade system of Prelab 1 and the equivalent single block. Make separate plots of the step response of the cascaded system and its equivalent singleblock. Record the values of settling time and rise time for each step response. 2.Using Simulink, set up the parallel system of Prelab 2 and the equivalent single block.Make separate plots of the step response of the parallel system and its equivalent singleblock. Record the values of settling time and rise time for each step response. 3.Using Simulink, set up the negative feedback system of Prelab 3 and the equivalent single block. Make separate plots of the step response of the negative feedback system and its equivalent single block. Record the values of settling time and rise time for eachstep response. 4.Using Simulink, set up the negative feedback systems of Prelabs 3, 4, and 5. Makeseparate plots of the step response of each of the systems. Record the values of settlingtime and rise time for each step response. Postlab 1.Using your lab data, verify the equivalent transfer function of blocks in cascade. 2.Using your lab data, verify the equivalent transfer function of blocks in parallel. 3.Using your lab data, verify the equivalent transfer function of negative feedbacksystems. 4.Using your lab data, verify the moving of blocks past summing junctions and pickoffpoints. 5.Discuss your results. Were the equivalencies veri Ô¨Åed?R(s) + C(s)G(s) H(s)‚Äì FIGURE P5.55Cyber Exploration Laboratory 295WEBC05 10/28/2014 17:36:32 Bibliography √Östrom, K., Klein, R. E., and Lennartsson, A. Bicycle Dynamics and Control. IEEE Control Systems , August 2005, pp. 26 ‚Äì47. Ballard, R. D. The Discovery of the Titanic , Warner Books, New York, 1987. Also, Ô¨Ågure caption source for Figure 5.33. Butler, H. Position Control in Lithographic Equipment. IEEE Control Systems , October 2011, pp. 28 ‚Äì47. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems. Springer-Verlag, London, 2012. Chen, S.-Y. Block diagrams and transfer functions of control-to-output and line-to-output for peak current-mode controlled boost converters. IET Power Electron. , vol. 6, no. 1, pp. 60 ‚Äì66, 2013. Craig, I. K., Xia, X., and Venter, J. W., Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. de Vlugt, E., Schouten, A. C., and van derHelm, F.C.T. Adaptation of Re Ô¨Çexive Feedback during Arm Posture to Different Environments. Biological Cybernetics , vol. 87, 2002, pp. 10 ‚Äì26.Experiment 5.2 Objective To use the various functions within LabVIEW ‚Äôs Control Design and Simulation Module to implement block diagram reduction. Minimum Required Software Packages LabVIEW with the Control Design Simulation Module Prelab Given the block diagram from Example 5.2, replace G 1,G2,G3,H1,H2,H3with the following transfer functions and obtain an equivalent transfer function. G1¬à1 s¬á10;G2¬à1 s¬á1;G3¬às¬á1 s2¬á4s¬á4;H1¬às¬á1 s¬á2;H2¬à2;H3¬à1 Lab Use LabVIEW to implement the block diagram from Example 5.2 using the transfer functions given in the Prelab. Postlab Verify your calculations from the Prelab with that of the equivalent transfer function obtained with LabVIEW. Experiment 5.3Objective To use the various functions within LabVIEW ‚Äôs Control Design and Simulation Module and the Mathematics/Polynomial palette to implement Mason ‚Äôs rule for block diagram reduction. Minimum Required Software Packages LabVIEW with Control Design and Simulation Module, Math Script RT Module, and the Mathematics/Polynomial palette. Prelab Given the block diagram created in the Prelab of Cyber Exploration Laboratory 5.2, use Mason ‚Äôs rule to obtain an equivalent transfer function. Lab Use LabVIEW ‚Äôs Control Design and Simulation Module as well as the Mathematics/ Polynomial functions to implement block diagram reduction using Mason ‚Äôs rule. Postlab Verify your calculations from the Prelab with that of the equivalent transfer function obtained with LabVIEW.296 Chapter 5 Reduction of Multiple SubsystemsWEBC05 10/28/2014 17:36:32 Ballard, R. D The Discovery of the Titanic (New York: Warner Books, Inc 1987). Gozde, H., and Taplamacioglu, M. C. Comparative performance analysis of arti Ô¨Åcial bee colony algorithm for automatic voltage regulator (AVR) system. Journal of the Franklin Institute , vol. 348, pp. 1927 ‚Äì1946, 2011. Graebe, S. F., Goodwin, G. C., and Elsley, G. Control Design and Implementation in Continuous Steel Casting. IEEE Control Systems , August 1995, pp. 64 ‚Äì71. Hostetter, G. H., Savant, C. J., Jr. and Stefani, R. T. Design of Feedback Control Systems . 2d ed. Saunders College Publishing, New York, 1989. Johnson, H. et al. Unmanned Free-Swimming Submersible (UFSS) System Description . NRL Memorandum Report 4393. Naval Research Laboratory, Washington, DC, 1980. Karkoub, M., Her, M.-G., and Chen, J. M. Design and Control of a Haptic Interactive Motion Simulator for Virtual Entertainment Systems. Robonica , vol. 28, 2010, pp. 47 ‚Äì56. Kong, F., and de Keyser, R. Identi Ô¨Åcation and Control of the Mould Level in a Continuous Casting Machine. Second IEEE Conference on Control Application , Vancouver, B.C., 1993. pp. 53 ‚Äì58. Lee, S.-R., Ko, S.-H., Dehbonei, H., Jeon, C.-H., and Kwon, O.-S., Operational Characteristics of PV/ Diesel Hybrid Distributed Generation System Using Dual Voltage Source Inverter for Weak Grid, ISIS 2007 Proceedings , Eighth Symposium on Advanced Intelligent Systems. 2007. Lin, J.-S., and Kanellakopoulos, I., Nonlinear Design of Active Suspensions. IEEE Control Systems , vol. 17, issue 3, June 1997, pp. 45 ‚Äì59. Mason, S. J. Feedback Theory ‚ÄîSome Properties of Signal-Flow Graphs. Proc. IRE , September 1953, pp. 1144 ‚Äì1156. Neamen, D. A. Electronic Circuit Analysis and Design . McGraw-Hill, 2d ed., 2001, p. 334. Piccin, O., Barb√© L., Bayle B., and de Mathelin, M. A Force Feedback Teleoperated Needle Insertion Device for Percutaneous Procedures. Int. J. of Robotics Research , vol. 28, 2009, p. 1154. Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Intelligence and Informatics . IEEE, 2007, pp. 157 ‚Äì162. Tasch, U., Koontz, J. W., Ignatoski, M. A., and Geselowitz, D. B. An Adaptive Aortic Pressure Observer for the Penn State Electric Ventricular Assist Device. IEEE Transactions on Biomedical Engineering , vol. 37, 1990, pp. 374 ‚Äì383. Timothy, L. K., and Bona, B. E. State Space Analysis: An Introduction . McGraw-Hill, New York, Vaughan, N. D., and Gamble, J. B. The Modeling and Simulation of a Proportional Solenoid Valve. Journal of Dynamic Systems, Measurements, and Control , vol. 118, March 1996, pp. 120 ‚Äì125. Yaniv, Y., Sivan, R., and Landesberg, A. Stability, Controllability and Observability of the ‚ÄúFour State‚Äù Model for the Sarcomeric Control of Contraction. Annals of Biomedical Engineering , vol. 34, 2006, pp. 778 ‚Äì789.Bibliography 297WEBC05 10/28/2014 17:36:32 Page 298WEBC06 10/28/2014 17:42:16 Stability Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅMake and interpret a basic Routh table to determine the stability of a system (Sections 6.1 ‚Äì6.2) ¬ÅMake and interpret a Routh table where either the Ô¨Årst element of a row is zero or an entire row is zero (Sections 6.3 ‚Äì6.4) ¬ÅUse a Routh table to determine the stability of a system represented in statespace (Section 6.5) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with casestudies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to Ô¨Ånd the range of preampliÔ¨Å er gain to keep the system stable. ¬ÅGiven the block diagrams for the UFSS vehicle ‚Äôs pitch and heading control systems on the back endpapers, you will be able to determine the range of gainfor stability of the pitch or heading control system.6 299WEBC06 10/28/2014 17:42:17 6.1 Introduction In Chapter 1, we saw that three requirements enter into the design of a control system: transient response, stability, and steady-state errors. Thus far we have covered transientresponse, which we will revisit in Chapter 8. We are now ready to discuss the nextrequirement, stability. Stability is the most important system speci Ô¨Åcation. If a system is unstable, transient response and steady-state errors are moot points. An unstable system cannot be designed fora speci Ô¨Åc transient response or steady-state error requirement. What, then, is stability? There are many de Ô¨Ånitions for stability, depending upon the kind of system or the point of view. In this section, we limit ourselves to linear, time-invariant systems. In Section 1.5, we discussed that we can control the output of a system if the steady- state response consists of only the forced response. But the total response of a system is thesum of the forced and natural responses, or c t¬Ü¬àc forced t¬Ü¬ácnatural t¬Ü (6.1) Using these concepts, we present the following de Ô¨Ånitions of stability, instability, and marginal stability: A linear, time-invariant system is stable if the natural response approaches zero as time approaches in Ô¨Ånity. A linear, time-invariant system is unstable if the natural response grows without bound as time approaches in Ô¨Ånity. A linear, time-invariant system is marginally stable if the natural response neither decays nor grows but remains constant or oscillates as time approaches in Ô¨Ånity. Thus, the de Ô¨Ånition of stability implies that only the forced response remains as the natural response approaches zero. These de Ô¨Ånitions rely on a description of the natural response. When one is looking at the total response, it may be difÔ¨Å cult to separate the natural response from the forced response. However, we realize that if the input is bounded and the total response is not approaching in Ô¨Ånity as time approaches in Ô¨Ånity, then the natural response is obviously not approaching in Ô¨Ånity. If the input is unbounded, we see an unbounded total response, and we cannot arrive at any conclusion about the stability of the system; we cannot tell whether the total response is unbounded because the forced response is unbounded or because thenatural response is unbounded. Thus, our alternate de Ô¨Ånition of stability , one that regards the total response and implies the Ô¨Årst de Ô¨Ånition based upon the natural response, is this: A system is stable if every bounded input yields a bounded output. We call this statement the bounded-input, bounded-output (BIBO) de Ô¨Ånition of stability. Let us now produce an alternate de Ô¨Ånition for instability based on the total response rather than the natural response. We realize that if the input is bounded but the total response isunbounded, the system is unstable, since we can conclude that the natural responseapproaches in Ô¨Ånity as time approaches in Ô¨Ånity. If the input is unbounded, we will see an unbounded total response, and we cannot draw any conclusion about the stability of thesystem; we cannot tell whether the total response is unbounded because the forced response isunbounded or because the natural response is unbounded. Thus, our alternate de Ô¨Ånition of instability , one that regards the total response, is this: A system is unstable if anybounded input yields an unbounded output.300 Chapter 6 StabilityWEBC06 10/28/2014 17:42:17 These de Ô¨Ånitions help clarify our previous de Ô¨Ånition of marginal stability , which really means that the system is stable for some bounded inputs and unstable for others. For example, we will show that if the natural response is undamped, a bounded sinusoidal inputof the same frequency yields a natural response of growing oscillations. Hence, the systemappears stable for all bounded inputs except this one sinusoid. Thus, marginally stablesystems by the natural response de Ô¨Ånitions are included as unstable systems under the BIBO deÔ¨Ånitions. Let us summarize our de Ô¨Ånitions of stability for linear, time-invariant systems. Using the natural response: 1.A system is stable if the natural response approaches zero as time approaches in Ô¨Ånity. 2.A system is unstable if the natural response approaches in Ô¨Ånity as time approaches inÔ¨Ånity. 3.A system is marginally stable if the natural response neither decays nor grows but remains constant or oscillates. Using the total response (BIBO): 1.A system is stable if every bounded input yields a bounded output. 2.A system is unstable if anybounded input yields an unbounded output. Physically, an unstable system whose natural response grows without bound can cause damage to the system, to adjacent property, or to human life. Many times systems are designed with limited stops to prevent total runaway. From the perspective of the timeresponse plot of a physical system, instability is displayed by transients that grow withoutbound and, consequently, a total response that does not approach a steady-state value or other forced response. 1 How do we determine if a system is stable? Let us focus on the natural response deÔ¨Ånitions of stability. Recall from our study of system poles that poles in the left half-plane (lhp) yield either pure exponential decay or damped sinusoidal natural responses. These natural responses decay to zero as time approaches in Ô¨Ånity. Thus, if the closed-loop system poles are in the left half of the plane and hence have a negative real part, the systemis stable. That is, stable systems have closed-loop transfer functions with poles only in the left half-plane . Poles in the right half-plane (rhp) yield either pure exponentially increasing or exponentially increasing sinusoidal natural responses. These natural responses approachinÔ¨Ånity as time approaches in Ô¨Ånity. Thus, if the closed-loop system poles are in the right half of the s-plane and hence have a positive real part, the system is unstable. Also, poles of multiplicity greater than 1 on the imaginary axis lead to the sum of responses of the formAt ncos œât¬áœï¬Ü, where n¬à1;2;...;where the amplitude approaches in Ô¨Ånity as time approaches in Ô¨Ånity. Thus, unstable systems have closed-loop transfer functions with at least one pole in the right half-plane and/or poles of multiplicity greater than 1 on the imaginary axis . Finally, a system that has imaginary axis poles of multiplicity 1 yields pure sinusoidal oscillations as a natural response. These responses neither increase nor decrease in amplitude. Thus, marginally stable systems have closed-loop transfer functions with only imaginary axis poles of multiplicity 1 and poles in the left half-plane . As an example, the unit step response of the stable system of Figure 6.1( a)i s compared to that of the unstable system of Figure 6.1( b). The responses, also shown in 1Care must be taken here to distinguish between natural responses growing without bound and a forced response, such as a ramp or exponential increase, that also grows without bound. A system whose forced response approaches in Ô¨Ånity is stable as long as the natural response approaches zero.6.1 Introduction 301WEBC06 10/28/2014 17:42:17 Figure 6.1, shows that while the oscillations for the stable system diminish, those for the unstable system increase without bound. Also notice that the stable system ‚Äôs response in this case approaches a steady-state value of unity. It is not always a simple matter to determine if a feedback control system is stable. Unfortunately, a typical problem that arises is shown in Figure 6.2. Although we know thepoles of the forward transfer function in Figure 6.2( a), we do not know the location of the poles of the equivalent closed-loop system of Figure 6.2( b) without factoring or otherwise solving for the roots. However, under certain conditions, we can draw some conclusions about the stability of the system. First, if the closed-loop transfer function has only left-half-plane poles, thenthe factors of the denominator of the closed-loop system transfer function consist ofproducts of terms such as s¬áa i¬Ü, where aiis real and positive, or complex with a positive real part. The product of such terms is a polynomial with all positive coef Ô¨Åcients.2No term of the polynomial can be missing, since that would imply cancellation between positive and negative coef Ô¨Åcients or imaginary axis roots in the factors, which is not the case. Thus, a01c(t) 15 30 0 Time (seconds) 1 0 ‚Äì115c(t) Time (seconds)‚Äì3 s(s +1)(s + 2) Stable system jœâ j 1.047s-plane ‚Äìj 1.047‚Äì0.164 ‚Äì2.672 Stable system's closed-loop poles (not to scale) ‚Äì7 s(s +1)(s + 2) Unstable system œÉœÉ jœâ j 1.505 s-plane ‚Äìj 1.5050.0434 ‚Äì3.087 Unstable system's closed-loop poles (not to scale)C(s) C(s) (b)(a)E(s) E(s)+1 R(s) = +s 1 s 30= R(s) 0 FIGURE 6.1 Closed-loop poles and response: a.stable system; b.unstable system 2The coef Ô¨Åcients can also be made all negative by multiplying the polynomial by  1. This operation does not change the root location.302 Chapter 6 StabilityWEBC06 10/28/2014 17:42:17 sufÔ¨Åcient condition for a system to be unstable is that all signs of the coef Ô¨Åcients of the denominator of the closed-loop transfer function are not the same. If powers of sare missing, the system is either unstable or, at best, marginally stable. Unfortunately, if all coef Ô¨Åcients of the denominator are positive and not missing, we do not have de Ô¨Ånitive information about the system ‚Äôs pole locations. If the method described in the previous paragraph is not suf Ô¨Åcient, then a computer can be used to determine the stability by calculating the root locations of the denominator of the closed-loop transfer function. Today some hand-held calculators can evaluate the roots of a polynomial. There is, however, another method to test for stability without having tosolve for the roots of the denominator. We discuss this method in the next section. 6.2 Routh-Hurwitz Criterion In this section, we learn a method that yields stability information without the need to solvefor the closed-loop system poles. Using this method, we can tell how many closed-loopsystem poles are in the left half-plane, in the right half-plane, and on the jœâ-axis. (Notice that we say how many , not where .) We can Ô¨Ånd the number of poles in each section of the s-plane, but we cannot Ô¨Ånd their coordinates. The method is called the Routh-Hurwitz criterion for stability ( Routh ,1905 ). The method requires two steps: (1) Generate a data table called a Routh table and (2) interpret the Routh table to tell how many closed-loop system poles are in the left half-plane, the right half-plane, and on the jœâ-axis. You might wonder why we study the Routh-Hurwitz criterion when modern calculators and computers can tell us the exact location of system poles. The power of the method lies in design rather than analysis. For example, if you havean unknown parameter in the denominator of a transfer function, it isdifÔ¨Åcult to determine via a calculator the range of this parameter to yield stability. You would probably rely on trial and error to answer the stabilityquestion. We shall see later that the Routh-Hurwitz criterion can yield aclosed-form expression for the range of the unknown parameter. In this section, we make and interpret a basic Routh table. In the next section, we consider two special cases that can arise when generating thisdata table. Generating a Basic Routh Table Look at the equivalent closed-loop transfer function shown in Figure 6.3. Since we areinterested in the system poles, we focus our attention on the denominator. We Ô¨Årst create the Routh table shown in Table 6.1. Begin by labeling the rows with powers of sfrom the highest power of the denominator of the closed-loop transfer function to s Next start with the coef Ô¨Åcient of the highest power of sin the denominator and list, horizontally in the Ô¨Årst row, every other coefÔ¨Å cient. In the second row, list horizontally, starting with the next highest power of s, every coef Ô¨Åcient that was skipped in the Ô¨Årst row.C(s) R(s) (b)C(s) R(s) (a)‚Äì+ E(s) s(s + 4)(s + 6)(s + 8)(s + 10)10(s + 2) 10(s + 2) s5 + 28s4 + 284s3 + 1232s2 + 1930s + 20FIGURE 6.2 Common cause of problems in Ô¨Ånding closed- loop poles: a.original system; b.equivalent system N(s) C(s) R(s) a4s4 + a 3s3 + a 2s2 + a 1s + a 0 FIGURE 6.3 Equivalent closed-loop transfer function TABLE 6.1 Initial layout for Routh table s4a4 a2 a0 s3a3 a1 0 s2 s1 s06.2 Routh-Hurwitz Criterion 303WEBC06 10/28/2014 17:42:19 The remaining entries are Ô¨Ålled in as follows. Each entry is a negative determinant of entries in the previous two rows divided by the entry in the Ô¨Årst column directly above the calculated row. The left-hand column of the determinant is always the Ô¨Årst column of the previous two rows, and the right-hand column is the elements of the column above and to the right. The table is complete when all of the rows are completed down to s0. Table 6.2 is the completed Routh table. Let us look at an example.TABLE 6.2 Completed Routh table s4a4 a2 a0 s3a3 a1 0 s2 /C12/C12/C12/C12a 4a2 a3a1/C12/C12/C12/C12 a 3¬àb1 /C12/C12/C12/C12a 4a0 a30/C12/C12/C12/C12 a 3¬àb2 /C12/C12/C12/C12a 40 a30/C12/C12/C12/C12 a 3¬à0 s1 /C12/C12/C12/C12a 3a1 b1b2/C12/C12/C12/C12 b 1¬àc1 /C12/C12/C12/C12a 30 b10/C12/C12/C12/C12 b 1¬à0 /C12/C12/C12/C12a 30 b10/C12/C12/C12/C12 b 1¬à0 s0 /C12/C12/C12/C12b 1b2 c10/C12/C12/C12/C12 c 1¬àd1 /C12/C12/C12/C12b 10 c10/C12/C12/C12/C12 c 1¬à0 /C12/C12/C12/C12b 10 c10/C12/C12/C12/C12 c 1¬à0 Example 6.1 Creating a Routh TableCreating a Routh Table PROBLEM: Make the Routh table for the system shown in Figure 6.4( a). SOLUTION: TheÔ¨Årst step is to Ô¨Ånd the equivalent closed-loop system because we want to test the denominator of this function, not the given forward transfer function, for pole location. Using the feedback formula, we obtain the equivalent system of Figure 6.4( b). The Routh-Hurwitz criterion will b e applied to this denominator. First label the rows with powers of sfrom s3down to s0in a vertical column, as shown in Table 6.3. Next form the Ô¨Årst row of the table, using the coef Ô¨Åcients of the denominator of the closed-loop transfer function. Start with the coef Ô¨Åcient of the highest power and skip every other power of s. Now form the second row with the coef Ô¨Åcients of the denominator skipped in the previ ous step. Subsequent rows are formed with determinants, as shown in Table 6.2. For convenience, any row of the Routh table can be multiplied by a positive constant without changing the values of the rows below. This can be proved by examining the expressions for the entries and verifying that any multiplicative constant from a previousrow cancels out. In the second row of Table 6.3, for example, the row was multiplied by1/10. We see later that care must be taken not to multiply the row by a negative constant.1000 R(s) (b)1000 C(s) R(s) (a)‚Äì+ E(s) C(s)(s + 2)(s + 3)(s + 5) s3 + 10s2 + 31s + 1030FIGURE 6.4 a.Feedback system for Example 6.1; b.equivalent closed-loop system304 Chapter 6 StabilityWEBC06 10/28/2014 17:42:20 Interpreting the Basic Routh Table Now that we know how to generate the Routh table, let us see how to interpret it. The basic Routh table applies to systems with poles in the left and right half-planes. Systems with imaginary poles and the kind of Routh table that results will be discussed in the nextsection. Simply stated, the Routh-Hurwitz criterion declares that the number of roots of the polynomial that are in the right half-plane is equal to the number of sign changes intheÔ¨Årst column . If the closed-loop transfer function has all poles in the left half of the s-plane, the system is stable. Thus, a system is stable if there are no sign changes in the Ô¨Årst column of the Routh table. For example, Table 6.3 has two sign changes in the Ô¨Årst column. The Ô¨Årst sign change occurs from 1 in the s 2row to  72 in the s1row. The second occurs from  72 in thes1row to 103 in the s0row. Thus, the system of Figure 6.4 is unstable since two poles exist in the right half-plane. Now that we have described how to generate and interpret a basic Routh table, let us look at two special cases that can arise. 6.3 Routh-Hurwitz Criterion: Special Cases Two special cases can occur: (1) The Routh table sometimes will have a zero only in the Ô¨Årst column of a row, or (2) the Routh table sometimes will have an entire row that consists of zeros. Let us examine the Ô¨Årst case.TABLE 6.3 Completed Routh table for Example 6.1 s313 1 0 s210 1 1030 103 0 s1 /C12/C12/C12/C1213 1 1 103/C12/C12/C12/C12 1¬à 72 /C12/C12/C12/C1210 00/C12/C12/C12/C12 1¬à0  /C12/C12/C12/C1210 10/C12/C12/C12/C12 1¬à0 s 0 /C12/C12/C12/C121 103  72 0/C12/C12/C12/C12  72¬à103  /C12/C12/C12/C1210  72 0/C12/C12/C12/C12  72¬à0  /C12/C12/C12/C1210  72 0/C12/C12/C12/C12  72¬à0 Skill-Assessment Exercise 6.1 PROBLEM: Make a Routh table and tell how many roots of the following polynomial are in the right half-plane and in the left half-plane. P s¬Ü¬à3s7¬á9s6¬á6s5¬á4s4¬á7s3¬á8s2¬á2s¬á6 ANSWER: Four in the right half-plane (rhp), three in the left half-plane (lhp). The complete solution is at www.wiley.com/college/nise .6.3 Routh-Hurwitz Criterion: Special Cases 305WEBC06 10/28/2014 17:42:25 Zero Only in the First Column If the Ô¨Årst element of a row is zero, division by zero would be required to form the next row. To avoid this phenomenon, an epsilon, œµ,i sa s s i g n e dt or e p l a c et h ez e r oi nt h e Ô¨Årst column. The value œµis then allowed to approach zero from either the positive or the negative side, after which the signs of the entries in the Ô¨Årst column can be determined. L e tu sl o o ka ta ne x a m p l e . Example 6.2 Stability via Epsilon MethodStability via Epsilon Method PROBLEM: Determine the stability of the closed-loop transfer function T s¬Ü¬à10 s5¬á2s4¬á3s3¬á6s2¬á5s¬á3(6.2) SOLUTION: The solution is shown in Table 6.4. We form the Routh table by using the denominator of Eq. (6.2). Begin by assembling the Routh table down to the row where a zero appears only in the Ô¨Årst column (the s3row). Next replace the zero by a small number, œµ, and complete the table. To begin the interpretation, we must Ô¨Årst assume a sign, positive or negative, for the quantity œµ. Table 6.5 shows the Ô¨Årst column of Table 6.4 along with the resulting signs for choices of œµpositive and œµnegative. Ifœµis chosen positive, Table 6.5 will show a sign change from the s3row to the s2 row, and there will be another sign change from the s2row to the s1row. Hence, the system is unstable and has two poles in the right half-plane. Alternatively, we could choose œµnegative. Table 6.5 would then show a sign change from the s4row to the s3row. Another sign change would occur from the s3row to the s2 row. Our result would be exactly the same as that for a positive choice for œµ. Thus, the system is unstable, with two poles in the right half-plane. Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch6sp1 in Appendix F at www.wiley.com/college/nise .Y o u will learn how to use the Symbolic Math Toolbox to calculate thevalues of cells in a Routh table even if the table contains symbolicobjects, such as œµ. You will see that the Symbolic Math Toolbox and MATLAB yield an alternate way to generate the Routh table forExample 6.2.TryIt 6.1 Use the following MATLAB statement to Ô¨Ånd the poles of the closed-loop transfer function in Eq. (6.1). roots( [ 123653 ] ) TABLE 6.4 Completed Routh table for Example 6.2 s513 5 s426 3 s30œµ7 20 s2 6œµ 7 œµ30 s1 42œµ 49 6œµ2 12œµ 1400 s030 0TABLE 6.5 Determining signs in Ô¨Årst column of a Routh table with zero as Ô¨Årst element in a row Label First column œµ¬à¬á œµ¬à  s51 ++ s42 ++ s30œµ +   s2 6œµ 7 œµ  + s1 42œµ 49 6œµ2 12œµ 14++ s03 ++306 Chapter 6 StabilityWEBC06 10/28/2014 17:42:27 Another method that can be used when a zero appears only in the Ô¨Årst column of a row is derived from the fact that a polynomial that has the reciprocal roots of the original polynomial has its roots distributed the same ‚Äîright half-plane, left half-plane, or imaginary axis‚Äîbecause taking the reciprocal of the root value does not move it to another region. Thus, if we can Ô¨Ånd the polynomial that has the reciprocal roots of the original, it is possible that the Routh table for the new polynomial will not have a zero in the Ô¨Årst column. This method is usually computationally easier than the epsilon method just described. We now show that the polynomial we are looking for, the one with the reciprocal roots, is simply the original polynomial with its coef Ô¨Åcients written in reverse order (Phillips, 1991 ). Assume the equation sn¬áan 1sn 1¬á‚àô‚àô‚àô¬áa1s¬áa0¬à0 (6.3) Ifsis replaced by 1= d, then dwill have roots which are the reciprocal of s. Making this substitution in Eq. (6.3), 1 d/C18/C19n ¬áan 11 d/C18/C19n 1 ¬á‚àô‚àô‚àô¬áa11 d/C18/C19 ¬áa0¬à0 (6.4) Factoring out 1=d¬Ün, 1 d/C18/C19n 1¬áan 11 d/C18/C19 1 ¬á‚àô‚àô‚àô¬áa11 d/C18/C191 n ¬Ü ¬áa01 d/C18/C19 n"# ¬à1 d/C18/C19n ¬â1¬áan 1d¬á‚àô‚àô‚àô¬áa1d n 1¬Ü¬áa0dn¬ä¬à0 (6.5) Thus, the polynomial with reciprocal roots is a polynomial with the coef Ô¨Åcients written in reverse order. Let us redo the previous example to show the computational advantage ofthis method. Example 6.3 Stability via Reverse CoefÔ¨Å cients Stability via Reverse CoefÔ¨Å cients PROBLEM: Determine the stability of the closed-loop transfer function T s¬Ü¬à10 s5¬á2s4¬á3s3¬á6s2¬á5s¬á3(6.6) SOLUTION: First write a polynomial that has the reciprocal roots of the denominator of Eq. (6.6). From our discussion, this polynomial is formed by writing the denominator of Eq. (6.6) in reverse order. Hence, D s¬Ü¬à3s5¬á5s4¬á6s3¬á3s2¬á2s¬á1 (6.7) We form the Routh table as shown in Table 6.6 using Eq. (6.7). Since there are two signchanges, the system is unstable and has two right-half-plane poles. This is the same asthe result obtained in Example 6.2. Notice that Table 6.6 does not have a zero in theÔ¨Årst column.TABLE 6.6 Routh table for Example 6.3 s536 2 s453 1 s34.2 1.4 s21.33 1 s1 1.75 s016.3 Routh-Hurwitz Criterion: Special Cases 307WEBC06 10/28/2014 17:42:29 Entire Row is Zero We now look at the second special case. Sometimes while making a Routh table, we Ô¨Ånd that an entire row consists of zeros because there is an even polynomial that is a factor of the original polynomial. This case must be handled differently from the case of a zero inonly the Ô¨Årst column of a row. Let us look at an example that demonstrates how to construct and interpret the Routh table when an entire row of zeros is present. Example 6.4 Stability via Routh Table with Row of ZerosStability via Routh Table with Row of Zeros PROBLEM: Determine the number of right-half-plane poles in the closed-loop transfer function T s¬Ü¬à10 s5¬á7s4¬á6s3¬á42s2¬á8s¬á56(6.8) SOLUTION: Start by forming the Routh table for the denominator of Eq. (6.8) (see Table 6.7). At the second row we multiply through by 1/7 for convenience. We stop at the third row, since the entire row consists of zeros, and use the following procedure.First we return to the row immediately above the row of zeros and form an auxiliarypolynomial, using the entries in that row as coef Ô¨Åcients. The polynomial will start with the power of sin the label column and continue by skipping every other power of s.T h u s , the polynomial formed for this example is P s¬Ü¬às 4¬á6s2¬á8( 6 . 9 ) Next we differentiate the polynomial with respect to sand obtain dP s¬Ü ds¬à4s3¬á12s¬á0 (6.10) Finally, we use the coef Ô¨Åcients of Eq. (6.10) to replace the row of zeros. Again, for convenience, the third row is multiplied by 1/4 after replacing the zeros. The remainder of the table is formed in a straightforward manner by following the standard form shown in Table 6.2. Table 6.7 shows that all entries in the Ô¨Årst column are positive. Hence, there are no right-half-plane poles. TABLE 6.7 Routh table for Example 6.4 s516 8 s471 42 6 56 8 s30 41 0 12 3 0 00 s238 0 s11 300 s080 0308 Chapter 6 StabilityWEBC06 10/28/2014 17:42:29 Let us look further into the case that yields an entire row of zeros. An entire row of zeros will appear in the Routh table when a purely even or purely odd polynomial is a factor of the original polynomial. Forexample, s 4¬á5s2¬á7 is an even polynomial; it has only even powers ofs. Even polynomials only have roots that are symmetrical about the origin.3This symmetry can occur under three conditions of root position: (1) The roots are symmetrical and real, (2) the roots are symmetrical andimaginary, or (3) the roots are quadrantal. Figure 6.5 shows examples ofthese cases. Each case or combination of these cases will generate an even polynomial. It is this even polynomial that causes the row of zeros to appear. Thus, the row of zeros tells us of the existence of an even polynomial whose roots are symmetric about the origin. Some of these roots could beon the jœâ-axis. On the other hand, since jœâroots are symmetric about the origin, if we do not have a row of zeros, we cannot possibly have jœâroots. Another characteristic of the Routh table for the case in question is that the row previous to the row of zeros contains the even polynomial that is a factor of the original polynomial. Finally, everything from the row containing the even polynomial down to the end of the Routh tableis a test of only the even polynomial. Let us put these facts together in anexample.CC CC AAjœâ s-plane A: Real and symmetrical about the origin B: Imaginary and symmetrical about the origin C: Quadrantal and s ymmetrical about the ori ginBB œÉ FIGURE 6.5 Root positions to generate even polynomials: A,B,C, or any combination 3The polynomial s5¬á5s3¬á7sis an example of an odd polynomial; it has only odd powers of s. Odd polynomials are the product of an even polynomial and an odd power of s. Thus, the constant term of an odd polynomial is always missing.Example 6.5 Pole Distribution via Routh Table with Row of ZerosPole Distribution via Routh Table with Row of Zeros PROBLEM: For the transfer function T s¬Ü¬à20 s8¬ás7¬á12s6¬á22s5¬á39s4¬á59s3¬á48s2¬á38s¬á20(6.11) tell how many poles are in the right half-plane, in the left half-plane, and on the jœâ-axis. SOLUTION: Use the denominator of Eq. (6.11) and form the Routh table in Table 6.8. For convenience the s6row is multiplied by 1/10, and the s5row is multiplied by 1/20. At the s3row we obtain a row of zeros. Moving back one row to s4, we extract the even polynomial, P(s), as P s¬Ü¬às4¬á3s2¬á2( 6 . 1 2 ) This polynomial will divide evenly into the denominator of Eq. (6.11) and thus is a factor. Taking the derivative with respect to sto obtain the coef Ô¨Åcients that replace the row of zeros in the s3row, we Ô¨Ånd dP s¬Ü ds¬à4s3¬á6s¬á0( 6.13) Replace the row of zeros with 4, 6, and 0 and multiply the row by 1/2 for convenience.Finally, continue the table to the s 0row, using the standard procedure.6.3 Routh-Hurwitz Criterion: Special Cases 309WEBC06 10/28/2014 17:42:35 How do we now interpret this Routh table? Since all entries from the even polynomial at the s4row down to the s0row are a test of the even polynomial, we begin to draw some conclusions about the roots of the even polynomial. No sign changes exist from the s4row down to the s0row. Thus, the even polynomial does not have right-half- plane poles. Since there are no right-half-plane poles, no left-half-plane poles are presentbecause of the requirement for symmetry. Hence, the even polynomial, Eq. (6.12), musthave all four of its poles on the jœâ-axis. 4These results are summarized in the Ô¨Årst column of Table 6.9. The remaining roots of the total polynomial are evaluated from the s8row down to thes4row. We notice two sign changes: one from the s7row to the s6row and the other from the s6row to the s5row. Thus, the other polynomial must have two roots in the right half-plane. These results are included in Table 6.9 under Other . The Ô¨Ånal tally is the sum of roots from each component, the even polynomial and the other polynomial, as shownunder Total in Table 6.9. Thus, the system has two poles in the right half-plane, two poles in the left half-plane, and four poles on the jœâ-axis; it is unstable because of the right-half- plane poles.TABLE 6.8 Routh table for Example 6.5 s811 2 3 9 4 8 2 0 s712 2 5 9 3 8 0 s6 10 1  20 2 10 1 20 2 0 s520 1 60 3 40 2 0 0 s413 2 0 0 s30 42 063 0 00 0 0 s23 23 24 0 0 0 s11300 0 0 s 040 0 0 0 4A necessary condition for stability is that the jœâroots have unit multiplicity. The even polynomial must be checked for multiple jœâroots. For this case, the existence of multiple jœâroots would lead to a perfect, fourth-order square polynomial. Since Eq. (6.12) is not a perfect square, the four jœâroots are distinct.TABLE 6.9 Summary of pole locations for Example 6.5 Polynomial LocationEven (fourth-order)Other (fourth-order)Total (eighth-order) Right half-plane 0 2 2 Left half-plane 0 2 2 jœâ 404310 Chapter 6 StabilityWEBC06 10/28/2014 17:42:35 We now summarize what we have learned about polynomials that generate entire rows of zeros in the Routh table. These polynomials have a purely even factor with roots that are sy mmetrical about the origin. The even polynomial appears in the Routh table in the row directly above the row ofzeros. Every entry in the table from the even polynomial ‚Äôs row to the end of the chart applies only to the even polynomial. Therefore, the number of signchanges from the even polynomial to the end of the table equals the numberof right-half-plane roots of the even polynomial. Because of the symmetryof roots about the origin, the even polynomial must have the same number of left-half-plane roots as it does right-half-plane roots. Having accounted for the roots in the right and left half-planes, we know the remaining rootsmust be on the jœâ-axis. Every row in the Routh table from the beginning of the chart to the row containing the even polynomial applies only to the other factor of theoriginal polynomial. For this factor, the number of sign changes, from thebeginning of the table down to the even polynomial, equals the number ofright-half-plane roots. The remaining roots are left-half-plane roots. There can be no jœâroots contained in the other polynomial. Let us demonstrate the usefulness of the Routh-Hurwitz criterion with a few additional examples. 6.4 Routh-Hurwitz Criterion: Additional Examples The previous two sections have introduced the Routh-Hurwitz criterion. Now we need todemonstrate the method ‚Äôs application to a number of analysis and design problems.Virtual Experiment 6.1 Stability Put theory into practice and evaluate the stability of the Quanser Linear Inverted Pendulum in LabVIEW. When in the upward balancedposition, this system addresses the challenge ofstabilizing a rocket during take-off. In the downward position it emulates the construction gantry crane. Virtual experiments are found onLearning Space. Skill-Assessment Exercise 6.2 PROBLEM: Use the Routh-Hurwitz criterion to Ô¨Ånd how many poles of the following closed-loop system, T(s), are in the rhp, in the lhp, and on the jœâ-axis: T s¬Ü¬às3¬á7s2 21s¬á10 s6¬ás5 6s4¬á0s3 s2 s¬á6 ANSWER: Two rhp, two lhp, and two jœâ The complete solution is at www.wiley.com/college/nise . Example 6.6 Standard Routh-HurwitzStandard Routh-Hurwitz PROBLEM: Find the number of poles in the left half-plane, the right half-plane, and on thejœâ-axis for the system of Figure 6.6.6.4 Routh-Hurwitz Criterion: Additional Examples 311WEBC06 10/28/2014 17:42:37 The next example demonstrates the occurrence of a zero in only the Ô¨Årst column of a row.SOLUTION: First, Ô¨Ånd the closed-loop transfer function as T s¬Ü¬à200 s4¬á6s3¬á11s2¬á6s¬á200(6.14) The Routh table for the denominator of Eq. (6.14) is shown as Table 6.10. For clarity, we leave most zero cells blank. At the s1row there is a negative coef Ô¨Åcient; thus, there are two sign changes. The system is unstable, since it has two right-half-plane poles and two left-half-plane poles. The system cannot have jœâpoles since a row of zeros did not appear in the Routh table.200 C(s) R(s) + E(s) s(s3 + 6s2 + 11s + 6)‚ÄìFIGURE 6.6 Feedback control system for Example 6.6 TABLE 6.10 Routh table for Example 6.6 s41 11 200 s361 61 s210 1 200 20 s1 19 s020 Example 6.7 Routh-Hurwitz with Zero in First ColumnRouth-Hurwitz with Zero in First Column PROBLEM: Find the number of poles in the left half-plane, the right half-plane, and on thejœâ-axis for the system of Figure 6.7. SOLUTION: The closed-loop transfer function is T s¬Ü¬à1 2s5¬á3s4¬á2s3¬á3s2¬á2s¬á1(6.15) Form the Routh table shown as Table 6.11, using the denominator of Eq. (6.15). A zero appears in the Ô¨Årst column of the s3row. Since the entire row is not zero, simply replace1 C(s) R(s) ‚Äì+ s(2s4 + 3s3 + 2s2 + 3s + 2)E(s) FIGURE 6.7 Feedback control system for Example 6.7312 Chapter 6 StabilityWEBC06 10/28/2014 17:42:40 In the next example, we see an entire row of zeros appear along with the possibility of imaginary roots.the zero with a small quantity, œµ, and continue the table. Permitting œµto be a small, positive quantity, we Ô¨Ånd that the Ô¨Årst term of the s2row is negative. Thus, there are two sign changes, and the system is unstable, with two poles in the right half-plane. The remaining poles are in the left half-plane. We also can use the alternative approach, where we produce a polynomial whose roots are the reciprocal of the original. Using the denominator of Eq. (6.15), we form a polynomial by writing the coef Ô¨Åcients in reverse order, s5¬á2s4¬á3s3¬á2s2¬á3s¬á2 (6.16) The Routh table for this polynomial is shown as Table 6.12. Unfortunately, in this casewe also produce a zero only in the Ô¨Årst column at the s 2row. However, the table is easier to work with than Table 6.11. Table 6.12 yields the same results as Table 6.11:three poles in the left half-plane and two p oles in the right-half-plane. The system is unstable. Students who are using MATLAB should now run ch6p1 in Appendix B. You will learn how to perform block diagram reduction to Ô¨Ånd T(s), followed by an evaluation of the closed-loop system‚Äô s poles to determine stability. This exercise uses MATLAB to do Example 6.7.TABLE 6.11 Routh table for Example 6.7 s522 2 s433 1 s30 œµ4 3 s23œµ 4 œµ1 s1 12œµ 16 3œµ2 9œµ 12 s01 TABLE 6.12 Alternative Routh table for Example 6.7 s513 3 s422 2 s322 s20 œµ 2 s12œµ 4 œµ s026.4 Routh-Hurwitz Criterion: Additional Examples 313WEBC06 10/28/2014 17:42:44 Example 6.8 Routh-Hurwitz with Row of ZerosRouth-Hurwitz with Row of Zeros PROBLEM: Find the number of poles in the left half-plane, the right half-plane, and on thejœâ-axis for the system of Figure 6.8. Draw conclusions about the stability of the closed-loop system. SOLUTION: The closed-loop transfer function for the system of Figure 6.8 is T s¬Ü¬à128 s8¬á3s7¬á10s6¬á24s5¬á48s4¬á96s3¬á128s2¬á192s¬á128(6.17) Using the denominator, form the Routh table shown as Table 6.13. A row of zeros appears in the s5row. Thus, the closed-loop transfer function denominator must have an even polynomial as a factor. Return to the s6row and form the even polynomial: P s¬Ü¬às6¬á8s4¬á32s2¬á64 (6.18) Differentiate this polynomial with respect to sto form the coef Ô¨Åcients that will replace the row of zeros: dP s¬Ü ds¬à6s5¬á32s3¬á64s¬á0 (6.19) Replace the row of zeros at the s5row by the coef Ô¨Åcients of Eq. (6.19) and multiply through by 1/2 for convenience. Then complete the table. We note that there are two sign changes from the even polynomial at the s6row down to the end of the table. Hence, the even polynomial has two right-half-plane poles.Because of the symmetry about the origin, the even polynomial must have an equal number of left-half-plane poles. Therefore, the even polynomial has two left-half-plane128 R(s) ‚Äì+ C(s) s(s7 + 3s6 + 10s5 + 24s4 + 48s3 + 96s2 + 128s + 192)E(s) FIGURE 6.8 Feedback control system for Example 6.8 TABLE 6.13 Routh table for Example 6.8 s81 10 48 128 128 s731 24 8 96 32 192 64 s621 16 8 64 32 128 64 s5063 032 16 064 32 0 00 s48 3164 38 64 24 s3 8 1  40 5 s231 24 8 s13 s08TryIt 6.2 Use MATLAB, The Control System Toolbox, and the following statements to Ô¨Ånd the closed-loop transfer function,T(s), for Figure 6.8 and the closed-loop poles. numg=128; deng=[1 3 10 24 ... 48 96 128 192 0] ; G=tf(numg, deng) ; T=feedback(G, 1) poles =pole(T)314 Chapter 6 StabilityWEBC06 10/28/2014 17:42:46 The Routh-Hurwitz criterion gives vivid proof that changes in the gain of a feedback control system result in differences in transient response because of changes in closed-loop pole locations. The next example demonstrates this concept. We will see that for controlsystems, such as those shown in Figure 6.9, gain variations can move poles from stableregions of the s-plane onto the jœâ-axis and then into the right half-plane.poles. Since the even polynomial is of sixth order, the two remaining poles must be onthejœâ-axis. There are no sign changes from the beginning of the table down to the even polynomial at the s 6row. Therefore, the rest of the polynomial has no right-half-plane poles. The results are summarized in Table 6.14. The system has two poles in theright half-plane, four poles in the left half-plane, and two poles on the jœâ-axis, which are of unit multiplicity. The clo sed-loop system is unstable because of the right-half- plane poles. TABLE 6.14 Summary of pole locations for Example 6.8 Polynomial LocationEven (sixth-order)Other (second-order)Total (eighth-order) Right half-plane 2 0 2 Left half-plane 2 2 4 jœâ 20 2 Fiber-optic tetherSyntactic flotation module (1200 Ibs)Thrusters (1 of 7)Lifting bailLong baseline & emergency beacon Emergency flasher Video camera Video camera Flash for still photography250-watt lamps (1 of 8) Electronic compassSide-scan sonar electronics housingTelemetry housing w/lasers Manipulator electronics housing Computer housing w/gyroAltimeterWiring junction box (1 of 2)Aluminum tubular frameSide-scan transceiver array (1 of 2) Still film camera Manipulator with coring toolPan & till unit FIGURE 6.9 Jason is an underwater, remote-controlled vehicle that has been used to explore the wreckage of the Lusitania . The manipulator and cameras comprise some of the vehicle ‚Äôs control systems (Courtesy of Woods Hole Oceanographic Institution)6.4 Routh-Hurwitz Criterion: Additional Examples 315WEBC06 10/28/2014 17:42:48 Example 6.9 Stability Design via Routh-HurwitzStability Design via Routh-Hurwitz PROBLEM: Find the range of gain, K, for the system of Figure 6.10 that will cause the system to be stable, unstable, and marginally stable. Assume K>0. SOLUTION: FirstÔ¨Ånd the closed-loop transfer function as T s¬Ü¬àK s3¬á18s2¬á77s¬áK(6.20) Next form the Routh table shown as Table 6.15. Since Kis assumed positive, we see that all elements in the Ô¨Årst column are always positive except the s1row. This entry can be positive, zero, or negative, depending upon the value of K.I f K<1386, all terms in the Ô¨Årst column will be positive, and since there are no sign changes, the system will have three poles in the left half-plane and be stable . IfK>1386, the s1term in the Ô¨Årst column is negative. There are two sign changes, indicating that the system has two right-half-plane poles and one left-half-plane pole, which makes the system unstable . IfK¬à1386, we have an entire row of zeros, which could signify jœâpoles. Returning to the s2row and replacing Kwith 1386, we form the even polynomial P s¬Ü¬à18s2¬á1386 (6.21) Differentiating with respect to s, we have dP s¬Ü ds¬à36s¬á0 (6.22) Replacing the row of zeros with the coef Ô¨Åcients of Eq. (6.22), we obtain the Routh-Hurwitz table shown as Table 6.16 for the case of K¬à1386.K C(s) E(s) R(s) s(s + 7)(s + 11)‚Äì+ FIGURE 6.10 Feedback control system for Example 6.9 TABLE 6.16 Routh table for Example 6.9 with K=1386 s317 7 s218 1386 s103 6 s01386TABLE 6.15 Routh table for Example 6.9 s317 7 s218 K s11386  K 18 s0K316 Chapter 6 StabilityWEBC06 10/28/2014 17:42:49 The Routh-Hurwitz criterion is often u sed in limited applications to factor polynomials containing even factors. Let us look at an example.Since there are no sign changes from the even polynomial ( s2row) down to the bottom of the table, the even polynomial has its two roots on the jœâ-axis of unit multiplicity. Since there are no sign changes above the even polynomial, the remaining root is in the left half-plane. Therefore the system is marginally stable . Students who are using MATLAB should now run ch6p2 in Appendix B. You will learn how to set up a loop to search for the range of gainto yield stability. This exercise uses MATLAB to do Example 6.9. Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch6sp2 in Appendix F at www.wiley.com/college/ nise . You will learn how to use the Symbolic Math Toolbox to calcu- late the values of cells in a Routh table even if the table containssymbolic objects, such as a variable gain, K. You will see that the Symbolic Math Toolbox and MATLAB yield an alternative way to solve Example 6.9. Example 6.10 Factoring via Routh-HurwitzFactoring via Routh-Hurwitz PROBLEM: Factor the polynomial s4¬á3s3¬á30s2¬á30s¬á200 (6.23) SOLUTION: Form the Routh table of Table 6.17. We Ô¨Ånd that the s1row is a row of zeros. Now form the even polynomial at the s2row: P s¬Ü¬às2¬á10 (6.24) This polynomial is differentiated with respect to sin order to complete the Routh table. However, since this polynomial is a factor of the original polynomial in Eq. (6.23), dividing Eq. (6.23) by (6.24) yields s2¬á3s¬á20¬Üas the other factor. Hence, s4¬á3s3¬á30s2¬á30s¬á200¬à s2¬á10¬Ü s2¬á3s¬á20¬Ü ¬à s¬áj3:1623 ¬Ü s j3:1623 ¬Ü  s¬á1:5¬áj4:213¬Ü s¬á1:5 j4:213¬Ü (6.25)TABLE 6.17 Routh table for Example 6.10 s41 30 200 s331 30 10 s220 1 200 10 s102 00 s0106.4 Routh-Hurwitz Criterion: Additional Examples 317WEBC06 10/28/2014 17:42:50 6.5 Stability in State Space Up to this point we have examined stability from the s-plane viewpoint. Now we look at stability from the perspective of state space. In Section 4.10, we mentioned that the values of the system ‚Äôs poles are equal to the eigenvalues of the system matrix, A. We stated that the eigenvalues of the matrix Awere solutions of the equation det sI A¬Ü¬à0, which also yielded the poles of the transfer function. Eigenvalues appeared again in Section 5.8, wherethey were formally de Ô¨Åned and used to diagonalize a matrix. Let us now formally show that the eigenvalues and the system poles have the same values. Reviewing Section 5.8, the eigenvalues of a matrix, A, are values of Œªthat permit a nontrivial solution (other than 0) for xin the equation Ax¬àŒªx (6.26) In order to solve for the values of Œªthat do indeed permit a solution for x, we rearrange Eq. (6.26) as follows: Œªx Ax¬à0 (6.27) or ŒªI A¬Üx¬à0 (6.28) Solving for xyields x¬à ŒªI A¬Ü  10 (6.29) or x¬àadj ŒªI A¬Ü det ŒªI A¬Ü0 (6.30) We see that all solutions will be the null vector except for the occurrence of zero in the denominator. Since this is the only condition where elements of xwill be 0 =0, or indeterminate, it is the only case where a nonzero solution is possible. The values of Œªare calculated by forcing the denominator to zero: det ŒªI A¬Ü¬à0 (6.31)Skill-Assessment Exercise 6.3 PROBLEM: For a unity feedback system with the forward transfer function G s¬Ü¬àK s¬á20¬Ü s s¬á2¬Ü s¬á3¬Ü Ô¨Ånd the range of Kto make the system stable. ANSWER: 0<K<2 The complete solution is at www.wiley.com/college/nise .318 Chapter 6 StabilityWEBC06 10/28/2014 17:42:52 This equation determines the values of Œªfor which a nonzero solution for xin Eq. (6.26) exists. In Section 5.8, we de Ô¨Ånedxaseigenvectors and the values of Œªas the eigenvalues of the matrix A. Let us now relate the eigenvalues of the system matrix, A, to the system ‚Äôs poles. In Chapter 3 we derived the equation of the system transfer function, Eq. (3.73), from the state equations. The system transfer function has det sI A¬Üin the denominator because of the presence of sI A¬Ü 1. Thus, det sI A¬Ü¬à0 (6.32) is the characteristic equation for the system from which the system poles can be found. Since Eqs. (6.31) and (6.32) are identical apart from a change in variable name, we conclude that the eigenvalues of the matrix Aare identical to the system ‚Äôs poles before cancellation of common poles and zeroes in the transfer function. Thus, we can determinethe stability of a system represented in state space by Ô¨Ånding the eigenvalues of the system matrix, A, and determining their locations on the s-plane. Example 6.11 Stability in State SpaceStability in State Space PROBLEM: Given the system _x¬à031 281  10  5  22 643 75x¬á10 0 02 643 75u (6.33a) y¬à¬â100 ¬äx (6.33b) Ô¨Ånd out how many poles are in the left half-plane, in the right half-plane, and on the jœâ-axis. SOLUTION: First form sI A¬Ü: sI A¬Ü¬às00 0s0 00 s2 643 75 031 281  10  5 22 643 75¬às 3  1  2 s 8 1 10 5 s¬á22 643 75 (6.34) Now Ô¨Åndthe det sI A¬Ü: det sI A¬Ü¬às3 6s2 7s 52 (6.35) Using this polynomial, form the Routh table of Table 6.18. TABLE 6.18 Routh table for Example 6.11 s31  7 s2 6 3  52  26 s1 47 3 1 00 s0 266.5 Stability in State Space 319WEBC06 10/28/2014 17:42:52 In this section, we have evaluated the st ability of feedback control systems from the state-space perspective. Since the closed-loop poles and the eigenvalues of a system are the same, the stability requirement of a s ystem represented in state space dictates that the eigenvalues cannot be in the right half of the s-plane or be multiple on the jœâ-axis. We can obtain the eigenvalues from the state equations without Ô¨År s tc o n v e r t i n gt oa transfer function to Ô¨Ånd the poles: The equation det sI A¬Ü¬à0 yields the eigenvalues directly. If det sI A¬Ü, a polynomial in s, cannot be factored easily, we can apply the Routh-Hurwitz criterion to it to evaluate how many eigenvalues are in each region of thes-plane. We now summarize this chapter, Ô¨Årst with case studies and then with a written summary. Our case studies include the antenna azimuth position control systemand the UFSS. Stability is as important to these systems as it is to the system shown in Figure 6.11.Since there is one sign change in the Ô¨Årst column, the system has one right-half- plane pole and two left-half-plane poles. It is therefore unstable. Yet, you may question thepossibility that if a nonminimum-phase zero cancels the unstable pole, the system will be stable. However, in practice, the nonminimum-phase zero or unstable pole will shift due to a slight change in the system ‚Äôs parameters. This change will cause the system to become unstable. Students who are using MATLAB should now run ch6p3 in Appendix B.You will learn how to determine the stability of a system repre-sented in state space by Ô¨Ånding the eigenvalues of the system matrix. This exercise uses MATLAB to do Example 6.11. Skill-Assessment Exercise 6.4 PROBLEM: For the following system represented in state space, Ô¨Ånd out how many poles are in the left half-plane, in the right half-plane, and on the jœâ-axis. _x¬à21 1 17 1  34  52 6643 775x¬á0 012 6643 775r y¬à010/C2/C3 x ANSWER: Two rhp and one lhp. The complete solution is at www.wiley.com/college/nise .TryIt 6.3 Use the following MATLAB statements to Ô¨Ånd the eigenvalues of the systemdescribed in Skill-AssessmentExercise 6.4. A=[2 1 1 171  34  5] ; Eig=eig(A)320 Chapter 6 StabilityWEBC06 10/28/2014 17:42:54 FIGURE 6.11 A FANUC M-410 iBTMhas 4 axes of motion. It is seen here performing bag palletizing Case Studies Antenna Control: Stability Design via GainAntenna Control: Stability Design via Gain This chapter has covered the elements of stability. We saw that stable systems have their closed-loop poles in the left half of the s-plane. As the loop gain is changed, the locations of the poles are also changed, creating the possibility that the poles can move into the righthalf of the s-plane, which yields instability. Proper gain settings are essential for the stability of closed-loop systems. The following case study demonstrates the proper settingof the loop gain to ensure stability. PROBLEM: You are given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 1. Find the range of preampli Ô¨Åer gain required to keep the closed-loop system stable. SOLUTION: The closed-loop transfer function was derived in the case studies in Chapter 5 as Ts ¬Ü¬à 6:63K s3¬á101:71s2¬á171s¬á6:63K(6.36) Using the denominator, create the Routh table shown as Table 6.19. The third row of the table shows that a row of zeros occurs if K¬à2623. This value of Kmakes the system marginally stable. Therefore, there will be no sign changes in the Ô¨Årst column if 0 <K<2623. We conclude that, for stability, 0 <K<2623. An animation PowerPoint presentation (PPT) demonstratin g this system is available for instructors atwww.wiley.com/college/nise .S e e Antenna (Ch. 6 ). TABLE 6.19 Routh table for antenna control case study s31 171 s2101.71 6.63K s117392.41‚Äì6.63 K 0 s06.63KCase Studies 321WEBC06 10/28/2014 17:42:56 CHALLENGE: We now give you a problem to test your knowledge of this chapter ‚Äôs objectives. Refer to the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 2. Find the range of preampli Ô¨Åer gain required to keep the closed-loop system stable. UFSS Vehicle: Stability Design via GainUFSS Vehicle: Stability Design via Gain For this case study, we return to the UFSS vehicle and study the stability of the pitch control system, which is used to control depth. Speci Ô¨Åcally, we Ô¨Ånd the range of pitch gain that keeps the pitch control loop stable. PROBLEM: The pitch control loop for the UFSS vehicle ( Johnson ,1980 ) is shown on the back endpapers. Let K2¬à1 and Ô¨Ånd the range of K1that ensures that the closed-loop pitch control system is stable. SOLUTION: TheÔ¨Årst step is to reduce the pitch control system to a single, closed-loop transfer function. The equivalent forward transfer function, Ge s¬Ü,i s Ge s¬Ü¬à0:25K1 s¬á0:435¬Ü s4¬á3:456s3¬á3:457s2¬á0:719s¬á0:0416(6.37) With unity feedback the closed-loop transfer function, T s¬Ü,i s T s¬Ü¬à0:25K1 s¬á0:435¬Ü s4¬á3:456s3¬á3:457s2¬á 0:719¬á0:25K1¬Üs¬á 0:0416 ¬á0:109K1¬Ü(6.38) The denominator of Eq. (6.38) is now used to form the Routh table shown as Table 6.20. Looking at the Ô¨Årst column, the s4ands3rows are positive. Thus, all elements of the Ô¨Årst column must be positive for stability. For the Ô¨Årst column of the s2row to be positive,  ‚àû<K1<44:91. For the Ô¨Årst column of the s1row to be positive, the numerator must be positive, since the denominator is positive from the previous step. The solution to the quadratic term in the numerator yields roots of K1¬à 4:685 and 25.87. Thus, for a positive numerator,  4:685<K1<25:87. Finally, for the Ô¨Årst column of the s0row to be positive,  0:382<K1<‚àû. Using all three conditions, stability will be ensured if  0:382<K1<25:87. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. For the UFSS vehicle ( Johnson, 1980) heading control system shown on the back endpapers and introduced in the UFSS Case Study Challenge in Chapter 5, do thefollowing: a.Find the range of heading gain that ensures the vehicle ‚Äôs stability. Let K 2¬à1 b.Repeat Part ausing MATLAB.TABLE 6.20 Routh table for UFSS case study s41 3.457 0:0416 ¬á0:109K1 s33.456 0:719¬á0:25K1 s211:228 0:25K1 0:144¬á0:377K1 s1  0:0625 K2 1¬á1:324K1¬á7:575 11:228 0:25K1 s00:144¬á0:377K1 Note: Some rows have been multiplied by a positive constant for convenience.322 Chapter 6 StabilityWEBC06 10/28/2014 17:42:56 Summary In this chapter, we explored the concepts of system stability from both the classical and the state-space viewpoints. We found that for linear systems, stability is based on a natural response that decays to zero as time approaches in Ô¨Ånity. On the other hand, if the natural response increases without bound, the forced response is overpowered by the natural response,and we lose control. This condition is known as instability . A third possibility exists: The natural response may neither decay nor grow without bound but oscillate. In this case, thesystem is said to be marginally stable . We also used an alternative de Ô¨Ånition of stability when the natural response is not explicitly available. This de Ô¨Ånition is based on the total response and says that a system is stable if every bounded input yields a bounded output (BIBO) and unstable if any bounded input yields an unbounded output. Mathematically, stability for linear, time-invariant systems can be determined from the location of the closed-loop poles: If the poles are only in the left half-plane, the system is stable. If any poles are in the right half-plane, the system is unstable. If the poles are on the jœâ-axis and in the left half-plane, the system is marginally stable as long as the poles on the jœâ-axis are of unit multiplicity; it is unstable if there are any multiple jœâpoles. Unfortunately, although the open-loop poles may be known, we found that in higher-ordersystems it is dif Ô¨Åcult to Ô¨Ånd the closed-loop poles without a computer program. The Routh-Hurwitz criterion lets us Ô¨Ånd how many poles are in each section of the s-plane without giving us the coordinates of the poles. Just knowing that there are poles in the right half-plane is enough to determine that a system is unstable. Under certain limited conditions, when an even polynomial is present, the Routh table can be used to factor thesystem ‚Äôs characteristic equation. Obtaining stability from the state-space representation of a system is based on the same concept ‚Äîthe location of the roots of the characteristic equation. These roots are equivalent to the eigenvalues of the system matrix and can be found by solvingdet sI A¬Ü¬à0. Again, the Routh-Hurwitz criterion can be applied to this polynomial. The point is that the state-space representation of a system need not be converted to atransfer function in order to investigate stability. In the next chapter, we will look at steady-state errors, the last of three important control system requirements we emphasize. Review Questions 1.What part of the output response is responsible for determining the stability of a linear system? 2.What happens to the response named in Question 1 that creates instability? 3.What would happen to a physical system that becomes unstable?In our case studies, we calculated the ranges of gain to ensure stability. The studentshould be aware that although these ranges yield stability, setting gain within theselimits may not yield the desired transient response or steady-state error characteristics.In Chapters 9 and 11, we will explore design techniques, other than simple gainadjustment, that yield more Ô¨Çexibility in obtaining desired characteristics.Review Questions 323WEBC06 10/28/2014 17:42:57 4.Why are marginally stable systems considered unstable under the BIBO de Ô¨Ånition of stability? 5.Where do system poles have to be to ensure that a system is not unstable? 6.What does the Routh-Hurwitz criterion tell us? 7.Under what conditions would the Routh-Hurwitz criterion easily tell us the actual location of the system ‚Äôs closed-loop poles? 8.What causes a zero to show up only in the Ô¨Årst column of the Routh table? 9.What causes an entire row of zeros to show up in the Routh table? 10.Why do we sometimes multiply a row of a Routh table by a positive constant? 11.Why do we not multiply a row of a Routh table by a negative constant? 12.If a Routh table has two sign changes above the even polynomial and Ô¨Åve sign changes below the even polynomial, how many right-half-plane poles does the system have? 13.D o e st h ep r e s e n c eo fa ne n t i r er o wo f zeros always mean that the system has jœâpoles? 14.If a seventh-order system has a row of zeros at the s3row and two sign changes below thes4row, how many jœâp o l e sd o e st h es y s t e mh a v e ? 15.Is it true that the eigenvalu es of the system matrix are the same as the closed-loop poles? 16.How do we Ô¨Ånd the eigenvalues? Problems 1.Tell how many roots of the following polynomial are in the right half-plane, in the left half-plane, and on thejœâ-axis: [Section: 6.2] P s¬Ü¬às 5¬á3s4¬á5s3¬á4s2¬ás¬á3 2.Tell how many roots of the following polynomial are in the right half-plane, in the left half-plane, and on thejœâ-axis: [Section: 6.3] P s¬Ü¬às 5¬á6s3¬á5s2¬á8s¬á20 3.Using the Routh table, tell how many poles of the following function are in the right half-plane, in the left half-plane, and on the jœâ-axis. [Section: 6.3] T s¬Ü¬às¬á8 s5 s4¬á3s3 3s2¬á3s 2 4.The closed-loop transfer function of a system is [Section: 6.3] T s¬Ü¬às3¬á2s2¬á7s¬á21 s5 2s4¬á3s3 6s2¬á2s 4Determine how many closed-loop poles lie in the right half-plane, in the left half-plane, and on the jœâ-axis. 5.How many poles are in the right half-plane, in the left half-plane, and on the jœâ-axis for the open-loop system of Figure P6.1? [Section: 6.3] C(s) s4 + 4s3 + 8s2 + 20s +15s2 + 4s ‚Äì 3 R(s) FIGURE P6.1 6.How many poles are in the right half-plane, the left half-plane, and on the jœâ-axis for the open-loop system of Figure P6.2? [Section: 6.3] C(s) s6 + s5 ‚Äì 6s4 + s2 + s ‚Äì 6‚Äì6 R(s) FIGURE P6.2 7.Use MATLAB to Ô¨Ånd the pole locations for the system of Problem 6. 8.Use MATLAB and the Symbolic Math Toolbox to generate a Routh table to solve Problem 3.324 Chapter 6 StabilityWEBC06 10/28/2014 17:43:0 9.Determine whether the unity feedback system of Figure P6.3 is stable if [Section: 6.2] G s¬Ü¬à240 s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü R(s) + E(s)G(s)C(s) ‚Äì FIGURE P6.3 10.Use MATLAB to Ô¨Ånd the pole locations for the system of Problem 9. 11.Consider the unity feedback system of Figure P6.3 with G s¬Ü¬à1 4s2 s2¬á2¬Ü a.Using the Routh-Hurwitz criterion, Ô¨Ånd the region of the s-plane where the poles of the closed-loop system are located. b.Use MATLAB to verify your answer and Ô¨Ånd the poles of T(s) . Indicate whether this system is stable, unstable, or marginally stable. [Section: 6.3] 12.In the system of Figure P6.3, let G s¬Ü¬àK s¬á1¬Ü s s 2¬Ü s¬á3¬Ü Find the range of Kfor closed-loop stab ility. [Section: 6.4] 13.Given the unity feedback system of Figure P6.3 with G s¬Ü¬à84 s s7¬á5s6¬á12s5¬á25s4¬á45s3¬á50s2¬á82s¬á60¬Ü tell how many poles of the closed-loop transfer function lie in the right half-plane, in the left half-plane, and onthejœâ-axis. [Section: 6.3] 14.Using the Routh-Hurwitz criterion and the unity feedback system of Figure P6.3 with G s¬Ü¬à1 2s4¬á5s3¬ás2¬á2s tell whether or not the closed-loop system isstable. [Section: 6.2] 15.Given the unity feedback system of Figure P6.3 with G s¬Ü¬à8 s s6 2s5 s4¬á2s3¬á4s2 8s 4¬Ü tell how many closed-loop poles are located in the righthalf-plane, in the left half-plane, and on the jœâ-axis. [Section: 6.3]16. Repeat Problem 15 using MATLAB. 17.Consider the following Routh table. Notice that the s5 row was originally all zeros. Tell how many roots ofthe original polynomial were in the right half-plane, inthe left half-plane, and on the jœâ-axis. [Section: 6.3] 18.For the system of Figure P6.4, tell how many closed- loop poles are located in the right half-plane, in the left half-plane, and on the jœâ-axis. Notice that there is positive feedback. [Section: 6.3] +18 R(s) + E(s) C(s) s5 + s4 ‚Äì 7s3 ‚Äì 7s2 ‚Äì 18s FIGURE P6.4 19.Using the Routh-Hurwitz criterion, tell how many closed-loop poles of the system shown in Figure P6.5 lie in the left half-plane, in the right half-plane,a n do nt h e jœâ-axis. [Section: 6.3] 450 s4+3s3+10s2+30s+150 1 sR(s) + C(s) ‚Äì FIGURE P6.5 20.Determine if the unity feedback system of Figure P6.3 with G s¬Ü¬àK s2¬á1¬Ü s¬á1¬Ü s¬á2¬Ü can be unstable. [Section: 6.4] 21.For the unity feedback system of Figure P6.3 with G s¬Ü¬àK s¬á6¬Ü s s¬á1¬Ü s¬á4¬Ü determine the range of Kto ensure stability. [Section: 6.4]s712  1  2 s612  1  2 s534  10 s41  1  30 s378 0 0 s2 15  21 0 0 s1 90 0 0 s0 21 0 0 0Problems 325WEBC06 10/28/2014 17:43:1 22.In the system of Figure P6.3, let G s¬Ü¬àK s a¬Ü s s b¬Ü Find the range of Kfor closed-loop stability when: [Section: 6.4] a.a<0;b<0 b.a<0;b>0 c.a>0;b<0 d.a>0;b>0 23.For the unity feedback system of Figure P6.3 with G s¬Ü¬àK s¬á3¬Ü s¬á5¬Ü s 2¬Ü s 4¬Ü determine the range of Kfor stability. [Section: 6.4] 24.Repeat Problem 23 using MATLAB. 25.Use MATLAB and the Symbolic Math Toolbox to generate a Routh table in terms of Kto solve Problem 23. 26.Find the range of Kfor stability for the unity feedback system of Figure P6.3 with [Section: 6.4] G s¬Ü¬àK s¬á4¬Ü s 4¬Ü s2¬á3¬Ü 27.For the unity feedback system of Figure P6.3 with G s¬Ü¬àK s¬á1¬Ü s4 s¬á4¬Ü Ô¨Ånd the range of Kfor stability. [Section: 6.4] 28.Find the range of gain, K, to ensure stability in the unity feedback system of Figure P6.3 with [Section: 6.4] G s¬Ü¬àK s 2¬Ü s¬á4¬Ü s¬á5¬Ü s2¬á12¬Ü 29.Find the range of gain, K, to ensure stability in the unity feedback system of Figure P6.3 with [Section: 6.4] G s¬Ü¬àK s¬á2¬Ü s2¬á1¬Ü s¬á4¬Ü s 1¬Ü 30.Using the Routh-Hurwitz criterion, Ô¨Ånd the value of K that will yield oscillations for the unity feedback systemof Figure P6.3 with [Section: 6.4] G s¬Ü¬àK s¬á77¬Ü s¬á27¬Ü s¬á38¬Ü 31.Use the Routh-Hurwitz criterion to Ô¨Ånd the range of Kfor which the system of Figure P6.6 is stable. [Section: 6.4]‚ÄìK(s2 ‚Äì 2s + 2) 1 s2 + 2s + 4R(s) + E(s) C(s) FIGURE P6.6 32.Repeat Problem 31 for the system of Figure P6.7. [Section: 6.4] ‚ÄìR(s) + E(s) C(s) K(s+1 ) s(s + 2)(s + 3) s+5 s+7 FIGURE P6.7 33.Given the unity feedback system of Figure P6.3 with G s¬Ü¬àK s¬á4¬Ü s s¬á1:2¬Ü s¬á2¬Ü Ô¨Ånd the following: [Section: 6.4] a.The range of Kthat keeps the system stable b.The value of Kthat makes the system oscillate c.The frequency of oscillation when Kis set to the value that makes the system oscillate 34.Repeat Problem 33 for [Section: 6.4] G s¬Ü¬àK s 1¬Ü s 2¬Ü s¬á2¬Ü s2¬á2s¬á2¬Ü 35.For the system shown in Figure P6.8, Ô¨Ånd the value of gain, K, that will make the system oscillate. Also, Ô¨Ånd the frequency of oscillation. [Section: 6.4] KR(s) + ‚Äì1 s(s+4)(s+6)+ C(s) ‚Äì s FIGURE P6.8 36.Given the unity feedback system of Figure P6.3 with [Section: 6.4] G s¬Ü¬àKs s¬á2¬Ü s2 4s¬á8¬Ü s¬á3¬Ü a.Find the range of Kfor stability. b.Find the frequency of oscillation when the system is marginally stable.326 Chapter 6 StabilityWEBC06 10/28/2014 17:43:2 37.Repeat Problem 36 using MATLAB. 38.For the unity feedback system of Figure P6.3 with G s¬Ü¬àK s¬á2¬Ü s2¬á1¬Ü s¬á4¬Ü s 1¬Ü Ô¨Ånd the range of Kfor which there will be only two closed-loop, right-half-plane poles. [Section: 6.4] 39.For the unity feedback system of Figure P6.3 with [Section: 6.4] G s¬Ü¬àK s¬á1¬Ü3 s¬á4¬Ü a.Find the range of Kfor stability. b.Find the frequency of oscillation when the system is marginally stable. 40.Given the unity feedback system of Figure P6.3 with [Section: 6.4] G s¬Ü¬àK s¬á49¬Ü s2¬á4s¬á5¬Ü a.Find the range of Kfor stability. b.Find the frequency of oscillation when the system is marginally stable. 41.Using the Routh-Hurwitz criterion and the unity feedback system of Figure P6.3 with [Section: 6.4] G s¬Ü¬àK s s¬á1¬Ü s¬á2¬Ü s¬á6¬Ü a.Find the range of Kfor stability. b.Find the value of Kfor marginal stability. c.Find the actual location of the closed-loop poles when the system is marginally stable. 42.Find the range of Kto keep the system shown in Figure P6.9 stable. [Section: 6.4] ‚ÄìsK s ‚Äì 1 s2 + 2s + 1R(s) + E(s) C(s) FIGURE P6.9 43.Find the value of Kin the system of Figure P6.10 that will place the closed-loop poles as shown. [Section: 6.4]K + ++ jœâR(s) s2 s2C(s) ‚Äì 1 s + 3s1 œÉ FIGURE P6.10 Closed-loop system with pole plot 44.The closed-loop transfer function of a system is T s¬Ü¬às2¬áK1s¬áK2 s4¬áK1s3¬áK2s2¬á5s¬á1 Determine the range of K1in order for the system to be stable. What is the relationship between K1andK2for stability? [Section: 6.4] 45.For the transfer function below, Ô¨Ånd the constraints on K1andK2such that the function will have only two jœâpoles. [Section: 6.4] T s¬Ü¬àK1s¬áK2 s4¬áK1s3¬ás2¬áK2s¬á1 46.The transfer function relating the output engine fan speed (rpm) to the input main burner fuel Ô¨Çow rate (lb/h) in a short takeoff and landing (STOL) Ô¨Åghter aircraft, ignoring the coupling between engine fanspeed and the pitch control command, is ( Schierman , 1992) [Section: 6.4] G s¬Ü¬à1:3s7¬á90:5s6¬á1970 s5¬á15;000s4¬á3120 s3 41;300s2 5000 s 1840 s8¬á103s7¬á1180 s6¬á4040 s5¬á2150 s4 8960 s3 10;600s2 1550 s 415 a.Find how many poles are in the right half-plane, inthe left half-plane, and on the jœâ-axis. b.Is this open-loop system stable? 47.An interval polynomial is of the form P s¬Ü¬àa 0¬áa1s¬áa2s2¬áa3s3¬áa4s4¬áa5s5¬á‚àô‚àô‚àô with its coef Ô¨Åcients belonging to intervals xiaiyi, where xi,yiare prescribed constants. Kharitonov ‚Äôs theorem says that an interval polynomial has all itsroots in the left half-plane if each one of the followingProblems 327WEBC06 10/28/2014 17:43:3 four polynomials has its roots in the left half-plane (Minichelli, 1989 ): K1 s¬Ü¬àx0¬áx1s¬áy2s2¬áy3s3¬áx4s4¬áx5s5¬áy6s6¬á‚àô‚àô‚àô K2 s¬Ü¬àx0¬áy1s¬áy2s2¬áx3s3¬áx4s4¬áy5s5¬áy6s6¬á‚àô‚àô‚àô K3 s¬Ü¬ày0¬áx1s¬áx2s2¬áy3s3¬áy4s4¬áx5s5¬áx6s6¬á‚àô‚àô‚àô K4 s¬Ü¬ày0¬áy1s¬áx2s2¬áx3s3¬áy4s4¬áy5s5¬áx6s6¬á‚àô‚àô‚àô Use Kharitonov ‚Äôs theorem and the Routh-Hurwitz criterion to Ô¨Ånd if the following polynomial has any zeros in the right half-plane. P s¬Ü¬àa0¬áa1s¬áa2s2¬áa3s3 2a04;1a12;4a26;a3¬à1 48.A linearized model of a torque-controlled crane hoisting a load with a Ô¨Åxed rope length is P s¬Ü¬àXT s¬Ü FT s¬Ü¬à1 mTs2¬áœâ2 0 s2 s2¬áaœâ2 0¬Ü where œâ0¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨Ég L;p L=the rope length, mT=the mass of the car, a=the combined rope and car mass, fT=the force input applied to the car, and xT=the resulting rope displacement ( Marttinen, 1990 ). If the system is controlled in a feedback con Ô¨Åguration by placing it in a loop as shown in Figure P6.11, with K>0;where will the closed-loop poles be located? K P(s)+ ‚ÄìC(s) R(s) FIGURE P6.11 49.The read/write head assembly arm of a computer hard disk drive (HDD) can be modeled as a rigid rotating body with inertia Ib:Its dynamics can be described with the transfer function P s¬Ü¬àX s¬Ü F s¬Ü¬à1 Ibs2 where X(s) is the displacement of the read/write head andF(s) is the applied force ( Yan,2003 ). Show that if the HDD is controlled in the con Ô¨Åguration shown in Figure P6.11, the arm will oscillate and cannot be positioned with any precision over a HDD track. Find the oscillation frequency. 50.A system is represented in state space as _x¬à013 22  4 1 432 643 75x¬á0 1 02 643 75u y¬à110/C2/C3 xDetermine how many eigenvalues are in the right half-plane, in the left half-plane, and on the jœâ-axis. [Section: 6.5] 51.Use MATLAB to Ô¨Ånd the eigenvalues of the following system: _x¬à01 0 01  4  11 82 643 75x¬á0 002 643 75u y¬à001/C2/C3 x The following system in state space represents the forward path of a unity feedback system. Use the Routh-Hurwitz criterion to determine if the closed-loop system is stable. [Section: 6.5] _x¬à010 012  5  4  32 643 75x¬á0 102 643 75u y¬à101/C2/C3 x Repeat Problem 52 using MATLAB. 54.A Butterworth polynomial is of the form Bn s¬Ü¬à1¬á  1¬Üns œâc/C18/C192n ;n>0 Use the Routh-Hurwitz criteria to Ô¨Ånd the zeros of a Butterworth polynomial for: a.n¬à1; b.n¬à2 55.An inverted pendulum, mounted on a motor-driven cart was presented in Chapter 3, Problem 30. The system ‚Äôs state-space model was linearized around a stationary point, x0=0, corresponding to the pendulum point- mass, m, being in the upright position at t=0, when the force applied to the cart u0=0(Prasad, 2012 ). We‚Äôll modify that model here to have two output variables: thependulumanglerelativetothe y-axis, Œ∏,andthehorizontal position of the cart, x. The output equation becomes: y¬àŒ∏ x/C20/C21 ¬àCx¬à10000010/C20/C21Œ∏ _Œ∏x _x2 66643 7775 Using MATLAB, Ô¨Ånd out how many eigenvalues are in the right half-plane, in the left half-plane, andon the jœâ-axis. What does that tell us about the stability of that unit? [Sec-tion: 6.5]328 Chapter 6 StabilityWEBC06 10/28/2014 17:43:3 DESIGN PROBLEMSDESIGN PROBLEMS 56.A model for an airplane ‚Äôs pitch loop is shown in Figure P6.12. Find the range of gain, K, that will keep the system stable. Can the system ever be unstable for positive values of K? + Gyro1s + 10 K(s + 1) (s + 4.85)Commanded pitch angleController Aircraft dynamics Pitch angle ‚Äìs2 + 0.6s + 9 FIGURE P6.12 Aircraft pitch loop model 57.A common application of control systems is in regulating the temperature of a chemical process (Figure P6.13). TheÔ¨Çow of a chemical reactant to a process is controlled by anactuator and valve. The reactant causes the temperature inthe vat to change. This temperature is sensed and com- pared to a desired set-point temperature in a closed loop, where the Ô¨Çow of reactant is adjusted to yield the desired temperature. In Chapter 9, we will learn how a PIDcontroller is used to improve the performance of suchprocess control systems. Figure P6.13 shows the controlsystem prior to the addition of the PID controller. The PIDcontroller is replaced by the shaded box with a gain ofunity. For this system, prior to the design of the PID controller, Ô¨Ånd the range of ampli Ô¨Åer gain, K, to keep the system stable. Desired temperature set point + ‚ÄìFuture PID controller AmplifierActuator and valveChemical heat processActual temperatureK1 0.7 0.1 Temperature sensors + 0.5 s2 + 1.7s + 0.3 s + 0.11 FIGURE P6.13 Block diagram of a chemical process control system 58.A transfer function from indoor radiator power, _Q s¬Ü;to room temperature, T(s), in an 11 m2room is P s¬Ü¬àT s¬Ü _Q s¬Ü¬à110 6s2¬á1:31410 9s¬á2:6610 13 s3¬á0:00163 s2¬á5:27210 7s¬á3:53810 11 where _Qis in watts and Tis in ¬∞C(Thomas ,2005 ). The room‚Äôs temperature will be controlled by embedding it in a closed loop, such as that of Figure P6.11. Find the range of Kfor closed-loop stability. 59.During vertical spindle surface grinding, adjustments are made on a multi-axis computer numerical control (CNC)machine by measuring the applied force with a dyna- mometer and applying appropriate corrections. This feedback force control results in higher homogeneityand better tolerances in the resulting Ô¨Ånished product. In a speci Ô¨Åc experiment with an extremely high feed rate, the transfer function from the desired depth of cut(DOC) to applied force was F s¬Ü DOC s¬Ü¬àKC 1¬áKC ms2¬ábs¬ák KC Kf1 Ts¬á1/C18/C19 where k¬à2:1104N=m;b¬à0:78 Ns =m;m¬à1:2 10 4kg;KC¬à1:5104N=mm;andT¬à0:004s :The parameter Kfis varied to adjust the system. Find the range of Kfunder which the system is stable (Hekman ,1999 ). 60.In order to obtain a low-cost lithium-ion battery charger, the feedback loop of Figure P6.3 is used, whereG s¬Ü¬àG c s¬ÜP s¬Ü. The following transfer functions have been derived for G(s)(Tsang ,2009 ): P s¬Ü¬àR1R2C1C2s2¬áR1C1¬áR2C1¬áR2C2 ¬Ü s¬á1 C11¬áR2C2 ¬Ü s Gc s¬Ü¬àKp¬áKI s IfR1¬à0:15Œ©;R2¬à0:44Œ©;C1¬à7200F; andC2¬à170F, u s et h eR o u t h - H u r w i t zc r i t e r i at oÔ¨Å nd the range of positive KPandKIfor which the system is closed-loop stable. 61.Figure P6.14 is a simpli Ô¨Åed and linearized block diagram of a cascade control system, which is used to controlwater level in a steam generator of a nuclear power plant(Wang ,2009 ). In this system, the level controller, G LC(s), is the master controller and the feed-water Ô¨Çow controller, GFC(s), is the slave controller. Using mass balance equations, the water level would ordinarily be regardedas a simple integration process of water Ô¨Çow. In a steam generator, however, steam Ô¨Çow rate and the cooling effect of feed-water change the dynamics of that process.Taking the latter into account and ignoring the much-lesspronounced impact of changes in steam Ô¨Çow rate, a Ô¨Årst- order lag plus time delay is introduced into the transferfunction, G fw(s), relating the controlled level, C(s), to feed-water Ô¨Çow rate, Qw(s) as follows: Gfw s¬Ü¬àC s¬Ü Qw s¬Ü¬àK1e œÑ1s s T1s¬á1¬Ü¬à2e 2s s 25s¬á1¬Ü 2 s 25s¬á1¬Ü 2s2¬á2s¬á1¬Ü where K1¬à2 is the process gain, œÑ1¬à2 is the pure time delay, and T1¬à25 is the steam generator ‚Äôs timeProblems 329WEBC06 10/28/2014 17:43:4 constant. (The expression e œÑ1srepresents a time delay. This function can be represented by what is known as a Pade approximation . This approximation can take on many increasingly complicated forms, depending uponthe degree of accuracy required. Here we use the Pade approximation, e  x1 1¬áx¬áx2 2!;and speci Ô¨Åc numeri- cal values for the considered steam generator.) The dynamic characteristics of the control valve are approximated by the transfer function Gv s¬Ü¬àQw s¬Ü Y s¬Ü¬àKv Tvs¬á1¬à1 3s¬á1 where Kvis the valve gain and Tvis its time constant. Given that: GFC s¬Ü¬àKPFC¬áKDFCs¬à0:5¬á2s and GLC s¬Ü¬àKPLC¬áKDLCs¬à0:5¬áKs, use the Routh-Hurwitz criterion to Ô¨Ånd the range of the level controller ‚Äôs derivative gain, KDLC¬àK>0, that will keep the system stable. 62.Look-ahead information can be used to automatically steer a bicycle in a closed-loop con Ô¨Åguration. A line is drawn in the middle of the lane to be followed, and an arbitrary point is chosen in the vehicle ‚Äôs longitudinal axis. A look-ahead offset is calculated by measuring the distance between the look-ahead point and the reference line and is used by the system to correct thevehicle ‚Äôs trajectory. A linearized model of a particular bicycle traveling on a straight-line path at a Ô¨Åxed longitudinal speed is _V _r _œà _Y g2 66643 7775¬à 11:76 :86 1 :6K 7:7K  3:5  24  66:9K 8:4K 01 0 0 10  10 02 66643 7775V rœàY g2 66643 7775 In this model, V=bicycle ‚Äôs lateral velocity, r=bicycle ‚Äôs yaw velocity, œà=bicycle ‚Äôs yaw acceleration, and Y g¬à bicycle ‚Äôs center of gravity coordinate on the y-axis. Kis a controller parameter to be chosen by the designer (√ñzg√ºner, 1995). Use the Routh-Hurwitz citerion to Ô¨Ånd the range of Kfor which the system is closed-loop stable. 63.Figure P5.42 Shows the block diagram of an Automatic Voltage Regulator ( Gozde ,2011 ). Assume in this diagramthe following parameter values: Ka=10,Ta=0.1,Ke=1, Te=0.4,Kg=1,Tg=1,Ks=1, and Ts=0.001. Also assume that the PID transfer function is substituted by a simple integrator, namely GPID s¬Ü¬àK s. Find the range ofKfor which the system is closed-loop stable. 64.It has been shown ( Pounds, 2011 ) that an unloaded UAV helicopter is closed-loop stable and will have a characteristic equation given by s3¬ámgh I q2¬ákkd¬Ü¬áq1g/C18/C19 s2 ¬ákmgh Is¬ámgh I kki¬áq1¬Ü¬à0 where mis the mass of the helicopter, gis the gravitational constant, Iis the rotational inertia of the helicopter, his the height of the rotor plane above the center of gravity,q 1andq2are stabilizer Ô¨Çapping parameters, k,ki,a n dk d are controller parameters; all constants > 0. The UAV is supposed to pick up a payload; when this occurs, the mass, height, and inertia change to m¬¥,h¬¥,a n d I¬¥,r e s p e c - tively, all still >0. Show that the helicopter will remain stable as long as m¬¥gh¬¥ I¬¥>q1¬ákki q1gk k q2¬ákkd¬Ü 65.Figure P6.15 shows the model of the dynamics of an economic system (Wingrove ,2012) .I nt h i sd i a g r a mx represents the rate of growth in real Gross NationalProduct (GNP), x 0the long-term trend (dc value) of the GNP,Œîxthe change over the long-term trend of the GNP, rxthe real and psychological disturbance inputs that affect the economy, rmthe random monetary inputs, andŒîuÔ¨Çuctuations in unemployment rate. The diagram has two feedback loops: one through Friedman ‚Äôs model in which the economy dynamics are approximated by F s¬Ü¬àKxs s œân/C18/C192 ¬á2Œæs œân/C18/C19 ¬á1 and a second loop through Okun‚Äô s law that relates the GNP to unemployment changes. Assuming the followingparameter values: K x¬à2y e ar s, œân¬à1:5ra d=year, Œ∂¬à0:8, Ku¬à0:4a n d Gx¬à 0:4. Find the range of Gufor closed- loop stability.GFC(s) GLC(s) GV(s)_+Qw(s) Gfw(s)+ _Y (s) X (s)Controlle d level C(s)Set point R(s) FIGURE P6.14330 Chapter 6 StabilityWEBC06 10/28/2014 17:43:5 66.The system shown in Figure P6.16 has G1 s¬Ü¬à 1=s s¬á2¬Ü s¬á4¬Ü. Find the following: K1+ ‚Äì+ ‚ÄìG1(s)E(s) R(s) C(s) K2 s FIGURE P6.16 a.The value of K2for which the inner loop will have two equal negative real poles and the associated range of K1for system stability. b.The value of K1at which the system oscillates and the associated frequency of oscillation. c.The gain K1at which a real closed-loop pole is at s=‚Äì5. Can the step response, c(t), be approximated by a second-order, underdamped response in thiscase? Why or why not? d.If the response in Part dcan be approximated as a second-order response, Ô¨Ånd the % OSand settling time, T s, when the input is a unit step, r(t)=u(t).67.A drive system with an elastically coupled load was presented in Problems 71 and 67 in Chapters 4 and 5,respectively ( Thomsen, 2011 ). That drive was shown in Figure P5.43 as the controlled unit in a feedback controlsystem, where Œ© L(s)=the load speed and Œ©r(s)=the desired (reference) speed. If the controller transfer function is GC s¬Ü¬àKp¬áKI s;while all of the other parameters and transfer functions are the same as in Problem 67 in Chapter 5, Ô¨Ånd the range of KPfor stability of the system if KI=0.1. PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 68.Control of HIV/AIDS. The HIV infection linearized model developed in Problem 84, Chapter 4, can be shown to have the transfer function P s¬Ü¬àY s¬Ü U1 s¬Ü¬à 520 s 10:3844 s3¬á2:6817 s2¬á0:11s¬á0:0126 G(s) P(s)+ ‚ÄìVirus count change, Y(s)Desired virus count change U1(s) FIGURE P6.17 It is desired to develop a policy for drug delivery to maintain the virus count at prescribed levels. For the purpose of obtaining an appropriate u1 t¬Ü;feedback will be used as shown in Figure P6.17 ( Craig ,2004 ). As aÔ¨Årst approach, consider G s¬Ü¬àK;a constant to be selected. Use the Routh-Hurwitz criteria to Ô¨Ånd the range of Kfor which the system is closed-loop stable. 69.Hybrid vehicle. Figure P6.18 shows the HEV system presented in Chapter 5, where parameter values have Motor angular speed _ _ 0.1 2Friction torque Tf (s)UC(s) +1.8Armature current Ia(s) Eb(s) Back emf Vehicle speed V(s) 4.8750.3Speed error Ev(s) 0.5 0.0443ss Kp 40+ ss6 10+ + _ _Torque controller & power amplifierRef. signal Rv(s) Feedbackspeed signal KSSŒ© (s)7.226 s1TL(s) + Feedbackcurrent signal KCS Ia(s)Ua(s) +Speed controller Current sensor sensitivity Speed sensor sensitivity 0.6154 Motive torque T(s) _1Armature resistance Ra(s) Œ© (s) FIGURE P6.18Friedman‚Äôs model Okun‚Äôs law F+ + +rmrx xo ++++ Gx Gux Œîu Œîx Ku s‚Äì FIGURE P6.15Problems 331WEBC06 10/28/2014 17:43:5 been substituted. It is assumed here that the speed controller has a proportional gain, Kp, to be adjusted. Use the Routh-Hurwitz stability method to Ô¨Ånd the range of positive Kpfor which the system is closed-loop stable (Graebe, 1995 ). 70.Parabolic trough collector. TheÔ¨Çuid temperature of a parabolic trough collector ( Camacho, 2012 ) will be controlled by using a unity feedback structure as shownin Figure P6.11. Assume the open-loop plant transfer function is given by P s¬Ü¬à137:210 6 s2¬á0:0224 s¬á19610 6e 39sUse the Routh-Hurwitz criteria to Ô¨Ånd the range of gain Kthat will result in a closed-loop stable system. Note: Pure time-delay dynamics, such as the one in thetransfer function of the parabolic trough collector,cannot be treated directly using the Routh-Hurwitzcriterion because it is represented by a nonrationalfactor. However, a Pad√© approximation can be used forthe nonrational component. The Pad√© approximationwas introduced in Problem 6.61, but it can appear in different forms. Here, it is suggested you use a Ô¨Årst-order approximation of the form e  sT1 T 2s 1¬áT 2s Cyber Exploration Laboratory Experiment 6.1 Objectives To verify the effect of pole location upon stability. To verify the effect upon stability of loop gain in a negative feedback system. Minimum Required Software Packages MATLAB, Simulink, and the Control System Toolbox Prelab 1.Find the equivalent transfer function of the negative feedback system of Figure P6.19 if G s¬Ü¬àK s s¬á2¬Ü2and H s¬Ü¬à1 2.For the system of Prelab 1, Ô¨Ånd two values of gain that will yield closed-loop, overdamped, second-order poles. Repeat for underdamped poles. 3.For the system of Prelab 1, Ô¨Ånd the value of gain, K, that will make the system critically damped. 4.For the system of Prelab 1, Ô¨Ånd the value of gain, K, that will make the system marginally stable. Also, Ô¨Ånd the frequency of oscillation at that value of Kthat makes the system marginally stable. 5.For each of Prelab 2 through 4, plot on one graph the pole locations for each case and write the corresponding value of gain, K, at each pole. Lab 1.Using Simulink, set up the negative feedback system of Prelab 1. Plot the step responseof the system at each value of gain calculated to yield overdamped, underdamped,critically damped, and marginally stable responses. 2.Plot the step responses for two values of gain, K, above that calculated to yield marginal stability. 3.At the output of the negative feedback system, cascade the transfer function G 1 s¬Ü¬à1 s2¬á4R(s) + C(s)G(s) H(s)‚Äì FIGURE P6.19332 Chapter 6 StabilityWEBC06 10/28/2014 17:43:5 Bibliography Ballard, R. D. The Riddle of the Lusitania. National Geographic , April 1994, National Geographic Society, Washington, D.C., 1994, pp. 68 ‚Äì85. Also, Ô¨Ågure caption source for Figure 6.9. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria, IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. D‚ÄôAzzo, J., and Houpis, C. H. Linear Control System Analysis and Design , 3d ed. McGraw-Hill, New York, 1988. Dorf, R. C. Modern Control Systems , 5th ed. Addison-Wesley, Reading, MA, 1989. FANUC Robotics North America, Inc. Figure caption source for Figure 6.11. Gozde, H., and Taplamacioglu, M. C. Comparative performance analysis of arti Ô¨Åcial bee colony algorithm for automatic voltage regulator (AVR) system. Journal of the Franklin Institute , vol. 348, pp. 1927 ‚Äì1946, 2011. Graebe, S. F., Goodwin, G. C., and Elsley, G. Control Design and Implementation in Continuous Steel Casting. IEEE Control Systems, August 1995, pp. 64 ‚Äì71. Hekman, K. A., and Liang, S. Y. Compliance Feedback Control for Part Parallelism in Grinding. International Journal of Manufacturing Technology , vol. 15, 1999, pp. 64 ‚Äì69. Hostetter, G. H., Savant, C. J., Jr., and Stefani, R. T. Design of Feedback Control Systems , 2d ed. Saunders College Publishing, New York, 1989. Johnson, H., et al. Unmanned Free-Swimming Submersible (UFSS) System Description. NRL Memorandum Report 4393. Naval Research Laboratory, Washington, D.C., 1980.Set the gain, K, at a value below that calculated for marginal stability and plot the step response. Repeat for Kcalculated to yield marginal stability. Postlab 1.From your plots, discuss the conditions that lead to unstable responses. 2.Discuss the effect of gain upon the nature of the step response of a closed-loop system. Experiment 6.2 Objective To use the LabVIEW Control Design and Simulation Module for stability analysis. Minimum Required Software Package LabVIEW with the Control Design and Simulation Module Prelab 1.Select six transfer functions of various orders and use Routh-Hurwitz to determine their stability. Lab 1.Create a LabVIEW VI that receives the order and the coef Ô¨Åcients of the characteristic equation and outputs the location of the poles and information regarding stability. Postlab 1.Verify the stability of the systems from your Prelab.Bibliography 333WEBC06 10/28/2014 17:43:5 Martinnen, A., Virkkunen, J., and Salminen, R. T. Control Study with Pilot Crane. IEEE Transactions on Education , vol. 33, no. 3, August 1990, pp. 298 ‚Äì305. Minnichelli, R. J., Anagnost, J. J., and Desoer, C. A. An Elementary Proof of Kharitonov ‚Äôs Stability Theorem with Extensions. IEEE Transactions on Automatic Control , vol. 34, 1989, pp. 995 ‚Äì998. √ñzg√ºner, ≈∞.,≈∞nyelioglu, K. A., and Haptipog ÃÇlu, C. An Analytical Study of Vehicle Steering Control. Proceedings of the 4th IEEE Conference Control Applications, 1995, pp. 125 ‚Äì130. Phillips, C. L., and Harbor, R. D. Feedback Control Systems , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1991. Pounds, P. E. I., Bersak, D. R., and Dollar, A . M. Grasping From the Air: Hovering Capture and Load Stability. 2011 IEEE International Conference on Robotics and Automation , Shanghai International Conference Center, May 9‚Äì13, Shanghai, China, 2011. Prasad, L., Tyagi, B., and Gupta, H. Modeling & Simulation for Optimal Control of Nonlinear Inverted Pendulum Dynamical System using PID Controller & LQR. IEEE Computer Society Sixth Asia Modeling Symposium , 2012, pp. 138 ‚Äì143. Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. 4th International Symposium on Applied Computational Intelligence and Informatics . IEEE. 2007, pp. 157 ‚Äì162. Routh, E. J. Dynamics of a System of Rigid Bodies , 6th ed. Macmillan, London, 1905. Schierman, J. D., and Schmidt, D. K. Analysis of Airframe and Engine Control Interactions and Integrated Flight/Propulsion Control. Journal of Guidance, Control, and Dynamics , vol. 15, no. 6, November ‚ÄìDecember 1992, pp. 1388 ‚Äì1396. Thomas, B., Soleimani-Mosheni, M., and Fahl√©n, P. Feed-Forward in Temperature Control of Buildings. Energy and Buildings , vol. 37, 2005, pp. 755 ‚Äì761. Thomsen, S., Hoffmann, N., and Fuchs, F. W. PI Control, PI-Based State Space Control, and Model- Based Predictive Control for Drive Systems With Elastically Coupled Loads ‚ÄîA Comparative Study. IEEE Transactions on Industrial Electronics , vol. 58, no. 8, August 2011, pp. 3647 ‚Äì3657. Timothy, L. K., and Bona, B. E. State Space Analysis: An Introduction . McGraw-Hill, New York, 1968. Tsang, K. M., and Chan, W. L. A Simple and Low-cost Charger for Lithium-Ion Batteries. Journal of Power Sources , vol. 191, 2009, pp. 633 ‚Äì635. Wang, X.-K., Yang, X.-H., Liu, G., and Qian, H. Adaptive Neuro-Fuzzy Inference System PID Controller for Steam Generator Water Level of Nuclear Power Plant. Procedings of the Eighth International Conference on Machine Learning and Cybernetics , 2009, pp. 567 ‚Äì572. Wingrove, R. C., and Da, R. E. Classical Linear-Control Analysis Applied to Business-Cycle Dynamics and Stability. Comput. Econ. vol. 39, Springer, 2012, pp. 77 ‚Äî98. Yan, T., and Lin, R. Experimental Modeling and Compensation of Pivot Nonlinearly in Hard Disk Drives. IEEE Transactions on Magnetics , vol. 39, 2003, pp. 1064 ‚Äì1069.334 Chapter 6 StabilityWEBC07 10/28/2014 17:50:53 Steady-State Errors Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅFind the steady-state error for a unity feedback system (Sections 7.1 ‚Äì7.2) ¬ÅSpecify a system ‚Äôs steady-state error performance (Section 7.3) ¬ÅDesign the gain of a closed-loop system to meet a steady-state error speci Ô¨Åcation (Section 7.4) ¬ÅFind the steady-state error for disturbance inputs (Section 7.5) ¬ÅFind the steady-state error for nonunity feedback systems (Section 7.6) ¬ÅFind the steady-state error sensitivity to parameter changes (Section 7.7) ¬ÅFind the steady-state error for systems represented in state space (Section 7.8) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with case studies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to Ô¨Ånd the preampli Ô¨Åer gain to meet steady-state error performance speci Ô¨Åcations. ¬ÅGiven a video laser disc recorder, you will be able to Ô¨Ånd the gain required to permit the system to record on a warped disc.7 335WEBC07 10/28/2014 17:50:55 7.1 Introduction In Chapter 1, we saw that control systems analysis and design focus on three speci Ô¨Åcations: (1) transient response, (2) stability, and (3) steady-state errors, taking into account the robustness of the design along with economic and social considerations. Elements oftransient analysis were derived in Chapter 4 for Ô¨Årst- and second-order systems. These concepts are revisited in Chapter 8, where they are extended to higher-order systems.Stability was covered in Chapter 6, where we saw that forced responses were overpoweredby natural responses that increase without bound if the system is unstable. Now we are ready to examine steady-state errors. We de Ô¨Åne the errors and derive methods of controlling them. As we progress, we Ô¨Ånd that control system design entails trade-offs between desired transient response, steady-state error, and the requirement that the system be stable. DeÔ¨Ånition and Test Inputs Steady-state error is the difference between the input and the output for a prescribed test input as t¬Æ‚àû. Test inputs used for steady-state error analysis and design are summarized in Table 7.1. In order to explain how these test signals are used, let us assume a position control system, where the output position follows the input commanded position. Step inputs represent constant position and thus are useful in determining the ability of the controlsystem to position itself with respect to a stationary target, such as a satellite in geostationaryorbit (see Figure 7.1). An antenna position control is an example of a system that can betested for accuracy using step inputs. Ramp inputs represent constant-velocity inputs to a position control system by their linearly increasing amplitude. These waveforms can be used to test a system ‚Äôs ability to follow a linearly increasing input or, equivalently, to track a constant-velocity target. For example, aposition control system that tracks a satellite that moves across the sky at a constant angularvelocity, as shown in Figure 7.1, would be tested with a ramp input to evaluate the steady-stateerror between the satellite ‚Äôs angular position and that of the control system. TABLE 7.1 Test waveforms for evaluating steady-state errors of position control systems Waveform Name Physical interpretation Time function Laplace transform r(t) tStep Constant position 1 1 s r(t) tRamp Constant velocity t 1 s2 r(t) tParabola Constant acceleration 1 2t2 1 s3336 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:50:55 Finally, parabolas, whose second derivati ves are constant, represent constant- acceleration inputs to position control systems and can be used to represent accelerating targets, such as the missile in Figure 7.1, to d etermine the steady-state error performance. Application to Stable Systems Since we are concerned with the difference between the input and the output of a feedbackcontrol system after the steady state has been reached, our discussion is limited to stablesystems, where the natural response approaches zero as t¬Æ ‚àû. Unstable systems represent loss of control in the steady state and are not acceptable for use at all. The expressions wederive to calculate the steady-state error can be applied erroneously to an unstable system.Thus, the engineer must check the system for stability while performing steady-state error analysis and design. However, in order to focus on the topic, we assume that all the systems in examples and problems in this chapter are stable. For practice, you may want to test someof the systems for stability. Evaluating Steady-State Errors Let us examine the concept of steady-state errors. In Figure 7.2( a) a step input and two possible outputs are shown. Output 1 has zero steady-state error, and Output 2 has a Ô¨Ånite steady-state error, e2‚àû ¬Ü. A similar example is shown in Figure 7.2( b), where a ramp input is compared with Output 1, which has zero steady-state error, and Output 2, which has a Ô¨Ånite steady-state error, e2‚àû ¬Ü. Errors are measured vertically between the Input and Output 2 after the transients have died down. For the ramp input another possibility exists. If theoutput ‚Äôs slope is different from that of the input, then Output 3, shown in Figure 7.2( b), results. Here the steady-state error is in Ô¨Ånite as measured vertically between the Input and Output 3 after the transients have died down, and tapproaches in Ô¨Ånity. Let us now look at the error from the perspective of the most general block diagram. Since the error is the difference between the input and the output of a system, we assume a closed-loop transfer function, T(s), and form the error, E(s), by taking the difference between the input and the output, as shown in Figure 7.3( a). Here we are interested in the steady-state, or Ô¨Ånal, value of e(t). For unity feedback systems, E(s) appears as shown in Figure 7.3(b ). In this chapter, we study and derive expressions for the steady-state error for unity feedback systems Ô¨Årst and then expand to nonunity feedback systems.Tracking systemSatellite orbiting at constant velocity Accelerating missileSatellite in geostationary orbit FIGURE 7.1 Test inputs for steady-state error analysis and design vary with target type7.1 Introduction 337WEBC07 10/28/2014 17:50:55 Before we begin our study of steady-state errors for unity feedback systems, let us look at the sources of the errors with which we deal. Sources of Steady-State Error Many steady-state errors in control syst ems arise from nonlinear sources, such as backlash in gears or a motor that will not move unless the input voltage exceeds athreshold. Nonlinear behavior as a source of st eady-state errors, although a viable topic for study is beyond the scope of a text on linear control systems. The steady-state errors we study here are errors that arise from the conÔ¨Å guration of the system itself and the type of applied input. For example, look at the system of Figure 7.4( a), where R(s) is the input, C(s)i s the output, and Es ¬Ü¬à Rs ¬Ü   Cs ¬Üis the error. Consider a step input. In the steady state, ifc(t)e q u a l sr (t),e(t) will be zero. But with a pure gain, K, the error, e(t), cannot be zero ifc(t)i st ob eÔ¨Å nite and nonzero. Thus, by virtue of the con Ô¨Åguration of the system (a pure gain of Kin the forward path), an error must exist. If we call c steady-state theOutput 1 Output 2Inputc(t)e2(‚àû) Output 1e2(‚àû) Output 3(a) (b)c(t) Time TimeOutput 2 Input FIGURE 7.2 Steady-state error: a. step input; b. ramp input R(s)T(s)C(s) E(s)+‚Äì R(s)G(s)E(s) C(s) + ‚Äì (b) (a)FIGURE 7.3 Closed-loop control system error: a.general representation; b.representation for unity feedback systems338 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:50:56 steady-state value of the output and esteady-state the steady-state value of the error, then csteady-state ¬àKesteady-state ,o r esteady-state ¬à1 Kcsteady-state (7.1) Thus, the larger the value of K, the smaller the value of esteady-state would have to be to yield a similar value of csteady-state . The conclusion we can draw is that with a pure gain in the forward path, there will always be a steady-state error for a step input. This error diminishes as the value of Kincreases. If the forward-path gain is replaced by an integrator, as shown in Figure 7.4( b), there will be zero error in the steady state for a step input. The reasoning is as follows: As c(t) increases, e(t) will decrease, since et ¬Ü¬à rt ¬Ü  ct ¬Ü. This decrease will continue until there is zero error, but there will still be a value for c(t) since an integrator can have a constant output without any input. For example, a motor can be represented simply as an integrator. Avoltage applied to the motor will cause rotation. When the applied voltage is removed, the motor will stop and remain at its present output position. Since it does not return to its initial position, we have an angular displacement output without an input to the motor. Therefore, asystem similar to Figure 7.4( b), which uses a motor in the forward path, can have zero steady-state error for a step input. We have examined two cases qualitatively to show how a system can be expected to exhibit various steady-state error characteristics, depending upon the system con Ô¨Åguration. We now formalize the concepts and derive the relationships between the steady-state errorsand the system con Ô¨Åguration generating these errors. 7.2 Steady-State Error for Unity Feedback Systems Steady-state error can be calculated from a system ‚Äôs closed-loop transfer function, T(s), or the open-loop transfer function, G(s), for unity feedback systems. We begin by deriving the system ‚Äôs steady-state error in terms of the closed-loop transfer function, T(s), in order to introduce the subject and the de Ô¨Ånitions. Next we obtain insight into the factors affecting steady-state error by using the open-loop transfer function, G(s), in unity feedback systems for our calculations. Later in the chapter we generalize this discussion to nonunity feedback systems. Steady-State Error in Terms of T(s) Consider Figure 7.3( a). To Ô¨ÅndE(s), the error between the input, R(s), and the output, C(s), we write Es ¬Ü¬à Rs ¬Ü   Cs ¬Ü (7.2) But Cs ¬Ü¬à Rs ¬ÜTs ¬Ü (7.3) Substituting Eq. (7.3) into Eq. (7.2), simplifying, and solving for E(s) yields Es ¬Ü¬à Rs ¬Ü ¬â1 Ts ¬Ü ¬ä (7.4)+ ‚ÄìR(s) E(s) C(s) K+ ‚ÄìR(s) E(s) C(s) K s (a)( b)FIGURE 7.4 System with a.Ô¨Ånite steady-state error for a step input; b.zero steady-state error for step input7.2 Steady-State Error for Unity Feedback Systems 339WEBC07 10/28/2014 17:50:57 Although Eq. (7.4) allows us to solve for e(t) at any time, t, we are interested in the Ô¨Ånal value of the error, e‚àû ¬Ü. Applying the Ô¨Ånal value theorem,1which allows us to use the Ô¨Ånal value of e(t) without taking the inverse Laplace transform of E(s), and then letting t approach in Ô¨Ånity, we obtain e‚àû ¬Ü ¬à lim t¬Æ‚àûet ¬Ü¬à lim s¬Æ0sE s ¬Ü (7.5)2 Substituting Eq. (7.4) into Eq. (7.5) yields e‚àû ¬Ü ¬à lim s¬Æ0sR s ¬Ü ¬â1 Ts ¬Ü ¬ä (7.6) Let us look at an example. Steady-State Error in Terms of G(s) Many times we have the system con Ô¨Ågured as a unity feedback system with a forward transfer function, G(s). Although we can Ô¨Ånd the closed-loop transfer function, T(s), andExample 7.1 Steady-State Error in Terms of T(s) Steady-State Error in Terms of T(s) PROBLEM: Find the steady-state error for the system of Figure 7.3( a)i fTs ¬Ü¬à 5=s2¬á7s¬á10/C0/C1 and the input is a unit step. SOLUTION: From the problem statement, Rs ¬Ü¬à 1=sand Ts ¬Ü¬à 5=s2¬á7s¬á10/C0/C1 . Substituting into Eq. (7.4) yields Es ¬Ü¬às2¬á7s¬á5 ss2¬á7s¬á10 ¬Ü(7.7) Since T(s) is stable and, subsequently, E(s) does not have right ‚Äìhalf-plane poles or jœâ poles other than at the origin, we can apply the Ô¨Ånal value theorem. Substituting Eq. (7.7) into Eq. (7.5) gives e‚àû ¬Ü ¬à 1=2. 1TheÔ¨Ånal value theorem is derived from the Laplace transform of the derivative. Thus, ‚Ñí¬â_ft ¬Ü ¬ä¬àZ‚àû 0 _ft ¬Üe stdt¬àsF s ¬Ü f0  ¬Ü As s¬Æ0; Z‚àû 0 _ft ¬Üdt¬àf‚àû ¬Ü   f0  ¬Ü ¬à lim s¬Æ0sF s ¬Ü   f0  ¬Ü or f‚àû ¬Ü ¬à lim s¬Æ0sF s ¬Ü ForÔ¨Ånite steady-state errors, the Ô¨Ånal value theorem is valid only if F(s) has poles only in the left half-plane and, at most, one pole at the origin. However, correct results that yield steady-state errors that are in Ô¨Ånite can be obtained if F(s) has more than one pole at the origin (see D‚ÄôAzzo and Houpis ,1988 ). IfF(s) has poles in the right half-plane or poles on the imaginary axis other than at the origin, the Ô¨Ånal value theorem is invalid. 2Valid only if (1) E(s) has poles only in the left half-plane and at the origin, and (2) the closed-loop transfer function, T(s), is stable. Notice that by using Eq. (7.5), numerical results can be obtained for unstable systems. These results, however, are meaningless.340 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:50:58 then proceed as in the previous subsection, we Ô¨Ånd more insight for analysis and design by expressing the steady-state error in terms of G(s) rather than T(s). Consider the feedback control system shown in Figure 7.3( b). Since the feedback, H(s), equals 1, the system has unity feedback. The implication is that E(s) is actually the error between the input, R(s), and the output, C(s). Thus, if we solve for E(s), we will have an expression for the error. We will then apply the Ô¨Ånal value theorem, Item 11 in Table 2.2, to evaluate the steady-state error. Writing E(s) from Figure 7.3( b), we obtain Es ¬Ü¬à Rs ¬Ü   Cs ¬Ü (7.8) But Cs ¬Ü¬à Es ¬ÜGs ¬Ü (7.9) Finally, substituting Eq. (7.9) into Eq. (7.8) and solving for E(s) yields Es ¬Ü¬àRs ¬Ü 1¬áGs ¬Ü(7.10) We now apply the Ô¨Ånal value theorem, Eq. (7.5). At this point in a numerical calculation, we must check to see whether the closed-loop system is stable, using, for example, the Routh-Hurwitz criterion. For now, though, assume that the closed-loop systemis stable and substitute Eq. (7.10) into Eq. (7.5), obtaining e‚àû ¬Ü ¬à lim s¬Æ0sR s ¬Ü 1¬áGs ¬Ü(7.11) Equation (7.11) allows us to calculate the steady-state error, e‚àû ¬Ü, given the input, R(s), and the system, G(s). We now substitute several inputs for R(s) and then draw conclusions about the relationships that exist between the open-loop system, G(s), and the nature of the steady-state error, e‚àû ¬Ü. The three test signals we use to establish speci Ô¨Åcations for a control system ‚Äôs steady-state error characteristics are shown in Table 7.1. Let us take each input and evaluateits effect on the steady-state error by using Eq. (7.11). Step Input. Using Eq. (7.11) with Rs ¬Ü¬à 1=s,w e Ô¨Ånd e‚àû ¬Ü ¬à estep‚àû ¬Ü ¬à lim s¬Æ0s1=s ¬Ü 1¬áGs ¬Ü¬à1 1¬álim s¬Æ0Gs ¬Ü(7.12) The term lim s¬Æ0Gs ¬Ü is the dc gain of the forward transfer function, since s, the frequency variable, is approaching zero. In order to have zero steady-state error, lim s¬Æ0Gs ¬Ü¬à‚àû (7.13) Hence, to satisfy Eq. (7.13), G(s) must take on the following form: Gs ¬Üs¬áz1 ¬Ü s¬áz2 ¬Ü ‚àô‚àô‚àô sns¬áp1 ¬Ü s¬áp2 ¬Ü ‚àô‚àô‚àô(7.14)7.2 Steady-State Error for Unity Feedback Systems 341WEBC07 10/28/2014 17:50:58 For the limit to be in Ô¨Ånite, the denominator must be equal to zero as sgoes to zero. Thus, n1; that is, at least one pole must be at the origin. Since division by sin the frequency domain is integration in the time domain (see Table 2.2, Item 10), we are also saying that at least one pure integration must be present in the forward path. The steady-stateresponse for this case of zero steady-state error is similar to that shown in Figure 7.2( a), Output 1. If there are no integrations, then n¬à0. Using Eq. (7.14), we have lim s¬Æ0Gs ¬Ü¬àz1z2‚àô‚àô‚àô p1p2‚àô‚àô‚àô(7.15) which is Ô¨Ånite and yields a Ô¨Ånite error from Eq. (7.12). Figure 7.2( a), Output 2, is an example of this case of Ô¨Ånite steady-state error. In summary, for a step input to a unity feedback system, the steady-state error will be zero if there is at least one pure integration in the forward path. If there are no integrations,then there will be a nonzero Ô¨Ånite error. This result is comparable to our qualitative discussion in Section 7.1, where we found that a pure gain yields a constant steady-stateerror for a step input, but an integrator yields zero error for the same type of input. We nowrepeat the development for a ramp input. Ramp Input. Using Eq. (7.11), with Rs ¬Ü¬à 1=s2, we obtain e‚àû ¬Ü ¬à eramp‚àû ¬Ü ¬à lim s¬Æ0s1=s2/C0/C1 1¬áGs ¬Ü¬àlim s¬Æ01 s¬ásG s ¬Ü¬à1 lim s¬Æ0sG s ¬Ü(7.16) To have zero steady-state error for a ramp input, we must have lim s¬Æ0sG s ¬Ü¬à‚àû (7.17) To satisfy Eq. (7.17), G(s) must take the same form as Eq. (7.14), except that n2. In other words, there must be at least two integrations in the forward path. An example ofzero steady-state error for a ramp input is shown in Figure 7.2( b), Output 1. If only one integration exists in the forward path, then, assuming Eq. (7.14), lim s¬Æ0sG s ¬Ü¬àz1z2‚àô‚àô‚àô p1p2‚àô‚àô‚àô(7.18) which is Ô¨Ånite rather than in Ô¨Ånite. Using Eq. (7.16), we Ô¨Ånd that this con Ô¨Åguration leads to a constant error, as shown in Figure 7.2( b), Output 2. If there are no integrations in the forward path, then lim s¬Æ0sG s ¬Ü¬à 0 (7.19) and the steady-state error would be in Ô¨Ånite and lead to diverging ramps, as shown in Figure 7.2( b), Output 3. Finally, we repeat the development for a parabolic input. Parabolic Input. Using Eq. (7.11), with Rs ¬Ü¬à 1=s3, we obtain e‚àû ¬Ü ¬à eparabola ‚àû ¬Ü ¬à lim s¬Æ0s1=s3/C0/C1 1¬áGs ¬Ü¬àlim s¬Æ01 s2¬ás2Gs ¬Ü¬à1 lim s¬Æ0s2Gs ¬Ü(7.20)342 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:50:59 In order to have zero steady-state error for a parabolic input, we must have lim s¬Æ0s2Gs ¬Ü¬à‚àû (7.21) To satisfy Eq. (7.21), G(s) must take on the same form as Eq. (7.14), except that n3. In other words, there must be at least three integrations in the forward path. If there are only two integrations in the forward path, then lim s¬Æ0s2Gs ¬Ü¬àz1z2‚àô‚àô‚àô p1p2‚àô‚àô‚àô(7.22) isÔ¨Ånite rather than in Ô¨Ånite. Using Eq. (7.20), we Ô¨Ånd that this con Ô¨Åguration leads to a constant error. If there is only one or less integrations in the forward path, then lim s¬Æ0s2Gs ¬Ü¬à 0 (7.23) and the steady-state error is in Ô¨Ånite. Two examples demonstrate these concepts. Example 7.2 Steady-State Errors for Systems with No IntegrationsSteady-State Errors for Systems with No Integrations PROBLEM: Find the steady-state errors for inputs of 5 u(t), 5tu(t), and 5 t2u(t) to the system shown in Figure 7.5. The function u(t) is the unit step. SOLUTION: First we verify that the closed-loop system is indeed stable. For this example we leave out the details. Next, for the input 5 u(t), whose Laplace transform is 5 =s, the steady-state error will be Ô¨Åve times as large as that given by Eq. (7.12), or e‚àû ¬Ü ¬à estep ‚àû¬Ü¬à5 1¬álim s¬Æ0G s¬Ü¬à5 1¬á20¬à5 21(7.24) which implies a response similar to Output 2 of Figure 7.2( a). For the input 5 tu(t), whose Laplace transform is 5/ s2, the steady-state error will be Ô¨Åve times as large as that given by Eq. (7.16), or e ‚àû¬Ü¬àeramp ‚àû¬Ü¬à5 lim s¬Æ0sG s¬Ü¬à5 0¬à‚àû (7.25) which implies a response similar to Output 3 of Figure 7.2( b). For the input 5t2u(t), whose Laplace transform is 10 =s3, the steady-state error will be 10 times as large as that given by Eq. (7.20), or e ‚àû¬Ü¬àeparabola ‚àû¬Ü¬à10 lim s¬Æ0s2G s¬Ü¬à10 0¬à‚àû (7.26)+ ‚ÄìR(s) C(s) 120(s + 2) (s + 3)(s + 4)E(s) FIGURE 7.5 Feedback control system for Example 7.27.2 Steady-State Error for Unity Feedback Systems 343WEBC07 10/28/2014 17:51:0 Example 7.3 Steady-State Errors for Systems with One IntegrationSteady-State Errors for Systems with One Integration PROBLEM: Find the steady-state errors for inputs of 5u (t), 5tu(t), and 5 t2u(t) to the system shown in Figure 7.6. The function u(t) is the unit step. SOLUTION: First verify that the closed-loop system is indeed stable. For this example we leave out the details. Next note that since there is an integration in the forward path, the steady-state errors for some of the input waveforms will be less than those found inExample 7.2. For the input 5 u(t), whose Laplace transform is 5 =s, the steady-state error will be Ô¨Åve times as large as that given by Eq. (7.12), or e ‚àû¬Ü¬àestep ‚àû¬Ü¬à5 1¬álim s¬Æ0G s¬Ü¬à5 ‚àû¬à0 (7.27) which implies a response similar to Output 1 of Figure 7.2( a). Notice that the integration in the forward path yields zero error for a step input, rather than the Ô¨Ånite error found in Example 7.2. For the input 5 tu(t), whose Laplace transform is 5 =s2, the steady-state error will be Ô¨Åve times as large as that given by Eq. (7.16), or e ‚àû¬Ü¬àeramp ‚àû¬Ü¬à5 lim s¬Æ0sG s¬Ü¬à5 100¬à1 20(7.28) which implies a response similar to Output 2 of Figure 7.2( b). Notice that the integration in the forward path yields a Ô¨Ånite error for a ramp input, rather than the in Ô¨Ånite error found in Example 7.2. For the input, 5 t2u(t), whose Laplace transform is 10 =s3, the steady-state error will be 10 times as large as that given by Eq. (7.20), or e ‚àû¬Ü¬àeparabola ‚àû¬Ü¬à10 lim s¬Æ0s2G s¬Ü¬à10 0¬à‚àû (7.29) Notice that the integration in the forward path does not yield any improvement in steady-state error over that found in Example 7.2 for a parabolic input.+ ‚ÄìR(s) C(s) 100(s + 2)(s + 6) s(s + 3)(s + 4)E(s) FIGURE 7.6 Feedback control system for Example 7.3 Skill-Assessment Exercise 7.1 PROBLEM: A unity feedback system has the following forward transfer function: Gs ¬Ü¬à10 s¬á20¬Ü s¬á30¬Ü s s¬á25¬Ü s¬á35¬Ü a.Find the steady-state error for the following inputs: 15 u(t), 15tu(t), and 15 t2u(t). b.Repeat for Gs ¬Ü¬à10 s¬á20¬Ü s¬á30¬Ü s2 s¬á25¬Ü s¬á35¬Ü s¬á50¬Ü ANSWERS: a.The closed-loop system is stable. For 15 u(t),estep ‚àû¬Ü¬à0; for 15tu(t),eramp ‚àû¬Ü¬à2:1875; for 15( t2)u(t),eparabola ‚àû¬Ü¬à‚àû: b.The closed-loop system is unstable. Calculations cannot be made. The complete solution is at www.wiley.com/college/nise .344 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:0 7.3 Static Error Constants and System Type We continue our focus on unity negative feedback systems and de Ô¨Åne parameters that we can use as steady-state error performance speci Ô¨Åcations. These de Ô¨Ånitions parallel our deÔ¨Åning damping ratio, natural frequency, settling time, percent overshoot, and so on as performance speci Ô¨Åcations for the transient response. The steady-state error performance speciÔ¨Åcations are called static error constants . Let us see how they are de Ô¨Åned, how to calculate them, and, in the next section, how to use them for design. Static Error Constants In the previous section we derived the following relationships for steady-state error. For a step input, u(t), e‚àû ¬Ü ¬à estep‚àû ¬Ü ¬à1 1¬álim s¬Æ0Gs ¬Ü(7.30) For a ramp input, tu(t), e‚àû ¬Ü ¬à eramp‚àû ¬Ü ¬à1 lim s¬Æ0sG s ¬Ü(7.31) For a parabolic input,1 2t2ut ¬Ü. e‚àû ¬Ü ¬à eparabola ‚àû ¬Ü ¬à1 lim s¬Æ0s2Gs ¬Ü(7.32) The three terms in the denominator that are taken to the limit determine the steady-state error. We call these limits static error constants . Individually, their names are position constant, K p, where Kp¬àlim s¬Æ0Gs ¬Ü (7.33) velocity constant, K v, where Kv¬àlim s¬Æ0sG s ¬Ü (7.34) acceleration constant, K a,where Ka¬àlim s¬Æ0s2Gs ¬Ü (7.35) As we have seen, these quantities, depending upon the form of G(s), can assume values of zero, Ô¨Ånite constant, or in Ô¨Ånity. Since the static error constant appears in the denominator of the steady-state error. Eqs. (7.30) through (7.32), the value of the steady-state error decreases as the static error constant increases.7.3 Static Error Constants and System Type 345WEBC07 10/28/2014 17:51:2 In Section 7.2, we evaluated the steady-state error by using the Ô¨Ånal value theorem. An alternate method makes use of the static error constants. A few examples follow: Example 7.4 Steady-State Error via Static Error ConstantsSteady-State Error via Static Error Constants PROBLEM: For each system of Figure 7.7, evaluate the static error constants and Ô¨Ånd the expected error for the standard step, ramp, and parabolic inputs. SOLUTION: First verify that all closed-loop systems shown are indeed stable. For this example we leave out the details. Next, for Figure 7.7( a), Kp¬àlim s¬Æ0Gs ¬Ü¬à50025 81012¬à5:208 (7.36) Kv¬àlim s¬Æ0sG s¬Ü¬à0 (7.37) Ka¬àlim s¬Æ0s2G s¬Ü¬à0 (7.38) Thus, for a step input, e ‚àû¬Ü¬à1 1¬áKp¬à0:161 (7.39) For a ramp input, e ‚àû¬Ü¬à1 Kv¬à‚àû (7.40) For a parabolic input, e ‚àû¬Ü¬à1 Ka¬à‚àû (7.41) Now, for Figure 7.7( b), Kp¬àlim s¬Æ0G s¬Ü¬à‚àû (7.42)+ ‚ÄìR(s) C(s) 500(s + 2)(s + 5) (s + 8)(s + 10)(s + 12) (a) + ‚ÄìR(s) C(s) 500(s + 2)(s + 5)(s + 6) s(s + 8)(s + 10)(s + 12) (b) + ‚ÄìR(s) C(s) 500(s + 2)(s + 4)(s + 5)(s + 6)(s + 7) s2(s + 8)(s + 10)(s + 12) (c)E(s) E(s) E(s) FIGURE 7.7 Feedback control systems for Example 7.4346 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:3 System Type Let us continue to focus on a unity negative feedback system. The values of the static error constants, again, depend upon the form of G(s), especially the number of pure integrations in the forward path. Since steady-state errors are dependent upon the number of integrations in the forward path, we give a name to this system attribute. Given the system inKv¬àlim s¬Æ0sG s ¬Ü¬à500256 81012¬à31:25 (7.43) and Ka¬àlim s¬Æ0s2G s¬Ü¬à0 (7.44) Thus, for a step input, e ‚àû¬Ü¬à1 1¬áKp¬à0 (7.45) For a ramp input, e ‚àû¬Ü¬à1 Kv¬à1 31:25¬à0:032 (7.46) For a parabolic input, e ‚àû¬Ü¬à1 Ka¬à‚àû (7.47) Finally, for Figure 7.7( c), Kp¬àlim s¬Æ0G s¬Ü¬à‚àû (7.48) Kv¬àlim s¬Æ0sG s¬Ü¬à‚àû (7.49) and Ka¬àlim s¬Æ0s2Gs ¬Ü¬à50024567 81012¬à875 (7.50) Thus, for a step input, e ‚àû¬Ü¬à1 1¬áKp¬à0 (7.51) For a ramp input, e ‚àû¬Ü¬à1 Kv¬à0 (7.52) For a parabolic input, e ‚àû¬Ü¬à1 Ka¬à1 875¬à1:1410 3(7.53) Students who are using MATLAB should now run ch7p1 in Appendix B. You will learn how to test the system for stability, evaluatestatic error constants, and calculate steady-state error usingMATLAB. This exercise applies MATLAB to solve Example 7.4 withSystem (b) .7.3 Static Error Constants and System Type 347WEBC07 10/28/2014 17:51:7 Figure 7.8, we de Ô¨Ånesystem type to be the value of nin the denominator or, equivalently, the number of pure integrations in the forward path. Therefore, a system with n¬à0 is a Type 0 system. If n¬à1o rn¬à2, the corresponding system is a Type 1 or Type 2 system, respectively. Table 7.2 ties together the concepts of steady-state error, static error constants, and system type. The table shows the static errorconstants and the steady-state errors as functions of input waveformand system type. In this section, we de Ô¨Åned steady-state errors, static error constants, and system type. Now the speci Ô¨Åcations for a control system ‚Äôs steady-state errors will be formulated, followed by some examples. 7.4 Steady-State Error Speci Ô¨Åcations Static error constants can be used to specify the steady-state error characteristics of controlsystems, such as that shown in Figure 7.9. Just as damping ratio, Œ∂, settling time, T s, peak time, Tp, and percent overshoot, % OS, are used as speci Ô¨Åcations for a control system ‚Äôs transient response, so the position constant, Kp, velocity constant, Kv, and acceleration constant, Ka, canSkill-Assessment Exercise 7.2 PROBLEM: A unity feedback system has the following forward transfer function: Gs ¬Ü¬à1000 s¬á8¬Ü s¬á7¬Ü s¬á9¬Ü a.Evaluate system type, Kp,Kv, and Ka. b.Use your answers to a.toÔ¨Ånd the steady-state errors for the standard step, ramp, and parabolic inputs. ANSWERS: a.The closed-loop system is stable. System type =Type 0. Kp¬à127, Kv¬à0, and Ka¬à0. b.estep ‚àû¬Ü¬à7:810 3;eramp ‚àû¬Ü¬à‚àû;andeparabola ‚àû ¬Ü ¬à ‚àû The complete solution is at www.wiley.com/college/nise .TryIt 7.1 Use MATLAB, the Control System Toolbox, and thefollowing statements to Ô¨ÅndK p, estep‚àû ¬Ü, and the closed-loop poles to check for stability for thesystem of Skill-AssessmentExercise 7.2. numg=1000* [1 8] ; deng=poly( [  7 9] ) ; G=tf (numg,deng) ; Kp=dcgain (G) estep =1/ (1+Kp) T=feedback(G,1) ; poles =pole(T)+ ‚ÄìR(s) C(s) K(s + z1)(s + z2) ... sn(s + p1)(s + p2) ...E(s) FIGURE 7.8 Feedback control system for de Ô¨Åning system type TABLE 7.2 Relationships between input, system type, static error constants, and steady-state errors Type 0 Type 1 Type 2 InputSteady-state error formulaStatic error constant ErrorStatic error constant ErrorStatic error constant Error Step, u(t)1 1¬áKpKp¬àConstant1 1¬áKpKp¬à‚àû 0 Kp¬à‚àû 0 Ramp, tu(t)1 KvKv¬à0 ‚àû Kv¬àConstant1 KvKv¬à‚àû 0 Parabola,1 2t2ut ¬Ü1 KaKa¬à0 ‚àû Ka¬à0 ‚àû Ka¬àConstant1 Ka348 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:7 be used as speci Ô¨Åcations for a control system ‚Äôs steady-state errors. We will soon see that a wealth of information is contained within the speci Ô¨Åcation of a static error constant. For example, if a control system has the speci Ô¨Åcation Kv¬à1000, we can draw several conclusions: 1.The system is stable. 2.The system is of Type 1, since only Type 1 systems have Kv‚Äôs that are Ô¨Ånite constants. Recall that Kv¬à0 for Type 0 systems, whereas Kv¬à‚àûfor Type 2 systems. 3.A ramp input is the test signal. Since Kvis speciÔ¨Å ed as a Ô¨Ånite constant, and the steady-state error for a ramp input is inversely proportional to Kv,w ek n o wt h et e s t input is a ramp. 4.The steady-state error between the input ramp and the output ramp is 1 =Kvper unit of input slope. Let us look at two examples that demonstrate analysis and design using static error constants. FIGURE 7.9 A robot used in the manufacturing of semiconductor random-accessmemories (RAMs) similar tothose in personal computers. Steady-state error is an important design considerationfor assembly-line robots Example 7.5 Interpreting the Steady-State Error Speci Ô¨Åcation Interpreting the Steady-State Error Speci Ô¨Åcation PROBLEM: What information is contained in the speci Ô¨Åcation Kp¬à1000? SOLUTION: The system is stable. The system is Type 0, since only a Type 0 system has aÔ¨Ånite Kp. Type 1 and Type 2 systems have Kp¬à‚àû. The input test signal is a step, since Kpis speci Ô¨Åed. Finally, the error per unit step is e ‚àû¬Ü¬à1 1¬áKp¬à1 1¬á1000¬à1 1001(7.54)7.4 Steady-State Error Speci Ô¨Åcations 349WEBC07 10/28/2014 17:51:8 Example 7.6 Gain Design to Meet a Steady-State Error Speci Ô¨Åcation Gain Design to Meet a Steady-State Error Speci Ô¨Åcation PROBLEM: Given the control system in Figure 7.10, Ô¨Ånd the value of Kso that there is 10% error in the steady state. SOLUTION: Since the system is Type 1, the error stated in the problem must apply to a ramp input; only a ramp yields a Ô¨Ånite error in a Type 1 system. Thus, e ‚àû¬Ü¬à1 Kv¬à0:1( 7.55) Therefore, Kv¬à10¬àlim s¬Æ0sG s ¬Ü¬àK5 678(7.56) which yields K¬à672 (7.57) Applying the Routh-Hurwitz criterion, we see that the system is stable at this gain. Although this gain meets the criteria for steady-state error and stability, it may not yield a desirable transient response. In Chapter 9 we will design feedback control systems to meet all three speci Ô¨Åcations. Students who are using MATLAB should now run ch7p2 in Appendix B. You will learn how to Ô¨Ånd the gain to meet a steady-state error speci Ô¨Åcation using MATLAB. This exercise solves Example 7.6 using MATLAB. Skill-Assessment Exercise 7.3 PROBLEM: A unity feedback system has the following forward transfer function: G s¬Ü¬àK s¬á12¬Ü s¬á14¬Ü s¬á18¬Ü Find the value of Kto yield a 10% error in the steady state. ANSWER: K¬à189 The complete solution is at www.wiley.com/college/nise .+ ‚ÄìR(s) C(s) K(s + 5) s(s + 6)(s + 7)(s + 8)E(s) FIGURE 7.10 Feedback control system for Example 7.6 TryIt 7.2 Use MATLAB, the Control System Toolbox, and the following statements to solveSkill-Assessment Exercise 7.3and check the resulting system for stability. numg=[1 12] ; deng=poly( [  14 18] ) ; G=tf(numg,deng) ; Kpdk=dcgain(G) ; estep =0.1; K=(1/estep-1) /Kpdk T=feedback(G,1) ; poles =pole(T)350 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:9 This example and exercise complete our discussion of unity feedback systems. In the remaining sections, we will deal with the steady-state errors for disturbances and the steady-state errors for feedback control systems in which the feedback is not unity. 7.5 Steady-State Error for Disturbances Feedback control systems are used to compensate for distur- bances or unwanted inputs that enter a system. The advantage of using feedback is that regardless of these disturbances,the system can be designed to follow the input with small or zero error, as we now demonstrate. Figure 7.11 shows afeedback control system with a disturbance, D(s), injected between the controller and the plant. We now re-derive theexpression for steady-state error with the disturbance included. The transform of the output is given by Cs ¬Ü¬à Es ¬ÜG 1s ¬ÜG2s ¬Ü ¬á Ds ¬ÜG2s ¬Ü (7.58) But Cs ¬Ü¬à Rs ¬Ü   Es ¬Ü (7.59) Substituting Eq. (7.59) into Eq. (7.58) and solving for E(s), we obtain Es ¬Ü¬à1 1¬áG1s ¬ÜG2s ¬ÜRs ¬Ü  G2s ¬Ü 1¬áG1s ¬ÜG2s ¬ÜDs ¬Ü (7.60) where we can think of 1 =¬â1¬áG1s ¬ÜG2s ¬Ü ¬äas a transfer function relating E(s)t oR(s) and  G2s ¬Ü=¬â1¬áG1s ¬ÜG2s ¬Ü ¬äas a transfer function relating E(s)t oD(s). ToÔ¨Ånd the steady-state value of the error, we apply the Ô¨Ånal value theorem3to Eq. (7.60) and obtain e‚àû ¬Ü ¬à lim s¬Æ0sE s ¬Ü¬à lim s¬Æ0s 1¬áG1s ¬ÜG2s ¬ÜRs ¬Ü   lim s¬Æ0sG2s ¬Ü 1¬áG1s ¬ÜG2s ¬ÜDs ¬Ü ¬àeR‚àû ¬Ü ¬á eD‚àû ¬Ü(7.61) where eR‚àû ¬Ü ¬à lim s¬Æ0s 1¬áG1s ¬ÜG2s ¬ÜRs ¬Ü and eD‚àû ¬Ü ¬à   lim s¬Æ0sG2s ¬Ü 1¬áG1s ¬ÜG2s ¬ÜDs ¬Ü TheÔ¨Årst term, eR‚àû ¬Ü, is the steady-state error due to R(s), which we have already obtained. The second term, eD‚àû ¬Ü, is the steady-state error due to the disturbance. Let us explore the conditions on eD‚àû ¬Üthat must exist to reduce the error due to the disturbance.+ ‚ÄìR(s) C(s)G1(s)E(s)Controller ++PlantD(s) G2(s) FIGURE 7.11 Feedback control system showing disturbance 3Remember that the Ô¨Ånal value theorem can be applied only if the system is stable, with the roots of ¬â1¬áG1s ¬ÜG2s ¬Ü ¬äin the left‚Äì half ‚Äìplane.7.5 Steady-State Error for Disturbances 351WEBC07 10/28/2014 17:51:9 At this point, we must make some assumptions about D(s), the controller, and the plant. First we assume a step disturbance, Ds ¬Ü¬à 1=s. Substituting this value into the second term of Eq. (7.61), eD‚àû ¬Ü, the steady-state error component due to a step disturbance is found to be eD‚àû ¬Ü ¬à  1 lim s¬Æ01 G2s ¬Ü¬álim s¬Æ0G1s ¬Ü(7.62) This equation shows that the steady-state error produced by a step disturbance can be reduced by increasing the dc gain of G1(s) or decreasing the dc gain of G2(s). This concept is shown in Figure 7.12, where the system of Figure 7.11 has been rearranged so that the disturbance, D(s), is depicted as the input and the error, E(s), as the output, with R(s) set equal to zero. If we want to minimize the steady-state value of E(s), shown as the output in Figure 7.12, we must either increase the dc gain of G1(s) so that a lower value of E(s)w i l l be fed back to match the steady-state value of D(s), or decrease the dc value of G2(s), which then yields a smaller value of e‚àû ¬Üas predicted by the feedback formula. Let us look at an example and calculate the numerical value of the steady-state error that res ults from a disturbance. Example 7.7 Steady-State Error Due to Step DisturbanceSteady-State Error Due to Step Disturbance PROBLEM: Find the steady-state error component due to a step disturbance for the system of Figure 7.13. SOLUTION: The system is stable. Using Figure 7.12 and Eq. (7.62), we Ô¨Ånd eD ‚àû¬Ü¬à 1 lim s¬Æ01 G2 s¬Ü¬álim s¬Æ0G1s ¬Ü¬à 1 0¬á1000¬à 1 1000(7.63) The result shows that the steady-state error produced by the step disturbance is inversely proportional to the dc gain of G1(s) .T h ed cg a i no f G2(s)i si n Ô¨Ånite in this example.Virtual Experiment 7.1 Steady-State Error with Disturbance Put theory into practice Ô¨Ånding the steady-state error of the Quanser Rotary Servo whensubject to an input or adisturbance by simulating it in LabVIEW. This analysis becomes important when developingcontrollers for bottle labeling machines or robot joint control. Virtual experiments are found on Learning Space.+ ‚ÄìD(s)G2(s) ControllerPlant G1(s)‚ÄìE(s) FIGURE 7.12 Figure 7.11 system rearranged to show disturbance as input and error as output, with R s¬Ü¬à0 + ‚ÄìR(s) C(s)1000Controller E(s)+D(s) + 1 s(s + 25)G1(s) PlantG2(s) FIGURE 7.13 Feedback control system for Example 7.7352 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:10 7.6 Steady-State Error for Nonunity Feedback Systems Control systems often do not have unity feedback because of the compensation used to improve performance or because of the physical model for the system. The feedback pathcan be a pure gain other than unity or have some dynamic representation. A general feedback system, showing the input transducer, G 1(s), controller and plant, G2(s), and feedback, H1(s), is shown in Figure 7.15( a). Pushing the input transducer to the right past the summing junction yields the general nonunity feedback system shown inSkill-Assessment Exercise 7.4 PROBLEM: Evaluate the steady-state error component due to a step disturbance for thesystem of Figure 7.14. ANSWER: e D ‚àû¬Ü¬à  9:9810 4 The complete solution is at www.wiley.com/college/nise .‚Äì1000s+2 s+4C(s) E(s) + R(s) ++D(s) FIGURE 7.14 System for Skill-Assessment Exercise 7.4 R(s) ‚Äì+ Ea(s)G(s) ‚Äì+ ‚Äì1 (b)( c) R(s) ‚Äì+ Ea(s) (d)R(s) ‚Äì+ (e)E(s) 1 + G(s)H(s) ‚Äì G(s)C(s) H(s)R(s) Ea(s)G(s)C(s) H(s) G(s) C(s) G(s) H(s) ‚Äì 1C(s) ‚Äì‚Äì‚Äì‚Äì+ Ea1(s)G2(s) (a)C(s) H1(s)R(s) G1(s) FIGURE 7.15 Forming an equivalent unity feedback system from a general nonunity feedback system7.6 Steady-State Error for Nonunity Feedback Systems 353WEBC07 10/28/2014 17:51:11 Figure 7.15( b), where Gs ¬Ü¬à G1s ¬ÜG2s ¬ÜandHs ¬Ü¬à H1s ¬Ü=G1s ¬Ü. Notice that unlike a unity feedback system, where Hs ¬Ü¬à 1, the error is not the difference between the input and the output. For this case we call the sign al at the output of the summing junction the actuating signal, E a(s). Ifr(t)a n d c(t) have the same units, we can Ô¨Ånd the steady-state error, e‚àû ¬Ü ¬à r‚àû ¬Ü   c‚àû ¬Ü.T h eÔ¨Å rst step is to show explicitly Es ¬Ü¬à Rs ¬Ü   Cs ¬Üon the block diagram. Take the nonunity feedback control system shown in Figure 7.15( b)a n df o r ma unity feedback system by adding and subtr acting unity feedback paths, as shown in Figure 7.15( c). This step requires that input and output units be the same. Next combine H(s) with the negative unity feedback, as shown in Figure 7.15( d). Finally, combine the feedback system consisting of G(s)a n d ¬âHs ¬Ü   1¬ä, leaving an equivalent forward path and a unity feedback, as shown in Figure 7.15( e). Notice that the Ô¨ÅnalÔ¨Ågure shows Es ¬Ü¬à Rs ¬Ü   Cs ¬Üexplicitly. The following example summarizes the concepts of steady-state error, system type, and static error constants for nonunity feedback systems. Example 7.8 Steady-State Error for Nonunity Feedback SystemsSteady-State Error for Nonunity Feedback Systems PROBLEM: For the system shown in Figure 7.16, Ô¨Ånd the system type, the appropriate error constant associated with the system type, and the steady-state error for a unit step input. Assume input and output unitsare the same. SOLUTION: After determining that the system is indeed stable, one may impulsively declare the system to be Type 1. This may not be the case, since there is a nonunity feedback element, and the plant ‚Äôs actuating signal is not the difference between the input and the output. TheÔ¨Årst step in solving the problem is to convert the system of Figure 7.16 into an equivalent unity feedback system. Using the equivalent forward transfer function of Figure 7.15(e ) along with Gs ¬Ü¬à100 ss¬á10 ¬Ü(7.64) and Hs ¬Ü¬à1 s¬á5 ¬Ü(7.65) weÔ¨Ånd Ges ¬Ü¬àGs ¬Ü 1¬áGs ¬ÜHs ¬Ü   Gs ¬Ü¬à100s¬á5 ¬Ü s3¬á15s2 50s 400(7.66) Thus, the system is Type 0, since there are no pure integrations in Eq. (7.66). The appropriate static error constant is then Kp, whose value is Kp¬àlim s¬Æ0Ges ¬Ü¬à1005  400¬à 5 4(7.67) The steady-state error, e‚àû ¬Ü,i s e‚àû ¬Ü ¬à1 1¬áKp¬à1 1 5=4 ¬Ü¬à 4 (7.68) The negative value for steady-state error implies that the output step is larger than the input step.R(s) C(s) ‚Äì+ Ea(s) 1 (s + 5)100 s(s + 10) FIGURE 7.16 Nonunity feedback control system for Example 7.8 TryIt 7.3 Use MATLAB, the Control System Toolbox, and thefollowing statements to Ô¨Ånd G e(s) in Example 7.8. G=zpk( [] , [0  10] ,100) ; H=zpk( [] ,  5,1) ; Ge=feedback... (G,(H-1) ) ; 'Ge(s) ' Ge=tf(Ge) T=feedback (Ge,1) ; 'Poles of T(s) 'pole(T)354 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:12 To continue our discussion of steady-state error for systems with nonunity feedback, let us look at the general system of Figure 7.17, which has both a disturbance and nonunity feedback. We will derive ageneral equation for the steady-state error and then determine theparameters of the system in order to drive the error to zero for stepinputs and step disturbances. 4 The steady-state error for this system, e‚àû ¬Ü ¬à r‚àû ¬Ü   c‚àû ¬Ü,i s e‚àû ¬Ü ¬à lim s¬Æ0sE s ¬Ü¬à lim s¬Æ0s( 1 G1s ¬ÜG2s ¬Ü 1¬áG1s ¬ÜG2s ¬ÜHs ¬Ü/C20/C21 Rs ¬Ü  G2s ¬Ü 1¬áG1s ¬ÜG2s ¬ÜHs ¬ÜDs ¬Ü/C20/C21) (7.69) Now limiting the discussion to step inputs and step disturbances, where Rs ¬Ü¬à Ds ¬Ü¬à 1=s, Eq. (7.69) becomes e‚àû ¬Ü¬àlim s¬Æ0sE s ¬Ü¬à 1 lim s¬Æ0¬âG1s ¬ÜG2s ¬Ü ¬ä lim s¬Æ0¬â1¬áG1s ¬ÜG2s ¬ÜHs ¬Ü ¬ä2 435 lim s¬Æ0G2s ¬Ü lim s¬Æ0¬â1¬áG1s ¬ÜG2s ¬ÜHs ¬Ü ¬ä24358 < :9 = ; (7.70) For zero error, lim s¬Æ0¬âG1s ¬ÜG2s ¬Ü ¬ä lim s¬Æ0¬â1¬áG1s ¬ÜG2s ¬ÜHs ¬Ü ¬ä¬à1a n dlim s¬Æ0G2s ¬Ü lim s¬Æ0¬â1¬áG1s ¬ÜG2s ¬ÜHs ¬Ü ¬ä¬à0 (7.71) The two equations in Eq. (7.71) can always be satis Ô¨Åed if (1) the system is stable, (2) G1(s)i s a Type 1 system, (3) G2(s) is a Type 0 system, and (4) H(s) is a Type 0 system with a dc gain of unity. To conclude this section, we discuss Ô¨Ånding the steady-state value of the actuating signal, Ea1(s), in Figure 7.15( a). For this task there is no restriction that the input and output units be the same, since we are Ô¨Ånding the steady-state difference between signals at the summing junction, which do have the same units.5The steady-state actuating signal for Figure 7.15( a)i s ea1‚àû ¬Ü ¬à lim s¬Æ0sR s ¬ÜG1s ¬Ü 1¬áG2s ¬ÜH1s ¬Ü(7.72) The derivation is left to the student in the problem set at the end of this chapter.R(s) C(s) ‚ÄìG1(s)+ ++D(s) G2(s) H(s) FIGURE 7.17 Nonunity feedback control system with disturbance Example 7.9 Steady-State Actuating Signal for Nonunity Feedback SystemsSteady-State Actuating Signal for NonunityFeedback Systems PROBLEM: Find the steady-state actuating signal for the system of Figure 7.16 for a unit step input. Repeat for a unit ramp input. 4Details of the derivation are included as a problem at the end of this chapter. 5For clarity, steady-state error is the steady-state difference between the input and the output. Steady-state actuating signal is the steady-state difference at the output of the summing junction. In questions asking for steady-state error in problems, examples, and skill-assessment exercises, it will be assumed that input and output units are the same.7.6 Steady-State Error for Nonunity Feedback Systems 355WEBC07 10/28/2014 17:51:13 In this section, we have applied steady-state error analysis to nonunity feedback systems. When nonunity feedback is present, the plant ‚Äôs actuating signal is not the actual error or difference between the input and the output. With nonunity feedback we may choose to (1) Ô¨Ånd the steady-state error for systems where the input and output units are the same or (2) Ô¨Ånd the steady-state actuating signal. We also derived a general expression for the steady-state error of a nonunity feedback system with a disturbance. We used this equation to determine the attributes of thesubsystems so that there was zero error for step inputs and step disturbances. Before concluding this chapter, we will discuss a topic that is not only signi Ô¨Åcant for steady-state errors but generally useful throughout the control systems design process. 7.7 Sensitivity During the design process, the engineer may want to consider the extent to which changes insystem parameters affect the behavior of a system. Ideally, parameter changes due to heat orother causes should not appreciably affect a system ‚Äôs performance. The degree to whichSOLUTION: Use Eq. (7.72) with R s¬Ü¬à1=s, a unit step input, G1 s¬Ü¬à1; G2 s¬Ü¬à100=¬âs s¬á10¬Ü¬ä, and H1 s¬Ü¬à1= s¬á5¬Ü. Also, realize that ea1 ‚àû¬Ü¬àea ‚àû¬Ü, since G1 s¬Ü¬à1. Thus, ea‚àû ¬Ü ¬à lim s¬Æ0s1 s/C18/C19 1¬á100 s s¬á10¬Ü/C18/C191 s¬á5¬Ü/C18/C19 ¬à0 (7.73) Now use Eq. (7.72) with R s¬Ü¬à1=s2, a unit ramp input, and obtain ea ‚àû¬Ü¬àlim s¬Æ0s1 s2/C18/C19 1¬á100 s s¬á10¬Ü/C18/C191 s¬á5¬Ü/C18/C19 ¬à1 2(7.74) Skill-Assessment Exercise 7.5 PROBLEM: a.Find the steady-state error, e ‚àû¬Ü¬àr ‚àû¬Ü c ‚àû¬Ü, for a unit step input given the nonunity feedback system of Figure 7.18. Repeat for a unit ramp input. Assume input and output units are the same. b.Find the steady-state actuating signal, ea ‚àû¬Ü, for a unit step input given the nonunity feedback system of Figure 7.18. Repeat for a unit ramp input. ANSWERS: a.estep ‚àû¬Ü¬à3:84610 2;eramp ‚àû¬Ü¬à‚àû b.For a unit step input, ea ‚àû¬Ü¬à3:84610 2; for a unit ramp input, ea ‚àû¬Ü¬à‚àû The complete solution is at www.wiley.com/college/nise .‚Äì+ Ea(s) C(s) s+11R(s) s+4100 FIGURE 7.18 Nonunity feedback system for Skill-Assessment Exercise 7.5356 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:13 changes in system parameters affect system transfer functions, and hence performance, is called sensitivity . A system with zero sensitivity (that is, changes in the system parameters have no effect on the transfer function) is ideal. The greater the sensitivity, the less desirable the effect of a parameter change. For example, assume the function F¬àK=K¬áa ¬Ü .I fK¬à10 and a¬à100, then F¬à0:091. If parameter atriples to 300, then F¬à0:032. We see that a fractional change in parameter aof 300  100 ¬Ü =100¬à2 (a 200% change) yields a change in the function F of 0 :032 0:091 ¬Ü =0:091¬à 0:65 65 %change ¬Ü . Thus, the function Fhas reduced sensitivity to changes in parameter a. As we proceed, we will see that another advantage of feedback is that in general it affords reduced sensitivity to parameter changes. Based upon the previous discussion, let us formalize a de Ô¨Ånition of sensitivity: Sensitivity is the ratio of the fractional change in the function to the fractional change in the parameter as the fractional change of the parameter approaches zero. That is, SF:P¬àlim ŒîP¬Æ0Fractional change in the function ;F Fractional change in the parameter ;P ¬àlim ŒîP¬Æ0ŒîF=F ŒîP=P ¬àlim ŒîP¬Æ0PŒîF FŒîP which reduces to SF:P¬àP FŒ¥F Œ¥P(7.75) Let us now apply the de Ô¨Ånition, Ô¨Årst to a closed-loop transfer function and then to the steady-state error. Example 7.10 Sensitivity of a Closed-Loop Transfer FunctionSensitivity of a Closed-Loop Transfer Function PROBLEM: Given the system of Figure 7.19, calculate the sensitivity of the closed-loop transfer function to changes in the parameter a. How would you reduce the sensitivity? SOLUTION: The closed-loop transfer function is Ts ¬Ü¬àK s2¬áas¬áK(7.76) Using Eq. (7.75), the sensitivity is given by ST:a¬àa TŒ¥T Œ¥a¬àa K s2¬áas¬áK/C18/C19 Ks s2¬áas¬áK¬Ü2/C18/C19 ¬à as s2¬áas¬áK(7.77) which is, in part, a function of the value of s. For any value of s,however, an increase in K reduces the sensitivity of the closed-loop transfer function to changes in the parameter a.R(s) ‚Äì+ E(s) K s(s + a)C(s) FIGURE 7.19 Feedback control system for Examples 7.10 and 7.117.7 Sensitivity 357WEBC07 10/28/2014 17:51:15 Example 7.11 Sensitivity of Steady-State Error with Ramp InputSensitivity of Steady-State Error with Ramp Input PROBLEM: For the system of Figure 7.19, Ô¨Ånd the sensitivity of the steady-state error to changes in parameter Kand parameter awith ramp inputs. SOLUTION: The steady-state error for the system is e ‚àû¬Ü¬à1 Kv¬àa K(7.78) The sensitivity of e ‚àû¬Üto changes in parameter ais Se:a¬àa eŒ¥e Œ¥a¬àa a=K1 K/C20/C21 ¬à1 (7.79) The sensitivity of e ‚àû¬Üto changes in parameter Kis Se:K¬àK eŒ¥e Œ¥K¬àK a=K a K2/C20/C21 ¬à 1 (7.80) Thus, changes in either parameter aor parameter Kare directly reÔ¨Ç ected in e ‚àû¬Ü,a n d there is no reduction or increase in sensitivity. The negative sign in Eq. (7.80) indicates a decrease in e ‚àû¬Üfor an increase in K. Both of these results could have been obtained directly from Eq. (7.78) since e ‚àû¬Üis directly proportional to parameter aand inversely proportional to parameter K. Example 7.12 Sensitivity of Steady-State Error with Step InputSensitivity of Steady-State Error with Step Input PROBLEM: Find the sensitivity of the steady-state error to changes in parameter Kand parameter afor the system shown in Figure 7.20 with a step input. SOLUTION: The steady-state error for this Type 0 system is e ‚àû¬Ü¬à1 1¬áKp¬à1 1¬áK ab¬àab ab¬áK(7.81) The sensitivity of e ‚àû¬Üto changes in parameter ais Se:a¬àa eŒ¥e Œ¥a¬àa ab ab¬áK/C18/C19ab¬áK ¬Ü b ab2 ab¬áK ¬Ü2¬àK ab¬áK(7.82) The sensitivity of e ‚àû¬Üto changes in parameter Kis Se:K¬àK eŒ¥e Œ¥K¬àK ab ab¬áK/C18/C19 ab ab¬áK¬Ü2¬à K ab¬áK(7.83) Equations (7.82) and (7.83) show that the sensitivity to changes in parameter Kand parameter ais less than unity for positive aandb. Thus, feedback in this case yields reduced sensitivity to variations in both parameters.R(s) ‚Äì+ K (s + a)(s + b)E(s) C(s) FIGURE 7.20 Feedback control system for Example 7.12 TryIt 7.4 Use MATLAB, the Symbolic Math Toolbox, and the following statements to Ô¨ÅndSe:a in Example 7.12. syms Kabs G=K/ ( (s+a) * (s+b) ) ; Kp=subs(G,s,0) ; e=1/ (1+Kp) ; Sea=(a/e) *diff(e,a) ; Sea=simplify(Sea) ; 'Sea' pretty(Sea)358 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:15 In this section, we deÔ¨Å ned sensitivity and showed that in some cases feedback reduces the sensitivity of a system ‚Äôs steady-state error to changes in system parameters. The concept of sensitivity can be applied to other measures of control system performance, as well; it is not limited to the sensitivity of the steady-state error performance. 7.8 Steady-State Error for Systems in State Space Up to this point, we have evaluated the steady-state error for systems modeled as transferfunctions. In this section, we will discuss how to evaluate the steady-state error for systemsrepresented in state space. Two methods for calculating the steady-state error will be covered: (1) analysis via Ô¨Ånal value theorem and (2) analysis via input substitution. We will consider these methods individually. Analysis via Final Value Theorem A single-input, single-output system represented in state space can be analyzed for steady- state error using the Ô¨Ånal value theorem and the closed-loop transfer function, Eq. (3.73), derived in terms of the state-space representation. Consider the closed-loop systemrepresented in state space: _x¬àAx¬áBr (7.84a) y¬àCx (7.84b) The Laplace transform of the error is Es ¬Ü¬à Rs ¬Ü   Ys ¬Ü (7.85) But Ys ¬Ü¬à Rs ¬ÜTs ¬Ü (7.86) where T(s) is the closed-loop transfer function. Substituting Eq. (7.86) into (7.85), we obtain Es ¬Ü¬à Rs ¬Ü ¬â1 Ts ¬Ü ¬ä (7.87) Using Eq. (3.73) for T(s), we Ô¨Ånd Es ¬Ü¬à Rs ¬Ü ¬â1 CsI A ¬Ü  1B¬ä (7.88) Applying the Ô¨Ånal value theorem, we have lim s¬Æ0sE s ¬Ü¬à lim s¬Æ0sR s ¬Ü ¬â1 CsI A ¬Ü 1B¬ä (7.89) Let us apply the result to an example.Skill-Assessment Exercise 7.6 PROBLEM: Find the sensitivity of the steady-state error to changes inKfor the system of Figure 7.21. ANSWER: Se:k¬à 7K 10¬á7K The complete solution is at www.wiley.com/college/nise .s2+2s+10K(s+7) ‚Äì+ E(s) C(s) R(s) FIGURE 7.21 System for Skill-Assessment Exercise 7.67.8 Steady-State Error for Systems in State Space 359WEBC07 10/28/2014 17:51:16 Analysis via Input Substitution Another method for steady-state analysis avoids taking the inverse of sI A ¬Ü and can be expanded to multiple-input, multiple-output systems; it substitutes the input along with an assumed solution into the state equations ( Hostetter ,1989 ). We will derive the results for unit step and unit ramp inputs. Step Inputs. Given the state Eqs. (7.84), if the input is a unit step where r¬à1, a steady-state solution, xss, for x,i s xss¬àV1 V2 ... Vn2 666643 77775¬àV (7.92) where V iis constant. Also, _xss¬à0 (7.93) Substituting r¬à1, a unit step, along with Eqs. (7.92) and (7.93), into Eqs. (7.84) yields 0¬àAV¬áB (7.94a) yss¬àCV (7.94b) where yssis the steady-state output. Solving for Vyields V¬à A 1B (7.95)Example 7.13 Steady-State Error Using the Final Value TheoremSteady-State Error Using the Final Value Theorem PROBLEM: Evaluate the steady-state error for the system described by Eqs. (7.90) for unit step and unit ramp inputs. Use the Ô¨Ånal value theorem. A¬à 51 0 0 21 20  10 12 435;B¬à0 0 12 435;C¬à¬â 110 ¬ä (7.90) SOLUTION: Substituting Eqs. (7.90) into (7.89), we obtain e ‚àû¬Ü¬àlim s¬Æ0sR s ¬Ü1 s¬á4 s3¬á6s2¬á13s¬á20/C18/C19 ¬àlim s¬Æ0sR s ¬Üs3¬á6s2¬á12s¬á16 s3¬á6s2¬á13s¬á20/C18/C19(7.91) For a unit step, R s¬Ü¬à1=s, and e ‚àû¬Ü¬à4=5. For a unit ramp, R s¬Ü¬à1=s2, and e ‚àû¬Ü¬à‚àû. Notice that the system behaves like a Type 0 system.TryIt 7.5 Use MATLAB, the Symbolic Math Toolbox, and the following statements to Ô¨Ånd the steady-state error for a step input to the system of Example 7.13. syms s A=[ 510 0 21 20 10 1] ; B=[0; 0; 1] ; C=[ 110 ] ; I=[1 0 0 010 001 ] ; E=(1/s) * [1  C*... [ (s*I-A) ^-1] *B] ; %New command:%subs(X,old,new) : %Replace old in...%X(old) with new. error =subs(s*E,s,0)360 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:17 But the steady-state error is the difference between the steady-state input and the steady- state output. The Ô¨Ånal result for the steady-state error for a unit step input into a system represented in state space is e‚àû ¬Ü ¬à 1 yss¬à1 CV¬à1¬áCA 1B (7.96) Ramp Inputs. For unit ramp inputs, r¬àt, a steady-state solution for xis xss¬àV1t¬áW1 V2t¬áW2 ... Vnt¬áWn2 666643 77775¬àVt¬áW (7.97) where V iandWiare constants. Hence, _xss¬àV1 V2 ... Vn2 666643 77775¬àV (7.98) Substituting r¬àtalong with Eqs. (7.97) and (7.98) into Eqs. (7.84) yields V¬àAVt¬áW ¬Ü ¬á Bt (7.99a) y ss¬àCVt¬áW ¬Ü (7.99b) In order to balance Eq. (7.99a), we equate the matrix coef Ô¨Åcients of t,AV¬à B,o r V¬à A 1B (7.100) Equating constant terms in Eq. (7.99a), we have AW ¬àV,o r W¬àA 1V (7.101) Substituting Eqs. (7.100) and (7.101) into (7.99b) yields yss¬àC¬â A 1Bt¬áA 1 A 1B/C0/C1 ¬ä¬à  C¬âA 1Bt¬áA 1/C0/C1 2B¬ä (7.102) The steady-state error is therefore e‚àû ¬Ü ¬à lim t¬Æ‚àût yss ¬Ü ¬à lim t¬Æ‚àû¬â1¬áCA 1B/C0/C1 t¬áCA 1/C0/C1 2B¬ä (7.103) Notice that in order to use this method, A 1must exist. That is, det A6¬à0. We now demonstrate the use of Eqs. (7.96) and (7.103) to Ô¨Ånd the steady-state error for step and ramp inputs. Example 7.14 Steady-State Error Using Input SubstitutionSteady-State Error Using Input Substitution PROBLEM: Evaluate the steady-state error fo r the system described by the three equations in Eq. (7.90) for unit step and unit ramp inputs. Use input substitution.7.8 Steady-State Error for Systems in State Space 361WEBC07 10/28/2014 17:51:19 In this chapter, we covered the evaluation of steady-state error for systems represented by transfer functions as well as systems represented in state space. For systems represented in state space, two methods were presented: (1) Ô¨Ånal value theorem and (2) input substitution. Case Studies Antenna Control: Steady-State Error Design via GainAntenna Control: Steady-State Error Design via Gain This chapter showed how to Ô¨Ånd steady-state errors for step, ramp, and parabolic inputs to a closed-loop feedback control system. We also learned how to evaluate the gain to meet a steady-state error requirement. This ongoing case study uses our antenna azimuth positioncontrol system to summarize the concepts. PROBLEM: For the antenna azimuth position control system shown on the front endpapers, ConÔ¨Å guration 1, a.Find the steady-state error in terms of gain, K, for step, ramp, and parabolic inputs. b.Find the value of gain, K, to yield a 10% error in the steady state.SOLUTION: For a unit step input, the steady-state error given by Eq. (7.96) is e ‚àû¬Ü¬à1¬áCA 1B¬à1 0:2¬à0:8 (7.104) where C,A, and Bare as follows: A¬à 51 0 0 21 20  10 12 435;B¬à0 012 435;C¬à¬â  110 ¬ä (7.105) For a ramp input, using Eq. (7.103), we have e ‚àû¬Ü¬à¬â lim t¬Æ‚àû¬â 1¬áCA 1B¬Ü¬ät¬áC A 1¬Ü2B¬ä¬à lim t¬Æ‚àû 0:8t¬á0:08¬Ü¬à‚àû (7.106) Skill-Assessment Exercise 7.7 PROBLEM: Find the steady-state error for a step input given the system represented in state space below. Calculate the steady-state error using both the Ô¨Ånal value theorem and input substitution methods. A¬à01  3  6/C20/C21 ;B¬à0 1/C20/C21 ;C¬à¬â11 ¬ä ANSWER: estep ‚àû¬Ü¬à2 3 The complete solution is at www.wiley.com/college/nise .362 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:20 SOLUTION: a.The simpli Ô¨Åed block diagram for the system is shown on the front endpapers. The steady-state error is given by e ‚àû¬Ü¬àlim s¬Æ0sE s¬Ü¬àlim s¬Æ0sR s¬Ü 1¬áG s¬Ü(7.107) From the block diagram, after pushing the potentiometer to the right past the summing junction, the equivalent forward transfer function is G s¬Ü¬à6:63K s s¬á1:71¬Ü s¬á100¬Ü(7.108) ToÔ¨Ånd the steady-state error for a step input, use R s¬Ü¬à1=salong with Eq. (7.108), and substitute these in Eq. (7.107). The result is e ‚àû¬Ü¬à0. ToÔ¨Ånd the steady-state error for a ramp input, use R s¬Ü 1=s2along with Eq. (7.108), and substitute these in Eq. (7.107). The result is e ‚àû¬Ü¬à25:79=K. ToÔ¨Ånd the steady-state error for a parabolic input, use R s¬Ü¬à1=s3along with Eq. (7.108), and substitute these in Eq. (7.107). The result is e ‚àû¬Ü¬à‚àû. b.Since the system is Type 1, a 10% error in the steady state must refer to a ramp input.This is the only input that yields a Ô¨Ånite, nonzero error. Hence, for a unit ramp input, e ‚àû¬Ü¬à0:1¬à1 Kv¬à 1:71¬Ü 100¬Ü 6:63K¬à25:79 K(7.109) from which K¬à257:9. You should verify that the value of Kis within the range of gains that ensures system stability. In the antenna control case study in the last chapter,the range of gain for stability was found to be 0 <K<2623 :29. Hence, the system is stable for a gain of 257.9. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives: Referring to the antenna azimuth position control system shown on the frontendpapers, Con Ô¨Åguration 2, do the following: a.Find the steady-state errors in terms of gain, K, for step, ramp, and parabolic inputs. b.Find the value of gain, K, to yield a 20% error in the steady state. Video Laser Disc Recorder: Steady-State Error Design via GainVideo Laser Disc Recorder: Steady-State Error Design via Gain As a second case study, let us look at a video laser disc focusing system for recording. PROBLEM: In order to record on a video laser disc, a 0.5 Œºm laser spot must be focused on the recording medium to burn pits that represent the program material. The small laser spot requires that the focusing lens be positioned to an accuracy of 0:1Œºm. A model of the feedback control system for the focusing lens is shown in Figure 7.22. Desired lens positionActual lens positionMotor & lens Filter DetectorPower amplifier + _0.12 (s + 40,000)K1(s + 800)K2K3 s2 FIGURE 7.22 Video laser disc recording: control system for focusing write beamCase Studies 363WEBC07 10/28/2014 17:51:21 The detector detects the distance between the focusing lens and the video disc by measuring the degree of focus as shown in Figure 7.23( a). Laser light re Ô¨Çected from the disc, D, is split by beam splitters B1andB2and focused behind aperture A. The remainder is reÔ¨Çected by the mirror and focuses in front of aperture A. The amount of light of each beam that passes through the aperture depends on how far the beam ‚Äôs focal point is from the aperture. Each side of the split photodiode, P, measures the intensity of each beam. Thus, as the disc ‚Äôs distance from the recording objective lens changes, so does the focal point of each beam. As a result, the relative voltage detected by each part of the split photodiode changes. When the beam is out of focus, one side of the photodiode outputs alarger voltage. When the beam is in focus, the voltage outputs from both sides of thephotodiode are equal. As i m p l i Ô¨Åed model for the detector is a straight line relating the differential voltage output from the two elements to the distance of the laser disc from nominal focus. Alinearized plot of the detector input-output relationship is shown in Figure 7.23( b) (a)L2, recording objective lensB1, polarizing beam splitterL1, condensing lensD-DiscQ‚ÄìX/Y plateB2, 50-50 beam splitterMirror A, pinhole apertureP, split photodiode 0.6 ‚Äì0.6‚Äì55 (b)Distance fro m nominal focus (Œºm)Differential voltage FIGURE 7.23 Video disc laser recording: a.focus detector optics;6b.linearized transfer function for focus detector6 6Isailovic ÃÅ,J .Videodisc and Optical Memory Technologies ,1st Edition ,ÓÄÇ1985. Reprinted by permission of Pearson Education, Inc., Upper Saddle River, NJ.364 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:21 Summary This chapter covered the analysis and design of feedback control systems for steady-state errors. The steady-state errors studied resulted strictly from the system con Ô¨Åguration. On the basis of a system con Ô¨Åguration and a group of selected test signals, namely steps, ramps, and parabolas, we can analyze or design for the system ‚Äôs steady-state error performance. The greater the number of pure integrations a system has in the forward path, the higher thedegree of accuracy, assuming the system is stable. The steady-state errors depend upon the type of test input. Applying the Ô¨Ånal value theorem to stable systems, the steady-state error for unit step inputs is e ‚àû ¬Ü ¬à1 1¬álim s¬Æ0Gs ¬Ü(7.110)(Isailovic ÃÅ,1985 ). Assume that a warp on the disc yields a worst-case disturbance in the focus of 10 t2Œºm. Find the value of K1K2K3in order to meet the focusing accuracy required by the system. SOLUTION: Since the system is Type 2, it can respond to parabolic inputs with Ô¨Ånite error. We can assume that the disturbance has the same effect as an input of 10 t2Œºm. TheLaplacetransform of 10 t2is 20=s3, or 20 units greater than the unit acceleration used to derive the general equation of the error for a parabolic input. Thus, e ‚àû¬Ü¬à20=Ka. ButKa¬àlim s¬Æ0s2G s¬Ü. From Figure 7.22, Ka¬à0:0024 K1K2K3. Also, from the problem statement, the error must be no greater than 0.1 Œºm. Hence, e ‚àû¬Ü¬à8333 :33=K1K2K3¬à0:1. Thus, K1K2K383333 :3, and the system is stable. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives: Given the video laser disc recording system whose block diagram is shown in Figure 7.24, do the following: a.If the focusing lens needs to be positioned to an accuracy of 0:005Œºm,Ô¨Ånd the value of K1K2K3i ft h ew a r po nt h ed i s cy i e l d saw o r s t - c a s ed i s t u r b a n c ei nt h ef o c u s of 15 t2Œºm. b.Use the Routh-Hurwitz criterion to show that the system is stable when the conditionsofa.are met. c. Use MATLAB to show that the system is stable when the conditionsofa.are met. Desired lens positionActual lens positionMotor & lens Filter DetectorPower amplifier + _0.2(s + 20,000)K1(s + 600)K2K3 s2 FIGURE 7.24 Video laser disc recording focusing systemSummary 365WEBC07 10/28/2014 17:51:22 The steady-state error for ramp inputs of unit velocity is e‚àû ¬Ü ¬à1 lim s¬Æ0sG s ¬Ü(7.111) and for parabolic inputs of unit acceleration, it is e‚àû ¬Ü ¬à1 lim s¬Æ0s2Gs ¬Ü(7.112) The terms taken to the limit in Eqs. (7.110) through (7.112) are called static error constants . Beginning with Eq. (7.110), the terms in the denominator taken to the limit are called the position constant, velocity constant, and acceleration constant , respectively. The static error constants are the steady-state error speci Ô¨Åcations for control systems. By specifying a static error constant, one is stating the number of pure integrations in the forward path, the test signal used, and the expected steady-state error. Another deÔ¨Å nition covered in this chapter was that of system type . The system type is the number of pure integrations in the f orward path, assuming a unity feedback system. Increasing the system type decreases the steady-state error as long as the systemremains stable. Since the steady-state error is, for the most part, inversely proportional to the static error constant, the larger the static error constant, the smaller the steady-state error.Increasing system gain increases the static error constant. Thus, in general, increasingsystem gain decreases the steady-state error as long as the system remains stable. Nonunity feedback systems were handled by deriving an equivalent unity feedback system whose steady-state error characteristics followed all previous development. The method was restricted to systems where input and output units are the same. We also saw how feedback decreases a system ‚Äôs steady-state error caused by disturbances. With feedback, the effect of a disturbance can be reduced by system gain adjustments. Finally, for systems represented in state space, we calculated the steady-state error using the Ô¨Ånal value theorem and input substitution methods. In the next chapter, we will examine the root locus, a powerful tool for the analysis and design of control systems. Review Questions 1.Name two sources of steady-state errors. 2.A position control, tracking with a constant difference in velocity, would yield how muchposition error in the steady state? 3.Name the test inputs used to evaluate steady-state error. 4.How many integrations in the forward path are required in order for there to be zerosteady-state error for each of the test inputs listed in Question 3? 5.Increasing system gain has what effect upon the steady-state error? 6.For a step input, the steady-state error is approximately the reciprocal of the static errorconstant if what condition holds true? 7.What is the exact relationship between the static error constants and the steady-stateerrors for ramp and parabolic inputs? 8.What information is contained in the speci Ô¨Åcation K p¬à10;000? 9.DeÔ¨Åne system type .366 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:22 10.The forward transfer function of a control system has three poles at  1; 2;and 3. What is the system type? 11.What effect does feedback have upon disturbances? 12.For a step input disturbance at the input to the plant, describe the effect of controller and plant gain upon minimizing the effect of the disturbance. 13.Is the forward-path actuating signal the system error if the system has nonunity feedback? 14.How are nonunity feedback systems analyzed and designed for steady-state errors? 15.DeÔ¨Åne, in words, sensitivity and describe the goal of feedback-control-system engineering as it applies to sensitivity. 16.Name two methods for calculating the stea dy-state error for systems represented in state space. Problems 1.For the unity feedback system shown in Figure P7.1,where Gs ¬Ü¬à450s¬á8 ¬Ü s¬á12 ¬Ü s¬á15 ¬Ü ss¬á38 ¬Ü s2¬á2s¬á28 ¬Ü Ô¨Ånd the steady-state errors for the following test inputs: 25ut ¬Ü;37tu t ¬Ü;47t2ut ¬Ü. [Section: 7.2] E(s)G(s)C(s) R(s)+ ‚Äì FIGURE P7.1 2.Figure P7.2 show st h er a m pi n p u t r(t) and the output c(t) of a system. Assuming the output ‚Äôs steady state can be approximated by a ramp, Ô¨Ånd [Section: 7.1] a.the steady-state error; b.the steady-state error if the input becomes rt ¬Ü¬à tu t ¬Ü. t(sec)6Mag 4 3r(t) c(t) FIGURE P7.23.For the unity feedback system shown in Figure P7.1, where Gs ¬Ü¬à60s¬á3 ¬Ü s¬á4 ¬Ü s¬á8 ¬Ü s2s¬á6 ¬Ü s¬á17 ¬Ü Ô¨Ån dt h es t e a d y - s t a t ee r r o ri ft h ei n p u ti s8 0 t2ut ¬Ü. [Section: 7.2] 4.For the system shown in Figure P7.3, what steady-stateerror can be expected for the following test inputs: 10ut ¬Ü;10tu t ¬Ü;10t 2ut ¬Ü. [Section: 7.2] C(s) R(s)+ ‚Äì+ ‚Äì++ ‚Äì1 3 2 6ss s + 4 FIGURE P7.3 5.For the unity feedback system shown in Figure P7.1, where Gs ¬Ü¬à500 s¬á28 ¬Ü s2¬á8s¬á12 ¬Ü Ô¨Ånd the steady-state error for inputs of 20 u(t), 60 tu(t), and 81 t2ut ¬Ü. [Section: 7.3] 6.An input of 25 t3ut ¬Üis applied to the input of a Type 3 unity feedback system, as shown in Figure P7.1,Problems 367WEBC07 10/28/2014 17:51:23 where Gs ¬Ü¬à210s¬á4 ¬Ü s¬á6 ¬Ü s¬á11 ¬Ü s¬á13 ¬Ü s3s¬á7 ¬Ü s¬á14 ¬Ü s¬á19 ¬Ü Find the steady-state error in position. [Section: 7.3] 7.The steady-state error in velocity of a system is de Ô¨Åned to be dr dt dc dt/C18/C19 /C12/C12/C12/C12 t¬Æ‚àû where ris the system input, and cis the system output. Find the steady-state error in velocity for an input of t3u(t) to a unity feedback system with a forward transfer function of [Section: 7.2] Gs ¬Ü¬à100 s¬á1 ¬Ü s¬á2 ¬Ü s2s¬á3 ¬Ü s¬á10 ¬Ü 8.What is the steady-state error for a step input of 15 unitsapplied to the unity feedback system of Figure P7.1,where [Section: 7.3] Gs ¬Ü¬à 1020 s¬á13 ¬Ü s¬á26 ¬Ü s¬á33 ¬Ü s¬á65 ¬Ü s¬á75 ¬Ü s¬á91 ¬Ü 9.A system has Kp¬à4. What steady-state error can be expected for inputs of 70 u(t) and 70 tu(t)? [Section 7.3] 10.For the unity feedback system shown in Figure P7.1,where [Section: 7.3] Gs ¬Ü¬à5000 ss¬á75 ¬Ü a.What is the expected percent overshoot for a unit stepinput? b.What is the settling time for a unit step input? c.What is the steady-state error for an input of 5 u(t)? d.What is the steady-state error for an input of 5 tu(t)? e.What is the steady-state error for an input of 5 t 2ut ¬Ü? 11.Given the unity feedback system shown in Figure P7.1, where Gs ¬Ü¬à500000 s¬á7 ¬Ü s¬á20 ¬Ü s¬á45 ¬Ü ss¬á30 ¬Ü s¬áŒ± ¬Ü s¬á50 ¬Ü Ô¨Ånd the value of Œ±to yield a Kv¬à35000. [Section: 7.4] 12.For the unity feedback system of Figure P7.1, where Gs ¬Ü¬àKs¬á2 ¬Ü s¬á4 ¬Ü s¬á6 ¬Ü s2s¬á5 ¬Ü s¬á7 ¬Ü Ô¨Ånd the value of Kto yield a static error constant of 10,000. [Section: 7.4]13.For the system shown in Figure P7.4, [Section: 7.3] a.Find Kp,Kv, and Ka. b.Find the steady-state error for an input of 50 u(t), 50tu(t), and 50 t2ut ¬Ü. c.State the system type. 5 (s + 3)C(s) R(s)+ ‚Äì‚Äìs(s + 1)(s +2 ) FIGURE P7.4 14.A Type 3 unity feedback system has rt ¬Ü¬à 10t3applied to its input. Find the steady-state position error for this input if the forward transfer function is [Section: 7.3] Gs ¬Ü¬à1030 s2¬á8s¬á23/C0/C1 s2¬á21s¬á18/C0/C1 s3s¬á6 ¬Ü s¬á13 ¬Ü 15.Find the system type for the system of Figure P7.5.[Section: 7.3] ‚Äì‚Äì+ C(s) 10R(s) s(s + 5)100(s + 2) s1000 FIGURE P7.5 16.What are the restrictions on the feedforward transferfunction G 2(s) in the system of Figure P7.6 to obtain zero steady-state error for step inputs if: [Section: 7.3] a.G1(s) is a Type 0 transfer function; b.G1(s) is a Type 1 transfer function; c.G1(s) is a Type 2 transfer function? G2(s) G1(s)) 3 (20 +s sR(s) C(s) E(s)+++ ‚Äì FIGURE P7.6 17.The steady-state error is de Ô¨Åned to be the difference in position between input and output as time approaches368 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:24 inÔ¨Ånity. Let us de Ô¨Åne a steady-state velocity error, which is the difference in velocity between input and output. Derive an expression for the error in velocity, _e‚àû ¬Ü ¬à _r‚àû ¬Ü   _c‚àû ¬Ü, and complete Table P7.1 for the error in velocity. [Sections: 7.2, 7.3] 18.For the system shown in Figure P7.7, [Section: 7.4] a.What value of Kwill yield a steady-state error in position of 0.01 for an input of 1 =10 ¬Ü t? b.What is the Kvfor the value of Kfound in Part a? c.What is the minimum possible steady-state positionerror for the input given in Part a? C(s) E(s) K(s + 7) s(s + 5)(s + 8)(s + 12)R(s) + ‚Äì FIGURE P7.7 19.Given the unity feedback system of Figure P7.1, where Gs ¬Ü¬àKs¬áa ¬Ü ss¬á2 ¬Ü s¬á15 ¬Ü Ô¨Ånd the value of Kaso that a ramp input of slope 30 will yield an error of 0.005 in the steady state when comparedto the output. [Section: 7.4] 20.Given the system of Figure P7.8, design the value of K so that for an input of 100 tu(t), there will be a 0.01 error in the steady state. [Section: 7.4] R(s) C(s) K s(s + 2) 5s K+ ‚Äì‚Äì FIGURE P7.821.Find the value of Kfor the unity feedback system shown in Figure P7.1, where Gs ¬Ü¬àKs¬á3 ¬Ü s2s¬á7 ¬Ü if the input is 10 t2ut ¬Ü, and the desired steady-state error is 0.061 for this input. [Section: 7.4] 22.The unity feedback system of Figure P7.1, where Gs ¬Ü¬àKs2¬á3s¬á30/C0/C1 sns¬á5 ¬Ü is to have 1/6000 error between an input of 10 tu(t) and the output in the steady state. [Section: 7.4] a.Find Kandnto meet the speci Ô¨Åcation. b.What are Kp,Kv, and Ka? 23.For the unity feedback system of Figure P7.1,where [Section: 7.3] Gs ¬Ü¬àKs2¬á6s¬á6/C0/C1 s¬á5 ¬Ü2s¬á3 ¬Ü a.Find the system type. b.What error can be expected for an input of 12 u(t)? c.What error can be expected for an input of 12 tu(t)? 24.For the unity feedback system of Figure P7.1, where Gs ¬Ü¬àKs¬á13 ¬Ü s¬á19 ¬Ü ss¬á6 ¬Ü s¬á9 ¬Ü s¬á22 ¬Ü Ô¨Ånd the value of Kto yield a steady-state error of 0.4 for a ramp input of 27 tu(t). [Section: 7.4] 25.Given the unity feedback system of Figure P7.1, where Gs ¬Ü¬àKs¬á6 ¬Ü s¬á2 ¬Ü s2¬á10s¬á29 ¬Ü Ô¨Ånd the value of Kto yield a steady-state error of 8%. [Section: 7.4] 26.For the unity feedback system of Figure P7.1, where Gs ¬Ü¬àK ss¬á4 ¬Ü s¬á8 ¬Ü s¬á10 ¬Ü Ô¨Ånd the minimum possible steady-state position error if a unit ramp is applied. What places the constraint upon the error? 27.The unity feedback system of Figure P7.1,where Gs ¬Ü¬àKs¬áŒ± ¬Ü s¬áŒ≤ ¬Ü2TABLE P7.1 Type Ramp ParabolaInputStep012Problems 369WEBC07 10/28/2014 17:51:25 is to be designed to meet the following speci Ô¨Åcations: steady-state error for a unit step input =0.1; damping ratio=0.5; natural frequency ¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 10p . Find K,Œ±, and Œ≤. [Section: 7.4] 28.A second-order, unity feedback system is to follow a ramp input with the following speciÔ¨Å cations: the steady-state output position shall differ from the input position by 0.01 of the input velocity; the naturalfrequency of the closed-loop system shall be 10 rad/s.Find the following: a.The system type b.The exact expression for the forward-path transferfunction c.The closed-loop system ‚Äôs damping ratio 29.The unity feedback system of Figure P7.1 has a transfer function G s¬Ü¬à C s¬Ü E s¬Ü¬àK s s¬áŒ±¬Üa n di st of o l l o war a m p input, r(t)=tu(t), so that the steady-state output position differs from the input position by 0.01 of the input velocity (e.g., e ‚àû¬Ü¬à1 Kv¬à0:01). The natural frequency of the closed-loop system will be œân¬à5r a d=s. [Section: 7.4] Find the following: a.The system type b.The values of KandŒ± c.The closed-loop system ‚Äôs damping ratio, Œ∂ d.IfKis reduced to 4 and Œ±=0.4,Ô¨Ånd the corresponding new values of e ‚àû¬Ü,œân, and Œ∂. 30.The unity feedback system of Figure P7.1, where Gs ¬Ü¬àKs¬áŒ± ¬Ü ss¬áŒ≤ ¬Ü is to be designed to meet the following requirements: The steady-state position error for a unit ramp inputequals 1/10; the closed-loop poles will be locatedat 1j1. Find K,Œ±,a n dŒ≤ in order to meet the speci Ô¨Åcations. [Section: 7.4] 31.Given the unity feedback control system of Figure P7.1,where Gs ¬Ü¬à K sns¬áa ¬Ü Ô¨Ånd the values of n,K,a n da in order to meet speci Ô¨Å- cations of 12% overshoot and Kv¬à110. [Section: 7.4] 32.Given the unity feedback control system of Figure P7.1,where Gs ¬Ü¬àK ss¬áa ¬ÜÔ¨Ånd the following: [Section: 7.4] a.Kandato yield Kv¬à1000 and a 20% overshoot b.Kandato yield a 1% error in the steady state and a 10% overshoot. 33.Given the system in Figure P7.9, Ô¨Ånd the following: [Section: 7.3] a.The closed-loop transfer function b.The system type c.The steady-state error for an input of 5u (t) d.The steady-state error for an input of 5tu (t) e.Discuss the validity of your answers to Parts candd. R(s) + _ s2 (s + 1)1 + _ s2 (s + 3)1 C(s) s1 FIGURE P7.9 34.Repeat Problem 33 for the system shown in Figure P7.10.[Section: 7.3] R(s) + _2s(s + 1)(s + 3)(s + 4)10 C(s) 2s+ _ FIGURE P7.10 35.For the system shown inFigure P7.11, use MATLAB to Ô¨Ånd the following: [Section: 7.3] a.The system type b.K p,Kv, and Ka c.The steady-state error for inputs of100u(t), 100 tu(t), and 100 t 2u(t) + (s + 12)(s + 32)(s + 68)6(s + 9)(s + 17) C(s) 13+ _ s(s + 6)(s + 12)(s + 14)(s + 9) s + 71_ _ FIGURE P7.11370 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:25 36.The system of Figure P7.12 is to have the following speci Ô¨Åcations: Kv¬à20;Œ∂¬à0:7. Find the values of K1 andKfrequired for the speci Ô¨Åcations of the system to be met. [Section: 7.4] K f s5 s(s + 2)Óáü + ‚ÄìK1 ‚ÄìÓáü + i(s) 0(s) FIGURE P7.12 37.The transfer function from elevator de Ô¨Çection to altitude change in a Tower Trainer 60 Unmanned Aerial Vehicle is Ps ¬Ü ¬àhs ¬Ü Œ¥s ¬Üe ¬à 34:16s3 144:4s2¬á7047 s¬á557:2 s5¬á13:18s4¬á95:93s3¬á14:61s2¬á31:94s An autopilot is built around the aircraft as shown inFigure P7.13, with Fs ¬Ü¬à Hs ¬Ü¬à 1 and Gs ¬Ü¬à0:00842 s¬á7:895 ¬Ü s2¬á0:108s¬á0:3393/C0/C1 s¬á0:07895 ¬Ü s2¬á4s¬á8 ¬Ü (Barkana ,2005 ). The steady-state error for a ramp input in this system is ess¬à25. Find the slope of the ramp input. F(s) G(s) P(s)R(s) C(s)+ ‚Äì H(s) FIGURE P7.13 38.Find the total steady-state error due to a unit step input and a unit step disturbance in the system of Figure P7.14. [Section: 7.5] 1 s + 5100 s + 2C(s)D(s) R(s)+ ‚Äì++ FIGURE P7.1439.Design the values of K1and K2in the system of Figure P7.15 to meet the following speci Ô¨Åcations: Steady-state error component due to a unit stepdisturbance is  0.00001; steady-state error component due to a unit ramp input is 0.002. [Section: 7.5] C(s) K1(s + 2) (s + 3)K2 s(s + 4)D(s) +R(s)+ ‚Äì+ FIGURE P7.15 40.In Figure P7.16, let Gs ¬Ü¬à 5a n d Ps ¬Ü¬à7 s¬á2. a.Calculate the steady-state error due to a command input Rs ¬Ü¬à3 swith Ds ¬Ü¬à 0. b.Verify the result of Part a using Simulink. c.Calculate the steady-state error due to a disturbance input Ds ¬Ü¬à 1 swith Rs ¬Ü¬à 0. d.Verify the result of Part c using Simulink. e.Calculate the total steady-state error due to acommand input Rs ¬Ü¬à 3 sand a disturbance Ds ¬Ü¬à  1 sapplied simultaneously. f.Verify the result of Part e using Simulink. G(s) P(s)+ ‚ÄìR(s) C(s)D(s ) ++ FIGURE P7.16 41.Derive Eq. (7.72) in the text, which is the Ô¨Ånal value of the actuating signal for nonunity feedback systems. [Section: 7.6] 42.For each system shown in Figure P7.17, Ô¨Ånd the following: [Section: 7.6] a.The system type b.The appropriate static error constant c.The input waveform to yield a constant error (problem continues )Problems 371WEBC07 10/28/2014 17:51:26 (Continued ) d.The steady-state error for a unit input of the waveform found in Part c e.The steady-state value of the actuating signal. C(s) s(s + 2)10(s + 10) (s + 4) System 1 C(s) System 2R(s)+ ‚Äì R(s)+ ‚Äìs(s + 2)10(s + 10) (s + 1) FIGURE P7.17 Closed-loop systems with nonunity feedback 43.For each system shown in Figure P7.18, Ô¨Ånd the appro- priatestaticerrorconstantaswellasthesteady-stateerror, r‚àû ¬Ü   c‚àû ¬Ü, for unit step, ramp, and parabolic inputs. [Section: 7.6] R(s) (s+ 3)(s+7 )s+4 C(s) 5+ _20R(s) (s+ 3)(s+7 )s+4 C(s) 10+ _5 10System 1 System 2 FIGURE P7.18 44.Given the system shown in Figure P7.19, Ô¨Ånd the following: [Section: 7.6] a.The system type b.The value of Kto yield 0.1% error in the steady state. R(s)+ ‚Äì(s + 1) s2(s + 2)C(s) K FIGURE P7.1945.For the system shown in Figure P7.20, [Section: 7.6] a.What is the system type? b.What is the appropriate static error constant? c.What is the value of the appropriate static error constant? d.What is the steady-state error for a unit step input? R(s)+ ‚ÄìK(s + 1) s2(s + 4)C(s) (s + 5) (s + 2) FIGURE P7.20 46.For the system shown in Figure P7.21, use MATLAB to Ô¨Ånd the following for K¬à10, and K¬à106: [Section: 7.6] a.The system type b.Kp,Kv, and Ka c.The steady-state error for inputs of30u(t), 30 tu(t), and 30 t 2u(t) R(s)+ ‚ÄìK(s + 1)(s + 2) s2(s + 4)(s + 5)(s + 6)C(s) (s + 6) (s + 8)(s + 9) FIGURE P7.21 47.A dynamic voltage restorer (DVR) is a device that isconnected in series to a power supply. It continuouslymonitors the voltage delivered to the load, and compen- sates voltage sagsbyapplying thenecessary extravoltage to maintain the load voltage constant. In the model shown in Figure P7.22, u rrepresents the desired reference voltage, uois the output voltage, andZLis the load impedance. All other parameters are internal to the DVR ( Lam,2004 ). a.Assuming ZL¬à1 sCL, and Œ≤6¬à1,Ô¨Ånd the system ‚Äôs type. b.Find the steady-state error to a unit step input as afunction of Œ≤. 1KTKv+Km1 Ls1 Cs 1 ZL‚àí ‚àíŒ± ‚àíŒ≤ur uoœÑs FIGURE P7.22 DVR Model372 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:27 48.Derive Eq. (7.69) in the text. [Section: 7.6] 49.Given the system shown in Figure P7.23, do the following: [Section: 7.6] a.Derive the expression for the error,Es ¬Ü¬à Rs ¬Ü   Cs ¬Ü, in terms of R(s) and D(s). b.Derive the steady-state error, e ‚àû ¬Ü,i fR(s) and D(s) are unit step functions. c.Determine the attributes of G1s ¬Ü;G2s ¬Ü,a n d H(s) necessary for the steady-state error to becomezero. C(s)D(s) G2(s)+ R(s)+ ‚Äì+ G1(s) H(s) FIGURE P7.23 System with input and disturbance 50.Given the system shown in Figure P7.24, Ô¨Ånd the sensitivity of the steady-state error to parameter a. Assume a step input. Plot the sensitivity as a functionof parameter a. [Section: 7.7] C(s) s(s + 2)(s + 5)K (s + a)R(s)+ ‚Äì FIGURE P7.24 a. Show that the sensitivity to plant changes in thesystem of Figure P7.13 is S T:P¬àP TŒ¥T Œ¥P¬à1 1¬áLs ¬Ü where Ls ¬Ü¬à Gs ¬ÜPs ¬ÜHs ¬Üand Ts ¬Ü¬àCs ¬Ü Rs ¬Ü¬àFs ¬Ü Hs ¬ÜLs ¬Ü 1¬áLs ¬Ü: b.Show that ST:Ps ¬Ü ¬áTs ¬ÜH s¬Ü Fs ¬Ü¬à1 for all values of s. 52.In Figure P7.13, P s¬Ü¬à5 s;H s¬Ü¬à1 Ts ¬Ü¬àCs ¬Ü Rs ¬Ü¬à200K s¬á1 ¬Ü s¬á3 ¬Ü s2¬á2s¬á20 ¬Üand ST:P¬àP TŒ¥T Œ¥P¬às2¬á2s s2¬á2s¬á20 a.Find F(s) and G(s). b.Find the value of Kthat will result in zero steady-state error for a unit step input. 53.For the system shown in Figure P7.25, Ô¨Ånd the sensitivity of the steady-state error for changes in K1 and in K2,w h e nK 1¬à100 and K2¬à0:1. Assume step inputs for both the input and the disturbance. [Section: 7.7] C(s)D(s) +R(s)+ ‚Äì+K1 s + 1K2 s + 2 FIGURE P7.25 System with input and disturbance 54.Given the block diagram of the active suspension system shown in Figure P5.36, ( Lin,1997 ) a.Find the transfer function from a road disturbance r to the error signal e. b.Use the transfer function in Part atoÔ¨Ånd the steady- state value of efor a unit step road disturbance. c.Use the transfer function in Part atoÔ¨Ånd the steady-state value of efor a unit ramp road disturbance. d.From your results in Parts bandc, what is the system ‚Äôs type for e? 55.For each of the following closed-loop systems, Ô¨Ånd the steady-state error for unit step and unit ramp inputs. Use both the Ô¨Ånal value theorem and input substitution methods. [Section: 7.8] a._x¬à 5 4 2  3 10 0  11  52 435x¬á1 102 435r;y¬à  121/C2/C3 x b._x¬à01 0  5  97  10 02435x¬á0 012 435r;y¬à¬â100 ¬äx c._x¬à 9 5 1 10  2  3 2 52435x¬á2 352 435r;y¬à¬â1 24 ¬äxProblems 373WEBC07 10/28/2014 17:51:27 56.A simpli Ô¨Åed model of the steering of a four-wheel drive vehicle is shown in Figure P7.26. Gf K r* GrŒ¥f u (Œ¥r) +++e r ‚Äì FIGURE P7.26 Steering model for a four-wheel drive vehicle7 In this block diagram, the output ris the vehicle ‚Äôs yaw rate, while Œ¥fandŒ¥rare the steering angles of the front and rear tires, respectively. In this model, r* s¬Ü¬às 300¬á0:8 s 10¬á1;Gf s¬Ü¬àh1s¬áh2 s2¬áa1s¬áa2 Gr s¬Ü¬àh3s¬áb1 s2¬áa1s¬áa2 andK(s) is a controller to be designed. ( Yin,2007 ). a.Assuming a step input for Œ¥f,Ô¨Ånd the minimum system type of the controller K(s) necessary so that in steady-state the error, as de Ô¨Åned by the signal ein Figure P7.26, is zero if at all possible. b.Assuming a step input for Œ¥f,Ô¨Ånd the system type of the controller K(s) necessary so that in steady state the error as de Ô¨Åned by Œ¥f ‚àû¬Ü r ‚àû¬Üis zero if at all possible. 57.Glycolysis is a feedback process through which living cells use glucose to generate adenosine triphosphate(ATP), necessary for cell operations. A linearized glycol-ysis model ( Chandra, 2011 ) is given by _Œîx _Œîy/C20/C21 ¬à ka ¬ág¬áh q¬á1¬Ük qa g q¬á1¬Ü¬áqh/C20/C21Œîx Œîy/C20/C21 ¬á0 1/C20/C21 Œ¥ where Œ¥is the perturbation (disturbance input) on ATP production, Œîyis the change in ATP level (output). Œ±>0 is the cooperativity of ATP binding to PFK, g>0 is the feedback strength of ATP on PK (PFK and PK are two different types of glycolytic enzymes), k>0 is the intermediate reaction rate, q>0i st h eautocatalytic stoichiometry, and h>0 is the feedback strength of ATP on the PFK enzyme. a.Since in this system Œ¥is a disturbance input, zero steady-state error is achieved when Œîy Œ¥¬à0. Show that in steady state _Œîx¬à0;_Œîy¬à0¬Ü,Œîy Œ¥¬à1 a h: b.Use the Routh-Hurwitz stability criterion to show thatthe system will be closed-loop stable as long as 0<h a<k¬ág q¬á1¬Ü q c.Assuming that his the only parameter of choice for steady-state error adjustments, show that zerosteady-state error is not achievable. 58.As part of the development of a textile cross-lappermachine ( Kuo, 2010 ), a torque input, u t¬Ü¬à10 t<50  15 0 t<100/C26/C27 , is applied to the motor of one of the movable racks embedded in a feedbackloop. The corresponding velocity output response isshown in Figure P7.27. a.What is the open-loop system ‚Äôs type? b.What is the steady-state error? c.What would be the steady-state error for a ramp input? 0.04 0.030.02 0.01 0 ‚Äì0.01 ‚Äì0.02‚Äì0.03‚Äì0.04 0 10 20 30 40 50 60 70 80 90 100 Time(sec)Velocity of the movable rack (m/sec) FIGURE P7.27 Velocity output response8 59.The block diagram in Figure P7.28 represents a motor driven by an ampli Ô¨Åer with double-nested tachometer feedback loops ( Mitchell ,2010 ).7Yin, G., Chen, N., and Li, P. Improving Handling Stability Performance of Four-Wheel Steering Vehicle via Œº-Synthesis Robust Control. IEEE Transactions on Vehicular Technology , vol. 56, no. 5, 2007, pp. 2432‚Äì Fig. 2, p. 2434. IEEE Transactions on Vehicular Technology by Vehicular Technology Society; Institute of Electrical and ElectronicsEngineers; IEEE Vehicular Technology Group. Reproduced with permis- sion of Institute of Electrical and Electronics Engineers, in the format Republish in a book via Copyright Clearance Center.8Kuo, C.-F. J., Tu, H.-M., and Liu, C.-H. Dynamic Modeling and Control of a Current New Horizontal Type Cross-Lapper Machine. Textile Research Journal , Vol. 80 (19), pp. 2016 ‚Äì2027, Figure 5. Copyright ÓÄÇ2010. Reprinted by Permission of SAGE.374 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:28 a.Find the steady-state error of this system to a step input. b.What is the system type? K1I O K2 1+ sT2+ ‚ÄìK3 1+ sT3 sv3 sv2 Œ≤K4 1+ sT4+ ‚Äì+ ‚Äì FIGURE P7.289 60.PID control, which is discussed in Chapter 9, may be recommended for Type 3 systems when the output in a feedback system is required to perfectly track a parabolic as well as step and ramp reference signals(Papadopoulos, 2013 ). In the system of Figure P7.29, the transfer functions of the plant, G P(s), and the recommended controller, GC(s), are given by: GP s¬Ü¬à127e 0:2s s s¬á1¬Ü s¬á2¬Ü s¬á5¬Ü2 s¬á10¬Ü GC s¬Ü¬à 92:9s2¬á13:63s¬á1¬Ü 97:6s2 0:1s¬á1¬Ü Use Simulink to model this systemand plot its response (from 0 to 300 seconds) to a unit-step reference input, r(t), applied at t=0, and (on the same graph) to a disturbance, d(t)=0.25 r (t), applied at t=150 seconds. What are the values of the steady-state error dueto the reference input and due to thedisturbance? What about the relative sta-bility of this Type 3 system as evidenced by the percent overshoot in response to the unit-step reference input? ++ ‚ÄìR(s)C(s) GC (s)E(s)+D(s) GP (s) FIGURE P7.29 61.A Type 3 feedback controlsystem (Papadopoulos, 2013 ) was presented in Problem 60. Modify theSimulink model you developed in that problem to plot its response (from 0 to100 seconds) to a unit-ramp referenceinput, r(t)=tu(t) , applied at t=0, and (on the same graph) to a disturbance, d(t)=0.25tu( t), applied at t=50 seconds. What are the values of thesteady-state position error due to thereference-input and disturbance ramps? Copy this model and paste it in the same Ô¨Åle. Then, in that copy, change the reference input to a unit parabola,r(t)=0.5t 2u(t), applied at t=0, and the disturbance to d(t)=0.125 t2u(t), applied at t=50 seconds, and plot, on a new graph (Scope 1),the system ‚Äôs response to these parabolic signals. DESIGN PROBLEMSDESIGN PROBLEMS 62.Motion control, which includes position or force control, is used in robotics and machining. Forcecontrol requires the designer to consider two phases:contact and noncontact motions. Figure P7.30(a )i sa diagram of a mechanical system for force controlunder contact motion. A force command, F cmd(s), is the input to the system, while the output, F(s), is the controlled contact force. ‚Äì+ + Fcmd(s) K2K1Force sensorElectric motorRotational direction Des+KeEnvironment (D es+Ke) (b)(a) F(s)Fcmd(s)F(s) (s)œâ ref(s)œâ ‚Äì1 s1 s.Œ∏(s)Œ∏(s) FIGURE P7.30 a.Force control mechanical loop under contact motion;10b.block diagram10 9Mitchell, R. J. More Nested Velocity Feedback Control. IEEE 9th International Conference on Cybernetic Intelligent Systems (CIS) , 2010. Figure 5, page 3 of the paper.10Ohnishi, K.; Shibata, M.; and Murakami, T. Motion Control for Advanced Mechatronics. IEEE/ASME Transactions on Mechatronics , vol. 1, no. 1, March 1996, Figures 14 & 16, p. 62. IEEE/AS ME transactions on mechatronics: a joint publication of the IEEE Industrial Electronics Society and the ASME Dynamic Systems and Control Division by Institute of Electrical andElectronics Engineers; IEEE Industrial Electronics Society; AmericanSociety of Mechanical Engineers. Dynamic Systems and Control Division Reproduced with permission of IEEE in the format Republish in a book via Copyright Clearance Center.Problems 375WEBC07 10/28/2014 17:51:28 In the Ô¨Ågure a motor is used as the force actuator. The force output from the actuator is applied to the object through a force sensor. A block diagram repre-sentation of the system is shown in Figure P7.30( b). K 2is velocity feedback used to improve the transient response. The loop is actually implemented by anelectrical loop (not shown) that controls the armaturecurrent of the motor to yield the desired torque at theoutput. Recall that T m¬àKtia(Ohnishi ,1996). Find an expression for the range of K2to keep the steady-state force error below 10% for ramp inputs of commandedforce. 63.An open-loop swivel controller and plant for anindustrial robot has the transfer function G es ¬Ü¬àœâos ¬Ü Vis ¬Ü¬àK s¬á10 ¬Ü s2¬á4s¬á10 ¬Ü where œâos ¬Üis the Laplace transform of the robot ‚Äôs angular swivel velocity and Vi(s) is the input voltage to the controller. Assume Ge(s) is the forward transfer function of a velocity control loop with an inputtransducer and sensor, each represented by a constantgain of 3 ( Schneider ,1992 ). a.Find the value of gain, K, to minimize the steady- state error between the input commanded angularswivel velocity and the output actual angular swivelvelocity. b.What is the steady-state error for the value of K found in Part a? c.F o rw h a tk i n do fi n p u td o e st h ed e s i g ni nP a r t a apply? 64.Packet information Ô¨Çow in a router working under TCP/IP can be modeled using the linearized transferfunction Ps ¬Ü¬à Qs ¬Ü fs ¬Ü¬àC2 2Ne sR s¬á2N R2C/C18/C19 s¬á1 R/C18/C19 where C=link capacity (packets/second) N=load factor (number of TCP sessions) Q=expected queue length R=round trip time (second) p=probability of a packet drop The objective of an active queue management (AQM) algorithm is to automatically choose a packet-dropprobability, p, so that the queue length is maintained at a desired level. This system can be represented bythe block diagram of Figure P7.13 with the plant modelin the P(s) block, the AQM algorithm in the G(s) block, and Fs ¬Ü¬à Hs ¬Ü¬à 1. Several AQM algorithms are available, but one that has received special attention inthe literature is the ran dom early detection (RED) algorithm. This algorithm can be approximated with Gs ¬Ü¬à LK s¬áK,w h e r e LandKare constants ( Hollot , 2001 ). Find the value of Lrequired to obtain a 10% steady-state error for a unit step input when C=3750 packets/s, N=50 TCP sessions, R=0.1 s, and K=0.005. 65.In Figure P7.16, the plant, Ps ¬Ü ¬à48;500 s2¬á2:89s;represents the dynamics of a robotic manipulator joint. The system ‚Äôso u t p u t , C(s), is the joint ‚Äôs angular position (Low, 2005 ). The system is controlled in a closed- loop con Ô¨Åguration as shown with Gs ¬Ü¬à KP¬áKI s,a proportional-plus-integral (PI) controller to be dis-cussed in Chapter 9. R(s)i st h ej o i n t ‚Äôs desired angular position. D(s) is an external disturbance, possibly caused by improper dynamics modeling, Coulombfriction, or other external f orces acting on the joint. a.Find the system ‚Äôs type. b.Show that for a step disturbance input, e ss¬à0 when KI6¬à0. c.Find the value of KIthat will result in ess¬à5%for a parabolic input. d.Using the value of KIfound in Part c,Ô¨Ånd the range ofKPfor closed-loop stability. PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 66.Control of HIV/AIDS. Consider the HIV infection model of Problem 68 in Chapter 6 and its block diagram in Figure P6.17 ( Craig ,2004 ). a.Find the system ‚Äôs type if G(s) is a constant. b.It was shown in Problem 68, Chapter 6, that whenGs ¬Ü¬à Kthe system will be stable when K<2:0410  4. What value of Kwill result in a unit step input steady-state error of 10%? c.It is suggested that to reduce the steady-state errorthe system ‚Äôs type should be augmented by making Gs ¬Ü¬àK s. Is this a wise choice? What is the resulting stability range for K? 67.Hybrid vehicle. Figure P7.31 shows the block diagram of the speed control of an HEV taken from Figure P5.53,376 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:29 and rearranged as a unity feedback system ( Preitl , 2007). Here the system output is C s¬Ü¬àKSSV s¬Ü,t h e output voltage of the speed sensor/transducer. UC (s) E (s)+ _R (s) C(s)0.11 (s + 0.6) s (s + 0.5173) + 5 (s + 0.6) (s + 0.01908)GSC(s) FIGURE P7.31 a.Assume the speed controller is given as GSC s¬Ü¬àKPSC. Find the gain, KPSC, that yields a steady-state error, estep ‚àû¬Ü¬à1%. b.Now assume that in order to reduce the steady-stateerror for step inputs, integration is added to thecontroller yielding G SC s¬Ü¬àKPSC¬á KISC=s¬Ü¬à 100¬á KISC=s¬Ü¬Ü. Find the value of the integral gain, KISC,thatresultsinasteady-stateerror, eramp ‚àû¬Ü¬à2:5%. c.In Parts aandb, the HEV was assumed to be driven on level ground. Consider the case when, afterreaching a steady-state speed with a controller given by G SC s¬Ü¬à100¬á40 s, the car starts climbing up a hill with a gradient angle, Œ±¬à5¬∞.F o rs m a l l angles sin Œ±¬àŒ±(in radians) and, hence, when reÔ¨Çected to the motor shaft the climbing torque is Tst¬àFstr itot¬àmgr itotsinŒ±¬àmgrŒ± itot ¬à1590 9:80:35 4:87557:3¬à83:7N m : The block diagram in Figure P7.32 represents the control system of the HEV rearranged for Part c.s+0.01908‚ÄìG2(s) = Equivalent transfer function of the car Tst(s)+‚ÄìE(s)=‚ÄìKSS V(s) (s + 0.5)13.53 s s100s + 40 (s + 0.5)3 (s + 0.6)++ G1(s) = Transfer function representation of tor que & s peed controllers FIGURE P7.32 In this diagram, the input is Tst t¬Ü¬à83:7u t¬Ü, corre- sponding to Œ±=5¬∞, and the output is the negative error,  e t¬Ü¬à  c t¬Ü¬à  KSSv t¬Ü, proportional to the change in car speed, v(t). Find the steady-state error e(‚àû) due to a step change in the disturbance; e.g., the climbing torque, Tst t¬Ü¬à83:7u t¬Ü. 68.Parabolic trough collector. The parabolic trough collector ( Camacho, 2012 ) is embedded in a unit feedback con Ô¨Åguration as shown in Figure P7.1, where G s¬Ü¬àGC s¬ÜP s¬Üand P s¬Ü¬à137:210 6 S2¬á0:0224 s¬á19610 6e 39s a.Assuming GC s¬Ü¬àK,Ô¨Ånd the value of Krequired for a unit-step input steady-state error of 3%. Usethe result you obtained in Problem 70, Chapter 6, toverify that the system is closed-loop stable whenthat value of Kis used. b.What is the minimum unit-step input steady-state error achievable with G C s¬Ü¬àK? c.What is the simplest compensator, GC s¬Ü, that can be used to achieve a steady-state error of 0%? Cyber Exploration Laboratory Experiment 7.1 Objective To verify the effect of input waveform, loop gain, and system type upon steady-state errors. Minimum Required Software Packages MATLAB, Simulink, and the Control System Toolbox Prelab 1.What system types will yield zero steady-state error for step inputs? 2.What system types will yield zero steady-state error for ramp inputs? 3.What system types will yield in Ô¨Ånite steady-state error for ramp inputs?Cyber Exploration Laboratory 377WEBC07 10/28/2014 17:51:30 4.What system types will yield zero steady-state error for parabolic inputs? 5.What system types will yield in Ô¨Ånite steady-state error for parabolic inputs? 6.For the negative feedback system of Figure P7.33, where Gs ¬Ü¬àKs¬á6 ¬Ü s¬á4 ¬Ü s¬á7 ¬Ü s¬á9 ¬Ü s¬á12 ¬Ü andHs ¬Ü¬à 1, calculate the steady-state error in terms of Kfor the following inputs: 5u(t), 5tu(t), and 5 t2ut ¬Ü. 7.Repeat Prelab 6 for Gs ¬Ü¬àKs¬á6 ¬Ü s¬á8 ¬Ü ss¬á4 ¬Ü s¬á7 ¬Ü s¬á9 ¬Ü s¬á12 ¬ÜandHs ¬Ü¬à 1. 8.Repeat Prelab 6 for Gs ¬Ü¬àKs¬á1 ¬Ü s¬á6 ¬Ü s¬á8 ¬Ü s2s¬á4 ¬Ü s¬á7 ¬Ü s¬á9 ¬Ü s¬á12 ¬ÜandHs ¬Ü¬à 1. Lab 1.Using Simulink, set up the negative feedback system of Prelab 6. Plot on one graph the error signal of the system for an input of 5u(t) and K¬à50;500;1000, and 5000. Repeat for inputs of 5tu(t) and 5 t2ut ¬Ü. 2.Using Simulink, set up the negative feedback system of Prelab 7. Plot on one graph theerror signal of the system for an input of 5 u(t) and K¬à50;500;1000, and 5000. Repeat for inputs of 5 tu(t) and 5 t 2ut ¬Ü. 3.Using Simulink, set up the negative feedback system of Prelab 8. Plot on one graph the error signal of the system for an input of 5 u(t) and K¬à200;400;800, and 1000. Repeat for inputs of 5 tu(t) and 5 t2ut ¬Ü. Postlab 1.Use your plots from Lab 1 and compare the expected steady-state errors to those calculated in the Prelab. Explain the reasons for any discrepancies. 2.Use your plots from Lab 2 and compare the expected steady-state errors to thosecalculated in the Prelab. Explain the reasons for any discrepancies. 3.Use your plots from Lab 3 and compare the expected steady-state errors to thosecalculated in the Prelab. Explain the reasons for any discrepancies. Experiment 7.2 Objective To use the LabVIEW Control Design and Simulation Module for analysis of steady-state performance for step and ramp inputs. Minimum Required Software Package LabVIEW with the Control Design and Simulation Module Prelab You are given the model of a single joint of a robotic manipulator shown in Figure P7.34 ( Spong, 2005), where Bis the coefÔ¨Å cient of viscous friction, Œ∏d s¬Üis the desired angle, Œ∏(s) is the output angle, and D(s) is the disturbance. We want to track the joint angle using a PD controller, which we will study in Chapter 9. Assume J¬àB¬à1. Find the step and ramp responses of this system for the following combinations of PD gains KP;KD¬Ü: (16, 7), (64, 15), and (144, 23). + +KP + KDsŒ∏ (s) Œ∏d (s)PD controller Plant 1 Js2 + Bs‚Äì ‚ÄìD (s) FIGURE P7.34R(s) + C(s)G(s) H(s)‚Äì FIGURE P7.33378 Chapter 7 Steady-State ErrorsWEBC07 10/28/2014 17:51:30 Bibliography Barkana, I. Classical and Simple Adaptive Control of Nonminimum Phase Autopilot Design. Journal of Guidance, Control, and Dynamics , vol. 28, 2005, pp. 631 ‚Äì638. Bylinkski, G. Silicon Valley High Tech: Window to the Future . Intercontinental Publishing Corp, Ltd., Hong Kong, 1985. Figure caption source for Figure 7.9. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Chandra, F. A., Buzi, G., and Doyle, J. C. Glycolytic Oscillations and Limits on Robust EfÔ¨Åciency. Science, vol. 333, American Association for the Advancement of Science, July 8, 2011, pp. 187 ‚Äì192. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. D‚ÄôAzzo, J. J., and Houpis, C. H. Feedback Control System Analysis and Design Conventional and Modern , 3d ed. McGraw-Hill, New York, 1988. Hollot, C. V., Misra, V., Towsley, D., and Gong, W. A Control Theoretic Analysis of RED. Proceedings of IEEE INFOCOM , 2001, pp. 1510 ‚Äì1519. Hostetter, G. H., Savant, C. J., Jr., and Stefani, R. T. Design of Feedback Control Systems , 2d ed. Saunders College Publishing, New York, 1989. Isailovic ÃÅ,J .Videodisc and Optical Memory Systems . Prentice Hall, Upper Saddle River, NJ, 1985. Kuo, C.-F. J., Tu, H.-M., and Liu, C.-H. Dynamic Modeling and Control of a Current New Horizontal Type Cross-Lapper Machine. Textile Research Journal, vol. 80, no. 19, Sage, 2010, pp. 2016 ‚Äì2027. Lam, C. S., Wong, M. C., and Han, Y. D. Stability Study on Dynamic Voltage Restorer (DVR). Power Electronics Systems and Applications, 2004; Proceedings First International Conference on Power Electronics , 2004, pp. 66 ‚Äì71. Lin, J.-S., and Kanellakopoulos, I. Nonlinear Design of Active Suspensions. IEEE Control Systems , vol. 17, issue 3, June 1997, pp. 45 ‚Äì59. Low, K. H., Wang, H., Liew, K. M., and Cai, Y. Modeling and Motion Control of Robotic Hand for Telemanipulation Application. International Journal of Software Engineering and Knowledge Engineering , vol. 15, 2005, pp. 147 ‚Äì152. Mitchell, R. J. More Nested Velocity Feedback Control. IEEE 9th International Conference on Cybernetic Intelligent Systems (CIS) , 2010. Ohnishi, K., Shibata, M., and Murakami, T. Motion Control for Advanced Mechatronics. IEEE/ASME Transactions on Mechatronics , vol. 1, no. 1, March 1996, pp. 56 ‚Äì67. Papadopoulos, K . G., Papastefanaki, E. N., and Margaris, N. I. Explicit Analytical PID Tuning Rules for the Design of Type-III Control Loops. IEEE Transactions on Industrial Electronics , vol. 60, no. 10, October 2013, pp. 4650 ‚Äì4664.Lab 1.Create a LabVIEW VI to simulate the response of this system to a step and a ramp inputs, under no-disturbance conditions. Use the functions available in the Control Design and Simulation/Control Design palette. 2.Create a LabVIEW VI using the functions available in the Control Design and Simulation/Simulation palette, to track an input set-point of 10 under a disturbance of D=40. Postlab Compare your results with those of the Prelab. What conclusions can you draw from the various responses of this system to different inputs and different PDparameters? What is the system type? Does the steady-state behavior corroborate thetheory you learned regarding system type and the steady-state error for various inputs?Explain your answer.Bibliography 379WEBC07 10/28/2014 17:51:30 Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Intelligence and Informatics , IEEE, 2007, pp. 157 ‚Äì162 . Schneider, R. T. Pneumatic Robots Continue to Improve. Hydraulics & Pneumatics , October 1992, pp. 38 ‚Äì39. Spong, M., Hutchinson, S., and Vidyasagar, M. Robot Modeling and Control . John Wiley & Sons. Hoboken, NJ, 2006. Yin, G., Chen, N., and Li, P. Improving Handling Stability Performance of Four-Wheel Steering Vehicle via Œº-Synthesis Robust Control. IEEE Transactions on Vehicular Technology , vol. 56, no. 5, 2007, pp. 2432 ‚Äì2439.380 Chapter 7 Steady-State ErrorsWEBC08 10/28/2014 17:55:41 Root Locus Techniques Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅDeÔ¨Åne a root locus (Sections 8.1 ‚Äì8.2) ¬ÅState the properties of a root locus (Section 8.3) ¬ÅSketch a root locus (Section 8.4) ¬ÅFind the coordinates of points on the root locus and their associated gains (Sections 8.5 ‚Äì8.6) ¬ÅUse the root locus to design a parameter value to meet a transient responsespeci Ô¨Åcation for systems of order 2 and higher (Sections 8.7 ‚Äì8.8) ¬ÅSketch the root locus for positive-feedback systems (Section 8.9) ¬ÅFind the root sensitivity for points along the root locus (Section 8.10) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with casestudies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to Ô¨Ånd the preampliÔ¨Å er gain to meet a transient response speci Ô¨Åcation.8 381WEBC08 10/28/2014 17:55:41 ¬ÅGiven the pitch or heading control system for the Unmanned Free-Swimming Submersible vehicle shown on the back endpapers, you will be able to plot the root locus and design the gain to meet a transient response speci Ô¨Åcation. You will then be able to evaluate other performance characteristics. 8.1 Introduction Root locus, a graphical presentation of the closed-loop poles as a system parameter isvaried, is a powerful method of analysis and design for stability and transient response (Evans ,1948 ,1950). Feedback control systems are dif Ô¨Åcult to comprehend from a qualitative point of view, and hence they rely heavily upon mathematics. The root locus covered in this chapter is a graphical technique that gives us the qualitative descriptionof a control system ‚Äôs performance that we are looking for and also serves as a powerful quantitative tool that yields more informa tion than the methods already discussed. Up to this point, gains and other system parameters were designed to yield a desired transient response for only Ô¨Årst- and second-order systems. Even though the root locus can be used to solve the same kind of problem, its real power lies in its ability to provide solutions for systems of order higher than 2. For example, under the right conditions, a fourth-order system ‚Äôs parameters can be designed to yield a given percent overshoot and settling time using the concepts learned in Chapter 4. The root locus can be used to describe qualitatively the performance of a system as various parameters are changed. For example, the effect of varying gain upon percentovershoot, settling time, and peak time can be vividly displayed. The qualitative descriptioncan then be veri Ô¨Åed with quantitative analysis. Besides transient response, the root locus also gives a graphical representation of a system ‚Äôs stability. We can clearly see ranges of stability, ranges of instability, and the conditions that cause a system to break into oscillation. Before presenting root locus, let us review two concepts that we need for the ensuing discussion: (1) the control system problem and (2) complex numbers and their representa-tion as vectors. The Control System Problem We have previously encountered the control system problem in Chapter 6: Whereas thepoles of the open-loop transfer function are easily found (typically, they are known byinspection and do not change with changes in system gain), the poles of the closed-looptransfer function are more dif Ô¨Åcult to Ô¨Ånd (typically, they cannot be found without factoring the closed-loop system ‚Äôs characteristic polynomial, the denominator of the closed-loop transfer function), and further, the closed-loop poles change with changes in system gain. A typical closed-loop feedback control system is shown in Figure 8.1( a). The open-loop transfer function was de Ô¨Åned in Chapter 5 as KG(s)H(s). Ordinarily, we can determine the poles of KG(s)H(s), since these poles arise from simple cascaded Ô¨Årst- or second-order subsystems. Further, variations in Kdo not affect the location of any pole of this function. On the other hand, we cannot determine the poles of T s¬Ü¬àKG s¬Ü=¬â1¬áKG s¬ÜH s¬Ü¬äunless we factor the denominator. Also, the poles of T(s) change with K. Let us demonstrate. Letting G s¬Ü¬à NG s¬Ü DG s¬Ü(8.1) and H s¬Ü¬àNH s¬Ü DH s¬Ü(8.2)382 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:42 then T s¬Ü¬àKN G s¬ÜDH s¬Ü DG s¬ÜDH s¬Ü¬áKN G s¬ÜNH s¬Ü(8.3) where NandDare factored polynomials and signify numerator and denominator terms, respectively. We observe the following: Typically, we know the factors of the numerators and denominators of G(s) and H(s). Also, the zeros of T(s) consist of the zeros of G(s) and the poles of H(s). The poles of T(s) are not immediately known and in fact can change with K. For example, if G s¬Ü¬à s¬á1¬Ü=¬âs s¬á2¬Ü¬äandH s¬Ü¬à s¬á3¬Ü= s¬á4¬Ü, the poles of KG(s)H(s) are 0 ; 2;and 4. The zeros of KG(s)H(s) are  1 and  3. Now, Ts ¬Ü¬à Ks¬á1 ¬Ü s¬á4 ¬Ü =¬âs3¬á6¬áK ¬Ü s2¬á8¬á4K ¬Ü s¬á3K¬ä. Thus, the zeros of T(s) consist of the zeros of G(s) and the poles of H(s). The poles of T(s) are not immediately known without factoring the denominator, and they are a function of K. Since the system ‚Äôs transient response and stability are dependent upon the poles of T(s), we have no knowledge of the system ‚Äôs performance unless we factor the denominator for speci Ô¨Åc values of K. The root locus will be used to give us a vivid picture of the poles of T(s)a sKvaries. Vector Representation of Complex Numbers Any complex number ,œÉ¬ájœâ, described in Cartesian coordinates can be graphically represented by a vector, as shown in Figure 8.2( a). The complex number also can be described in polar form with magnitude Mand angle Œ∏,a sM¬ÄŒ∏. If the complex number is substituted into a complex function, F(s), another complex number will result. For example, if F s¬Ü¬à s¬áa¬Ü, then substituting the complex number s¬àœÉ¬ájœâyields F s¬Ü¬à œÉ¬áa¬Ü¬ájœâ, another complex number. This number is shown in Figure 8.2( b). Notice that F(s) has a zero at  a. If we translate the vector aunits to the left, as in Figure 8.2( c), we have an alternate representation of the complex number that originates at the zero of F(s) and terminates on the point s¬àœÉ¬ájœâ. We conclude that ( s¬áa)is a complex number and can be represented by a vector drawn from the zero of the function to the point s . For example, s¬á7¬Üjs¬Æ5¬áj2is a complex number drawn from the zero of the function,  7, to the point s, which is 5 ¬áj2, as shown in Figure 8.2( d). Now let us apply the concepts to a complicated function. Assume a function F s¬Ü¬àŒ†m i¬à1 s¬ázi¬Ü Œ†n j¬à1 s¬ápj¬Ü¬àŒ†numerator ‚Äôs complex factors Œ†denominator ‚Äôs complex factors(8.4)+ Ea(s) ‚Äì H(s)KG(s)Input R(s)Actuating signalForward transfer functionOutput C(s) Feedback transfer function (a)C(s) R(s) KG(s) 1 + KG(s)H(s) (b)FIGURE 8.1 a.Closed-loop system; b.equivalent transfer function8.1 Introduction 383WEBC08 10/28/2014 17:55:42 where the symbol Œ†means ‚Äúproduct, ‚Äùm¬ànumber of zeros ;andn¬ànumber of poles. Each factor in the numerator and each factor in the denominator is a complex number that can be represented as a vector. The function de Ô¨Ånes the complex arithmetic to be performed in order to evaluate F(s) at any point, s. Since each complex factor can be thought of as a vector, the magnitude, M,o fF(s)a ta n yp o i n t , s,i s M¬àŒ†zero lengths Œ†pole lengths¬àŒ†m i¬à1js¬ázi ¬Ü j Œ†n j¬à1j s¬ápj¬Üj(8.5) where a zero length, j s¬ázi¬Üj, is the magnitude of the vector drawn from the zero of F(s)a t  zito the point s, and a pole length, j s¬ápj¬Üj, is the magnitude of the vector drawn from the pole of F(s)a t pjto the point s. The angle, Œ∏,o fF(s) at any point, s,i s Œ∏¬àPzero angles  Ppole angles ¬àXm i¬à1¬Äs¬ázi ¬Ü  Xn j¬à1¬Ä s¬ápj¬Ü(8.6) where a zero angle is the angle, measured from the positive extension of the real axis, of avector drawn from the zero of F(s)a t z ito the point s, and a pole angle is the angle, measured from the positive extension of the real axis, of the vector drawn from the pole ofF(s)a t p jto the point s.s-plane jœâ jœâ M (a) (b) (d)5 ‚Äì7 (c)s-plane + a s-plane j2s-plane jwjœâ jœâ jœâ jœâ ‚ÄìaœÉœÉ œÉ œÉœÉœÉœÉŒ∏ FIGURE 8.2 Vector representation of complex numbers: a.s¬àœÉ¬ájœâ; b. s¬áa¬Ü;c.alternate representation of s¬áa¬Ü; d. s¬á7¬Üjs¬Æ5¬áj2384 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:43 As a demonstration of Eqs. (8.5) and (8.6), consider the following example. Skill-Assessment Exercise 8.1 PROBLEM: Given F s¬Ü¬à s¬á2¬Ü s¬á4¬Ü s s¬á3¬Ü s¬á6¬Ü Ô¨ÅndF(s) at the point s¬à 7¬áj9 the following ways: a.Directly substituting the point into F(s) b.Calculating the result using vectors ANSWER:  0:0339  j0:0899 ¬à0:096¬Ä 110 :7¬∞ The complete solution is at www.wiley.com/college/nise .TryIt 8.1 Use the following MATLAB statements to solve the problem given in Skill-AssessmentExercise 8.1. s=-7+9j ; G=(s+2) * (s+4) / ... (s* (s +3) * (s+6)); Theta =(180/pi) *... angle(G) M=abs(G)Example 8.1 Evaluation of a Complex Function via VectorsEvaluation of a Complex Function via Vectors PROBLEM: Given F s¬Ü¬à s¬á1¬Ü s s¬á2¬Ü(8.7) Ô¨ÅndF(s) at the point s¬à 3¬áj4. SOLUTION: The problem is graphically depicted in Figure 8.3, where each vector, s¬áŒ±¬Ü, of the function is shown terminating on the selected point s¬à 3¬áj4. The vector originating at the zero at  1i s Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 20p ¬Ä116:6¬∞ (8.8) The vector originating at the pole at the origin is 5¬Ä126 :9¬∞ (8.9) The vector originating at the pole at  2i s Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 17p ¬Ä104 :0¬∞ (8.10) Substituting Eqs. (8.8) through (8.10) into Eqs. (8.5) and (8.6) yields M¬ÄŒ∏¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 20p 5Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 17p ¬Ä116 :6¬∞ 126:9¬∞ 104:0¬∞¬à0:217¬Ä 114:3¬∞ (8.11) as the result for evaluating F(s) at the point  3¬áj4.j1j2j3j4 s-planejœâ ‚Äì2 ‚Äì1 0(s + 2)(s + 1) ‚Äì3(s) œÉ FIGURE 8.3 Vector representation of Eq. (8.7)8.1 Introduction 385WEBC08 10/28/2014 17:55:43 We are now ready to begin our discussion of the root locus. 8.2 De Ô¨Åning the Root Locus A security camera system similar to that shown in Figure 8.4( a) can automatically follow a subject. The tracking system monitors pixel changes and positions the camera to center the changes. The root locus technique can be used to analyze and design the effect of loop gain upon the system ‚Äôs transient response and stability. Assume the block diagram representation of a tracking system as shown in Figure 8.4( b), where the closed-loop poles of the system change location as the gain, K, is varied. Table 8.1, which was formed by applying the quadratic formula to the denominator of the transfer function in Figure 8.4( c), shows the variation of pole location for different values of gain, K. The data of Table 8.1 is graphically displayed in Figure 8.5( a), which shows each pole and its gain. As the gain, K, increases in Table 8.1 and Figure 8.5( a), the closed-loop pole, which is at 10 for K¬à0, moves toward the right, and the closed-loop pole, which is at 0 for K¬à0, moves toward the left. They meet at  5, break away from the real axis, and move into the complex plane. One closed-loop pole moves upward while the other moves downward. We cannot tell which pole moves up or which moves down. In Figure 8.5( b), the individual closed-loop pole locations are removed and their paths are represented with solid lines. It is this representation of the paths of the closed-loop poles as the gain is varied that we call a root locus . For most of our work, the discussion will be limited to positive gain, or K0. The root locus shows the changes in the transient response as the gain, K, varies. First of all, the poles are real for gains less than 25. Thus, the system is overdamped. At again of 25, the poles are real and multiple and hence critically damped. For gains above 25,the system is underdamped. Even though these preceding conclusions were available (a) Largeformat 4 5/iStockphoto. K1s(s + 10)R(s)Subject‚Äôs position + ‚ÄìC(s)Camera position C(s) s2 + 10s + K where K = K 1K2(b) (c)AmplifierMotor and camera K2 R(s) KSensors FIGURE 8.4 a.Security cameras with auto tracking can be used to follow moving objects automatically; b.block diagram; c.closed-loop transfer function386 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:46 through the analytical techniques covered in Chapter 4, the following conclusions are graphically demonstrated by the root locus. Directing our attention to the underdamped portion of the root locus, we see that regardless of the value of gain, the real parts of the complex poles are always the same. Sincethe settling time is inversely proportional to the real part of the complex poles for thissecond-order system, the conclusion is that regardless of the value of gain, the settling timefor the system remains the same under all conditions of underdamped responses. Also, as we increase the gain, the damping ratio diminishes, and the percent overshoot increases. The damped frequency of oscillation, which is equal to the imaginary part of thepole, also increases with an increase in gain, resulting in a reduction of the peak time. Finally, since the root locus never crosses over into the right half-plane, the system is always stable, regardless of the value of gain, and can never break into a sinusoidal oscillation. These conclusions for such a simple system may appear to be trivial. What we are about to see is that the analysis is applicable to systems of order higher than two. For theseTABLE 8.1 Pole location as function of gain for the system of Figure 8.4 K Pole 1 Pole 2 0  10 0 5  9.47  0.53 10  8.87  1.13 15  8.16  1.84 20  7.24  2.76 25  5  5 30  5¬áj2:24  5 j2:24 35  5¬áj3:16  5 j3:16 40  5¬áj3:87  5 j3:87 45  5¬áj4:47  5 j4:47 50  5¬áj5  5 j5 œÉœÉ ‚Äì1 0 ‚Äì2 ‚Äì3 ‚Äì4 ‚Äì6 ‚Äì7 ‚Äì8 ‚Äì9 ‚Äì10 ‚Äì5 30 K = 50454035 (b)30354045K = 50 s-plane 5 10 15 20 25 20 15 10 5 K = 00 = Kj1j2j3j4j5 ‚Äìj1 ‚Äìj2 ‚Äìj3 ‚Äìj4 ‚Äìj5 (a)jœâ jœâ ‚Äì1 0 ‚Äì2 ‚Äì3 ‚Äì4 ‚Äì6 ‚Äì7 ‚Äì8 ‚Äì9 ‚Äì10j1j2j3j4j5 ‚Äìj1 ‚Äìj2 ‚Äìj3 ‚Äìj4 ‚Äìj5‚Äì5 30 K = 5045403530354045K = 50 s-plane 5 10 15 20 25 20 15 10 5 K = 00 = K FIGURE 8.5 a.Pole plot from Table 8.1; b.root locus8.2 De Ô¨Åning the Root Locus 387WEBC08 10/28/2014 17:55:46 systems, it is dif Ô¨Åcult to tie transient response characteristics to the pole location. The root locus will allow us to make that association and will become an important technique in the analysis and design of higher-order systems. 8.3 Properties of the Root Locus In Section 8.2, we arrived at the root locus by factoring the second-order polynomial in thedenominator of the transfer function. Consider what would happen if that polynomial wereofÔ¨Åfth or tenth order. Without a computer, factoring the polynomial would be quite a problem for numerous values of gain. We are about to examine the properties of the root locus. From these properties we will be able to make a rapid sketch of the root locus for higher-order systems without having to factor the denominator of the closed-loop transfer function. The properties of the root locus can be derived from the general control system of Figure 8.1( a). The closed-loop transfer function for the system is T s¬Ü¬àKG s¬Ü 1¬áKG s¬ÜH s¬Ü(8.12) From Eq. (8.12), a pole, s, exists when the characteristic polynomial in the denominator becomes zero, or KG s¬ÜH s¬Ü¬à  1¬à1¬Ä 2k¬á1¬Ü180 ¬∞k¬à0;1;2;3;... (8.13) where  1 is represented in polar form as 1 ¬Ä 2k¬á1¬Ü180 ¬∞. Alternately, a value of sis a closed-loop pole if jKG s¬ÜH s¬Üj¬à1 (8.14) and ¬ÄKG s¬ÜH s¬Ü¬à 2k¬á1¬Ü180 ¬∞ (8.15) Equation (8.13) implies that if a value of sis substituted into the function KG(s)H(s), a complex number results. If the angle of the complex number is an odd multiple of 180 ¬∞, that value of sis a system pole for some particular value of K. What value of K? Since the angle criterion of Eq. (8.15) is satis Ô¨Åed, all that remains is to satisfy the magnitude criterion, Eq. (8.14). Thus, K¬à1 jG s¬ÜjjH s¬Üj(8.16) We have just found that a pole of the closed-loop system causes the angle of KG(s)H(s), or simply G(s)H(s) since Kis a scalar, to be an odd multiple of 180 ¬∞. Furthermore, the magnitude of KG(s)H(s) must be unity, implying that the value of Kis the reciprocal of the magnitude of G(s)H(s) when the pole value is substituted for s. Let us demonstrate this relationship for the second-order system of Figure 8.4. The fact that closed-loop poles exist at  9:47 and  0:53 when the gain is 5 has already been established in Table 8.1. For this system, KG s¬ÜH s¬Ü¬àK s s¬á10¬Ü(8.17)388 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:46 Substituting the pole at  9:47 for sand 5 for Kyields KG s¬ÜH s¬Ü¬à  1. The student can repeat the exercise for other points in Table 8.1 and show that each case yields KG s¬ÜH s¬Ü¬à  1. It is helpful to visualize graphically the meaning of Eq. (8.15). Let us apply the complex number concepts reviewed in Section 8.1 to the root locus of the system shown inFigure 8.6. For this system the open-loop transfer function is KG s¬ÜH s¬Ü¬àK s¬á3¬Ü s¬á4¬Ü s¬á1¬Ü s¬á2¬Ü(8.18) The closed-loop transfer function, T(s), is T s¬Ü¬àK s¬á3¬Ü s¬á4¬Ü 1¬áK¬Üs2¬á 3¬á7K¬Üs¬á 2¬á12K¬Ü(8.19) If point sis a closed-loop system pole for some value of gain, K, then smust satisfy Eqs. (8.14) and (8.15). Consider the point  2¬áj3. If this point is a closed-loop pole for some value of gain, then the angles of the zeros minusthe angles of the poles must equal an odd multiple of 180 ¬∞. From Figure 8.7, Œ∏ 1¬áŒ∏2 Œ∏3 Œ∏4¬à56:31¬∞¬á71:57¬∞ 90¬∞ 108:43¬∞ ¬à 70:55¬∞ (8.20) Therefore,  2¬áj3 is not a point on the root locus, or alternatively,  2¬áj3 is not a closed-loop pole for any gain. If these calculations are repeated for the point  2¬áj Ô¨ÉÔ¨ÉÔ¨É 2p =2¬Ü, the angles do add up to 180 ¬∞.T h a ti s ,  2¬áj Ô¨ÉÔ¨ÉÔ¨É2p =2¬Üis a point on the root locus for some value of gain. We now proceed to evaluate that value of gain.jœâ j3 L4s-plane L3 L2 L1 ‚Äì1 ‚Äì2 ‚Äì3 ‚Äì 4œÉŒ∏1 Œ∏2 Œ∏3 Œ∏4 FIGURE 8.7 Vector representation of G(s) from Figure 8.6( a) at 2¬áj3K(s + 3) (s + 4) (s + 1) (s + 2)R(s) (a) (b)C(s) ‚Äì+ ‚Äì4jœâ s-plane ‚Äì3 ‚Äì2 ‚Äì1œÉ FIGURE 8.6 a.Example system; b.pole-zero plot of G(s)8.3 Properties of the Root Locus 389WEBC08 10/28/2014 17:55:47 From Eqs. (8.5) and (8.16), K¬à1 jG s¬ÜH s¬Üj¬à1 M¬àŒ†pole lengths Œ†zero lengths(8.21) Looking at Figure 8.7 with the point  2¬áj3 replaced by  2¬áj Ô¨ÉÔ¨ÉÔ¨É 2p =2¬Ü, the gain, K,i s calculated as K¬àL3L4 L1L2¬àÔ¨ÉÔ¨ÉÔ¨É2p 2 1:22¬Ü 2:12¬Ü 1:22¬Ü¬à0:33 (8.22) Thus, the point  2¬áj Ô¨ÉÔ¨ÉÔ¨É2p =2¬Üis a point on the root locus for a gain of 0.33. We summarize what we have found as follows: Given the poles and zeros of the open-loop transfer function, KG(s)H(s), a point in the s-plane is on the root locus for a particular value of gain, K, if the angles of the zeros minus the angles of the poles, all d r a w nt ot h es e l e c t e dp o i n to nt h es -plane, add up to 2k¬á1¬Ü180 ¬∞.F u r t h e r m o r e ,g a i nK at that point for which the angles add up to 2k¬á1¬Ü180 ¬∞is found by dividing the product of the pole lengths by the product of the zero lengths. 8.4 Sketching the Root Locus It appears from our previous discussion that the root locus can be obtained by sweeping through every point in the s-plane to locate those points for which the angles, as previously described, add up to an odd multiple of 180 ¬∞. Although this task is tedious without the aid of a computer, the concept can be used to develop rules that can be used tosketch the root locus without the effort required to plot the locus. Once a sketch isSkill-Assessment Exercise 8.2 PROBLEM: Given a unity feedback system that has the forward transfer function G s¬Ü¬àK s¬á2¬Ü s2¬á4s¬á13¬Ü do the following: a.Calculate the angle of G(s) at the point (  3¬áj0) by Ô¨Ånding the algebraic sum of angles of the vectors drawn from the zeros and poles of G(s) to the given point. b.Determine if the point speci Ô¨Åed in ais on the root locus. c.If the point speci Ô¨Åed in ais on the root locus, Ô¨Ånd the gain, K, using the lengths of the vectors. ANSWERS: a.Sum of angles ¬à180 ¬∞ b.Point is on the root locus c.K¬à10 The complete solution is at www.wiley.com/college/nise .TryIt 8.2 Use MATLAB and the following statements to solve Skill-Assessment Exercise 8.2. s=-3+0j ; G=(s+2) / (s^2 +4*s+13) ; Theta =(180/pi) *... angle(G) M=abs(G) ; K=1/M390 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:47 obtained, it is possible to accurately plot just those points that are of interest to us for a particular problem. The following Ô¨Åve rules allow us to sketch the root locus using minimal calculations. The rules yield a sketch that gives intuitive insight into the behavior of a control system. In the next section, we re Ô¨Åne the sketch by Ô¨Ånding actual points or angles on the root locus. These re Ô¨Ånements, however, require some calculations or the use of computer programs, such as MATLAB. Number of branches. Each closed-loop pole moves as the gain is varied. If we deÔ¨Åne a branch as the path that one pole traverses, then there will be one branch for each closed-loop pole. Our Ô¨Årst rule, then, deÔ¨Å nes the number of branches of the root locus: The number of branches of the root locus equals the number of closed-loop poles. As an example, look at Figure 8.5( b), where the two branches are shown. One originates at the origin, the other at  10. Symmetry. If complex closed-loop poles do not exist in conjugate pairs, the resulting polynomial, formed by multiplying the factors containing the closed-loop poles, would have complex coef Ô¨Åcients. Physically realizable systems cannot have complex coefÔ¨Åcients in their transfer functions. Thus, we conclude: The root locus is symmetrical about the real axis. An example of symmetry about the real axis is shown in Figure 8.5( b). Real-axis segments. Let us make use of the angle property, Eq. (8.15), of the points on the root locus to determine where the real-axis segments of the root locus exist. Figure 8.8 shows the poles and zerosof a general open-loop system. If an attempt is made to calculate the angular contribution of the poles and zeros at each point, P 1,P2,P3,a n d P4, along the real axis, we observe the following: (1) At each point the angular contribution of a pair of open-loop complex poles or zeros is zero, and (2) the contribution of the open-loop poles and open-loopzeros to the left of the respective point is zero. The conclusion is that theonly contribution to the angle at any of the points comes from theopen-loop, real-axis poles and zeros that exist to the right of the respectivepoint. If we calculate the angle at each point using only the open-loop, real-axis poles and zeros to the right of each point, we note the following: (1) The angles on the real axis alternate between 0¬∞ and 180 ¬∞, and (2) the angle is 180 ¬∞for regions of the real axis that exist to the left of an odd number of poles and/or zeros. The following rulesummarizes the Ô¨Åndings: On the real axis, for K >0 the root locus exists to the left of an odd number of real-axis, Ô¨Ånite open-loop poles and/or Ô¨Ånite open-loop zeros. Examine Figure 8.6( b). According to the rule just developed, the real-axis segments of the root locus are between  1 and  2 and between  3 and  4 as shown in Figure 8.9. Starting and ending points. Where does the root locus begin (zero gain) and end (inÔ¨Å nite gain)? The answer to this question will enable us to expand the sketch of the root locus beyond the real-axis segments. Consider the closed-loop transfer function,‚Äì4jœâ s-plane ‚Äì3 ‚Äì2 ‚Äì1œÉ FIGURE 8.9 Real-axis segments of the root locus for the system of Figure 8.6s-planejœâ P4P3P2P1œÉ FIGURE 8.8 Poles and zeros of a general open-loop system with test points, Pi, on the real axis8.4 Sketching the Root Locus 391WEBC08 10/28/2014 17:55:48 T(s), described by Eq. (8.3). T(s) can now be evaluated for both large and small gains, K. AsKapproaches zero (small gain), T s¬Ü‚âàKN G s¬ÜDH s¬Ü DG s¬ÜDH s¬Ü¬áœµ(8.23) From Eq. (8.23) we see that the closed-loop system poles at small gains approach the combined poles of G(s) and H(s). We conclude that the root locus begins at the poles of G(s)H(s), the open-loop transfer function. At high gains, where Kis approaching in Ô¨Ånity, T s¬Ü‚âàKN G s¬ÜDH s¬Ü œµ¬áKN G s¬ÜNH s¬Ü(8.24) From Eq. (8.24) we see that the closed-loop system poles at large gains approach the combined zeros of G(s) and H(s). Now we conclude that the root locus ends at the zeros ofG(s)H(s), the open-loop transfer function. Summarizing what we have found: The root locus begins at the Ô¨Ånite and in Ô¨Ånite poles of G (s)H(s)and ends at the Ô¨Ånite and inÔ¨Ånite zeros of G (s)H(s). Remember that these poles and zeros are the open-loop poles and zeros. In order to demonstrate this rule, look at the system in Figure 8.6( a), whose real-axis segments have been sketched in Figure 8.9. Using the rule just derived, we Ô¨Ånd that the root locus begins at the poles at  1 and  2 and ends at the zeros at  3 and  4 (see Figure 8.10). Thus, the poles start out at  1 and  2 and move through the real-axis space between the two poles. They meet somewhere between the two poles and break out into the complex plane, moving as complex conjugates. The poles return to the real axissomewhere between the zeros at  3 and  4, where their path is completed as they move away from each other, and end up, respectively, at the two zeros of the open-loop systemat 3 and  4. Behavior at in Ô¨Ånity. Consider applying Rule 4 to the following open-loop transfer function: KG s¬ÜH s¬Ü¬à K s s¬á1¬Ü s¬á2¬Ü(8.25) There are three Ô¨Ånite poles, at s¬à0; 1;and 2, and no Ô¨Ånite zeros. A function can also have inÔ¨Ånitepoles and zeros. If the function approaches in Ô¨Ånity assapproaches in Ô¨Ånity, then the function has a pole at in Ô¨Ånity. If the function approaches jœâ ‚Äì3 ‚Äì4 ‚Äì2 ‚Äì1s-plane j1 ‚Äìj1œÉ FIGURE 8.10 Complete root locus for the system of Figure 8.6392 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:48 zero as sapproaches in Ô¨Ånity, then the function has a zero at in Ô¨Ånity. For example, the function G s¬Ü¬àshas a pole at inÔ¨Å nity, since G(s) approaches in Ô¨Ånity as sapproaches inÔ¨Ånity. On the other hand, G s¬Ü¬à1=shas a zero at in Ô¨Ånity, since G(s) approaches zero as s approaches in Ô¨Ånity. Every function of shas an equal number of poles and zeros if we include the in Ô¨Ånite poles and zeros as well as the Ô¨Ånite poles and zeros. In this example, Eq. (8.25) contains three Ô¨Ånite poles and three in Ô¨Ånite zeros. To illustrate, let sapproach in Ô¨Ånity. The open-loop transfer function becomes KG s¬ÜH s¬Ü‚âàK s3¬àK sss(8.26) Each sin the denominator causes the open-loop function, KG(s)H(s), to become zero as that sapproaches in Ô¨Ånity. Hence, Eq. (8.26) has three zeros at in Ô¨Ånity. Thus, for Eq. (8.25), the root locus begins at the Ô¨Ånite poles of KG(s)H(s) and ends at the in Ô¨Ånite zeros. The question remains: Where are the in Ô¨Ånite zeros? We must know where these zeros are in order to show the locus moving from the three Ô¨Ånite poles to the three inÔ¨Ånite zeros. Rule 5 helps us locate these zeros at in Ô¨Ånity. Rule 5 also helps us locate poles at inÔ¨Ånity for functions containing more Ô¨Ånite zeros than Ô¨Ånite poles.1 We now state Rule 5, which will tell us what the root locus looks like as it approaches the zeros at in Ô¨Ånity or as it moves from the poles at in Ô¨Ånity. The derivation can be found in Appendix M.1 at www.wiley.com/college/nise . The root locus approaches straight lines as asymptotes as the locus approaches inÔ¨Å nity. Further, the equation of the asymptotes is given by the real-axis intercept, œÉaand angle, Œ∏aas follows: œÉa¬àPfinite poles  Pfinite zeros #finite poles  #finite zeros(8.27) Œ∏a¬à 2k¬á1¬ÜœÄ #finite poles  #finite zeros(8.28) where k ¬à0;1;2;3and the angle is given in radians with respect to the positive extension of the real axis. Notice that the running index, k, in Eq. (8.28) yields a multiplicity of lines that account for the many branches of a root locus that approach in Ô¨Ånity. Let us demonstrate the concepts with an example. Example 8.2 Sketching a Root Locus with AsymptotesSketching a Root Locus with Asymptotes PROBLEM: Sketch the root locus for the system shown in Figure 8.11. R(s) + ‚ÄìC(s) K(s + 3) s(s + 1)(s + 2)(s + 4) FIGURE 8.11 System for Example 8.2 1Physical systems, however, have more Ô¨Ånite poles than Ô¨Ånite zeros, since the implied differentiation yields in Ô¨Ånite output for discontinuous input functions, such as step inputs.8.4 Sketching the Root Locus 393WEBC08 10/28/2014 17:55:49 SOLUTION: Let us begin by calculating the asymptotes. Using Eq. (8.27), the real-axis intercept is evaluated as œÉa¬à  1 2 4¬Ü    3¬Ü 4 1¬à 4 3(8.29) The angles of the lines that intersect at  4=3, given by Eq. (8.28), are Œ∏a¬à 2k¬á1¬ÜœÄ #finite poles  #finite zeros(8.30a) ¬àœÄ=3 for k¬à0 (8.30b) ¬àœÄ fork¬à1 (8.30c) ¬à5œÄ=3 for k¬à2 (8.30d) If the value for kcontinued to increase, the angles would begin to repeat. The number of lines obtained equals the difference between the number of Ô¨Ånite poles and the number of Ô¨Ånite zeros. Rule 4 states that the locus begins at the open-loop poles and ends at the open- loop zeros. For the example there are more open-loop poles than open-loop zeros. Thus, there must be zeros at inÔ¨Å nity. The asymptotes te ll us how we get to these zeros at in Ô¨Ånity. Figure 8.12 shows the complete root locus as well as the asymptotes that were just calculated. Notice that we have made use of all the rules learned so far. The real-axissegments lie to the left of an odd number of poles and/or zeros. The locus starts at theopen-loop poles and ends at the open-loop zeros. For the example there is only oneopen-loop Ô¨Ånite zero and three in Ô¨Ånite zeros. Rule 5, then, tells us that the three zeros at inÔ¨Ånity are at the ends of the asymptotes. ‚Äì20Asymptotes-plane ‚Äì4 ‚Äì3 AsymptoteAsymptote j1jœâ 12 ‚Äìj1 ‚Äìj2 ‚Äìj3j3 ‚Äì1j2 œÉ FIGURE 8.12 Root locus and asymptotes for the system of Figure 8.11394 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:49 8.5 Re Ô¨Åning the Sketch The rules covered in the previous section permit us to sketch a root locus rapidly. If we want more detail, we must be able to accurately Ô¨Ånd important points on the root locus along with their associated gain. Points on the real axis where the root locus enters or leaves thecomplex plane ‚Äîreal-axis breakaway and break-in points ‚Äîand the jœâ-axis crossings are candidates. We can also derive a better picture of the root locus by Ô¨Ånding the angles of departure and arrival from complex poles and zeros, respectively. In this section, we discuss the calculations required to obtain speci Ô¨Åc points on the root locus. Some of these calculations can be made using the basic root locus relationshipthat the sum of the zero angles minus the sum of the pole angles equals an odd multiple of180 ¬∞, and the gain at a point on the root locus is found as the ratio of (1) the product of pole lengths drawn to that point to (2) the product of zero lengths drawn to that point. We haveyet to address how to implement this task. In the past, an inexpensive tool called a Spirule TM added the angles together rapidly and then quickly multiplied and divided the lengths toobtain the gain. Today we can rely on hand-held or programmable calculators as well aspersonal computers. Students pursuing MATLAB will learn how to apply it to the root locus at the end of Section 8.6. Other alternatives are discussed in Appendix H.2 at www.wiley.com/college/nise . The discussion can be adapted to programmable hand-held calculators. All readers areencouraged to select a computational aid at this point. Root locus calculations can be laborintensive if hand calculations are used. We now discuss how to reÔ¨Å ne our root locus sketch by calculating real-axis breakaway and break-in points, jœâ-axis crossings, angles of departure from complex poles, and angles of arrival to complex zeros. We conclude by showing how to Ô¨Ånd accurately any point on the root locus and calculate the gain. Real-Axis Breakaway and Break-In Points Numerous root loci appear to break away from the real axis as the system poles movefrom the real axis to the complex plane. At other times the loci appear to return to the realaxis as a pair of complex poles becomes real. We illustrate this in Figure 8.13. This locus is sketched using the Ô¨Årst four rules: (1) number of branches, (2) symmetry, (3) real-axis segments, and (4) starting and ending points. The Ô¨Ågure shows a root locus leaving the real axis between  1a n d  2 and returning to the real axis between ¬á3a n d ¬á5. The point where the locus leaves the real axis,  œÉ 1,i sc a l l e dt h ebreakaway point , and the point where the locus returns to the real axis, œÉ2,i sc a l l e dt h e break-in point . At the breakaway or break-in point, the branches of the root locus form an angle of 180 ¬∞=nwith the real axis, where nis the number of closed-loop poles arriving at or departing from the single breakaway or break-in point on the real axis ( Kuo,1991 ). Thus, for the two poles shown in Figure 8.13, the branches at the breakaway point form 90 ¬∞angles with the real axis.Skill-Assessment Exercise 8.3 PROBLEM: Sketch the root locus and its asymptotes for a unity feedback system that has the forward transfer function G s¬Ü¬àK s¬á2¬Ü s¬á4¬Ü s¬á6¬Ü ANSWER: The complete solution is at www.wiley.com/college/nise .8.5 ReÔ¨Å ning the Sketch 395WEBC08 10/28/2014 17:55:49 We now show how to Ô¨Ånd the breakaway and break-in points. As the two closed-loop poles, which are at  1a n d  2w h e n K¬à0, move toward each other, the gain increases from a value of zero. We conclude that the gain must be maximum along the real axis at the point where the breakaway occurs, somewhere between  1a n d  2. Naturally, the gain increases above this value as the poles move into the complex plane. We concludethat the breakaway point occurs at a point of maximum gain on the real axis between the open-loop poles. Now let us turn our attention to the break-in point somewhere between ¬á3 and ¬á5o n the real axis. When the closed-loop complex pair returns to the real axis, the gain will continue to increase to in Ô¨Ånity as the closed-loop poles move toward the open-loop zeros. It must be true, then, that the gain at the break-in point is the minimum gain found along thereal axis between the two zeros. The sketch in Figure 8.14 shows the variation of real-axis gain. The breakaway point is found at the maximum gain between  1 and  2, and the break-in point is found at the minimum gain between ¬á3 and ¬á5.3 ‚Äì2 ‚Äì1‚Äìs-planejœâ 2 1 00j1j3j4 ‚Äìj1 ‚Äìj34 52 ‚Äìj2j2 1 œÉœÉ œÉ FIGURE 8.13 Root locus example showing real-axis breakaway ( œÉ 1) and break-in points (œÉ 2) K 5 4 3 2 1 2 ‚Äì1 ‚Äì2 ‚Äì3 1‚Äì0œÉ œÉ œÉFIGURE 8.14 Variation of gain along the real axis for theroot locus of Figure 8.13396 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:50 There are three methods for Ô¨Ånding the points at which the root locus breaks away from and breaks into the real axis. The Ô¨Årst method is to maximize and minimize the gain, K, using differential calculus. For all points on the root locus, Eq. (8.13) yields K¬à 1 G s¬ÜH s¬Ü(8.31) For points along the real-axis segment of the root locus where breakaway and break-in points could exist, s¬àœÉ. Hence, along the real axis Eq. (8.31) becomes K¬à 1 G œÉ¬ÜH œÉ¬Ü(8.32) This equation then represents a curve of Kversus œÉsimilar to that shown in Figure 8.14. Hence, if we differentiate Eq. (8.32) with respect to œÉand set the derivative equal to zero, we can Ô¨Ånd the points of maximum and minimum gain and hence the breakaway and break-in points. Let us demonstrate. The second method is a variation on the differential calculus method. Called the transition method , it eliminates the step of differentiation ( Franklin ,1991 ). This method, derived in Appendix M.2 at www.wiley.com/college/nise , is now stated:Example 8.3 Breakaway and Break-in Points via DifferentiationBreakaway and Break-in Points via Differentiation PROBLEM: Find the breakaway and break-in points for the root locus of Figure 8.13, using differential calculus. SOLUTION: Using the open-loop poles and zeros, we represent the open-loop system whose root locus is shown in Figure 8.13 as follows: KG s¬ÜH s¬Ü¬àK s 3¬Ü s 5¬Ü s¬á1¬Ü s¬á2¬Ü¬àK s2 8s¬á15¬Ü s2¬á3s¬á2¬Ü(8.33) But for all points along the root locus, KG s¬ÜH s¬Ü¬à  1, and along the real axis, s¬àœÉ. Hence, K œÉ2 8œÉ¬á15¬Ü œÉ2¬á3œÉ¬á2¬Ü¬à 1( 8.34) Solving for K,w e Ô¨Ånd K¬à  œÉ2¬á3œÉ¬á2¬Ü œÉ2 8œÉ¬á15¬Ü(8.35) Differentiating Kwith respect to œÉand setting the derivative equal to zero yields dK dœÉ¬à 11œÉ2 26œÉ 61¬Ü œÉ2 8œÉ¬á15¬Ü2¬à0 (8.36) Solving for œÉ,w eÔ¨Å ndœÉ¬à 1:45 and 3.82, which are the breakaway and break-in points.8.5 ReÔ¨Å ning the Sketch 397WEBC08 10/28/2014 17:55:52 Breakaway and break-in points satisfy the relationship Xm 11 œÉ¬ázi¬àXn 11 œÉ¬ápi(8.37) where z iand piare the negative of the zero and pole values, respectively, of G (s)H(s). Solving Eq. (8.37) for œÉ, the real-axis values that minimize or maximize K, yields the breakaway and break-in points without differentiating. Let us look at an example. For the third method, the root locus program discussed in Appendix H.2 at www.wiley.com/college/nise c a nb eu s e dt oÔ¨Å nd the breakaway and break-in points. Simply use the program to search for the point of maximum gain between  1a n d  2 and to search for the point of minimum gain between ¬á3a n d ¬á5. Table 8.2 shows the results of the search. The l ocus leaves the axis at  1:45, the point of maximum gainExample 8.4 Breakaway and Break-in Points Without DifferentiationBreakaway and Break-in Points Without Differentiation PROBLEM: Repeat Example 8.3 without differentiating. SOLUTION: Using Eq. (8.37), 1 œÉ 3¬á1 œÉ 5¬à1 œÉ¬á1¬á1 œÉ¬á2(8.38) Simplifying, 11œÉ2 26œÉ 61¬à0 (8.39) Hence, œÉ¬à 1:45 and 3.82, which agrees with Example 8.3. TABLE 8.2 Data for breakaway and break-in points for the root locus of Figure 8.13 Real-axis value Gain Comment  1.41 0.008557  1.42 0.008585  1.43 0.008605  1.44 0.008617  1.45 0.008623 ‚Üê Max:gain :breakaway  1.46 0.008622 3.3 44.686 3.4 37.125 3.5 33.000 3.6 30.667 3.7 29.440 3.8 29.000 ‚Üê Min:gain :break-in 3.9 29.202398 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:54 between  1a n d  2, and reenters the real axis at ¬á3:8, the point of minimum gain between ¬á3a n d ¬á5 .T h e s er e s u l t sa r et h es a m ea st h o s eo b t a i n e du s i n gt h e Ô¨Årst two methods. MATLAB also has the capability of Ô¨Ånding breakaway and break-in points. Thejœâ-Axis Crossings We now further re Ô¨Åne the root locus by Ô¨Ånding the imaginary-axis crossings. The importance of the jœâ-axis crossings should be readily apparent. Looking at Figure 8.12, we see that the system ‚Äôs poles are in the left half-plane up to a particular value of gain. Above this value of gain, two of the closed-loop system ‚Äôs poles move into the right half- plane, signifying that the system is unstable. The jœâ-axis crossing is a point on the root locus that separates the stable operation of the system from the unstable operation. The value of œâat the axis crossing yields the frequency of oscillation, while the gain at the jœâ-axis crossing yields, for this example, the maximum positive gain for system stability. We should note here that other exampl es illustrate instability at small values of gain and stability at large values of gain. These systems have a root locus starting in theright‚Äì half-plane (unstable at small values of gain) and ending in the left ‚Äìhalf-plane (stable for high values of gain). ToÔ¨Ånd the jœâ-axis crossing, we can use the Routh -Hurwitz criterion, covered in Chapter 6, as follows: Forcing a row of zero s in the Routh table will yield the gain; going back one row to the even polynomial equation and solving for the roots yields thefrequency at the imaginary-axis crossing. Example 8.5 Frequency and Gain at Imaginary-Axis CrossingFrequency and Gain at Imaginary-Axis Crossing PROBLEM: For the system of Figure 8.11, Ô¨Ånd the frequency and gain, K, for which the root locus crosses the imaginary axis. For what range of Kis the system stable? SOLUTION: The closed-loop transfer function for the system of Figure 8.11 is T s¬Ü¬àK s¬á3¬Ü s4¬á7s3¬á14s2¬á 8¬áK¬Üs¬á3K(8.40) Using the denominator and simplifying some of the entries by multiplying any row by a constant, we obtain the Routh array shown in Table 8.3. A complete row of zeros yields the possibility for imaginary axis roots. For positive values of gain, those for which the root locus is plotted, only the s1row can yield a row of zeros. Thus,  K2 65K¬á720¬à0 (8.41) TABLE 8.3 Routh table for Eq (8.40) s4 11 4 3 K s3 78 ¬áK s2 90 K 21K s1 K2 65K¬á720 90 K s0 21K8.5 ReÔ¨Å ning the Sketch 399WEBC08 10/28/2014 17:55:55 Another method for Ô¨Ånding the jœâ-axis crossing (or any point on the root locus, for that matter) uses the fact that at the jœâ-axis crossing, the sum of angles from the Ô¨Ånite open-loop poles and zeros must add to 2k¬á1¬Ü180 ¬∞. Thus, we can search jœâ-axis until we Ô¨Ånd the point that meets this angle condition. A computer program, such as the root locus program discussed in Appendix H.2 at www.wiley.com/college/nise or MATLAB, can be used for this purpose. Subsequent examples in this chapter use this method to determine thejœâ-axis crossing. Angles of Departure and Arrival In this subsection, we further re Ô¨Åne our sketch of the root locus by Ô¨Ånding angles of departure and arrival from complex poles and zeros. Consider Figure 8.15, which showsthe open-loop poles and zeros, some of which are complex. The root locus starts at theopen-loop poles and ends at the open-loop zeros. In order to sketch the root locus moreaccurately, we want to calculate the root locus departure angle from the complex poles andthe arrival angle to the complex zeros. If we assume a point on the root locus œµclose to a complex pole, the sum of angles drawn from all Ô¨Ånite poles and zeros to this point is an odd multiple of 180 ¬∞. Except for the pole that is œµclose to the point, we assume all angles drawn from all other poles and zeros are drawn directly to the pole that is near the point. Thus, the only unknown angle in the sum isthe angle drawn from the pole that is œµclose. We can solve for this unknown angle, which is also the angle of departure from this complex pole. Hence, from Figure 8.15( a),  Œ∏ 1¬áŒ∏2¬áŒ∏3 Œ∏4 Œ∏5¬áŒ∏6¬à 2k¬á1¬Ü180 ¬∞ (8.44a) or Œ∏1¬àŒ∏2¬áŒ∏3 Œ∏4 Œ∏5¬áŒ∏6  2k¬á1¬Ü180 ¬∞ (8.44b) If we assume a point on the root locus œµclose to a complex zero, the sum of angles drawn from all Ô¨Ånite poles and zeros to this point is an odd multiple of 180 ¬∞. Except for the zero that is œµclose to the point, we can assume all angles drawn from all other poles and zeros are drawn directly to the zero that is near the point. Thus, the only unknownangle in the sum is the angle drawn from the zero that is œµclose. We can solve for this unknown angle, which is also the angle of arrival to this complex zero. Hence, fromFigure 8.15( b),  Œ∏ 1¬áŒ∏2¬áŒ∏3 Œ∏4 Œ∏5¬áŒ∏6¬à 2k¬á1¬Ü180 ¬∞ (8.45a) or Œ∏2¬àŒ∏1 Œ∏3¬áŒ∏4¬áŒ∏5 Œ∏6¬á 2k¬á1¬Ü180 ¬∞ (8.45b)From this equation Kis evaluated as K¬à9:65 (8.42) Forming the even polynomial by using the s2row with K¬à9:65, we obtain 90 K¬Üs2¬á21K¬à80:35s2¬á202:7¬à0 (8.43) andsis found to be equal to j1:59. Thus the root locus crosses the jœâ-axis at j1:59 at a gain of 9.65. We conclude that the system is stable for 0 K<9:65.400 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:55 Let us look at an example.2 s-plane ‚Äì Œ∏1 + Œ∏2 + Œ∏3 ‚Äì Œ∏4 ‚Äì Œ∏5 + Œ∏6 = (2k + 1)180œÉ (a)Œ∏1ùúñ Œ∏4Œ∏6 Œ∏5 Œ∏3jœâ Œ∏ jœâ s-plane œÉ (b)Œ∏4Œ∏2 Œ∏2 Œ∏6 Œ∏5 Œ∏3ùúñ ‚Äì Œ∏1 + Œ∏2 + Œ∏3 ‚Äì Œ∏4 ‚Äì Œ∏5 + Œ∏6 = (2k + 1)180 FIGURE 8.15 Open-loop poles and zeros and calculation of a.angle of departure; b.angle of arrival Example 8.6 Angle of Departure from a Complex PoleAngle of Departure from a Complex Pole PROBLEM: Given the unity feedback system of Figure 8.16, Ô¨Ånd the angle of departure from the complex poles and sketch the root locus. K(s + 2) (s + 3)(s2 + 2s + 2)R(s) C(s) ‚Äì+ FIGURE 8.16 Unity feedback system with complex poles8.5 ReÔ¨Å ning the Sketch 401WEBC08 10/28/2014 17:55:55 Plotting and Calibrating the Root Locus Once we sketch the root locus using the rules from Section 8.4, we may want to accurately locate points on the root locus as well as Ô¨Ånd their associated gain. For example, we might want to know the exact coordinates of the root locus as it crosses the radial line representing20% overshoot. Further, we also may want the value of gain at that point. Consider the root locus shown in Figure 8.12. Let us assume we want to Ô¨Ånd the exact point at which the locus crosses the 0.45 damping ratio line and the gain at that point.Figure 8.18 shows the system ‚Äôs open-loop poles and zeros along with the Œ∂¬à0:45 line. If a few test points along the Œ∂¬à0:45 line are selected, we can evaluate their angular sum and locate that point where the angles add up to an odd multiple of 180 ¬∞. It is at this point that the root locus exists. Equation (8.20) can then be used to evaluate the gain, K, at that point. Selecting the point at radius 2 r¬à2¬Üon the Œ∂¬à0:45 line, we add the angles of the zeros and subtract the angles of the poles, obtaining Œ∏ 2 Œ∏1 Œ∏3 Œ∏4 Œ∏5¬à 251:5¬∞ (8.47)SOLUTION: Using the poles and zeros of G s¬Ü¬à s¬á2¬Ü=¬â s¬á3¬Ü s2¬á2s¬á2¬Ü¬äas plotted in Figure 8.17, we calculate the sum of angles drawn to a point œµclose to the complex pole,  1¬áj1, in the second quadrant. Thus,  Œ∏1 Œ∏2¬áŒ∏3 Œ∏4¬à Œ∏1 90¬∞¬átan 11 1/C18/C19  tan 112/C18/C19 ¬à180 ¬∞ (8.46) from which Œ∏¬à 251:6¬∞¬à108:4¬∞. A sketch of the root locus is shown in Figure 8.17. Notice how the departure angle from the complex poles helps us to re Ô¨Åne the shape. jœâ j4 j3j2 j1 ‚Äìj4‚Äìj3‚Äìj2‚Äìj1Angle of departure ‚Äì10‚Äì2 ‚Äì3 ‚Äì4s-plane Œ∏1 Œ∏3 Œ∏4 Œ∏2œÉ FIGURE 8.17 Root locus for system of Figure 8.16 showing angle of departure402 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:56 Since the sum is not equal to an odd multiple of 180 ¬∞, the point at radius ¬à2 is not on the root locus. Proceeding similarly for the points at radius ¬à1:5;1;0:747, and 0.5, we obtain the table shown in Figure 8.18. This table lists the points, giving their radius, r, and the sum of angles indicated by the symbol ¬Ä. From the table we see that the point at radius 0.747 is on the root locus, since the angles add up to  180 ¬∞. Using Eq. (8.21), the gain, K, at this point is K¬àjAjjCjjDjjEj jBj¬à1:71 (8.48) In summary, we search a given line for the point yielding a summation of angles (zero angles ‚Äìpole angles) equal to an odd multiple of 180 ¬∞. We conclude that the point is on the root locus. The gain at that point is then found by multiplying the pole lengths drawn to that point and dividing by the product of the zero lengths drawn to that point . A computer program, such as that discussed in Appendix H.2 at www.wiley.com/college/nise or MATLAB, can be used.‚Äì4 ‚Äì3 ‚Äì2 ‚Äì15 4 3 2 1j1j2jœâ r = 2 r = 1 r = 0.5E D CBA0.5 0.7471.01.52.0‚Äì158.4‚Äì180.0‚Äì199.9‚Äì230.4‚Äì251.5Radius rAngle (degrees) = 0.45 s-planer =1.5 0ùúÅ Œ∏Œ∏ Œ∏ Œ∏ Œ∏œÉ FIGURE 8.18 Finding and calibrating exact points on the root locus of Figure 8.12 Skill-Assessment Exercise 8.4 PROBLEM: Given a unity feedback system that has the forward transfer function G s¬Ü¬àK s¬á2¬Ü s2 4s¬á13¬Ü do the following: a.Sketch the root locus. b.Find the imaginary-axis crossing. c.Find the gain, K, at the jœâ-axis crossing. d.Find the break-in point. e.Find the angle of departure from the complex poles. ANSWERS: a.See solution at www.wiley.com/college/nise . b.s¬àjÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 21p c.K¬à4 d.Break-in point ¬à 7 e.Angle of departure ¬à 233:1¬∞ The complete solution is at www.wiley.com/college/nise .8.5 ReÔ¨Å ning the Sketch 403WEBC08 10/28/2014 17:55:56 8.6 An Example We now review the rules for sketching and Ô¨Ånding points on the root locus, as well as present an example. The root locus is the path of the closed-loop poles of a system as a parameter of the system is varied. Each point on the root locus satis Ô¨Åes the angle condition, ¬ÄG s¬ÜH s¬Ü¬à 2k¬á1¬Ü180 ¬∞. Using this relationship, rules for sketching and Ô¨Ånding points on the root locus were developed and are now summarized. Basic Rules for Sketching the Root Locus Number of branches The number of branches of the root locus equals the number of closed-loop poles. Symmetry The root locus is symmetrical about the real axis. Real-axis segments On the real axis, for K>0 the root locus exists to the left of an odd number of real-axis, Ô¨Ånite open-loop poles and/or Ô¨Ånite open-loop zeros. Starting and ending points The root locus begins at the Ô¨Ånite and in Ô¨Ånite poles of G(s)H(s) and ends at the Ô¨Ånite and in Ô¨Ånite zeros of G(s)H(s). Behavior at in Ô¨Ånity The root locus approaches straight lines as asymptotes as the locus approaches in Ô¨Ånity. Further, the equations of the asymptotes are given by the real-axis intercept and angle in radians as follows: œÉa¬àPfinite poles  Pfinite zeros #finite poles  #finite zeros(8.49) Œ∏a¬à 2k¬á1¬ÜœÄ #finite poles  #finite zeros(8.50) where k¬à0;1;2;3;.... Additional Rules for Re Ô¨Åning the Sketch Real-axis breakaway and break-in points The root locus breaks away from the real axis at a point where the gain is maximum and breaks into the real axis at a point where the gainis minimum. Calculation of j œâ-axis crossings The root locus crosses the jœâ-axis at the point where ¬ÄG s¬ÜH s¬Ü¬à 2k¬á1¬Ü180 ¬∞. Routh-Hurwitz or a search of the jœâ-axis for 2k¬á1¬Ü180 ¬∞ can be used to Ô¨Ånd the jœâ-axis crossing. Angles of departure and arrival The root locus departs from complex, open-loop poles and arrives at complex, open-loop zeros at angles that can be calculated as follows. Assume apoint œµclose to the complex pole or zero. Add all angles drawn from all open-loop poles and zeros to this point. The sum equals 2k¬á1¬Ü180 ¬∞. The only unknown angle is that drawn from the œµclose pole or zero, since the vectors drawn from all other poles and zeros can be considered drawn to the complex pole or zero that is œµclose to the point. Solving for the unknown angle yields the angle of departure or arrival. Plotting and calibrating the root locus All points on the root locus satisfy the relationship ¬ÄG s¬ÜH s¬Ü¬à 2k¬á1¬Ü180¬∞. The gain, K, at any point on the root locus is given by K¬à1 jG s¬ÜH s¬Üj¬à1 M Œ†finite pole lengths Œ†finite zero lengths(8.51)404 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:57 Two animation PowerPoint presentations (PPTs) demonstrating root locus plotting are available for instructors at www.wiley.com/college/nise .S e e Root-Locus Plotter and Dynamic Root-Locus . Let us now look at a summary example. Example 8.7 Sketching a Root Locus and Finding Critical PointsSketching a Root Locus and Finding Critical Points PROBLEM: Sketch the root locus for the system shown in Figure 8.19( a) and Ô¨Ånd the following: a.The exact point and gain where the locus crosses the 0.45 damping ratio line b.The exact point and gain where the locus crosses the jœâ-axis c.The breakaway point on the real axis d.The range of Kwithin which the system is stable ‚Äì2= 0.45 ‚Äìj50 ( )bR(s) C(s) K(s2 ‚Äì 4s + 20) (s + 2)(s + 4) ( )a jœâ ‚Äì4s-plane2 + j4 2 ‚Äì j4‚Äìj1 ‚Äìj2 ‚Äìj3 ‚Äìj4j2j3j4j5 24‚Äì1 3 1 ‚Äì3+ ‚Äì j1j1 œÉùúÅ FIGURE 8.19 a.System for Example 8.7; b.root locus sketch8.6 An Example 405WEBC08 10/28/2014 17:55:58 SOLUTION: The problem solution is shown, in part, in Figure 8.19( b). First sketch the root locus. Using Rule 3, the real-axis segment is found to be between  2a n d 4. Rule 4 tells us that the root locus starts at the open-loop poles and ends at the open-loop zeros. These two rules alone give us the general shape of the root locus. a.ToÔ¨Ånd the exact point where the locus crosses the Œ∂¬à0:45 line, we can use the root locus program discussed in Appendix H.2 at www.wiley.com/college/nise to search along the line Œ∏¬à180 ¬∞ cos 10:45¬à116:7¬∞ (8.52) for the point where the angles add up to an odd multiple of 180 ¬∞. Searching in polar coordinates, we Ô¨Ånd that the root locus crosses the Œ∂¬à0:45 line at 3 :4¬Ä116:7¬∞with a gain, K, of 0.417. b.ToÔ¨Ånd the exact point where the locus crosses the jœâ-axis, use the root locus program to search along the line Œ∏¬à90¬∞ (8.53) for the point where the angles add up to an odd multiple of 180 ¬∞. Searching in polar coordinates, we Ô¨Ånd that the root locus crosses the jœâ-axis at j3:9 with a gain of K¬à1:5. c.ToÔ¨Ånd the breakaway point, use the root locus program to search the real axis between  2 and  4 for the point that yields maximum gain. Naturally, all points will have the sum of their angles equal to an odd multiple of 180 ¬∞. A maximum gain of 0.0248 is found at the point  2:88. Therefore, the breakaway point is between the open-loop poles on the real axis at  2:88. d.From the answer to b, the system is stable for Kbetween 0 and 1.5. Students who are using MATLAB should now run ch8p1 in Appendix B. You will learn how to use MATLAB to plot and title a root locus,overlay constant Œ∂and œâ ncurves, zoom into and zoom out from a root locus, and interact with the root locus to Ô¨Ånd critical points as well as gains at those points. This exercise solves Example 8.7using MATLAB. Skill-Assessment Exercise 8.5 PROBLEM: Given a unity feedback system that has the forward transfer function G s¬Ü¬àK s 2¬Ü s 4¬Ü s2¬á6s¬á25¬Ü do the following: a.Sketch the root locus. b.Find the imaginary-axis crossing. c.Find the gain, K, at the jœâ-axis crossing. d.Find the break-in point. e.Find the point where the locus crosses the 0.5 damping ratio line. f.Find the gain at the point where the locus crosses the 0.5 damping ratio line. g.Find the range of gain, K, for which the system is stable.TryIt 8.3 Use MATLAB, the Control System Toolbox, and the following statements to plotthe root locus for Skill-Assessment Exercise 8.5. Solve the remaining parts of the problem by clicking on theappropriate points on theplotted root locus. numg=poly( [2 4] ) ; deng=[1 6 25] ; G=tf(numg,deng) rlocus(G) z=0.5 sgrid(z,0)406 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:55:59 8.7 Transient Response Design via Gain Adjustment Now that we know how to sketch a root locus, we show how to use it for the design of transient response. In the last section we found that the root locus crossed the 0.45damping ratio line with a gain of 0.417. D oes this mean that the system will respond with 20.5% overshoot, the equivalent to a damping ratio of 0.45? It must be emphasized that the formulas describing percent overshoot, settling time, and peak time were derived only for a system with two closed-loop complex poles and no closed-loop zeros. Theeffect of additional poles and zeros and the conditions for justifying an approximation ofa two-pole system were discussed in Sections 4.7 and 4.8 and apply here to closed-loopsystems and their root loci. The conditions justifying a second-order approximation arerestated here: 1.Higher-order poles are much farther into the left half of the s-plane than the dominant second-order pair of poles. The response that results from a higher-order pole does not appreciably change the transient response expected from the dominant second-orderpoles. 2.Closed-loop zeros near the closed-loop second-order pole pair are nearly canceled by the close proximity of higher-order closed-loop poles. 3.Closed-loop zeros not canceled by the close proximity of higher-order closed-loop poles are far removed from the closed-loop second-order pole pair. TheÔ¨Årst condition as it applies to the root locus is shown graphically in Figure 8.20( a) and ( b). Figure 8.20( b) would yield a much better second-order approximation than Figure 8.20( a), since closed-loop pole p 3is farther from the dominant, closed-loop second- order pair, p1andp2. The second condition is shown graphically in Figure 8.20( c) and ( d). Figure 8.20( d) would yield a much better second-order approximation than Figure 8.20( c), since closed-loop pole p3is closer to canceling the closed-loop zero. Summarizing the design procedure for higher-order systems, we arrive at the following: 1.Sketch the root locus for the given system. 2.Assume the system is a second-order system without any zeros and then Ô¨Ånd the gain to meet the transient response speci Ô¨Åcation. 3.Justify your second-order assumption by Ô¨Ånding the location of all higher-order poles and evaluating the fact that they are much farther from the jœâ-axis than the dominantANSWERS: a.See solution at www.wiley.com/college/nise . b.s¬àj4:06 c.K¬à1 d.Break-in point ¬à¬á2:89 e.s¬à 2:42¬áj4:18 f.K¬à0:108 g.K<1 The complete solution is at www.wiley.com/college/nise .8.7 Transient Response Design via Gain Adjustment 407WEBC08 10/28/2014 17:56:0 second-order pair. As a rule of thumb, this textbook assumes a factor of Ô¨Åve times farther. Also, verify that closed-loop zeros are approximately canceled by higher-order poles. If closed-loop zeros are not canceled by higher-order closed-looppoles, be sure that the zero is far removed from the dominant second-order pole pairto yield approximately the same response obtained without the Ô¨Ånite zero. 4.If the assumptions cannot be justi Ô¨Åed, your solution will have to be simulated in order to be sure it meets the transient response speci Ô¨Åcation. It is a good idea to simulate all solutions, anyway. We now look at a design example to show how to make a second-order approximation and then verify whether or not the approximation is valid.jœâ p1s-plane (a) (d)Open-loop pole Closed-loop pole Closed-loop zerop2p3 jœâ s-planep1 p2(b)jœâ s-planep1 p2 (c)jœâ s-planep1 p2p3 p3 p3œÉ œÉœÉ œÉ FIGURE 8.20 Making second-order approximations Example 8.8 Third-Order System Gain DesignThird-Order System Gain Design PROBLEM: Consider the system shown in Figure 8.21. Design the value of gain, K,t o yield 1.52% overshoot. Also estimate the settling time, peak time, and steady-state error. SOLUTION: The root locus is shown in Figure 8.22. Notice that this is a third-order system with one zero. Breakaway points on the real axis can occur between 0 and  1 and between  1:5 and  10, where the gain reaches a peak. Using the root locus program and searching in these regions for the peaks in gain, breakaway points are found at  0:62 with a gain of 2.511 and at  4:4 with a gain of 28.89. A break-in point on the real axis can occur between  1:5 and  10, where the gain reaches a local minimum. Using the root locus program and searching in these regions for the local minimum gain, a break-in point is found at  2:8 with a gain of 27.91. Next assume that the system can be approximated by a second- order, under-damped system without any zeros. A 1.52% overshoot corresponds to a damping ratio of 0.8. Sketch this damping ratio lineon the root locus, as shown in Figure 8.22.C(s) s(s + 1)(s + 10)K(s + 1.5) E(s) R(s) + ‚Äì+ ‚Äì+ ‚Äì FIGURE 8.21 System for Example 8.8408 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:2 Use the root locus program to search along the 0.8 damping ratio line for the point where the angles from the open-loop poles and zeros add up to an odd multiple of 180 ¬∞. This is the point where the root locus crosses the 0.8 damping ratio or 1.52 percent overshoot line. Three points satisfy this criterion:  0:87j0:66; 1:19j0:90, and  4:6j3:45 with respective gains of 7.36, 12.79, and 39.64. For each point the settling time and peak time are evaluated using Ts¬à4 Œ∂œân(8.54) where Œ∂œânis the real part of the closed-loop pole, and also using Tp¬àœÄ œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p (8.55) where œânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É1 Œ∂2p is the imaginary part of the closed-loop pole. To test our assumption of a second-order system, we must calculate the location of the third pole. Using the root locus program, search along the negative extension of the real axis between the zero at  1:5 and the pole at  10 for points that match the value of gain found at the second-order dominant poles. For each of the three crossings of the 0.8 damping ratio line, the third closed-loop pole is at  9:25, 8:6, and  1:8, respectively. The results are summarized in Table 8.4. Finally, let us examine the steady-state error produced in each case. Note that we have little control over the steady-state error at this point. When the gain is set to meetjœâ j2 0j3j4 ‚Äìj1 ‚Äìj2s-plane ‚Äì10‚Äì4.6 + j3.45, K = 39.64= 0.8 ‚Äì1 ‚Äì1.5‚Äì1.19 + j0.90, K = 12.79 ‚Äì0.87 + j0.66, K = 7.36 ‚Äì9 ‚Äì8 ‚Äì7 ‚Äì6 ‚Äì5 ‚Äì 4 ‚Äì3 = Closed-loop pole = Open-loop poleùúÅ œÉ FIGURE 8.22 Root locus for Example 8.8 TABLE 8.4 Characteristics of the system of Example 8.8 CaseClosed-loop polesClosed- loop zero GainThird closed-loop poleSettling timePeak time Kv 1  0:87j0:66  1:5¬áj0 7.36  9.25 4.60 4.76 1.1 2  1:19j0:90  1:5¬áj0 12.79  8.61 3.36 3.49 1.9 3  4:60j3:45  1:5¬áj0 39.64  1.80 0.87 0.91 5.98.7 Transient Response Design via Gain Adjustment 409WEBC08 10/28/2014 17:56:2 the transient response, we have also designed the steady-state error. For the example, the steady-state error speci Ô¨Åcation is given by Kvand is calculated as Kv¬àlim s¬Æ0sG s¬Ü¬àK 1:5¬Ü 1¬Ü 10¬Ü(8.56) The results for each case are shown in Table 8.4. How valid are the second-order assumptions? From Table 8.4, Cases 1 and 2 yield third closed-loop poles that are relatively far from the closed-loop zero. For these twocases there is no pole-zero cancellation, and a second-order system approximation is not valid. In Case 3, the third closed-loop pole and the closed-loop zero are relatively close to each other, and a second-order system approximation can be considered valid. In orderto show this, let us make a partial-fraction expansion of the closed-loop step response ofCase 3 and see that the amplitude of the exponential decay is much less than the amplitudeof the underdamped sinusoid. The closed-loop step response, C 3 s¬Ü, formed from the closed-loop poles and zeros of Case 3 is C3 s¬Ü¬à39:64 s¬á1:5¬Ü s s¬á1:8¬Ü s¬á4:6¬áj3:45¬Ü s¬á4:6 j3:45¬Ü ¬à39:64 s¬á1:5¬Ü s s¬á1:8¬Ü s2¬á9:2s¬á33:06¬Ü ¬à1 s¬á0:3 s s¬á18¬Ü 1:3 s¬á4:6¬Ü¬á1:6 3:45¬Ü s¬á4:6¬Ü2¬á3:452(8.57) Thus, the amplitude of the exponential decay from the third pole is 0.3, and the amplitude of the underdamped response from the dominant poles isÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1:32¬á1:62p ¬à2:06. Hence, the dominant pole response is 6.9 times as large as the nondominant exponential response, and we assume that a second-order approximation is valid. Using a simulation program, we obtain Figure 8.23, which shows comparisons of step responses for the problem we have just solved. Cases 2 and 3 are plotted for boththe third-order response and a second-order response, assuming just the dominant pair of poles calculated in the design problem. Again, the second-order approximation was justi Ô¨Åed for Case 3, where there is a small difference in percent overshoot. The second-order approximation is not valid for Case 2. Other than the excess overshoot,Case 3 responses are similar. Third-order, K = 12.79 Second-order, K = 12.79 (a)Case 2 response 0.0 0Response Time (seconds)0.20.40.60.81.01.2 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5Third-order, K = 39.64 Second-order, K = 39.64 0Response Time (seconds) ( )b0.20.40.60.81.01.2 0.5 1 1.5 2 2.5 3 3.5 4 4.5 50.0Case 3 response FIGURE 8.23 Second- and third-order responses for Example 8.8: a.Case 2; b.Case 3410 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:3 Students who are using MATLAB may want to explore the SISO Design Tool described in Appendix E at www.wiley.com/college/nise. The SISO Design Tool is a convenient and intuitive way to obtain, view,and interact with a system ‚Äôs root locus. Section D.7 describes the advantages of using the tool, while Section D.8 describes how touse it. For practice, you may want to apply the SISO Design Tool tosome of the problems at the end of this chapter. 8.8 Generalized Root Locus Up to this point we have always drawn the root locus as a function of the forward-path gain, K. The control system designer must often know how the closed-loop poles change as a function of another parameter. For example, in Figure 8.24, the parameter of interest is the open-loop pole at  p1. How can we obtain a root locus for variations of the value of p1?Students who are using MATLAB should now run ch8p2 in Appendix B.You will learn how to use MATLAB to enter a value of percentovershoot from the keyboard. MATLAB will then draw the root locus and overlay the percent overshoot line requested. You will then interact with MATLAB and select the point of intersection of theroot locus with the requested percent overshoot line. MATLABwill respond with the value of gain, all closed-loop poles atthat gain, and a closed-loop step response plot corresponding tothe selected point. This exercise solves Example 8.8 using MATLAB. Skill-Assessment Exercise 8.6 PROBLEM: Given a unity feedback system that has the forward-path transfer function G s¬Ü¬àK s¬á2¬Ü s¬á4¬Ü s¬á6¬Ü do the following: a.Sketch the root locus. b.Using a second-order approximation, design the value of Kto yield 10% overshoot for a unit-step input. c.Estimate the settling time, peak time, rise time, and steady-state error for the value of K designed in (b). d.Determine the validity of your second-order approximation. ANSWERS: a.See solution located at www.wiley.com/college/nise . b.K¬à45:55 c.Ts¬à1:97 s;Tp¬à1:13 s;Tr¬à0:53 s, and estep ‚àû¬Ü¬à0:51 d.Second-order approximation is not valid. The complete solution is located at www.wiley.com/college/nise .8.8 Generalized Root Locus 411WEBC08 10/28/2014 17:56:4 If the function KG(s)H(s) is formed as KG s¬ÜH s¬Ü¬à10 s¬á2¬Ü s¬áp1¬Ü(8.58) the problem is that p1is not a multiplying factor of the function, as the gain, K, was in all of the previous problems. The solution to this dilemma is to create an equivalent system where p1appears as the forward-path gain. Since the closed-loop transfer function ‚Äôs denomi- nator is 1 ¬áKG s¬ÜH s¬Ü, we effectively want to create an equivalent system whose denominator is 1 ¬áp1G s¬ÜH s¬Ü. For the system of Figure 8.24, the closed-loop transfer function is T s¬Ü¬àKG s¬Ü 1¬áKG s¬ÜH s¬Ü¬à10 s2¬á p1¬á2¬Üs¬á2p1¬á10(8.59) Isolating p1, we have T s¬Ü¬à10 s2¬á2s¬á10¬áp1 s¬á2¬Ü(8.60) Converting the denominator to the form [1 ¬áp1G s¬ÜH s¬Ü]b y dividing numerator and denominator by the term not included with p1;s2¬á2s¬á10, we obtain T s¬Ü¬à10 s2¬á2s¬á10 1¬áp1 s¬á2¬Ü s2¬á2s¬á10(8.61) Conceptually, Eq. (8.61) implies that we have a system for which KG s¬ÜH s¬Ü¬àp1 s¬á2¬Ü s2¬á2s¬á10(8.62) The root locus can now be sketched as a function of p1, assuming the open-loop system of Eq. (8.62). The Ô¨Ånal result is shown in Figure 8.25. In this section, we learned to plot the root locus as a function of any system parameter. In the next section we will learn how to plot root loci for positive-feedback systems.‚Äì10 0jœâ s-plane j2j4j6 ‚Äìj2 ‚Äìj4 ‚Äìj6‚Äì5 ‚Äì2œÉ FIGURE 8.25 Root locus for the system of Figure 8.24, with p1as a parameterR(s) C(s) (s + 2)(s + p1)10 + ‚Äì FIGURE 8.24 System requiring a root locus calibrated with p1as a parameter Skill-Assessment Exercise 8.7 PROBLEM: Sketch the root locus for variations in the value of p1, for a unity feedback system that has the following forward transfer function: G s¬Ü¬à100 s s¬áp1¬Ü ANSWER: The complete solution is at www.wiley.com/college/nise .412 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:4 8.9 Root Locus for Positive-Feedback Systems The properties of the root locus were derived from the system of Figure 8.1. This is a negative-feedback system because of the negativesumming of the feedback signal to the input signal. The properties of theroot locus change dramatically if the feedback signal is added to the inputrather than subtracted. A positive-feedback system can be thought of as anegative-feedback system with a negative value of H(s). Using this concept, we Ô¨Ånd that the transfer function for the positive-feedback s y s t e ms h o w ni nF i g u r e8 . 2 6i s T s¬Ü¬àKG s¬Ü 1 KG s¬ÜH s¬Ü(8.63) We now retrace the development of the root locus for the denominator of Eq. (8.63). Obviously, a pole, s, exists when KG s¬ÜH s¬Ü¬à1¬à1¬Äk360 ¬∞k¬à0;1;2;3;... (8.64) Therefore, the root locus for positive-feedback systems consists of all points on the s-plane where the angle of KG s¬ÜH s¬Ü¬àk360 ¬∞. How does this relationship change the rules for sketching the root locus presented in Section 8.4? Number of branches. The same arguments as for negative feedback apply to this rule. There is no change. Symmetry. The same arguments as for negative feedback apply to this rule. There is no change. Real-axis segments. The development in Section 8.4 for the real-axis segments led to the fact that the angles of G(s)H(s) along the real axis added up to either an odd multiple of 180 ¬∞or a multiple of 360 ¬∞. Thus, for positive-feedback systems the root locus exists on the real axis along sections where the locus for negative-feedback systems does not exist. The rule follows: Real-axis segments: On the real axis, the root locus for positive-feedback systems exists tothe left of an even number of real-axis, Ô¨Ånite open-loop poles and/or Ô¨Ånite open-loop zeros. The change in the rule is the word even; for negative-feedback systems the locus existed to the left of an oddnumber of real-axis, Ô¨Ånite open-loop poles and/or zeros. Starting and ending points. You will Ô¨Ånd no change in the development in Section 8.4 if Eq. (8.63) is used instead of Eq. (8.12). Therefore, we have the following rule. Starting and ending points: The root locus for positive-feedback systems begins at theÔ¨Ånite and in Ô¨Ånite poles of G(s)H(s) and ends at the Ô¨Ånite and in Ô¨Ånite zeros of G(s)H(s). Behavior at in Ô¨Ånity. The changes in the development of the asymptotes begin at Eq.(M.4) in Appendix M at www.wiley.com/college/nise since positive-feedback systems follow the relationship in Eq. (8.64). That change yields a different slopefor the asymptotes. The value of the real-axis intercept for the asymptotes remainsunchanged. The student is encouraged to go through the development in detail and showthat the behavior at in Ô¨Ånity for positive-feedback systems is given by the following rule: The root locus approaches straight lines as asymptotes as the locus approachesinÔ¨Ånity. Further, the equations of the asymptotes for positive-feedback systems are given by the real-axis intercept, œÉ a, and angle, Œ∏a,a sf o l l o w s :KG(s) H(s)C(s) R(s) + ++ FIGURE 8.26 Positive-feedback system8.9 Root Locus for Positive-Feedback Systems 413WEBC08 10/28/2014 17:56:5 œÉa¬àPfinite poles  Pfinite zeros #finite poles  #finite zeros(8.65) Œ∏a¬àk2œÄ #finite poles  #finite zeros(8.66) where k ¬à0;1;2;3;..., and the angle is given in radians with respect to the positive extension of the real axis . The change we see is that the numerator of Eq. (8.66) is k2œÄinstead of 2k¬á1¬ÜœÄ. What about other calculations? The imaginary-axis crossing can be found using the root locus program. In a search of the jœâ-axis, you are looking for the point where the angles add up to a multiple of 360 ¬∞instead of an odd multiple of 180 ¬∞. The breakaway points are found by looking for the maximum value of K. The break-in points are found by looking for the minimum value of K. When we were discussing negative -feedback systems, we always made the root locus plot for positive values of gain. Since positive -feedback systems can also be thought of as negative -feedback systems with negative gain, the rules developed in this section apply equally to negative -feedback systems with negative gain. Let us look at an example. Example 8.9 Root Locus for a Positive-Feedback SystemRoot Locus for a Positive-Feedback System PROBLEM: Sketch the root locus as a function of negative gain, K, for the system shown in Figure 8.11. SOLUTION: The equivalent positive-feedback system found by pushing  1, associated with K, to the right past the pickoff point is shown in Figure 8.27( a). Therefore, as the gain of the equivalent system goes through positive values of K, the root locus will be equivalent to that generated by the gain, K, of the original system in Figure 8.11 as it goes through negative values. The root locus exists on the real axis to the left of an even number of real, Ô¨Ånite open-loop poles and/or zeros. Therefore, the locus exists on the entire positive extension of the real axis, between  1a n d  2a n db e t w e e n  3a n d  4. Using Eq. (8.27), the œÉa intercept is found to be œÉa¬à  1 2 4¬Ü    3¬Ü 4 1¬à 4 3(8.67) The angles of the lines that intersect at  4=3 are given by Œ∏a¬àk2œÄ #finite poles  #finite zeros(8.68a) ¬à0 for k¬à0 (8.68b) ¬à2œÄ=3 for k¬à1 (8.68c) ¬à4œÄ=3 for k¬à2 (8.68d) TheÔ¨Ånal root locus sketch is shown in Figure 8.27( b).414 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:5 8.10 Pole Sensitivity The root locus is a plot of the closed-loop poles as a system parameter is varied. Typically, that system parameter is gain. Any change in the parameter changes the closed-loop poles and, subsequently, the performance of the system. Many times theparameter changes against our wishes, due to heat or other environmental conditions.We would like to Ô¨Ånd out the extent to which changes in parameter values affect the performance of our system. The root locus exhibits a nonlinear relationship between gain and pole location. Along some sections of the root locus, (1) very small changes in gain yield very large changes in pole location and hence performance; along other sections of the root locus, (2) very large changes in gain yield very small changes in pole location. In the Ô¨Årst case we say that theSkill-Assessment Exercise 8.8 PROBLEM: Sketch the root locus for the positive-feedback system whose forward transfer function is G s¬Ü¬àK s¬á4¬Ü s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü The system has unity feedback. ANSWER: The complete solution is at www.wiley.com/college/nise .‚Äì1C(s) + 12345 ‚Äì5 ‚Äì3s-planejœâ(a)+ K(s + 3) s(s + 1)(s + 2)(s + 4)R(s) 4‚Äì 2 ‚Äì 1 (b)‚Äìj3‚Äìj2‚Äìj1j1j2j3 ‚ÄìœÉ FIGURE 8.27 a.Equivalent positive-feedback system for Example 8.9; b.root locus8.10 Pole Sensitivity 415WEBC08 10/28/2014 17:56:6 system has a high sensitivity to changes in gain. In the second case, the system has a low sensitivity to changes in gain. We prefer systems with low sensitivity to changes in gain. In Section 7.7, we de Ô¨Åned sensitivity as the ratio of the fractional change in a function to the fractional change in a parameter as the change in the parameter approaches zero. Applying the same de Ô¨Ånition to the closed-loop poles of a system that vary with a parameter, we de Ô¨Åne root sensitivity as the ratio of the fractional change in a closed-loop pole to the fractional change in a system parameter, such as gain. Using Eq. (7.75), we calculate thesensitivity of a closed-loop pole, s, to gain, K: Ss:K¬àK sŒ¥s Œ¥K(8.69) where sis the current pole location, and Kis the current gain. Using Eq. (8.69) and converting the partials to Ô¨Ånite increments, the actual change in the closed-loop poles can be approximated as Œîs¬àsS s:K ¬ÜŒîK K(8.70) where Œîsis the change in pole location, and ŒîK=Kis the fractional change in the gain, K. Let us demonstrate with an example. We begin with the characteristic equation from whichŒ¥s=Œ¥Kcan be found. Then, using Eq. (8.69) with the current closed-loop pole, s, and its associated gain, K, we can Ô¨Ånd the sensitivity. Example 8.10 Root Sensitivity of a Closed-Loop System to Gain VariationsRoot Sensitivity of a Closed-Loop System to Gain Variations PROBLEM: Find the root sensitivity of the system in Figure 8.4 at s¬à 9:47 and  5¬áj5. Also calculate the change in the pole location for a 10% change in K. SOLUTION: The system ‚Äôs characteristic equation, found from the closed-loop transfer function denominator, is s2¬á10s¬áK¬à0. Differentiating with respect to K, we have 2sŒ¥s Œ¥K¬á10Œ¥s Œ¥K¬á1¬à0 (8.71) from which Œ¥s Œ¥K¬à 1 2s¬á10(8.72) Substituting Eq. (8.72) into Eq. (8.69), the sensitivity is found to be Ss:K¬àK s* 1 2s¬á10(8.73) For s¬à 9:47, Table 8.1 shows K¬à5. Substituting these values into Eq. (8.73) yields Ss:K¬à 0:059. The change in the pole location for a 10% change in Kcan be found using Eq. (8.70), with s¬à 9:47;ŒîK=K¬à0:1, and Ss:K¬à 0:059. Hence, Œîs¬à0:056, or the pole will move to the right by 0.056 units for a 10% change in K. Fors¬à 5¬áj5, Table 8.1 shows K¬à50. Substituting these values into Eq. (8.73) yields Ss:K¬à1= 1¬áj1¬Ü¬à 1=Ô¨ÉÔ¨ÉÔ¨É 2p ¬Ü¬Ä   45¬∞. The change in the pole location for a 10% change in Kcan be found using Eq. (8.70), with s¬à 5¬áj5;ŒîK=K¬à0:1, and416 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:8 Ss:K¬à 1=Ô¨ÉÔ¨ÉÔ¨É 2p ¬Ü¬Ä   45¬∞. Hence, Œîs¬à j5, or the pole will move vertically by 0.5 unit for a 10% change in K. In summary, then, at K¬à5;Ss:K¬à 0:059. At K¬à50;Ss:K¬à 1=Ô¨ÉÔ¨ÉÔ¨É 2p ¬Ü¬Ä   45¬∞. Comparing magnitudes, we conclude that the root locus is less sensitive to changes in gain at the lower value of K. Notice that root sensitivity is a complex quantity possessing both the magnitude and direction information from which the change inpoles can be calculated. Case Studies Antenna Control: Transient Design via GainAntenna Control: Transient Design via Gain The main thrust of this chapter is to demonstrate design of higher-order systems (higher than two) through gain adjustment. Speci Ô¨Åcally, we are interested in determining the value of gain required to meet transient response requirements, such as percent overshoot, settling time, and peak time. The following case study emphasizes this design procedure, using the root locus. PROBLEM: Given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 1, Ô¨Ånd the preampli Ô¨Åer gain required for 25% overshoot. SOLUTION: The block diagram for the system was derived in the Case Studies section in Chapter 5 and is shown in Figure 5.34( c), where G s¬Ü¬à6:63K=¬âs s¬á1:71¬Ü s¬á100¬Ü¬ä. First a sketch of the root locus is made to orient the designer. The real-axis segments are between the origin and  1:71 and from  100 to in Ô¨Ånity. The locus begins at the open-loop poles, which are all on the real axis at the origin,  1:71, and  100. The locus then moves toward the zeros at in Ô¨Ånity by following asymptotes that, from Eqs. (8.27) and (8.28), intersect the real axis at  33:9 at angles of 60 ¬∞, 180 ¬∞, and  60¬∞. A portion of the root locus is shown in Figure 8.28. From Eq. (4.39), 25% overshoot corresponds to a damping ratio of 0.404. Now draw a radial line from the origin at an angle of cos 1Œ∂¬à113:8. The intersection of this line with the root locus locates the system ‚Äôs dominant, second-order closed-loop poles. Using the root locus program discussed in Appendix H.2 at www.wiley.com/college/niseSkill-Assessment Exercise 8.9 PROBLEM: A negative unity feedback system has the forward transfer function G s¬Ü¬àK s¬á1¬Ü s s¬á2¬Ü IfKis set to 20, Ô¨Ånd the changes in closed-loop pole location for a 5% change in K. ANSWER: For the closed-loop pole at  21:05;Œîs¬à 0:9975; for the closed-loop pole at 0:95;Œîs¬à 0:0025. The complete solution is at www.wiley.com/college/nise .Case Studies 417WEBC08 10/28/2014 17:56:9 to search the radial line for 180 ¬∞yields the closed-loop dominant poles as 2:063¬Ä113:8¬∞¬à 0:833j1:888. The gain value yields 6 :63K¬à425:7, from which K¬à64:21. Checking our second-order assumption, the third pole must be to the left of the open-loop pole at  100 and is thus greater than Ô¨Åve times the real part of the dominant pole pair, which is  0:833. The second-order approximation is thus valid. The computer simulation of the closed-loop system ‚Äôs step response in Figure 8.29 shows that the design requirement of 25% overshoot is met. 10 Time (seconds)c(t) 9 8 7 6 5 4 3 2 1 01.4 1.01.2 0.8 0.6 0.4 0.2 0 FIGURE 8.29 Step response of the gain-adjusted antenna control systemj10jœâ j2j6 j8 ‚Äìj2 ‚Äìj4 ‚Äìj6 ‚Äìj8‚Äìj10j4 204 ‚Äì2 4s-plane 113.8Additional open-loop pole at ‚Äì100 ‚ÄìùúÅ = 0.404 œÉ FIGURE 8.28 Portion of the root locus for the antenna control system418 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:10 CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. Referring to the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 2, do the following: a.Find the preampli Ô¨Åer gain, K, required for an 8-second settling time. b.Repeat, using MATLAB. UFSS Vehicle: Transient Design via GainUFSS Vehicle: Transient Design via Gain In this case study, we apply the root locus to the UFSS vehicle pitch control loop. The pitch control loop is shown with both rate and position feedback on the back endpapers. In theexample that follows, we plot the root locus without the rate feedback and then with the rate feedback. We will see the stabilizing effect that rate feedback has upon the system. PROBLEM: Consider the block diagram of the pitch control loop for the UFSS vehicle shown on the back endpapers ( Johnson ,1980 ). a.IfK 2¬à0 (no rate feedback), plot the root locus for the system as a function of pitch gain, K1, and estimate the settling time and peak time of the closed-loop response with 20% overshoot. b.LetK2¬àK1(add rate feedback) and repeat a. SOLUTION: a.Letting K2¬à0, the open-loop transfer function is G s¬ÜH s¬Ü¬à0:25K1 s¬á0:435¬Ü s¬á1:23¬Ü s¬á2¬Ü s2¬á0:226s¬á0:0169 ¬Ü(8.74) from which the root locus is plotted in Figure 8.30. Searching along the 20% overshoot line evaluated from Eq. (4.39), we Ô¨Ånd the dominant second-order poles to be  0:202j0:394 with a gain of K¬à0:25K1¬à0:706, or K1¬à2:824. 20% s-plane j1 0‚Äì0.202 + j0.394 K = 0.706; K1 = 2.824jœâ ‚Äì1 ‚Äì2 ‚Äì3 ‚Äìj3j3 j2 ‚Äìj2‚Äìj1 = Closed-loop pole = Open-loop poleœÉ FIGURE 8.30 Root locus of pitch control loop without rate feedback, UFSS vehicleCase Studies 419WEBC08 10/28/2014 17:56:11 From the real part of the dominant pole, the settling time is estimated to be Ts¬à4=0:202¬à19:8 seconds. From the imaginary part of the dominant pole, the peak time is estimated to be Tp¬àœÄ=0:394¬à7:97 seconds. Since our estimates are based upon a second-order assumption, we now test our assumption by Ô¨Ånding the third closed-loop pole location between  0:435 and  1:23 and the fourth closed-loop pole location between  2a n di n Ô¨Ånity. Searching each of these regions for a gain of K¬à0:706, we Ô¨Ånd the third and fourth poles at  0:784 and  2:27, respectively. The third pole, at  0:784, may not be close enough to the zero at  0:435, and thus the system should be simulated. The fourth pole, at  2:27, is 11 times as far from the imaginary axis as the dominant poles and thus meets the requirement of at least Ô¨Åve times the real part of the dominant poles. A computer simulation of the step response for the system, which is shown in Figure 8.31, shows a 29% overshoot above a Ô¨Ånal value of 0 :88, approximately 20-second settling time, and a peak time of approximately 7.5 seconds. b.Adding rate feedback by letting K2¬àK1in the pitch control system shown on the back endpapers, we proceed to Ô¨Ånd the new open-loop transfer function. Pushing  K1to the right past the summing junction, dividing the pitch rate sensor by  K 1, and combining the two resulting feedback paths obtaining s¬á1¬Ügive us the following open-loop transfer function: G s¬ÜH s¬Ü¬à0:25K1 s¬á0:435¬Ü s¬á1¬Ü s¬á1:23¬Ü s¬á2¬Ü s2¬á0:226s¬á0:0169 ¬Ü(8.75) Notice that the addition of rate feedback adds a zero to the open-loop transfer function. The resulting root locus is shown in Figure 8.32. Notice that this root locus, unlike the root locus in a, is stable for all values of gain, since the locus does not enter the right half of the s-plane for any value of positive gain, K¬à0:25K Also notice that the intersection with the 20% overshoot line is much farther from the imaginary axis thanis the case without rate feedback, resulting in a faster responsetime for the system.0.2 0 3 0 Time (seconds)c(t) 6 9 12 15 18 21 240.40.60.81.01.2 Final value FIGURE 8.31 Computer simulation of step response of pitch control loop without ratefeedback, UFSS vehicle ‚Äì1.024 + j1.998 K = 5.17; K 1 = 20.68 s-planej2 j1 ‚Äìj1 ‚Äìj2‚Äì1 0jœâ20% ‚Äì2 = Closed-loop pole = Open-loop poleœÉ FIGURE 8.32 Root locus of pitch control loop with rate feedback, UFSS vehicle420 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:11 The root locus intersects the 20% overshoot line at  1:024j1:998 with a gain of K¬à0:25K1¬à5:17, or K1¬à20:68. Using the real and imaginary parts of the dominant pole location, the settling time is predicted to be Ts¬à4=1:024¬à3:9 seconds, and the peak time is estimated to be Tp¬àœÄ=1:998¬à1:57 seconds. The new estimates show considerable improvement in the transient response as compared to the system without the rate feedback. Now we test our second-order approximation by Ô¨Ånding the location of the third and fourth poles between  0:435 and  1 .S e a r c h i n gt h i sr e g i o nf o rag a i no f K¬à5:17, we locate the third and fourth poles at approximately  0:5a n d  0:91. Since the zero at  1i saz e r oo f H(s), the student can verify that this zero is not a zero of the closed-loop transfer function. Thu s, although there may be pole-zero cancel- lation between the closed-loop pole at  0:5 and the closed-loop zero at  0:435, there is no closed-loop zero to cancel the closed-loop pole at  0:91.2Our second-order approximation is not valid. A computer simulation of the system with rate feedback is shown in Figure 8.33. Although the response shows that our second-order approximation is invalid, it still represents a considerable improvement in performance over the system without rate feedback; the percent overshoot is small, and the settling time is about 6 seconds instead ofabout 20 seconds. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. For the UFSS vehicle ( Johnson, 1980 ) heading control system shown on the back endpapers, and introduced in the case study challenge in Chapter 5, do the following: a.LetK 2¬àK1andÔ¨Ånd the value of K1that yields 10% overshoot. b.Repeat, using MATLAB.1.0 2 01 0 Time (seconds)c(t) 4680.8 0.6 0.4 0.2 0Final value FIGURE 8.33 Computer simulation of step response of pitch control loop with rate feedback, UFSS vehicle 2The zero at  1 shown on the root locus plot of Figure 8.32 is an open-loop zero since it comes from the numerator ofH(s).Case Studies 421WEBC08 10/28/2014 17:56:11 We have concluded the chapter with two case studies showing the use and application of the root locus. We have se en how to plot a root locus and estimate the transient response by making a second-order approximation. We saw that the second-order approximation held when rate feedback was not used for the UFSS.When rate feedback was used, an open-loop zero from H(s) was introduced. Since it was not a closed-loop zero, there was no pole-zero cancellation, and a second-orderapproximation could not be justi Ô¨Åed. In this case, however, the transient response with rate feedback did represent an impr ovement in transient response over the system without rate feedback. In subsequent chapters we will see why rate feedback yields an improvement. We will also see ot her methods of improving the transient response. Summary In this chapter, we examined the root locus , a powerful tool for the analysis and design of control systems. The root locus empow ers us with qualitative and quantitative information about the stability and transient response of feedback control systems. The root locus allows us to Ô¨Ånd the poles of the closed-loop system by starting from the open-loop system ‚Äôs poles and zeros. It is basically a graphical root-solving technique. We looked at ways to sketch the root locus rapidly, even for higher-order systems. The sketch gave us qualitative information about changes in the transient response as parameters were varied. From the locus we were able to determine whether a system was unstable forany range of gain. Next we developed the criterion for determining whether a point in the s-plane was on the root locus: The angles from the open-loop zeros, minus the angles from the open-looppoles drawn to the point in the s-plane, add up to an odd multiple of 180 ¬∞. The computer program discussed in Appendix G.2 at www.wiley.com/college/nise helps us to search rapidly for points on the root locus. This program allows us toÔ¨Ånd points and gains to meet cert ain transient response speci Ô¨Åcations as long as we are able to justify a second-order assumption for higher-order systems. Other computerprograms, such as MATLAB, plot the root loc us and allow the user to interact with the display to determine transient response speci Ô¨Åcations and system parameters. Our method of design in this chapter is gain adjustment. We are limited to transient responses governed by the poles on the root locus. Transient responses represented bypole locations outside of the root locus cannot be obtained by a simple gain adjustment.Further, once the transient response has been established, the gain is set, and so is the steady-state error performance. In other wor ds, by a simple gain adjustment, we have to trade off between a speci Ô¨Åed transient response and a speci Ô¨Åed steady-state error. Transient response and steady-state error cannot be designed independently with a simple gain adjustment. We also learned how to plot the root locus against system parameters other than gain. In order to make this root locus plot, we must Ô¨Årst convert the closed-loop transfer function into an equivalent transfer function that has the desired system parameter in the sameposition as the gain. The chapter discussion concluded with positive-feedback systems andhow to plot the root loci for these systems. The next chapter extends the concept of the root locus to the design of compensation networks. These networks have as an advantage the separate design of transient performance and steady-state error performance.422 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:11 Review Questions 1.What is a root locus? 2.Describe two ways of obtaining the root locus. 3.IfKG s¬ÜH s¬Ü¬à5¬Ä180 ¬∞, for what value of gain is sa point on the root locus? 4.Do the zeros of a system change with a change in gain? 5.Where are the zeros of the closed-loop transfer function? 6.What are two ways to Ô¨Ånd where the root locus crosses the imaginary axis? 7.How can you tell from the root locus if a system is unstable? 8.How can you tell from the root locus if the settling time does not change over a region of gain? 9.How can you tell from the root locus that the natural frequency does not change over aregion of gain? 10.How would you determine whether or not a root locus plot crossed the real axis? 11.Describe the conditions that must exist for all closed-loop poles and zeros in order tomake a second-order approximation. 12.What rules for plotting the root locus are the same whether the system is a positive- or anegative-feedback system? 13.BrieÔ¨Çy describe how the zeros of the open-loop system affect the root locus and the transient response. Problems 1.For each of the root loci shown in Figure P8.1, tell whether or not the sketch can be a root locus. If the sketch cannot be a root locus, explain why. Give all reasons. [Section: 8.4] s-plane jœâ jœâjœâ jœâ jœâ jœâjœâ jœâ(a) s-plane (b) s-plane (c)Double pole s-plane (d) s-plane (e) s-plane (f) s-plane (g) s-plane (h)Œ¥Œ¥Œ¥Œ¥ Œ¥ Œ¥Œ¥Œ¥ FIGURE P8.1Problems 423WEBC08 10/28/2014 17:56:12 2.Sketch the general shape of the root locus for each of the open-loop pole-zero plots shown in Figure P8.2. [Section: 8.4] s-plane (a)jœâ jœâ jœâ jœâ jœâ jœâs-plane (b) s-plane (c)s-plane (d) s-plane (e)s-plane (f)œÉ œÉ œÉ œÉœÉœÉ FIGURE P8.2 3.Sketch the root locus for the unity feedback system shownin Figure P8.3for the followingtransferfunctions:[Section: 8.4] a.G s¬Ü¬àK s¬á2¬Ü s¬á6¬Ü s2¬á8s¬á25 b.G s¬Ü¬àK s2¬á4¬Ü s2¬á1¬Ü c.G s¬Ü¬àK s2¬á1¬Ü s2 d.G s¬Ü¬àK s¬á1¬Ü3 s¬á4¬ÜR(s) G(s)C(s) ‚Äì+ FIGURE P8.3 4.Let G s¬Ü¬àKs ¬á2 3/C18/C19 s2 s¬á6¬Ü in Figure P8.3. [Section: 8.5] a.Plot the root locus. b.Write an expression for the closed-loop transfer function at the point where the three closed-looppoles meet. 5.Let G s¬Ü¬à K s¬á1¬Ü2 s2¬á2s¬á2 with K>0 in Figure P8.3. [Sections: 8.5, 8.9] a.Find the range of Kfor closed-loop stability. b.Sketch the system ‚Äôs root locus. c.Find the position of the closed-loop poles when K¬à1 andK¬à2. 6.For the open-loop pole-zero plot shown in Figure P8.4, sketch the root locus and Ô¨Ånd the break-in point. [Section: 8.5] ‚Äì1 ‚Äì2 ‚Äì3 ‚Äìj1j1s-planejœâ 1œÉ FIGURE P8.4 7.Sketch the root locus of the unity feedback system shown in Figure P8.3, where G s¬Ü¬àK s¬á1¬Ü s¬á7¬Ü s¬á3¬Ü s 5¬Ü andÔ¨Ånd the break-in and breakaway points. Find the range of Kfor which the system is closed-loop stable. [Section: 8.5]424 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:12 8.The characteristic polynomial of a feedback control system, which is the denominator of the closed-loop transfer function, is given by s3¬á2s2¬á 20K¬á7¬Üs¬á 100K. Sketch the root locus for this system. [Section: 8.8] 9.Figure P8.5 shows open-loop poles and zeros. There are two possibilities for the sketch of the root locus. Sketch each of the two possibilities. Be aware that onlyone can be the reallocus for speci Ô¨Åc open-loop pole and zero values. [Section: 8.4] s-planejœâ œÉ FIGURE P8.5 10.Plot the root locus for the unity feedback system shownin Figure P8.3, where G s¬Ü¬àK s¬á2¬Ü s2¬á4¬Ü s¬á5¬Ü s 3¬Ü For what range of Kwill the poles be in the right half-plane? [Section: 8.5] 11.For the unity feedback system shown in Figure P8.3,where G s¬Ü¬àKs2 9/C0/C1 s2¬á4 ¬Ü sketch the root locus and tell for what values of Kthe system is stable and unstable. [Section: 8.5] 12.Sketch the root locus for the unity feedback systemshown in Figure P8.3, where G s¬Ü¬àKs2¬á2/C0/C1 s¬á3¬Ü s¬á4¬Ü Give the values for all critical points of interest. Isthe system ever unstable? If so, for what range of K? [Section: 8.5] 13.For each system shown in Figure P8.6, make anaccurate plot of the root locus and Ô¨Ånd the following: [Section: 8.5] a.The breakaway and break-in points b.The range of Kto keep the system stablec.The value of Kthat yields a stable system with critically damped second-order poles d.The value of Kthat yields a stable system with a pair of second-order poles that have a damping ratioof 0.707 C(s) K(s + 2)(s + 1) (s ‚Äì 2)(s ‚Äì 1) System 1R(s) + ‚Äì C(s) K(s + 2)(s + 1) (s2 ‚Äì 2s + 2) System 2R(s) + ‚Äì FIGURE P8.6 14.Sketch the root locus and Ô¨Ånd the range of Kfor stability for the unity feedback system shown in Figure P8.3for the following conditions: [Section: 8.5] a.G s¬Ü¬àK s2¬á1¬Ü s 1¬Ü s¬á2¬Ü s¬á3¬Ü b.G s¬Ü¬àK s2 2s¬á2¬Ü s s¬á1¬Ü s¬á2¬Ü 15.For the unity feedback system of Figure P8.3, where G s¬Ü¬àK s¬á5¬Ü s2¬á1¬Ü s 1¬Ü s¬á3¬Ü sketch the root locus and Ô¨Ånd the range of Ksuch that there will be only two right ‚Äìhalf-plane poles for the closed-loop system. [Section: 8.5] 16.For the unity feedback system of Figure P8.3, where G s¬Ü¬àK s s¬á5¬Ü s¬á8¬Ü plot the root locus and calibrate your plot for gain. Findall the critical points, such as breakaways, asymptotes,jœâ-axis crossing, and so forth. [Section: 8.5] 17.Given the unity feedback system of Figure P8.3, makean accurate plot of the root locus for the following: a.G s¬Ü¬à K s2 2s¬á2¬Ü s¬á1¬Ü s¬á2¬Ü b.G s¬Ü¬àK s 1¬Ü s 2¬Ü s¬á1¬Ü s¬á2¬Ü Also, do the following:Problems 425WEBC08 10/28/2014 17:56:13 Calibrate the gain for at least four points for each case. Also Ô¨Ånd the breakaway points, the jœâ-axis crossing, and the range of gain for stability for each case. Find the angles of arrival for Part a. [Section: 8.5] 18.Given the root locus shown in Figure P8.7, [Section: 8.5] a.Find the value of gain that will make the systemmarginally stable. b.Find the value of gain for which the closed-looptransfer function will have a pole on the real axisat 5. ‚Äì4 ‚Äì1j1 ‚Äìj1s-planejœâ œÉ FIGURE P8.7 19.Given the unity feedback system of Figure P8.3, where G s¬Ü¬àK s¬á2¬Ü s s¬á1¬Ü s¬á3¬Ü s¬á5¬Ü do the following: [Section: 8.5] a.Sketch the root locus. b.Find the asymptotes. c.Find the value of gain that will make the systemmarginally stable. d.Find the value of gain for which the closed-looptransfer function will have a pole on the real axisat 0:5. 20.For the unity feedback system of Figure P8.3, where G s¬Ü¬à K s¬áŒ±¬Ü s s¬á3¬Ü s¬á6¬Ü Ô¨Ånd the values of Œ±andKthat will yield a second-order closed-loop pair of poles at  1j100. [Section: 8.5] 21.For the unity feedback system of Figure P8.3, where G s¬Ü¬àK s 1¬Ü s 2¬Ü s s¬á1¬Ü s¬á2¬Ü sketch the root locus and Ô¨Ånd the following: [Section: 8.5]a.The breakaway and break-in points b.Thejœâ-axis crossing c.The range of gain to keep the system stable d.The value of Kto yield a stable system with second- order complex poles, with a damping ratio of 0.5. 22.For the unity feedback system shown in Figure P8.3,where G s¬Ü¬àK s¬á10¬Ü s¬á20¬Ü s¬á30¬Üs2 10s¬á100 ¬Ü do the following: [Section: 8.7] a.Sketch the root locus. b.Find the range of gain, K, that makes the system stable. c.Find the value of Kthat yields a damping ratio of 0.707 for the system‚Äô s closed-loop dominant poles. d.Find the value of Kthat yields closed-loop critically damped dominant poles. 23.For the system of Figure P8.8( a), sketch the root locus andÔ¨Ånd the following: [Section: 8.7] a.Asymptotes b.Breakaway points c.The range of Kfor stability d.The value of Kto yield a 0.7 damping ratio for the dominant second-order pair To improve stability, we desire the root locus to cross the jœâ-axis at j5.5. To accomplish this, the open-loop function is cascaded with a zero, as shown in Figure P8.8( b). e.Find the value of Œ±and sketch the new root locus. f.Repeat Part cfor the new locus. g.Compare the results of Part cand Part f. What improvement in transient response do you notice? C(s) K (s + 1)(s + 2)(s + 3)(s + 4) C(s) K(s + Œ±) (s + 1)(s + 2)(s + 3)(s + 4)(a) (b)R(s)+ ‚Äì R(s)+ ‚Äì FIGURE P8.8426 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:14 24.Sketch the root locus for the positive-feedback system shown in Figure P8.9. [Section: 8.9] K C(s) R(s)+ +s(s+1) FIGURE P8.9 25.Root loci are usually plotted for variations in the gain. Sometimes we are interested in the variation of theclosed-loop poles as other parameters are changed. Forthe system shown in Figure P8.10, sketch the rootlocus as Œ±is varied. [Section: 8.8] C(s) R(s)+ ‚Äì1 s(s + Œ±) FIGURE P8.10 26.Given the unity feedback system shown in Figure P8.3,where G s¬Ü¬àK s¬á1¬Ü s¬á2¬Ü s¬á3¬Ü do the following problem parts by Ô¨Årst making a second-order approximation. After you are Ô¨Ånished with all of the parts, justify your second-orderapproximation. [Section: 8.7] a.Sketch the root locus. b.Find Kfor 20% overshoot. c.ForKfound in Part b, what is the settling time, and what is the peak time? d.Find the locations of higher-order poles for Kfound in Part b. e.Find the range of Kfor stability. 27.For the unity feedback system shown in Figure P8.3,where G s¬Ü¬à K s2 2s¬á2¬Ü s¬á2¬Ü s¬á4¬Ü s¬á5¬Ü s¬á6¬Ü do the following: [Section: 8.7] a.Sketch the root locus. b.Find the asymptotes. c.Find the range of gain, K, that makes the system stable. d.Find the breakaway points. e.Find the value of Kthat yields a closed-loop step response with 25% overshoot.f.Find the location of higher-order closed-loop poles when the system is operating with 25% overshoot. g.Discuss the validity of your second-order approximation. h.Use MATLAB to obtain theclosed-loop step response tovalidate or refute your second-orderapproximation. 28.The unity feedback system shown in Figure P8.3, where G s¬Ü¬à K s¬á2¬Ü s¬á3¬Ü s s¬á1¬Ü is to be designed for minimum damping ratio. Find thefollowing: [Section: 8.7] a.The value of Kthat will yield minimum damping ratio b.The estimated percent overshoot for that case c.The estimated settling time and peak time for that case d.The justi Ô¨Åcation of a second-order approximation (discuss) e.The expected steady-state error for a unit ramp inputfor the case of minimum damping ratio 29.For the unity feedback system shown in Figure P8.3, where G s¬Ü¬à K s¬á2¬Ü s s¬á6¬Ü s¬á10¬Ü Ô¨ÅndKto yield closed-loop complex poles with a damping ratio of 0.55. Does your solution require ajustiÔ¨Åcation of a second-order approximation? Explain. [Section: 8.7] 30.For the unity feedback system shown in Figure P8.3,where G s¬Ü¬à K s¬áŒ±¬Ü s s¬á2¬Ü s¬á6¬Ü Ô¨Ånd the value of Œ±so that the system will have a settling time of 2 seconds for large values of K. Sketch the resulting root locus. [Section: 8.8] 31.For theunity feedback system showninFigure 8.3,where G s¬Ü¬àK s¬á5¬Ü s2¬á8s¬á25¬Ü s¬á1¬Ü2 s¬áŒ±¬Ü design KandŒ±so that the dominant complex poles of the closed-loop function have a damping ratio of 0.5 anda natural frequency of 1.2 rad/s.Problems 427WEBC08 10/28/2014 17:56:15 32.For the unity feedback system shown in Figure 8.3, where G s¬Ü¬àK s s¬á3¬Ü s¬á4¬Ü s¬á8¬Ü do the following: [Section: 8.7] a.Sketch the root locus. b.Find the value of Kthat will yield a 10% overshoot. c.Locate all nondominant poles. What can you say about the second-order approximation that led toyour answer in Part b? d.Find the range of Kthat yields a stable system. Repeat Problem 32 using MATLAB.Use one program to do thefollowing: a.Display a root locus and pause. b.Draw a close-up of the root locus wherethe axes go from  2 to 0 on the real axis and  2 to 2 on the imaginary axis. c.Overlay the 10% overshoot line on theclose-up root locus. d.Select interactively the point where the root locus crosses the 10% over- shoot line, and respond with the gainat that point as well as all of theclosed-loop poles at that gain. e.Generate the step response at the gainfor 10% overshoot. 34.Fortheunityfeedback system shown inFigure 8.3, where G s¬Ü¬à K s2¬á4s¬á5¬Ü s2¬á2s¬á5¬Ü s¬á3¬Ü s¬á4¬Ü do the following: [Section: 8.7] a.Find the gain, K, to yield a 1-second peak time if one assumes a second-order approximation. b.Check the accuracy of thesecond-order approximationusing MATLAB to simulate the system. 35.For the unity feedback system shown in Figure P8.3,where G s¬Ü¬à K s¬á2¬Ü s¬á3¬Ü s2¬á2s¬á2¬Ü s¬á4¬Ü s¬á5¬Ü s¬á6¬Ü do the following: [Section: 8.7] a.Sketch the root locus. b.Find the jœâ-axis crossing and the gain, K, at the crossing.c.Find all breakaway and break-in points. d.Find angles of departure from the complex poles. e.Find the gain, K, to yield a damping ratio of 0.3 for the closed-loop dominant poles. 36.Repeat Parts athrough candeof Problem 35 for [Section: 8.7] G s¬Ü¬àK s¬á4¬Ü s s¬á1¬Ü s¬á2¬Ü s¬á10¬Ü 37.For the unity feedback system shown in Figure P8.3,where G s¬Ü¬àK s¬á3¬Ü s2¬á4s¬á5¬Ü do the following: [Section: 8.7] a.Find the location of the closed-loop dominant poles if the system is operating with 15% overshoot. b.Find the gain for Part a. c.Find all other closed-loop poles. d.Evaluate the accuracy of your second-order approximation. 38.For the system shown in Figure P8.11, do the following:[Section: 8.7] K C(s) R(s)+ ‚Äì(s + 2)(s + 3) (s2 + 2s + 5)s2 ‚Äì 4s + 8 FIGURE P8.11 a.Sketch the root locus. b.Find the jœâ-axis crossing and the gain, K, at the crossing. c.Find the real-axis breakaway to two-decimal-placeaccuracy. d.Find angles of arrival to the complex zeros. e.Find the closed-loop zeros. f.Find the gain, K, for a closed-loop step response with 30% overshoot. g.Discuss the validity of your second-order approximation. 39.Sketch the root locus for the system of Figure P8.12 and Ô¨Ånd the following: [Section: 8.7] a.The range of gain to yield stability428 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:15 b.The value of gain that will yield a damping ratio of 0.707 for the system ‚Äôs dominant poles c.The value of gain that will yield closed-loop poles that are critically damped K C(s) (s + 30)R(s)+ ‚Äìs(s + 3)(s + 7)(s + 9) (s2 + 20s + 225) FIGURE P8.12 40.Repeat Problem 39 using MATLAB.The program will do the followingin one program: a.Display a root locus and pause. b.Display a close-up of the root locuswhere the axes go from  2 to 0.5 on the real axis and  2 to 2 on the imaginary axis. c.Overlay the 0.707 damping ratio lineon the close-up root locus. d.Allow you to select interactively thepoint where the root locus crosses the0.707 damping ratio line, and respondby displaying the gain at that point as well as all of the closed-loop poles at that gain. The program willthen allow you to select interac-tively the imaginary-axis crossingand respond with a display of thegain at that point as well as all ofthe closed-loop poles at that gain.Finally, the program will repeat the evaluation for critically damped dominant closed-loop poles. e.Generate the step response for thecritically damped case. 41.Given the unity feedback system shown in Figure P8.3,where G s¬Ü¬à K s¬áz¬Ü s2 s¬á10¬Ü do the following: [Section: 8.7] a.Ifz¬à2,Ô¨Ånd Kso that the damped frequency of oscillation of the transient response is 5 rad/s. b.For the system of Part a, what static error constant (Ô¨Ånite) can be speci Ô¨Åed? What is its value?c.The system is to be redesigned by changing the values of zand K. If the new speci Ô¨Åcations are %OS¬à4:32%andTs¬à0:8s ,Ô¨Ånd the new values ofzandK. 42.Given the unity feedback system shown in Figure P8.3, where G s¬Ü¬àK s¬á1¬Ü s¬á3¬Ü s¬á6¬Ü2 Ô¨Ånd the following: [Section: 8.7] a.The value of gain, K, that will yield a settling time of 4 seconds b.The value of gain, K, that will yield a critically damped system 43.You are given the unity-feedbacksystem of Figure P8.3, where G s¬Ü¬àK s¬á0:02¬Ü s2 s¬á4¬Ü s¬á10¬Ü s¬á25¬Ü Use MATLAB to plot the root locus. Use acloseup of the locus (from  5 to 0 and ‚Äî1 to 6) to Ô¨Ånd the gain, K, that yields a closed-loop unit-step response, c(t), with 20.5% overshoot and a settling timeofT s=3 seconds. Mark on the time response graph all other relevant characteristics, such as the peak time, rise time, and Ô¨Ånal steady-state value. 44.Let G s¬Ü¬àK s 1¬Ü s¬á2¬Ü s¬á3¬Ü in Figure P8.3. [Section: 8.7]. a.Find the range of Kfor closed-loop stability. b.Plot the root locus for K>0. c.Plot the root locus for K<0. d.Assuming a step input, what value of Kwill result in the smallest attainable settling time? e.Calculate the system‚Äô sessfor a unit step input assuming the value of Kobtained in Part d. f.Make an approximate hand sketch of the unit stepresponse of the system if Khas the value obtained in Part d. 45.Given the unity feedback system shown in Figure P8.3,where G s¬Ü¬à K s s¬á1:25¬Ü s¬á8¬ÜProblems 429WEBC08 10/28/2014 17:56:16 evaluate the pole sensitivity of the closed-loop system if the second-order, underdamped closed-loop poles are set for [Section: 8.10] a.Œ∂¬à0:591 b.Œ∂¬à0:456 c.Which of the two previous cases has more desirablesensitivity? 46.Repeat Problem 3 but sketch your root loci for negativevalues of K. [Section: 8.9] 47.Figure P8.13 shows the block diagram of a closed-loop control of a linearized magnetic levitation system(Galv√£o, 2003 ). A s2 ‚Äì Œ∑2 G(s) R(s) C(s) + + FIGURE P8.13 Linearized magnetic levitation system block diagram Assuming A¬à1300 and Œ∑¬à860, draw the root locus andÔ¨Ånd the range of Kfor closed-loop stability when: a.G s¬Ü¬àK; b.G s¬Ü¬àK s¬á200¬Ü s¬á1000 48.The simpli Ô¨Åed transfer function model from steering angle Œ¥ s¬Üto tilt angle œÜ s¬Üin a bicycle is given by G s¬Ü¬àœÜ s¬Ü Œ¥ s¬Ü¬àaV bh*s¬áVa s2 g h In this model, hrepresents the vertical distance from the center of mass to the Ô¨Çoor, so it can be readily veriÔ¨Åed that the model is open-loop unstable. (√Östr√∂m ,2005 ). Assume that for a speci Ô¨Åcb i c y c l e , a¬à0:6m , b¬à1:5m , h¬à0:8m ,a n d g¬à9:8m / s e c . In order to stabilize the bicycle, it is assumed that the bicycle is placed in the closed-loop con Ô¨Åguration shown in Figure P8.3 and that the only availablecontrol variable is V, the rear wheel velocity. a.Find the range of Vfor closed-loop stability. b.Explain why the methods presented in this chaptercannot be used to obtain the root locus. c. Use MATLAB to obtain the system ‚Äôs root locus. 49.A technique to control the steering of a vehicle thatfollows a line located in the middle of a lane is to de Ô¨Ånea look-ahead point and measure vehicle deviationswith respect to the point. A linearized model for such a vehicle is _V _r _œà _Y g2 6666643 777775¬àa 11a12 b1Kb1K d a21a22 b2Kb2K d 01 0 0 10 U 02 666666643 77777775V r œà Y g2 666643 77775 where V¬àvehicle ‚Äôs lateral velocity, r¬àvehicle ‚Äôsy a w velocity, œà¬àvehicle ‚Äôs yaw position, and Y g¬àthe y-axis coordinate of the vehicle ‚Äôsc e n t e ro fg r a v i t y . K is a parameter to be varied depending upon trajectory changes. In a speci Ô¨Åc vehicle traveling at a speed of U¬à 10 m/sec, the parameters are a11¬à 11:6842 ; a12¬à6:7632 ;b1¬à 61:5789 ;a21¬à 3:5143 ;a22¬à 24:0257, and b2¬à66:8571 :d¬à5 m is the look-ahead distance ( √únyeliog ÃÜlu,1997 ). Assuming the vehicle will be controlled in closed loop: a.Find the system ‚Äôs characteristic equation as a function of K. b.Find the system ‚Äôs root locus as Kis varied. c.Using the root locus found in Part b, show that the system will be unstable for all values K. 50.It is known that mammals have hormonal regulationmechanisms that help maintain almost constantcalcium plasma levels (0.08 ‚Äì0.1 g/L in dairy cows). This control is necessary to maintain healthyfunctions, as calcium is responsible for diversephysiological functions, such as bone formation, intracellular communications, and blood clotting. It has been postulated that the mechanism of calciumcontrol resembles that of a PI (proportional-plus-integral) controller. PI controllers (discussed in detailin Chapter 9) are placed in cascade with the plant andused to improve steady-state error. Assume that the PI controller has the form G c s¬Ü¬à KP¬áKI S/C20/C21 where KP andKIare constants. Also assume that the mammal ‚Äôs system accumulates calcium in an integrator-like fashion, namely P s¬Ü¬à1 Vs,w h e r e Vis the plasma volume. The closed-loop model is similar to that of Figure P8.3, where G s¬Ü¬àGc s¬ÜP s¬Ü(Khammash , 2004). a.Sketch the system‚Äô s root locus as a function of KP, assuming KI>0 is constant. b.Sketch the system‚Äô s root locus as a function of KI, assuming KP>0 is constant.430 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:17 51.Problem 64 in Chapter 7 introduced the model of a TCP/IP router whose packet-drop probability is controlled by using a random early detection (RED) algorithm(Hollot, 2001 ). Using Figure P8.3 as a model, a speci Ô¨Åc router queue‚Äô s open-loop transfer function is G s¬Ü¬à7031250 Le 0:2s s¬á0:667¬Ü s¬á5¬Ü s¬á50¬Ü The function e 0:2srepresents delay. To apply the root locus method, the delay function must be replacedwith a rational function approximation. A Ô¨Årst-order Pad√© approximation can be used for this purpose. Lete  sD‚âà1 Ds. Using this approximation, plot the root locus of the system as a function of L. 52.For the dynamic voltage restorer (DVR) discussed in Problem 47, Chapter 7, do the following: a.When ZL¬à1 sCL, a pure capacitance, the system is more inclined toward instability. Find the system ‚Äôs characteristic equation for this case. b.Using the characteristic equation found in Part a, sketch the root locus of the system as a functionof C L:LetL¬à7:6m H ;C¬à11ŒºF;Œ±¬à26:4; Œ≤¬à1;Km¬à25;Kv¬à15;KT¬à0:09565, and œÑ¬à2m s( Lam,2004). 53.The closed-loop vehicle response in stopping a traindepends on the train ‚Äôs dynamics and the driver, who is an integral part of the feedback loop. In Figure P8.3, let the input be R s¬Ü¬àv rthe reference velocity, and the output C s¬Ü¬àv, the actual vehicle velocity. (Yamazaki, 2008 ) shows that such dynamics can be modeled by G s¬Ü¬àGd s¬ÜGt s¬Üwhere Gd s¬Ü¬àh1¬áK s/C18/C19s L 2 s¬áL 2 represents the driver dynamics with h,K, and Lparam- eters particular to each individual driver. We assume here that h=0.003 and L=1. The train dynamics are given by Gt s¬Ü¬àkbfKp M 1¬áke¬Üs œÑs¬á1¬Ü where M=8000 kg, the vehicle mass; ke¬à0:1 the inertial coef Ô¨Åcient; kb¬à142:5, the brake gain; Kp¬à47:5, the pressure gain; œÑ¬à1:2 sec, a time con- stant; and f¬à0:24, the normal friction coefÔ¨Å cient. a.Make a root locus plot of the system as a function ofthe driver parameter K.b.Discuss why this model may not be an accurate description of a real dr iver-train situation. 54.Voltage droop control is a technique in which loads are driven at lower voltages than those provided by the source.In general, the voltage is decreased as current demandincreases in the load. The advantage of voltage droop isthat it results in lower sensitivity to load current variations. Voltage droop can be applied to the power distribu- tion of several generators and loads linked through a dcbus. In (Karlsson, 2003 ) generators and loads are driven by 3-phase ac power, so they are interfaced to the busthrough ac/dc converters. Since each one of the loadsworksindependently, a feedback system shown in Figure P8.14 isused in each to respond equally to bus voltage variations.Given that C s=Cr=8,000 ŒºF,Lcable=50ŒºH,Rcable= 0.06Œ©,Zr=Rr=5Œ©,œâlp=200 rad/s, Gconv(s)=1, Vdc-ref=750 V, and Pref-ext=0, do the following: a.IfZreqis the parallel combination of RrandCr, and Gconv(s)=1,Ô¨Ånd G s¬Ü¬àVs s¬Ü Is s¬Ü¬àVs s¬Ü Is ref s¬Ü b.Write a MATLAB M- Ô¨Åle to plot and copy the full root locusfor that system, then zoom-in thelocus by setting the x-axis (real-axis) limits to  150 to 0 and the y-axis (imaginary-axis) limits to  150 to 150. Copy that plot, too, and Ô¨Ånd and record the following: (1)The gain, K, at which the system would have complex-conjugate closed-loopdominant poles with a damping ratioŒ∂=0.707 (2)The coordinates of the correspond-ing point selected on the root-locus (3)The values of all closed-loop polesat that gain (4)The output voltage v s(t) for a step input voltage vdc-ref (t)=750 u(t) volts c.Plot that step response and use the MATLAB Characteristics tool (inthegraphwindow) to note onthe curve the following parameters: (1)The actual percent overshoot andthe corresponding peak time, T p (2)The rise time, Tr, and the settling time, Ts (3)TheÔ¨Ånal steady-state value in voltsProblems 431WEBC08 10/28/2014 17:56:18 55.It has been suggested that the use of closed-loop feedback in ventilators can highly reduce mortalityand health problems in patients in need of respiratorytreatments ( Hahn ,2012). A good knowledge of the transfer functions involved is necessary for thedesign of an appropriate controller. In a study with18 patients it was found that the open-loop transfer function from minute ventilation (MV) to end-tidal carbon dioxide partial pressure (P ETCO 2) can be nominally modeled as: G s¬Ü¬à0:415kc s¬á0:092¬Ü s¬á0:25¬Ü s s¬á0:007¬Ü s¬á0:207¬Ü a.Make a sketch of the root locus of the systemindicating the breakaway points and the value k ctakes in each of them. b.In the design of ventilators it is very important to have negligible overshoot with the fastest possible settling time. It has been suggested that a value ofk c¬à5:35 will achieve these speci Ô¨Åcations. Mark the position of the closed-loop poles for this valueofk cand explain why this is a reasonable gain choice. 56.Figure P8.15 shows a simpli Ô¨Åed drawing of a feedback system that includes the drive systemGC(s) GP(s)+ ‚ÄìM(s) C(s) = Œ©L(s) R(s) = Œ©r(s) E(s) FIGURE P8.15 G s¬Ü¬à25 s2¬á1:2s¬á12500 ¬Ü s s2¬á5:6s¬á62000 ¬Ü presented in Problem 67, Chapter 5 ( Thomsen, 2011 ). Referring to Figures P5.43 and P8.15, Gp(s)i n Figure P8.15 is given by: Gp s¬Ü¬àKMG s¬Ü 1¬á0:1G s¬Ü Given that the controller is proportional, that is, GC(s)=KP, use MATLAB and a procedure similar tothat developed in Problem 40 in thischapter to plot the root locus 4and obtain the output response, c(t) =œâL(t), when a step input, r(t)=œâr(t)=260u(t) rad/ sec, is applied at t=0. Mark on the time response graph, c(t), all relevant char- acteristics, such as the percent over- shoot (which should not exceed 16%), peak time, rise time, settling time, and Ô¨Ånal steady-state value. DESIGN PROBLEMSDESIGN PROBLEMS 57.A simpli Ô¨Åed block diagram of a human pupil servo- mechanism is shown in Figure P8.16. The term e 0:18s_ H (s)Icable(s) _ + Vs (s) Ev(s) GC(s)1 Vs(s) + _Vdc-ref (s) Vs-lp(s) sCs1Zcable + Zreq1Pref-ext(s) s + œâlpK+Iref-ext(s) Is-ref(s) Is(s) Gconv(s) œâlp FIGURE P8.143 3Karlsson, P., and Svensson, J. DC Bus Voltage Control for a Distributed Power System, IEEE Trans. Power Electronics , vol. 18, no. 6, 2003, pp. 1405 ‚Äì1412. Fig. 4, p. 1406. IEEE Transactions on Power Electronics by Institute of Electrical and Electronics Engineers; Power Electronics Council (Institute of Electrical and Electronic Engineers); IEEE PowerElectronics Society. Reproduced with permission of Institute of Electricaland Electronics Engineers, in the format Republish in a book via Copyright Clearance Center. 4Select a point on the close-up of the root locus that corresponds to a gain between 1 and 5.432 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:18 represents a time delay. This function can be approxi- mated by what is known as a Pad√© approximation. This approximation can take on many increasingly compli-cated forms, depending upon the degree of accuracyrequired. If we use the Pad√© approximation e  x¬à1 1¬áx¬áx2 2! then e 0:18s¬à61:73 s2¬á11:11s¬á61:73 Since the retinal light Ô¨Çux is a function of the opening of the iris, oscillations in the amount of retinal light Ô¨Çux imply oscillations of the iris ( Guy,1976 ). Find the following: a.The value of Kthat will yield oscillations b.The frequency of these oscillations c.The settling time for the iris if Kis such that the eye is operating with 20% overshoot Retinal light fluxExternal light flux + ‚Äì(s + 10)3Ke‚Äì0.18s FIGURE P8.16 Simpli Ô¨Åed block diagram of pupil servomechanism 58.A hard disk drive (HDD) arm has an open-loop unstabletransfer function, P s¬Ü¬àX s¬Ü F s¬Ü¬à1 Ibs2 where X(s) is arm displacement and F(s) is the applied force ( Yan,2003 ). Assume the arm has an inertia of Ib¬à310 5kg-m2and that a lead controller, Gc s¬Ü (used to improve transient response and discussed inChapter 9), is placed in cascade to yield P s¬ÜG c s¬Ü¬àG s¬Ü¬àK Ib s¬á1¬Ü s2 s¬á10¬Ü as in Figure P8.3. a.Plot the root locus of the system as a function of K. b.Find the value of Kthat will result in dominant complex conjugate poles with a Œ∂¬à0:7 damping factor. 59.A robotic manipulator together with a cascade PIcontroller (used to improve steady-state response anddiscussed in Chapter 9) has a transfer function ( Low,2005) G s¬Ü¬à K p¬áK1 s/C18/C1948;500 s2¬á2:89s Assume the robot ‚Äôs joint will be controlled in the con- Ô¨Åguration shown in Figure P8.3. a.Find the value of KIthat will result in ess¬à2%for a parabolic input. b.Using the value of KIfound in Part a, plot the root locus of the system as a function of KP. c.Find the value of KPthat will result in a real pole at  1. Find the location of the other two poles. 60.Wind turbines, such as the one shown in Figure P8.17( a), are becoming popular as a way of generating electricity. Feedback control loops are designed to control the output power of the turbine, given an input power demand.Blade-pitch control may be used as part of the controlloop for a constant-speed, pitch-controlled wind turbine,as shown in Figure P8.17( b). The drivetrain, consisting of the windmill rotor, gearbox, and electric generator (seeFigure P8.17( c)), is part of the control loop. The torque created by the wind drives the rotor. The windmill rotor is connected to the generator through a gearbox. The transfer function of the drivetrain is Po s¬Ü TR s¬Ü¬àGdt s¬Ü ¬à3:92KLSSKHSSKGN2s fN2KHSSJRs2¬áKLSS ¬Ü JGs2œÑels¬á1 ¬â¬ä ¬áKGs¬Ü¬áJRs2KLSS¬â JGs2¬áKHSS¬Ü œÑels¬á1¬Ü¬áKGs¬äg where Po s¬Üis the Laplace transform of the output power from the generator and TR s¬Üis the Laplace transform of the input torque on the rotor. Substituting typical numerical values into the transfer function yields Po s¬Ü TR s¬Ü¬àGdt s¬Ü ¬à 3:92¬Ü 12:6106¬Ü 301103¬Ü 688¬ÜN2s fN2 301103¬Ü 190;120s2¬á12:6106¬Ü  3:8s2¬â2010 3s¬á1¬ä¬á668s¬Ü ¬á190;120s2 12:6106¬Ü ¬â 3:8s2¬á301103¬Ü  2010 3s¬á1¬Ü¬á668s¬äg (Anderson ,1998 ). Do the following for the drivetrain dynamics, making use of any computational aids at yourdisposal:Problems 433WEBC08 10/28/2014 17:56:18 + ‚Äì+++++ ‚ÄìPower controllerPitch actuator Power transducerRotor pitch sensitivityRotor gust sensitivity Pitch inertiaDrivetrainWindspeed disturbance Applied momentDisturbance momentPitch demandElectrical po werPower demandControl surface aerodynamics (b)Pitch angleShaft torque (c)Rotor inertia JRLow-speed shaft stiffness KLSS Gearbox Ratio NHigh-speed shaft stiffness KHSS GeneratorInertia J g, Generator gain KG, Time constant œÑel FIGURE P8.17 a.Wind turbines generating electricity near Palm Springs, California; b.control loop for a constant-speed pitch-controlled wind turbine;5c.drivetrain5 5Adapted from Anderson, C. G., Richon, J-B., and Campbell, T. J. An Aerodynamic Moment-Controlled Surface for Gust Load Alleviation on Wind Turbine Rotors, IEEE Transactions on Control System Technology , vol. 6, no. 5, September 1998, pp. 577 ‚Äì595.ÓÄÇ1998 IEEE.434 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:19 a.Sketch a root locus that shows the pole locations of Gdt(s) for different values of gear ratio, N. b.Find the value of Nthat yields a pair of complex poles of Gdt(s) with a damping ratio of 0.5. 61.An active system for the elimination of Ô¨Çoor vibrations due to human presence ispresented in ( Nyawako, 2009 ) . The system consists of a sensor that measures theÔ¨Çoor‚Äôs vertical acceleration and an actu- ator that changes the Ô¨Çoor characteris- tics. The open-loop transmission of the particular setup used can be described byG s¬Ü¬àKG a s¬ÜF s¬ÜGm s¬Ü, where the actua- tor‚Äôs transfer function is Ga s¬Ü¬à10:26 s2¬á11:31s¬á127:9 TheÔ¨Çoor‚Äôs dynamic charactristics can be modeled by F s¬Ü¬à6:667 10 5s2 s2¬á0:2287 s¬á817:3 The sensor ‚Äôs transfer function is Gm s¬Ü¬às s2¬á5:181s¬á22:18 andKis the gain of the controller. The system operations can be described by theunity-gain feedback loop of Figure P8.3. a.Use MATLAB ‚Äôs SISO Design Tool to obtain the root locus of the system in termsofK. b.Find the range of Kfor closed-loop stability. c.Find, if possible, a value of Kthat will yield a closed-loop overdampedresponse. 62.Many implantable medical devices such as pacemakers,retinal implants, deep brain stimulators, and spinal cordstimulators are powered by an in-body battery that can becharged througha transcutaneous inductive device.Opti-mal battery charge can be obtained when the out-of-bodycharging circuit is in resonance with the implanted charging circuit ( Baker, 2007 ). Under certain conditions, the coupling of both resonant circuits can be modeled by the feedback system in Figure P8.3 where G s¬Ü¬à Ks4 s2¬á2Œ∂œâns¬áœâ2 n/C0/C12The gain Kis related to the magnetic coupling between the external and in-body circuits. Kmay vary due to positioning, skin conditions, and other variations. For this problem let Œ∂¬à0:5 and œân¬à1. a.Find the range of Kfor closed-loop stability. b.Draw the corresponding root locus. 63.It is important to precisely control the amount of organic fertilizer applied to a speci Ô¨Åc crop area in order to providespeci Ô¨Åc nutrient quantities and to avoid unnecessary environmentalpollution. A precise delivery liquidmanure machine has been developed forthis purpose (Saeys, 2008). The system consists of a pressurized tank, a valve, and a rheological Ô¨Çow sensor. After simpliÔ¨Å cation, the system can be modeled as a closed-loop negative-feedback system with a forward-pathtransfer function G s¬Ü¬à 2057 :38K s2 120s¬á4800 ¬Ü s s¬á13:17¬Ü s2¬á120s¬á4800 ¬Ü consisting of an electrohydraulic sys-tem in cascade with the gain of the manureÔ¨Çow valve and a variable gain, K. The feedback path is comprised of H s¬Ü¬à 10 s2 4s¬á5:333¬Ü s¬á10¬Ü s2¬á4s¬á5:333¬Ü a.Use the SISO Design Tool in MATLAB toobtain the root locus of the system. b.Use the SISO Design Tool to Ô¨Ånd the range of Kfor closed-loop stability. c.Find the value of Kthat will result in the smallest settling time for thissystem. d.Calculate the expected settling timefor a step input with the value of K obtained in Part c. e.Check your result through a step-response simulation. Harmonic drives are verypopular for use in roboticmanipulators due to their low backlash, high torque transmission, and compact size ( Spong, 2006 ) . The problem of jointProblems 435WEBC08 10/28/2014 17:56:20 Ô¨Çexibility is sometimes a limiting factor in achieving good performance. Consider that the idealized model representingjoint Ô¨Çexibility is shown in Figure P8.18. The input to the drive is from an actuatorand is applied at Œ∏ m. The output is connected to a load at Œ∏l. The spring represents the joint Ô¨Çexibility and Bm andBlrepresent the viscous damping of the actuator and load, respectively.Now we insert the device into the feedbackloop shown in Figure P8.19. The Ô¨Årst block in the forward path is a PD controller,which we will study in the next chapter.The PD controller is used to improvetransient response performance. BmŒ∏ Œ∏m u k JmJ B FIGURE P8.18 Idealized model representing joint Ô¨Çexibility7 Kp + KDsk r+ + + ‚Äìk Œ∏mŒ∏i1 pm(s) FIGURE P8.19 Joint Ô¨Çexibility model inserted in feedback loop8 Use MATLAB to Ô¨Ånd the gain KDto yield an approximate 5% overshoot in the stepresponse given the following parameters: J l=10;Bl=1;k=100; Jm=2;Bm=0.5;KP KD¬à 0:25;pl s¬Ü¬àJls2¬áBls¬ák;andpm s¬Ü¬àJms2¬á Bms¬ák 65.Using LabVIEW, the Control Design and Simulation Module , and the MathScript RT Module, open and customize the Interactive Root Locus VI from the Examples to implement the system ofProblem 64. Select the parameter K Dtomeet the requirement of Problem 64 by varying the location of the closed-loop poles onthe root locus.Besure your frontpanel shows the following: (1) open-looptransfer function, (2) closed-loop trans-fer function, (3) root locus, (4) list ofclosed-loop poles, and (5) step response. An automatic regulator is usedto control the Ô¨Åeld current of a three-phase synchronous machine withidentical symmetrical armature windings(Stapleton,1964 ) .Thepurposeofthereg- ulator is to maintain the system voltageconstant within certain limits. Thetransfer function of the synchronousmachine is G sm s¬Ü¬àŒîŒ¥ s¬Ü ŒîPm s¬Ü¬àM s z1¬Ü s z2¬Ü s p1¬Ü s p2¬Ü s p3¬Ü which relates the variation of rotor angle, ŒîŒ¥s ¬Ü, to the change in the syn- chronous machine ‚Äôs shaft power, ŒîPms ¬Ü. The closed-loop system is shown inFigure P8.3, where Gs ¬Ü ¬à KG Cs ¬ÜGsms ¬ÜandK is a gain to be adjusted. The regulator ‚Äôs transfer function, Gc(s), is given by Gc s¬Ü¬àŒº. Te s¬á1 Te Assume the following parameter values: Œº¬à4;M¬à0:117;Te¬à0:5;z1;2¬à 0:071 j6:25; p1¬à 0:047;andp2;3¬à 0:262 j5:1; and do the following: Write a MATLAB M- Ô¨Åle to plot the root locus for the system and to Ô¨Ånd the following: a.The gain Kat which the system becomes marginally stable b.The closed-loop poles, p, and transfer function, T(s) , corresponding to a 16% overshoot c.The coordinates of the point selectedon the root-locus corresponding to 16%overshoot d.A simulation of the unit-step responseof the closed-loop system correspond-ing to your 16% overshoot design. Note 7Spong, M., Hutchinson, S., and Vidyasagar, M. Robot Modeling and Control . John Wiley & Sons, Hoboken, NJ, 2006. Figure 6.20, p. 221. 8Spong, M., Hutchinson, S., and Vidyasagar, M. Robot Modeling and Control . John Wiley & Sons, Hoboken, NJ, 2006. Figure 6.24, p. 224.436 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:20 in your simulation the following values: (1) actual percent overshoot, (2)corresponding peak time, Tp, (3)rise time, Tr,(4) settling time, Ts, and (5) Ô¨Ånal steady-state value. 67.It is well known that when a person ingests a signi Ô¨Å- cant amount of water, the blood volume increases,causing an increase in arterial blood pressure until thekidneys are able to excrete the excess volume and thepressure returns to normal ( Shahin, 2010). In order to describe mathematically this process, water-loadingexperiments are performed in various subjects whiletheir mean arterial pressure is monitored. It wasfound that the open-loop transfer function of this process is G s¬Ü¬à bp 1:759s3¬á2:318s2¬á2:17310 4¬Ü 3:362s3¬á11:34s2¬á7:803s¬á0:00293 where bpis an autonomous nervous activity parameter. a.Make a sketch of the root locus of the system, indicat-ing the breakaway points and the value of b pfor each point. b.Indicate the range of bpfor which the system is overdamped. c.Indicate the values of bpfor which the system is critically damped. d.Indicate the range of bpfor which the system is underdamped. e.Explain why the system will have a larger settling time for larger values of bp68.One of the treatments for Parkinson ‚Äôs disease in some patients is Deep Brain Stimulation (DBS) ( Davidson , 2012 ). In DBS a set of electrodes is surgically implanted and a vibrating current is applied to the subthalamicnucleus, also known as a brain pacemaker. Root locushas been used on a linearized model of the system to helpexplain the dynamics of DBS. The DBS model can be obtained by substituting G s¬Ü¬à ks s b¬Ü2 b>0¬Üin the unity-feedback diagram of Figure P8.3. a.Make a sketch of the resulting root locus as a function ofkandÔ¨Ånd the break-in point and its corresponding value of gain. b.Find the range of kfor closed-loop stability in terms of b. c.Find the frequency of oscillation when the system hasclosed-loop poles on the jœâaxis. 69.A linear dynamic model of the Œ±-subsystem of a grid- connected voltage-source converter (VSC) using a Y-Ytransformer is shown in Figure P8.20( a)(Mahmood ,2012 ). Here, C¬à135ŒºF;R 1¬à0:016Œ©;L1¬à0:14 mH ;R2¬à 0:014Œ©;L2¬à10ŒºH;Rg¬à1:1Œ©;andLg¬à0:5m H . a.Find the transfer function GP s¬Ü¬àVŒ± s¬Ü MŒ± s¬Ü. b.IfGP(s) is the plant in Figure P8.20(b )a n dG C(s)=K, use MATLAB to plot the root locus. On acloseup of the locus (from  300 to 0 on the real axis and from  50 to 5000 on the imaginary axis), Ô¨ÅndKand the GC(s) GP(s)+ ‚ÄìMŒ±(s) C(s) = V Œ±(s) R(s) = Vr(s) (b)(a)1 3Cs(R1+ L1s)+‚Äì++ ‚Äì‚Äì17.33 (Rg + Lgs)(R1+ L1s) 17.33 (Rg + Lgs) 17.331 L2s + R2MŒ±(s) VŒ±(s) VcŒ±(s) FIGURE P8.20Problems 437WEBC08 10/28/2014 17:56:21 coordinates of the dominant poles, which correspond to Œ∂=0.012. Plot the output response, c(t) =vŒ±(t), at that value of the gain when a step input, r(t)=vr(t)=208u(t) volts, is applied att=0. Mark on the time response graph, c(t) , all relevant character- istics, such as the percent overshoot,peak time, rise time, settling time, andÔ¨Ånal steady-state value. PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 70.Control of HIV/AIDS. In the linearized model of Chapter 6, Problem 68, where virus levels are controlled by means of RTIs, the open-loop plant transfer functionwas shown to be P s¬Ü¬à Y s¬Ü U1 s¬Ü¬à 520 s 10:3844 s3¬á2:6817 s2¬á0:11s¬á0:0126 The amount of RTIs delivered to the patient willautomatically be calculated by embedding the patientin the control loop as G(s) shown in Figure P6.17 (Craig ,2004). a.In the simplest case, G s¬Ü¬àK, with K>0. Note that this effectively creates a positive-feedback loopbecause the negative sign in the numerator of P(s) cancels out with the negative-feedback sign in thesumming junction. Use positive-feedback rules toplot the root locus of the system. b.Now assume G s¬Ü¬à  Kwith K>0. The system is now a negative-feedback system. Use negative-feed-backrules to draw the root locus. Show that in thiscasethe system will be closed-loop stable for all K>0. Hybrid vehicle. In Chapter 7, Figure P7.31 shows the blockdiagram of the speed control of an HEVrearranged as a unity feedback system (Preitl , 2007) . Let the transfer function of the speedcontroller be G SC s¬Ü¬àKPsc¬áKIsc s¬àKPscs¬áKIsc KPsc/C18/C19 sa.Assume Ô¨Årst that the speed controller is con Ô¨Ågured as a proportional controller KISC¬à0 and/C0 GSCs ¬Ü ¬à KPSC. Calculate the forward- path open-loop poles. Now use MATLABto plot the system‚Äô s root locus and Ô¨Ånd the gain, K PSCthat yields a critically damped closed-loopresponse.Finally,plot the time-domain response, c(t), for a unit-step input using MATLAB.Note on the curve the rise time, T r, and settling time, Ts. b.Now add an integral gain, KISC, to the controller, such that KISC=KPSC¬à0:4. Use MATLAB to plot the root locus and Ô¨Ånd the proportional gain, KPSC, that could lead to a closed- loop unit-step response with 10%overshoot. Plot c(t) using MATLAB and note on the curve the peak time, T p,a n d settling time, Ts. Does the response obtained resembleasecond-orderunder- damped response? 72.Parabolic trough collector. Consider the Ô¨Çuid temperature control of a parabolic trough collector(Camocho ,2012 ) embedded in the unity feedback structure as shown in Figure P8.3, where the open-loopplant transfer function is given by G s¬Ü¬à 137:210 6K s2¬á0:0224 s¬á19610 6e 39s Approximating the time-delay term with e sT1 T 2s 1¬áT 2s, make a sketch of the resulting root locus (Note: Aftersubstituting the approximation, G ‚àû¬Ü<0, the positive feedback rules of Section 8.9 must be used). Markwhere appropriate in the plot and Ô¨Ånd: a.The asymptotes and their intersection with the realaxis; b.The break-in and breakaway points. (The procedures presented in Section 8.5 are also valid for positive feedback systems); c.The range of Kfor closed-loop stability; d.The value of Kthat will make the system oscillate and the oscillation frequency.438 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:21 Cyber Exploration Laboratory Experiment 8.1 Objectives To verify the effect of open-loop poles and zeros upon the shape of the root locus. To verify the root locus as a tool for estimating the effect of open-loop gain upon the transient response of closed-loop systems. Minimum Required Software Packages MATLAB and the Control System Toolbox Prelab 1.Sketch two possibilities for the root locus of a unity negative-feedback system with theopen-loop pole-zero con Ô¨Åguration shown in Figure P8.21. 2.If the open-loop system of Prelab 1 is G s¬Ü¬àK s¬á1:5¬Ü s s¬á0:5¬Ü s¬á10¬Ü, estimate the percent overshoot at the following values of gain, K: 20, 50, 85, 200, and 700. Lab 1.Using Matlab ‚Äôs SISO Design Tool, set up a negative unity feedback system with G s¬Ü¬àK s¬á6¬Ü s s¬á0:5¬Ü s¬á10¬Ü to produce a root locus. For convenience, set up the zero at  6 using SISO Design Tool‚Äôs compensator function by simply dragging a zero to  6 on the resulting root locus. Print the root locus for the zero at  6. Move the zero to the following locations and print out a root locus at each location:  2, 1:5, 1:37, and  1:2. 2.Using Matlab ‚Äôs SISO Design Tool, set up a negative unity feedback system with G s¬Ü¬àK s¬á1:5¬Ü s s¬á0:5¬Ü s¬á10¬Ü to produce a root locus. Open the LTI Viewer for SISO Design Tool to show stepresponses. Using the values of K speci Ô¨Åed in Prelab 2, record the percent overshoot and settling time and print the root loci and step response for each value of K. Postlab 1.Discuss your Ô¨Åndings from Prelab 1 and Lab 1. What conclusions can you draw? 2.Make a table comparing percent overshoot and settling time from your calculations inPrelab 2 and your experimental values found in Lab 2. Discuss the reasons for anydiscrepancies. What conclusions can you draw?jœâ œÉ FIGURE P8.21Cyber Exploration Laboratory 439WEBC08 10/28/2014 17:56:22 Experiment 8.2 Objective To use MATLAB to design the gain of a controller via root locus. Minimum Required Software Package MATLAB with the Control Systems Toolbox. Prelab The open-loop system dynamics model for the NASA eight-axis Advanced Research Manipulator II (ARM II) electromechanical shoulder joint/link, actuated by an armature-controlled dc servomotor is shown in Figure P8.22. The ARM II shoulder joint c onstant parameters are Ka=12,L=0.006 H, R=1.4Œ©, Kb=0.00867, n=200, Km=4.375, J=Jm+JL/n2,D=Dm+DL/n2,JL=1,DL=0.5,Jm= 0.00844, and Dm=0.00013 ( Craig, 2005 ), (Nyzen, 1999 ), and (Williams, 1994 ). a.Obtain the equivalent open-loop transfer function, G s¬Ü¬àŒ∏L s¬Ü Vref s¬Ü. b.The loop is to be closed by cascading a controller, Gc s¬Ü¬àKDs¬áKP, with G(s)i n the forward path forming an equivalent forward-transfer function, Ge s¬Ü¬àGc s¬ÜG s¬Ü. Parameters of Gc(s) will be used to design a desired transient performance. The input to the closed-loop system is a voltage, VI s¬Ü, representing the desired angular displacement of the robotic joint with a ratio of 1 volt equals 1 radian. The output of the closed-loop system is the actual angular displacement of the joint, Œ∏L s¬Ü. An encoder in the feedback path, Ke, converts the actual joint displacement to a voltage with a ratio of 1 radian equals 1 volt. Draw the closed-loop system showing all transfer functions. c.Find the closed-loop transfer function. Lab LetKP KD¬à4 and use MATLAB to design the value of KDto yield a step response with a maximum percent overshoot of 0.2%. Postlab 1.Discuss the success of your design. 2.Is the steady-state error what you would expect? Give reasons for your answer. Experiment 8.3 Objective To use LabVIEW to design the gain of a controller via root locus. Minimum Required Software Package LabVIEW with the Control Design and Simulation Module, and the MathScript RT Module. Prelab Complete the Prelab to Experiment 8.2 if you have not already done so. Lab LetKP KD¬à4. Use LabVIEW to open and customize the Interactive Root Locus VI from the Examples in order to implement a design of KDto yield a step responseKa (Ls + R)(Js + D)Km 1/n s KbVrefAmp + _Armature circuit & motor dynamics Back emf Gears & integrator Œ∏L FIGURE P8.22 Open-loop model for ARM ll440 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:22 with a maximum percent overshoot of 0.2%. Use a hybrid graphical/MathScript approach. Postlab 1.Discuss the success of your design. 2.Is the steady-state error what you would expect? Give reasons for your answer. Hardware Interface Laboratory Experiment 8.4 Speed Control Using Gain Adjustment Objective To control the speed of a motor in closed-loop using gain compensation. To make observations about tradeoffs between the compensated transient response and the steady-state error. Material Required Computer with LabVIEW Installed; myDAQ; dc brushed gearmotor with Hall Sensor quadrature encoder (  10 V to +10 V normal operation range); and motor control chip BA6886N or a transistor circuit substitute Files Provided at www.wiley.com/college/nise Speed P Control Incomplete.viSignal Conditioning (subVI).vi Prelab Answer the following questions: 1.Find the closed-loop transfer function from R(s)toC(s) for the system in Figure P8.23. 2.Draw the root locus for the system. 3.Draw the unit-step response for the system marking the settling time, peak time, andmaximum output. 4.Find an expression for the steady-state error to a unit-step input for the system. Lab Software: TheSpeed P Control Incomplete.vi is provided and illustrated in Figure P 8 . 2 4 .Y o un e e dt om o d i f yi ta sf o l l o w sb e f o r ei tb e c o m e so p e r a t i o n a l . 1.You need to change the constant on the left to Ô¨Åt your motor ‚Äôs gear ratio and encoder CPR (counts per revolution) as shown in Figure P8.24( b). 2.You need to write a SubVI for a P controlle r and place it where the arrow indicates it in Figure P8.24( b). The function of a P controller is u¬àKPe. Your SubVI has two inputs, the system ‚Äôse r r o re and the proportional constant KP.I tw i l lh a v eo n e output u.KPK sœÑ + 1+ ‚ÄìC(s) R(s) FIGURE P8.23Hardware Interface Laboratory 441WEBC08 10/28/2014 17:56:22 3.Double-clicking on the Signal Conditioning (SubVI) , Figure P8.24( b), you get Figure P8.25. Modify the indicated constant to re Ô¨Çect the dead zone parameter of your motor. This SubVI limits the inpu t voltage to the motor controller and eliminates the dead zone by offsettin g the input to the motor controller. FIGURE P8.24 Speed P Control Incomplete.vi :a. Front Panel ;b. Block Diagram FIGURE P8.25 Signal Conditioning (SubVI).vi Block Diagram442 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:23 Hardware: Figure P8.26 is the hardware diagram for speed control. The diagram is identical to the one in Experiment 4.6, except that Pins 2 and 10 in the motor controller chip connect to digital lines D2 and D3 in the myDAQ to allow changes in motor direction. Procedure: 1.Verify the operation of your closed-loop system. 2.Draw a functional block diagram (similar to the ones shown in control systems textbooks) of the system. Do not include the signal conditioning functions, nor thechange-of-direction signals. 3.Using the transfer function you found in Experiment 4.6, draw the system‚Äô s root locus. 4.Find the theoretical range of K Pin which the system is closed-loop stable. 5.Run your program and system to Ô¨Ånd experimentally the range of KPin which the system is closed-loop stable. 6.Make a judicious choice of three different values of KPfor experimentation. 7.Using the transfer function you found previously and the three judicious choices ofproportional gain, complete the following table using hand calculations only (calculatorsOK, no computer simulations allowed). Show all your work. 5V DGND 7 6 5 4 32 1 0 1‚Äì 1+ 0‚Äì 0+ 1 0 ‚Äì15V +15VAO AGND AUDIO OUT AUDIO INAGNDAI ¬±10VDIO 0‚Äì5VMyDAQ1 2 3 4 5 678 9 1010Œ© 9VMotor BA6886Nwhite FIGURE P8.26 Wiring diagram9 9MyDAQ right slot shown on left is taken from Multisim program module NI myDAQ design and also reproduced in White-Paper 11423, Figure 2. Both Multisim and the White Paper are from National Instruments.Hardware Interface Laboratory 443WEBC08 10/28/2014 17:56:24 KP TP‚ÄîPeak time %OS‚ÄîPercent overshoot Ts‚ÄîSettling time ess‚ÄîSteady state error (step input) Theoretical 8.For each one of the three values of KP, perform step-input experiments; use one single value of step-input amplitude for the three values. Make sure that your oscilloscope captures contain the system ‚Äôs transient response in its entirety. Show measurements of all the parameters in the table above and Ô¨Åll in the following table. Please note that Ts, the settling time, is hard to measure in the current setting because of the limited number of analog channels present. Instead of measuring Ts, mark in your oscilloscope its theoretical value using the scope cursors. KP TP‚ÄîPeak time %OS‚ÄîPercent overshoot ess‚ÄîSteady-state error (step input) Experimental Postlab Make a detailed comparison of your theoretical and experimental results. Discuss similarities and discrepancies between experimental and theoretical values and givepossible reasons. Experiment 8.5 Position Control Using Gain Adjustment Objectives To control the angular position of the shaft of a permanent-magnet dc motor in closed-loop using gain compensation. To make observations about tradeoffs between the compensated transient response and the steady-state error. Material Required Computer with LabVIEW Installed; myDAQ; dc brushed gearmotor with Hall Sensor quadrature encoder (  10 V to +10 V normal operation range); and motor control chip BA6886N or a transistor circuit substitute. Files Provided at www.wiley.com/college/nise Position control.viSignal Conditioning (SubVI).viP Controller (SubVI).vi Prelab Answer the following questions: 1.For a given permanent-magnet dc motor it has been found that the transfer function from armature voltage Ea s¬Üto angular velocity Œ© s¬ÜisŒ© s¬Ü Ea s¬Ü¬àK œÑs¬á1. Find the transfer function of the motor from armature voltage to angular positionŒò s¬Ü Ea s¬Ü. 2.Draw the root locus for the system in Figure P8.27.444 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:24 3.Draw the unit-step response for the syst em marking the settling time, peak time, and maximum output. Find all the possibiliti es: overdamped, cr itically damped, and underdamped. 4.Find an expression for the steady-state error to a unit-step input for the system. Lab Software: The front panel and block diagram of the Position control.vi are shown in Figure P8.28. Change the constants inside the Signal Conditioning SubVI to match yourKPK s (sœÑ + 1)+ ‚ÄìC(s) R(s) FIGURE P8.27 FIGURE P8.28 Position control.vi :a.Front Panel ;b.Block DiagramHardware Interface Laboratory 445WEBC08 10/28/2014 17:56:25 dead zone parameters. The constant on the right of the diagram must be modi Ô¨Åed to match your motor ‚Äôs gear ratio. Hardware: Make the following changes to the wiring diagram shown in Figure P8.26: Move the connections from D1, D2, and D3 to D2, D3, and D4, respectively. All the other connections remain the same. Procedure: 1.Choose a small Pgain. Verify the operation of your closed-loop system. The motor should be able to move in both directions and through the full-scale range. 2.Using the transfer function found in Experiment 4.6, calculate the motor ‚Äôs transfer function from armature voltage to angular positionŒò s¬Ü Ea s¬Ü. 3.Draw a functional block diagram of the system. Do not include the signal conditioning functions, nor the change-of-direction signals. Label all the pertinent signals. 4.Using the transfer functionŒò s¬Ü Ea s¬Üyou just calculated, draw the system ‚Äôs root locus. 5.Find the theoretical range of KPfor which the system is closed-loop stable. 6.Run your program and system to Ô¨Ånd experimentally the range of KPfor which the system is closed-loop stable. 7.Make a judicious choice of three different values of KPfor experimentation. 8.Using the transfer function you calculated above and the three judicious choices ofproportional gain, complete the following table using hand calculations only (calculatorsOK, no computer simulations allowed). Show all your work. KP TP‚ÄîPeak time %OS‚ÄîPercent overshoot Ts‚ÄîSettling time ess‚ÄîSteady-state error (step input) Theoretical 9.For each one of the three values of KP, perform step-input experiments using one value of step input for the three values. Make sure that your oscilloscope captures contain thesystem ‚Äôs transient response in its entirety. Show measurements of all the parameters in the table above and Ô¨Åll in the following table. Please note that T s, the settling time, is hard to measure in the current setting because of the limited number of analog channelsavailable. Instead of measuring T s, mark in your oscilloscope its theoretical value using the scope cursors. KP TP‚ÄîPeak time %OS‚ÄîPercent overshoot ess‚ÄîSteady-state error (step input) Experimental446 Chapter 8 Root Locus TechniquesWEBC08 10/28/2014 17:56:25 Bibliography Anderson, C. G., Richon, J.-B., and Campbell, T. J. An Aerodynamic Moment-Controlled Surface for Gust Load Alleviation on Wind Turbine Rotors. IEEE Transactions on Control System Technology , vol. 6, no. 5, September 1998, pp. 577 ‚Äì595. √Östr√∂m, K., Klein, R. E., and Lennartsson, A. Bicycle Dynamics and Control. IEEE Control Systems , August 2005, pp. 26 ‚Äì47. Baker, M. W., and Sarpeshkar, R. Feedback Analysis and Design of RF Power Links for Low-Power Bionic Systems. IEEE Transactions on Biomedical, Circuits and Systems . vol. 1, 2007, pp. 28‚Äì38. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. Craig, J. J. Introduction to Robotics: Mechanics and Control , 3d ed. Prentice Hall, Upper Saddle River, NJ, 2005. Davidson, C. M., de Paor, A. M., and Lowery, M. M. Insights from Control Theory into Deep Brain Stimulation for Relief from Parkinson ‚Äôs Disease. IEEE, Proc. of the 9th Int. Conf. Elektro , 2012, pp. 2 ‚Äì7. Dorf, R. C. Modern Control Systems , 5th ed. Addison-Wesley, Reading, MA., 1989. Evans, W. R. Control System Synthesis by Root Locus Method. AIEE Transactions , vol. 69, 1950, pp. 66 ‚Äì69. Evans, W. R. Graphical Analysis of Control Systems. AIEE Transactions , vol. 67, 1948, pp. 547‚Äì551. Franklin, G. F., Powell, J. D., and Emami-Naeini, A. Feedback Control of Dynamic Systems , 2d ed. Addison-Wesley, Reading, MA., 1991. Galv√£o, K. H. R., Yoneyama, T., and de Ara√∫jo, F. M. U. A Simple Technique for Identifying a Linearized Model for a Didactic Magnetic Levitation System. IEEE Transactions on Education , vol. 46, no. 1, February 2003, pp. 22 ‚Äì25. Guy, W., The Human Pupil Servomechanism . Computers in Education Division of ASEE, Application Note No. 45, 1976. Hahn, J. O., Dumont, G. A., and Ansermino, J. M. System Identi Ô¨Åcation and Closed-Loop Control of End-Tidal CO 2in Mechanically Ventilated Patients. IEEE Transactions on Information Technology in Biomedicine , vol. 16, no. 6, November 2012, pp. 1176 ‚Äì2012. Hollot, C. V., Misra, V., Towsley, D., and Gong, W. A Control Theoretic Analysis of RED. Proceedings of IEEE INFOCOM , 2001, pp. 1510 ‚Äì1519. Johnson, H., et al. Unmanned Free-Swimming Submersible (UFSS) System Description. NRL Memorandum Report 4393. Naval Research Laboratory, Washington, D.C., 1980. Karlsson, P., and Svesson, J. DC Bus Voltage Control for a Distributed Power System. IEEE Trans. on Power Electronics , vol. 18, no. 6, 2003, pp. 1405 ‚Äì1412. Khammash, M., and El-Samad, H. Systems Biology: From Physiology to Gene Regulation. IEEE Control Systems , August 2004, pp. 62 ‚Äì76. Kuo, B. C. Automatic Control Systems , 6th ed. Prentice Hall, Upper Saddle River, NJ, 1991. Lam, C. S., Wong, M. C., and Han, Y. D. Stability Study on Dynamic Voltage Restorer (DVR). Power Electronics Systems and Applications 2004; Proceedings of the First International Conference on Power Electronics , 2004, pp. 66 ‚Äì71. Low, K. H., Wang, H., Liew, K. M., and Cai, Y. Modeling and Motion Control of Robotic Hand for Telemanipulation Application. International Journal of Software Engineering and Knowledge Engineering , vol. 15, 2005, pp. 147 ‚Äì152.Postlab Make a detailed comparison of your theoretical and experimental tables. Discuss similarities and discrepancies between experimental and theoretical results and give possible reasons.Bibliography 447WEBC08 10/28/2014 17:56:25 Mahmood, H., and Jiang, J. Modeling and Control System Design of a Grid Connected VSC Considering the Effect of the Interface Transformer Type. IEEE Transactions on Smart Grid, vol. 3, no. 1, March 2012, pp. 122 ‚Äì134. Nyawako, D., and Reynolds, P. Response-Dependent Velocity Feedback Control for Mitigation of Human-Induced Floor Vibrations. Smart Materials and Structures , vol. 18, IOP Publishing Ltd., UK, 2009, pp. 1 ‚Äì13. Nyzen, R. J. Analysis and Control of an Eight-Degree-of-Freedom Manipulator. Ohio University Masters Thesis, Mechanical Engineering, Dr. Robert L. Williams II, advisor, August 1999. Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Intelligence and Informatics, IEEE, 2007, pp. 157 ‚Äì162. Saeys, W., Deblander, J., Ramon, H., and Anthonis, J. High-Performance Flow Control for Site-Speci Ô¨Åc Application of Liquid Manure. Biosystems Engineering , vol. 99, 2008, pp. 22 ‚Äì34. Shahin, M., and Maka, S. A Transfer Function Method for the Assessment of Nervous System Modulation of Long-Term Dynamics of Blood Pressure. IEEE International Conf. on Communi- cation, Control, and Computing , IEEE 2010, pp. 560 ‚Äì564. Spong, M., Hutchinson, S., and Vidyasagar, M. Robot Modeling and Control . John Wiley & Sons, Hoboken, NJ, 2006. Stapleton, C.A. Root-Locus Study of Synchronous-Machine Regulation. IEE Proceedings , vol. 111, issue 4, 1964, pp. 761 ‚Äì768. Thomsen, S., Hoffmann, N., and Fuchs, F. W. PI Control, PI-Based State Space Control, and Model- Based Predictive Control for Drive Systems With Elastically Coupled Loads ‚ÄîA Comparative Study. IEEE Transactions on Industrial Electronics , vol. 58, no. 8, August 2011, pp. 3647 ‚Äì3657. √únyeliog ÃÜlu, K. A., Hatopog ÃÜlu, C., and √ñzg√ºner, √ú. Design and Stability Analysis of a Lane Following Controller. IEEE Transactions on Control Systems Technology , vol. 5, 1997, pp. 127 ‚Äì134. Williams, R. L. II. Local Performance Optimization for a Class of Redundant Eight-Degree-of- Freedom Manipulators. NASA Technical Paper 3417 , NASA Langley Research Center, Hampton VA, March 1994. Yamazaki, H., Marumo, Y., Iizuka, Y., and Tsunashima, H. Driver Model Simulation for Railway Brake Systems. Fourth IET Int. Conf. on Railway Condition Monitoring , 2008. Yan, T., and Lin, R. Experimental Modeling and Compensation of Pivot Nonlinearity in Hard Disk Drives. IEEE Transactions on Magnetics , vol. 39, 2003, pp. 1064 ‚Äì1069.448 Chapter 8 Root Locus TechniquesWEBC09 10/28/2014 18:1:31 Design via Root Locus Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅUse the root locus to design cascade compensators to improve the steady-state error (Sections 9.1 ‚Äì9.2) ¬ÅUse the root locus to design cascade compensators to improve the transientresponse (Section 9.3) ¬ÅUse the root locus to design cascade compensators to improve both thesteady-state error and the transient response (Section 9.4) ¬ÅUse the root locus to design feedback compensators to improve the transientresponse (Section 9.5) ¬ÅRealize the designed compensators physically (Section 9.6) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with casestudies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to design a cascade compensator to meet transientresponse and steady-state error speci Ô¨Åcations. ¬ÅGiven the pitch or heading control system for the UFSS vehicle shown on theback endpapers, you will be able to design a cascade or feedback compensatorto meet transient response speci Ô¨Åcations.9 449WEBC09 10/28/2014 18:1:31 9.1 Introduction In Chapter 8, we saw that the root locus graphically displayed both transient response and stability information. The locus can be sketched quickly to get a general idea of the changesin transient response generated by changes in gain. Speci Ô¨Åc points on the locus also can be found accurately to give quantitative design information. The root locus typically allows us to choose the proper loop gain to meet a transient response speci Ô¨Åcation. As the gain is varied, we mo ve through different regions of response. Setting the gain at a p articular value yields the transient response dictated by the poles at that point on the root locus. Thus, we are limited to those responses that exist along the root locus . Improving Transient Response Flexibility in the design of a desired transient response can be increased if we can design fortransient responses that are not on the root locus. Figure 9.1( a) illustrates the concept. Assume that the desired transient response, de Ô¨Åned by percent overshoot and settling time, is represented by point B. Unfortunately, on the current root locus at the speci Ô¨Åed percent overshoot, we only can obtain the settling time represented by point Aafter a simple gain adjustment. Thus, our goal is to speed up the response at Ato that of B, without affecting the percent overshoot. This increase in speed cannot be accomplished by a simple gainadjustment, since point Bdoes not lie on the root locus. Figure 9.1(b ) illustrates the improvement in the transient response we seek: The faster response has the same percentovershoot as the slower response. One way to solve our problem is to replace the existing system with a system whose root locus intersects the desired design point, B. Unfortunately, this replacement is expensive and counterproductive. Most systems are chosen for characteristics other than transient s-planeAB (a) (b)jœâ œÉ c(t) tPoles at BPoles at A = Closed-loop pole = Open-loop pole FIGURE 9.1 a.Sample root locus, showing possible design point via gain adjustment (A) and desired design point that cannot be met via simple gainadjustment (B );b.responses from poles at AandB450 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:31 response. For example, an elevator cage and motor are chosen for speed and power. Components chosen for their transient response may not necessarily meet, for example, power requirements. Rather than change the existing system, we augment, or compensate , the system with additional poles and zeros, so that the compensated system has a root locus that goes through the desired pole location for some value of gain. One of the advantages ofcompensating a system in this way is that additional poles and zeros can be added atthe low-power end of the system before the plant. Addition of compensating poles and zerosneed not interfere with the power output requirements of the system or present additional load or design problems. The compensating poles and zeros can be generated with a passive or an active network. A possible disadvantage of compensating a system with additional open-loop poles and zeros is that the system order can increase, with a subsequent effect on the desiredresponse. In Chapters 4 and 8, we discussed the effect of additional closed-loop polesand zeros on the transient response. At the beginning of the design process discussed inthis chapter, we determine the proper location of additional open-loop poles and zeros to yield the desired second-order closed-loop poles. However, we do not know the location of the higher-order closed-loop poles until the end of the design. Thus, we should evaluate the transient response through simulation after the design is complete to be sure therequirements have been met. In Chapter 12, when we discuss state-space design, the disadvantage of Ô¨Ånding the location of higher-order closed-loop poles after the design will be eliminated. Techniquesthat allow the designer to specify and design the location of all the closed-loop poles at thebeginning of the design process. One method of compensating for transient re sponse, that will be discussed later, is t oi n s e r tad i f f e r e n t i a t o ri nt h ef o r w a r dp a t hi np a r a l l e lw i t ht h eg a i n .W ec a nv i s u a l i z et h eoperation of the differentiator with the fol lowing example. Assuming a position control with a step input, we note that the error undergoes an initial large change. Differentiatingthis rapid change yields a large signal that drives the plant. The output from thedifferentiator is much larger than the output from the pure gain. This large, initial inputto the plant produces a faster response. As the error approaches its Ô¨Ånal value, its derivative approaches zero, and the output from the differentiator becomes negligiblecompared to the output from the gain. Improving Steady-State Error Compensators are not only used to improve the transient response of a system; they are alsoused independently to improve the steady-state error characteristics. Previously, when the system gain was adjusted to meet the transient response speci Ô¨Åcation, steady-state error performance deteriorated, since both the transient response and the static error constant wererelated to the gain. The higher the gain, the smaller the steady-state error, but the largerthe percent overshoot. On the other hand, reducing gain to reduce overshoot increased thesteady-state error. If we use dynamic compensators, compensating networks can be designedthat will allow us to meet transient and steady-state error speci Ô¨Åcations simultaneously . 1We no longer need to compromise between transient response and steady-state error, as long as thesystem operates in its linear range. In Chapter 7, we learned that steady-state error can be improved by adding an open-loop pole at the origin in the forward path, thus increasing the system type and driving theassociated steady-state error to zero. This additional pole at the origin requires an integratorfor its realization. 1The word dynamic describes compensators with noninstantaneous transient response. The transfer functions of such compensators are functions of the Laplace variable, s, rather than pure gain.9.1 Introduction 451WEBC09 10/28/2014 18:1:31 In summary, then, transient response is improved with the addition of differentiation, and steady-state error is improved with the addition of integration in the forward path. ConÔ¨Ågurations Two conÔ¨Å gurations of compensation are covered in this chapter: cascade compensation and feedback compensation. These methods are modeled in Figure 9.2. With cascade compensation, the compensating network, G1(s), is placed at the low-power end of the forward path in cascade with the plant. If feedback compensation is used, thecompensator, H 1(s), is placed in the feedback path. Both methods change the open-loop poles and zeros, thereby creating a new root locus that goes through the desired closed-looppole location. Compensators Compensators that use pure integration for improving steady-state error or pure differentia-tion for improving transient response are de Ô¨Åned as ideal compensators . Ideal compensators must be implemented with active networks, which, in the case of electric networks, requirethe use of active ampli Ô¨Åers and possible additional power sources. An advantage of ideal integral compensators is that steady-state error is reduced to zero. Electromechanical idealcompensators, such as tachometers, are often used to improve transient response, since they can be conveniently interfaced with the plant. Other design techniques that preclude the use of active devices for compensation can be adopted. These compensators, which can be implemented with passive elements such as resistors and capacitors, do not use p ure integration and di fferentiation and are not ideal compensators. Advantages of passive networks are that they are less expensiveand do not require additional power sources for their operation. Their disadvantage isthat the steady-state error is not driven to zero in cases where ideal compensators yieldzero error. Thus, the choice between an active or a passive compensator revolves around cost, weight, desired performance, transfer function, and the interface between the compensatorand other hardware. In Sections 9.2, 9.3, and 9.4, we Ô¨Årst discuss cascade compensatorR(s) C(s) G1(s)Cascade compensator Plant (a) (b)R(s) C(s) G1(s)Original controller PlantOriginal controller G2(s) G3(s) G2(s) H1(s)+ ‚Äì + ‚Äì Feedback compensator FIGURE 9.2 Compensation techniques: a.cascade; b.feedback452 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:31 design using ideal compensation and follow with cascade compensation using compensators that are not implemented with pure integration and differentiation. 9.2 Improving Steady-State Error via Cascade Compensation In this section, we discuss two ways to im prove the steady-state error of a feedback control system using cascade compensation. One objective of this design is to improve the steady-state error without appreciably affecting the transient response. TheÔ¨Årst technique is ideal integral compensation , which uses a pure integrator to place an open-loop, forward-path pole at the origin, thus increasing the system type and reducing the error to zero. The second technique does not use pure integration.This compensation technique places the pole near the origin, and although it doesnot drive the steady-state error to zero, it does yield a measurable reduction in steady-state error. While the Ô¨Årst technique reduces the steady-state error to zero, the compensator must be implemented with active networks, such as ampli Ô¨Åers. The second technique, although it does not reduce the error to zero, does have the advantage that it can be implemented with a less expensive passi ve network that does not require additional power sources. The names associated with the compensators come either from the method of implementing the compensator or from the compensator ‚Äôs characteristics. Systems that feed the error forward to the plant are called proportional control systems . Systems that feed the integral of the error to the plant are called integral control systems . Finally, systems that feed the derivative of the error to the plant are called derivative control systems . Thus, in this section we call the ideal integral compensator a proportional-plus-integral (PI)controller , since the implementation, as we will see, consists of feeding the error (proportional) plus the integral of the error forward to the plant. The second technique uses what we call alag compensator . The name of this compensator comes from its frequency response characteristics, which will be discussed in Chapter 11. Thus, we use the name PI controller interchangeably with ideal integral compensator , and we use the name lag compensator when the cascade compensator does not employ pure integration. Ideal Integral Compensation (PI) Steady-state error can be improved by placing an open-loop pole at the origin, because this increases the system type by one. For example, a Type 0 system responding to a step input with a Ô¨Ånite error responds with zero error if the system type is increased by one. Active circuits can be used to place poles at the origin. Later in this chapter, we show how to buildan integrator with active electronic circuits. To see how to improve the steady-state error without affecting the transient response, look at Figure 9.3( a). Here we have a system operating with a desirable transient response generated by the closed-loop poles at A. If we add a pole at the origin to increase the system type, the angular contribution of the open-loop poles at point Ais no longer 180 ¬∞, and the root locus no longer goes through point A, as shown in Figure 9.3( b). To solve the problem, we also add a zero close to the pole at the origin, as shown in Figure 9.3(c ). Now the angular contribution of the compensator zero and compensator pole cancel out, point Ais still on the root locus, and the system type has been increased. Furthermore, the required gain at the dominant pole is about the same as before compensation, since the ratioof lengths from the compensator pole and the compensator zero is approximately unity. Thus,we have improved the steady-state error without appreciably affecting the transient response.9.2 Improving Steady-State Error via Cascade Compensation 453WEBC09 10/28/2014 18:1:31 A compensator with a pole at the origin and a zero close to the pole is called an ideal integral compensator . In the example that follows, we demonstrate the effect of ideal integral compensation. An open-loop pole will be placed at the origin to increase the system type and drive the steady-state error to zero. An open-loop zero will be placed very close to the open-loop poleat the origin so that the original closed-loop poles on the original root locus still remain atapproximately the same points on the compensated root locus.s-planejœâ œÉ Œ∏1= (2k + 1)180¬∞ (a)A ‚ÄìŒ∏2‚ÄìŒ∏Œ∏1 Œ∏3 3 ‚Äì2Œ∏R(s) + ‚ÄìC(s)G(s)Plant Gain K s-planejœâ œÉ Œ∏1 (b)A Œ∏2Œ∏3Œ∏cŒ∏ Œ∏R(s) + ‚ÄìC(s)G(s)Plant KCompensator Œ∏c 21 (2k + 1)180¬∞ ‚Äì ‚Äì‚Äì ‚ÄìŒ∏3s (c)R(s) + ‚ÄìC(s)Plant Compensator K(s + a)G(s) Œ∏zc Œ∏pcs-planejœâ A Œ∏1 Œ∏3 +Œ∏zc Œ∏1‚ÄìŒ∏2‚ÄìŒ∏3‚ÄìŒ∏pc (2k + 1)180¬∞œÉ ‚ÄìŒ∏2s FIGURE 9.3 Pole at Aisa.on the root locus without compensator; b.not on the root locus with compensator pole added; c.approximately on the root locus with compensator pole and zero added454 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:32 Example 9.1 Effect of an Ideal Integral CompensatorEffect of an Ideal Integral Compensator PROBLEM: Given the system of Figure 9.4( a), operating with a damping ratio of 0.174, show that the addition of the ideal integral compensator shown in Figure 9.4( b) reduces the steady-state error to zero for a step input without appreciably affecting transient response. The compensating network is chosen with a pole at the origin to increase thesystem type and a zero at  0:1, close to the compensator pole, so that the angular contribution of the compensator evaluated at the original, dominant, second-order poles is approximately zero. Thus, the original, dominant, second-order closed-loop poles are still approximately on the new root locus. SOLUTION: WeÔ¨Årst analyze the uncompensated system and determine the location of the dominant, second-order poles. Next we evaluate the uncompensated steady-state error for a unit step input. The root locus for the uncompensated system is shown in Figure 9.5. s-planejœâ œÉ= 0.174 K = 164.6‚Äì0.694 + j3.926 100.02¬∞ ‚Äì2 ‚Äì1 0 = Closed-loop pole = Open-loop pole4 6 ‚Äì8 ‚Äì10 ‚Äì11.61j2j4 ‚Äìj2 ‚Äìj4Œ∂ ‚Äì ‚Äì FIGURE 9.5 Root locus for uncompensated system of Figure 9.4( a)(a) (b)R(s) E(s) C(s)Plant ‚ÄìsCompensator K(s+0.1) +1 R(s) E(s) C(s)Plant ‚ÄìGain (s+1)(s+2)(s+10)+K 1 (s+1)(s+2)(s+10) FIGURE 9.4 Closed-loop system for Example 9.1: a.before compensation; b.after ideal integral compensation9.2 Improving Steady-State Error via Cascade Compensation 455WEBC09 10/28/2014 18:1:32 A damping ratio of 0.174 is represented by a radial line drawn on the s-plane at 100:02¬∞. Searching along this line with the root locus program discussed in Appendix H at www.wiley.com/college/nise ,w e Ô¨Ånd that the dominant poles are 0: 694j3:926 for a gain, K, of 164.6. Now look for the third pole on the root locus beyond  10 on the real axis. Using the root locus program and searching for the same gain as that of the dominant pair, K¬à164:6, we Ô¨Ånd that the third pole is approximately at  11:61. This gain yields Kp¬à8:23. Hence, the steady-state error is e ‚àû¬Ü¬à1 1¬áKp¬à1 1¬á8:23¬à0:108 9.1¬Ü Adding an ideal integral compensator with a zero at  0:1, as shown in Figure 9.4( b), we obtain the root locus shown in Figure 9.6. The dominant second-order poles, the third pole beyond  10, and the gain are approximately the same as for the uncompensated system. Another section of the compensated root locus is between the origin and  0:1. Searching this region for the same gain at the dominant pair, K¬à158:2, the fourth closed-loop pole is found at  0:0902, close enough to the zero to cause pole-zero cancellation. Thus, the compensated system ‚Äôs closed-loop poles and gain are approximately the same as the uncompensated system ‚Äôs closed-loop poles and gain, which indicates that the transient response of the compensated system is about the same as the uncompensated system. However, the compensated system, with its pole at the origin, is a Type 1 system; unlike the uncompensated system, it will respond to a step input with zero error. Figure 9.7 compares the uncompensated response with the ideal integral compensated response. The step response of the ideal integral compensated system approaches unity in the steady state, while the uncompensated system approaches 0.892. Thus, the idealintegral compensated system responds with zero steady-state error. The transientresponse of both the uncompensated and the ideal integral compensated systems isthe same up to approximately 3 seconds. After that time, the integrator in the compensator, s-planejœâ œÉ= 0.174 K = 158.2‚Äì 0.678 + j3.837 100.02¬∞ ‚Äì11.55 ‚Äì10 ‚Äì2‚Äì1 ‚Äì0.10 Fourth closed-loop pole at ‚Äì 0.0902 = Closed-loop pole = Open-loop pole4 6 ‚Äì8 ‚Äìj2j2j4 ‚Äìj4Œ∂ ‚Äì ‚Äì FIGURE 9.6 Root locus for compensated system of Figure 9.4( b)456 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:32 A method of implementing an ideal integral compensator is shown in Figure 9.8. The compensating network precedes G(s) and is an ideal integral compensator since Gc s¬Ü¬àK1¬áK2 s¬àK1s¬áK2 K1/C18/C19 s 9.2¬Ü The value of the zero can be adjusted by varying K2=K1. In this implementation, the error and the integral of the error are fed forward to the plant, G(s). Since Figure 9.8 has both proportional and integral control, the ideal integral controller, or compensator, is given the alternate name PI controller . Later in the chapter we will see how to implement each block, K1andK2=s. Lag Compensation Ideal integral compensation, with its pole on the origin, requires an active integrator. If weuse passive networks, the pole and zero are moved to the left, close to the origin, as shown in Figure 9.9( c). One may guess that this placement of the pole, although it does not increase the system type, does yield an improvement in the static error constant over an uncompensated system. Without loss of generality, we demonstrate that this improvementis indeed realized for a Type 1 system.shown in Figure 9.4( b), slowly compensates for the error until zero error is Ô¨Ånally reached. The simulation shows that it takes 18 seconds for the compensated system to reach to within 2%of the Ô¨Ånal value of unity, while the uncompensated system takes about 6 seconds to settle to within 2%of its Ô¨Ånal value of 0.892. The compensation at Ô¨Årst may appear to yield deterioration in the settling time. However, notice that the compensated system reaches the uncompensated system ‚ÄôsÔ¨Ånal value in about the same time. The remaining time is used to improve the steady-state error over that of the uncompensated system.2.0 1.81.61.41.21.00.80.60.40.2 00 51 0 1 5 2 0c(t)Ideal integral compensated Uncompensated Time (seconds)FIGURE 9.7 Ideal integral compensated system response and the uncompensated systemresponse of Example 9.1 R(s) C(s) K1++K2 s G(s)+ ‚ÄìIntegral (I) Proportional (P) Plant FIGURE 9.8 PI controller9.2 Improving Steady-State Error via Cascade Compensation 457WEBC09 10/28/2014 18:1:33 Assume the uncompensated system shown in Figure 9.9( a). The static error constant, KvO, for the system is KvO¬àKz 1z2‚àô‚àô‚àô p1p2‚àô‚àô‚àô 9.3¬Ü Assuming the lag compensator shown in Figure 9.9( b)a n d( c), the new static error constant is KvN¬à Kz 1z2‚àô‚àô‚àô¬Ü zc¬Ü p1p2‚àô‚àô‚àô¬Ü pc¬Ü 9.4¬Ü What is the effect on the transient response? Figure 9.10 shows the effect on the root locus of adding the lag compensator. The uncompensated system ‚Äôs root locus is shown in Figure 9.10( a), where point Pis assumed to be the dominant pole. If the lag compensator pole and zero are close together, the angular contribution of the compensator to point P is approximately zero degrees. Thus, in Figure 9.10( b), where the compensator has been added, point Pis still at approximately the sa me location on the compensated root locus. What is the effect on the required gain, K? After inserting the compensator, we Ô¨Ånd thatKis virtually the same for the uncompensated and compensated systems, since the lengths of the vectors drawn from the lag compensator are approximately equal and all other vectors have not changed appreciably. Now, what improvement can we expect in the steady-state error? Since we established that the gain, K, is about the same for the uncompensated and compensated systems, we can substitute Eq. (9.3) into (9.4) and obtain KvN¬àKvOzc pc>KvO 9.5¬Ü(a) (b) (c)(s + z1)(s + z2) s(s + p1)(s + p2)R(s) E(s) C(s)Plant ‚ÄìK(s + zc) (s + pc) (s + zc)Gc(s) = s-planejœâ œÉ ‚Äìpc ‚Äìzc(s + pc)Compensator +(s + z1)(s + z2) s(s + p1)(s + p2)R(s) E(s) C(s)Plant ‚ÄìGain +K FIGURE 9.9 a.Type 1 uncompensated system; b.Type 1 compensated system; c.compensator pole-zero plot458 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:33 Equation (9.5) shows that the improvement in the compensated system‚Äô sKvover the uncompensated system ‚ÄôsKvis equal to the ratio of the magnitude of the compensator zero to the compensator pole. In order to keep the transient response unchanged, we know the compensator pole and zero must be close to each other. The only way the ratio of zctopc can be large in order to yield an appreciable improvement in steady-state error and,simultaneously, have the compensator ‚Äôs pole and zero close to each other to minimize the angular contribution, is to place the compensator ‚Äôs pole-zero pair close to the origin. For example, the ratio of z ctopccan be equal to 10 if the pole is at  0:001 and the zero is at 0:01. Thus, the ratio is 10, yet the pole and zero are very close, and the angular contribution of the compensator is small. In conclusion, although the ideal compen sator drives the stea dy-state error to zero, a lag compensator with a pole that is not at the origin will improve the static errorconstant by a factor equal to z c=pc. There also will be a minimal effect upon the transient response if the pole-zero pair of the compensator is placed close to the origin. Later in the chapter we show circuit con Ô¨Ågurations for the lag comp ensator. These circuit conÔ¨Ågurations can be obtained with passive net works and thus do not require the active ampli Ô¨Åers and possible additional power supplies that are required by the ideal integral (PI) compensator. In the following exam ple we design a lag compensator to yield a speci Ô¨Åed improvement in steady-state error.s-planeœâj œÉœÉ (a)( b)Ps-planeœâj P ‚Äìzc‚Äìpc FIGURE 9.10 Root locus: a.before lag compensation; b.after lag compensation Example 9.2 Lag Compensator DesignLag Compensator Design PROBLEM: Compensate the system of Figure 9.4( a), whose root locus is shown in Figure 9.5, to improve the steady-state error by a factor of 10 if the system is operating with a damping ratio of 0.174. SOLUTION: The uncompensated system error from Example 9.1 was 0.108 with Kp¬à8:23. A tenfold improvement means a steady-state error of e ‚àû¬Ü¬à0:108 10¬à0:0108 9.6¬Ü9.2 Improving Steady-State Error via Cascade Compensation 459WEBC09 10/28/2014 18:1:34 Since e ‚àû¬Ü¬à1 1¬áKp¬à0:0108 9.7¬Ü rearranging and solving for the required Kpyields Kp¬à1 e ‚àû¬Ü e ‚àû¬Ü¬à1 0:0108 0:0108¬à91:59 9.8¬Ü The improvement in Kpfrom the uncompensated system to the compensated system is the required ratio of the compensator zero to the compensator pole, or zc pc¬àKpN KpO¬à91:59 8:23¬à11:13 9.9¬Ü Arbitrarily selecting pc¬à0:01 9.10¬Ü we use Eq. (9.9) and Ô¨Ånd zc¬à11:13pc‚âà0:111 9.11¬Ü Let us now compare the compensated system, shown in Figure 9.11, with the uncompensated system. First sketch the root locus of the compensated system, as shown in Figure 9.12. Next search along the Œ∂¬à0:174 line for a multiple of 180 ¬∞andÔ¨Ånd that the s-planejœâ œÉ = 0.174 K = 158.1‚Äì 0.678 + j3.836 ‚Äì2 ‚Äì1 0 ‚Äì0.111 Fourth closed-loop pole at ‚Äì0.101 = Closed-loop pole = Open-loop pole4 6 ‚Äì8 ‚Äìj2 ‚Äìj4‚Äì10 ‚Äì11.55j4j2 100.02¬∞ Compensator pole at ‚Äì0.01Œ∂ ‚Äì ‚Äì FIGURE 9.12 Root locus for compensated system of Figure 9.111 R(s) E(s) C(s)Plant ‚Äì(s + 0.01)Compensator (s + 1)(s + 2)(s + 10)K(s + 0.111) + FIGURE 9.11 Compensated system for Example 9.2460 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:35 second-order dominant poles are at  0:678j3:836 with a gain, K, of 158.1. The third and fourth closed-loop poles are at  11:55 and  0:101, respectively, and are found by searching the real axis for a gain equal to that of the dominant poles. All transient and steady-state results for both the uncompensated and the compensated systems are shown in Table 9.1. The fourth pole of the compensated system cancels its zero. This leaves the remaining three closed-loop poles of the compensated system very close in value tothe three closed-loop poles of the uncompensated system. Hence, the transient response ofboth systems is approximately the same, as is the system gain, but notice that the steady-state error of the compensated system is 1/9.818 that of the uncompensated system and isclose to the design speci Ô¨Åcation of a tenfold improvement. Figure 9.13 shows the effect of the lag compensator in the time domain. Even though the transient responses of the uncompensated and lag-compensated systems are the same,the lag-compensated system exhibits less steady-state error by approaching unity moreclosely than the uncompensated system. We now examine another design possibility for the lag compensator and compare the response to Figure 9.13. Let us assume a lag compensator whose pole and zero are 10 timesas close to the origin as in the previous design. The results are compared in Figure 9.14. Eventhough both responses will eventually reach approximately the same steady-state value, the lag compensator previously designed, G c s¬Ü¬à s¬á0:111¬Ü= s¬á0:01¬Ü, approaches the Ô¨Ånal value faster than the proposed lag compensator, Gc s¬Ü¬à s¬á0:0111 ¬Ü= s¬á0:001¬Ü. We can explain this phenomenon as follows. From Table 9.1, the previously designed lagTABLE 9.1 Predicted characteristics of uncompensated and lag-compensated systems for Example 9.2 Parameter Uncompensated Lag-compensated Plant and compensatorK s¬á1¬Ü s¬á2¬Ü s¬á10¬ÜK s¬á0:111¬Ü s¬á1¬Ü s¬á2¬Ü s¬á10¬Ü s¬á0:01¬Ü K 164.6 158.1 Kp 8.23 87.75 e ‚àû¬Ü 0.108 0.011 Dominant second-order poles  0:694j3:926  0:678j3:836 Third pole  11:61  11:55 Fourth pole None  0:101 Zero None  0:111 1.4 1.21.00.80.60.40.2 0051 0 1 5 2 0c(t)Lag-compensated Uncompensated Time (seconds)FIGURE 9.13 Step responses of uncompensated and lag- compensated systems for Example 9.2TryIt 9.1 Use the following MATLAB and Control System Toolbox statements to reproduceFigure 9.13. Gu=zpk([], ... [ 1 2 10] ,164.6) ; Gc=zpk( [  0.111] , ... [ 0.01] ,1) ; Gce=Gu*Gc; Tu=feedback(Gu,1) ; Tc=feedback(Gce,1) ; step(Tu) holdstep(Tc)9.2 Improving Steady-State Error via Cascade Compensation 461WEBC09 10/28/2014 18:1:36 9.3 Improving Transient Response via Cascade Compensation Since we have solved the problem of improving the steady-state error without affecting the transient response, let us now improve the transient response itself. In this section, wediscuss two ways to improve the transient response of a feedback control system by usingcompensator has a fourth closed-loop pole at  0:101. Using the same analysis for the new lag compensator with its open-loop pole 10 times as close to the imaginary axis, we Ô¨Ånd its fourth closed-loop pole at  0:01. Thus, the new lag compensator has a closed-loop pole closer to the imaginary axis than the original lag compensator. This pole at  0:01 will produce a longer transient response than the original pole at  0:101, and the steady-state value will not be reached as quickly.(s + 0.001)Gc(s) =(s + 0.111) (s + 0.0111)Gc(s) = 0.2 0 0 5 10 15 20c(t) 0.40.60.81.01.21.4 Time (seconds)(s + 0.01) FIGURE 9.14 Step responses of the system for Example 9.2 using different lag compensators Skill-Assessment Exercise 9.1 PROBLEM: A unity feedback system with the forward transfer function G s¬Ü¬àK s s¬á7¬Ü is operating with a closed-loop step response that has 15% overshoot. Do the following: a.Evaluate the steady-state error for a unit ramp input. b.Design a lag compensator to improve the steady-state error by a factor of 20. c.Evaluate the steady-state error for a unit ramp input to your compensated system. d.Evaluate how much improvement in steady-state error was realized. ANSWERS: a.eramp ‚àû¬Ü¬à0:1527 b.Glag s¬Ü¬às¬á0:2 s¬á0:01 c.eramp ‚àû¬Ü¬à0:0078 d.19.58 times improvement The complete solution is at www.wiley.com/college/nise .462 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:36 cascade compensation. Typically, the objective is to design a response that has a desirable percent overshoot and a shorter settling time than the uncompensated system. TheÔ¨Årst technique we will discuss is ideal derivative compensation . With ideal derivative compensation, a pure differentiator is added to the forward path of the feedback control system. We will see that the result of adding differentiation is the addition of a zeroto the forward-path transfer function. This type of compensation requires an active networkfor its realization. Further, differentiation is a noisy process; although the level of the noiseis low, the frequency of the noise is high compared to the signal. Thus, differentiatinghigh-frequency noise yields a large, unwanted signal. The second technique does not use pure differentiation. Instead, it approximates differentiation with a passive network by adding a zero and a more distant pole tothe forward-path transfer function. The zero approximates pure differentiation as describedpreviously. As with compensation to improve steady-state error, we introduce names associated with the implementation of the compensators. We call an ideal derivative compensator aproportional-plus-derivative (PD)controller , since the implementation, as we will see, consists of feeding the error (proportional) plus the derivative of the error forward to the plant. The second technique uses a passive network called a lead compensator . As with the lag compensator, the name comes from its frequency response, which is discussed in Chapter 11. Thus, we use the name PD controller interchangeably with ideal derivative compensator , and we use the name lead compensator when the cascade compensator does not employ pure differentiation. Ideal Derivative Compensation (PD) The transient response of a system can be selected by choosing an appropriate closed-looppole location on the s-plane. If this point is on the root locus, then a simple gain adjustment is all that is required in order to meet the transient response speci Ô¨Åcation. If the closed-loop pole location is not on the root locus, then the root locus must be reshaped so that the compensated (new) root locus goes through the selected closed-loop pole location. In order to accomplish the latter task, poles and zeros can be added in the forward path to produce a newopen-loop function whose root locus goes through the design point on the s-plane. One way to speed up the original system that generally works is to add a single zero to the forward path. This zero can be represented by a compensator whose transfer function is G c s¬Ü¬às¬ázc 9.12¬Ü This function, the sum of a differentiator and a pure gain, is called an ideal derivative ,o rPD controller . Judicious choice of the position of the compensator zero can quicken the response over the uncompensated system. In summary, transient responses unattainable by a simple gain adjustment can be obtained by augmenting the system‚Äô s poles and zeros with an ideal derivative compensator. We now show that ideal derivative compensation speeds up the response of a system. Several simple examples are shown in Figure 9.15, where the uncompensated system of Figure 9.15( a), operating with a damping ratio of 0.4, becomes a compensated system by the addition of a compensating zero at  2, 3, and  4 in Figures 9.15( b), (c), and ( d), respectively. In each design, the zero is moved to a different position, and the root locus isshown. For each compensated case, the dominant, second-order poles are farther out along the 0.4 damping ratio line than the uncompensated system. Each of the compensated cases has dominant poles with the same damping ratio as the uncompensated case. Thus, we predict that the percent overshoot will be the same for each case. Also, the compensated, dominant, closed-loop poles have more negative real parts than the uncompensated, dominant, closed-loop poles. Hence, we predict that the settling times for the compensated cases will be shorter than for the uncompensated case. The compensated,9.3 Improving Transient Response via Cascade Compensation 463WEBC09 10/28/2014 18:1:36 dominant, closed-loop poles with the more negative real parts will have the shorter settling times. The system in Figure 9.15( b) will have the shortest settling time. All of the compensated systems will have smaller peak times than the uncompensated system, since the imaginary parts of the compensated systems are larger. The system ofFigure 9.15( b) will have the smallest peak time. Also notice that as the zero is placed farther from the dominant poles, the closed-loop, compensated dominant poles move closer to the origin and to the uncompensated, dominantclosed-loop poles. Table 9.2 summarizes the results obtained from the root locus of each ofthe design cases shown in Figure 9.15.s-planejœâ œÉK = 23.72‚Äì0.939 + j2.151 ‚Äì1 0 ‚Äì3 4 ‚Äì5 6Third pole (a)Œ∂ = 0.4 = Closed-loop pole‚Äì2 = Open-loop polej1j2j3j4j5j7 113.6¬∞j6 ‚Äì ‚ÄìK = 51.25‚Äì3 + j6.874Œ∂ = 0.4 s-planejœâ œÉ ‚Äì1 0 ‚Äì4 ‚Äì5 ‚Äì6 (b)= Closed-loop pole‚Äì2 = Open-loop polej1j2j3j4j5j7 j6 113.6¬∞ ‚Äì3 K = 35.34‚Äì2.437 + j5.583Œ∂ = 0.4 s-planejœâ œÉ ‚Äì1 0 ‚Äì3 ‚Äì4 ‚Äì5 ‚Äì6Third pole (c)= Closed-loop pole‚Äì2 = Open-loop polej1j2j3j4j5j7 113.6¬∞j6 K = 20.76‚Äì1.869 + j4.282Œ∂ = 0.4 s-planejœâ œÉ ‚Äì1 0 ‚Äì3 ‚Äì4 ‚Äì5 6 (d)= Closed-loop pole‚Äì2 = Open-loop polej1j2j3j4j5j7 j6 113.6¬∞Third pole ‚Äì FIGURE 9.15 Using ideal derivative compensation: a.uncompensated; b.compensator zero at  2; c.compensator zero at  3;d.compensator zero at  4464 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:38 In summary, although compensation methods canddyield slower responses than method b, the addition of ideal derivative compensation shortened the response time in each case while keeping the percent overshoot the same. This change can best be seen in the settling time and peak time, where there is at least a doubling of speed across all of the casesof compensation. An added bene Ô¨Åt is the improvement in the steady-state error, even though lag compensation was not used. Here the steady-state error of the compensated system is at least one-third that of the uncompensated system, as seen by e ‚àû¬ÜandKp. All systems in Table 9.2 are Type 0, and some steady-state error is expected. The reader must not assume that, in general, improvement in transient response always yields an improvement insteady-state error. The time response of each case in Table 9.2 is shown in Figure 9.16. We see that the compensated responses are faster and exhibit less error than the uncompensated response. Now that we have seen what ideal derivative compensation can do, we are ready to design our own ideal derivative compensator to meet a transient response speci Ô¨Åcation. Basically, we will evaluate the sum of angles from the open-loop poles and zeros to a designpoint that is the closed-loop pole that yields the desired transient response. The differencebetween 180 ¬∞and the calculated angle must be the angular contribution of the compensator zero. Trigonometry is then used to locate the position of the zero to yield the requireddifference in angle.TABLE 9.2 Predicted characteristics for the systems of Figure 9.15 Uncompensated Compensation b Compensation c Compensation d Plant and compensatorK s¬á1¬Ü s¬á2¬Ü s¬á5¬ÜK s¬á2¬Ü s¬á1¬Ü s¬á2¬Ü s¬á5¬ÜK s¬á3¬Ü s¬á1¬Ü s¬á2¬Ü s¬á5¬ÜK s¬á4¬Ü s¬á1¬Ü s¬á2¬Ü s¬á5¬Ü Dom, poles  0:939j2:151  3j6:874  2:437j5:583  1:869j4:282 K 23.72 51.25 35.34 20.76 Œ∂ 0.4 0.4 0.4 0.4 œân 2.347 7.5 6.091 4.673 %OS 25.38 25.38 25.38 25.38 Ts 4.26 1.33 1.64 2.14 Tp 1.46 0.46 0.56 0.733 Kp 2.372 10.25 10.6 8.304 e ‚àû¬Ü 0.297 0.089 0.086 0.107 Third pole  6:123 None  3:127  4:262 Zero None None  3  4 Comments Second-order approx. OKPuresecond-orderSecond-orderapprox. OKSecond-orderapprox. OK Zero at ‚Äì2 Uncompensate d Zero at ‚Äì3Zero at ‚Äì4 1.25 1.000.750.500.25 004.5c(t) 1.5 3.0 Time (seconds)FIGURE 9.16 Uncompensated system andideal derivative compensation solutions from Table 9.29.3 Improving Transient Response via Cascade Compensation 465WEBC09 10/28/2014 18:1:39 Example 9.3 Ideal Derivative Compensator DesignIdeal Derivative Compensator Design PROBLEM: Given the system of Figure 9.17, design an ideal derivative compensator to yield a 16% overshoot, with a threefold reduction in settling time. SOLUTION: Let us Ô¨Årst evaluate the performance of the uncompensated system operating with 16% overshoot. The root locus for the uncompensated system is shown in Figure 9.18. Since 16%overshoot is equivalent to Œ∂¬à0:504, we search along that damping ratio line for an odd multiple of 180 ¬∞andÔ¨Ånd that the dominant, second-order pair of poles is at  1:205j2:064. Thus, the settling time of the uncompensated system is T s¬à4 Œ∂œân¬à4 1:205¬à3:320 9.13¬Ü Since our evaluation of percent overshoot and settling time is based upon a second- order approximation, we must check the assumption by Ô¨Ånding the third pole and justifying the second-order approximation. Searching beyond  6 on the real axis for a gain equal to the gain of the dominant, second-order pair, 43.35, we Ô¨Ånd a third pole at  7:59, which is over six times as far from the jœâ-axis as the dominant, second-order pair. We conclude that our approximation is valid. The transient and steady-state errorcharacteristics of the uncompensated system are summarized in Table 9.3. Now we proceed to compensate the system. First we Ô¨Ånd the location of the compensated system ‚Äôs dominant poles. In order to have a threefold reduction in the settling time, the compensated system ‚Äôs settling time will be one- third of Eq. (9.13). The new settling time will be 1.107. Therefore, the real part of the compensatedsystem ‚Äôs dominant, second-order pole is œÉ¬à 4 Ts¬à4 1:107¬à3:613 9.14¬ÜK s(s + 4)(s + 6)R(s) C(s) ‚Äì+ E(s) FIGURE 9.17 Feedback control system for Example 9.3 Virtual Experiment 9.1 PD Controller Design Put theory into practice and use root-locus to design a PD controller for the Quanser Ball and Beam usingLabVIEW. The Ball andBeam is an unstable system, similar to exothermic chemical processes that haveto be stabilized to avoidoverheating. Virtual experiments are foundon Learning Space. s-planejœâ œÉK = 43.35‚Äì1.205 + j2.064Œ∂ = 0.504 = Closed-loop pole = Open-loo p polej1 ‚Äì1 0 ‚Äì2 ‚Äì3 4 ‚Äì5 6 ‚Äì7j2j3 ‚Äì7.59120.26¬∞ ‚Äì ‚Äì FIGURE 9.18 Root locus for uncompensated system shown in Figure 9.17466 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:41 Figure 9.19 shows the designed dominant, second-order pole, with a real part equal to  3:613 and an imaginary part of œâd¬à3:613 tan 180 ¬∞ 120:26¬∞¬Ü¬à6:193 9.15¬Ü Next we design the location of the compensator zero. Input the uncompensated system ‚Äôs poles and zeros in the root locus program as well as the design point  3:613j6:193 as a test point. The result is the sum of the angles to the design point of all the poles and zeros of the compensated system except for those of the compensatorzero itself. The difference between the result obtained and 180 ¬∞is the angular contribution required of the compensator zero. Using the open-loop poles shown in Figure 9.19 and thetest point,  3:613¬áj6:193, which is the desired dominant second-order pole, we obtain the sum of the angles as  275 :6¬∞. Hence, the angular contribution required from the compensator zero for the test point to be on the root locus is ¬á275 :6¬∞ 180 ¬∞¬à95:6¬∞.T h eTABLE 9.3 Uncompensated and compensated system characteristic of Example 9.3 Uncompensated Simulation Compensated Simulation Plant and compensatorK s s¬á4¬Ü s¬á6¬ÜK s¬á3:006¬Ü s s¬á4¬Ü s¬á6¬Ü Dominant poles  1:205j2:064  3:613j6:193 K 43.35 47.45 Œ∂ 0.504 0.504 œân 2.39 7.17 %OS 16 14.8 16 11.8 Ts 3.320 3.6 1.107 1.2 Tp 1.522 1.7 0.507 0.5 Kv 1.806 5.94 e ‚àû¬Ü 0.554 0.168 Third pole  7:591  2:775 Zero None  3:006 Comments Second-order approx. OKPole-zeronot canceling 120.26¬∞ ‚Äì1 0œÉs-planeDesired compensated dominant pole ‚Äì3.613 + j 6.193= 0.504Œ∂jœâ = Closed-loop pole = Open-loo p pole‚Äì2 ‚Äì3 4 ‚Äì5 6 ‚Äì7 ‚Äì7.59j2j3j4j5j6j7 Uncompensated dominant pole ‚Äì1.205 + j2.064 j1 ‚Äì‚ÄìFIGURE 9.19 Compensated dominant pole superimposed over the uncompensated root locus for Example 9.39.3 Improving Transient Response via Cascade Compensation 467WEBC09 10/28/2014 18:1:42 geometry is shown in Figure 9.20, where we now must solve for  œÉ, the location of the compensator zero. From the Ô¨Ågure, 6:193 3:613 œÉ¬àtan 180 ¬∞ 95:6¬∞¬Ü 9.16¬Ü Thus, œÉ¬à3:006. The complete root locus for the compensated system is shown in Figure 9.21. Table 9.3 summarizes the results for both the uncompensated system and the compensated system. For the uncompensated system, the estimate of the transient response is accurate since the third pole is at least Ô¨Åve times the real part of the dominant, second-order pair. The second-order approximation for the compensated system, however, may be invalid because there is no approximate closed-loop third-pole and zero cancellation ‚Äì1 0 ‚Äì2 ‚Äì3 ‚Äì4 ‚Äì5 ‚Äì6 ‚Äì7‚Äì3.613 + j 6.193= 0.504 K = 47.45 s-planej j1j2j3j4j5j7 j6 = Closed-loop pole = Open-loo p poleCompensated dominant pole 120.26¬∞ ‚Äì2.775œÉœâ Œ∂ FIGURE 9.21 Root locus for the compensated system of Example 9.3Desired compensated dominant pole‚Äì3.613 + j 6.193= 0.504Œ∂ s-planejœâ œÉ ‚Äì1 0 ‚Äì3 ‚Äì4 ‚Äì5 ‚Äì6 ‚Äì2 = Closed-loop pole = Open-loo p polej1j2j3j4j5j7 j6 ‚Äì795.6¬∞Uncompensated dominant pole ‚Äì œÉ120.26¬∞‚Äì1.205 + j 2.064 FIGURE 9.20 Evaluating the location of the compensating zero for Example 9.3468 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:42 Once we decide on the location of the compensating zero, how do we implement the ideal derivative, or PD controller? The ideal integral compensator that improved steady-state error was implemented with a proportional-plus-integral (PI) controller. The ideal derivativecompensator used to improve the transient response is implementedwith a proportional-plus-derivative (PD) controller. For example, inFigure 9.23 the transfer function of the controller is G c s¬Ü¬àK2s¬áK1¬àK2s¬áK1 K2/C18/C19 9.17¬Ü Hence, K1=K2is chosen to equal the negative of the compensator zero, and K2is chosen to contribute to the required loop-gain value. Later in the chapter, we will study circuits that canbe used to approximate differentiation and produce gain.between the closed-loop pole at  2:775 and the closed-loop zero at  3:006. A simulation or a partial-fraction expansion of the closed-loop response to compare the residue of thepole at  2:775 to the residues of the dominant poles at  3:613j6:193 is required. The results of a simulation are shown in the table ‚Äôs second column for the uncompensated system and the fourth column for the compensated system. The simulation results can beobtained using MATLAB (discussed at the end of this example) or a program like thestate-space step-response progr am described in Appendix H.1 at www.wiley.com/ college/nise . The percent overshoot differs by 3 % between the uncompensated and compensated systems, while there is approximately a threefold improvement in speed asevaluated from the settling time. TheÔ¨Ånal results are displayed in Figure 9.22, which compares the uncompensated system and the faster compensated system. Students who are using MATLAB should now run ch9p1 in Appendix B. MATLAB will be used to design a PD controller. You will input thedesired percent overshoot from the keyboard. MATLAB will plot theroot locus of the uncompensated system and the percent overshootline. You will interactively select the gain, after which MATLABwill display the performance characteristics of the uncompensatedsystem and plot its step response. Using these characteristics, you will input the desired settling time. MATLAB will design the PD controller, enumerate its performance characteristics, and plot astep response. This exercise solves Example 9.3 using MATLAB.Compensated Uncompensated 1.2 1.00.80.60.40.2 0 0 1.0 3.5c(t) Time (seconds)0.5 1.5 2.0 2.5 3.0 4.0FIGURE 9.22 Uncompensated and compensated system step responses of Example 9.3 K1K2s R(s) C(s)+ G(s) ‚Äì+ + FIGURE 9.23 PD controller9.3 Improving Transient Response via Cascade Compensation 469WEBC09 10/28/2014 18:1:42 While the ideal derivative compensator can improve the transient response of the system, it has two drawbacks. First, it requires an active circuit to perform the differentia- tion. Second, as previously mentioned, differentiation is a noisy process: The level of thenoise is low, but the frequency of the noise is high compared to the signal. Differentiationof high frequencies can lead to large unwanted signals or saturation of ampli Ô¨Åers and other components. The lead compensator is a passive network used to overcome thedisadvantages of ideal differentiation and still retain the ability to improve the transientresponse. Lead Compensation Just as the active ideal integral compensator can be approximated with a passive lagnetwork, an active ideal derivative compensator can be approximated with a passive leadcompensator. When passive networks are used, a single zero cannot be produced; rather, acompensator zero and a pole result. However, if the pole is farther from the imaginary axis than the zero, the angular contribution of the compensator is still positive and thus approximates an equivalent single zero. In other words, the angular contribution of thecompensator pole subtracts from the angular contribution of the zero. This deduction doesnot preclude the use of the compensator to improve transient response, since the net angularcontribution is positive, just as for a single PD controller zero. The advantages of a passive lead network over an active PD controller are that (1) no additional power supplies are required and (2) noise due to differentiation is reduced. Thedisadvantage is that the additional pole does not reduce the number of branches of the root locus that cross the imaginary axis into the right half-plane. On the other hand, the addition of the single zero of the PD controller tends to reduce the number of branches of the rootlocus that cross into the right half-plane. Let us Ô¨Årst look at the concept behind lead compensation. If we select a desired dominant, second-order pole on the s-plane, the sum of the angles from the uncompensated system ‚Äôs poles and zeros to the design point can be found. The difference between 180 ¬∞and the sum of the angles must be the angular contribution required of the compensator. For example, looking at Figure 9.24, we see that Œ∏ 2 Œ∏1 Œ∏3 Œ∏4¬áŒ∏5¬à 2k¬á1¬Ü180 ¬∞ 9.18¬Ü where Œ∏2 Œ∏1¬Ü¬àŒ∏cis the angular contribution of the lead compensator. From Figure 9.24 we see that Œ∏cis the angle of a ray extending from the design point and intersecting the real axis at the pole value and zero value of the compensator. Now visualize this ray rotatingabout the desired closed-loop pole location and intersecting the real axis at the compensatorpole and zero, as illustrated in Figure 9.25. We realize that an in Ô¨Ånite number of lead compensators could be used to meet the transient response requirement.TryIt 9.2 Use MATLAB, the Control System Toolbox, and thefollowing steps to useSISOTOOL to perform the design of Example 9.3. Type SISOTOOL in the MATLAB Command Window . Select Import in the File menu of the SISO Design for SISO Design Task Window . In the Data Ô¨Åeld for G, type zpk([],[0 ,-4,-6] ,1 ) and hit ENTER on the keyboard. Click OK. On the Edit menu choose SISO Tool Preferences ... and select Zero/pole/gain: under the Options tab. Click OK. Right-click on the root locus white space and choose Design Requirements/ New ... Choose Percent overshoot and type in 16. Click OK. Right-click on the root locus white space and choose Design Requirements/New ... Choose Settling time and click OK. Drag the settling time vertical line to the intersection of the root locus and 16% overshoot radial line. Read the settling time at the bottom of the window. Drag the settling time vertical line to a settling time that is 1/3of the value found in Step 9. Click on a red zero icon in the menu bar. Place the zero on theroot locus real axis by clicking again on the real axis. Left-click on the real-axis zero and drag it along the real axis until the root locus intersects the settling time and percent overshoot lines. Drag a red square along the root locus until it is at theintersection of the root locus,settling time line, and the percent overshoot line. Click the Compensator Editor tab of the Control and Estimation Tools Manager window to see the resultingcompensator, including the gain. pcjœâ zc p2 p1 z1s-planeDesired pole location 21 3 4 5 2 œÉŒ∏ Œ∏ Œ∏Œ∏ Œ∏ Œ∏cŒ∏ Œ∏1 FIGURE 9.24 Geometry of lead compensation470 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:43 How do the possible lead compensators differ? The differences are in the values of static error constants, the gain required to reach the design point on the compensated root locus, the difÔ¨Å culty in justifying a second-order approximation when the design is complete, and the ensuing transient response. For design, we arbitrarily select either a lead compensator pole or zero and Ô¨Ånd the angular contribution at the design point of this pole or zero along with the system ‚Äôs open- loop poles and zeros. The difference between this angle and 180 ¬∞is the required contribution of the remaining compensator pole or zero. Let us look at an example.j s-plane zc1pc2pc3zc2zc3pc1Desired pole location œÉœâ Œ∏c Œ∏c Œ∏c FIGURE 9.25 Three of the inÔ¨Ånite possible lead compensator solutions Example 9.4 Lead Compensator DesignLead Compensator Design PROBLEM: Design three lead compensators for the system of Figure 9.17 that will reduce the settling time by a factor of 2 while maintaining 30% overshoot. Compare the system characteristics between the three designs. SOLUTION: First determine the characteristics of the uncompensated system operating at 30% overshoot to see what the uncompensated settling time is. Since 30%overshoot is equivalent to a damping ratio of 0.358, wesearch along the Œ∂¬à0:358 line for the uncompensated dominant poles on the root locus, as shown in Figure 9.26.From the pole ‚Äôs real part, we calculate the uncompensated settling time as T s¬à4=1:007¬à3:972 seconds. The remaining characteristics of the uncompensated systemare summarized in Table 9.4. Next we Ô¨Ånd the design point. A twofold reduction in settling time yields T s¬à3:972=2¬à1:986 seconds, from which the real part of the desired pole location is  Œ∂œâ n¬à 4=Ts¬à 2:014. The imaginary part is œâd¬à  2:014 tan 110:98¬∞¬Ü¬à5:252. We continue by designing the lead compensator. Arbitrarily assume a compensator zero at  5 on the real axis as a possible solution. Using the root locus program, sum the angles from both this zero and the uncompensated system ‚Äôs poles and zeros, using the design point as a test point. Theresulting angle is  172 :69¬∞. The difference between this angle and 180 ¬∞is the angular contribution required from the compensator pole in order to place the design point on the root locus. Hence, an angular contribution of  7:31¬∞is required from the compensator pole.j s-plane ‚Äì7 ‚Äì6 ‚Äì5 ‚Äì4 ‚Äì3 ‚Äì2 ‚Äì1 0= 0.358 110.98¬∞‚Äì2.014 + j 5.252 ‚Äì1.007 + j 2.627 K = 63.21 j1j2j3j4j5j6Desired compensated dominant pole Uncompensated dominant pole = Closed-loop pole = Open-loo p poleœÉœâ Œ∂ FIGURE 9.26 Lead compensator design, showing evaluation of uncompensated and compensated dominant poles for Example 9.49.3 Improving Transient Response via Cascade Compensation 471WEBC09 10/28/2014 18:1:45 T h eg e o m e t r ys h o w ni nF i g u r e9 . 2 7i su sed to calculate the location of the compensator pole. From the Ô¨Ågure, 5:252 pc 2:014¬àtan 7 :31¬∞ 9.19¬Ü from which the compensator pole is found to be pc¬à42:96 9.20¬Ü The compensated system root locus is sketched in Figure 9.28. In order to justify our estimates of percent overshoot and settling time, we must show that the second-order approximation is valid. To perform this validity check, we search for the third and fourth closed-loop poles found beyond  42:96 and between  5a n d  6i n Figure 9.28. Searching these regions for the gain equal to that of the compensated dominantpole, 1423, we Ô¨Ånd that the third and fourth poles are at  43:8 and  5:134, respectively.TABLE 9.4 Comparison of lead compensation designs for Example 9.4 Uncompensated Compensation a Compensation b Compensation c Plant and compensatorK s s¬á4¬Ü s¬á6¬ÜK s¬á5¬Ü s s¬á4¬Ü s¬á6¬Ü s¬á42:96¬ÜK s¬á4¬Ü s s¬á4¬Ü s¬á6¬Ü s¬á20:09¬ÜK s¬á2¬Ü s s¬á4¬Ü s¬á6¬Ü s¬á8:971¬Ü Dominant poles  1:007j2:627  2:014j5:252  2:014j5:252  2:014j5:252 K 63.21 1423 698.1 345.6 Œ∂ 0.358 0.358 0.358 0.358 œân 2.813 5.625 5.625 5.625 %OS*30 (28) 30 (30.7) 30 (28.2) 30 (14.5) Ts*3.972 (4) 1.986 (2) 1.986 (2) 1.986 (1.7) Tp*1.196 (1.3) 0.598 (0.6) 0.598 (0.6) 0.598 (0.7) Kv 2.634 6.9 5.791 3.21 e ‚àû¬Ü 0.380 0.145 0.173 0.312 Other poles  7:986  43.8,  5:134  22:06  13:3, 1:642 Zero None  5 None  2 Comments Second-order approx. OKSecond-orderapprox. OKSecond-orderapprox. OKNo pole-zerocancellation *Simulation results are shown in parentheses. jœâ s-planej5.252 ‚Äì2.014 ‚ÄìpcDesired compensated dominant pole Note: This fi gure is not drawn to scale. = Closed-loop pole = Open-loop pole7.31¬∞ œÉ FIGURE 9.27 s-plane picture used to calculate the location of the compensatorpole for Example 9.4 s-planej ‚Äì4 0 ‚Äì5 ‚Äì6 ‚Äì42.96 Note: This fi gure is not drawn to scale. = Closed-loop pole = Open-loop poleœâ œÉ FIGURE 9.28 Compensated system root locus472 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:46 Since  43:8 is more than 20 times the real part of the dominant pole, the effect of the third closed-loop pole is negligible. Since the closed-loop pole at  5:134 is close to the zero at 5, we have pole-zero cancellation, and the second-order approximation is valid. All results for this design and two other designs, which place the compensator zero arbitrarily at  2a n d  4 and follow similar design techniques, are summarized in Table 9.4. Each design should be veri Ô¨Åed by a simulation, which could consist of using MATLAB (discussed at the end of this example) or the state-space model and the step-response program discussed in Appendix H.1 at www.wiley.com/college/nise . We have performed a simulation for this design problem, and the results are shown by parenthetical entries next tothe estimated values in the table. The only design that disagrees with the simulation is thecase where the compensator zero is at  2. For this case the closed-loop pole and zero do not cancel. A sketch of the root locus, which you should generate, shows why the effect of the zero is pronounced, causing the response to be different from that predicted.Placing the zero to the right of the pole at  4 creates a portion of the root locus that is between the origin and the zero. In other words, there is a closed-loop pole closer to theorigin than the dominant poles, with little chance of pole-zero cancellation except at highgain. Thus, a quick sketch of the root locus gives us information from which we can makebetter design decisions. For this example, we want to place the zero on, or to the left of, the pole at  4, which gives a better chance for pole-zero cancellation and for a higher-order pole that is to the left of the dominant poles and subsequently faster. This is veri Ô¨Åed by the fact that our results show good second-order approximations for the cases where the zero was placed at  4 and  5. Again, decisions about where to place the zero are based on simple rules of thumb and must be veri Ô¨Åed by simulations at the end of the design. Let us now summarize the results shown in Table 9.4. First we notice differences in the following: 1.The position of the arbitrarily selected zero 2.The amount of improvement in the steady-state error 3.The amount of required gain, K 4.The position of the third and fourth poles and their relative effect upon the second-orderapproximation. This effect is measured by their distance from the dominant poles or thedegree of cancellation with the closed-loop zero. Once a simulation veri Ô¨Åes desired performance, the choice of compensation can be based upon the amount of gain required or the improvement in steady-state error that can be obtained without a lag compensator. The results of Table 9.4 are supported by simulations of the step response, shown in Figure 9.29 for the uncompensated system and the three lead compensation solutions. Compensation c UncompensatedCompensation a, b 1.4 1.21.00.80.60.40.2 0 01 2 3c(t) Time (seconds)4FIGURE 9.29 Uncompensated system and lead compensation responsesfor Example 9.49.3 Improving Transient Response via Cascade Compensation 473WEBC09 10/28/2014 18:1:46 9.4 Improving Steady-State Error and Transient Response We now combine the design techniques covered in Sections 9.2 and 9.3 to obtain improvement in steady-state error and transient response independently .B a s i c a l l y ,w e Ô¨Årst improve the transient response by using the methods of Section 9.3. Then we improve the steady-state error ofthis compensated system by applying the methods of Section 9.2. A disadvantage of thisapproach is the slight decrease in the speed of the response when the steady-state error isimproved. As an alternative, we can improve the steady-state error Ô¨Årst and then follow with the design to improve the transient response. A disadvantage of this approach is that theimprovement in transient response in some cases yields deterioration in the improvementof the steady-state error, which was designed Ô¨Årst. In other cases, the improvement in transient response yields further improvement in steady-state errors. Thus, a system can beoverdesigned with respect to steady-state errors. Overdesign is usually not a problem unlessit affects cost or produces other design problems. In this textbook, we Ô¨Årst design for transient response and then design for steady-state error. The design can use either active or passive compensators, as previously described. If we design an active PD controller followed by an active PI controller, the resultingSkill-Assessment Exercise 9.2 PROBLEM: A unity feedback system with the forward transfer function G s¬Ü¬àK s s¬á7¬Ü is operating with a closed-loop step response that has 15% overshoot. Do the following: a.Evaluate the settling time. b.Design a lead compensator to decrease the settling time by three times. Choose the compensator ‚Äôs zero to be at  10. ANSWER: a.Ts¬à1:143 s b.Glead s¬Ü¬às¬á10 s¬á25:52;K¬à476:3 The complete solution is at www.wiley.com/college/nise .Students who are using MATLAB should now run ch9p2 in Appendix B. MATLAB will be used to design a lead compensator. You will input the desired percent overshoot from the keyboard. MATLAB will plot the root locus of the uncompensated system and the percent overshoot line. You will interactively select the gain, afterwhich MATLAB will display the performance characteristics ofthe uncompensated system and plot its step response. Using thesecharacteristics,you will input the desired settling time and azero value for the lead compensator.You will then interactivelyselect a value for the compensator pole. MATLAB will respond with aroot locus.You can then continue selecting pole values until the root locus goes through the desired point. MATLAB will display the lead compensator,enumerate its performance characteristics,andplot a step response.This exercise solves Example 9.4 using MATLAB.474 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:47 compensator is called a proportional-plus-integral-plus-derivative (PID) controller .I fw e Ô¨Årst design a passive lead compensator and then design a passive lag compensator, the resulting compensator is called a lag-lead compensator . PID Controller Design A PID controller is shown in Figure 9.30. Its transfer function is Gc s¬Ü¬àK1¬áK2 s¬áK3s¬àK1s¬áK2¬áK3s2 s¬àK3s2¬áK1 K3s¬áK2 K3/C18/C19 s 9.21¬Ü which has two zeros plus a pole at the origin. One zero and the pole at the origin can be designed as the ideal integral compensator; the other zero can be designed as the ideal derivative compensator. The design technique, which is demonstrated in Example 9.5, consists of the following steps: 1.Evaluate the performance of the uncompensated system to determine how much improvement in transient response is required. 2.Design the PD controller to meet the transient response speci Ô¨Åcations. The design includes the zero location and the loop gain. 3.Simulate the system to be sure all requirements have been met. 4.Redesign if the simulation shows that requirements have not been met. 5.Design the PI controller to yield the required steady-state error. 6.Determine the gains, K1,K2, and K3, in Figure 9.30. 7.Simulate the system to be sure all requirements have been met. 8.Redesign if simulation shows that requirements have not been met.K1K2 sK3s R(s) C(s)+ G(s) ‚Äì+ ++ FIGURE 9.30 PID controller Example 9.5 PID Controller DesignPID Controller Design PROBLEM: Given the system of Figure 9.31, design a PID controller so that the system can operate with a peak time that is two-thirds that of the uncompensated system at 20%overshoot and with zero steady-state error for a step input. SOLUTION: Note that our solution follows the eight-step procedure described earlier.K(s + 8) (s + 3)(s + 6)(s + 10)R(s) C(s) ‚Äì+ E(s) FIGURE 9.31 Uncompensated feedback control system for Example 9.59.4 Improving Steady-State Error and Transient Response 475WEBC09 10/28/2014 18:1:49 Step 1 Let us Ô¨Årst evaluate the uncompensated system operating at 20% overshoot. Searching along the 20% overshoot line Œ∂¬à0:456¬Üin Figure 9.32, we Ô¨Ånd the dominant poles to be  5:415j10:57 with a gain of 121.5. A third pole, which exists at  8:169, is found by searching the region between  8 and  10 for a gain equivalent to that at the dominant poles. The complete performance of the uncompensated system is shown in the Ô¨Årst column of Table 9.5, where we117.13¬∞K = 121.5Uncompensated dominant pole‚Äì5.415 + j10.57 j s-plane œÉ ‚Äì2 0 ‚Äì4 ‚Äì6 ‚Äì8 ‚Äì10 ‚Äì8.169 ‚Äì5.5œâ j2j4j6j8j10j12 ‚Äì3 ‚Äì4.6= 0.456 = Closed-loop pole = Open-loo p poleŒ∂ FIGURE 9.32 Root locus for the uncompensated system of Example 9.5 TABLE 9.5 Predicted characteristics of uncompensated, PD-, and PID-compensated systems of Example 9.5 Uncompensated PD-compensated PID-compensated Plant and compensatorK s¬á8¬Ü s¬á3¬Ü s¬á6¬Ü s¬á10¬ÜK s¬á8¬Ü s¬á55:92¬Ü s¬á3¬Ü s¬á6¬Ü s¬á10¬ÜK s¬á8¬Ü s¬á55:92¬Ü s¬á0:5¬Ü s¬á3¬Ü s¬á6¬Ü s¬á10¬Üs Dominant poles  5:415j10:57  8:13j15:87  7:516j14:67 K 121.5 5.34 4.6 Œ∂ 0.456 0.456 0.456 œân 11.88 17.83 16.49 %OS 20 20 20 Ts 0.739 0.492 0.532 Tp 0.297 0.198 0.214 Kp 5.4 13.27 ‚àû e ‚àû¬Ü 0.156 0.070 0 Other poles  8:169  8:079  8:099,  0:468 Zeros  8  8, 55:92  8, 55:92, 0:5 Comments Second-order approx. OKSecond-order approx. OKZeros at  55:92 and 0:5 not canceled476 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:50 compare the calculated values to those obtained through simulation (Figure 9.35). We estimate that the uncompensated system has a peak time of 0.297 second at20% overshoot. Step 2 To compensate the system to reduce the peak time to two-thirds of that of theuncompensated system, we must Ô¨ÅrstÔ¨Ånd the compensated system ‚Äôs dominant pole location. The imaginary part of the compensated dominant pole is œâ d¬àœÄ Tp¬àœÄ 2=3¬Ü 0:297¬Ü¬à15:87 9.22¬Ü Thus, the real part of the compensated dominant pole is œÉ¬àœâd tan 117 :13¬∞¬à 8:13 9.23¬Ü Next we design the compensator. Using the geometry shown in Figure 9.33, we calculate the compensating zero‚Äô s location. Using the root locus program, we Ô¨Ånd the sum of angles from the uncompensated system ‚Äôs poles and zeros to the desired compensated dominant pole to be  198:37¬∞. Thus, the contribution required from the compensator zero is 198 :37¬∞ 180 ¬∞¬à18:37¬∞. Assume that the compensator zero is located at  zc, as shown in Figure 9.33. Since 15:87 zc 8:13¬àtan 18 :37¬∞ 9.24¬Ü then zc¬à55:92 9.25¬Ü Thus, the PD controller is GPD s¬Ü¬à s¬á55:92¬Ü 9.26¬Ü The complete root locus for the PD-compensated system is sketched in Figure 9.34.Using a root locus program, the gain at the design point is 5.34. Complete speci Ô¨Åcations for ideal derivative compensation are shown in the third column of Table 9.5.‚Äìzc‚Äì8.13j15.87 s-plane œÉPD-compensated dominant poleœâj Note: This fi gure is not drawn to scale. = Closed-loop pole18.37¬∞ FIGURE 9.33 Calculating the PD compensator zero for Example 9.5 ‚Äì10 ‚Äì8 ‚Äì6 ‚Äì3 0117.13¬∞j K = 5.34Œ∂= 0.456 ‚Äì55.92œâ œÉ‚Äì8.13 + j 15.87 ‚Äì106s-planePD-compensated dominant pole Note: This fi gure is not drawn to scale. = Closed-loop pole = Open-loop pole FIGURE 9.34 Root locus for PD-compensated system of Example 9.59.4 Improving Steady-State Error and Transient Response 477WEBC09 10/28/2014 18:1:50 Steps 3 & 4 We simulate the PD-compensated system, as shown in Figure 9.35. We see the reduction in peak time and the improvement in steady-state error over the uncompensated system. Step 5 After we design the PD controller, we design the ideal integral compensator toreduce the steady-state error to zero for a step input. Any ideal integral compensatorzero will work, as long as the zero is placed close to the origin. Choosing the idealintegral compensator to be G PI s¬Ü¬às¬á0:5 s 9.27¬Ü we sketch the root locus for the PID-compensated system, as shown in Figure 9.36.Searching the 0.456 damping ratio line, we Ô¨Ånd the dominant, second-order poles to be ‚Äì10 ‚Äì8 ‚Äì6 ‚Äì3 0117.13¬∞ ‚Äì0.5s-planej K = 4.6Œ∂= 0.456 ‚Äì55.92œâ œÉ‚Äì7.516 + j14.67 Note: This fi gure is not drawn to scale. = Closed-loop pole = Open-loop polePID-compensated dominant pole ‚Äì106 FIGURE 9.36 Root locus for PID-compensated system of Example 9.501.0 0 2.0c(t) Time (seconds)PID Uncompensated 0.2 00.40.60.81.2 1.6 1.2 0.8 0.4PD FIGURE 9.35 Step responses for uncompensated,PD-compensated, and PID-compensated systems of Example 9.5478 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:50 Lag-Lead Compensator Design In the previous example, we serially combined the concepts of ideal derivative and ideal integral compensation to arrive at the desig n of a PID controller that improved both the transient response and the steady-state error performance. In the next example, weimprove both transient response and the steady-state error by using a lead compensatorand a lag compensator rather than the i deal PID. Our compensator is called a lag-lead compensator . WeÔ¨Årst design the lead compensator to imp rove the transient response. Next we evaluate the improvement in steady-state error still required. Finally, we design the lagcompensator to meet the steady-state error requirement. Later in the chapter we showcircuit designs for the passive network. The following steps summarize the designprocedure: 1.Evaluate the performance of the uncompensated system to determine how much improvement in transient response is required. 2.Design the lead compensator to meet the transient response speci Ô¨Åcations. The design includes the zero location, pole location, and the loop gain. 3.Simulate the system to be sure all requirements have been met. 4.Redesign if the simulation shows that requirements have not been met. 5.Evaluate the steady-state error performance for the lead-compensated system to determine how much more improvement in steady-state error is required. 6.Design the lag compensator to yield the required steady-state error. 7.Simulate the system to be sure all requirements have been met. 8.Redesign if the simulation shows that requirements have not been met. 7:516j14:67, with an associated gain of 4.6. The remaining characteristics for the PID-compensated system are summarized in the fourth column of Table 9.5. Step 6 Now we determine the gains, K1,K2, and K3, in Figure 9.30. From Eqs. (9.26) and (9.27), the product of the gain and the PID controller is GPID s¬Ü¬àK s¬á55:92¬Ü s¬á0:5¬Ü s¬à4:6 s¬á55:92¬Ü s¬á0:5¬Ü s ¬à4:6 s2¬á56:42s¬á27:96¬Ü s 9.28¬Ü Matching Eqs. (9.21) and (9.28), K1¬à259:5,K2¬à128:6, and K3¬à4:6. Steps 7 & 8 Returning to Figure 9.35, we summarize the results of our design. PD compensation improved the transient response by decreasing the time required toreach the Ô¨Årst peak as well as yielding some improvement in the steady-state error. The complete PID controller further improved the steady-state error withoutappreciably changing the transient response designed with the PD controller. As we have mentioned before, the PID controller exhibits a slower response, reaching theÔ¨Ånal value of unity at approximately 3 seconds. If this is undesirable, the speed of the system must be increased by redesigning the ideal derivative compensatoror moving the PI controller zero farther from the origin. Simulation plays animportant role in this type of design since our derived equation for settling time isnot applicable for this part of the response, where there is a slow correction of thesteady-state error.9.4 Improving Steady-State Error and Transient Response 479WEBC09 10/28/2014 18:1:53 Example 9.6 Lag-Lead Compensator DesignLag-Lead Compensator Design PROBLEM: Design a lag-lead compensator for the system of Figure 9.37 so that the system will operate with 20% overshoot and a twofold reduction in settling time. Further, the compensatedsystem will exhibit a tenfold improvement in steady-state error for aramp input. SOLUTION: Again, our solution follows the steps just described. Step 1 First we evaluate the performance of the uncompensated system. Searching along the 20% overshoot line Œ∂¬à0:456¬Üin Figure 9.38, we Ô¨Ånd the dominant poles at  1:794j3:501, with a gain of 192.1. The performance of the uncompensated system is summarized in Table 9.6. Step 2 Next we begin the lead compensator design by selecting the location of the compensated system ‚Äôs dominant poles. In order to realize a twofold reduction in settling time, the real part of the dominant pole must be increased by a factor of 2,K s(s + 6)(s + 10)E(s) R(s) C(s) ‚Äì+ FIGURE 9.37 Uncompensated system for Example 9.6 TABLE 9.6 Predicted characteristics of uncompensated, lead-compensated, and lag-lead-compensated systems of Example 9.6 Uncompensated Lead-compensated Lag-lead-compensated Plant and compensatorK s s¬á6¬Ü s¬á10¬ÜK s s¬á10¬Ü s¬á29:1¬ÜK s¬á0:04713 ¬Ü s s¬á10¬Ü s¬á29:1¬Ü s¬á0:01¬Ü Dominant poles  1:794j3:501  3:588j7:003  3:574j6:976 K 192.1 1977 1971 Œ∂ 0.456 0.456 0.456 œân 3.934 7.869 7.838 %OS 20 20 20 Ts 2.230 1.115 1.119 Tp 0.897 0.449 0.450 Kv 3.202 6.794 31.92 e ‚àû¬Ü 0.312 0.147 0.0313 Third pole  12:41  31:92  31:91, 0:0474 Zero None None  0:04713 Comments Second-order approx. OK Second-order approx. OK Second-order approx. OK‚Äì11 ‚Äì10 ‚Äì9 ‚Äì8 ‚Äì7 ‚Äì6 ‚Äì5 ‚Äì4 ‚Äì3 ‚Äì2 ‚Äì1 0117.13¬∞jœâ Œ∂= 0.456 œÉs-plane ‚Äì12.41K = 192.1‚Äì1.794 + j3.501 j1j2j3j4 = Closed-loop pole = Open-loop poleUncompensated dominant pole FIGURE 9.38 Root locus for uncompensated system of Example 9.6480 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:53 since the settling time is inversely proportional to the real part. Thus,  Œ∂œâ n¬à 2 1:794¬Ü¬à  3:588 9.29¬Ü The imaginary part of the design point is œâd¬àŒ∂œântan 117 :13¬∞¬à3:588 tan 117 :13¬∞¬à7:003 9.30¬Ü Now we design the lead compensator. Arbitrarily select a location for the lead compensator zero. For this example, we select the location of the compensator zero coincident with the open-loop pole at  6. This choice will eliminate a zero and leave the lead-compensated system with three poles, the same number as theuncompensated system. We complete the design by Ô¨Ånding the location of the compensator pole. Using the root locus program, sum the angles to the design point from theuncompensated system ‚Äôs poles and zeros and the compensator zero and get  164 :65¬∞. The difference between 180 ¬∞and this quantity is the angular contribution required from the compensator pole, or  15:35¬∞. Using the geometry shown in Figure 9.39, 7:003 pc 3:588¬àtan 15 :35¬∞ 9.31¬Ü from which the location of the compensator pole, pc, is found to be  29:1. The complete root locus for the lead-compensated system is sketched in Figure 9.40. The gain setting at the design point is found to be 1977. ‚Äì33 ‚Äì30 ‚Äì27 ‚Äì24 ‚Äì21 ‚Äì18 ‚Äì15 ‚Äì12 ‚Äì9 ‚Äì6 ‚Äì3 0117.13¬∞j = 0.456 s-plane ‚Äì3.588 + j 7.003 ‚Äì31.91K = 1977 j3j6j9 = Closed-loop pole = Open-loo p poleCompensated dominant pole œÉœâ ùúÅ FIGURE 9.40 Root locus for lead-compensated system of Example 9.6j7.003 ‚Äì3.588 ‚ÄìpcœÉœâj s-plane 15.35¬∞ = Closed-loop pole = O pen-loo p pole FIGURE 9.39 Evaluating the compensator pole for Example 9.69.4 Improving Steady-State Error and Transient Response 481WEBC09 10/28/2014 18:1:54 Steps 3 & 4 Check the design with a simulation. (The result for the lead-compensated system is shown in Figure 9.42 and is satisfactory.) Step 5 Continue by designing the lag compensator to improve the steady-state error. Since the uncompensated system‚Äô s open-loop transfer function is G s¬Ü¬à192:1 s s¬á6¬Ü s¬á10¬Ü 9.32¬Ü the static error constant, Kv, which is inversely proportional to the steady-state error, is 3.201. Since the open-loop transfer function of the lead-compensated system is GLC s¬Ü¬à1977 s s¬á10¬Ü s¬á29:1¬Ü 9.33¬Ü the static error constant, Kv, which is inversely proportional to the steady-state error, is 6.794. Thus, the addition of lead compensation has improved thesteady-state error by a factor of 2.122. Since the requirements of the problemspeci Ô¨Åed a tenfold improvement, the lag compensator must be designed to improve the steady-state error by a factor of 4.713 10=2:122¬à4:713¬Üover the lead-compensated system. Step 6 We arbitrarily choose the lag compensator pole at 0.01, which then places the lagcompensator zero at 0.04713, yielding G lag s¬Ü¬à s¬á0:04713 ¬Ü s¬á0:01¬Ü 9.34¬Ü as the lag compensator. The lag-lead-compensated system ‚Äôs open-loop transfer function is GLLC s¬Ü¬àK s¬á0:04713 ¬Ü s s¬á10¬Ü s¬á29:1¬Ü s¬á0:01¬Ü 9.35¬Ü where the uncompensated system pole at  6 canceled the lead compensator zero at  6. By drawing the complete root locus for the lag-lead-compensated system and by searching along the 0.456 damping ratio line, we Ô¨Ånd the dominant, closed-loop poles to be at  3:574j6:976, with a gain of 1971. The lag-lead-compensated root locus is shown in Figure 9.41. = 0.456 s-plane ‚Äì29.1 ‚Äì31.91‚Äì10 0j ‚Äì0.0474 ‚Äì0.010.04713K = 1971‚Äì3.574 + j 6.976 117.13¬∞Compensated dominant pole = Closed-loop pole = Open-loop pole Note: This fi gure is not drawn to scale.ùúÅœâ œÉ FIGURE 9.41 Root locus for lag-lead-compensated system of Example 9.6482 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:54 A summary of our design is shown in Table 9.6. Notice that the lag-lead compensation has indeed increased the speed of the system, as witnessed by the settling time or the peak time. The steady-state error for a ramp input has also decreased by about 10 times, as seen from e ‚àû¬Ü. Step 7 TheÔ¨Ånal proof of our designs is shown by the simulations of Figures 9.42 and 9.43. The improvement in the transient response is shown in Figure 9.42, where we see the peak time occurring sooner in the lag-lead-compensated system.Improvement in the steady-state error for a ramp input is seen in Figure 9.43, where each step of our design yields more improvement. The improvement for the lead-compensated system is shown in Figure 9.43( a), and the Ô¨Ånal improvement due to the addition of the lag is shown in Figure 9.43( b). (a) (b)Lead-compensated InputUncompensated 05.0 4.54.03.53.02.52.01.51.00.5 00 5c(t) t 4 3 2 1 05.04.54.03.53.02.52.01.51.00.5 00 5 t 4 3 2 1 Time (seconds)c(t)Time (seconds) Lag-lead-compensatedInput FIGURE 9.43 Improvement in ramp response error for the system of Example 9.6:a.lead-compensated; b.lag-lead-compensatedUncompensated 01.25 1.000.750.500.25 0 01 45c(t) 23Lead- and lag-lead-compensated Time (seconds)FIGURE 9.42 Improvement in step response for lag-lead- compensated system ofExample 9.69.4 Improving Steady-State Error and Transient Response 483WEBC09 10/28/2014 18:1:54 In the previous example, we canceled the system pole at  6 with the lead compensator zero. The design technique is the same if you place the lead compensator zero at a different location. Placing a zero at a different location and not canceling the open-loop pole yields asystem with one more pole than the example. This increased complexity could make it moredifÔ¨Åcult to justify a second-order approximation. In any case, simulations should be used at each step to verify performance. Notch Filter If a plant, such as a mechanical system, has high-frequency vibration modes, then a desiredclosed-loop response may be dif Ô¨Åcult to obtain. These high-frequency vibration modes can be modeled as part of the plant ‚Äôs transfer function by pairs of complex poles near the imaginary axis. In a closed-loop con Ô¨Åguration, these poles can move closer to the imaginary axis or even cross into the right half-plane, as shown in Figure 9.44( a). Instability or high-frequency oscillations superimposed over the desired response can result (see Figure 9.44( b)). j s-plane Plant‚Äôs high-frequency polesPlant‚Äôs poles (a)œÉœâ Response Time (b) s-planej (c)œâ œÉj s-plane Notch filter zeros and plant high-frequency polesPlant‚Äôs polesNotch filter poles (d)œâ œÉ FIGURE 9.44 a.Root locus before cascading notch Ô¨Ålter;b.typical closed-loop step response before cascading notch Ô¨Ålter;c.pole-zero plot of a notch Ô¨Ålter;d.root locus after cascading notch Ô¨Ålter; (Ô¨Ågure continues )484 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:54 One way of eliminating the high-frequency oscillations is to cascade a notch Ô¨Ålter2 with the plant ( Kuo,1995 ), as shown in Figure 9.44( c). The notch Ô¨Ålter has zeros close to the low-damping-ratio poles of the plant as well as two real poles. Figure 9.44( d) shows that the root locus branch from the high-frequency poles now goes a short distance from the high- frequency pole to the notch Ô¨Ålter‚Äôs zero. The high-frequency response will now be negligible because of the pole-zero cancellation (see Figure 9.44( e)). Other cascade compensators can now be designed to yield a desired response. The notch Ô¨Ålter will be applied to Progressive Analysis and Design Problem 55 near the end of this chapter. Response Time (e) FIGURE 9.44 (Continued )e.closed-loop step response after cascading notch Ô¨Ålter Skill-Assessment Exercise 9.3 PROBLEM: A unity feedback system with forward transfer function G s¬Ü¬àK s s¬á7¬Ü is operating with a closed-loop step response that has 20% overshoot. Do the following: a.Evaluate the settling time. b.Evaluate the steady-state error for a unit ramp input. c.Design a lag-lead compensator to decrease the settling time by 2 times and decrease thesteady-state error for a unit ramp input by 10 times. Place the lead zero at  3. ANSWERS: a.T s¬à1:143 s b.eramp ‚àû¬Ü¬à0:1189 c.Gc s¬Ü¬à s¬á3¬Ü s¬á0:092¬Ü s¬á9:61¬Ü s¬á0:01¬Ü;K¬à205:4 The complete solution is at www.wiley.com/college/nise . 2The name of this Ô¨Ålter comes from the shape of its magnitude frequency response characteristics, which shows a dip near the damped frequency of the high-frequency poles. Magnitude frequency response is discussed in Chapter 10.9.4 Improving Steady-State Error and Transient Response 485WEBC09 10/28/2014 18:1:56 Before concluding this section, let us brie Ô¨Çy summarize our discussion of cascade compensation. In Sections 9.2, 9.3, and 9.4, we used cascade compensators to improve transient response and steady-state error. Table 9.7 itemizes the types, functions, andcharacteristics of these compensators. TABLE 9.7 Types of cascade compensators Function Compensator Transfer function Characteristics Improve steady-state error PI Ks¬ázc s1.Increases system type. 2.Error becomes zero. 3.Zero at  zcis small and negative. 4.Active circuits are required to implement. Improve steady-state error Lag Ks¬ázc s¬ápc1.Error is improved but not driven to zero. 2.Pole at  pcis small and negative. 3.Zero at  zcis close to, and to the left of, the pole at  pc. 4.Active circuits are not required to implement. Improve transient response PD K s¬ázc¬Ü 1.Zero at  zcis selected to put design point on root locus. 2.Active circuits are required to implement. 3.Can cause noise and saturation; implement with rate feedback or with a pole (lead). Improve transient response Lead Ks¬ázc s¬ápc1.Zero at  zcand pole at  pcare selected to put design point on root locus. 2.Pole at  pcis more negative than zero at  zc. 3.Active circuits are not required to implement. Improve steady-state error and transient responsePID K s¬ázlag¬Ü s¬ázlead¬Ü s1.Lag zero at  zlagand pole at origin improve steady-state error. 2.Lead zero at  zleadimproves transient response. 3.Lag zero at  zlagis close to, and to the left of, the origin. 4.Lead zero at  zleadis selected to put design point on root locus. 5.Active circuits required to implement. 6.Can cause noise and saturation; implement with rate feedback or with an additional pole. Improve steady-state error and transient responseLag-lead K s¬ázlag¬Ü s¬ázlead¬Ü s¬áplag¬Ü s¬áplead¬Ü1.Lag pole at  plagand lag zero at  zlagare used to improve steady-state error. 2.Lead pole at  pleadand lead zero at  zleadare used to improve transient response. 3.Lag pole at  plagis small and negative. 4.Lag zero at  zlagis close to, and to the left of, lag pole at  plag. 5.Lead zero at  zleadand lead pole at  pleadare selected to put design point on root locus. 6.Lead pole at  pleadis more negative than lead zero at  zlead. 7.Active circuits are not required to implement.486 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:56 9.5 Feedback Compensation In Section 9.4, we used cascade compensation as a way to improve transient response and steady-state response independently. Cascading a compensator with the plant is not the onlyway to reshape the root locus to intersect the closed-loop s-plane poles that yield a desired transient response. Transfer functions designed to be placed in a feedback path can alsoreshape the root locus. Figure 9.45 is a generic con Ô¨Åguration showing a compensator, H c(s), placed in the minor loop of a feedback control system. Other con Ô¨Ågurations arise if we consider Kunity, G2(s) unity, or both unity. The design procedures for feedback compensation can be more complicated than for cascade compensation. On the other hand, feedback compensation can yield fasterresponses. Thus, the engineer has the luxury of designing faster responses into portionsof a control loop in order to provide isolation. For example, the transient response of theailerons and rudder control systems of an aircraft can be designed separately to be fast inorder to reduce the effect of their dynamic response on the steering control loop. Feedbackcompensation can be used in cases where noise problems preclude the use of cascadecompensation. Also, feedback compensation may not require additional ampli Ô¨Åcation, since the signal passing through the compensator originates at the high-level output of the forwardpath and is delivered to a low-level input in the forward path. For example, let KandG 2(s)i n Figure 9.45 be unity. The input to the feedback compensator, KfHc(s), is from the high-level output of G1(s), while the output of KfHc(s) is one of the low-level inputs into K1. Thus, there is a reduction in level through KfHc(s), and ampli Ô¨Åcation is usually not required. A popular feedback compensator is a rate sensor that acts as a differentiator. In aircraft and ship applications, the rate sensor can be a rate gyro that responds with anoutput voltage proportional to the input angular velocity. In many other systems this rate sensor is implemented with a tachometer . A tachometer is a voltage generator that yields a voltage output proportional to input rotational speed. This compensator can easily be geared to the position output of a system. Figure 9.46 is a position control R(s) K Minor loopK1C(s)G1(s) G2(s) Hc (s)‚Äì+ ‚Äì+ Major loopKfFIGURE 9.45 Generic control system with feedback compensation. Inertia Motor Input potentiomete r Tachometer Output potentiometer Photo by Mark E. Van Dusen. FIGURE 9.46 A position control system that uses a tachometer as a differentiator inthe feedback path. Can you see the similarity between this system and the schematic on thefront endpapers?9.5 Feedback Compensation 487WEBC09 10/28/2014 18:1:57 system showing the gearing of the tachometer to the motor. You can see the input and output potentiometers as well as the motor and inertial load. The block diagram representation of a tachometer is shown in Figure 9.47( a), and its typical position within a control loop is shown in Figure 9.47( b). While this section shows methods for des igning systems using rate feedback, it also sets the stage for compensation techniques in Chapter 12, where not only rate but all states including position will be fed ba ck for proper control system performance. We now discuss design procedures. Typically, the design of feedback compensation consists of Ô¨Ånding the gains, such as K,K1, and Kfin Figure 9.45, after establishing a dynamic form for Hc(s). There are two approaches. The Ô¨Årst is similar to cascade compensation. Assume a typical feedback system, where G(s) is the forward path and H(s) is the feedback. Now consider that a root locus is plotted from G(s)H(s). With cascade compensation we added poles and zeros to G(s). With feedback compensation, poles and zeros are added via H(s). With the second approach, we design a speci Ô¨Åed performance for the minor loop, shown in Figure 9.45, followed by a design of the major loop. Thus, the minor loop, such asailerons on an aircraft, can be designed with its own performance speci Ô¨Åcations and operate within the major loop. Approach 1 TheÔ¨Årst approach consists of reducing Figure 9.45 to Figure 9.48 by pushing Kto the right past the summing junction, pushing G2(s) to the left past the pickoff point, and then adding the two feedback paths. Figure 9.48 shows that the loop gain, G(s)H(s), is G s¬ÜH s¬Ü¬àK1G1 s¬Ü¬âKfHc s¬Ü¬áKG 2 s¬Ü¬ä 9.36¬Ü Without feedback, KfHc(s), the loop gain is G s¬ÜH s¬Ü¬àKK 1G1 s¬ÜG2 s¬Ü 9.37¬Ü Thus, the effect of adding feedback is to replace the poles and zeros of G2(s) with the poles and zeros of ¬âKfHc s¬Ü¬áKG 2 s¬Ü¬ä. Hence, this method is similar to cascade compensation in that we add new poles and zeros via H(s) to reshape the root locus to go through the design point. However, one must remember that zeros of the equivalent feedback shown inFigure 9.48, H s¬Ü¬à¬â K fHc s¬Ü¬áKG 2 s¬Ü¬ä=KG 2 s¬Ü, are not closed-loop zeros.R(s) K TachometerC(s)i(s) (a) (b)Vo(s) K1 G1(s) ‚Äì+ ‚Äì+Kf s Kf sŒ∏ FIGURE 9.47 a.Transfer function of a tachometer; b.tachometer feedback compensation KK1G1(s)G2(s) KfHc(s) + KG2(s) KG2(s)R(s) C(s) ‚Äì+ FIGURE 9.48 Equivalent block diagram of Figure 9.45488 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:57 For example, if G2 s¬Ü¬à1 and the minor-loop feedback, KfHc(s), is a rate sensor, KfHc s¬Ü¬àKfs, then from Eq. (9.36) the loop gain is G s¬ÜH s¬Ü¬àKfK1G1 s¬Üs¬áK Kf/C18/C19 9.38¬Ü Thus, a zero at  K=Kfis added to the existing open-loop poles and zeros. This zero reshapes the root locus to go through the desired design point. A Ô¨Ånal adjustment of the gain, K1, yields the desired response. Again, you should verify that this zero is not a closed-loop zero. Let us look at a numerical example. Example 9.7 Compensating Zero via Rate FeedbackCompensating Zero via Rate Feedback PROBLEM: Given the system of Figure 9.49( a), design rate feedback compensation, as shown in Figure 9.49( b), to reduce the settling time by a factor of 4 while continuing to operate the system with 20% overshoot. SOLUTION: First design a PD compensator. For the uncompensated system, search along the 20% overshoot line Œ∂¬à0:456¬ÜandÔ¨Ånd that the dominant poles are at  1:809j3:531, as shown in Figure 9.50. The estimated speci Ô¨Åcations for the uncompensated system ‚Äìj20‚Äìj10j10j20j 20% OS ‚Äì20 ‚Äì10 0 10 20s-plane ‚Äì1.809 + j3.531 K1 = 257.8117.13¬∞ œÉœâ FIGURE 9.50 Root locus for uncompensated system of Example 9.7‚Äì+ K1 s(s + 5)(s + 15)E(s) C(s) R(s) (a) (b) (c) (d)‚Äì+ s(s + 5)(s + 15)C(s) R(s) ‚Äì+ s(s + 5)(s + 15)C(s) R(s) ‚Äì+ s[s2 + 20s + (75 + K1Kf)]E(s) C(s) R(s)Kfs‚Äì+ 1 Kf s + 1 KfK1 K1 K1 FIGURE 9.49 a.System for Example 9.7; b.system with rate feedback compensation; c.equivalent compensated system; d.equivalent compensated system showing unity feedback9.5 Feedback Compensation 489WEBC09 10/28/2014 18:1:59 are shown in Table 9.8, and the step response is shown in Figure 9.51. The settling time is 2.21 seconds and must be reduced by a factor of 4 to 0.55 second. Next determine the location of the dominant poles for the compensated system. To achieve a fourfold decrease in the settling time, the real part of the pole must be increasedby a factor of 4. Thus, the compensated pole has a real part of 4  1:809¬Ü¬à  7:236. The imaginary part is then œâ d¬à 7:236 tan 117 :13¬∞¬à14:12 9.39¬Ü where 117 :13¬∞is the angle of the 20% overshoot line. Using the compensated dominant pole position of  7:236j14:1 2 ,w es u mt h e angles from the uncompensated system ‚Äôs poles and obtain  277:33¬∞. This angle requires a compensator zero contribution of ¬á97:33¬∞to yield 180 ¬∞at the design point.TABLE 9.8 Predicted characteristics of uncompensated and compensated systems of Example 9.7 Uncompensated Compensated Plant and compensatorK1 s s¬á5¬Ü s¬á15¬ÜK1 s s¬á5¬Ü s¬á15¬Ü Feedback 1 0:185 s¬á5:42¬Ü Dominant poles  1:809j3:531  7:236j14:12 K1 257.8 1388 Œ∂ 0.456 0.456 œân 3.97 15.87 %OS 20 20 Ts 2.21 0.55 Tp 0.89 0.22 Kv 3.44 4.18 e ‚àû¬Ü(ramp) 0.29 0.24 Other poles  16:4  5:53 Zero None None Comments Second-order approx. OK Simulate 0 0.5 1.0 1.5 2.0 2.5 Time (seconds)0.2 00.40.60.81.01.2c(t) 3.0 FIGURE 9.51 Step response for uncompensated system of Example 9.7490 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:1:59 The geometry shown in Figure 9.52 leads to the calculation of the compensator ‚Äôs zero location. Hence, 14:12 7:236 zc¬àtan 180 ¬∞ 97:33¬∞¬Ü 9.40¬Ü from which zc¬à5:42. The root locus for the equivalent compensated system of Figure 9.49( c) is shown in Figure 9.53. The gain at the design point, which is K1Kf from Figure 9.49(c ), is found to be 256.7. Since Kfis the reciprocal of the compensator zero, Kf¬à0:185. Thus, K1¬à1388. In order to evaluate the steady-state error characteristic, Kvis found from Figure 9.49( d)t ob e Kv¬àK1 75¬áK1Kf¬à4:18 9.41¬Ü Predicted performance for the compensated system is shown in Table 9.8. Notice that the higher-order pole is not far enough awayfrom the dominant poles and thus cannot be neglected. Further, fromFigure 9.49( d), we see that the closed-loop transfer function is T s¬Ü¬à G s¬Ü 1¬áG s¬ÜH s¬Ü¬àK1 s3¬á20s2¬á 75¬áK1Kf¬Üs¬áK1 9.42¬Ü Thus, as predicted, the open-loop zero is not a closed-loop zero, and there isno pole-zero cancellation. Hence, the design must be checked by simulation. The results of the simulation are shown in Figure 9.54 and show an over-damped response with a settling time of 0.75 second, comparedto the uncompensated system ‚Äôs settling time of approximately 2.2 seconds. Although not meeting the design requirements, the response still represents an improvement over the uncompensated system of Figure 9.51. Typically, less overshoot is acceptable. The system shouldbe redesigned for further reduction in settling time. You may want to do Problem 8 at the end of this chapter, where you can repeat this example using PD cascade compensation. You willsee that the compensator zero for cascade compensation is a closed-loopzero, yielding the possibility of pole-zero cancellation. However, PDcompensation is usually noisy and not always practical.‚Äì7.236 ‚Äìzcj14.12 Compensator zeroj s-plane œÉœâ 97.33¬∞ = Closed-loop pole FIGURE 9.52 Finding the compensator zero in Example 9.7 ‚Äìj20‚Äìj10j10j20 ‚Äì20 ‚Äì10 0j s-plane‚Äì7.236 + j14.12 K1 = 1388 117.13¬∞= 0.456 = Closed-loop pole = Open-loop poleùúÅ œÉœâ FIGURE 9.53 Root locus for the compensated system of Example 9.7 0.5 01.0c(t) 0 0.5 1.0 1.5 2.0 2.5 Time (seconds)3.0FIGURE 9.54 Step response for the compensated system of Example 9.79.5 Feedback Compensation 491WEBC09 10/28/2014 18:2:0 Approach 2 The second approach allows us to use feedback compensation to design a minor loop ‚Äôs transient response separately from the closed-loop system response. In the case of an aircraft, the minor loop may control the position of the aerosurfaces, while the entire closed-loop system may control the entire aircraft ‚Äôs pitch angle. We will see that the minor loop of Figure 9.45 basically represents a forward-path transfer function whose poles can be adjusted with the minor-loop gain. These poles thenbecome the open-loop poles for the entire control system. In other words, rather thanreshaping the root locus with additional poles and zeros, as in cascade compensation, we canactually change the plant ‚Äôs poles through a gain adjustment. Finally, the closed-loop poles are set by the loop gain, as in cascade compensation. Example 9.8 Minor-Loop Feedback CompensationMinor-Loop Feedback Compensation PROBLEM: For the system of Figure 9.55( a), design minor-loop feedback compensa- tion, as shown in Figure 9.55( b), to yield a damping ratio of 0.8 for the minor loop and a damping ratio of 0.6 for the closed-loop system. SOLUTION: Theminorloopisde Ô¨Ånedastheloopcontainingtheplant,1 =¬âs s¬á5¬Ü s¬á15¬Ü¬ä, and the feedback compensator, Kfs. The value of Kfwill be adjusted to set the location of the minor-loop poles, and then Kwill be adjusted to yield the desired closed-loop response. The transfer function of the minor loop, GML(s), is GML s¬Ü¬à1 s¬âs2¬á20s¬á 75¬áKf¬Ü¬ä 9.43¬Ü The poles of GML(s) can be found analytically or via the root locus. The root locus for the minor loop, where Kfs=¬âs s¬á5¬Ü s¬á15¬Ü¬äis the open-loop transfer function, is shown in Figure 9.56. Since the zero at the origin comes from the feedback transfer function of the minor loop, this zero is not a zero of the closed-loop transfer function of the minor loop.Hence, the pole at the origin appears to remain stationary, and there is no pole-zerocancellation at the origin. Equation (9.43) also shows this phenomenon. We see astationary pole at the origin and two complex poles that change with gain. Notice thatthe compensator gain, K f, varies the natural frequency, œân, of the minor-loop poles as seens(s + 5)(s + 15) R(s) + ‚ÄìK+ ‚ÄìC(s) 1 s(s + 5)(s + 15)(a) (b)R(s) + C(s) K E(s) Kfs‚Äì FIGURE 9.55 a.Uncompensated system and b.feedback-compensated system for Example 9.8492 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:0 from Eq. (9.43). Since the real parts of the complex poles are constant at  Œ∂œâ n¬à 10, the damping ratio must also be varying to keep 2Œ∂œâ n¬à20, a constant. Drawing the Œ∂¬à0:8 line in Figure 9.56 yields the complex poles at  10j7:5. The gain, Kf,which equals 81.25, places the minor-loop poles in a position to meet the speci Ô¨Åcations. The poles just found,  10j7:5, as well as the pole at the origin (Eq. (9.43)), act as open-loop poles that generate a root locus for variations of the gain, K. TheÔ¨Ånal root locus for the system is shown in Figure 9.57. The Œ∂¬à0:6d a m p i n g ratio line is drawn and searched. The clo sed-loop complex poles are found to be  4:535j6:0 4 6 ,w i t har e q u i r e dg a i no f6 2 4 . 3 .At h i r dp o l ei sa t  10:93.‚Äìj20‚Äìj10‚Äì20j10j20 = 0.8j 10 20 ‚Äì15 ‚Äì5 0s-plane ‚Äì10 + j 7.5 Kf=81.25 = Closed-loop pole (minor loop) = Open-loo p pole143.13¬∞ ‚Äì10ùúÅœâ œÉ FIGURE 9.56 Root locus for minor loop of Example 9.8 Virtual Experiment 9.2 Improving Performance Using Rate Feedback with PD or PID Control Put theory into practice and design a compensator in LabVIEW that controls the ball position in the QuanserMagnetic Levitation system. Magnetic Levitation technology is used for moderntransportation systems thatsuspend, such as the high-speed Magnetic Levitation train. Virtual experiments are found on Learning Space.= 0.6j ‚Äì20 ‚Äì10 10 20 ‚Äìj50j15j20 ‚Äìj15 ‚Äìj20‚Äì 4.535 + j6.046 K = 624.3 = Closed-loop pole = Open-loo p poles-plane 126.87¬∞j5 ‚Äì10.93 ‚Äìj10j10ùúÅœâ œÉ FIGURE 9.57 Root locus for closed-loop system of Example 9.89.5 Feedback Compensation 493WEBC09 10/28/2014 18:2:2 The results are summarized in Table 9.9. We see that the compensated system, although having the same damping ratio as the uncompensated system, is much faster and also has a smaller steady-state error. The results, however, are predicted results and mustbe simulated to verify percent overshoot, settling time, and peak time, since the third poleis not far enough from the dominant poles. The step response is shown in Figure 9.58 and closely matches the predicted performance.TABLE 9.9 Predicted characteristics of the uncompensated and compensated systems of Example 9.8 Uncompensated Compensated Plant and compensatorK1 s s¬á5¬Ü s¬á15¬ÜK s s2¬á20s¬á156:25¬Ü Feedback 1 1 Dominant poles  1:997j2:662  4:535j6:046 K 177.3 624.3 Œ∂ 0.6 0.6 œân 3.328 7.558 %OS 9.48 9.48 Ts 2 0.882 Tp 1.18 0.52 Kv 2.364 3.996 e ‚àû¬Ü(ramp) 0.423 0.25 Other poles  16  10:93 Zero None None Comments Second-order approx. OK Simulate 00 0.2 0.4 0.8 1.0 1.2 0.6 Time (seconds)c(t) 0.20.40.60.81.01.2 FIGURE 9.58 Step response simulation for Example 9.8 Skill-Assessment Exercise 9.4 PROBLEM: For the system of Figure 9.59, design minor-loop rate feedback compensa- tion to yield a damping ratio of 0.7 for the minor loop ‚Äôs dominant poles and a damping ratio of 0.5 for the closed-loop system ‚Äôs dominant poles.494 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:3 Our discussion of compensation methods is now complete. We studied both cascade and feedback compensation and compared and contrasted them. We are now ready to show how to physically realize the controllers and compensators we designed. 9.6 Physical Realization of Compensation In this chapter, we derived compensation to improve transient response and steady-stateerror in feedback control systems. Transfer functions of compensators used in cascade withthe plant or in the feedback path were derived. These compensators were de Ô¨Åned by their pole-zero con Ô¨Ågurations. They were either active PI, PD, or PID controllers or passive lag, lead, or lag-lead compensators. In this section, we show how to implement the active controllers and the passive compensators. Active-Circuit Realization In Chapter 2, we derived Vo s¬Ü Vi s¬Ü¬à Z2 s¬Ü Z1 s¬Ü 9.44¬Ü as the transfer function of an inverting operational ampliÔ¨Å er whose con Ô¨Ågura- tion is repeated here in Figure 9.60. By judicious choice of Z1(s) and Z2(s), this circuit can be used as a building block to implement the compensators and controllers, such as PID controllers, discussed in this chapter. Table 9.10summarizes the realization of PI, PD, and PID controllers as well as lag, lead,ANSWER: The system is con Ô¨Ågured similar to Figure 9.55( b) with Kf¬à77:42 and K¬à626:3. The complete solution is at www.wiley.com/college/nise .‚ÄìKC(s) + R(s) s(s+ 7)(s + 10)1 FIGURE 9.59 System for Skill-Assessment Exercise 9.4 +‚ÄìZ1(s)Z2(s) I1(s)V1(s) Vo(s)Vi(s) Ia(s)I2(s) FIGURE 9.60 Operational ampli Ô¨Åer conÔ¨Ågured for transfer function realization TABLE 9.10 Active realization of controllers and compensators, using an operational ampli Ô¨Åer Function Z1 s¬Ü Z2 s¬Ü Gc s¬Ü¬à Z2 s¬Ü Z1 s¬Ü GainR1 R2  R2 R1 IntegrationR C  1 RC s DifferentiationC R  RCs (table continues)9.6 Physical Realization of Compensation 495WEBC09 10/28/2014 18:2:4 and lag-lead compensators using operational ampli Ô¨Åers. You can verify the table by using the methods of Chapter 2 to Ô¨Ånd the impedances. Other compensators can be realized by cascading compensators shown in the table. For example, a lag-lead compensator can be formed by cascading the lag compensator with the lead compensator, as shown in Figure 9.61. As an example, let us implement one of the controllers we designed earlier in the chapter.TABLE 9.10 Active realization of controllers and compensators, using an operational ampli Ô¨Åer(Continued ) Function Z1 s¬Ü Z2 s¬Ü Gc s¬Ü¬à Z2 s¬Ü Z1 s¬Ü PI controllerR1 C R2  R2 R1s¬á1 R2C/C18/C19 s PD controllerC R1R2  R2Cs ¬á1 R1C/C18/C19 PID controllerC1 R1C2 R2  R2 R1¬áC1 C2/C18/C19 ¬áR2C1s¬á1 R1C2 s2 6643 775 Lag compensationC1 R1C2 R2 C1 C2s¬á1 R1C1/C18/C19 s¬á1 R2C2/C18/C19 where R2C2>R1C1 Lead compensationC1 R1C2 R2 C1 C2s¬á1 R1C1/C18/C19 s¬á1 R2C2/C18/C19 where R1C1>R2C2 +‚Äìvi(t) vo(t)R1C1 R3C3R2C2 Lag compensator R2C2>R1C1Lead compensator R3C3>R4C4+‚ÄìR4C4 FIGURE 9.61 Lag-lead compensator implemented with operational ampli Ô¨Åers496 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:5 Passive-Circuit Realization Lag, lead, and lag-lead compensators can also be implemented with passive networks. Table 9.11 summarizes the networks and their transfer functions. The transfer functions canbe derived with the methods of Chapter 2. The lag-lead transfer function can be put in the following form: G c s¬Ü¬às¬á1 T1/C18/C19 s¬á1 T2/C18/C19 s¬á1 Œ±T1/C18/C19 s¬áŒ± T2/C18/C19 9.50¬Ü where Œ±<1. Thus, the terms with T1form the lead compensator, and the terms with T2form the lag compensator. Equation (9.50) shows a restriction inherent in using this passive realization. We see that the ratio of the lead compensator zero to the lead compensator poleExample 9.9 Implementing a PID ControllerImplementing a PID Controller PROBLEM: Implement the PID controller of Example 9.5. SOLUTION: The transfer function of the PID controller is Gc s¬Ü¬à s¬á55:92¬Ü s¬á0:5¬Ü s 9.45¬Ü which can be put in the form Gc s¬Ü¬às¬á56:42¬á27:96 s 9.46¬Ü Comparing the PID controller in Table 9.10 with Eq. (9.46), we obtain the following three relationships: R2 R1¬áC1 C2¬à56:42 9.47¬Ü R2C1¬à1 9.48¬Ü and 1 R1C2¬à27:96 9.49¬Ü Since there are four unknowns and three equations, we arbitrarily select a practical value for one of the elements. Selecting C2¬à0:1ŒºF, the remaining values are found to be R1¬à357:65 kŒ©,R2¬à178;891 kŒ©, andC1¬à5:59ŒºF. The complete circuit is shown in Figure 9.62, where the circuit element values have been rounded off.vi(t) 358 kŒ©179 kŒ© +‚Äìv1(t) vo(t)5.6 ŒºF0.1 ŒºF FIGURE 9.62 PID controller9.6 Physical Realization of Compensation 497WEBC09 10/28/2014 18:2:6 must be the same as the ratio of the lag compensator pole to the lag compensator zero. In Chapter 11 we design a lag-lead compensator with this restriction. A lag-lead compensator without this restriction can be realized with an active network as previously shown or with passive networks by cascading the lead and lag networksshown in Table 9.11. Remember, though, that the two networks must be isolated to ensurethat one network does not load the other. If the networks load each other, the transferfunction will not be the product of the individual transfer functions. A possible realizationusing the passive networks uses an operational ampli Ô¨Åer to provide isolation. The circuit is shown in Figure 9.63. Example 9.10 demonstrates the design of a passive compensator.TABLE 9.11 Passive realization of compensators Function Network Transfer function,Vo s¬Ü Vi s¬Ü Lag compensation vi(t)R1 R2 Cvo(t)+ + ‚Äì ‚ÄìR2 R1¬áR2s¬á1 R2C s¬á1 R1¬áR2¬ÜC Lead compensation vi(t)R1 R2Cvo(t)+ + ‚Äì ‚Äìs¬á1 R1C s¬á1 R1C¬á1 R2C Lag-lead compensation vi(t)R1 R2C1 C2vo(t)+ + ‚Äì ‚Äìs¬á1 R1C1/C18/C19 s¬á1 R2C2/C18/C19 s2¬á1 R1C1¬á1 R2C2¬á1 R2C1/C18/C19 s¬á1 R1R2C1C2 R4 R5C2R2R1 R3R3 C1 Lag Isolation gain = ‚Äì1Lead+ ‚Äì+ ‚Äìvo(t)vi(t)‚Äì + FIGURE 9.63 Lag-lead compensator implemented with cascaded lag and lead networks with isolation498 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:7 Example 9.10 Realizing a Lead CompensatorRealizing a Lead Compensator PROBLEM: Realize the lead compensator designed in Example 9.4 (Compensator b). SOLUTION: The transfer function of the lead compensator is Gc s¬Ü¬às¬á4 s¬á20:09 9.51¬Ü Comparing the transfer function of a lead network shown in Table 9.11 with Eq. (9.51), we obtain the following two relationships: 1 R1C¬à4 9.52¬Ü and 1 R1C¬á1 R2C¬à20:09 9.53¬Ü Hence, R1C¬à0:25, and R2C¬à0:0622. Since there are three network elements and two equations, we may select one of the element values arbitrarily. Letting C¬à1ŒºF, then R1¬à 250 kŒ©andR2¬à62:2kŒ©. Skill-Assessment Exercise 9.5 PROBLEM: Implement the compensators shown in a. and b. below. Choose a passive realization if possible. a.Gc s¬Ü¬à s¬á0:1¬Ü s¬á5¬Ü s b.Gc s¬Ü¬à s¬á0:1¬Ü s¬á2¬Ü s¬á0:01¬Ü s¬á20¬Ü ANSWERS: a.Gc(s) is a PID controller and thus requires active realization. Use Figure 9.60 with the PID controller circuits shown in Table 9.10. One possible set of approximatecomponent values is C 1¬à10ŒºF;C2¬à100ŒºF;R1¬à20 kŒ©;R2¬à100 kŒ© b.Gc(s) is a lag-lead compensator that can be implemented with a passive network because the ratio of the lead pole to zero is the inverse of the ratio of the lag pole tozero. Use the lag-lead compensator circuit shown in Table 9.11. One possible set ofapproximate component values is C 1¬à100ŒºF;C2¬à900ŒºF;R1¬à100 kŒ©;R2¬à560Œ© The complete solution is at www.wiley.com.college/nise .9.6 Physical Realization of Compensation 499WEBC09 10/28/2014 18:2:10 Case Studies Antenna Control: Lag-Lead CompensationAntenna Control: Lag-Lead Compensation For the antenna azimuth position control system case study in Chapter 8, we obtained a 25% overshoot using a simple gain adjustment. Once this percent overshoot was obtained,the settling time was determined. If we try to improve the settling time by increasing thegain, the percent overshoot also increases. In this section, we continue with the antennaazimuth position control by designing a cascade compensator that yields 25% overshoot ata reduced settling time. Further, we effect an improvement in the steady-state errorperformance of the system. PROBLEM: Given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 1, design cascade compensation to meet the following requirements: (1) 25% overshoot, (2) 2-second settling time, and (3) K v¬à20. SOLUTION: For the case study in Chapter 8, a preampli Ô¨Åer gain of 64.21 yielded 25% overshoot, with the dominant, second-order poles at  0:833j1:888. The settling time is thus 4= Œ∂œân¬à4=:833¬à4:8 seconds. The open-loop function for the system as derived in the case study in Chapter 5 is G s¬Ü¬à6:63K=¬âs s¬á1:71¬Ü s¬á100¬Ü¬ä. Hence Kv¬à6:63K= 1:71100¬Ü¬à2:49. Comparing these values to this example ‚Äôs problem statement, we want to improve the settling time by a factor of 2.4, and we want approximately an eightfold improvement in Kv. Lead compensator design to improve transient response: First locate the dominant second-order pole. To obtain a settling time, Ts, of 2 seconds and a percent overshoot of 25%, the real part of the dominant second-order pole should be at  4=Ts¬à 2. Locating the pole on the 113 :83¬∞line ( Œ∂¬à0:404, corresponding to 25% overshoot) yields an imaginary part of 4.529 (see Figure 9.64). Second, assume a lead compensator zero and Ô¨Ånd the compensator pole. Assuming a compensator zero at  2, along with the uncompensated system ‚Äôs open-loop poles and zeros, use the root locus program in Appendix H.2 at www.wiley.com/college/nise toÔ¨Ånd that there is an angular contribution of  120 :14¬∞at the design point of  2j4:529. Therefore, the compensator ‚Äôs pole must contribute 120 :14¬∞ 180 ¬∞¬à 59:86¬∞for the design point to be on the compensated system ‚Äôs root locus. The geometry is shown in Figure 9.64. To calculate the compensator pole, we use 4 :529= pc 2¬Ü¬àtan 59 :86¬∞or pc¬à4:63. 59.86¬∞ ‚Äì1.71 ‚Äì2 0 ‚Äì100113.83¬∞‚Äì2 + j4.529j ‚Äìpcs-plane = Closed-loop pole = Open-loop pole Note: This fi gure is not drawn to scale.= 0.404ùúÅœâ œÉ FIGURE 9.64 Locating compensator pole500 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:11 Now determine the gain. Using the lead-compensated system ‚Äôs open-loop function, G s¬Ü¬à6:63K s¬á2¬Ü s s¬á1:71¬Ü s¬á100¬Ü s¬á4:63¬Ü 9.54¬Ü and the design point  2¬áj4:529 as the test point in the root locus program, the gain, 6.63K, is found to be 2549. Lag compensator design to improve the steady-state error: Kvfor the lead- compensated system is found using Eq. (9.54). Hence, Kv¬à2549 2¬Ü 1:71¬Ü 100¬Ü 4:63¬Ü¬à6:44 9.55¬Ü Since we want Kv¬à20, the amount of improvement required over the lead-compensated system is 20 =6:44¬à3:1. Choose pc¬à 0:01 and calculate zc¬à0:031, which is 3.1 times larger. Determine gain: The complete lag-lead-compensated open-loop function, GLLC(s), is GLLC s¬Ü¬à6:63K s¬á2¬Ü s¬á0:031¬Ü s s¬á:01¬Ü s¬á1:71¬Ü s¬á4:63¬Ü s¬á100¬Ü 9.56¬Ü Using the root locus program in Appendix H.2 at www.wiley.com/college/nise and the poles and zeros of Eq. (9.56), search along the 25% overshoot line 113:83¬∞¬Üfor the design point. This point has moved sligh tly with the addition of the lag compensator to 1:99j4:51. The gain at this point equals 2533, which is 6.63 K. Solving for Kyields K¬à382:1. Realization of the compensator: A realization of the lag-lead compensator is shown in Figure 9.63. From Table 9.11 the lag portion has the following transfer function: Glag s¬Ü¬àR2 R1¬áR2s¬á1 R2C s¬á1 R1¬áR2¬ÜC¬àR2 R1¬áR2 s¬á0:031¬Ü s¬á0:01¬Ü 9.57¬Ü Selecting C¬à10ŒºF, we Ô¨ÅndR2¬à3:2MŒ©andR1¬à6:8MŒ©. From Table 9.11 the lead compensator portion has the following transfer function: Glead s¬Ü¬às¬á1 R1C s¬á1 R1C¬á1 R2C¬à s¬á2¬Ü s¬á4:63¬Ü 9.58¬Ü Selecting C¬à10ŒºF, we Ô¨ÅndR1¬à50 kŒ©andR2¬à38 kŒ© . The total loop gain required by the system is 2533. Hence, 6:63KR2 R1¬áR2¬à2533 9.59¬Ü where Kis the gain of the preampli Ô¨Åer, and R2= R1¬áR2¬Üis the gain of the lag portion. Using the values of R1andR2found during the realization of the lag portion, we Ô¨Ånd K¬à1194.Case Studies 501WEBC09 10/28/2014 18:2:11 TheÔ¨Ånal circuit is shown in Figure 9.65, where the preampli Ô¨Åer is implemented with an operational ampli Ô¨Åer whose feedback and input resistor ratio approximately equals 1194, the required preampli Ô¨Åer gain. The preampli Ô¨Åer isolates the lag and lead portions of the compensator. Summary of the design results: Using Eq. (9.56) along with K¬à382:1 yields the compensated value of Kv. Thus, Kv¬àlim s¬Æ0sGLLC s¬Ü¬à2533 2¬Ü 0:031¬Ü 0:01¬Ü 1:71¬Ü 4:63¬Ü 100¬Ü¬à19:84 9.60¬Ü which is an improvement over the gain-compensated system in the case study of Chapter 8, where Kv¬à2:49. This value is calculated from the uncompensated G(s) by letting K¬à64:21, as found in the Case Study of Chapter 8. Finally, checking the second-order approximation via simulation, we see in Figure 9.66 the actual transient response. Compare this to the gain-compensated systemresponse of Figure 8.29 to see the improvement effected by cascade compensation over simple gain adjustment. The gain-compensated system yielded 25%, with a settling time of about 4 seconds. The lag-lead-compensated system yields 28% overshoot, with a settlingtime of about 2 seconds. If the results are not adequate for the application, the systemshould be redesigned to reduce the percent overshoot. 24 681 00.20.40.60.81.01.2c(t) Time (seconds)00 FIGURE 9.66 Step response of lag-lead-compensated antenna control+ ‚Äì+ ‚Äìvo(t)vi(t)3.2 MŒ©6.8 MŒ©10 MŒ© 8.4 kŒ© 38 kŒ©50 kŒ© 10 F10 F‚Äì + Œº Œº FIGURE 9.65 Realization of lag-lead compensator502 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:12 CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. You are given the antenna azimuth position control system shown on the front endpapers, ConÔ¨Å guration 2. In the challenge in Chapter 8, you were asked to design, via gain adjustment, an 8-second settling time. a.For your solution to the challenge in Chapter 8, evaluate the percent overshoot and thevalue of the appropriate static error constant. b.Design a cascade compensator to reduce the percent overshoot by a factor of 4 and thesettling time by a factor of 2. Also, improve the appropriate static error constant by a factor of 2. c. Repeat Part busing MATLAB. UFSS Vehicle: Lead and Feedback CompensationUFSS Vehicle: Lead and Feedback Compensation As aÔ¨Ånal look at this case study, we redesign the pitch control loop for the UFSS vehicle. For the case study in Chapter 8, we saw that rate feedback improved the transient response. In this chapter ‚Äôs case study, we replace the rate feedback with a cascade compensator. PROBLEM: Given the pitch control loop without rate feedback K2¬à0¬Üfor the UFSS vehicle shown on the back endpapers, design a compensator to yield 20% overshoot anda settling time of 4 seconds ( Johnson ,1980 ). SOLUTION: First determine the location of the dominant closed-loop poles. Using the required 20% overshoot and a 4-second settling time, asecond-order approximation shows the dominant closed-loop poles are located at  1j1:951. From the uncompensated system analyzed in the Chapter 8 case study, the estimated settling time was 19.8 seconds for dominant closed-loop poles of  0:202j0:394. Hence, a lead compensator is required to speed up the system. Arbitrarily assume a lead compensator zero at  1. Using the root locus program in Appendix H.2 at www.wiley.com/college/nise ,w e Ô¨Ånd that this compensator zero, al ong with the open-loop poles and zeros of the system, yields an angular contribution at the design point,  1¬áj1:951, of  178 :92¬∞. The difference between this angle and 180 ¬∞,o r 1:08¬∞, is the angular contribution required from the compensator pole. Using the geometry shown in Figure 9.67, where  p cis the compensator pole location, we Ô¨Ånd that 1:951 pc 1¬àtan 1 :08¬∞ 9.61¬Ü from which pc¬à104:5. The compensated open-loop transfer function is thus G s¬Ü¬à0:25K1 s¬á0:435¬Ü s¬á1¬Ü s¬á1:23¬Ü s¬á2¬Ü s2¬á0:226s¬á0:0169 ¬Ü s¬á104:5¬Ü 9.62¬Ü where the compensator is Gc s¬Ü¬à s¬á1¬Ü s¬á104:5¬Ü 9.63¬Ü Using all poles and zeros shown in Eq. (9.62), the root locus program shows that a gain of 516.5 is required at the design point,  1j1:951. The root locus of the compensated system is shown in Figure 9.68.1.08¬∞117.13¬∞‚Äì1 j1.951+j ‚Äìpc = Closed-loop pole = Open-loop pole Note: This fi gure is not drawn to scale.s-plane= 0.456 0œâùúÅ œÉ FIGURE 9.67 Locating compensator poleCase Studies 503WEBC09 10/28/2014 18:2:12 Summary In this chapter, we learned how to design a system to meet transient and steady-state speciÔ¨Åcations. These design techniques overcame limitations in the design methodology covered in Chapter 8, whereby a transient response could be created only if the polesgenerating that response were on the root locus. Subsequent gain adjustment yielded theA test of the second-order approximation shows three more closed-loop poles at  0:5, 0:9, and  104 :5. Since the open-loop zeros are at  0:435 and  1, simulation is required to see if there is effectively closed-loop pole-zero cancellation with the closed-loop poles at  0:5 and  0:9, respectively. Further, the closed-loop pole at  104 :5 is more thanÔ¨Åve times the real part of the dominant closed-loop pole,  1j1:951, and its effect on the transient response is therefore negligible. The step response of the closed-loop system is shown in Figure 9.69, where we see a 26% overshoot and a settling time of about 4.5 seconds. Comparing this response with Figure 8.31, the response of the uncompensated system, we see considerable improvement in the settling time and steady-state error. However, the transient response performancedoes not meet the design requirements. Thus, a redesign of the system to reduce thepercent overshoot is suggested if required by the application. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. The heading control system for the UFSS vehicle is shown on the back endpapers. The minor loop contains the rudder and vehicle dynamics, and the majorloop relates output and input headings ( Johnson ,1980). a.Find the values of K 1andK2so that the minor-loop dominant poles have a damping ratio of 0.6 and the major-loop dominant poles have a damping ratio of 0.5. b.Repeat, using MATLAB.j Additional open-loop pole at ‚Äì104.5 ‚Äì3 ‚Äì2 ‚Äì1 1 0j3 j2 j1 ‚Äìj1 ‚Äìj2 ‚Äìj32s-plane œÉœâ FIGURE 9.68 Root locus for lead-compensated system00 24 680.20.40.60.81.01.2c(t) Time (seconds)10 FIGURE 9.69 Step response of lead-compensated UFSS vehicle504 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:12 desired response. Since this value of gain dict ated the amount of steady-state error in the response, a trade-off was required between the desired transient response and the desired steady-state error. Cascade orfeedback compensation is used to overcome the disadvantages of gain adjustment as a compensating technique. In this chapter, we saw that the transient responseand the steady-state error can be designed separately from each other. No longer was atrade-off between these two speci Ô¨Åcations required. Further, we were able to design for a transient response that was not represented on the original root locus. The transient response design technique covered in this chapter is based upon reshaping the root locus to go through a desired transient response point, followed by again adjustment. Typically, the resulting gain is much higher than the original if thecompensated system response is faster than the uncompensated response. The root locus is reshaped by adding additional poles and zeros via a cascade or feedback compensator. The additional poles and zeros must be checked to see that anysecond-order approximations used in the design are valid. All poles, besides the dominantsecond-order pair, must yield a response that is much faster than the designed response.Thus, nondominant poles must be at least Ô¨Åve times as far from the imaginary axis as the dominant pair. Further, any zeros of the system must be close to a nondominant pole forpole-zero cancellation, or far from the dominant pole pair. The resulting system can then beapproximated by two dominant poles. The steady-state response design technique is based upon placing a pole on or near the origin in order to increase or nearly increase the system type. Then a zero is placed near thispole so that the effect upon the transient response is negligible. However, Ô¨Ånal reduction of steady-state error occurs with a long-time constant. The same arguments about other polesyielding fast responses and about zeros being cancelled in order to validate a second-order approximation also hold true for this technique. If the second-order approximations cannot be justi Ô¨Åed, then a simulation is required to make sure the design is within tolerance. Steady-state design compensators are implemented via PI controllers orlag compensators . PI controllers add a pole at the origin, thereby increasing the system type. Lag compensators,usually implemented with passive networks, place the pole off the origin but near it. Bothmethods add a zero very close to the pole in order not to affect the transient response. The transient response design compensators are implemented through PD controllers orlead compensators . PD controllers add a zero to compensate the transient response; they are considered ideal . Lead compensators, on the other hand, are not ideal since they add a pole along with the zero. Lead compensators are usually passive networks. We can correct both transient response and steady-state error with a PIDorlag-lead compensator . Both of these are simply combinations of the previously described compensators. Table 9.7 summarized the types of cascade compensators. Feedback compensation can also be used to improve the transient response. Here the compensator is placed in the feedback path. The feedback gain is used to change thecompensator zero or the system ‚Äôs open-loop poles, giving the designer a wide choice of various root loci. The system gain is then varied to move along the selected root locus to thedesign point. An advantage of feedback compensation is the ability to design a fast responseinto a subsystem independently of the system ‚Äôs total response. In the next chapter, we look at another method of design, frequency response, which is an alternate method to the root locus. Review Questions 1.BrieÔ¨Çy distinguish between the design techniques in Chapter 8 and Chapter 9. 2.Name two major advantages of the design techniques of Chapter 9 over the designtechniques of Chapter 8.Review Questions 505WEBC09 10/28/2014 18:2:13 3.What kind of compensation improves the steady-state error? 4.What kind of compensation improves transient response? 5.What kind of compensation improves both steady-state error and transient response? 6.Cascade compensation to improve the steady-state error is based upon what pole-zero placement of the compensator? Also, state the reasons for this placement. 7.Cascade compensation to improve the transient response is based upon what pole-zeroplacement of the compensator? Also, state the reasons for this placement. 8.What difference on the s-plane is noted between using a PD controller or using a lead network to improve the transient response? 9.In order to speed up a system without changing the percent overshoot, where must thecompensated system ‚Äôsp o l e so nt h e s-plane be located in comparison to the uncompensated system ‚Äôsp o l e s ? 10.Why is there more improvement in steady-state error if a PI controller is used instead of alag network? 11.When compensating for steady-state error, what effect is sometimes noted in the transient response? 12.A lag compensator with the zero 25 times as far from the imaginary axis as the compensator pole will yield approximately how much improvement in steady-state error? 13.If the zero of a feedback compensator is at  3 and a closed-loop system pole is at  3:001, can you say there will be pole-zero cancellation? Why? 14.Name two advantages of feedback compensation. Problems 1.Design a PI controller to drive the step response error tozero for the unity feedback system shown in Figure P9.1,where G s¬Ü¬à K s¬á1 ¬Ü2s¬á10 ¬Ü The system operates with a damping ratio of 0.6.Compare the speciÔ¨Å cations of the uncompensated and compensated systems. [Section: 9.2] R(s) + C(s) E(s) G(s) ‚Äì FIGURE P9.1 2.Consider the unity feedback system shown inFigure P9.1, where G s¬Ü¬àK s s¬á3¬Ü s¬á6¬Ü a.Design a PI controller to drive the ramp response error to zero for any Kthat yields stability. [Section: 9.2]b.Use MATLAB to simulate your design for K¬à1. Show both the input ramp and the outputresponse on the same plot. 3.The unity feedback system shown in Figure P9.1 with G s¬Ü¬àK s¬á2¬Ü s¬á3¬Ü s¬á7¬Ü is operating with 10% overshoot. [Section: 9.2] a.What is the value of the appropriate static error constant? b.Find the transfer function of a lag network so that the appropriate static error constant equals 4 withoutappreciably changing the dominant poles of theuncompensated system. c. Use MATLAB or any other computerprogram to simulate the systemto see the effect of your compensator. 4.Repeat Problem 3 for G s¬Ü¬à K s s¬á3¬Ü s¬á7¬Ü. [Section: 9.2] 5.Consider the unity feedback system shown inFigure P9.1 with G s¬Ü¬àK s¬á3¬Ü s¬á5¬Ü s¬á7¬Ü506 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:13 a.Design a compensator that will yield Kp¬à20 without appreciably changing the dominant pole location that yields a 10% overshoot for theuncompensated system. [Section: 9.2] b. Use MATLAB or any other computerprogram to simulate theuncompensated and compensated systems. c. Use MATLAB or any other computerprogram to determine how much time it takes the slow response of the lag compensator to bring the out-put to within 2% of its Ô¨Ånal compensated value. 6.The unity feedback system shown in Figure P9.1 with G s¬Ü¬à K s¬á6¬Ü s¬á2¬Ü s¬á3¬Ü s¬á5¬Ü is operating with a dominant-pole damping ratio of0.707. Design a PD controller so that the settling timeis reduced by a factor of 2. Compare the transient andsteady-state performance of the uncompensated andcompensated systems. Describe any problems with your design. [Section: 9.3] Redo Problem 6 using MATLAB in the following way: a.MATLAB will generate the root locus forthe uncompensated system along withthe 0.707 damping ratio line. You willinteractively select the operating point. MATLAB will then inform you of the coordinates of the operatingpoint,the gain at the operating point,as well as the estimated %OS, T s,Tp,Œ∂, œân, and Kprepresented by a second- order approximation at the operatingpoint. b.MATLAB will display the step responseof the uncompensated system. c.Without further input,MATLAB will calculate the compensated design point and will then ask you to inputa value for the PD compensator zerofrom the keyboard. MATLAB willrespond with a plot of the root locusshowing the compensated designpoint. MATLAB will then allow you tokeep changing the PD compensator value from the keyboard until a root locus is plotted that goes throughthe design point.d.For the compensated system, MATLAB will inform you of the coordinates of the operating point,the gain atthe operating point,as well asthe estimated %OS, T s,T p,Œ∂,œân,and Kprepresented by a second-order approximation at the operating point. e.MATLAB will then display the stepresponse of the compensated system. 8.Design a PD controller for the system shown inFigure P9.2 to reduce the settling time by a factor of4 while continuing to operate the system with 20.5%overshoot.Comparetheperformanceofthecompensatedsystem to that of the uncompensated system. Summarizethe results in a table similar to that in Example 9.7. R(s) C(s) ‚Äì+ K s(s + 8)(s + 25) FIGURE P9.2 9.Consider the unity feedback system shown inFigure P9.1 with [Section: 9.3] G s¬Ü¬àK s¬á5¬Ü3 a.Find the location of the dominant poles to yield a1.2 second settling time and an overshoot of 15%. b.If a compensator with a zero at  1 is used to achieve the conditions of Part a, what must the angular contri- bution of the compensator pole be? c.Find the location of the compensator pole. d.Find the gain required to meet the requirements statedin Part a. e.Find the location of other closed-loop poles for thecompensated system. f.Discuss the validity of your second-orderapproximation. g. Use MATLAB or any other computerprogram to simulate thecompensated system to checkyour design. 10.The unity feedback system shown in Figure P9.1 with G s¬Ü¬à K s2 is to be designed for a settling time of 1.667 seconds anda 16.3% overshoot. If the compensator zero is placedat 1, do the following: [Section: 9.3] a.Find the coordinates of the dominant poles. b.Find the compensator pole. (problem continues )Problems 507WEBC09 10/28/2014 18:2:14 (Continued ) c.Find the system gain. d.Find the location of all nondominant poles. e.Estimate the accuracy of your second-order approximation. f.Evaluate the steady-state error characteristics. g.Use MATLAB or any other computerprogram to simulate the system and evaluate the actualtransient response characteristicsfor a step input. 11.Given the unity feedback system of Figure P9.1, with G s¬Ü¬à K s¬á6¬Ü s¬á3¬Ü s¬á4¬Ü s¬á7¬Ü s¬á9¬Ü do the following: [Section: 9.3] a.Sketch the root locus. b.Find the coordinates of the dominant poles for whichŒ∂¬à0:8. c.Find the gain for which Œ∂¬à0:8. d.If the system is to be cascade-compensated so thatT s¬à1 second and Œ∂¬à0:8,Ô¨Ånd the compensator pole if the compensator zero is at  4:5. e.Discuss the validity of your second-orderapproximation. f. Use MATLAB or any other computerprogram to simulate thecompensated and uncompensated systems and compare the results to those expected. Redo Problem 11 using MATLAB inthe following way: a.MATLAB will generate the root locus forthe uncompensated system along withthe 0.8 damping ratio line. You will interactively select the operating point. MATLAB will then inform you ofthe coordinates of the operatingpoint, the gain at the operating point,as well as the estimated %OS,T s, Tp,Œ∂,œân,and Kprepresented by a second- order approximation at the operatingpoint. b.MATLAB will display the step response of the uncompensated system. c.Without further input, MATLAB willcalculate the compensated design point and will then ask you to input a valuefor the lead compensator pole from thekeyboard. MATLAB will respond with aplot of the root locus showing the com- pensated design point. MATLAB will then allow you to keep changing thelead compensator pole value from thekeyboard until a root locus is plottedthat goes through the design point. d.For the compensated system, MATLABwill inform you of the coordinatesof the operating point,the gainat the operating point,as well as the estimated %OS, T s,T p,Œ∂,œân,and Kp represented by a second-order approx- imation at the operating point. e.MATLAB will then display the stepresponse of the compensated system. f.Change the compensator ‚Äôs zero location a few times and collect data on thecompensated system to see if any otherchoices of compensator zero yieldadvantages over the original design. 13.Consider the unity feedback system of Figure P9.1 with G s¬Ü¬à K s s¬á20¬Ü s¬á40¬Ü The system is operating at 20% overshoot. Design acompensator to decrease the settling time by a factor of2 without affecting the percent overshoot and do the following: [Section: 9.3] a.Evaluate the uncompensated system ‚Äôs dominant poles, gain, and settling time. b.Evaluate the compensated system‚Äô s dominant poles and settling time. c.Evaluate the compensator ‚Äôs pole and zero. Find the required gain. d. Use MATLAB or any other computer program to simulate thecompensated and uncompensatedsystems‚Äô step response. 14.The unity feedback system shown in Figure P9.1 with G s¬Ü¬à K s¬á15¬Ü s2¬á6s¬á13¬Ü is operating with 30% overshoot. [Section: 9.3] a.Find the transfer function of a cascade compensator,the system gain, and the dominant pole location thatwill cut the settling time in half if the compensatorzero is at  7. b.Find other poles and zeros and discuss your second-order approximation. c. Use MATLAB or any othercomputer program to simulate508 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:15 both the uncompensated and compensated systems to see the effect of your compensator. 15.For the unity feedback system of Figure P9.1 with G s¬Ü¬àK s s¬á1¬Ü s2¬á10s¬á26¬Ü do the following: [Section: 9.3] a.Find the settling time for the system if it is operatingwith 15% overshoot. b.Find the zero of a compensator and the gain, K,so that the settling time is 7 seconds. Assume that the pole ofthe compensator is located at  15. c. Use MATLAB or any other computerprogram to simulate thesystem‚Äô s step response to test the compensator. 16.A unity feedback control system has the following forward transfer function: [Section: 9.3] G s¬Ü¬à K s2 s¬á4¬Ü s¬á12¬Ü a.Design a lead compensator to yield a closed-loop step response with 20.5% overshoot and a settling time of3 seconds. Be sure to specify the value of K. b.Is your second-order approximation valid? c. Use MATLAB or any othercomputer program to simulate and compare the transient response of the compensated system tothe predicted transient response. 17.For the unity feedback system of Figure P9.1, with G s¬Ü¬à K s2¬á20s¬á101¬Ü s¬á20¬Ü the damping ratio for the dominant poles is to be 0.4, andthe settling time is to be 0.5 second. [Section: 9.3] a.Find the coordinates of the dominant poles. b.Find the location of the compensator zero if thecompensator pole is at  15. c.Find the required system gain. d.Compare the performance of the uncompensated andcompensated systems. e. Use MATLAB or any other computerprogram to simulate the system to check your design. Redesign if necessary. 18.Consider the unity feedback system of Figure P9.1, with G s¬Ü¬àK s¬á3¬Ü s¬á5¬Üa.Show that the system cannot operate with a settling time of 2/3 second and a percent overshoot of 1.5 % with a simple gain adjustment. b.Design a lead compensator so that the system meetsthe transient response characteristics of Part a. Specify the compensator ‚Äôs pole, zero, and the required gain. 19.Given the unity feedback system of Figure P9.1 with G s¬Ü¬àK s¬á2¬Ü s¬á4¬Ü s¬á6¬Ü s¬á8¬Ü Find the transfer function of a lag-lead compensatorthat will yield a settling time 0.5 second shorter thanthat of the uncompensated system. The compensatedsystem also will have a damping ratio of 0.5, andimprove the steady-state error by a factor of 30. Thecompensator zero is at  5. Also, Ô¨Ånd the compensated system ‚Äôs gain. Justify any second-order approximations or verify the design through simulation. [Section: 9.4] Redo Problem 19 using a lag-leadcompensator and MATLAB in thefollowing way: a.MATLAB will generate the root locusfor the uncompensated system alongwith the 0.5 damping-ratio line. You will interactively select the operat- ing point. MATLAB will then proceed toinform you of the coordinates of theoperating point,the gain at the oper-ating point, as well as the estimated%OS,T s,Tp,Œ∂,œân, and Kprepresented by a second-order approximation at theoperating point. b.MATLAB will display the step response of the uncompensated system. c.Without further input, MATLAB willcalculate the compensated design point and will then ask you to input a valuefor the lead compensator pole from thekeyboard. MATLAB will respond with aplot of the root locus showing the com-pensated design point. MATLAB willthen allow you to keep changing thelead compensator pole value from the keyboard until a root locus is plotted that goes through the design point. d.For the compensated system, MATLAB willinform you of the coordinates of theoperating point,the gain at the operat-ing point,as well as the estimated%OS,T s,Tp,Œ∂,œân, and Kprepresented by aProblems 509WEBC09 10/28/2014 18:2:15 second-order approximation at the operating point. e.MATLAB will then display the step response of the compensated system. f.Change the compensator ‚Äôs zero location a few times and collect data on thecompensated system to see if any otherchoices of the compensator zero yieldadvantages over the original design. g.Using the steady-state error of theuncompensated system, add a lag com-pensator to yield an improvement of 30 times over the uncompensated system ‚Äôs steady-state error, with minimal effect on the designed transientresponse. Have MATLAB plot the stepresponse. Try several values for thelag compensator ‚Äôs pole and see the effect on the step response. 21.Given the uncompensated unity feedback system ofFigure P9.1, with G s¬Ü¬à K s s¬á1¬Ü s¬á3¬Ü do the following: [Section: 9.4] a.Design a compensator to yield the following speci Ô¨Å- cations: settling time ¬à2:86 seconds; percent overshoot ¬à4:32%; the steady-state error is to be improved by a factor of 2 over the uncompensatedsystem. b.Compare the transient and steady-state error speciÔ¨Å ca- tions of the uncompensated and compensated systems. c.Compare the gains of the uncompensated andcompensated systems. d.Discuss the validity of your second-orderapproximation. e. Use MATLAB or any other computerprogram to simulate the uncompensated and compensated systems and verify the speciÔ¨Å cations. 22.For the unity feedback system given in Figure P9.1 with G s¬Ü¬àK s s¬á5¬Ü s¬á11¬Ü do the following: [Section: 9.4] a.Find the gain, K,for the uncompensated system to operate with 30% overshoot. b.Find the peak time and Kvfor the uncompensated system. c.Design a lag-lead compensator to decrease the peaktime by a factor of 2, decrease the percent overshootby a factor of 2, and improve the steady-state error by a factor of 30. Specify all poles, zeros, and gains. 23.The unity feedback system shown in Figure P9.1 with G s¬Ü¬àK s2¬á4s¬á8¬Ü s¬á10¬Ü is to be designed to meet the following speci Ô¨Åcations: Overshoot: Less than 22% Settling time: Less than 1.6 seconds Kp¬à15 Do the following: [Section: 9.4] a.Evaluate the performance of the uncompensated system operating at approximately 10% overshoot. b.Design a passive compensator to meet the desired speciÔ¨Åcations. c.Use MATLAB to simulate the compensated system. Comparethe response with the desiredspeci Ô¨Åcations. 24.Consider the unity feedback system in Figure P9.1, with G s¬Ü¬à K s¬á2¬Ü s¬á4¬Ü The system is operated with 4.32% overshoot. In order toimprove the steady-state error, K pis to be increased by at least a factor of 5. A lag compensator of the form Gc s¬Ü¬à s¬á0:5¬Ü s¬á0:1¬Ü is to be used. [Section: 9.4] a.Find the gain required for both the compensated andthe uncompensated systems. b.Find the value of K pfor both the compensated and the uncompensated systems. c.Estimate the percent overshoot and settling time for boththe compensated and the uncompensated systems. d.Discuss the validity of the second-order approxima-tion used for your results in Part c. e. Use MATLAB or any other computer program to simulate the step response for the uncompen-sated and compensated systems. Whatdo you notice about the compensatedsystem ‚Äôs response? f.Design a lead compensator that will correct theobjection you notice in Part e. 25.For the unity feedback system in Figure P9.1, with G s¬Ü¬à K s¬á1¬Ü s¬á3¬Ü design a PID controller that will yield a peak time of1.122 seconds and a damping ratio of 0.707, with zeroerror for a step input. [Section: 9.4]510 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:16 26.Repeat Problem 25 for a peak time of 1.047 seconds, a damping ratio of 0.5, zero steady-state error for a step input, and with Gs ¬Ü¬àK s¬á1 ¬Ü2 27.For the unity feedback system in Figure P9.1, with G s¬Ü¬àK s¬á4¬Ü s¬á6¬Ü s¬á10¬Ü do the following: a.Design a controller that will yield no more than25% overshoot and no more than a 2-secondsettling time for a step input and zero steady-stateerror for step and ramp inputs. b. Use MATLAB and verify yourdesign. Redo Problem 27 using MATLAB inthe following way: a.MATLAB will ask for the desired per-cent overshoot, settling time, and PIcompensator zero. b.MATLAB will design the PD controller ‚Äôs zero. c.MATLAB will display the root locus ofthe PID-compensated system with thedesired percent overshoot line. d.The user will interactively select theintersection of the root locus and thedesired percent overshoot line. e.MATLAB will display the gain and tran- sient response characteristics of the PID-compensated system. f.MATLAB will display the step responseof the PID-compensated system. g.MATLAB will display the ramp responseof the PID-compensated system. 29.If the system of Figure P9.3 operates with a dampingratio of 0.456 for the dominant second-order poles, Ô¨Ånd the location of all closed-loop poles and zeros. R(s) + ‚ÄìC(s) K (s2 + 2s + 0.36) (s + 3) (s + 2) FIGURE P9.3 30.For the unity feedback system in Figure P9.1, with G s¬Ü¬àK s s¬á2¬Ü s¬á4¬Ü s¬á6¬Ü do the following: [Section: 9.5]a.Design rate feedback to yield a step response with no more than 15% overshoot and no more than 3 seconds settling time. Use Approach 1. b.Use MATLAB and simulate yourcompensated system. 31.Given the system of Figure P9.4: [Section: 9.5] R(s) C(s) ‚Äì+ K1 s(s + 2)(s + 5)K s + a‚Äì+ FIGURE P9.4 a.Design the value of K1, as well as ain the feedback path of the minor loop, to yield a settling time of4 seconds with 5% overshoot for the step response. b.Design the value of Kto yield a major-loop response with 10% overshoot for a step input. c. Use MATLAB or any othercomputer program to simulatethe step response to the entireclosed-loop system. d. Add a PI compensator to reducethe major-loop steady-stateerror to zero and simulate thestep response using MATLAB or anyother computer program. 32.Design a PI controller to drive the step-response errorto zero for the unity feedback system shown inFigure P9.1, where Gs ¬Ü¬à K s¬á1 ¬Ü s¬á3 ¬Ü s¬á10 ¬Ü The system operates with a damping factor of0.4. Design for each of the following two cases:(1) compensator zero at  0.1, and (2) compensator zero at  0.7. Compare the speci Ô¨Åcations of the uncompensated and each one of the compensated systems. Simulateeach one of the systems using any software program. 33.An inverted pendulum mounted on a motor-drivencart was introduced in Problem 30 in Chapter 3.Its state-space model was linearized around a station- ary point, x 0=0(Prasad, 2012). At the stationary point, the pendulum point-mass, m, is in the upright position at t=0, and the force applied to the cart, u0,i s Its model was then modi Ô¨Åed in Problem 55 in Chapter 6 to have two output variables: the pendulum angle relative to the y-axis, Œ∏(t), and the horizontal position of the cart, x(t). MATLAB was then used toProblems 511WEBC09 10/28/2014 18:2:17 Ô¨Ånd its eigenvalues. Noting that only one pole (out of four) is located in the left half of the s-plane, we concluded that this unit requires stabilization. To accomplish stability and design an appropriate control system, do the following: a.Draw a signal-Ô¨Ç ow diagram for that unit and use it to develop Simulink models for two feedbacksystems: one to control the cartposition, x(t), and the other to con- trol the pendulum angle, Œ∏(t) . Set the upper and lower saturation limits ofthe second integrator in the angleloop to 100 and  100, respectively, and those limits in the position loopto 10 and  10. b.Use rate feedback with a gain of 12.5 tostabilize the pendulum angle controlsystem. The forward path of each of these systems should include a PD (proportional-plus-derivative) con-troller that adjusts the force appliedto the cart, u(t) . These controllers 3 may be con Ô¨Ågured with the following settings:4 P=5,I=0, and D=5 for the cart position controller P=2,I=0, and D=10 for the pendulum angle controller c.Utilizing scopes to capture the two output responses, use a unit-impulse5 as the reference input in the anglecontrol loop and a unit-step source(con Ô¨Ågured to start at t=0 with a Ô¨Ånal value of 1) as the input for the cartposition control loop. d.If either of the responses has a steady- state error, e( ‚àû)>2%, a peak time, TP>1.2 seconds, or a percent overshoot, %OS>20.5%, suggest appropriate changes to its controller settings. 34.Identify and realize the following controllers with operational ampli Ô¨Åers. [Section: 9.6] a.s¬á0:01 s b.s¬á235.Identify and realize the following compensators with passive networks. [Section: 9.6] a.s¬á0:1 s¬á0:01 b.s¬á2 s¬á5 c.s¬á0:1 s¬á0:01/C18/C19s¬á1 s¬á10/C18/C19 36.Repeat Problem 35 using operational ampli Ô¨Åers. [Section: 9.6] DESIGN PROBLEMSDESIGN PROBLEMS 37.The room temperature of an 11 m2room is to be con- trolled by varying the power of an indoor radiator. For this speci Ô¨Åc room, the open-loop transfer function from radiator power, _Q s¬Ü,t ot e m p e r a t u r e ,T (s), is (Thomas ,2005) G s¬Ü¬àT s¬Ü _Q s¬Ü¬à 110 6¬Üs2¬á 1:31410 9¬Üs¬á 2:6610 13¬Ü s3¬á0:00163 s2¬á 5:27210 7¬Üs¬á 3:53810 11¬Ü The system is assumed to be in the closed-loop conÔ¨Åguration shown in Figure P9.1. a.For a unit step input, calculate the steady-state error ofthe system. b.Try using the procedure of Section 9.2 to design aPI controller to obtain zero steady-state error forstep inputs without appreciably changing the tran-sient response. Then explain why it is not possibleto do so. c.Design a PI controller of the form G c s¬Ü¬àK s¬áz¬Ü s that will reduce the step-response error to zero whilenot changing signi Ô¨Åcantly the transient response. (Hint: Place the zero of the compensator in a positionwhere the closed-loop poles of the uncompensatedroot locus will not be affected signi Ô¨Åcantly.) d. Use Simulink to simulate the systems of Parts bandcand to verify the correctness of your design in Part c. 38.Figure P9.5 shows a two-tank system. The liquidinÔ¨Çow to the upper tank can be controlled using a valve and is represented by F The upper tank‚Äô s outÔ¨Çow equals the lower tank ‚Äôsi nÔ¨Çow and is repre- sented by F1.T h eo u t Ô¨Çow of the lower tank is F2.T h e objective of the design is to control the liquid level,y(t), in the lower tank. The open-loop transmission for this system isY s¬Ü Fo s¬Ü¬àa2a3 s2¬á a1¬áa4¬Üs¬áa1a4 (Romagnoli ,2006). The system will be controlled in a loop analogous to that of Figure P9.1, where the lower3These are PID controllers, in which the integral actions are set to zero to avoid any negative effect on stability. 4Note that a high value for the derivative action of the angle controller and a low value for its proportional gain have been selected to further stabilize the pendulum. 5To create a unit-impulse, use a unit-step source followed by a derivative block.512 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:17 liquid level will be measured and compared to a set point. The resulting error will be fed to a controller, which in turn will open or close the valve feeding the upper tank. F0 F1 F2 FIGURE P9.56 a.Assuming a1¬à0:04;a2¬à0:0187 ;a3¬à1;anda4¬à 0:227, design a lag compensator to obtain a step- response steady-state error of 10% without affectingthe system ‚Äôs transient response appreciably. b. Verify your design through MATLAB simulations.39.Figure P9.6( a) shows a heat-exchanger process whose purpose is to maintain the temperature of a liquid at a prescribed temperature. The temperature is measured using a sensor and a transmitter, TT 22, that sends the measurement to acorresponding controller, TC 22, that compares the actualtemperature with a desired temperature set point, SP. Thecontroller automatically opens or closes a valve to allowor prevent the Ô¨Çow of steam to change the temperature in the tank. The corresponding block diagram for this system is shown in Figure P9.6( b)(Smith ,2002 ). Assume the following transfer functions: G v s¬Ü¬à0:02 4s¬á1;G1 s¬Ü¬à70 50s¬á1;H s¬Ü¬à1 12s¬á1 a.Assuming Gc s¬Ü¬àK,Ô¨Ånd the value of Kthat will result in a dominant pole with Œ∂¬à0:7. Obtain the corresponding Ts. b.Design a PD controller to obtain the same damping factor as Part abut with a settling time 20% smaller. c.Verify your results through MATLAB simulation. 40.Repeat Problem 39, Parts bandc, using a lead compensator. SP TT(t) Ti(t)Steam Process fluid Condensate returnTC 22 TT 22 (a) + ‚ÄìGc(s) Gv(s) Gp(s) H(s)Compensator Valve SensorHeat exchanger TSP(s) T(s) (b) FIGURE P9.6 a.Heat-exchanger process;7b.block diagram 6Romagnoli, J.A., and Palazoglu. A. Introduction to Process Control. CRC Press, Boca Raton, 2006. P. 44, Figure 3.4.7Smith, C.A. Automated Continuous Process Control. John Wiley & Sons, New York, NY, 2002. p. 128, Figure 6-1.1.Problems 513WEBC09 10/28/2014 18:2:17 a. Find the transfer function of a motor whose torque- speed curve and load are given in Figure P9.7. b.Design a tachometer compensator to yield a damping ratio of 0.5 for a position control employing a powerampli Ô¨Åer of gain 1 and a preampli Ô¨Åer of gain 5000. c.Compare the transient and steady-state characteristicsof the uncompensated system and the compensatedsystem. RPMTorque 0.5 N-m 5V 60,000 00 2 Motor 44 10 5 kg-m2 1 N-m-s/rad1œÄ FIGURE P9.7 42.You are given the motor whose transfer function isshown in Figure P9.8( a). R(s) + ‚Äì+ ‚Äì KfsTachometerC(s) E(s) K125 s(s + 2)Motor Amplifier25 s(s + 2)Ea(s)o(s) (a) (b)Œ∏ FIGURE P9.8a.If this motor were the forward transfer function of a unity feedback system, calculate the percent over- shoot and settling time that could be expected. b.You want to improve the closed-loop response. Sincethe motor constants cannot be changed and youcannot use a different motor, an ampli Ô¨Åer and tachometer are inserted into the loop as shown inFigure P9.8( b). Find the values of K 1andKfto yield a percent overshoot of 15% and a settling time of0.5 second. c.Evaluate the steady-state error speci Ô¨Åcations for both the uncompensated and the compensatedsystems. 43.A position control is to be designed with a 20% overshootand a settling time of 2 seconds. You have on hand anampli Ô¨Åer and a power ampli Ô¨Åer whose cascaded transfer function is K 1= s¬á20¬Üwith which to drive the motor. Two 10-turn pots are available to convert shaft positioninto voltage. A voltage of 5œÄvolts is placed across the pots. A dc motor whose transfer function is of the form Œ∏o s¬Ü Ea s¬Ü¬àK s s¬áa¬Ü is also available. The transfer function of the motor isfound experimentally as follows: The motor and gearedload are driven open-loop by applying a large, short, rectangular pulse to the armature. An oscillogram of the response shows that the motor reached 63% of its Ô¨Ånal output value at 1/2 second after the application of thepulse. Further, with a constant 10 volts dc applied to thearmature, the constant output speed was 100 rad/s. a.Draw a complete block diagram of the system,specifying the transfer function of each componentwhen the system is operating with 20% overshoot. b.W h a tw i l lt h es t e a d y - s t a t ee r r o rb ef o rau n i tr a m pi n p u t ? c.Determine the transient response characteristics. d.If tachometer feedback is used around the motor, asshown in Figure P9.9, Ô¨Ånd the tachometer and the ampli Ô¨Åer gain to meet the original speci Ô¨Åcations. Summarize the transient and st eady-state characteristics. R(s) + ‚Äì+ ‚Äì KfTachometerC(s)K1Amplifier Pot MotorPower amp Pots FIGURE P9.9514 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:18 44.Apositioncontrolistobedesignedwitha10%overshoot, a settling time of 1 second, and Kv¬à1000. You have on hand an ampli Ô¨Åer and a power ampli Ô¨Åer whose cascaded transfer function is K1= s¬á40¬Üwith which to drive the motor. Two 10-turn pots are available to convert shaft position into voltage. A voltage of 20œÄvolts is placed across the pots. A dc motor whose transfer function is ofthe form Œ∏o s¬Ü Ea s¬Ü¬àK s s¬áa¬Ü isalso available. The following data are observed froma dynamometer test at 50 V. At 25 N-m of torque, themotor turns at 1433 rpm. At 75 N-m of torque,the motor turns at 478 rpm. The speed measured atthe load is 0.1 that of the motor. The equivalent inertia,including the load, at the motor armature is 100 kg-m 2, and the equivalent viscous damping, including the load, at the motor armature is 50 N-m-s/rad. a.Draw a complete block diagram of the system, specifying the transfer function of each component. b.Design a passive compensator to meet therequirements in the problem statement. c.Draw the schematic of the compensator showing allcomponent values. Use an operational ampli Ô¨Åer for isolation where necessary. d. Use MATLAB or any other computerprogram to simulate your systemand show that all requirementshave been met. 45.Given the system shown in Figure P9.10, Ô¨Ånd the values of KandK fso that the closed-loop dominant poles will have a damping ratio of 0.5 and the under-damped poles of the minor loop will have a dampingratio of 0.8. R(s) + ‚ÄìK+ ‚Äì Kf sTachometerC(s) E(s) 1 (s + 1)2(s + 5)AmplifierPower amplifier and plant FIGURE P9.10 46.Given the system in Figure P9.11, Ô¨Ånd the values of K and Kfso that the closed-loop system will have a 4.32% overshoot and the minor loop will have adamping ratio of 0.8. Compare the expectedperformance of the system without tachometer com- pensation to the expected performance with tachometer compensation. R(s) + ‚ÄìK+ ‚Äì Kf sTachometerC(s) E(s) 1 (s + 1)(s + 5)(s + 10)AmplifierPower amplifier and plant FIGURE P9.11 47.Steam-driven power generators rotate at a constantspeed via a governor that maintains constant steampressure in the turbine. In addition, automatic genera- tion control (AGC) or load frequency control (LFC) is a d d e dt oe n s u r er e l i a b i l i ty and consistency despite load variations or other disturbances that can affectthe distribution line frequency output. A speciÔ¨Å c turbine-governor system can be described only usingthe block diagram of Figure P9.1 in which G s¬Ü¬à G c s¬ÜGg s¬ÜGt s¬ÜGm s¬Ü,w h e r e( Khodabakhshian, 2005) Gg s¬Ü¬à1 0:2s¬á1is the governor ‚Äôs transfer function Gt s¬Ü¬à1 0:5s¬á1is the turbine transfer function Gm s¬Ü¬à1 10s¬á0:8represents the machine and loadtransfer functions G c(s) is the LFC compensation to be designed a.Assuming Gc s¬Ü¬àK,Ô¨Ånd the value of Kthat will result in a dominant pole with Œ∂¬à0:7. Obtain the corresponding Ts. b.Design a PID controller to obtain the same damp-ing factor as in Part a, but with a settling time of 2 seconds and zero steady-state error to step inputcommands. c. Verify your results using aMATLAB simuation. 48.Repeat Problem 47 using a lag-lead compensator insteadof a PID controller. Design for a steady-state error of 1%for a step input command. 49.Digital versatile disc (DVD) players incorporate several control systems for their operations. The control tasks include (1) keeping the laser beam focused on the discsurface, (2) fast track selection, (3) disc rotation speedcontrol, and (4) following a track accurately. In orderto follow a track, the pickup-head radial position iscontrolled via a voltage that operates a voice coilembedded in a magnet con Ô¨Åguration. For a speci Ô¨ÅcProblems 515WEBC09 10/28/2014 18:2:18 DVD player, the transfer function is given by P s¬Ü¬àX s¬Ü V s¬Ü ¬à0:63 1¬á0:36 305:4s¬ás2 305:42/C18/C19 1¬á0:04 248:2s¬ás2 248:22/C18/C19 where x t¬Ü¬àradial pickup position and v t¬Ü¬àthe coil input voltage ( Bittanti ,2002 ). a.Assume that the system will be controlled in a closed-loop conÔ¨Å guration, such as the one shown in Figure P9.1. Assuming that the plant, P(s), is cascaded with a proportional compensator,G c s¬Ü¬àK, plot the root locus of the system. b.Repeat Part ausing MATLAB if your root locus plot wascreated by any other tool. c.Find the range of Kfor closed-loop stability, the resulting damping factor range, and the smallestsettling time. d.Design a notch Ô¨Ålter compensator so that the system ‚Äôs dominant poles have a damping factor of Œ∂¬à0:7w i t h a closed-loop settling time of 0.1 second. e. Simulate the system ‚Äôs step response for Part cusing MATLAB. f.Add a PI compensator to the system to achieve zerosteady-state error for a step input without appreciably affecting the transient response achieved in Part b. g. Simulate the system ‚Äôs step response for Part eusing MATLAB. 50.A coordinate measuring machine (CMM) measures coordinates on three-dimensional objects. The accuracyof CMMs is affected by temperature changes as well as by mechanical resonances due to joint elasticity. Theseresonances are more pronounced when the machinehas to go over abrupt changes of dimension, such as sharp corners at high speed. Each of the machine linkscan be controlled in a closed-loop con Ô¨Åguration, such as the one shown in Figure P9.12, designed for aspeci Ô¨Åc machine with prismatic (sliding) links. In the Ô¨Ågure, X ref(s) is the commanded position and X(s)i st h e actual position. The minor loop uses a tachometer generatorto obtain the joint speed, while the main loop controls the joint‚Äôs position ( √ñzel,2003). a.Find the value of Kthat will result in a minor loop with Œ∂¬à0:5. b.Use a notch Ô¨Ålter compensator, G c(s), for the external loop so that it results in a closed-loop damping factor ofŒ∂¬à0:7 with Ts‚âà4 seconds. c.Use MATLAB to simulate thecompensated system ‚Äôs closed- loop step response. 51.An X-4 quadrotor Ô¨Çyer is designed as a small-sized unmanned autonomous vehicle (UAV) that Ô¨Çies mainly indoorsandcanhelpinsearchandrecognizancemissions.To minimize mechanical problems and for simplicity,thisaircraftuses Ô¨Åxedpitchrotorswithspeciallydesigned blades. Therefore, for thrust it is necessary to add a Ô¨Åfth propeller. A simpli Ô¨Åed design of the thrust control design can be modeled as in Figure P9.1 with G s¬Ü¬àG c s¬ÜP s¬Ü where P s¬Ü¬à1:90978s 0:43¬á1/C16/C17 s 9:6¬á1/C16/C17s 0:54¬á1/C16/C17 represents the dynamics of the thruster rotor gain, the motor, and the battery dynamics. Initially, the system is designed using a proportional compensator given byG c s¬Ü¬à3(Pounds ,2009 ). a.Calculate the resulting steady-state error for a unitstep input. + ‚Äì+ ‚Äì Tachometer generatorCompensator s(s2 + 14.24 s + 3447.91) 0.0466 s(s2 + 1.15 s + 0.33)Plant Xref (s) Gc(s) K574.98X(s) FIGURE P9.12516 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:19 b.Design a lag compensator t o yield half the steady- state error of the proportional compensator, with- out appreciably affecting the system ‚Äôst r a n s i e n t response. c.Use MATLAB to simulate theoriginal design and the lagcompensated design. Verify yourresults. 52.Problem 8.54 described an ac/dc conversion andpower distribution system for which droop control isimplemented through the use of a proportionalcontroller to stabilize the dc-bus voltage. For simpli Ô¨Å- cation, a system with only one source converter and oneload converter was considered. The parameters anddesign considerations presented in that problem,along with some solution results, allow us to represent the block-diagram of that system as shown in the Figure P9.13. H (s)Ev(s) GC(s)+ _Vdc‚Äìref (s) VS‚Äìlp(s)(s3 +1225s2 + 5030000s + 62500000)125(s2 + 1225s + 2530000) 200 s + 200Is‚Äìref(s)GP (s) Vs (s) FIGURE P9.13 Here Gc(s) is the transfer function of the controller, Gp(s) represents the forward path of the controlled plant (a conversion and power distribution unit), and H(s) is the transfer function of the feedback low-pass Ô¨Ålter (Karlsson ,2003 ). Prepare a table, such as Table 9.5, where the Ô¨Årst column, headed Uncompensated ,i sÔ¨Ålled in with your results from the proportional design of Problem 8.54, assuming an input step, vdc ref t¬Ü¬à750u t¬Ü. Follow Steps 2 ‚Äì8 as described in Section 9.4 (Example 9.5), to design a proportional-plus-integral- plus-derivative (PID) controller so that the system canoperate with a percent overshoot 4.4 %, a peak time 20% smaller than that of the uncompensated system,and zero steady-state error, e Vstep ‚àû¬Ü¬à0. Fill in the remaining two columns of your table, PD-compensated andPID-compensated . 53.Testing of hypersonic Ô¨Çight is performed in wind tunnels where maintaining a constant air pressure is important.Air pressure control is accomplished in several stages.For a speci Ô¨Åc setup, a simpli Ô¨Åed transfer function has been found to be ( Varghese ,2009 ) Ps ¬Ü Ms ¬Ü¬à 2:369106s2¬á7:897107s¬á4:21105 0:015s5¬á0:7802 s4¬á9:89s3¬á18:46s2¬á3:377s ¬á0:01937where M(s) is the stem movement of a valve feeding compressed air into the storage tank, and P(s) is the settling chamber pressure. In order to achieve steady-state error, design a PI controller that operates with a damping factorof 0.4. Compare the characteristics of the un-compensated and compensated systems, and use acomputer program to simulate the step response to thecompensated system. 54.Ametering pump is a pump capable of delivering a precise Ô¨Çow rate of Ô¨Çuid. Most metering pumps consist of an electric motor that varies the strike length of ashaft, allowing more or less Ô¨Çu i dt op a s st h r o u g hi t s body. The control of such a valve has been considered and the open-loop transfer function of the pump was f o u n dt ob e( Yu,2011) Us ¬Ü Ys ¬Ü¬à1:869 s2¬á12:32s¬á0:4582 where the output of the system, Y(s), represents the liquid Ô¨Çow, and the input, U(s), is the command signal to the motor that varies the pump ‚Äôs plunger strike length. a.Design a PID controller to reduce the steady-stateerror to zero with a maximum 5% overshoot and a20% reduction in uncompensated settling time. b.Find the characteristics of the uncompensated system. c.Design a PID controller to reduce the steady-state error to zero; achieve a maximum 5% overshoot and a 20% reduction in uncompensated settling time. d.Simulate the step response for the compensatedsystem to verify the validity of your design. 55.A linear model of the Œ±-subsystem of a grid-connected converter ( Mahmood ,2012 ) with a Y-Y transformer was presented as the plant in Problem 69 in Chapter 8. You were asked to Ô¨Ånd the transfer function of that plant, G Ps ¬Ü¬àVŒ±s ¬Ü MŒ±s ¬Ü(see Figure P8.20( b)). a.Use the results of your solution to Problem 69, Chapter 8, to write the open-loop transfer functionin pole-zero form with a unity gain. Then design a PIDcontroller to yield a zero steady-state error for a stepinput with an overshoot of less than 10% and a naturalfrequency of 135.3. b.Plot the time response, c(t), marking on it all relevant characteristics, such as the percent overshoot (if any),rise time, settling time, and Ô¨Ånal steady-state value. Also Ô¨Ånd all closed-loop poles of this system and the velocity error constant, K v. Do you have any observa- tions about the time response and/or the poles?Problems 517WEBC09 10/28/2014 18:2:19 56.Design a PID controller for the drive system of Problem 56, Chapter 8, and shown in Figure P8.15 (Thomsen ,2011 ). Obtain an output response, œâL(t), with an overshoot 15%, a settling time of preferably 0.2 second, but not more than 5 seconds, a zerosteady-state position error, and a velocity error of<2%, for a step input, œâ r(t)=260u(t) rad/sec, applied att=0. PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 57.Control of HIV/AIDS. It was shown in Chapter 6, Problem 68, that when the virus levels in an HIV/ AIDS patient are controlled using RTIs the linearizedplant model is P s¬Ü¬àY s¬Ü U1 s¬Ü¬à 520 s 10:3844 s3¬á2:6817 s2¬á0:11s¬á0:0126 Assume that the system is embedded in a con Ô¨Åguration, such as the one shown in Figure P9.1, whereG s¬Ü¬àG c s¬ÜP s¬Ü. Here, Gc(s) is a cascade compen- sator. For simplicity in this problem, choose the dcgain of G c(s) less than zero to obtain a negative- feedback system (the negative signs of Gc(s) and P(s) cancel out) ( Craig ,I. K.,2004 ). a.Consider the uncompensated system withG c s¬Ü¬à  K.F i n dt h ev a l u eo f Kthat will place all closed-loop poles on the real axis. b.Use MATLAB to simulate theunit-step response of thegain-compensated system. Note the %OS and the T sfrom the simulation. c.Design a PI compensator so that the steady-state errorfor step inputs is zero. Choose a gain value to make allpoles real. d. Use MATLAB to simulate the design in Part c for a unit step input. Compare the simulation to Part b. 58.Hybrid vehicle. In the previous chapter, we used the root locus to design a proportional controller for thespeed control of an HEV. We rearranged the blockdiagram to be a unity feedback system, as shown in the block diagram of Figure P7.31 ( Preitl ,2007 ). The plant and compensator resulted in G s¬Ü¬à K s¬á0:60¬Ü s¬á0:5858 ¬Ü s¬á0:0163 ¬Ü and we found that K=0.78 resulted in a critically damped system.a.Use this design to itemize the performancespeciÔ¨Åcations by Ô¨Ålling in a table, similar to Table 9.5, under the column Uncompensated . Take advantage of the results from Chapter 8 or use MATLAB to Ô¨Ånd the entries. Plot c(t) for r(t)=4u(t) volts. b. Now assume that the system speci Ô¨Åcations require zero steady-state error for step inputs,asteady-state error for ramp inputs2%,a %OS 4.32%,and a settling time 4 sec. It should be evident that thisis not accomplished with a propor-tional controller. Thus, start by designing a PI controller to meet therequirements. If necessary, add a PDmode to get a PID controller. Simulateyour Ô¨Ånal design using MATLAB. Fill in the results of this design in the second column of your table with the heading Compensated. c.Now note the following limitations of linear controlsystem modeling: 1.No limit is set on system variables. For example,vehicle acceleration as well as motor and powerampli Ô¨Åer current, torque or power do not have upper limits. 2.It is assumed that to improve the speed of responsein Part b, we could place the PI controller ‚Äôs zero on top of the pole closest to the origin. Realistically,such pole-zero cancellation is not always possibleto maintain. If you do not expand yourmodel beyond the describedlimitations if required for accu-racy, unrealistic response char-acteristics, such as rise and settling times could result. Look at your design results includingresponse curves. Are they realis-tic? If not,revise your Simulinkmodel,which you developed forProblem 5.79, according to thefollowing 4 steps: i.Represent the motor armature asaÔ¨Årst-order system with a unity steady-state gain and a timeconstant of 50 ms,which avoidsthe creation of internal alge-braic closed-loops and shouldhave negligible effect on system response;518 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:20 ii.Add a saturation element at the output of the motor armature and set it to an upper limit of 250 A; iii.Use the following PI settings. ThePI settings of the speed controllerare P =61 and I =0.795. The PI set- tings of the torque controller areP=10 and I =6; iv.Run the modi Ô¨Åed model and comment on the graphs obtained for motor cur-rent, car acceleration, and speed. 59.Parabolic trough collector. The parabolic trough collector ( Camacho ,2012 ) is a Type 0 system as can be seen from its transfer function, Gs ¬Ü¬à 137:210 6K s2¬á0:0224 s¬á19610 6e 39sWe want the system operating in the critically damped mode, but with reduced steady-state error. Using the root locus and a Pad√© approximation, e sT1 T 2s 1¬áT 2s, do the following: a.Substitute the Pad√© approximation for the delay and Ô¨Ånd the gain necessary to have the system operating with a damping factor, Œ∂¬à0:5. Also, Ô¨Ånd the corresponding steady-state error. b.Design a PI compensator to obtain a zero steady-stateerror while maintaining Œ∂¬à0:5. c. Simulate the resulting designusing MATLAB to verify yourdesign. Cyber Exploration Laboratory Experiment 9.1 Objectives To perform a trade-off study for lead compensation. To design a PI controller and see its effect upon steady-state error. Minimum Required Software Packages MATLAB, and the Control System Toolbox Prelab 1.How many lead compensator designs will meet the transient response speci Ô¨Åcations of a system? 2.What differences do the lead compensators of Prelab 1 make? 3.Design a lead compensator for a unity negative feedback system with a forward transfer function of G s¬Ü¬àK s s¬á3¬Ü s¬á6¬Üto meet the following speci Ô¨Åcations: percent overshoot ¬à20%; settling time ¬à2 seconds. Specify the required gain, K. Estimate the validity of the second-order approximation. 4.What is the total angular contribution of the lead compensator of Prelab 3? 5.Determine the pole and zero of two more lead compensators that will meet the requirements of Prelab 3. 6.What is the expected steady-state error for a step input for each of the lead-compensatedsystems? 7.What is the expected steady-state error for a ramp input for each of the lead-compensatedsystems? 8.Select one of the lead compensator designs and specify a PI controller that can becascaded with the lead compensator that will produce a system with zero steady-stateerror for both step and ramp inputs.Cyber Exploration Laboratory 519WEBC09 10/28/2014 18:2:20 Lab 1.Using the SISO Design Tool, create the design in Prelab 3 and plot the root locus, step response, and ramp response. Take data to determine the percent overshoot, settlingtime, and step and ramp steady-state errors. Record the gain, K. 2.Repeat Lab 1 for each of the designs in Prelab 5. 3.For the design selected in Prelab 8, use the SISO Design Tool and insert the PIcontroller. Plot the step response and measure the percen t overshoot, settling time, and steady-state error. Also, plot the ramp response for the design and measure thesteady-state error. 4.Plot the step and ramp responses for two more values of the PI controller zero. Postlab 1.Make a table showing calculated and actual values for percent overshoot, settlingtime, gain, K, steady-state error for step inputs, and steady-state error for ramp inputs. Use the three systems without the PI controller and the single system with the PIcontroller from Lab 3. 2.Itemize the bene Ô¨Åts of each system without the PI controller. 3.Choose a Ô¨Ånal design and discuss the reasons for your choice. Experiment 9.2 Objective To design a PID controller via LabVIEW Minimum Required Software Packages LabVIEW with the Control Design and Simulation Module Prelab 1.Perform Cyber Exploration Laboratory Experiment 8.3. 2.Use the system described in Cyber Exploration Laboratory Experiment 8.3 and replace the controller described there, Gc s¬Ü¬àKDs¬áKP, with a PID controller. 3.Design the controller to meet the following requirements: (1) shorten the settling timefound in the design of Cyber Exploration Laboratory Experiment 8.3 to less than 1 sec.,and (2) limit the percent overshoot to no more than 5%. 4.Design a LabVIEW VI to test your design. The front panel inputs will be the PID gainsand the numerator and denominator of the plant. The indicators will be the transferfunctions of the plant, PID controller, and closed-loop system. Finally, provide anindicator for the step-response graph. Lab Run your LabVIEW VI and obtain the step response of the closed-loop system. Postlab Compare the transient and steady-state error performance between the closed-loop step responses of Cyber Exploration Laboratory Experiment 8.3 and thisexperiment. Hardware Interface Laboratory Experiment 9.3 Speed Control Using PI Control Objectives To control the speed of the motor in closed loop using integral control and to investigate the tradeoffs of this approach520 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:20 Material Required Computer with LabView installed; myDAQ; dc brushed gearmotor with Hall Sensor quadrature encoder (  10V to +10V normal operation range); and motor control chip BA6886N (or a transistor circuit substitute) Files Provided at www.wiley.com/college/nise Speed PI Control.vi Signal Conditioning (SubVI).vi PI Controller (SubVI).vi Prelab Answer the following questions: + ‚ÄìR(s)KI sK C(s) st + 1 FIGURE P9.14 For the system shown in Figure P9.14, do the following: 1.Find the closed-loop transfer function from R(s)t oC(s). 2.Draw the root locus as a function of KI. 3.Draw the unit-step response marking the settling time, peak time, and maximum output. Find all the possibilities: overdamped, critically damped, and underdamped. 4.Find an expression for the steady-state error for a unit-step input. Lab Software: Use the Speed PI Control.vi and change the constant on the left to Ô¨Åty o u r motor‚Äô s gear ratio and encoder CPR as shown in Figure P9.15( b). Also change the constants wired to the PI controller. These values should be the maximum motor voltage- dead-zone constant. Change the dead-zone constants inside the signal conditioning block just as you did in Experiment 8.4. FIGURE P9.15 Speed PI Control.vi: a.Front Panel; (Ô¨Ågure continues )Hardware Interface Laboratory 521WEBC09 10/28/2014 18:2:21 Hardware: Same as Experiment 8.4 Procedure: 1.Make the P gain =0, and choose a small I gain. Verify the operation of your closed-loop system. In this experiment we will keep the P gain at 0. 2.Draw a functional block diagram (simila rt ot h a tp r e s e n t e di nC h a p t e r1 )o ft h e system. Do not include the signal conditioning functions, nor the change-of- direction signals. 3.Using the transfer function you found in Experiment 4.6, draw the system‚Äô s root locus. 4.Find the theoretical range of KIin which the system is closed-loop stable. 5.Run your program and system to Ô¨Ånd experimentally the range of KIin which the system is closed-loop stable. 6.Make a judicious choice of three different values of KIfor experimentation. 7.Using the transfer function you found in Experiment 8.4 and the three judicious choicesof proportional gain, complete the following table using hand calculations only(calculators OK, computer simulations are not acceptable). Show all your work. KI TP‚ÄîPeak time %OS‚ÄîPercent overshoot Ts‚ÄîSettling time ess‚ÄîSteady-state error (step input) Theoretical 8.For each one of the three values of KI, perform step-input experiments. Use a single value of step input for the three values of KI. Make sure that your oscilloscope captures contain the system ‚Äôs transient response in its entirety. Show measurements of all the parameters in the Theoretical table above and Ô¨Åll in the following Experimental table. Please note that Ts, the settling time, is hard to measure in the current setting because of FIGURE P9.15 (Continued )b.Block Diagram522 Chapter 9 Design via Root LocusWEBC09 10/28/2014 18:2:21 Bibliography Bittanti, S., Dell‚Äô Orto, F., Di Carlo, A., and Savaresi, S. M. Notch Filtering and Multirate Control for Radial Tracking in High Speed DVD-Players. IEEE Transactions on Consumer Electronics , vol. 48, 2002, pp. 56 ‚Äì62. Budak, A. Passive and Active Network Analysis and Synthesis . Houghton Mif Ô¨Çin, Boston, MA, 1974. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. Craig, J. J. Introduction to Robotics. Mechanics and Control , 3d ed. Prentice Hall, Upper Saddle River, NJ, 2005. D'Azzo, J. J., and Houpis, C. H. Feedback Control System Analysis and Synthesis , 2d ed. McGraw-Hill, New York, 1966. Dorf, R. C. Modern Control Systems , 5th ed. Addison-Wesley, Reading, MA, 1989. Hostetter, G. H., Savant, C. J., Jr., and Stefani, R. T. Design of Feedback Control Systems , 2d ed. Saunders College Publishing, New York, 1989. Johnson, H. et al. Unmanned Free-Swimming Submersible (UFSS )System Description . NRL Memorandum Report 4393. Naval Research Laboratory, Washington, D.C., 1980. Karlsson, P., and Svensson, J. DC Bus Voltage Control for a Distributed Power System, IEEE Trans. on Power Electronics , vol. 18, no. 6, 2003, pp. 1405 ‚Äì1412. Khodabakhshian, A., and Golbon, N. Design of a New Load Frequency PID Controller Using QFT. Proceedings of the 13th Mediterranean Conference on Control and Automation, 2005, pp. 970 ‚Äì975. Kuo, B. C. Automatic Control Systems , 7th ed. Prentice Hall, Upper Saddle River, NJ, 1995. Mahmood, H., and Jiang, J. Modeling and Control System Design of a Grid Connected VSC Considering the Effect of the Interface Transformer Type. IEEE Transactions on Smart Grid , vol. 3, no. 1, March 2012, pp. 122 ‚Äì134. Ogata, K. Modern Control Engineering , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1990. √ñzel, T. Precision Tracking Control of a Horizontal Arm Coordinate Measuring Machine. Proceedings of the IEEE Conference on Control Applications,2 0 0 3 ,p p .1 0 3 ‚Äì108. Pounds, P. E. I., Mahony, R. E., and Corke, P. I. Design of a Static Thruster for Microair Vehicle Rotorcraft. Journal of Aerospace Engineering , vol. 22, no. 1, 2009, pp. 85 ‚Äì94.the limited number of analog channels available. Instead of measuring Ts,m a r ko n your oscilloscope the theoretical value using the scope cursors. ( Important: In this experiment stop the VI before restarting it every time you apply a step input. This action will reset the integrator). KI Tp‚ÄîPeak time %OS‚ÄîPercent overshoot ess‚ÄîSteady-state error (step input) Experimental Postlab Make a detailed comparison of your theoretical and experimental tables. Discuss similarities and discrepancies betw een experimental and theoretical and give possible reasons.Bibliography 523WEBC09 10/28/2014 18:2:21 Prasad, L., Tyagi, B., and Gupta, H. Modeling & Simulation for Optimal Control of Nonlinear Inverted Pendulum Dynamical System using PID Controller & LQR. IEEE Computer Society Sixth Asia Modeling Symposium, 2012, pp. 138 ‚Äì143. Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Intelligence and Informatics . IEEE. 2007, pp. 157 ‚Äì162. Romagnoli, J. A., and Palazoglu, A. Introduction to Process Control . CRC Press, Boca Raton, FL, Smith, C. A. Automated Continuous Process Control. Wiley, New York, 2002. Thomas, B., Soleimani-Mosheni, M., and Fahl√©n, P. Feed-forward in Temperature Control of Buildings. Energy and Buildings , vol. 37, 2005, pp. 755 ‚Äì761. Thomsen, S., Hoffmann, N., and Fuchs, F. W. PI Control, PI-Based State Space Control, and Model-Based Predictive Control for Drive Systems With Elastically Coupled Loads ‚ÄîA Comparative Study. IEEE Transactions On Industrial Electronics , vol. 58, no. 8, August 2011, pp. 3647 ‚Äì3657. Van de Vegte, J. Feedback Control Systems , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1990. Varghese, J., and Binu, L. S. Adaptive Fuzzy PI Controller for Hypersonic Wind Tunnel Pressure Regulation. 10th National Conference on Technological Trends (NCTT09) ,N o v .6 ‚Äì7, 2009, pp. 184‚Äì 187. Yu, S., Wu, J., and Zhang, D. Robust Non-fragile PID Controller Design for the Stroke Regulation of Metering Pumps. Chinese Journal of Chemical Engineering , vol. 19, no. 1, 2011, pp. 83 ‚Äì88.524 Chapter 9 Design via Root LocusWEBC10 10/28/2014 18:15:50 Frequency Response Techniques Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅDeÔ¨Åne and plot the frequency response of a system (Section 10.1) ¬ÅPlot asymptotic approximations to the frequency response of a system (Section 10.2) ¬ÅSketch a Nyquist diagram (Section 10.3 ‚Äì10.4) ¬ÅUse the Nyquist criterion to determine the stability of a system (Section 10.5) ¬ÅFind stability and gain and phase margins using Nyquist diagrams and Bodeplots (Sections 10.6 ‚Äì10.7) ¬ÅFind the bandwidth, peak magnitude, and peak frequency of a closed-loop frequency response given the closed-loop time response parameters of peak time, settling time, and percent overshoot (Section 10.8) ¬ÅFind the closed-loop frequency response given the open-loop frequencyresponse (Section 10.9) ¬ÅFind the closed-loop time response parameters of peak time, settlingtime, and percent overshoot given the open-loop frequency response(Section 10.10)10 525WEBC10 10/28/2014 18:15:50 Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with a case study as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers and using frequency response methods, you will be able to Ô¨Ånd the range of gain, K, for stability. You will also be able to Ô¨Ånd percent overshoot, settling time, pea k time, and rise time, given K. 10.1 Introduction The root locus method for transient design, steady-state design, and stability was covered inChapters 8 and 9. In Chapter 8, we covered the simple case of design through gainadjustment, where a trade-off was made between a desired transient response and a desiredsteady-state error. In Chapter 9, the need for this trade-off was eliminated by usingcompensation networks so that transient and steady-state errors could be separately speciÔ¨Åed and designed. Further, a desired transient response no longer had to be on the original system ‚Äôs root locus. This chapter and Chapter 11 present the design of feedback control systems through gain adjustment and compensation networks from another perspective ‚Äîthat of frequency response. The results of frequency response compensation techniques are not new or different from the results of root locus techniques. Frequency response methods, developed by Nyquist and Bode in the 1930s, are older than the root locus method, which was discovered by Evans in 1948 ( Nyquist , 1932; Bode, 1945). The older method, which is covered in this chapter, is not as intuitive as the root locus. However, frequency response yields a new vantage point from which toview feedback control systems. This technique has distinct advantages in the followingsituations: 1.When modeling transfer functions from physical data, as shown in Figure 10.1 2.When designing lead compensators to meet a steady-state error requirement and a transient response requirement 3.When Ô¨Ånding the stability of nonlinear systems 4.In settling ambiguities when sketching a root locus FIGURE 10.1 National Instruments PXI, Compact RIO, Compact DAQ, and USB hardware plantforms (shown from left to right) coupled withNI LabVIEW software to provide stimulus and acquire signals from physical systems.NI LabVIEW can then be used to analyze data, determine the mathematical model, andprototype and deploy acontroller for the physical system526 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:15:51 WeÔ¨Årst discuss the concept of frequency response, de Ô¨Åne frequency response, derive analytical expressions for the frequency response, plot the frequency response, develop ways of sketching the frequency response, and then apply the concept to control systemanalysis and design. The Concept of Frequency Response In the steady state, sinusoidal inputs to a linear system generate sinusoidal responses of thesame frequency. Even though these responses are of the same frequency as the input, they differin amplitude and phase angle from the input. These differences are functions of frequency. Before de Ô¨Åning frequency response, let us look at a convenient representation of sinusoids. Sinusoids can be represented as complex numbers called phasors .T h e magnitude of the complex number is the amplitude of the sinusoid, and the angle ofthe complex number is the phase angle of the sinusoid. Thus, M 1cos œât¬áœï1¬Ücan be represented as M1¬Äœï1where the frequency, œâ, is implicit. Since a system causes both the amplitude and phase angle of the input to be changed, we can think of the system itself as represented by a complex number, deÔ¨Å ned so that the product of the input phasor an d the system function yields the phasor representation of the output. Consider the mechanical system of Figure 10.2( a). If the input force, f(t), is sinusoidal, the steady-state output response, x(t), of the system is also sinusoidal and at the same frequency as the input. In Figure 10.2( b) the input and output sinusoids are represented by complex numbers, or phasors, Mi œâ¬Ü¬Ä œïi œâ¬ÜandMo œâ¬Ü¬Äœïo œâ¬Ü, respectively. Here, the M‚Äôs are the amplitudes of the sinusoids and the œï‚Äôs are the phase angles of the sinusoids as shown in Figure 10.2( c). Assume that the system is represented by the complex number, M œâ¬Ü¬Ä œï œâ¬Ü. The output steady-state sinusoid is found by multiplying the complex number representation of the input by the complex number representation of the system. Thus, thesteady-state output sinusoid is M o œâ¬Ü¬Äœïo œâ¬Ü¬àMi œâ¬ÜM œâ¬Ü¬Ä¬âœïi œâ¬Ü¬á œï œâ¬Ü¬ä (10.1) f(t) = Mi cos(œât +œïi) o(œâ) (œâ) Mass Viscous damperSpring (a) Inputtx(t) (c)Mi(œâ) i(œâ) M(œâ)Mo(œâ) Mo = M i Mf(t) io = i +Mi t Output(b)x (t) = Mo cos(œâ + œïo) œï œï œï œïœï œï FIGURE 10.2 Sinusoidal frequency response: a.system; b.transfer function; c.input and output waveforms10.1 Introduction 527WEBC10 10/28/2014 18:15:52 From Eq. (10.1) we see that the system function is given by M œâ¬Ü¬àMo œâ¬Ü Mi œâ¬Ü(10.2) and œï œâ¬Ü¬à œïo œâ¬Ü  œïi œâ¬Ü (10.3) Equations (10.2) and (10.3) form our de Ô¨Ånition of frequency response. We call M œâ¬Üthe magnitude frequency response andœï œâ¬Üthephase frequency response . The combination of the magnitude and phase frequency responses is called the frequency response and isM œâ¬Ü¬Äœï œâ¬Ü. In other words, we de Ô¨Åne the magnitude frequency response to be the ratio of the output sinusoid ‚Äôs magnitude to the input sinusoid ‚Äôs magnitude. We de Ô¨Åne the phase response to be the difference in phase angle between the output and the input sinusoids. Both responses are a function of frequency and apply only to the steady-state sinusoidal responseof the system. Analytical Expressions for Frequency Response N o wt h a tw eh a v ed e Ô¨Åned frequency response, let us obtain the analytical expression for it (Nilsson ,1990). Later in the chapter, we will us e this analytical expression to determine stability, transient response, and steady-state error. Figure 10.3 shows a system, G(s), with the Laplace transform of a general sinusoid, r t¬Ü¬àAcosœât ¬áBsinœât¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Ô¨É A2¬áB2p cos¬âœât tan 1 B=A¬Ü¬äas the input. We can represent the input as a phasor in three ways: (1) in polar form, Mi¬Äœïi,w h e r eM i¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉA2¬áB2p andœïi¬à tan 1 B=A¬Ü; (2) in rectangular form, A jB;a n d( 3 )u s i n gE u l e r ‚Äôsf o r m u l a , Miejœïi. We now solve for the forced response portion of C(s), from which we evaluate the frequency response. From Figure 10.3, C s¬Ü¬àAs¬áBœâ s2¬áœâ2¬ÜG s¬Ü (10.4) We separate the forced solution from the transient solution by performing a partial-fraction expansion on Eq. (10.4). Thus, C s¬Ü¬àAs¬áBœâ s¬ájœâ¬Ü s jœâ¬ÜG s¬Ü ¬àK1 s¬ájœâ¬áK2 s jœâ¬áPartial fraction terms from G s¬Ü(10.5) where K1¬àAs¬áBœâ s jœâG s¬Ü/C12/C12/C12 s¬Æ jœâ¬à1 2 A¬ájB¬ÜG  jœâ¬Ü¬à12M ie jœïiMGe jœïG ¬àMiMG 2e j œïi¬áœïG¬Ü(10.6a) K2¬àAs¬áBœâ s¬ájœâG s¬Ü/C12/C12/C12 s¬Æ¬ájœâ¬à1 2 A jB¬ÜG jœâ¬Ü¬à12M iejœïiMGejœïG ¬àMiMG 2ej œïi¬áœïG¬Ü¬àK* 1(10.6b) For Eqs. (10.6), K* 1is the complex conjugate of K1, MG¬àjG jœâ¬Üj (10.7)As + Bœâ s2 + œâ2 G(s) C(s) R(s) = FIGURE 10.3 System with sinusoidal input528 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:15:52 and œïG¬àangle of G jœâ¬Ü (10.8) The steady-state response is that portion of the partial-fraction expansion that comes from the input waveform ‚Äôs poles, or just the Ô¨Årst two terms of Eq. (10.5). Hence, the sinusoidal steady-state output, Css(s), is Css s¬Ü¬àK1 s¬ájœâ¬áK2 s jœâ(10.9) Substituting Eqs. (10.6) into Eq. (10.9), we obtain Css s¬Ü¬àMiMG 2e j œïi¬áœïG¬Ü s¬ájœâ¬áMiMG 2ej œïi¬áœïG¬Ü s jœâ(10.10) Taking the inverse Laplace transformation, we obtain c t¬Ü¬àMiMGe j œât¬áœïi¬áœïG¬Ü¬áej œât¬áœïi¬áœïG¬Ü 2/C18/C19 ¬àMiMGcos œât¬áœïi¬áœïG¬Ü(10.11) which can be represented in phasor form as Mo¬Äœïo¬à M1¬Äœï1¬Ü MG¬ÄœïG¬Ü, where MG¬ÄœïG is the frequency response function. But from Eqs. (10.7) and (10.8), MG¬ÄœïG¬àG jœâ¬Ü.I n other words, the frequency response of a system whose transfer function is G(s)i s G jœâ¬Ü¬à G s¬Üjs¬Æjœâ (10.12) Plotting Frequency Response G jœâ¬Ü¬à MG œâ¬Ü<œïG œâ¬Ücan be plotted in several ways; two of them are (1) as a function of frequency, with separate magnitude and phase plots; and (2) as a polar plot, where the phasor length is the magnitude and the phasor angle is the phase. When plotting separate magnitude and phase plots, the magnitude curve can be plotted in decibels (dB) vs. log œâ, where dB ¬à20 log M.1The phase curve is plotted as phase angle vs. log œâ. The motivation for these plots is shown in Section 10.2. Using the concepts covered in Section 8.1, data for the plots also can be obtained using vectors on the s-plane drawn from the poles and zeros of G(s) to the imaginary axis. Here the magnitude response at a particular frequency is the product of the vector lengthsfrom the zeros of G(s) divided by the product of the vector lengths from the poles of G(s), drawn to points on the imaginary axis. The phase response is the sum of the angles from thezeros of G(s) minus the sum of the angles from the poles of G(s) drawn to points on the imaginary axis. Performing this operation for successive points along the imaginary axisyields the data for the frequency response. Remember, each point is equivalent tosubstituting that point, s¬àjœâ 1, into G(s) and evaluating its value. The plots also can be made from a computer program that calculates the frequency response. For example, the root locus program discussed in Appendix H at www.wiley.com/ college/nise can be used with test points that are on the imaginary axis. The calculated K value at each frequency is the reciprocal of the scaled magnitude response, and thecalculated angle is, directly, the phase angle response at that frequency. The following example demonstrates how to obtain an analytical expression for frequency response and make a plot of the result. 1Throughout this book, ‚Äúlog‚Äùis used to mean log 10, or logarithm to the base 10.10.1 Introduction 529WEBC10 10/28/2014 18:15:54 Example 10.1 Frequency Response from the Transfer FunctionFrequency Response from the Transfer Function PROBLEM: Find the analytical expression for the magnitude frequency response and the phase frequency response for a system G s¬Ü¬à1= s¬á2¬Ü. Also, plot both the separate magnitude and phase diagrams and the polar plot. SOLUTION: First substitute s¬àjœâin the system function and obtain G jœâ¬Ü¬à 1= jœâ¬á2¬Ü¬à 2 jœâ¬Ü= œâ2¬á4¬Ü. The magnitude of this complex number, jG jœâ¬Üj¬àM œâ¬Ü¬à1=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Ô¨É œâ2¬á4¬Üp , is the magnitude frequency response. The phase angle ofG jœâ¬Ü;œï œâ¬Ü¬à  tan 1 œâ=2¬Ü, is the phase frequency response. G jœâ¬Ücan be plotted in two ways: (1) in separate magnitude and phase plots and (2) in a polar plot. Figure 10.4 shows separate magnitude and phase diagrams, where the magnitude diagram is 20 log M œâ¬Ü¬à20 log 1=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É œâ2¬á4p ¬Üvs. log œâ, and the phase diagram is œï œâ¬Ü¬à  tan 1 œâ=2¬Üvs. log œâ. The polar plot, shown in Figure 10.5, is a plot ofM œâ¬Ü<œï œâ¬Ü¬à1=Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É œâ2¬á4p < tan 1 œâ=2¬Üfor different œâ. 0 ‚Äì0.05 ‚Äì0.10 ‚Äì0.15 ‚Äì0.20 ‚Äì0.25‚àûr/s0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45ReG 10 r/s 9 r/s 8 r/s 7 r/s 6 r/s 5 r/s 4 r/s 3 r/s 2 r/s1 r/s0.9 r/s0.8 r/s0.7 r/s0.6 r/s0.5 r/s0.4 r/s0.3 r/s0.2 r/s0.1 r/s0 r/sGIm Note: r/s = rad/s 0.5œâ= œâ= FIGURE 10.5 Frequency response plot for G s¬Ü¬à1= s¬á2¬Ü: polar plot‚Äì6Phase (degrees)0 ‚Äì90‚Äì12 ‚Äì18 ‚Äì24 ‚Äì30 ‚Äì36 ‚Äì1011 0 Frequency (rad/s)0.1 100 ‚Äì20 ‚Äì30 ‚Äì40 ‚Äì50 ‚Äì60 ‚Äì70 ‚Äì80‚Äì4220 log M 11 0 Frequency (rad/s)0.1 100FIGURE 10.4 Frequency response plots for G s¬Ü¬à1= s¬á2¬Ü: separate magnitude and phase diagrams530 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:15:54 In the previous example, we plotted the separate magnitude and phase responses, as well as the polar plot, using the mathematical expression for the frequency response. Either of these frequency response presentations can also be obtained from the other. You shouldpractice this conversion by looking at Figure 10.4 and obtaining Figure 10.5 usingsuccessive points. For example, at a frequency of 1 rad/s in Figure 10.4, the magnitudeis approximately  7 dB, or 10  7=20¬à0:447. The phase plot at 1 rad/s tells us that the phase is about  26 ¬∞. Thus on the polar plot, a point of radius 0.447 at an angle of  26 ¬∞is plotted and identi Ô¨Åed as 1 rad/s. Continuing in like manner for other frequencies in Figure 10.4, you can obtain Figure 10.5. Similarly, Figure 10.4 can be obtained from Figure 10.5 by selecting a sequence of points in Figure 10.5 and translating them to separate magnitude and phase values. Forexample, drawing a vector from the origin to the point at 2 rad/s in Figure 10.5, we see thatthe magnitude is 20 log 0 :35¬à 9:12 dB and the phase angle is about  45 ¬∞. The magnitude and phase angle are then plotted at 2 rad/s in Figure 10.4 on the separate magnitude andphase curves. In this section, we de Ô¨Åned frequency response and saw how to obtain an analytical expression for the frequency response of a system simply by substituting s¬àjœâinto G(s). We also saw how to make a plot of G jœâ¬Ü. The next section shows how to approximate the magnitude and phase plots in order to sketch them rapidly. 10.2 Asymptotic Approximations: Bode Plots The log-magnitude and phase frequency response curves as functions of log œâare called Bode plots or Bode diagrams. Sketching Bode plots can be simpli Ô¨Åed because they can be approximated as a sequence of straight lines. Straight-line approximations simplify the evaluation of the magnitude and phase frequency response.Skill-Assessment Exercise 10.1 PROBLEM: a.Find analytical expressions for the magnitude and phase responses of G s¬Ü¬à1 s¬á2¬Ü s¬á4¬Ü b.Make plots of the log-magnitude and the phase, using log-frequency in rad/s as the ordinate. c.Make a polar plot of the frequency response. ANSWERS: a.M œâ¬Ü¬à1Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Ô¨É 8 œâ2¬Ü2¬á 6œâ¬Ü2q ; for œâÔ¨ÉÔ¨ÉÔ¨É 8p :œï œâ¬Ü¬à  arctan6œâ 8 œâ2/C18/C19 , for œâ>Ô¨ÉÔ¨ÉÔ¨É 8p :œï œâ¬Ü¬à  œÄ¬áarctan6œâ 8 œâ2/C18/C19 /C20/C21 b.See the answer at www.wiley.com/college/nise . c.See the answer at www.wiley.com/college/nise . The complete solution is at www.wiley.com/college/nise .10.2 Asymptotic Approximations: Bode Plots 531WEBC10 10/28/2014 18:15:55 Consider the following transfer function: G s¬Ü¬àK s¬áz1¬Ü s¬áz2¬Ü‚àô‚àô‚àô s¬ázk¬Ü sm s¬áp1¬Ü s¬áp2¬Ü‚àô‚àô‚àô s¬ápn¬Ü(10.13) The magnitude frequency response is the product of the magnitude frequency responses of each term, or jG jœâ¬Üj¬àKj s¬áz1¬Üjj s¬áz2¬Üj‚àô‚àô‚àôj s¬ázk¬Üj jsmjj s¬áp1¬Üjj s¬áp2¬Üj‚àô‚àô‚àôj s¬ápn¬Üj/C12/C12/C12/C12 s¬Æjœâ(10.14) Thus, if we know the magnitude response of each pole and zero term, we can Ô¨Ånd the total magnitude response. The process can be simpli Ô¨Åed by working with the logarithm of the magnitude, since the zero terms ‚Äômagnitude responses would be added and the pole terms ‚Äômagnitude responses subtracted, rather than, respectively, multiplied or divided, to yield the logarithm of the total magnitude response. Converting the magnitude response into dB, we obtain 20 log jG jœâ¬Üj¬à20 log K¬á20 log j s¬áz1¬Üj¬á20 log j s¬áz2¬Üj ¬á‚àô‚àô‚àô 20 log jsmj 20 log j s¬áp1¬Üj ‚àô‚àô‚àôjs¬Æjœâ(10.15) Thus, if we knew the response of each term, the algebraic sum would yield the totalresponse in dB. Further, if we could make an approximation of each term that would consistonly of straight lines, graphical addition of terms would be greatly simpli Ô¨Åed. Before proceeding, let us look at the phase response. From Eq. (10.13), the phase frequency response is the sum of the phase frequency response curves of the zero terms minus the sumof the phase frequency response curves of the pole terms. Again, since the phase response is the sum of individual terms, straight-line approximations to theseindividual responses simplify graphical addition. Let us now show how to approximate the frequency response of simple pole and zero terms by straight-line approximations. Later we show how to combine these responses tosketch the frequency response of more complicated functions. In subsequent sections, after a discussion of the Nyquist stability criterion, we learn how to use the Bode plots for the analysis and design of stability and transient response. Bode Plots for G(s)=(s+a) Consider a function, G s¬Ü¬à s¬áa¬Ü, for which we want to sketch separate logarithmic magnitude and phase response plots. Letting s¬àjœâ, we have G jœâ¬Ü¬à jœâ¬áa¬Ü¬àajœâ a¬á1/C16/C17 (10.16) At low frequencies when œâapproaches zero, G jœâ¬Ü‚âàa (10.17) The magnitude response in dB is 20 log M¬à20 log a (10.18) where M¬àjG jœâ¬Üjand is a constant. Eq. (10.18) is shown plotted in Figure 10.6( a) from œâ¬à0:01atoa. At high frequencies where œâ a, Eq. (10.16) becomes G jœâ¬Ü‚âàajœâ a/C18/C19 ¬àaœâ a/C16/C17 ¬Ä90¬∞¬àœâ¬Ä90¬∞ (10.19)532 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:15:56 The magnitude response in dB is 20 log M¬à20 log a¬á20 logœâ a¬à20 log œâ (10.20) where a<œâ<‚àû. Notice from the middle term that the high-frequency approximation is equal to the low-frequency approximation when œâ¬àa, and increases for œâ>a. If we plot dB, 20 log M, against log œâ, Eq. (10.20) becomes a straight line: y¬à20x (10.21) where y¬à20 log M;andx¬àlogœâ. The line has a slope of 20 when plotted as dB vs. log œâ. Since each doubling of frequency causes 20 log œâto increase by 6 dB, the line rises at an equivalent slope of 6 dB/octave, where an octave is a doubling of frequency. This rise begins at œâ¬àa, where the low-frequency approximation equals the high-frequency approximation. We call the straight-line approximations asymptotes . The low-frequency approximation is called the low-frequency asymptote , and the high-frequency approximation is called the high-frequency asymptote . The frequency, a, is called the break frequency because it is the break between the low- and the high-frequency asymptotes. Many times it is convenient to draw the line over a decade rather than an octave, where adecade is 10 times the initial frequency. Over one decade, 20 log œâincreases by 20 dB. Thus, a slope of 6 dB/octave is equivalent to a slope of 20 dB/decade. The plot is shown in Figure 10.6( a) from œâ¬à0:01ato 100 a. Let us now turn to the phase response, which can be drawn as follows. At the break frequency, a, Eq. (10.16) shows the phase to be 45¬∞ . At low frequencies, Eq. (10.17) shows that the phase is 0 ¬∞. At high frequencies, Eq. (10.19) shows that the phase is 90 ¬∞.T o draw the curve, start one decade 1=10¬Übelow the break frequency, 0.1 a, with 0 ¬∞phase,aa a a a a a 0.01 0.1 10 100a Frequency (rad/s) Frequency (rad/s)90 75 60 45 30 15Phase (degrees) 0(a) (b)Slope = 6 dB/octave Slope = 45¬∞/decade30 + 20 log 24 + 20 log 18 + 20 log 12 + 20 log 6 + 20 log 20 log a aa a 0.01a 0.1 10 100a aaaa 36 + 20 log42 + 20 log20 log M = 20 dB/decade FIGURE 10.6 Bode plots of s¬áa¬Ü:a.magnitude plot; b.phase plot10.2 Asymptotic Approximations: Bode Plots 533WEBC10 10/28/2014 18:15:58 and draw a line of slope ¬á45¬∞/decade passing through 45¬∞ at the break frequency and continuing to 90 ¬∞one decade above the break frequency, 10 a. The resulting phase diagram is shown in Figure 10.6( b). It is often convenient to normalize the magnitude and scale the frequency so that the log-magnitude plot will be 0 dB at a break frequency of unity. Normalizing and scaling helps in the following applications: 1.When comparing different Ô¨Årst- or second-order frequency response plots, each plot will have the same low-frequency asymptote after normalization and the same break frequency after scaling. 2.When sketching the frequency response of a function such as Eq. (10.13), each factor in the numerator and denominator will have the same low-frequency asymptote afternormalization. This common low-frequency asymptote makes it easier to add compo-nents to obtain the Bode plot. To normalize s¬áa¬Ü,w ef a c t o ro u tt h eq u a n t i t ya and form a¬â s=a¬Ü¬á1¬ä.T h ef r e q u e n c yi s scaled by de Ô¨Åning a new frequency variable, s 1¬às=a. Then the magnitude is divided by the quantity ato yield 0 dB at the break frequency. Hence, the normalized and scaled function is s1¬á1¬Ü. To obtain the original frequency response, the magnitude and frequency are multiplied by the quantity a. We now use the concepts of normalization and scaling to compare the asymptotic approximation to the actual magnitude and phase plot for s¬áa¬Ü. Table 10.1 shows the TABLE 10.1 Asymptotic and actual normalized and scaled frequency response data for s¬áa¬Ü Frequency a20 logM a dB¬ÜPhase (degrees) (rad/s) Asymptotic Actual Asymptotic Actual 0.01 0 0.00 0.00 0.57 0.02 0 0.00 0.00 1.15 0.04 0 0.01 0.00 2.29 0.06 0 0.02 0.00 3.43 0.08 0 0.03 0.00 4.57 0.1 0 0.04 0.00 5.71 0.2 0 0.17 13.55 11.31 0.4 0 0.64 27.09 21.80 0.6 0 1.34 35.02 30.96 0.8 0 2.15 40.64 38.66 1 0 3.01 45.00 45.00 2 6 6.99 58.55 63.43 4 12 12.30 72.09 75.96 6 15.56 15.68 80.02 80.54 8 18 18.13 85.64 82.87 10 20 20.04 90.00 84.29 20 26.02 26.03 90.00 87.14 40 32.04 32.04 90.00 88.57 60 35.56 35.56 90.00 89.05 80 38.06 38.06 90.00 89.28 100 40 40.00 90.00 89.43534 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:15:59 comparison for the normalized and scaled frequency response of s¬áa¬Ü. Notice that the actual magnitude curve is never greater than 3.01 dB from the asymptotes. This maximum difference occurs at the break frequency. The maximum difference for the phase curve is5.71 ¬∞, which occurs at the decades above and below the break frequency. For convenience, the data in Table 10.1 is plotted in Figures 10.7 and 10.8. We now Ô¨Ånd the Bode plots for other common transfer functions. Actual90 80 70 60 50 40 30 20 10 0 0.01 0.1 1 FrequencyPhase (degrees) (rad/s)a10 100Asymptotic approximation FIGURE 10.8 Asymptotic and actual normalized and scaled phase response of s¬áa¬ÜActual Asymptotic approximation20 18 16 14 12 10 8 6 4 2 00.1 10 120 log(M/a) Frequency(rad/s)a FIGURE 10.7 Asymptotic and actual normalized and scaled magnitude response of s¬áa¬Ü10.2 Asymptotic Approximations: Bode Plots 535WEBC10 10/28/2014 18:15:59 Bode Plots for G(s)=1/(s+a) Let us Ô¨Ånd the Bode plots for the transfer function G s¬Ü¬à1 s¬áa¬Ü¬à1 as a¬á1/C18/C19 (10.22) This function has a low-frequency asymptote of 20 log 1=a¬Ü, which is found by letting the frequency, s, approach zero. The Bode plot is constant until the break frequency, arad/s, is reached. The plot is then approximated by the high-frequency asymptote found by letting s approach ‚àû. Thus, at high frequencies G jœâ¬Ü¬à1 as a/C18/C19/C12/C12/C12/C12 s¬Æjœâ¬à1 ajœâ a/C18/C19 ¬à1 a œâ a¬Ä 90¬∞¬à1 œâ¬Ä 90¬∞ (10.23) or, in dB, 20 log M¬à20 log1 a 20 logœâ a¬à 20 log œâ (10.24) Notice from the middle term that the high-frequency approximation equals the low- frequency approximation when œâ¬àa, and decreases for œâ>a. This result is similar to Eq. (10.20), except the slope is negative rather than positive. The Bode log-magnitudediagram will decrease at a rate of 20 dB/decade rather than increase at a rate of 20 dB/decadeafter the break frequency. The phase plot is the negative of the previous example, since the function is the inverse. The phase begins at 0 ¬∞and reaches  90¬∞at high frequencies, going through  45¬∞at the break frequency. Both the Bode normalized and scaled log-magnitude and phase plotare shown in Figure 10.9( d). Bode Plots for G(s)=s Our next function, G s¬Ü¬às, has only a high-frequency asymptote. Letting s¬àjœâ,t h e magnitude is 20 log œâ, which is the same as Eq. (10.20). Hence, the Bode magnitude plot is a straight line drawn with a ¬á20 dB =decade slope passing through zero dB when œâ¬à1. The phase plot, which is a constant ¬á90 ¬∞, is shown with the magnitude plot in Figure 10.9( a). FIGURE 10.9 Normalized and scaled Bode plots for a.G s¬Ü¬às; b.G s¬Ü¬à1=s; (Ô¨Ågure continues )02040 ‚Äì20 ‚Äì4020 log M 0.01 0.1 1 10 100+6 dB/octave = +20 dB/decade‚Äì6 dB/octave = ‚Äì20 dB/decadePhase (degrees)Frequency (rad/s) 0.01 0.1 1 10 100 Frequency (rad/s)04590 ‚Äì45 ‚Äì9002040 ‚Äì20 ‚Äì4020 log M 0.01 0.1 1 10 100Phase (degrees)Frequency (rad/s) 0.01 0.1 1 10 100 Frequency (rad/s)04590 ‚Äì45 ‚Äì90 (a) (b)G (s) = s G (s) =1sG (s) =1s G (s) = s536 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:1 Bode Plots for G(s)=1/s The frequency response of the inverse of the preceding function, G s¬Ü¬à1=s, is shown in Figure 10.9(b ) and is a straight line with a  20 dB =decade slope passing through zero dB at œâ¬à1. The Bode phase plot is equal to a constant  90 ¬∞. We have covered four functions that have Ô¨Årst-order polynomials in sin the numerator or denominator. Before proceeding to second-order polynomials, let us look at an example of drawing the Bode plots for a function that consists of the product of Ô¨Årst-order polynomials in the numerator and denominator. The plots will be made by adding together the individual frequency response curves.02040 ‚Äì20 ‚Äì4020 log(M/a) 0.01 0.1 1 10 100+6 dB/octave = +20 dB/decadePhase (degrees) 0.01 0.1 1 10 10004590 ‚Äì45 ‚Äì9002040 ‚Äì20‚Äì40 0.01 0.1 1 10 100Phase (degrees) 0.01 0.1 1 10 10004590 ‚Äì45 ‚Äì90‚Äì6 dB/octave = ‚Äì20 dB/decade +45¬∞/decade ‚Äì45¬∞/decade (c) (d)20 logMa aFrequency(rad/s)aFrequency(rad/s) aFrequency(rad/s)aFrequency(rad/s)G (s) = (s + a) G (s) = (s + a )G (s) =1 (s+a)G (s) =1 (s+a) FIGURE 10.9 (Continued ) c.G s¬Ü¬à s¬áa¬Ü; d.G s¬Ü¬à1= s¬áa¬Ü Example 10.2 Bode Plots for Ratio of First-Order FactorsBode Plots for Ratio of First-Order Factors PROBLEM: Draw the Bode plots for the system shown in Figure 10.10, where G s¬Ü¬àK s¬á3¬Ü=¬âs s¬á1¬Ü s¬á2¬Ü¬ä. SOLUTION: We will make a Bode plot for the open-loop function G s¬Ü¬àK s¬á3¬Ü=¬âs s¬á1¬Ü s¬á2¬Ü¬ä. The Bode plot is the sum of the Bode plots for each Ô¨Årst-order term. Thus, it is convenient to use the normalized plot for each of these terms so that the low-frequency asymptote of each term, except the pole at the origin, is at 0 dB, making it easier to add the components of the Bode plot. We rewrite G(s) showing each term normalized to a low-frequency gain of unity. Hence, G s¬Ü¬à3 2Ks 3¬á1/C18/C19 s s¬á1¬Üs 2¬á1/C18/C19 (10.25) Now determine that the break frequencies are at 1, 2, and 3. The magnitude plot should begin a decade below the lowest break frequency and extend a decade above the highestR(s) ‚ÄìE(s)G(s)C(s) + FIGURE 10.10 Closed-loop unity feedback system10.2 Asymptotic Approximations: Bode Plots 537WEBC10 10/28/2014 18:16:2 break frequency. Hence, we choose 0.1 radian to 100 radians, or three decades, as the extent of our plot. Atœâ¬à0:1 the low-frequency value of the function is found from Eq. (10.25) using the low-frequency values for all of the ¬â s=a¬Ü¬á1¬äterms (that is, s¬à0) and the actual value for the sterm in the denominator. Thus, G j0:1¬Ü‚âà3 2K=0:1¬à15K. The effect of K is to move the magnitude curve up (increasing K) or down (decreasing K) by the amount of 20 log K.Khas no effect upon the phase curve. If we choose K¬à1, the magnitude plot can be denormalized later for any value of Kthat is calculated or known. Figure 10.11( a) shows each component of the Bode log-magnitude frequency response. Summing the components yields the composite plot shown in Figure 10.11( b). The results are summarized in Table 10.2, which can be used to obtain the slopes. Each40 20 ‚Äì20 ‚Äì40 ‚Äì60 ‚Äì80 0.1 1 10 10040 20 0 ‚Äì20 ‚Äì40 ‚Äì60 ‚Äì80 00.1 1 10 100 Frequency (rad/s) Frequency (rad/s)(a) (b)20 dB/dec (6 dB/oct) ‚Äì20 dB/dec (‚Äì6 dB/oct) ‚Äì 40 dB/dec (‚Äì12dB/oct)20 log M 20 log M(s + 1)1 ‚Äì20 dB/dec ( ‚Äì6 dB/oct) ‚Äì60 dB/dec (‚Äì18 dB/oct)‚Äì40 dB/dec (‚Äì12 dB/oct)1 s + 122s3 s + 13 FIGURE 10.11 Bode log-magnitude plot for Example 10.2: a.components; b.composite TABLE 10.2 Bode magnitude plot: slope contribution from each pole and zero in Example 10.2 Frequency (rad/s) Description0.1 (Start: Pole at 0)1 (Start: Pole at  1)2 (Start: Pole at  2)3 (Start: Zero at  3) Pole at 0  20  20  20  20 Pole at  10  20  20  20 Pole at  20 0  20  20 Zero at  30 0 0 2 0 Total slope (dB/dec)  20  40  60  40538 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:3 pole and zero is itemized in the Ô¨Årst column. Reading across the table shows its contribution at each frequency. The last row is the sum of the slopes and correlates with Figure 10.11( b). The Bode magnitude plot for K¬à1 starts at œâ¬à0:1 with a value of 20 log 15 ¬à23:52 dB, and decreases immediately at a rate of  20 dB =decade, due to the sterm in the denominator. At œâ¬à1, the s¬á1¬Üterm in the denominator begins its 20 dB= decade downward slope and causes an additional 20 dB =decade negative slope, or a total of  40 dB =decade. At œâ¬à2, the term ¬â s=2¬Ü¬á1¬äbegins its  20 dB= decade slope, adding yet another  20 dB= decade to the resultant plot, or a total of  60 dB =decade slope that continues until œâ¬à3. At this frequency, the ¬â s=3¬Ü¬á1¬äterm in the numerator begins its positive 20 dB =decade slope. The resultant magnitude plot, therefore, changes from a slope of  60 dB= decade to  40 dB =decade at œâ¬à3, and continues at that slope, since there are no other break frequencies. The slopes are easily drawn by sketching straight-line segme nts decreasing by 20 dB over a decade. For example, the initial  20 dB =decade slope is drawn from 23 .52 dB at œâ¬à0:1, to 3.52 dB (a 20 dB decrease) at œâ¬à1. The  40 dB =decade slope starting at œâ¬à1 is drawn by sketching a line segment from 3.52 dB at œâ¬à1, to  3 6 . 4 8d B( a4 0d Bd e c r e a s e )a tœâ ¬à10, and using only the portion from œâ¬à1t o œâ¬à2. The next slope of  60 dB =decade is drawn by Ô¨Årst sketching a line segment from œâ¬à2t o œâ¬à20 (1 decade) that drops down by 60 dB, and using only that portion of the line from œâ¬à2t oœâ¬à3. The Ô¨Ånal slope is drawn by sketching a line segment from œâ¬à3t oœâ¬à30 (1 decade) that drops by 40 dB. This slope continues to the end of the plot. Phase is handled similarly. However, the existence of breaks, a decade below and a decade above the break frequency, requires a little more bookkeeping. Table 10.3 showsthe starting and stopping frequencies of the 45 ¬∞=decade slope for each of the poles and zeros. For example, reading across for the pole at  2, we see that the  45¬∞slope starts at a frequency of 0.2 and ends at 20. Filling in the rows for each pole and then summing the columns yields the slope portrait of the resulting phase plot. Looking at the row marked Total slope , we see that the phase plot will have a slope of  45¬∞=decade from a frequency of 0.1 to 0.2. The slope will then increase to  90 ¬∞=decade from 0.2 to 0.3. The slope will return to  45¬∞=decade from 0.3 to 10 rad/s. A slope of 0 ensues from 10 to 20 rad/s, followed by a slope of ¬á45 ¬∞=decade from 20 to 30 rad/s. Finally, from 30 rad/s to inÔ¨Å nity, the slope is 0 ¬∞=decade. The resulting component and composite phase plots are shown in Figure 10.12. Since the pole at the origin yields a constant  90 ¬∞phase shift, the plot begins at  90 ¬∞and follows the slope portrait just described. TABLE 10.3 Bode phase plot: slope contribution from each pole and zero in Example 10.2 Frequency (rad/s) Description0.1 (Start: Pole at  1)0.2 (Start: Pole at  2)0.3 (Start: Pole at  3)0 (End: Pole at  1)20 (End: Pole at  2)30 (End: Zero at  3) Pole at  1  45  45  45 0 Pole at  2  45  45  45 0 Zero at  34 5 45 45 0 Total slope (deg/dec)  45  90  45 0 45 010.2 Asymptotic Approximations: Bode Plots 539WEBC10 10/28/2014 18:16:4 Bode Plots for G(s)=s2+2Œ∂œâns+œân2 Now that we have covered Bode plots for Ô¨Årst-order systems, we turn to the Bode log-magnitude and phase plots for second-order polynomials in s. The second-order polynomial is of the form G s¬Ü¬às2¬á2Œ∂œâns¬áœâ2 n¬àœâ2ns2 œâ2 n¬á2Œ∂s œân¬á1/C18/C19 (10.26) Unlike the Ô¨Årst-order frequency response approximation, the difference between the asymptotic approximation and the actual frequency response can be great for some values ofŒ∂. A correction to the Bode diagrams can be made to improve the accuracy. We Ô¨Årst derive the asymptotic approximation and then show the difference between the asymptoticapproximation and the actual frequency response curves. At low frequencies, Eq. (10.26) becomes G s¬Ü‚âàœâ 2 n¬àœâ2n¬Ä0¬∞ (10.27) The magnitude, M, in dB at low frequencies therefore is 20 log M¬à20 log jG jœâ¬Üj¬à20 log œâ2 n (10.28) At high frequencies, G s¬Ü‚âàs2(10.29) or G jœâ¬Ü‚âà œâ2¬àœâ2¬Ä180 ¬∞ (10.30) The log-magnitude is 20 log M¬à20 log jG jœâ¬Üj¬à20 log œâ2¬à40 log œâ (10.31)(b)(a)‚Äì180Phase (degrees) 0.1 1 10 100 Frequency (rad/s)45¬∞/dec ‚Äì45¬∞/dec ‚Äì315Phase (degrees) 0.1 1 10 100 Frequency (rad/s)‚Äì135‚Äì90‚Äì4504590 3s ‚Äì270‚Äì225‚Äì180‚Äì135‚Äì90‚Äì45¬∞/dec 45¬∞/dec‚Äì90¬∞/dec‚Äì45¬∞/dec ‚Äì360+1 3 2s ‚Äì45¬∞/dec1 ( + 1)s1 +12s FIGURE 10.12 Bode phase plot for Example 10.2: a.components; b.composite540 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:4 Equation (10.31) is a straight line with twice the slope of a Ô¨Årst-order term (Eq. (10.20)). Its slope is 12 dB/octave, or 40 dB/decade. The low-frequency asymptote (Eq. (10.27)) and the high-frequency asymptote (Eq. (10.31)) are equal when œâ¬àœân. Thus, œânis the break frequency for the second- order polynomial. For convenience in representing systems with different œân, we normalize and scale ourÔ¨Åndings before drawing the asymptotes. Using the normalized and scaled term of Eq. (10.26), we normalize the magnitude, dividing by œâ2 n, and scale the frequency, dividing byœân. Thus, we plot G s1¬Ü=œâ2n¬às21¬á2Œ∂s1¬á1, where s1¬às=œân.G s1¬Ühas a low-frequency asymptote at 0 dB and a break frequency of 1 rad/s. Figure 10.13( a) shows the asymptotes for the normalized and scaled magnitude plot. We now draw the phase plot. It is 0 ¬∞at low frequencies (Eq. (10.27)) and 180 ¬∞ at high frequencies (Eq. (10.30)). To Ô¨Ånd the phase at the natural frequency, Ô¨Årst evaluate G jœâ¬Ü: G jœâ¬Ü¬à s2¬á2Œ∂œâns¬áœâ2 njs¬Æjœâ¬à œâ2n œâ2¬Ü¬áj2Œ∂œânœâ (10.32) Then Ô¨Ånd the function value at the natural frequency by substituting œâ¬àœân. Since the result is j2Œ∂œâ2 n, the phase at the natural frequency is ¬á90 ¬∞. Figure 10.13( b) shows the phase plotted with frequency scaled by œân. The phase plot increases at a rate of 90¬∞=decade from 0.1 to 10 and passes through 90 ¬∞at 1. Corrections to Second-Order Bode Plots Let us now examine the error between the actual response and the asymptotic approximation of the second-order polynomial. Whereas the Ô¨Årst-order polynomial has a disparity of no more than 3.01 dB magnitude and 5.71 ¬∞phase, the second-order function may have a greater disparity, which depends upon the value of Œ∂.‚Äì12020 log (M )œâ2 (a) ‚Äì45Phase (degrees) (b)‚Äì80‚Äì4004080120 04590135180 ‚Äì900.01 0.1 1 10 100 0.01 0.1 1 10 100Slope = 12 dB/octave = 40 dB/decade Slope = 90¬∞/decadenn œâœâ nœâœâFIGURE 10.13 Bode asymptotes for normalized and scaled G s¬Ü¬às2¬á2Œ∂œâ ns¬áœâ2 n: a.magnitude; b.phase10.2 Asymptotic Approximations: Bode Plots 541WEBC10 10/28/2014 18:16:12 From Eq. (10.32), the actual magnitude and phase for G s¬Ü¬às2¬á2Œ∂œâns¬áœâ2 nare, respectively, M¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É œâ2 n œâ2¬Ü2¬á 2Œ∂œânœâ¬Ü2q (10.33) Phase ¬àtan 12Œ∂œânœâ œâ2 n œâ2(10.34) These relationships are tabulated in Table 10.4 for a range of values of Œ∂a n dp l o t t e di n Figures 10.14 and 10.15 along with the asymptotic approximations for normalized TABLE 10.4 Data for normalized and scaled log-magnitude and phase plots for s2¬á2Œ∂œâns¬áœâ2 n¬Ü. Mag ¬à20 log M=œâ2n¬Ü Freq. œâ œânMag (dB) Œ∂¬à0:1Phase (deg) Œ∂¬à0:1Mag (dB) Œ∂¬à0:2Phase (deg) Œ∂¬à0:2Mag (dB) Œ∂¬à0:3Phase (deg) Œ∂¬à0:3 0.10  0.09 1.16  0.08 2.31  0.07 3.47 0.20  0.35 2.39  0.32 4.76  0.29 7.13 0.30  0.80 3.77  0.74 7.51  0.65 11.19 0.40  1.48 5.44  1.36 10.78  1.17 15.95 0.50  2.42 7.59  2.20 14.93  1.85 21.80 0.60  3.73 10.62  3.30 20.56  2.68 29.36 0.70  5.53 15.35  4.70 28.77  3.60 39.47 0.80  8.09 23.96  6.35 41.63  4.44 53.13 0.90  11.64 43.45  7.81 62.18  4.85 70.62 1.00  13.98 90.00  7.96 90.00  4.44 90.00 1.10  10.34 133.67  6.24 115.51  3.19 107.65 1.20  6.00 151.39  3.73 132.51  1.48 121.43 1.30  2.65 159.35  1.27 143.00 0.35 131.50 1.40 0.00 163.74 0.92 149.74 2.11 138.81 1.50 2.18 166.50 2.84 154.36 3.75 144.25 1.60 4.04 168.41 4.54 157.69 5.26 148.39 1.70 5.67 169.80 6.06 160.21 6.64 151.65 1.80 7.12 170.87 7.43 162.18 7.91 154.26 1.90 8.42 171.72 8.69 163.77 9.09 156.41 2.00 9.62 172.41 9.84 165.07 10.19 158.20 3.00 18.09 175.71 18.16 171.47 18.28 167.32 4.00 23.53 176.95 23.57 173.91 23.63 170.91 5.00 27.61 177.61 27.63 175.24 27.67 172.87 6.00 30.89 178.04 30.90 176.08 30.93 174.13 7.00 33.63 178.33 33.64 176.66 33.66 175.00 8.00 35.99 178.55 36.00 177.09 36.01 175.64 9.00 38.06 178.71 38.07 177.42 38.08 176.14 10.00 39.91 178.84 39.92 177.69 39.93 176.53 (table continues )542 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:15 magnitude and scaled frequency. In Figure 10.14, which is normalized to the square of the natural frequency, the normalized log-magnitude at the scaled natural frequencyis¬á20 log 2 Œ∂. The student should verify that the actual magnitude at the unscaled natural frequency is ¬á20 log 2 Œ∂œâ 2 n. Table 10.4 and Figures 10.14 and 10.15 can be used to improve accuracy when drawing Bode plots. For example, a magnitude correction of ¬á20 log 2 Œ∂can be made at the natural, or break, frequency on the Bode asymptotic plot. Bode Plots for G(s)=1/(s2+2Œ∂œâns+œân2) Bode plots for G s¬Ü¬à1= s2¬á2Œ∂œâns¬áœâ2 n¬Ücan be derived similarly to those for G s¬Ü¬às2¬á2Œ∂œâns¬áœâ2n.W eÔ¨Ånd that the magnitude curve breaks at the natural frequencyFreq. œâ œânMag (dB) Œ∂¬à0:5Phase (deg) Œ∂¬à0:5Mag (dB) Œ∂¬à0:7Phase (deg) Œ∂¬à0:7Mag (dB) Œ∂¬à1:0Phase (deg) Œ∂¬à1:0 0.10  0.04 5.77 0.00 8.05 0.09 11.42 0.20  0.17 11.77 0.00 16.26 0.34 22.62 0.30  0.37 18.25 0.02 24.78 0.75 33.40 0.40  0.63 25.46 0.08 33.69 1.29 43.60 0.50  0.90 33.69 0.22 43.03 1.94 53.13 0.60  1.14 43.15 0.47 52.70 2.67 61.93 0.70  1.25 53.92 0.87 62.51 3.46 69.98 0.80  1.14 65.77 1.41 72.18 4.30 77.32 0.90  0.73 78.08 2.11 81.42 5.15 83.97 1.00 0.00 90.00 2.92 90.00 6.02 90.00 1.10 0.98 100.81 3.83 97.77 6.89 95.45 1.20 2.13 110.14 4.79 104.68 7.75 100.39 1.30 3.36 117.96 5.78 110.76 8.60 104.86 1.40 4.60 124.44 6.78 116.10 9.43 108.92 1.50 5.81 129.81 7.76 120.76 10.24 112.62 1.60 6.98 134.27 8.72 124.85 11.03 115.99 1.70 8.10 138.03 9.66 128.45 11.80 119.07 1.80 9.17 141.22 10.56 131.63 12.55 121.89 1.90 10.18 143.95 11.43 134.46 13.27 124.48 2.00 11.14 146.31 12.26 136.97 13.98 126.87 3.00 18.63 159.44 19.12 152.30 20.00 143.13 4.00 23.82 165.07 24.09 159.53 24.61 151.93 5.00 27.79 168.23 27.96 163.74 28.30 157.38 6.00 31.01 170.27 31.12 166.50 31.36 161.08 7.00 33.72 171.70 33.80 168.46 33.98 163.74 8.00 36.06 172.76 36.12 169.92 36.26 165.75 9.00 38.12 173.58 38.17 171.05 38.28 167.32 10.00 39.96 174.23 40.00 171.95 40.09 168.58TABLE 10.4 Data for normalized and scaled log-magnitude and phase plots for s2¬á2Œ∂œâns¬áœâ2 n¬Ü. Mag ¬à20 log M=œâ2n¬Ü (Continued )10.2 Asymptotic Approximations: Bode Plots 543WEBC10 10/28/2014 18:16:15 and decreases at a rate of  40 dB =decade. The phase plot is 0 ¬∞at low frequencies. At 0 :1œân it begins a decrease of  90 ¬∞=decade and continues until œâ¬à10œân, where it levels off at 180 ¬∞. The exact frequency response also follows the same derivation as that of G s¬Ü¬às2¬á2Œ∂œâns¬áœâ2 n. The results are summarized in Table 10.5, as well as Figures 10.16 and 10.17. The exact magnitude is the reciprocal of Eq. (10.33), and the exact phase is the negative of Eq. (10.34). The normalized magnitude at the scaled natural frequencyis 20 log 2Œ∂ , which can be used as a correction at the break frequency on the Bode asymptotic plot. Phase (degrees) 0.1 10Asymptote 10204060801001201401601800.5 1.0 1.50.2 0.3 0.7ùúÅ = 0.1 nœâœâ FIGURE 10.15 Scaled phase response for s2¬á2Œ∂œâ ns¬áœâ2 n¬Ü0.1 1 n10‚Äì20‚Äì1001020304050ùúÅ = 1.5 1.0High-frequency asymptote 0.5 ùúÅ = 0.3Low-frequency asymptote 0.2 0.10.7 œâœâ20 log (M/œâ2)n FIGURE 10.14 Normalized and scaled log-magnitude response for s2¬á2Œ∂œâns¬áœâ2 n¬Ü544 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:23 TABLE 10.5 Data for normalized and scaled log-magnitude and phase plots for 1 = s2¬á2Œ∂œâ ns¬áœâ2 n¬Ü. Mag ¬à20 log M=œâ2n¬Ü Freq. œâ œânMag (dB) Œ∂¬à0:1Phase (deg) Œ∂¬à0:1Mag (dB) Œ∂¬à0:2Phase (deg) Œ∂¬à0:2Mag (dB) Œ∂¬à0:3Phase (deg) Œ∂¬à0:3 0.10 0.09  1.16 0.08  2.31 0.07  3.47 0.20 0.35  2.39 0.32  4.76 0.29  7.13 0.30 0.80  3.77 0.74  7.51 0.65  11.19 0.40 1.48  5.44 1.36  10.78 1.17  15.95 0.50 2.42  7.59 2.20  14.93 1.85  21.80 0.60 3.73  10.62 3.30  20.56 2.68  29.36 0.70 5.53  15.35 4.70  28.77 3.60  39.47 0.80 8.09  23.96 6.35  41.63 4.44  53.13 0.90 11.64  43.45 7.81  62.18 4.85  70.62 1.00 13.98  90.00 7.96  90.00 4.44   90.00 1.10 10.34  133.67 6.24  115.51 3.19  107.65 1.20 6.00  151.39 3.73  132.51 1.48  121.43 1.30 2.65  159.35 1.27  143.00  0.35  131.50 1.40 0.00  163.74  0.92  149.74  2.11  138.81 1.50  2.18  166.50  2.84  154.36  3.75  144.25 1.60  4.04  168.41  4.54  157.69  5.26  148.39 1.70  5.67  169.80  6.06  160.21  6.64  151.65 1.80  7.12  170.87  7.43  162.18  7.91  154.26 1.90  8.42  171.72  8.69  163.77  9.09  156.41 2.00  9.62  172.41  9.84  165.07  10.19  158.20 3.00  18.09  175.71  18.16  171.47  18.28  167.32 4.00  23.53  176.95  23.57  173.91  23.63  170.91 5.00  27.61  177.61  27.63  175.24  27.67  172.87 6.00  30.89  178.04  30.90  176.08  30.93  174.13 7.00  33.63  178.33  33.64  176.66  33.66  175.00 8.00  35.99  178.55  36.00  177.09  36.01  175.64 9.00  38.06  178.71  38.07  177.42  38.08  176.14 10.00  39.91  178.84  39.92  177.69  39.93  176.53 (table continues )10.2 Asymptotic Approximations: Bode Plots 545WEBC10 10/28/2014 18:16:26 Freq. œâ œânMag (dB) Œ∂¬à0:5Phase (deg) Œ∂¬à0:5Mag (dB) Œ∂¬à0:7Phase (deg) Œ∂¬à0:7Mag (dB) Œ∂¬à1:0Phase (deg) Œ∂¬à1:0 0.10 0.04  5.77 0.00  8.05  0.09  11.42 0.20 0.17  11.77 0.00  16.26  0.34  22.62 0.30 0.37  18.25  0.02  24.78  0.75  33.40 0.40 0.63  25.46  0.08  33.69  1.29  43.60 0.50 0.90  33.69  0.22  43.03  1.94  53.13 0.60 1.14  43.15  0.47  52.70  2.67  61.93 0.70 1.25  53.92  0.87  62.51  3.46  69.98 0.80 1.14   65.77  1.41  72.18  4.30  77.32 0.90 0.73  78.08  2.11  81.42  5.15  83.97 1.00 0.00  90.00  2.92  90.00  6.02  90.00 1.10  0.98  100.81  3.93  97.77  6.89  95.45 1.20  2.13  110.14  4.79  104.68  7.75  100.39 1.30  3.36  117.96  5.78  110.76  8.60  104.86 1.40  4.60  124.44  6.78  116.10  9.43  108.92 1.50  5.81  129.81  7.76  120.76  10.24  112.62 1.60  6.98  134.27  8.72  124.85  11.03  115.99 1.70  8.10  138.03  9.66  128.45  11.80  119.07 1.80  9.17  141.22  10.56  131.63  12.55  121.89 1.90  10.18  143.95  11.43  134.46  13.27  124.48 2.00  11.14  146.31  12.26  136.97  13.98  126.87 3.00  18.63  159.44  19.12  152.30  20.00  143.13 4.00  23.82  165.07  24.09  159.53  24.61  151.93 5.00  27.79  168.23  27.96  163.74  28.30  157.38 6.00  31.01  170.27  31.12  166.50  31.36  161.08 7.00  33.72  171.70  33.80  168.46  33.98  163.74 8.00  36.06  172.76  36.12  169.92  36.26  165.75 9.00  38.12  173.58  38.17  171.05  38.28  167.32 10.00  39.96  174.23  40.00  171.95  40.09  168.58TABLE 10.5 Data for normalized and scaled log-magnitude and phase plots for 1 = s2¬á2Œ∂œâ ns¬áœâ2 n¬Ü. Mag ¬à20 log M=œâ2n¬Ü (Continued )546 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:26 Let us now look at an example of drawing Bode plots for transfer functions that contain second-order factors.0.1 10‚Äì50‚Äì40‚Äì30‚Äì20‚Äì1001020 High-frequency asymptoteLow-frequency asymptoteùúÅ = 0.1 1.51.00.7 0.30.2 ùúÅ = 0.5 n120 log (M/œâ2)n FIGURE 10.16 Normalized and scaled log-magnitude response for 1= s2¬á2Œ∂œâns¬áœâ2 n¬ÜPhase (degrees) 0.1 100.5ùúÅ = 0.1 1.00.2 Asymptote0.3 0.7 1‚Äì180‚Äì160‚Äì140‚Äì120‚Äì100‚Äì80‚Äì60‚Äì40‚Äì2001.5 n FIGURE 10.17 Scaled phase response for 1 = s2¬á2Œ∂œâ ns¬áœâ2 n¬Ü Example 10.3 Bode Plots for Ratio of First- and Second-Order FactorsBode Plots for Ratio of First- and Second-Order Factors PROBLEM: Draw the Bode log-magnitude and phase plots of G(s) for the unity feedback system shown in Figure 10.10, where G s¬Ü¬à s¬á3¬Ü=¬â s¬á2¬Ü s2¬á2s¬á25¬Ü¬ä.10.2 Asymptotic Approximations: Bode Plots 547WEBC10 10/28/2014 18:16:28 SOLUTION: WeÔ¨Årst convert G(s) to show the normalized components that have unity low-frequency gain. The second-order term is normalized by factoring out œâ2 n, forming s2 œâ2 n¬á2Œ∂ œâns¬á1 (10.35) Thus, G s¬Ü¬à3 2¬Ü 25¬Üs 3¬á1/C16/C17 s 2¬á1/C16/C17s2 25¬á2 25s¬á1/C18/C19 ¬à3 50s 3¬á1/C16/C17 s 2¬á1/C16/C17s2 25¬á2 25s¬á1/C18/C19 (10.36) The Bode log-magnitude diagram is shown in Figure 10.18( b) and is the sum of the individual Ô¨Årst- and second-order terms of G(s) shown in Figure 10.18( a). We solve this problem by adding the slopes of these component parts, beginning and ending at the appropriate frequencies. The results are summarized in Table 10.6, which can be used to(b)(a)‚Äì5020 log M 0.01 100 Frequency (rad/s)20 log M 0.01 Frequency (rad/s)0.1 1 10 ‚Äì703 50‚Äì20 dB/dec20 dB/dec ‚Äì40‚Äì30‚Äì20‚Äì10010 ‚Äì60‚Äì50‚Äì40‚Äì30‚Äì20‚Äì10 100 0.1 1 10‚Äì20 dB/decCorrection ‚Äì40 dB/dec‚Äì40 dB/dec 1+ 1 s 2 + s 3 1 1 s2 + 2 s +125 25 FIGURE 10.18 Bode magnitude plot for G s¬Ü¬à s¬á3¬Ü= ¬â s¬á2¬Ü s2¬á2s¬á25¬Ü¬ä: a.components; b.composite TABLE 10.6 Magnitude diagram slopes for Example 10.3 Frequency (rad/s) Description0.01 (Start: Plot)2 (Start: Pole at  2)3 (Start: Zero at  3)5 (Start: œân¬à5) Pole at  20  20  20  20 Zero at  30 0 2 0 2 0 œân¬à50 0 0  40 Total slope (dB/dec) 0  20 0  40548 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:29 obtain the slopes. The low-frequency value for G(s), found by letting s¬à0, is 3/50, or  24.44 dB. The Bode magnitude plot starts out at this value and continues until the Ô¨Årst break frequency at 2 rad/s. Here the pole at  2 yields a  20 dB =decade slope downward until the next break at 3 rad/s. The zero at  3 causes an upward slope of ¬á20 dB =decade, which, when added to the previous  20 dB =decade curve, gives a net slope of 0. At a frequency of 5 rad/s, the second-order term initiates a  40 dB =decade downward slope, which continues to in Ô¨Ånity. The correction to the log-magnitude curve due to the underdamped second-order term can be found by plotting a point  20 log 2 Œ∂above the asymptotes at the natural frequency. Since Œ∂¬à0:2 for the second-order term in the denominator of G(s), the correction is 7.96 dB. Points close to the natural frequency can be corrected by taking the values from the curves of Figure 10.16. TABLE 10.7 Phase diagram slopes for Example 10.3 Frequency (rad/s) Description0.2 (Start: Pole at  2)0.3 (Start: Zero at  3)0.5 (Start: œânat 5)20 (End: Pole at  2)30 (End: Zero at  3)50 (End: œân¬à5) Pole at  2  45  45  45 0 Zero at  34 5 45 45 0 œân¬à5  90  90  90 0 Total slope (dB/dec)  45 0  90  45  90 0 ‚Äì90¬∞/dec‚Äì45¬∞/decPhase (degrees)90 45 0 ‚Äì45 ‚Äì90 ‚Äì135 ‚Äì180 ‚Äì225 0.01 0.1 1 10 100 Frequency (rad/s) 0 ‚Äì45 ‚Äì90 ‚Äì135 ‚Äì180 ‚Äì225 ‚Äì270 ‚Äì315(a) (b)Phase (degrees) 0.01 0.1 1 10 100 Frequency (rad/s)‚Äì45¬∞/dec3 50 ‚Äì45¬∞/dec ‚Äì90¬∞/dec11+ 1 s2 + 2 s +125 251+ 2s ‚Äì90¬∞/dec45¬∞/decs 3 FIGURE 10.19 Bode phase plot for G s¬Ü¬à s¬á3¬Ü= ¬â s¬á2¬Ü s2¬á2s¬á25¬Ü¬ä: a.components; b.composite10.2 Asymptotic Approximations: Bode Plots 549WEBC10 10/28/2014 18:16:29 In this section, we learned how to construct Bode log-magnitude and Bode phase plots. The Bode plots are separate magnitude and phase frequency response curves for a system, G(s). In the next section, we develop the Nyquist criterion for stability, which makes use of the frequency response of a system. The Bode plots can then be used to determine the stability of a system. 10.3 Introduction to the Nyquist Criterion The Nyquist criterion relates the stability of a closed-loop system to the open-loopfrequency response and open-loop pole location. Thus, knowledge of the open-loop system ‚Äôs frequency response yields information about the stability of the closed-loop system. Thisconcept is similar to the root locus, where we began with information about the open-loopsystem, its poles and zeros, and developed transient and stability information about theclosed-loop system. Although the Nyquist criterion will yield stability information at Ô¨Årst, we will extend the concept to transient response and steady-state errors. Thus, frequency response techniques are an alternate approach to the root locus.We now turn to the phase plot. Table 10.7 is formed to determine the progression of slopes on the phase diagram. The Ô¨Årst-order pole at  2 yields a phase angle that starts at 0 ¬∞ and ends at  90 ¬∞via a  45 ¬∞=decade slope starting a decade below its break frequency and ending a decade above its break frequency. The Ô¨Årst-order zero yields a phase angle that starts at 0 ¬∞and ends at ¬á90 ¬∞via a ¬á45 ¬∞=decade slope starting a decade below its break frequency and ending a decade above its break frequency. The second-order poles yield a phase angle that starts at 0 ¬∞and ends at  180 ¬∞via a  90¬∞=decade slope starting a decade below their natural frequency œân¬à5¬Üand ending a decade above their natural frequency. The slopes, shown in Figure 10.19( a), are summed over each frequency range, and the Ô¨Ånal Bode phase plot is shown in Figure 10.19( b). Students who are using MATLAB should now run ch10p1 in Appendix B.You will learn how to use MATLAB to make Bode plots and list thepoints on the plots. This exercise solves Example 10.3 usingMATLAB. Skill-Assessment Exercise 10.2 PROBLEM: Draw the Bode log-magnitude and phase plots for the system shown in Figure 10.10, where G s¬Ü¬à s¬á20¬Ü s¬á1¬Ü s¬á7¬Ü s¬á50¬Ü ANSWER: The complete solution is at www.wiley.com/college/nise .TryIt 10.1 Use MATLAB, the Control System Toolbox, and the following statements to obtain the Bode plots for the system ofSkill-Assessment Exercise 10.2 G=zpk( [  20] , [  1, 7 , ...  50] , 1) bode (G) ; grid on After the Bode plots appear, click on the curve and drag to read the coordinates.550 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:30 Derivation of the Nyquist Criterion Consider the system of Figure 10.20. The Nyquist criterion can tell us how many closed- loop poles are in the right half-plane. Before deriving the criterion, let us establish four important concepts that will be used during the derivation: (1) the relationshipbetween the poles of 1 ¬áG s¬ÜH s¬Üand the poles of G(s)H(s); (2) the relationship between the zeros of 1 ¬áG s¬ÜH s¬Üand the poles of the closed-loop transfer function, T(s); (3) the concept of mapping points; and (4) the concept of mapping contours. Letting G s¬Ü¬àNG DG(10.37a) H s¬Ü¬àNH DH(10.37b) weÔ¨Ånd G s¬ÜH s¬Ü¬àNGNH DGDH(10.38a) 1¬áG s¬ÜH s¬Ü¬à1¬áNGNH DGDH¬àDGDH¬áNGNH DGDH(10.38b) T s¬Ü¬àG s¬Ü 1¬áG s¬ÜH s¬Ü¬àNGDH DGDH¬áNGNH(10.38c) From Eqs. (10.38), we conclude that (1) the poles of 1¬áG s¬ÜH s¬Üare the same as the poles of G(s)H(s), the open-loop system, and (2)the zeros of 1¬áG s¬ÜH s¬Üare the same as the poles of T( s), the closed-loop system . Next, let us de Ô¨Åne the term mapping . If we take a complex number on the s-plane and substitute it into a function, F(s), another complex number results. This process is called mapping . For example, substituting s¬à4¬áj3 into the function s2¬á2s¬á1¬Üyields 16¬áj30. We say that 4 ¬áj3 maps into 16 ¬áj30 through the function s2¬á2s¬á1¬Ü. Finally, we discuss the concept of mapping contours . Consider the collection of points, called a contour , shown in Figure 10.21 as contour A. Also, assume that F s¬Ü¬à s z1¬Ü s z2¬Ü... s p1¬Ü s p2¬Ü...(10.39) Contour Acan be mapped through F(s) into contour Bby substituting each point of contour Ainto the function F(s) and plotting the resulting complex numbers. For example, point Q in Figure 10.21 maps into point Q¬¥through the function F(s). The vector approach to performing the calculation, covered in Section 8.1, can be used as an alternative. Some examples of contour mapping are shown in Figure 10.22for some simple F(s). The mapping of each point is de Ô¨Åned by complex arithmetic, where the resulting complex number, R, is evaluated from the complex numbersR(s) + ‚ÄìG(s) H(s)C(s) FIGURE 10.20 Closed-loop control system jœâ F(s) ImContour A ReContour Bs-plane F-plane Q'Q œÉ FIGURE 10.21 Mapping contour Athrough function F(s) to contour B10.3 Introduction to the Nyquist Criterion 551WEBC10 10/28/2014 18:16:30 represented by V, as shown in the last column of Figure 10.22. You should verify that if we assume a clockwise direction for mapping the points on contour A, then contour B maps in a clockwise direction if F(s) in Figure 10.22 has just zeros or has just poles that are not encircled by the contour. The contour Bmaps in a counterclockwise direction if F(s) has just poles that are encircled by the contour. Also, you should verify that if the pole or zero of F(s) is enclosed by contour A, the mapping encircles the origin. In the last case of Figure 10.22, the pole and zero rotation cancel, and the mapping does not encircle the origin. Let us now begin the derivation of the Nyquist criterion for stability. We show that a unique relationship exists between the number of poles of F(s) contained inside contour A, the number of zeros of F(s) contained inside contour A, and the number of counterclockwiseVjœâ z1s F(s) = (s ‚Äì z1) ImContour A Re R = VContour B RF-plane (a) Vjœâ p1s-plane F(s) =ImContour A Re R =V Contour BRF-plane (b)1 (s ‚Äì p1)1 Vjœâ z1s-planeIm Contour A Re R = VContour B RF-plane (c) Vjœâ p1 F(s) =Im Contour A Re R =VContour B (d)1 1 R V1jœâ p1s-planeIm Contour A Re R =Contour BF-plane (e)R z1(s ‚Äì z1) V2-plane F(s) = (s ‚Äì z 1) s-plane (s ‚Äì p1)F-plane F(s) =(s ‚Äì p1)V2 V1œÉœÉœÉœÉœÉ FIGURE 10.22 Examples of contour mapping552 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:31 encirclements of the origin for the mapping of contour B. We then show how this interrelationship can be used to determine the stability of closed-loop systems. This method of determining stability is called the Nyquist criterion. Let us Ô¨Årst assume that F s¬Ü¬à1¬áG s¬ÜH s¬Ü, with the picture of the poles and zeros of 1¬áG s¬ÜH s¬Üas shown in Figure 10.23 near contour A. Hence, R¬à V1V2¬Ü= V3V4V5¬Ü.A s each point Qof the contour Ais substituted into 1 ¬áG s¬ÜH s¬Ü, a mapped point results on contour B. Assuming that F s¬Ü¬à1¬áG s¬ÜH s¬Ühas two zeros and three poles, each parenthetical term of Eq. (10.39) is a vector in Figure 10.23. As we move around contour Ain a clockwise direction, each vector of Eq. (10.39) that lies inside contour Awill appear to undergo a complete rotation, or a change in angle of 360 ¬∞. On the other hand, each vector drawn from the poles and zeros of 1 ¬áG s¬ÜH s¬Üthat exists outside contour Awill appear to oscillate and return to its previous position, undergoing a net angular change of 0 ¬∞. Each pole or zero factor of 1 ¬áG s¬ÜH s¬Üwhose vector undergoes a complete rotation around contour Amust yield a change of 360 ¬∞in the resultant, R, or a complete rotation of the mapping of contour B. If we move in a clockwise direction along contour A, each zero inside contour Ayields a rotation in the clockwise direction, while each pole inside contour Ayields a rotation in the counterclockwise direction, since poles are in the denominator of Eq. (10.39). Thus, N¬àP Z, where Nequals the number of counterclockwise rotations of contour Babout the origin; Pequals the number of poles of 1 ¬áG s¬ÜH s¬Üinside co ntour A, and Zequals the number of zeros of 1 ¬áG s¬ÜH s¬Üinside contour A. Since the poles shown in Figure 10.23 are poles of 1 ¬áG s¬ÜH s¬Ü, we know from Eqs. (10.38) that they are also the poles of G(s)H(s) and are known. But, since the zeros shown in Figure 10.23 are the zeros of 1¬áG s¬ÜH s¬Ü, we know from Eqs. (10.38) that they are also the poles of the closed-loop system and are not known . Thus, Pequals the number of enclosed open-loop poles, and Zequals the number of enclosed closed-loop poles. Hence, N¬àP Z, or alternately, Z¬àP N, tells us that the number of closed-loop poles inside the contour (which is the same as the zeros inside the contour) equals the number of open-loop poles of G(s)H(s) inside the contour minus the number of counterclockwise rotations of the mapping about the origin. If we extend the contour to include the entire right half-plane, as shown in Figure 10.24, we can count the number of right-half-plane closed-loop poles inside contour Aand determine a system ‚Äôs stability. Since we can count the number of open-loop poles, P, inside the contour, which are the same as the right-half-plane poles of G(s)H(s),the only probl em remaining is how to obtain the mapping and Ô¨Ånd N. Since all of the poles and zeros of G(s)H(s) are known, what if we map through G(s)H(s) instead of 1 ¬áG s¬ÜH s¬Ü? The resulting contour is the same as a mapping through 1 ¬áG s¬ÜH s¬Ü, except that it is translated one unit to the left. Thus, we count rotations about  1 instead of rotations about the origin. Hence, the Ô¨Ånal statement of the Nyquist stability criterion is as follows: If a contour, A, that encircles the entire right half-plane is mapped through G(s)H(s), then the number of closed-loop poles, Z, in the right half-plane equalss-planeAjœâ œÉ FIGURE 10.24 Contour enclosing right half-plane to determine stabilityF(s) = 1 + G(s)H(s)V2V3V4Q V1jœâ s-plane Contour A1 + GH-plane Contour BV1RIm Re= V5V2 V3V4V5 RœÉ FIGURE 10.23 Vector representation of mapping10.3 Introduction to the Nyquist Criterion 553WEBC10 10/28/2014 18:16:31 the number of open-loop poles, P, that are in the right half-plane minus the number of counterclockwise revolutions, N, around  1of the mapping; that is, Z ¬àP N.The mapping is called the Nyquist diagram, or Nyquist plot, of G(s)H(s). We can now see why this method is classi Ô¨Åed as a frequency response technique. Around contour Ain Figure 10.24, the mapping of the points on the jœâ-axis through the function G(s)H(s) is the same as substituting s¬àjœâinto G(s)H(s) to form the frequency response function G jœâ¬ÜH jœâ¬Ü. We are thus Ô¨Ånding the frequency response of G(s)H(s) over that part of contour Aon the positive jœâ-axis. In other words, part of the Nyquist diagram is the polar plot of the frequency response of G(s)H(s). Applying the Nyquist Criterion to Determine Stability Before describing how to sketch a Nyquist diagram, let us look at some typical examples thatuse the Nyquist criterion to determine the stability of a system. These examples give us a perspective prior to engaging in the details of mapping. Figure 10.25( a) shows a contour A that does not enclose closed-loop poles, that is, the zeros of 1 ¬áG s¬ÜH s¬Ü. The contour thus maps through G(s)H(s) into a Nyquist diagram that does not encircle  1. Hence, P¬à0;N¬à0, and Z¬àP N¬à0. Since Zis the number of closed-loop poles inside contour A, which encircles the right half-plane, this system has no right-half-plane poles and is stable. On the other hand, Figure 10.25( b)s h o w sac o n t o u rA that, while it does not enclose open- loop poles, does generate two clockwise encirclements of  1. Thus, P¬à0;N¬à 2, and the system is unstable; it has two closed-loop poles in the right half-plane, since Z¬àP N¬à2. The two closed-loop poles are shown inside contour Ain Figure 10.25( b) as zeros of 1¬áG s¬ÜH s¬Ü. You should keep in mind that the existence of these poles is not known a priori. In this example, notice that clockwise encirclements imply a negative value for N. The number of encirclements can be determined by drawing a test radius from  1 in any convenient direction and counting the number of times the Nyquist diagram crosses the testradius. Counterclockwise crossings are positive, and clockwise crossings are negative. Forexample, in Figure 10.25( b), contour Bcrosses the test radius twice in a clockwise direction. Hence, there are  2 encirclements of the point  1. A jœâ As-planeTest radiusIm GH-plane ‚Äì1B ReReBIm GH-plane ‚Äì1 (a) (b)s-plane G(s)H(s) G(s)H(s) = zeros of 1 + G(s)H(s) = poles of closed-loop system= poles of 1 + G(s)H(s) = poles of G(s)H(s) Location is known Location not knownjœâ œÉœÉ FIGURE 10.25 Mapping examples: a.Contour does not enclose closed-loop poles; b.contour does enclose closed-loop poles554 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:33 Before applying the Nyquist criterion to other examples in order to determine a system ‚Äôs stability, we must Ô¨Årst gain experience in sketching Nyquist diagrams. The next section covers the development of this skill. 10.4 Sketching the Nyquist Diagram The contour that encloses the right half-plane can be mapped through the function G(s)H(s) by substituting points along the contour into G(s)H(s). The points along the positive extension of the imaginary axis yield the polar frequency response of G(s)H(s). Approximations can be made to G(s)H(s) for points around the in Ô¨Ånite semicircle by assuming that the vectors originate at the origin. Thus, their length is in Ô¨Ånite, and their angles are easily evaluated. However, most of the time a simple sketch of the Nyquist diagram is all that is needed. A sketch can be obtained rapidly by looking at the vectors of G(s)H(s)a n dt h e i r motion along the contour. In the examples th at follow, we stress this rapid method for sketching the Nyquist diagram. However, the examples also include analytical expressions for G(s)H(s) for each section of the contour to aid you in determining the shape of the Nyquist diagram. Example 10.4 Sketching a Nyquist DiagramSketching a Nyquist Diagram PROBLEM: Speed controls Ô¨Ånd wide application throughout industry and the home. Figure 10.26( a) shows one application: output frequency control of electrical power from a turbine and generator pair. By regulating the speed, the control system ensures that the generated frequency remains within tolerance. Deviations from the desired speed are sensed, and a steam valve is changed to compensate for the speed error. The system block diagram is shown in Figure 10.26( b). Sketch the Nyquist diagram for the system of Figure 10.26. Generator Turbine ControllerValve actuator Desired speed or frequencyFrequency or speed measurements (a)Steam (b)Desired speed + ‚ÄìTurbineAmplifier, valve actuator, and steam valve Generator E (s)Steam pressure TorqueActual speed 100 ( s + 10)1 (s + 3)5 (s + 1)Sensor FIGURE 10.26 a.Turbine and generator; b.block diagram of speed control system for Example 10.410.4 Sketching the Nyquist Diagram 555WEBC10 10/28/2014 18:16:33 SOLUTION: Conceptually, the Nyquist diagram is p lotted by substituting the points of the contour shown in Figure 10.27( a)i n t o G s¬Ü¬à500=¬â s¬á1¬Ü s¬á3¬Ü s¬á10¬Ü¬ä.T h i s process is equivalent to performing com plex arithmetic using the vectors of G(s)d r a w n to the points of the contour as shown in Figure 10.27(a )a n d( b). Each pole and zero term of G(s) shown in Figure 10.26( b) is a vector in Figure 10.27( a)a n d( b). The resultant vector, R, found at any point along the contour is in general the product of the zero vectors divided by the product of the pole vectors (see Figure 10.27( c)). Thus, the magnitude of the resultant is the product of the zero lengths divided by the product of the pole lengths, and the angle of the resultant is the sum of the zero angles minusthe sum of the pole angles. As we move in a clockwise direction around the contour from point Ato point Cin Figure 10.27( a), the resultant angle goes from 0¬∞ to 390¬∞¬à 270 ¬∞,o rf r o m A ¬¥toC¬¥in Figure 10.27( c). Since the angles emanate from poles in the denominator ofG(s) ,t h er o t a t i o no ri n c r e a s ei na n g l ei sr e a l l yad e c r e a s ei na n g l eo ft h ef u n c t i o n G(s); the poles gain 270 ¬∞in a counterclockwise direction, which explains why the function loses 270 ¬∞. While the resultant moves from A¬¥toC¬¥in Figure 10.27( c), its magnitude changes as the product of the zero lengths divided by the product of the pole lengths. Thus, the Q'Im 50 3ReA' B'‚Äìj8.36D'C'‚Äì0.874 (c)GH-plane B'=V1V2V3500jœâ ‚Äì3 ‚Äì1 ‚Äì10C A DB (a)s-plane V1 V2V3C D‚Äì3 ‚Äì1 ‚Äì10 (b)s-plane Bjœâ V3V2V1 AœÉ œÉ FIGURE 10.27 Vector evaluation of the Nyquist diagram for Example 10.4: a.vectors on contour at low frequency; b.vectors on contour around in Ô¨Ånity; c.Nyquist diagram556 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:34 resultant goes from a Ô¨Ånite value at zero frequency (at point Aof Figure 10.27( a), there are three Ô¨Ånite pole lengths) to zero magnitude at in Ô¨Ånite frequency at point C(at point Cof Figure 10.27( a), there are three in Ô¨Ånite pole lengths). The mapping from point Ato point Ccan also be explained analytically. From AtoC the collection of points along the contour is imaginary. Hence, from AtoC,G s¬Ü¬àG jœâ¬Ü, or from Figure 10.26( b), G jœâ¬Ü¬à500 s¬á1¬Ü s¬á3¬Ü s¬á10¬Ü/C12/C12/C12/C12 s¬Æjœâ¬à500  14œâ2¬á30¬Ü¬áj 43œâ œâ3¬Ü(10.40) Multiplying the numerator and denominator by t he complex conjugate of the denominator, we obtain G jœâ¬Ü¬à 500  14œâ2¬á30¬Ü j 43œâ œâ3¬Ü  14œâ2¬á30¬Ü2¬á 43œâ œâ3¬Ü2(10.41) At zero frequency, G jœâ¬Ü¬à 500=30¬à50=3. Thus, the Nyquist diagram starts at 50 =3a t an angle of 0 ¬∞.A sœâ increases, the real part remains positive and the imaginary part remains negative. At œâ¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 30=14p , the real part becomes negative. At œâ¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 43p , the Nyquist diagram crosses the negative real axis, since the imaginary term goes to zero. The real value at the axis crossing, point Q¬¥in Figure 10.27( c), found by substituting into Eq. (10.41), is  0.874. Continuing toward œâ¬à‚àû, the real part is negative, and the imaginary part is positive. At in Ô¨Ånite frequency G jœâ¬Ü‚âàj500=œâ3, or approximately zero at 90 ¬∞. Around the inÔ¨Å nite semicircle from point Cto point Dshown in Figure 10.27(b ), the vectors rotate clockwise, each by 180 ¬∞. Hence, the resultant undergoes a counter- clockwise rotation of 3 180 ¬∞, starting at point C¬¥a n de n d i n ga tp o i n t D¬¥of Figure 10.27( c). Analytically, we can see this by assuming that around the in Ô¨Ånite semicircle, the vectors originate approximately at the origin and have in Ô¨Ånite length. For any point on the s-plane, the value of G(s) can be found by representing each complex number in polar form, as follows: G s¬Ü¬à500 R 1ejŒ∏ 1¬Ü R 3ejŒ∏ 3¬Ü R 10ejŒ∏ 10¬Ü(10.42) where R iis the magnitude of the complex number s¬ái¬Ü, and Œ∏ iis the angle of the complex number s¬ái¬Ü. Around the in Ô¨Ånite semicircle, all R iare in Ô¨Ånite, and we can use our assumption to approximate the angles as if the vectors originated at the origin. Thus,around the in Ô¨Ånite semicircle, G s¬Ü¬à500 ‚àû¬Ä Œ∏ 1¬áŒ∏ 3¬áŒ∏ 10¬Ü¬à0¬Ä  Œ∏ 1¬áŒ∏ 3¬áŒ∏ 10¬Ü (10.43) At point Cin Figure 10.27( b), the angles are all 90 ¬∞. Hence, the resultant is 0 ¬Ä 270 ¬∞, shown as point C¬¥in Figure 10.27( c). Similarly, at point D,G s¬Ü¬à0¬Ä¬á270 ¬∞and maps into point D¬¥. You can select intermediate points to verify the spiral whose radius vector approaches zero at the origin, as shown in Figure 10.27( c). The negative imaginary axis can be mapped by realizing that the real part of G jœâ¬ÜH jœâ¬Üis always an even function, whereas the imaginary part of G jœâ¬ÜH jœâ¬Üis an odd function. That is, the real part will not change sign when negative values of œâare used, whereas the imaginary part will change sign. Thus, the mapping of the negative imaginaryaxis is a mirror image of the mapping of the positive imaginary axis. The mapping of thesection of the contour from points DtoAis drawn as a mirror image about the real axis of the mapping of points AtoC.10.4 Sketching the Nyquist Diagram 557WEBC10 10/28/2014 18:16:36 In the previous example, there were no open-loop poles situated along the contour enclosing the right half-plane. If such poles exist, then a detour around the poles on the contour is required; otherwise, the mapping would go to in Ô¨Ånity in an undetermined way, without angular information. Subsequently, a complete sketch of the Nyquist diagram couldnot be made, and the number of encirclements of  1 could not be found. Let us assume a G s¬ÜH s¬Ü¬àN s¬Ü=sD s¬Üwhere D(s) has imaginary roots. The sterm in the denominator and the imaginary roots of D(s)a r ep o l e so f G(s)H(s) that lie on the contour, as shown in Figure 10.28( a). To sketch the Nyquist diagram, the contour must detour around each open-loop pole lying on its path. The detour can be to the right of thepole, as shown in Figure 10.28( b), which makes it clear that each pole ‚Äôsv e c t o rr o t a t e s through ¬á180 ¬∞as we move around the contour near that pole. This knowledge of the angular rotation of the poles on the contour pe rmits us to complete the Nyquist diagram. Of course, our detour must carry us only an in Ô¨Ånitesimal distance into the right half-plane, or else some closed-loop, right-half-plane poles will be excluded in the count. We can also detour to the left of the open-loop poles. In this case, each pole rotates through an angle of  180 ¬∞as we detour around it. Again, the detour must be in Ô¨Ånitesimally small, or else we might include some left-half-plane poles in the count. Let us look at anexample.jœâ jœâ jœâ (a)( b)( c)s-plane s-plane s-plane œÉ œÉ œÉ FIGURE 10.28 Detouring around open-loop poles: a.poles on contour; b.detour right; c.detour left Example 10.5 Nyquist Diagram for Open-Loop Function with Poles onContourNyquist Diagram for Open-Loop Function with Poleson Contour PROBLEM: Sketch the Nyquist diagram of the unity feedback system of Figure 10.10, where G s¬Ü¬à s¬á2¬Ü=s2. SOLUTION: The system ‚Äôs two poles at the origin are on the contour and must be bypassed, as shown in Figure 10.29( a). The mapping starts at point Aand continues in a clockwise direction. Points A,B,C,D,E,a n dF of Figure 10.29( a) map, respectively, into points A¬¥;B¬¥;C¬¥;D¬¥;E¬¥;andF¬¥of Figure 10.29( b). At point A, the two open-loop poles at the origin contribute 2 90¬∞¬à180 ¬∞, and the zero contributes 0 ¬∞. The total angle at point Ais thus  180 ¬∞. Close to the origin, the function is in Ô¨Ånite in magnitude because of the close proximity to the two open-loop poles. Thus, point Amaps into point A¬¥, located at in Ô¨Ånity at an angle of  180 ¬∞. Moving from point Ato point Balong the contour yields a net change in angle of ¬á90¬∞from the zero alone. The angles of the poles remain the same. Thus, the mapping changes by ¬á90 ¬∞in the counterclockwise direction. The mapped vector goes from  180 ¬∞atA¬¥to 90¬∞atB¬¥. At the same time, the magnitude changes from in Ô¨Ånity to zero, since at point Bthere is one in Ô¨Ånite length from the zero divided by two in Ô¨Ånite lengths from the poles.558 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:37 Alternately, the frequency response can be determined analytically from G jœâ¬Ü¬à 2¬ájœâ¬Ü=  œâ2¬Ü, considering œâgoing from 0 to ‚àû. At low frequencies, G jœâ¬Ü‚âà2=  œâ2¬Ü,o r‚àû¬Ä180 ¬∞. At high frequencies, G jœâ¬Ü‚âàj=  œâ¬Ü,o r0 ¬Ä  90¬∞. Also, the real and imaginary parts are always negative. As we travel along the contour BCD , the function magnitude stays at zero (one inÔ¨Ånite zero length divided by two in Ô¨Ånite pole lengths). As the vectors move through BCD , the zero ‚Äôs vector and the two poles ‚Äôvectors undergo changes of  180 ¬∞each. Thus, the mapped vector undergoes a net change of ¬á180 ¬∞, which is the angular change of the zero minus the sum of the angular changes of the poles f 180 ¬â2  180¬Ü¬ä ¬à ¬á180 g. The mapping is shown as B¬¥C¬¥D¬¥, where the resultant vector changes by ¬á180 ¬∞with a magnitude of Œµthat approaches zero. From the analytical point of view, G s¬Ü¬àR 2¬ÄŒ∏ 2 R0¬ÄŒ∏0¬Ü R0¬ÄŒ∏0¬Ü(10.44) anywhere on the s-plane where R 2¬ÄŒ∏ 2is the vector from the zero at  2 to any point on thes-plane, and R0¬ÄŒ∏0is the vector from a pole at the origin to any point on the s-plane. Around the in Ô¨Ånite semicircle, all R i¬à‚àû, and all angles can be approximated as if the vectors originated at the origin. Thus at point B,G s¬Ü¬à0¬Ä 90¬∞, since all Œ∏ i¬à90¬∞in Eq. (10.44). At point C, all R i¬à‚àû, and all Œ∏ i¬à0¬∞in Eq. (10.44). Thus, G s¬Ü¬à0¬Ä0¬∞. At point D, allR i¬à‚àû, and all Œ∏ i¬à 90¬∞in Eq. (10.44). Thus, G s¬Ü¬à0¬Ä90 ¬∞. The mapping of the section of the contour from DtoEis a mirror image of the mapping of AtoB. The result is D¬¥toE¬¥. Finally, over the section EFA, the resultant magnitude approaches in Ô¨Ånity. The angle of the zero does not change, but each pole changes by ¬á180 ¬∞. This change yields a change in the function of  2180 ¬∞¬à 360 ¬∞. Thus, the mapping from E¬¥toA¬¥is shown as inÔ¨Ånite in length and rotating  360 ¬∞. Analytically, we can use Eq. (10.44) for the points along the contour EFA.A t E,G s¬Ü¬à 2¬Ä0¬∞¬Ü=¬â œµ¬Ä 90 ¬∞¬Ü œµ¬Ä 90 ¬∞¬Ü¬ä ¬à‚àû¬Ä180 ¬∞.A t F,G s¬Ü¬à 2¬Ä0¬∞¬Ü=¬â œµ¬Ä0¬∞¬Ü œµ¬Ä0¬∞¬Ü¬ä ¬à‚àû¬Ä0¬∞.A t A,G s¬Ü¬à 2¬Ä0¬∞¬Ü=¬â œµ¬Ä90 ¬∞¬Ü œµ¬Ä90 ¬∞¬Ü¬ä ¬à ‚àû¬Ä 180 ¬∞. The Nyquist diagram is now complete, and a test radius drawn from  1i n Figure 10.29( b) shows one counterclockwise revolution, and one clockwise revolution, yielding zero encirclements. Students who are using MATLAB should now run ch10p2 in Appendix B. You will learn how to use MATLAB to make a Nyquist plot andlist the points on the plot. You will also learn how to specifya range for frequency. This exercise solves Example 10.5 usingMATLAB.EA FCB DF' A'E'D' B' ‚Äì2 Two polesjœâ Test radiusIm Re‚Äì1 (a)( b)GH-plane s-plane œÉ C' FIGURE 10.29 a.Contour for Example 10.5; b.Nyquist diagram for Example 10.510.4 Sketching the Nyquist Diagram 559WEBC10 10/28/2014 18:16:37 In this section, we learned how to sketch a Nyquist diagram. We saw how to calculate the value of the intersection of the Nyquist diagram with the negative real axis. This intersection is important in determining the number of encirclements of  1. Also, we showed how to sketch the Nyquist diagram when open-loop poles exist on the contour; thiscase required detours around the poles. In the next section, we apply the Nyquist criterion todetermine the stability of feedback control systems. 10.5 Stability via the Nyquist Diagram We now use the Nyquist diagram to determine a system ‚Äôs stability, using the simple equation Z¬àP N. The values of P, the number of open-loop poles of G(s)H(s) enclosed by the contour, and N, the number of encirclements the Nyquist diagram makes about  1, are used to determine Z, the number of right-half-plane poles of the closed-loop system. If the closed-loop system has a variable gain in the loop, one question we would like to ask is, ‚ÄúFor what range of gain is the system stable? ‚ÄùThis question, previously answered by the root locus method and the Routh-Hurwitz criterion, is now answered via the Nyquistcriterion. The general approach is to set the loop gain equal to unity and draw the Nyquistdiagram. Since gain is simply a multiplying factor, the effect of the gain is to multiply theresultant by a constant anywhere along the Nyquist diagram. For example, consider Figure 10.30, which summarizes the Nyquist approach for a system with variable gain, K. As the gain is varied, we can visualize the Nyquist diagram in Figure 10.30( c) expanding (increased gain) or shrinking (decreased gain) like a balloon.Skill-Assessment Exercise 10.3 PROBLEM: Sketch the Nyquist diagram for the system shown in Figure 10.10 where G s¬Ü¬à1 s¬á2¬Ü s¬á4¬Ü Compare your sketch with the polar plot in Skill-Assessment Exercise 10.1(c). ANSWER: The complete solution is located at www.wiley.com/college/nise . A CB ‚Äì1.33 15 8œâ = 11 B' A'C'(a)R(s)+ ‚ÄìE(s) (s ‚Äì 2)(s ‚Äì 4)K(s + 3)(s + 5) C(s) ‚Äì3 ‚Äì52 4jœâ (b)s-planeIm Re (c)GH-plane 1‚ÄìK1œÉ FIGURE 10.30 Demonstrat- ing Nyquist stability: a.system; b.contour; c.Nyquist diagramTryIt 10.2 Use MATLAB, the Control System Toolbox, and the following statements to plot theNyquist diagram of the systemshown in Figure 10.30( a). G=zpk( [  3, 5] , ... [2,4] ,1) nyquist(G) After the Nyquist diagram appears, click on the curve anddrag to read the coordinates.560 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:39 This motion could move the Nyquist diagram past the  1 point, changing the stability picture. For this system, since P¬à2, the critical point must be encircled by the Nyquist diagram to yield N¬à2 and a stable system. A reduction in gain would place the critical point outside the Nyquist diagram where N¬à0, yielding Z¬à2, an unstable system. From another perspective we can think of the Nyquist diagram as remaining stationary and the  1 point moving along the real axis. In order to do this, we set the gain to unity and position the critical point at  1=Krather than  1. Thus, the critical point appears to move closer to the origin as Kincreases. Finally, if the Nyquist diagram intersects the real axis at  1, then G jœâ¬ÜH jœâ¬Ü¬à  1. From root locus concepts, when G s¬ÜH s¬Ü¬à  1, the variable sis a closed-loop pole of the system. Thus, the frequency at which the Nyquist diagram intersects  1 is the same frequency at which the root locus crosses the jœâ-axis. Hence, the system is marginally stable if the Nyquist diagram intersects the real axis at  1. In summary, then, if the open-loop system contains a variable gain, K, set K¬à1 and sketch the Nyquist diagram. Consider the critical point to be at  1=Krather than at  1. Adjust the value of Kto yield stability, based upon the Nyquist criterion. Example 10.6 Range of Gain for Stability via the Nyquist CriterionRange of Gain for Stability via the Nyquist Criterion PROBLEM: For the unity feedback system of Figure 10.10, where G s¬Ü¬à K=¬âs s¬á3¬Ü s¬á5¬Ü¬ä,Ô¨Ånd the range of gain, K, for stability, instability, and the value of gain for marginal stability. For marginal stability also Ô¨Ånd the frequency of oscillation. Use the Nyquist criterion. SOLUTION: First set K¬à1 and sketch the Nyquist diagram for the system, using the contour shown in Figure 10.31( a). For all points on the imaginary axis, G jœâ¬ÜH jœâ¬Ü¬àK s s¬á3¬Ü s¬á5¬Ü/C12/C12/C12/C12 K¬à1 s¬àjœâ¬à 8œâ2 j 15œâ œâ3¬Ü 64œâ4¬áœâ2 15 œâ2¬Ü2(10.45) Atœâ¬à0;G jœâ¬ÜH jœâ¬Ü¬à  0:0356  j‚àû. Next Ô¨Ånd the point where the Nyquist diagram intersects the negative real axis. Setting the imaginary part of Eq. (10.45) equal to zero, we Ô¨Åndœâ¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 15p . Substituting this jœâ ‚Äì5 ‚Äì3‚Äì 0.0083‚Äì115Re ( )b ( )aIm s-plane = 0 + = 0 ‚Äì= ‚Äì‚àû= +‚àû = 0 += 0 ‚Äì =GH-plane œâ = ‚Äì‚àû œâœâ œâœâ = +‚àû œâ œâœâ œÉ FIGURE 10.31 a.Contour for Example 10.6; b.Nyquist diagram10.5 Stability via the Nyquist Diagram 561WEBC10 10/28/2014 18:16:39 Now that we have used the Nyquist diagram to determine stability, we can develop a simpli Ô¨Åed approach that uses only the mapping of the positive jœâ-axis. Stability via Mapping Only the Positive jœâ-Axis Once the stability of a system is determined by the Nyquist criterion, continued evaluation of the system can be simpli Ô¨Åed by using just the mapping of the positive jœâ-axis. This concept plays a major role in the next two sections, where we discuss stability margin and the implementation of the Nyquist criterion with Bode plots. Consider the system shown in Figure 10.32, which is stable at low values of gain and unstable at high values of gain. Since the contour does not encircle open-loop poles, the Nyquist criterion tells us that we must have no encirclements of  1 for the system to be stable. We can see from the Nyquist diagram that the encirclements of the critical point canbe determined from the mapping of the positive jœâ-axis alone. If the gain is small, the mapping will pass to the right of  1, and the system will be stable. If the gain is high, the mapping will pass to the left of  1, and the system will be unstable. Thus, this system is stable for the range of loop gain, K, that ensures that the open-loop magnitude is less than unity at that frequency where the phase angle is 180 ¬∞(or, equivalently , 180 ¬∞). This statement is thus an alternative to the Nyquist criterion for this system. Now consider the system shown in Figure 10.33, which is unstable at low values of gain and stable at high values of gain. Since the contour encloses two open-loop poles, twocounterclockwise encirclements of the critical point are required for stability. Thus, for thiscase the system is stable if the open-loop magnitude is greater than unity at that frequency where the phase angle is 180 ¬∞(or, equivalently , 180 ¬∞). In summary, Ô¨Årst determine stability from the Nyquist criterion and the Nyquist diagram. Next, interpret the Nyquist criterion and determine whether the mapping of just thepositive imaginary axis should have a gain of less than or greater than unity at 180 ¬∞. If the Nyquist diagram crosses 180 ¬∞at multiple frequencies, determine the interpretation from the Nyquist criterion.value of œâback into Eq. (10.45) yields the real part of  0.0083. Finally, at œâ¬à‚àû, G jœâ¬ÜH jœâ¬Ü¬à G s¬ÜH s¬Üjs¬Æj‚àû¬à1= j‚àû¬Ü3¬à0¬Ä 270 ¬∞. From the contour of Figure 10.31( a),P¬à0; for stability Nmust then be equal to zero. From Figure 10.31( b), the system is stable if the critical point lies outside the contour N¬à0¬Ü, so that Z¬àP N¬à0. Thus, Kcan be increased by 1 =0:0083 ¬à120:5 before the Nyquist diagram encircles  1. Hence, for stability, K<120:5. For marginal stability K¬à120:5. At this gain the Nyquist diagram intersects  1, and the frequency of oscillation isÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 15p rad/s. ( ) ( )AContours-plane CBjœâ Root locusIm ReGH-plane A'B' C' ‚Äì1 abœÉ FIGURE 10.32 a.Contour and root locus of system that is stable for small gain and unstable for large gain;b.Nyquist diagram562 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:40 A CB A' B'C'Contourjœâ Root locusIm Re ‚Äì1s-plane GH-plane ( )b ( )aœÉ FIGURE 10.33 a.Contour and root locus of system that is unstable for small gain and stable for large gain; b.Nyquist diagram Example 10.7 Stability Design via Mapping Positive jœâ-Axis Stability Design via Mapping Positive jœâ-Axis PROBLEM: Find the range of gain for stability and instability, and the gain for marginal stability, for the unity feedba ck system shown in Figure 10.10, where G s¬Ü¬àK=¬â s2¬á2s¬á2¬Ü s¬á2¬Ü¬ä. For marginal stability, Ô¨Ånd the radian frequency of oscillation. Use the Nyquist criterion and the mapping of only the positive imaginary axis. SOLUTION: Since the open-loop poles are only in the left-half-plane, the Nyquist criterion tells us that we want no encirclements of  1 for stability. Hence, a gain less than unity at 180 ¬∞is required. Begin by letting K¬à1 and draw the portion of the contour along the positive imaginary axis as shown in Figure 10.34( a). In Figure 10.34(b ), the intersection with the negative real axis is found by letting s¬àjœâinG(s)H(s), setting the imaginary part equal to zero to Ô¨Ånd the frequency, and then substituting the frequency into the real part of G jœâ¬ÜH jœâ¬Ü. Thus, for any point on the positive imaginary axis, G jœâ¬ÜH jœâ¬Ü¬à1 s2¬á2s¬á2¬Ü s¬á2¬Ü/C12/C12/C12 s¬Æjœâ ¬à4 1 œâ2¬Ü jœâ 6 œâ2¬Ü 16 1 œâ2¬Ü2¬áœâ2 6 œâ2¬Ü2(10.46) Setting the imaginary part equal to zero, we Ô¨Åndœâ¬àÔ¨ÉÔ¨ÉÔ¨É 6p . Substituting this value back into Eq. (10.46) yields the real part,   1=20¬Ü¬à 1=20¬Ü¬Ä180 ¬∞. This closed-loop system is stable if the magnitude of the frequency response is less than unity at 180 ¬∞. Hence, the system is stable for K<20, unstable for K>20, and marginally stable for K¬à20. When the system is marginally stable, the radian frequency of oscillation isÔ¨ÉÔ¨ÉÔ¨É6p . ( )a ( )b‚Äì2 ‚Äì1jœâ Im ReGH-plane 1 20‚Äì1 4jContour 1 AB B' A's-plane œÉ œâ FIGURE 10.34 a.Portion of contour to be mapped for Example 10.7; b.Nyquist diagram of mapping of positive imaginary axis10.5 Stability via the Nyquist Diagram 563WEBC10 10/28/2014 18:16:40 10.6 Gain Margin and Phase Margin via the Nyquist Diagram Now that we know how to sketch and interpret a Nyquist diagram to determine a closed-loop system ‚Äôs stability, let us extend our discussion to concepts that will eventually lead us to the design of transient response characteristics via frequency response techniques. Using the Nyquist diagram, we de Ô¨Åne two quantitative measures of how stable a system is. These quantities are called gain margin andphase margin . Systems with greater gain and phase margins can withstand greater changes in system parameters before becoming unstable.In a sense, gain and phase margins can be qualitatively related to the root locus, in that systemswhose poles are farther from the imaginary axis have a greater degree of stability. In the last section, we discussed stability from the point of view of gain at 180 ¬∞phase shift. This concept leads to the following de Ô¨Ånitions of gain margin and phase margin: Gain margin, G M. The gain margin is the change in open-loop gain, expressed in decibels (dB), required at 180 ¬∞of phase shift to make the closed-loop system unstable. Phase margin, Œ¶M. The phase margin is the change in open-loop phase shift required at unity gain to make the closed-loop system unstable. These two de Ô¨Ånitions are shown graphically on the Nyquist diagram in Figure 10.35. A s s u m eas y s t e mt h a ti ss t a b l ei ft h e r ea r en oe n c i r c l e m e n t so f  1. Using Figure 10.35, let us focus on the deÔ¨Å nition of gain margin. Here a gain difference between the Nyquist diagram ‚Äôs crossing of the real axis at  1=aand the  1 critical point determines the proximity of the system to instability. Thus, if the gain of the system were multiplied by aunits, the Nyquist diagram would intersect the critical point. We then say that the gain margin is aunits, or, expressed in dB, GM¬à20 log a. Notice that the gain margin is the reciprocal of the real-axis crossing expressed in dB. In Figure 10.35, we also see the phase margin graphically displayed. At point Q¬¥, where the gain is unity, arepresents the system ‚Äôs proximity to instability. That is, at unity gain, if a phase shift of Œ±degrees occurs, the system becomes unstable. Hence, the amount of phase margin is Œ±. Later in the chapter, we show that phase margin can be related to the damping ratio. Thus, we will be able to relate frequency response characteristics toSkill-Assessment Exercise 10.4 PROBLEM: For the system shown in Figure 10.10, where G s¬Ü¬àK s¬á2¬Ü s¬á4¬Ü s¬á6¬Ü do the following: a.Plot the Nyquist diagram. b.Use your Nyquist diagram to Ô¨Ånd the range of gain, K, for stability. ANSWERS: a.See the answer at www.wiley.com/college/nise . b.Stable for K<480 The complete solution is at www.wiley.com/college/nise .564 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:41 transient response characteristics as well as stability. We will also show that the calculations of gain and phase margins are more convenient if Bode plots are usedrather than a Nyquist diagram, such as that shown in Figure 10.35. For now, let us look at an example that shows the calculation of the gain and phase margins.‚Äì 1‚Äì1a 1Nyquist diagramUnit circleIm Gain margin = GM = 20 log a Phase margin = Œ¶M = Œ±Gain difference before instabilityPhase difference before instabilityGH-plane Re Q'Œ± FIGURE 10.35 Nyquist diagram showing gain and phase margins Example 10.8 Finding Gain and Phase MarginsFinding Gain and Phase Margins PROBLEM: Find the gain and phase margin for the system of Example 10.7 if K¬à6. SOLUTION: ToÔ¨Ånd the gain margin, Ô¨ÅrstÔ¨Ånd the frequency where the Nyquist diagram crosses the negative real axis. Finding G jœâ¬ÜH jœâ¬Ü, we have G jœâ¬ÜH jœâ¬Ü¬à6 s2¬á2s¬á2¬Ü s¬á2¬Ü/C12/C12/C12/C12 s¬Æjœâ ¬à6¬â4 1 œâ2¬Ü jœâ 6 œâ2¬Ü¬ä 16 1 œâ2¬Ü2¬áœâ2 6 œâ2¬Ü2(10.47) The Nyquist diagram crosses the real axis at a frequency ofÔ¨ÉÔ¨ÉÔ¨É 6p rad/s. The real part is calculated to be  0.3. Thus, the gain can be increased by 1=0:3¬Ü¬à3:33 before the real part becomes  1. Hence, the gain margin is GM¬à20 log 3: 33¬à10:45 dB (10.48) ToÔ¨Ånd the phase margin, Ô¨Ånd the frequency in Eq. (10.47) for which the magnitude is unity. As the problem stands, this calculation requires computational tools, such as a function solver or the program described in Appendix H.2. Later in the chapter we will simplify the process by using Bode plots. Equation (10.47) has unity gain at a frequency of 1.253 rad/s. At this frequency, the phase angle is  112:3¬∞. The difference between this angle and  180 ¬∞is 67:7¬∞, which is the phase margin.10.6 Gain Margin and Phase Margin via the Nyquist Diagram 565WEBC10 10/28/2014 18:16:41 In this section, we deÔ¨Å ned gain margin and phase margin and calculated them via the Nyquist diagram. In the next section, we show how to use Bode diagrams to implement the stability calculations perf ormed in Sections 10.5 and 10.6 using the Nyquist diagram. We will see that the Bode plots reduce the time and simplify the calculations required to obtain results. 10.7 Stability, Gain Margin, and Phase Margin via Bode Plots In this section, we determine stability, gain and phase margins, and the range of gainrequired for stability. All of these topics were covered previously in this chapter, usingNyquist diagrams as the tool. Now we use Bode plots to determine these characteristics. Bode plots are subsets of the complete Nyquist diagram but in another form. They are a viable alternative to Nyquist plots, since they are easily drawn without the aid of thecomputational devices or long calculations required for the Nyquist diagram and root locus.You should remember that all calculations applied to stability were derived from and basedupon the Nyquist stability criterion. The Bode plots are an alternate way of visualizing andimplementing the theoretical concepts. Determining Stability Let us look at an example and determine the stability of a system, implementing the Nyquiststability criterion using Bode plots. We will draw a Bode log-magnitude plot and thenStudents who are using MATLAB should now run ch10p3 in Appendix B.You will learn how to use MATLAB to Ô¨Ånd gain margin, phase margin, zero dB frequency, and 180 ¬∞frequency. This exercise solves Exam- ple 10.8 using MATLAB. MATLAB ‚Äôs LTI Viewer, with the Nyquist diagram selected, is another method that may be used to Ô¨Ånd gain margin, phase margin, zero dB frequency, and 180 ¬∞frequency. You are encouraged to study Appendix E, at www.wiley.com/college/nise , which contains a tutorial on the LTI Viewer as well as some examples. Example E.2solves Example 10.8 using the LTI Viewer. Skill-Assessment Exercise 10.5 PROBLEM: Find the gain margin and the 180 ¬∞frequency for the problem in Skill-Assessment Exercise 10.4 if K¬à100. ANSWERS: Gain margin ¬à13:62 dB; 180 ¬∞frequency ¬à6:63 rad/s The complete solution is at www.wiley.com/college/nise .TryIt 10.3 Use MATLAB, the Control System Toolbox, and the following statements to Ô¨Ånd the gain and phase margins of G(s)H(s)= 100/[( s+2)(s+4)(s+6)] using the Nyquist diagram. G=zpk( [] , [ ‚Äì2,‚Äì4,‚Äì6] ,100) nyquist(G)After the Nyquist diagram appears: Right-click in the graph area. Select Characteristics . Select All Stability Margins . Let the mouse rest on the margin points to read the gain and phase margins.566 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:42 determine the value of gain that ensures that the magnitude is less than 0 dB (unity gain) at that frequency where the phase is 180 ¬∞. Example 10.9 Range of Gain for Stability via Bode PlotsRange of Gain for Stability via Bode Plots PROBLEM: Use Bode plots to determine the range of Kwithin which the unity feedback system shown in Figure 10.10 is stable. Let G s¬Ü¬àK=¬â s¬á2¬Ü s¬á4¬Ü s¬á5¬Ü¬ä. SOLUTION: Since this system has all of its open-loop poles in the left-half-plane, the open-loop system is stable. Hence, from the discussion of Section 10.5, the closed-loop system will be stable if the frequency response has a gain less than unity when the phaseis 180 ¬∞. Begin by sketching the Bode magnitude and phase diagrams shown in Figure 10.36. In Section 10.2, we summed normalized plots of each factor of G(s) to create the Bode plot. We saw that at each break frequency, the slope of the resultant Bode plot changed byan amount equal to the new slope that was added. Table 10.6 demonstrates this observation. In this example, we use this fact to draw the Bode plots faster by avoiding the sketching of the response of each term. The low-frequency gain of G(s)H(s) is found by setting sto zero. Thus, the Bode magnitude plot starts at K=40. For convenience, let K¬à40 so that the log-magnitude plot starts at 0 dB. At each break frequency, 2, 4, and 5, a 20 dB/decade increase in negativeslope is drawn, yielding the log-magnitude plot shown in Figure 10.36. The phase diagram begins at 0 ¬∞until a decade below the Ô¨Årst break frequency of 2 rad/s. At 0.2 rad/s the curve decreases at a rate of  45 ¬∞/decade, decreasing an additional‚Äì20 ‚Äì4020 log 40 M‚Äì60 ‚Äì80 ‚Äì100 0.01 100 10 0.1 1 Frequency (rad/s) Frequency (rad/s)0.01 100 10 0.1 10 ‚Äì120Phase (degrees)0 ‚Äì270‚Äì225‚Äì180‚Äì135‚Äì90‚Äì45‚Äì20 dB/dec ‚Äì40 dB/dec ‚Äì60 dB/dec ‚Äì45¬∞/dec ‚Äì90¬∞/dec ‚Äì135¬∞/dec‚Äì90¬∞/dec ‚Äì45¬∞/dec FIGURE 10.36 Bode log-magnitude and phase diagrams for the system of Example 10.910.7 Stability, Gain Margin, and Phase Margin via Bode Plots 567WEBC10 10/28/2014 18:16:42 Evaluating Gain and Phase Margins Next we show how to evaluate the gain and phase margins by using Bode plots (Figure 10.37). The gain margin is found by using the phase plot to Ô¨Ånd the frequency, œâGM, where the phase angle is 180 ¬∞. At this frequency, we look at the magnitude plot to determine the gain margin, GM, which is the gain required to raise the magnitude curve to 0 dB. To illustrate, in the previous example with K¬à40, the gain margin was found to be 20 dB. The phase margin is found by using the magnitude curve to Ô¨Ånd the frequency, œâŒ¶M, where the gain is 0 dB. On the phase curve at that frequency, the phase margin, Œ¶M, is the difference between the phase value and 180 ¬∞.45¬∞/decade at each subsequent frequency (0.4 and 0.5 rad/s) a decade below each break. At a decade above each break frequency, the slopes are reduced by 45 ¬∞=decade at each frequency. The Nyquist criterion for this example t ells us that we want zero encirclements of  1 for stability. Thus, we recognize that the Bode log-magnitude plot must be less than unity when the Bode phase plot is 180 ¬∞. Accordingly, we see that at a frequency of 7r a d / s ,w h e nt h ep h a s ep l o ti s  180 ¬∞, the magnitude plot is  20 dB. Therefore, an increase in gain of +20 dB is possible before the system becomes unstable. Since the gain plot was scaled for a gain of 40, +20 dB (a gain of 10) represents the required increase in gain above 40. Hence, the gain for instability is 40 10¬à400. The Ô¨Ånal result is 0 <K<400 for stability. This result, obtained by approximating the frequency response by Bode asymptotes, can be compared to the result obtained from the actual frequency response, which yields again of 378 at a frequency of 6.16 rad/s. Students who are using MATLAB should now run ch10p4 in Appendix B.You will learn how to use MATLAB to Ô¨Ånd the range of gain for stability via frequency response methods. This exercise solvesExample 10.10 using MATLAB. 0 dBGain plot log œâ log œâ 180¬∞Phase (degrees)Phase plot MGMM (dB) wGMw MŒ¶ œâŒ¶ œâ FIGURE 10.37 Gain and phase margins on the Bode diagrams568 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:43 Skill-Assessment Exercise 10.6 PROBLEM: For the system shown in Figure 10.10, where G s¬Ü¬àK s¬á5¬Ü s¬á20¬Ü s¬á50¬Ü do the following: a.Draw the Bode log-magnitude and phase plots. b.Find the range of Kfor stability from your Bode plots. c.Evaluate gain margin, phase margin, zero dB frequency, and 180 ¬∞frequency from your Bode plots for K¬à10;000. ANSWERS: a.See the answer at www.wiley.com/college/nise . b.K<96;270 c.Gain margin ¬à19:67 dB, phase margin ¬à92:9¬∞, zero dB frequency ¬à7:74 rad/s, and 180 ¬∞frequency ¬à36:7 rad/s The complete solution is at www.wiley.com/college/nise .Example 10.10 Gain and Phase Margins from Bode PlotsGain and Phase Margins from Bode Plots PROBLEM: IfK¬à200 in the system of Example 10.9, Ô¨Ånd the gain margin and the phase margin. SOLUTION: The Bode plot in Figure 10.36 is scaled to a gain of 40. If K¬à200 ( Ô¨Åve times as great), the magnitude plot would be 20 log 5 ¬à13:98 dB higher. ToÔ¨Ånd the gain margin, look at the phase plot and Ô¨Ånd the frequency where the phase is 180 ¬∞. At this frequency, determine from the magnitude plot how much the gain can be increased before reaching 0 dB. In Figure 10.36, the phase angle is 180 ¬∞at approximately 7 rad/s. On the magnitude plot, the gain is  20¬á13:98¬à 6:02 dB. Thus, the gain margin is 6.02 dB. ToÔ¨Ånd the phase margin, we look on the magnitude plot for the frequency where the gain is 0 dB. At this frequency, we look on the phase plot to Ô¨Ånd the difference between the phase and 180 ¬∞. This difference is the phase margin. Again, remembering that the magnitude plot of Figure 10.36 is 13.98 dB lower than the actual plot, the 0 dB crossing ( 13.98 dB for the normalized plot shown in Figure 10.36) occurs at 5.5 rad/s. At this frequency the phase angle is  165 ¬∞. Thus, the phase margin is  165 ¬∞   180 ¬∞¬Ü¬à15¬∞. MATLAB‚Äô s LTI Viewer, with Bode plots selected, is another method that may be used to Ô¨Ånd gain margin, phase margin, zero dB frequency, and 180 ¬∞frequency. You are encouraged to study Appendix E at www.wiley.com/college/nise , which contains a tutorial on the LTI Viewer as well as some examples. Example E.3 solves Example 10.10using the LTI Viewer. TryIt 10.4 Use MATLAB, the Control System Toolbox, and the following statements tosolve Skill-AssessmentExercise 10.6(c) using Bode plots. G=zpk( [] , ... [ 5, 20, 50] ,10000) bode(G) grid on After the Bode plot appears: Right-click in the graph area. Select Characteristics . Select All Stability Margins . Let the mouse rest on the margin points to read thegain and phase margins.10.7 Stability, Gain Margin, and Phase Margin via Bode Plots 569WEBC10 10/28/2014 18:16:43 We have seen that the open-loop frequency response curves can be used not only to determine whether a system is stable but to calculate the range of loop gain that will ensure stability. We have also seen how to calculate the gain margin and the phase marginfrom the Bode diagrams. Is it then possible to parallel the root locus technique and analyze and design systems for transient response using frequency response methods? We will begin to explore theanswer in the next section. 10.8 Relation Between Closed-Loop Transient and Closed-Loop Frequency Responses Damping Ratio and Closed-Loop Frequency Response In this section, we will show that a relationship exists between a system ‚Äôst r a n s i e n t response and its closed-loop frequency respon se. In particular, consider the second-order feedback control system of Figure 10.38, which we have been using sinceChapter 4, where we derived relationships between the closed-loop transientresponse and the poles of the clo sed-loop transfer function, C s¬Ü R s¬Ü¬àT s¬Ü¬àœâ2 n s2¬á2Œ∂œâns¬áœâ2 n(10.49) We now derive relationships between the transient response of Eq. (10.49) and characteristics of its frequency response. We de Ô¨Åne these characteristics and relate them to damping ratio, natural frequency, settling time, peak time, and rise time. In Section 10.10, we will show howto use the frequency response of the open-loop transfer function G s¬Ü¬àœâ2 n s s¬á2Œ∂œân¬Ü(10.50) shown in Figure 10.38, to obtain the same transient response characteristics. Let us now Ô¨Ånd the frequency response of Eq. (10.49), de Ô¨Åne characteristics of this response, and relate these characteristics to the transient response. Substituting s¬àjœâinto Eq. (10.49), we evaluate the magnitude of the closed-loop frequency response as M¬àjT jœâ¬Üj¬àœâ2 nÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Ô¨É œâ2 n œâ2¬Ü2¬á4Œ∂2œâ2nœâ2q (10.51) A representative sketch of the log plot of Eq. (10.51) is shown in Figure 10.39. We now show that a relationship exists be tween the peak value of the closed-loop magnitude response and the damping ratio. Squaring Eq. (10.51), differentiating with respect to œâ2, and setting the derivative equal to zero yields the maximum value of M,Mp, where Mp¬à1 2Œ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p (10.52) at a frequency, œâp,o f œâp¬àœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 2Œ∂2p (10.53)s(s + 2ùúÅœân)‚ÄìR(s) + E(s) C(s) n2œâ FIGURE 10.38 Second-order closed-loop system570 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:44 Since Œ∂is related to percent overshoot, we can plot Mpvs. percent overshoot. The result is shown in Figure 10.40. Equation (10.52) shows that the maximum magnitude on the frequency response curve is directly related to the damping ratio and, hence, the percent overshoot. Also notice from Eq. (10.53) that the peak frequency, œâp, is not the natural frequency. However, for low values of damping ratio, we can assume that the peak occurs at the natural frequency.Finally, notice that there will not be a peak at frequencies above zero if Œ∂>0:707. This limiting value of Œ∂for peaking on the magnitude response curve should not be confused with overshoot on the step response, where there is overshoot for 0 <Œ∂<1. Response Speed and Closed-Loop Frequency Response Another relationship between the frequency response and time response is between thespeed of the time response (as measured by settling time, peak time, and rise time) and thebandwidth of the closed-loop frequency response. Bandwidth is de Ô¨Åned here as the frequency, œâ BW, at which the magnitude response curve is 3 dB down from its value at zero frequency (see Figure 10.39). The bandwidth of a two-pole system can be found by Ô¨Ånding that frequency for which M¬à1=Ô¨ÉÔ¨ÉÔ¨É 2p (that is,  3 dB) in Eq. (10.51). The derivation is left as an exercise for the student. The result is œâBW¬àœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 2Œ∂2¬Ü¬áÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 4Œ∂4 4Œ∂2¬á2pq (10.54)12345678 0 1 02 03 04 05 06 07 08 0 Percent overshootMp FIGURE 10.40 Closed-loop frequency response peak vs. percent overshoot for a two-pole system‚Äì20‚Äì15‚Äì10‚Äì5510 0 ‚Äì3 log plog BW Log-frequenc y (rad/s)Magnitude (dB)20 log Mp œâ œâFIGURE 10.39 Representa- tive log-magnitude plot of Eq. (10.51)10.8 Relation Between Closed-Loop Transient and Closed-Loop Frequency Responses 571WEBC10 10/28/2014 18:16:44 To relate œâBWto settling time, we substitute œân¬à4=TsŒ∂, derived from Eq. (4.42), into Eq. (10.54) and obtain œâBW¬à4 TsŒ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 2Œ∂2¬Ü¬áÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 4Œ∂4 4Œ∂2¬á2qr (10.55) Similarly, since œân¬àœÄ= TpÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬Ü, œâBW¬àœÄ TpÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2pÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 2Œ∂2¬Ü¬áÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 4Œ∂4 4Œ∂2¬á2qr (10.56) To relate the bandwidth to rise time, Tr, we use Figure 4.16, knowing the desired Œ∂andTr. For example, assume Œ∂¬à0:4 and Tr¬à0:2 second. Using Figure 4.16, the ordinate Trœân¬à1:463, from which œân¬à1:463=0:2¬à7:315 rad/s. Using Eq. (10.54), œâBW¬à10:05 rad/s. Normalized plots of Eqs. (10.55) and (10.56) and the relationship between bandwidth normalized by rise time and damping ratio are shown in Figure 10.41.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 11.51.61.71.81.922.12.2 Damping ratio0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1020406080100120140 44.555.566.57 Damping ratio Damping ratioœâBWTs (c)(a)( b)œâBWTpœâBWTr0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 FIGURE 10.41 Normalized bandwidth vs. damping ratio for a.settling time; b.peak time; c.rise time Skill-Assessment Exercise 10.7 PROBLEM: Find the closed-loop bandwidth required for 20% overshoot and 2-seconds settling time. ANSWER: œâBW¬à5:79 rad/s The complete solution is at www.wiley.com/college/nise .572 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:45 In this section, we related the closed-loop transient response to the closed-loop frequency response via bandwidth. We continue by relating the closed-loop frequency response to the open-loop frequency response and explaining the impetus. 10.9 Relation Between Closed- and Open-Loop Frequency Responses At this point, we do not have an easy way of Ô¨Ånding the closed-loop frequency response from which we could determine Mpand thus the transient response.2As we have seen, we are equipped to rapidly sketch the open-loop frequency response but not the closed-loopfrequency response. However, if the open-loop response is related to the closed-loop response, we can combine the ease of sketching the open-loop response with the transient response information contained in the closed-loop response. Constant MCircles and Constant NCircles Consider a unity feedback system whose closed-loop transfer function is T s¬Ü¬àG s¬Ü 1¬áG s¬Ü(10.57) The frequency response of this closed-loop function is T jœâ¬Ü¬àG jœâ¬Ü 1¬áG jœâ¬Ü(10.58) Since G jœâ¬Üis a complex number, let G jœâ¬Ü¬à P œâ¬Ü¬á jQ œâ¬Üi nE q .( 1 0 . 5 8 ) ,w h i c h yields T jœâ¬Ü¬àP œâ¬Ü¬á jQ œâ¬Ü ¬âP œâ¬Ü¬á1 ¬Ü ¬á jQ œâ¬Ü¬ä(10.59) Therefore, M2¬àjT2 jœâ¬Üj¬àP2 œâ¬Ü¬á Q2 œâ¬Ü ¬âP œâ¬Ü¬á 1 ¬Ü2¬áQ2 œâ¬Ü¬ä(10.60) Equation (10.60) can be put into the form P¬áM2 M2 1/C18/C19 2 ¬áQ2¬àM2 M2 1¬Ü2(10.61) which is the equation of a circle of radius M= M2 1¬Ücentered at ¬â M2= M2 1¬Ü;0¬ä. These circles, shown plotted in Figure 10.42 for various values of M, are called constant M circles and are the locus of the closed-loop magnitude frequency response for unity feedbacksystems. Thus, if the polar frequency response of an open-loop function, G(s), is plotted and superimposed on top of the constant Mcircles, the closed-loop magnitude frequency response is determined by each intersection of this polar plot with the constant Mcircles. 2At the end of this subsection, we will see how to use MATLAB to obtain closed-loop frequency responses.10.9 Relation Between Closed- and Open-Loop Frequency Responses 573WEBC10 10/28/2014 18:16:45 Before demonstrating the use of the constant Mcircles with an example, let us go through a similar development for the closed-loop phase plot, the constant Ncircles. From Eq. (10.59), the phase angle, œï, of the closed-loop response is œï¬àtan 1Q œâ¬Ü P œâ¬Ü tan 1Q œâ¬Ü P œâ¬Ü¬á 1 ¬àtan 1Q œâ¬Ü P œâ¬Ü Q œâ¬Ü P œâ¬Ü¬á 1 1¬áQ œâ¬Ü P œâ¬ÜQ œâ¬Ü P œâ¬Ü¬á 1/C18/C19(10.62) after using tan Œ± Œ≤¬Ü¬à tanŒ± tanŒ≤¬Ü= 1¬átanŒ±tanŒ≤¬Ü. Dropping the functional notation, tanœï¬àN¬àQ P2¬áP¬áQ2(10.63) Equation (10.63) can be put into the form of a circle, P¬á1 2/C18/C192 ¬áQ 1 2N/C18/C192 ¬àN2¬á1 4N2(10.64) which is plotted in Figure 10.43 for various values of N. The circles of this plot are called constant N circles . Superimposing a unity feedback, open-loop frequency response over the constant Ncircles yields the closed-loop phase response of the system. Let us now look at an example of the use of the constant MandNcircles.Im Re ‚Äì2‚Äì112 12 ‚Äì1 ‚Äì2 ‚Äì3 ‚Äì40.6 0.5M = 0.7M = 1.3 1.4 1.5G-planeM = 1.0 0.42.01.6 1.8 FIGURE 10.42 Constant Mcircles574 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:45 Im Re 12 ‚Äì1 ‚Äì2 ‚Äì33 2 1 ‚Äì1 ‚Äì2 ‚Äì3œï = 20¬∞ 50¬∞40¬∞25¬∞G-plane 70¬∞ ‚Äì70¬∞‚Äì70¬∞ ‚Äì50¬∞‚Äì50¬∞‚Äì70¬∞ ‚Äì50¬∞30¬∞ ‚Äì25¬∞‚Äì30¬∞ ‚Äì20¬∞‚Äì4 0 ¬∞ FIGURE 10.43 Constant Ncircles Example 10.11 Closed-Loop Frequency Response from Open-Loop Frequency ResponseClosed-Loop Frequency Response from Open-LoopFrequency Response PROBLEM: Find the closed-loop frequency response of the unity feedback system shown in Figure 10.10, where G s¬Ü¬à50=¬âs s¬á3¬Ü s¬á6¬Ü¬ä, using the constant Mcircles, Ncircles, and the open-loop polar frequency response curve. SOLUTION: First evaluate the open-loop frequency function and make a polar frequency response plot superimposed over the constant MandNcircles. The open-loop frequency function is G jœâ¬Ü¬à50  9œâ2¬áj 18œâ œâ3¬Ü(10.65) from which the magnitude, jG jœâ¬Üj, and phase, ¬ÄG jœâ¬Ü, can be found and plotted. The polar plot of the open-loop frequency response (Nyquist diagram) is shown superimposed over the MandNcircles in Figure 10.44.10.9 Relation Between Closed- and Open-Loop Frequency Responses 575WEBC10 10/28/2014 18:16:46 The closed-loop magnitude frequency response can now be obtained by Ô¨Ånding the intersection of each point of the Nyquist plot with the Mcircles. The closed-loop phase response can be obtained by Ô¨Ånding the intersection of each point of the Nyquist plot with theNcircles. The result is shown in Figure 10.45.3 Students who are using MATLAB should now run ch10p5 in Appendix B. You will learn how to use MATLAB to Ô¨Ånd the closed-loop frequency response. This exercise solves Example 10.11 using MATLAB.‚Äì1.0 ‚Äì0.8 ‚Äì0.2 0.2 0 0.4 0.6 0.8 1.0 1.2j0.2 ‚Äìj0.2 ‚Äìj0.4 ‚Äìj0.6 ‚Äìj0.8 ‚Äìj1.0 ‚Äìj1.2 ‚Äìj1.4 ‚Äìj1.8‚Äìj1.6œâ = 0.8 œâ = 0.9 œâ = 1 œâ = 1.3 œâ = 1.5 œâ = 1.7 œâ = 2œâ = 3œâ = 3.5 œâ = 2.5œâ = 5œâ = 4.2Im Re ‚Äì0.6 ‚Äì0.4 FIGURE 10.45 Closed- loop frequency response for Example 10.11Im Re 12 ‚Äì1 ‚Äì33 2 1 ‚Äì1 ‚Äì2 ‚Äì350¬∞ ‚Äì4 ‚Äì20.6 0M = 1.0 040¬∞ 0.5M = 0.725¬∞ M = 1.3 1.4 1.5G-plane 1.0 œâ = 0.870¬∞30¬∞ 0.4 ‚Äì20¬∞‚Äì25¬∞‚Äì30¬∞‚Äì4 0 ¬∞1.6 1.8 2.0 1.52.02.53.5 3.0 ‚Äì70¬∞ ‚Äì50¬∞œï = 20¬∞ FIGURE 10.44 Nyquist diagram for Example 10.11 and constant MandN circles 3You are cautioned not to use the closed-loop polar plot for the Nyquist criterion. The closed-loop frequency response, however, can be used to determine the closed-loop transient response, as discussed in Section 10.8.576 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:46 Nichols Charts A disadvantage of using the MandNcircles is that changes of gain in the open-loop transfer function, G(s), cannot be handled easily. For example, in the Bode plot, a gain change is handled by moving the Bode magnitude curve up or down an amount equal to the gain change in dB. Since the MandNcircles are not dB plots, changes in gain require each point ofG jœâ¬Üto be multiplied in length by the increase or decrease in gain. Another presentation of the Mand Ncircles, called a Nichols chart ,d i s p l a y s the constant Mcircles in dB, so that changes in gain are as simple to handle as in the Bode plot. A Nichols chart is shown in Figure 10.46. The chart is a plot of open-loopmagnitude in dB vs. open-loop phase angle in degrees. Every point on the Mcircles can be transferred to the Nichols chart. Each point on the constant Mcircles is represented by magnitude and angle (polar coordinates). Converting the magnitude to dB, we cantransfer the point to the Nichols chart, using the polar coordinates with magnitude in dBplotted as the ordinate, and the phase angle plotted as the abscissa. Similarly, the Ncircles also can be transferred to the Nichols chart. For example, assume the function G s¬Ü¬à K s s¬á1¬Ü s¬á2¬Ü(10.66) Superimposing the frequency response of G(s) on the Nichols chart by plotting magnitude in dB vs. phase angle for a range of frequencies from 0.1 to 1 rad/s, we obtain the plotin Figure 10.47 for K¬à1. If the gain is increased by 10 dB, simply raise the curve for K¬à1 by 10 dB and obtain the curve for K¬à3:16 10 dB ¬Ü. The intersection of the plots of G jœâ¬Üwith the Nichols chart yields the frequency response of the closed-loop system. Students who are using MATLAB should now run ch10p6 in Appendix B.You will learn how to use MATLAB to make a Nichols plot. Thisexercise makes a Nichols plot of G s¬Ü¬à1=¬âs s¬á1¬Ü s¬á2¬Ü¬äusing MATLAB. MATLAB ‚Äôs LTI Viewer is an alternative method of obtaining the Nichols chart. You are encouraged to study Appendix E at www.wiley .com/college/nise, which contains a tutorial on the LTI Viewer aswell as some examples. Example E.4 shows how to obtain Figure 10.47using the LTI Viewer. 0.5 ‚Äì15‚Äì10‚Äì50510152025 ‚Äì280 ‚Äì260 ‚Äì240 ‚Äì220 ‚Äì200 ‚Äì180 ‚Äì160 ‚Äì140 ‚Äì120 ‚Äì100 ‚Äì80 Phase (degrees)Magnitude (dB)0.707421.61.41.21.1 ‚Äì300¬∞‚Äì340¬∞ ‚Äì320¬∞‚Äì40¬∞‚Äì20¬∞ ‚Äì60¬∞‚Äì5¬∞ ‚Äì10¬∞ ‚Äì80¬∞ ‚Äì220¬∞ ‚Äì90¬∞ ‚Äì140¬∞ ‚Äì160¬∞ ‚Äì100¬∞ ‚Äì120¬∞ ‚Äì270¬∞‚Äì260¬∞ ‚Äì200¬∞ ‚Äì240¬∞ ‚Äì180¬∞‚Äì280¬∞‚Äì355¬∞ 1.0 0.3 FIGURE 10.46 Nichols chart10.9 Relation Between Closed- and Open-Loop Frequency Responses 577WEBC10 10/28/2014 18:16:47 10.10 Relation Between Closed-Loop Transient and Open-Loop Frequency Responses Damping Ratio From MCircles We can use the results of Example 10.11 to estimate the transient response characteristics of the system. We can Ô¨Ånd the peak of the closed-loop frequency response by Ô¨Ånding the maximum Mcurve tangent to the open-loop frequency response. Then we can Ô¨Ånd the damping ratio, Œ∂, and subsequently the percent overshoot, via Eq. (10.52). The following example demonstrates the use of the open-loop frequency response and the Mcircles to Ô¨Ånd the damping ratio or, equivalently, the percent overshoot. Example 10.12 Percent Overshoot from Open-Loop Frequency ResponsePercent Overshoot from Open-Loop Frequency Response PROBLEM: Find the damping ratio and the percent overshoot expected from the system of Example 10.11, using the open-loop frequency response and the Mcircles.0.5œâ =.1 ‚Äì15‚Äì10‚Äì50510152025 ‚Äì280 ‚Äì260 ‚Äì240 ‚Äì220 ‚Äì200 ‚Äì180 ‚Äì160 ‚Äì140 ‚Äì120 ‚Äì100 ‚Äì80 Phase (degrees)Magnitude (dB)0.707K=3.16 K=1œâ =.1 œâ = 1œâ = 1421.61.41.21.1 ‚Äì300¬∞‚Äì40¬∞1.0 ‚Äì270¬∞ ‚Äì90¬∞‚Äì20¬∞ ‚Äì60¬∞‚Äì5¬∞ ‚Äì10¬∞ ‚Äì260¬∞ ‚Äì200¬∞ ‚Äì‚Äì140¬∞0.3 ‚Äì180¬∞ ‚Äì240¬∞ ‚Äì220¬∞ ‚Äì160¬∞ ‚Äì100¬∞ ‚Äì120¬∞‚Äì340¬∞‚Äì355¬∞ ‚Äì320¬∞ ‚Äì280¬∞ ‚Äì80¬∞FIGURE 10.47 Nichols chart with frequency response for G s¬Ü¬àK=¬âs s¬á1¬Ü s¬á2¬Ü¬ä superimoposed. Values forK¬à1 and K¬à3:16 are shown. Skill-Assessment Exercise 10.8 PROBLEM: Given the system shown in Figure 10.10, where G s¬Ü¬à8000 s¬á5¬Ü s¬á20¬Ü s¬á50¬Ü plot the closed-loop log-magnitude and phase frequency response plots using the following methods: a.MandNcircles b.Nichols chart ANSWER: The complete solution is at www.wiley.com/college/nise .TryIt 10.5 Use MATLAB, the Control System Toolbox, and the following statements to make a Nichols chart of the systemgiven in Skill-AssessmentExercise 10.8 G=zpk( [] , ... [ 5, 20, 50] ,8000) nichols(G) grid on578 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:47 So far in this section, we have tied together the system ‚Äôs transient response and the peak value of the closed-loop frequency response as obtained from the open-loop frequency response. We used the Nyquist plots and the MandNcircles to obtain the closed-loop transient response. Another association exists between the open-loop frequency responseand the closed-loop transient response that is easily implemented with the Bode plots,which are easier to draw than the Nyquist plots. Damping Ratio from Phase Margin Let us now derive the relationship between the phase margin and the damping ratio. Thisrelationship will enable us to evaluate the percent overshoot from the phase margin foundfrom the open-loop frequency response. Consider a unity feedback system whose open-loop function G s¬Ü¬à œâ2 n s s¬á2Œ∂œân¬Ü(10.68) yields the typical second-order, closed-loop transfer function T s¬Ü¬àœâ2n s2¬á2Œ∂œâns¬áœâ2 n(10.69) In order to evaluate the phase margin, we Ô¨ÅrstÔ¨Ånd the frequency for which jG jœâ¬Üj¬à1. Hence, jG jœâ¬Üj¬àœâ2 n j œâ2¬áj2Œ∂œânœâj¬à1 (10.70) The frequency, œâ1, that satis Ô¨Åes Eq. (10.70) is œâ1¬àœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É  2Œ∂2¬áÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1¬á4Œ∂4qr (10.71) The phase angle of G jœâ¬Üat this frequency is ¬ÄG jœâ¬Ü¬à   90 tan 1œâ1 2Œ∂œân ¬à 90 tan 1Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É  2Œ∂2¬áÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 4Œ∂4¬á1pq 2Œ∂(10.72)SOLUTION: Equation (10.52) shows that there is a unique relationship between the closed-loop system ‚Äôs damping ratio and the peak value, MP, of the closed-loop system ‚Äôs magnitude frequency plot. From Figure 10.44, we see that the Nyquist diagram is tangent to the 1.8 Mcircle. We see that this is the maximum value for the closed-loop frequency response. Thus, Mp¬à1:8. We can solve for Œ∂by rearranging Eq. (10.52) into the following form: Œ∂4 Œ∂2¬á 1=4M2 p¬Ü¬à0 (10.67) Since Mp¬à1:8, then Œ∂¬à0:29 and 0.96. From Eq. (10.53), a damping ratio larger than 0.707 yields no peak above zero frequency. Thus, we select Œ∂¬à0:29, which is equivalent to 38.6% overshoot. Care must be taken, however, to be sure we can make a second-order approximation when associating the value of percent overshoot to the value of Œ∂.A computer simulation of the step response shows 36% overshoot.10.10 Relation Between Closed-Loop Transient and Open-Loop Frequency Responses 579WEBC10 10/28/2014 18:16:48 The difference between the angle of Eq. (10.72) and  180 ¬∞is the phase margin, œïM. Thus, Œ¶M¬à90 tan 1Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É  2Œ∂2¬áÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1¬á4Œ∂4pq 2Œ∂ ¬àtan 12Œ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É  2Œ∂2¬áÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1¬á4Œ∂4pq(10.73) Equation (10.73), plotted in Figure 10.48, shows the relationship between phase margin and damping ratio. As an example, Eq. (10.53) tells us that there is no peak frequency if Œ∂¬à0:707. Hence, there is no peak to the closed-loop magnitude frequency response curve forthis value of damping ratio and larger. Thus, from Figure 10.48, a phase margin of65:52¬∞ Œ∂¬à0:707¬Üor larger is required from the open-loop frequency response to ensure there is no peaking in the closed-loop frequency response. Response Speed from Open-Loop Frequency Response Equations (10.55) and (10.56) relate the closed-loop bandwidth to the desired settling orpeak time and the damping ratio. We now show that the closed-loop bandwidth can beestimated from the open-loop frequency response. From the Nichols chart in Figure 10.46,we see the relationship between the open-loop gain and the closed-loop gain. TheM¬à0:707  3d B¬Ücurve, replotted in Figure 10.49 for clarity, shows the open-loop gain when the closed-loop gain is  3 dB. This relationship typically occurs at œâ BWif the low-frequency closed-loop gain is 0 dB. We can approximate Figure 10.49 by saying that ‚Äì7‚Äì6‚Äì5‚Äì4‚Äì3‚Äì2‚Äì10 ‚Äì280 ‚Äì260 ‚Äì240 ‚Äì220 ‚Äì200 ‚Äì180 ‚Äì160 ‚Äì140 ‚Äì120 ‚Äì100 ‚Äì80 Open-loo p phase (de grees)Closed-loop magnitude = ‚Äì3 dBOpen-loop magnitude (dB) ‚Äì8FIGURE 10.49 Open-loop gain vs. open-loop phase angle for 3 dB closed-loop gain10 02030405060708090 0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0 Damping ratioPhase margin (degrees) FIGURE 10.48 Phase margin vs. damping ratio580 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:48 the closed-loop bandwidth, œâBW(the frequency at which the closed-loop magnitude response is  3 dB), equals the frequency at which the open-loop magnitude response is between  6 and  7:5 dB if the open-loop phase response is between  135 ¬∞and 225 ¬∞. Then, using a second-order system approximation, Eqs. (10.55) and (10.56) can be used, along with the desired damping ratio, Œ∂,t oÔ¨Ånd settling time and peak time, respectively. Let us look at an example. Example 10.13 Settling and Peak Times from Open-Loop Frequency ResponseSettling and Peak Times from Open-Loop Frequency Response PROBLEM: Given the system of Figure 10.50( a) and the Bode diagrams of Figure 10.50( b), estimate the settling time and peak time. SOLUTION: Using Figure 10.50( b), we estimate the closed-loop bandwidth by Ô¨Ånding the frequency where the open-loop magnitude response is in the range of  6t o 7:5d B if the phase response is in the range of  135 ¬∞to 225 ¬∞. Since Figure 10.50( b) shows  6t o  7:5 dB at approximately 3.7 rad/s with a phase response in the stated region, œâBW¬Å3:7r a d / s . ( )aE(s) 50 s(s + 3)(s + 6)C(s) R(s)+ ‚Äì 10 6 2 ‚Äì2 ‚Äì6 ‚Äì10‚Äì14‚Äì18‚Äì22‚Äì26‚Äì30 12 3 4 5 6 7 8 910 Frequency (rad/s)20 log M ‚Äì100 ‚Äì120‚Äì140‚Äì160‚Äì180‚Äì200‚Äì220‚Äì240Phase (degrees) 12 3 4 5 6 7 8 910 Frequency (rad/s) ( )b FIGURE 10.50 a.Block diagram; b.Bode diagrams for system of Example 10.1310.10 Relation Between Closed-Loop Transient and Open-Loop Frequency Responses 581WEBC10 10/28/2014 18:16:49 10.11 Steady-State Error Characteristics from Frequency Response In this section, we show how to use Bode diagrams to Ô¨Ånd the values of the static error constants for equivalent unity feedback systems: Kpfor a Type 0 system, Kvfor a Type 1 system, and Kafor a Type 2 system. The results will be obtained from unnormalized and unscaled Bode log-magnitude plots. Position Constant ToÔ¨ÅndKp, consider the following Type 0 system: G s¬Ü¬àK‚àèn i¬à1 s¬ázi¬Ü ‚àèm i¬à1 s¬ápi¬Ü(10.74) A typical unnormalized and unscaled Bode log-magnitude plot is shown in Figure 10.51( a). The initial value is 20 log M¬à20 log K‚àèn i¬à1zi ‚àèm i¬à1pi(10.75)Skill-Assessment Exercise 10.9 PROBLEM: Using the open-loop frequency response for the system in Figure 10.10, where G s¬Ü¬à100 s s¬á5¬Ü estimate the percent overshoot, settling time, and peak time for the closed-loop step response. ANSWERS: %OS¬à44%;Ts¬à1:64 s;andTP¬à0:33 s The complete solution is at www.wiley.com/college/nise .Next Ô¨ÅndŒ∂via the phase margin. From Figure 10.50( b), the phase margin is found by Ô¨ÅrstÔ¨Ånding the frequency at which the magnitude plot is 0 dB. At this frequency, 2.2 rad/s, the phase is about  145 ¬∞. Hence, the phase margin is approximately  145 ¬∞   180 ¬∞¬Ü¬Ü ¬à35¬∞. Using Figure 10.48, Œ∂¬à0:32. Finally, using Eqs. (10.55) and (10.56), with the values of œâBWandŒ∂just found, Ts¬à4:86 seconds and Tp¬à129 seconds. Checking the analysis with a computer simulation shows Ts¬à5:5 seconds, and Tp¬à1:43 seconds.582 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:49 But for this system Kp¬àK‚àèn i¬à1zi ‚àèm i¬à1pi(10.76) which is the same as the value of the low-f requency axis. Thus, for an unnormalized and unscaled Bode log-magnitude plot, the low-frequency magnitude is 20 log Kpfor a Type 0 system. Velocity Constant ToÔ¨ÅndKvfor a Type 1 system, consider the following open-loop transfer function of a Type 1 system: G s¬Ü¬àK‚àèn i¬à1 s¬ázi¬Ü s‚àèm i¬à1 s¬ápi¬Ü(10.77) A typical unnormalized and unscaled Bode log-magnitude diagram is shown in Figure 10.51( b) for this Type 1 system. The Bode plot starts at 20 log M¬à20 log K‚àèn i¬à1zi œâ0‚àèm i¬à1pi(10.78) The initial  20 dB/decade slope can be thought of as originating from a function, G¬¥ s¬Ü¬àK‚àèn i¬à1zi s‚àèm i¬à1pi(10.79)20 log M 20 log Kp 0 ( )a20 log M 20 log K 0 ( )bi=1n i=10‚Äì20 dB/dec Kv 20 log M 0 ( )c‚Äì40 dB/dec Kam pi 20 log K i=10mpi2zi i=1n zi FIGURE 10.51 Typical unnormalized and unscaled Bode log-magnitude plots showing the value of static error constants: a.Type 0; b.Type 1; c.Type 210.11 Steady-State Error Characteristics from Frequency Response 583WEBC10 10/28/2014 18:16:50 G¬¥ s¬Üintersects the frequency axis when œâ¬àK‚àèn i¬à1zi ‚àèm i¬à1pi(10.80) But for the original system (Eq. (10.77)), Kv¬àK‚àèn i¬à1zi ‚àèm i¬à1pi(10.81) which is the same as the frequency-axis intercept, Eq. (10.80). Thus, we can Ô¨ÅndKvby extending the initial  20 dB/decade slope to the frequency axis on an unnormalized and unscaled Bode diagram. The intersection with the frequency axis is Kv. Acceleration Constant ToÔ¨ÅndKafor a Type 2 system, consider the following: G s¬Ü¬àK‚àèn i¬à1 s¬ázi¬Ü s2‚àèm i¬à1 s¬ápi¬Ü(10.82) A typical unnormalized and unscaled Bode plot for a Type 2 system is shown in Figure 10.51( c). The Bode plot starts at 20 log M¬à20 log K‚àèn i¬à1zi œâ2 0‚àèm i¬à1pi(10.83) The initial  40 dB/decade slope can be thought of as coming from a function, G¬¥ s¬Ü¬àK‚àèn i¬à1zi s2‚àèm i¬à1pi(10.84) G¬¥ s¬Üintersects the frequency axis when œâ¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É K‚àèn i¬à1zi ‚àèm i¬à1pivuuuuut(10.85) But for the original system (Eq. (10.82)), K a¬àK‚àèn i¬à1zi ‚àèm i¬à1pi(10.86) Thus, the initial  40 dB/decade slope intersects the frequency axis atÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Kap .584 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:50 Example 10.14 Static Error Constants from Bode PlotsStatic Error Constants from Bode Plots PROBLEM: For each unnormalized and unscaled Bode log-magnitude plot shown in Figure 10.52, a.Find the system type. b.Find the value of the appropriate static error constant. SOLUTION: Figure 10.52( a) is a Type 0 system, since the initial slope is zero. The value of Kpis given by the low-frequency asymptote value. Thus, 20 log Kp¬à25, or Kp¬à17:78. 30 25201510 5020 log M 0.1 1 10 Frequency (rad/s) (a) 15‚Äì5 ‚Äì25‚Äì45 ‚Äì65‚Äì85 ‚Äì10520 log M 0.1 1 10 Frequency (rad/s) (b)0 604020 0 ‚Äì20‚Äì40 ‚Äì6020 log M 0.1 1 10 Frequency (rad/s) (c)‚Äì40 dB/dec ‚Äì20 dB/dec ‚Äì40 dB/dec Zero dB crossing‚Äì20 dB/dec ‚Äì20 dB/dec Zero dB crossing ‚Äì40 dB/dec ‚Äì20 dB/dec FIGURE 10.52 Bode log-magnitude plots for Example 10.1410.11 Steady-State Error Characteristics from Frequency Response 585WEBC10 10/28/2014 18:16:51 10.12 Systems with Time Delay Time delay occurs in control systems when there is a delay between the commanded response and the start of the output response. For example, consider a heating systemthat operates by heating water for pipeline distribution to radiators at distant locations.Since the hot water must Ô¨Çow through the line, the radiators will not begin to get hot until after a speci Ô¨Åed time delay. In other words, the time between the command for more heat and the commencement of the rise in temperature at a distant location along the pipeline is the time delay. Notice that th is is not the same as the transient response or the time it takes the temperature to rise to the desired level. During the time delay, nothing is occurring at the output. Modeling Time Delay Assume that an input, R(s), to a system, G(s), yields an output, C(s). If another system, G¬¥ s¬Ü, delays the output by Tseconds, the output response is c t T¬Ü. From Table 2.2, Item 5, the Laplace transform of c t T¬Üise sTC s¬Ü. Thus, for the system without delay, C s¬Ü¬àR s¬ÜG s¬Ü, and for the system with delay, e sTC s¬Ü¬àR s¬ÜG¬¥ s¬Ü. Dividing theseSkill-Assessment Exercise 10.10 PROBLEM: Find the static error constants for a stable unity feedback system whose open-loop transfer function has the Bode magnitude plot shown in Figure 10.53. ANSWERS: Kp¬à‚àû;Kv¬à‚àû;Ka¬à90:25 The complete solution is www.wiley.com/college/nise .Figure 10.52( b) is a Type 1 system, since the initial slope is  20 dB/decade. The value of Kvis the value of the frequency that the initial slope intersects at the zero dB crossing of the frequency axis. Hence, Kv¬à0:55. Figure 10.52( c) is a Type 2 system, since the initial slope is  40 dB/decade. The value ofÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Kap is the value of the frequency that the initial slope intersects at the zero dB crossing of the frequency axis. Hence, Ka¬à32¬à9. 150 100 50 0 ‚Äì5020 log M 0.01 0.1 1 10 100 1000 Frequenc y (rad/s) FIGURE 10.53 Bode log-magnitude plot for Skill-Assessment Exercise 10.10586 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:51 two equations, G¬¥ s¬Ü=G s¬Ü¬àe sT. Thus, a system with time delay Tcan be represented in terms of an equivalent system without time delay as follows: G¬¥ s¬Ü¬àe sTG s¬Ü (10.87) The effect of introducing time delay into a system can also be seen from the perspective of the frequency response by substituting s¬àjœâin Eq. (10.87). Hence, G¬¥ jœâ¬Ü¬à e jœâTG jœâ¬Ü¬à jG jœâ¬Üj¬Äf œâT¬á¬ÄG jœâ¬Üg (10.88) In other words, the time delay does not affect the magnitude frequency response curve ofG jœâ¬Ü, but it does subtract a linearly increasing phase shift, œâT, from the phase frequency response plot of G jœâ¬Ü. The typical effect of adding time delay can be seen in Figure 10.54. Assume that the gain and phase margins as well as the gain- and phase-margin frequenciesshown in the Ô¨Ågure apply to the system without delay. From the Ô¨Ågure, we see that the r e d u c t i o ni np h a s es h i f tc a u s e db yt h ed e l a y reduces the phase margin. Using a second- order approximation, this reduction in phase margin yields a reduced damping ratio for the closed-loop system and a more oscillato ry response. The reduction of phase also leads to a reduced gain-margin frequency. From the magnitude curve, we can see that a reduced gain-margin frequency leads to reduced gain margin, thus moving the systemcloser to instability. An example of plotting frequency response curves for systems with delay follows.0 dB 180¬∞Gain plot GMM(dB) log œâlog œâ Phase (degrees) Phase plot with dela yPhase plot without delayGM Œ¶MŒ¶M œâ œâ FIGURE 10.54 Effect of delay upon frequency response Example 10.15 Frequency Response Plots of a System with Time DelayFrequency Response Plots of a System with Time Delay PROBLEM: Plot the frequency response for the system G s¬Ü¬àK=¬âs s¬á1¬Ü s¬á10¬Ü¬äif there is a time delay of 1 second through the system. Use the Bode plots. SOLUTION: Since the magnitude curve is not affected by the delay, it can be plotted by the methods previously covered in the chapter and is shown in Figure 10.55( a) forK¬à1.10.12 Systems with Time Delay 587WEBC10 10/28/2014 18:16:52 Let us now use the results of Example 10.15 to design stability and analyze transient response and compare the results to the system without time delay.The phase plot, however, is affected by the delay. Figure 10.55( b) shows the result. First draw the phase plot for the delay, e jœâT¬à1¬Ä œâT¬à1¬Ä œâ, since T¬à1 from the problem statement. Next draw the phase plot of the system, G jœâ¬Ü, using the methods previously covered. Finally, add the two phase curves together to obtain the total phase response for e jœâTG jœâ¬Ü. Be sure to use consistent units for the phase angles of G jœâ¬Üand the delay; either degrees or radians. Notice that the delay yields a decreased phase margin, since at any frequency the phase angle is more negative. Using a second-order approximation, this decrease inphase margin implies a lower damping ratio and a more oscillatory response for theclosed-loop system. Further, there is a decrease in the gain-margin frequency. On the magnitude curve, note that a reduction in the gain-margin frequency shows up as reduced gain margin, thusmoving the system closer to instability. Students who are using MATLAB should now run ch10p7 in Appendix B.You will learn how to use MATLAB to include time delay on Bode plots. You will also use MATLAB to make multiple plots on one graph and label the plots. This exercise solves Example 10.15using MATLAB. Example 10.16 Range of Gain for Stability for System with Time DelayRange of Gain for Stability for System with Time Delay PROBLEM: The open-loop system with time delay in Example 10.15 is used in a unity feedback con Ô¨Åguration. Do the following: a.Find the range of gain, K, to yield stability. Use Bode plots and frequency response techniques. b.Repeat Part afor the system without time delay.Time delaySystem Total20 0 ‚Äì20 ‚Äì40 ‚Äì60 ‚Äì8020 log M 0.1 1 10 0.01 Frequency (rad/s) (a) ‚Äì200 ‚Äì400 ‚Äì600 ‚Äì800Phase (degrees) 0.1 1 0.01 Frequency (rad/s) (b)0 10FIGURE 10.55 Frequency response plots for G s¬Ü¬àK=¬âs s¬á1¬Ü s¬á10¬Ü¬ä with a delay of 1 second andK¬à1:a.magnitude plot; b.phase plot588 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:53 SOLUTION: a.From Figure 10.55, the phase angle is  180 ¬∞at a frequency of 0.81 rad/s for the system with time delay, marked ‚ÄúTotal ‚Äùon the phase plot. At this frequency, the magnitude curve is at  20.39 dB. Thus, Kcan be raised from its current value of unity to 1020:39=20¬à10:46. Hence, the system is stable for 0 <K10:46. b.If we use the phase curve without delay, marked ‚ÄúSystem, ‚Äù 180 ¬∞occurs at a frequency of 3.16 rad/s, and Kcan be raised 40.84 dB or 110.2. Thus, without delay the system is stable for 0 <K110:2, an order of magnitude larger. Example 10.17 Percent Overshoot for System with Time DelayPercent Overshoot for System with Time Delay PROBLEM: The open-loop system with time delay in Example 10.15 is used in a unity feedback con Ô¨Åguration. Do the following: a.Estimate the percent overshoot if K¬à5. Use Bode plots and frequency response techniques. b.Repeat Part afor the system without time delay. SOLUTION: a.Since K¬à5, the magnitude curve of Figure 10.55 is raised by 13.98 dB. The zero dB crossing then occurs at a frequency of 0.47 rad/s with a phase angle of  145 ¬∞, as seen from the phase plot marked ‚ÄúTotal. ‚ÄùTherefore, the phase margin is  145 ¬∞   180 ¬∞¬Ü¬Ü ¬à35¬∞. Assuming a second-order approximation and using Eq. (10.73) or Figure 10.48, we Ô¨Ånd Œ∂¬à0:33. From Eq. (4.38), %OS¬à33%. The time response, Figure 10.56( a), shows a 38% overshoot instead of the predicted 33%. Notice the time delay at the start of the curve. b.The zero dB crossing occurs at a frequency of 0.47 rad/s with a phase angle of  118 ¬∞, as seen from the phase plot marked ‚ÄúSystem. ‚ÄùTherefore, the phase margin is  118 ¬∞   180 ¬∞¬Ü¬Ü ¬à62¬∞. Assuming a second-order approximation and usingc(t) 0.2 0 0 5 10 15 20 25 30 Time (seconds) (a)0.40.60.81.01.21.4 FIGURE 10.56 Step response for closed-loop system with G s¬Ü¬à5=¬âs s¬á1¬Ü s¬á10¬Ü¬ä: a.with a 1-second delay; (Ô¨Ågure continues )10.12 Systems with Time Delay 589WEBC10 10/28/2014 18:16:54 In summary, then, systems with time delay can be handled using previously described frequency response techniques if the phase response is adjusted to re Ô¨Çect the time delay. Typically, time delay reduces gain and phase margins, resulting in increased percent overshoot or instability in the closed-loop response.Eq. (10.73) or Figure 10.48, we Ô¨ÅndŒ∂¬à0:64. From Eq. (4.38), %OS¬à7:3%. The time response is shown in Figure 10.56( b). Notice that the system without delay has less overshoot and a smaller settling time.FIGURE 10.56 (Continued ) b.without delay c(t) 02468 1 00.2 00.40.60.81.01.2 2468 1 0 Time (seconds) (b) Skill-Assessment Exercise 10.11 PROBLEM: For the system shown in Figure 10.10, where G s¬Ü¬à10 s s¬á1¬Ü Ô¨Ånd the phase margin if there is a delay in the forward path of a.0s b.0.1 s c.3s ANSWERS: a.18.0 ¬∞ b.0.35 ¬∞ c. 151 :41¬∞ The complete solution is at www.wiley.com/college/nise .TryIt 10.6 Use MATLAB, the Control System Toolbox, and the followingstatements to solve Skill-AssessmentExercise 10.11. For each part of the problem let d¬àthe speci Ô¨Åed delay. G=zpk( [] ,[0,  1] ,10) d=0 [numGd,denGd] =pade... (d,12) Gd=tf(numGd,denGd) Ge=G*Gd bode(Ge)grid on After the Bode diagrams appear: Right-click in the graph area.2. Select Characteristics. Select All Stability Margins. Let the mouse rest on the margin point on the phase plot to read thephase margin.590 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:55 10.13 Obtaining Transfer Functions Experimentally In Chapter 4, we discussed how to obtain th e transfer function of a system through step-response testing. In this section, we show how to obta in the transfer function using sinusoidal frequency response data. The analytical determination of a system ‚Äôs transfer function can be difÔ¨Å cult. Individual component values may not be known, or the internal con Ô¨Åguration of the system may not be accessible. In such cases, the frequency response of the system, from input to output, can be obtained experiment a l l ya n du s e dt od e t e r m i n et h et r a n s f e r function. To obtain a frequency response plot experimentally, we use a sinusoidalforce or signal generator at the input to the system and measure the output steady-statesinusoid amplitude and phase angle (see Figure 10.2). Repeating this process at a numberof frequencies yields data for a frequency response plot. Referring to Figure 10.2( b), the amplitude response is M œâ¬Ü¬àM o œâ¬Ü=Mi œâ¬Ü, and the phase response is œï œâ¬Ü¬àœïo œâ¬Ü œïi œâ¬Ü. Once the frequency response is obtained, the transfer function of the system can be estimated from the break frequencies and slopes. Frequency responsemethods can yield a more reÔ¨Å ned estimate of the transfer function than the transient response techniques covered in Chapter 4. Bode plots are a convenient presentation of the frequency response data for the purpose of estimating the transfer function. These plots allow parts of the transfer function tobe determined and extracted, leading the way to further re Ô¨Ånements to Ô¨Ånd the remaining parts of the transfer function. Although experience and intuition are invaluable in the process, the following steps are still offered as a guideline: 1.Look at the Bode magnitude and phase plots and estimate the pole-zero con Ô¨Åguration of the system. Look at the initial slope on the magnitude plot to determine system type. Look at phase excursions to get an idea of the difference between the number of polesand the number of zeros. 2.See if portions of the magnitude and phase curves represent obvious Ô¨Årst- or second-order pole or zero frequency response plots. 3.See if there is any telltale peaking or depressions in the magnitude response plot thatindicate an underdamped second-order pole or zero, respectively. 4.If any pole or zero responses can be identi Ô¨Åed, overlay appropriate 20 or 40dB/decade lines on the magnitude curve or 45¬∞/decade lines on the phase curve and estimate the break frequencies. For second-order poles or zeros, estimate the damping ratio andnatural frequency from the standard curves given in Section 10.2. 5.Form a transfer function of unity gain using the poles and zeros found. Obtain thefrequency response of this transfer function and subtract this response from the previousfrequency response ( Franklin ,1991 ). You now have a frequency response of reduced complexity from which to begin the process again to extract more of the system‚Äô s poles and zeros. A computer program such as MATLAB is of invaluable help for this step. Let us demonstrate. Example 10.18 Transfer Function from Bode PlotsTransfer Function from Bode Plots PROBLEM: Find the transfer function of the subsystem whose Bode plots are shown in Figure 10.57.10.13 Obtaining Transfer Functions Experimentally 591WEBC10 10/28/2014 18:16:55 SOLUTION: Let us Ô¨Årst extract the underdamped poles that we suspect, based on the peaking in the magnitude curve. We estimate the natural frequency to be near the peak frequency, or approximately 5 rad/s. From Figure 10.57, we see a peak of about 6.5 dB,which translates into a damping ratio of about Œ∂¬à0:24 using Eq. (10.52). The unity gain second-order function is thus G 1 s¬Ü¬àœâ2 n= s2¬á2Œ∂œâns¬áœâ2n¬Ü¬à25= s2¬á2:4s¬á25¬Ü. The frequency response plot of this function is made and subtracted from the previous Bode plots to yield the response in Figure 10.58. ‚Äì15 ‚Äì20‚Äì25‚Äì30‚Äì35‚Äì40‚Äì45‚Äì50‚Äì5520 log M 10 100 1000 1 Frequency (rad/s) 0 ‚Äì20 ‚Äì40‚Äì60‚Äì80 ‚Äì100Phase (degrees) Frequenc y (rad/s)10 100 1000 1 FIGURE 10.58 Original Bode plots minus response of G1 s¬Ü¬à25= s2¬á2:4s¬á25¬ÜPhase (degrees) 10000 ‚Äì50 ‚Äì100 ‚Äì150‚Äì200‚Äì250‚Äì300 100 10 1 Fre quenc y (rad/s)20 log M 10000 ‚Äì50 ‚Äì100 ‚Äì150 100 10 1 Frequency (rad/s) FIGURE 10.57 Bode plots for subsystem with undetermined transfer function592 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:56 Overlaying a  20 dB/decade line on the magnitude response and a  45 ¬∞/decade line on the phase response, we detect a Ô¨Ånal pole. From the phase response, we estimate the break frequency at 90 rad/s. Subtracting the response of G2 s¬Ü¬à90= s¬á90¬Üfrom the previous response yields the response in Figure 10.59. Figure 10.59 has a magnitude and phase curve similar to that generated by a lag function. We draw a  20 dB/decade line and Ô¨Åt it to the curves. The break frequencies are read from the Ô¨Ågure as 9 and 30 rad/s. A unity gain transfer function containing a pole at  9a n daz e r oa t  30 is G3 s¬Ü¬à0:3 s¬á30¬Ü= s¬á9¬Ü. Upon subtraction of G1 s¬ÜG2 s¬ÜG3 s¬Ü,w e Ô¨Ånd the magnitude frequency response Ô¨Çat1d B and the phase response Ô¨Çat at  3¬∞5¬∞. We thus conclude that we are Ô¨Ånished extracting dynamic transfer functions. The low-frequency, or dc, value of the original curve is  1 9d B ,o r0 . 1 1 .O u re s t i m a t eo ft h es u b s y s t e m ‚Äôs transfer function is G s¬Ü¬à0:11G1 s¬ÜG2 s¬ÜG3 s¬Ü,o r G s¬Ü¬à0:1125 s2¬á2:4s¬á25/C18/C19 901 s¬á90/C18/C19 0:3s¬á30 s¬á9/C18/C19 ¬à74:25s¬á30 s¬á9¬Ü s¬á90¬Ü s2¬á2:4s¬á25¬Ü(10.89) It is interesting to note that the original curve was obtained from the function G s¬Ü¬à70s¬á20 s¬á7¬Ü s¬á70¬Ü s2¬á2s¬á25¬Ü(10.90)Phase (degrees) 10000 ‚Äì5 ‚Äì10 ‚Äì15 ‚Äì20 ‚Äì25 ‚Äì30 ‚Äì35 100 10 1 Frequenc y (rad/s)20 log M 1000‚Äì18 ‚Äì20 ‚Äì22 ‚Äì24 ‚Äì26 ‚Äì28 ‚Äì30 ‚Äì32 100 10 1 Frequency (rad/s) FIGURE 10.59 Original Bode plot minus response of G1 s¬ÜG2 s¬Ü¬à¬â25= s2¬á2:4s¬á25¬Ü¬ä ¬â90= s¬á90¬Ü¬ä10.13 Obtaining Transfer Functions Experimentally 593WEBC10 10/28/2014 18:16:56 In this chapter, we derived the relationships between time response performance and the frequency responses of the open- and closed-loop systems. The methods derived, although yielding a different perspective, are simply alternatives to the root locus andsteady-state error analyses previously covered.Skill-Assessment Exercise 10.12 PROBLEM: Estimate G(s), whose Bode log-magnitude and phase plots are shown in Figure 10.60. ANSWER: G s¬Ü¬à30 s¬á5¬Ü s s¬á20¬Ü The complete solution is at www.wiley.com/college/nise . ‚Äì40‚Äì30‚Äì20‚Äì100102020 log M 1 10 100 1000 Frequency (rad/s) ‚Äì95‚Äì90‚Äì80 ‚Äì85‚Äì75‚Äì60‚Äì65 ‚Äì70‚Äì55‚Äì50‚Äì45Phase (degrees) 1 10 100 1000 Frequenc y (rad/s) FIGURE 10.60 Bode plots for Skill-Assessment Exercise 10.12Students who are using MATLAB should now run ch10 p8 in Appendix B. You will learn how to use MATLAB to subtract Bode plots for thepurpose of estimating transfer functions through si nusoidal testing. This exercise solves a portion of Example 10.18 usingMATLAB.594 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:57 Case Study Antenna Control: Stability Design andT ransient PerformanceAntenna Control: Stability Design and Transient Performance Our ongoing antenna position control system serves now as an example that summarizes the major objectives of the chapter. The case study demonstrates the use of frequency response methods to Ô¨Ånd the range of gain for stability and to design a value of gain to meet a percent overshoot requirement for the closed-loop step response. PROBLEM: Given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 1, use frequency response techniques to Ô¨Ånd the following: a.The range of preampli Ô¨Åer gain, K, required for stability b.Percent overshoot if the preampli Ô¨Åer gain is set to 30 c.The estimated settling time d.The estimated peak time e.The estimated rise time SOLUTION: Using the block diagram (Con Ô¨Åguration 1) shown on the front endpapers and performing block diagram reduction yields the loop gain, G(s)H(s), as G s¬ÜH s¬Ü¬à6:63K s s¬á1:71¬Ü s¬á100¬Ü¬à0:0388 K ss 1:71¬á1/C16/C17s 100¬á1/C16/C17 (10.91) Letting K¬à1, we have the magnitude and phase frequency response plots shown in Figure 10.61. 0 ‚Äì180 11 0 Frequency (rad/s)100 0.1 1000 11 0 Frequency (rad/s)100 0.1 1000‚Äì180 ‚Äì200 ‚Äì220 ‚Äì240 ‚Äì260Phase (degrees)‚Äì160 ‚Äì160‚Äì140 ‚Äì140‚Äì120 ‚Äì120‚Äì100 ‚Äì10020 log M‚Äì80 ‚Äì280‚Äì80‚Äì60‚Äì40‚Äì20 FIGURE 10.61 Open-loop frequency response plots for the antenna control system K¬à1¬ÜCase Study 595WEBC10 10/28/2014 18:16:58 Summary Frequency response methods are an alternative to the root locus for analyzing and designing feedback control systems. Frequency response techniques can be used more effectively than transient response to model physical systems in the laboratory. On theother hand, the root locus is more directly related to the time response. The input to a physical system can be sinusoidally varying with known frequency, amplitude, and phase angle. The system ‚Äôs output, which is also sinusoidal in the steady state, can then be measured for amplitude and phase angle at different frequencies. Fromthis data, the magnitude frequency response of the system, which is the ratio of the outputamplitude to the input amplitude, can be pl otted and used in place of an analytically obtained magnitude frequency response. Similarly, we can obtain the phase response byÔ¨Ånding the difference between the output phase angle and the input phase angle at different frequencies.a.In order to Ô¨Ånd the range of Kfor stability, we notice from Figure 10.61 that the phase response is  180 ¬∞atœâ¬à13:1 rad/s. At this frequency, the magnitude plot is  68.41 dB. The gain, K, can be raised by 68.41 dB. Thus, K¬à2633 will cause the system to be marginally stable. Hence, the system is stable if 0 <K<2633. b.ToÔ¨Ånd the percent overshoot if K¬à30, we Ô¨Årst make a second-order approximation and assume that the second-order transient response equations relating percent overshoot,damping ratio, and phase margin are true for this system. In other words, we assume thatEq. (10.73), which relates damping ratio to phase margin, is valid. If K¬à30, the magnitude curve of Figure 10.61 is moved up by 20 log 30 ¬à29:54 dB. Therefore, the adjusted magnitude curve goes through zero dB at œâ¬à1. At this frequency, the phase angle is  120 :9¬∞, yielding a phase margin of 59.1 ¬∞. Using Eq. (10.73) or Figure 10.48, Œ∂¬à0:6, or 9.48% overshoot. A computer simulation shows 10%. c.To estimate the settling time, we make a second-order approximation and useEq. (10.55). Since K¬à30 (29.54 dB), the open-loop magnitude response is  7d B when the normalized magnitude response of Figure 10.61 is  36.54 dB. Thus, the estimated bandwidth is 1.8 rad/s. Using Eq. (10.55), T s¬à4:25 seconds. A computer simulation shows a settling time of about 4.4 seconds. d.Using the estimated bandwidth found in Part calong with Eq. (10.56) and the damping ratio found in a, we estimate the peak time to be 2.5 seconds. A computer simulation shows a peak time of 2.8 seconds. e.To estimate the rise time, we use Figure 4.16 and Ô¨Ånd that the normalized rise time for a damping ratio of 0.6 is 1.854. Using Eq. (10.54), the estimated bandwidth found inc, and Œ∂¬à0:6, we Ô¨Åndœâ n¬à1:57. Using the normalized rise time and œân,w e Ô¨Ånd Tr¬à1:854=1:57¬à1:18 seconds. A simulation shows a rise time of 1.2 seconds. CHALLENGE: You are now given a problem to test your knowledge of this chapter ‚Äôs objectives. You are given the antenna azimuth position control system shown on the frontendpapers, Con Ô¨Åguration 3. Record the block diagram parameters in the table shown on the front endpapers for Con Ô¨Åguration 3 for use in subsequent case study challenge problems. Using frequency response methods, do the following: a.Find the range of gain for stability. b.Find the percent overshoot for a step input if the gain, K, equals 3. c. Repeat Parts aandbusing MATLAB.596 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:58 The frequency response of a system can be represented either as a polar plot or as separate magnitude and phase diagrams. As a polar plot, the magnitude response is the length of a vector drawn from the origin to a point on the curve, whereas the phase responseis the angle of that vector. In the polar plot, frequency is implicit and is represented by eachpoint on the polar curve. The polar plot of G(s)H(s) is known as a Nyquist diagram . Separate magnitude and phase diagrams, sometimes referred to as Bode plots , present the data with frequency explicitly enumerated along the abscissa. The magnitudecurve can be a plot of log-magnitude versus log-frequency. The other graph is a plot ofphase angle versus log-frequency. An advantage of Bode plots over the Nyquist diagram is that they can easily be drawn using asymptotic approximations to the actual curve. The Nyquist criterion sets forth the theoretical foundation from which the frequency response can be used to determine a system ‚Äôs stability. Using the Nyquist criterion and Nyquist diagram, or the Nyquis t criterion and Bode plots, we can determine as y s t e m ‚Äôs stability. Frequency response methods give us not only stability information but also transient response information. By de Ô¨Åning such frequency response quantities as gain margin and phase margin, the transient response can be analyzed or designed. Gain margin is the amount that the gain of a system can be increased before instability occurs if the phase angle is constant at 180 ¬∞.Phase margin is the amount that the phase angle can be changed before instability occurs if the gain is held at unity. While the open-loop frequency response leads to the results for stability and transient response just described, other desi gn tools relate the closed-loop frequency response peak and bandwidth to the transient response. Since the closed-loop responseis not as easy to obtain as the open-loop res ponse, because of the unavailability of the closed-loop poles, we use graphical aids in order to obtain the closed-loop frequency response from the open-loop frequency response. These graphical aids are the MandN circles and the Nichols chart. By superimposing the open-loop frequency response over theMand Ncircles or the Nichols chart, we are able to obtain the closed-loop frequency response and then analyze and design for transient response. Today, with the availability of computers and appropriate software, frequency response plots can be obtained without relying on the graphical techniques describedin this chapter. The program used for the root locus calculations and described inAppendix H.2 is one such program. MATLAB is another. We concluded the chapter discussion by showing how to obtain a reasonable estimate of a transfer function using its frequency response, which can be obtainedexperimentally. Obtaining transfer functions this way yields more accuracy than transientresponse testing. This chapter primarily has examined analysis of feedback control systems via frequency response techniques. We developed the relationships between frequencyresponse and both stability and transient response. In the next chapter, we apply theconcepts to the design of feedback control systems, using the Bode plots. Review Questions 1.Name four advantages of frequency response techniques over the root locus. 2.DeÔ¨Åne frequency response as applied to a physical system. 3.Name two ways to plot the frequency response. 4.BrieÔ¨Çy describe how to obtain the frequency response analytically. 5.DeÔ¨Åne Bode plots. 6.Each pole of a system contributes how much of a slope to the Bode magnitude plot?Review Questions 597WEBC10 10/28/2014 18:16:58 7.A system with only four poles and no zeros would exhibit what value of slope at high frequencies in a Bode magnitude plot? 8.A system with four poles and two zeros would exhibit what value of slope at high frequencies in a Bode magnitude plot? 9.Describe the asymptotic phase response of a system with a single pole at  2. 10.What is the major difference between Bode magnitude plots for Ô¨Årst-order systems and for second-order systems? 11.For a system with three poles at  4, what is the maximum difference between the asymptotic approximation and the actual magnitude response? 12.BrieÔ¨Çy state the Nyquist criterion. 13.What does the Nyquist criterion tell us? 14.What is a Nyquist diagram? 15.Why is the Nyquist criterion called a frequency response method? 16.When sketching a Nyquist diagram, what must be done with open-loop poles on theimaginary axis? 17.What simpli Ô¨Åcation to the Nyquist criterion can we usually make for systems that are open-loop stable? 18.What simpli Ô¨Åcation to the Nyquist criterion can we usually make for systems that are open-loop unstable? 19.DeÔ¨Åne gain margin. 20.DeÔ¨Åne phase margin. 21.Name two different frequency response characteristics that can be used to determine asystem ‚Äôs transient response. 22.Name three different methods of Ô¨Ånding the closed-loop frequency response from the open-loop transfer function. 23.BrieÔ¨Çy explain how to Ô¨Ånd the static error constant from the Bode magnitude plot. 24.Describe the change in the open-loop frequency response magnitude plot if time delay is added to the plant. 25.If the phase response of a pure time delay were plotted on a linear phase versus linear frequency plot, what would be the shape of the curve? 26.When successively extracting component transfer functions from experimentalfrequency response data, how do you know when you are Ô¨Ånished? Problems 1.Find analytical expressions for the magnitude and phaseresponse for each G(s) below. [Section: 10.1] a.G s¬Ü¬à1 s s¬á2¬Ü s¬á4¬Ü b.G s¬Ü¬à s¬á5¬Ü s¬á2¬Ü s¬á4¬Ü c.G s¬Ü¬à s¬á3¬Ü s¬á5¬Ü s s¬á2¬Ü s¬á4¬Ü 2.For each function in Problem 1, make a plot of thelog-magnitude and the phase, using log-frequencyin rad/s as the ordinate. Do not use asymptoticapproximations. [ Section: 10.1] 3.For each function in Problem 1, make a polar plot of thefrequency response. [Section: 10.1] 4.For each function in Problem 1, sketch the Bodeasymptotic magnitude and asymptotic phase plots.Compare your results with your answers to Problem 1.[Section: 10.2] 5.Sketch the Nyquist diagram for each of the systems in Figure P10.1. [Section: 10.4]598 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:16:58 + ‚Äì50 s(s + 3)(s + 6)E(s) R(s) C(s) + E(s) R(s) C(s)+ 50 s2(s + 1)R(s) C(s) (s + 4) + 20 s(s + 1)R(s) C(s) (s + 4)(s + 3)System 1 ‚Äì ‚Äì‚ÄìSystem 2 System 4System 3 100(s + 5) s(s + 3)(s2 + 4) FIGURE P10.1 6.Draw the polar plot from the separate magnitude and phase curves shown in Figure P10.2. [Section: 10.1]7.Draw the separate magnitude and phase curves from the polar plot shown in Figur e P10.3. [Section: 10.1]Imaginary axis8 6420 ‚Äì2 ‚Äì4 ‚Äì6 ‚Äì8 Real axis10 8 6 4 2 ‚Äì2 ‚Äì4√ó 10‚Äì3 √ó 10‚Äì31087 6 5 4 3 2œâ =1 0 FIGURE P10.3Phase (deg) 1000 ‚Äì50 ‚Äì100 ‚Äì150 ‚Äì200 10 1 0.1 Frequenc y (rad/s)20 log M 1000 ‚Äì10‚Äì20‚Äì30‚Äì40 10 1 0.1 Frequency (rad/s) FIGURE P10.2Problems 599WEBC10 10/28/2014 18:16:59 8.Write a program in MATLAB that will do the following: a.Plot the Nyquist diagram of a system b.Display the real-axis crossing value and frequency Apply your program to a unity feedback system with G s¬Ü¬àK s¬á5¬Ü s2¬á6s¬á100¬Ü s2¬á4s¬á25¬Ü 9.Using the Nyquist criterion, Ô¨Ånd out whether each system of Problem 5 is stable. [Section: 10.3] 10.Using the Nyquist criterion, Ô¨Ånd the range of Kfor stability for each of the systems in Figure P10.4.[Section: 10.3] + K (s + 2)R(s) C(s) + (s + 2)(s + 4)R(s) C(s) System 2System 1 + K(s ‚Äì 1) (s + 1) (s ‚Äì 2) (s + 2)R(s) C(s) System 31 (s + 4)(s + 6) ‚Äì ‚Äì‚Äì 1 sK(s2 ‚Äì 4s + 13) FIGURE P10.4 11.For each system of Problem 10, Ô¨Ånd the gain margin and phase margin if the value of Kin each part of Problem 10 is [Section: 10.6] a.K¬à1000 b.K¬à100 c.K¬à0:1 12.Write a program in MATLAB thatwill do the following: a.Allow a value of gain, K, to be entered from the keyboardb.Display the Bode plots of a system for the entered value of K c.Calculate and display the gain and phase margin for the entered valueofK Test your program on a unity feedback system with G s¬Ü¬àK=¬âs s¬á3¬Ü s¬á12¬Ü¬ä. Use MATLAB ‚Äôs LTI Viewer to Ô¨Ånd the gain margin, phase margin,zero dB frequency, and 180 ¬∞frequency for a unity feedback system with G s¬Ü¬à8000 s¬á6¬Ü s¬á20¬Ü s¬á35¬Ü Use the following methods: a.The Nyquist diagram b.Bode plots 14.Derive Eq. (10.54), the closed-loop bandwidth interms of Œ∂andœâ nof a two-pole system. [Section: 10.8] 15.For each closed-loop system with the following performance characteristics, Ô¨Ånd the closed-loop bandwidth: [Section: 10.8] a.Œ∂¬à0:2;Ts¬à3 seconds b.Œ∂¬à0:2;Tp¬à3 seconds c.Ts¬à4 seconds ;Tp¬à2 seconds d.Œ∂¬à0:3;Tr¬à4 seconds : 16.Consider the unity feedback system of Figure 10.10. For each G(s) that follows, use the MandNcircles to make a plot of the closed-loop frequency response:[Section: 10.9] a.G s¬Ü¬à10 s s¬á1¬Ü s¬á2¬Ü b.G s¬Ü¬à1000 s¬á3¬Ü s¬á4¬Ü s¬á5¬Ü s¬á6¬Ü c.G s¬Ü¬à50 s¬á3¬Ü s s¬á2¬Ü s¬á4¬Ü 17.Repeat Problem 16,using the Nichols chart in place oftheMandNcircles. [Section: 10.9] 18.Using the results of Problem 16, estimate the percent overshoot that can be expected in the step response for each system shown. [Section: 10.10] 19.Use the results of Problem 17 to estimate the percentovershoot if the gain term in the numerator of the600 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:17:0 forward path of each part of the problem is respec- tively changed as follows: [Section: 10.10] a.From 10 to 30 b.From 1000 to 2500 c.From 50 to 75 20.Write a program in MATLAB that will do the following: a.Allow a value of gain, K, to be entered from the keyboard b.Display the closed-loop magnitude andphase frequency response plots of aunity feedback system with an open-loop transfer function, KG(s) c.Calculate and display the peak magni-tude, frequency of the peak magnitude,and bandwidth for the closed-loopfrequency response and the entered value of K Test your program on the system of Figure P10.5 for K¬à50. K(s + 5) s(s2 + 4s +16)+ ‚ÄìR(s) E(s) C(s) FIGURE P10.5 21.Use MATLAB ‚Äôs LTI Viewer with the Nichols plot to Ô¨Ånd the gain margin, phase margin, zero dB frequency, and 180 ¬∞frequency for a unity feedback system with the forward-path transferfunction G s¬Ü¬à5 s¬á6¬Ü s s2¬á4s¬á15¬Ü 22.Write a program in MATLAB thatwill do the following: a.Make a Nichols plot of an open-looptransfer function b.Allow the user to read the Nichols plotdisplay and enter the value of M p c.Make closed-loop magnitude and phase plots d.Display the expected values of percent overshoot, settling time, and peak time e.Plot the closed-loop step response Test your program on a unity feedback system with the forward-path transferfunctionG s¬Ü¬à5 s¬á6¬Ü s s2¬á4s¬á15¬Ü and explain any discrepancies. 23.Using Bode plots, estimate the transient response of thesystems in Figure P10.6. [Section: 10.10] + 100(s + 2) s(s + 1)(s + 4)R(s) C(s) ‚Äì System 1 + 50(s + 3)(s + 5) s(s + 2)(s + 4)(s + 6)E(s) R(s) C(s) ‚Äì System 2 FIGURE P10.6 24.For the system of Figure P10.5, do the following: [Section: 10.10] a.Plot the Bode magnitude and phase plots. b.Assuming a second-order approximation, estimatethe transient response of the system if K¬à2. c. Use MATLAB or any other programto check your assumptions by simulating the step response of thesystem. Write a program in MATLAB thatwill use an open-loop transfer function, G(s), to do the following: a.Make a Bode plot b.Use frequency response methods toestimate the percent overshoot, settling time, and peak time c.Plot the closed-loop step response Test your program by comparing the results to those obtained for the systemsof Problem 23. 26.The Bode plots for a plant, G(s), used in a unity feedback system are shown in Figure P10.7. Do the following: a.Find the gain margin, phase margin, zero dB frequency,180 ¬∞frequency, and the closed-loop bandwidth. b.Use your results in Part ato estimate the damping ratio, percent overshoot, settling time, and peak time. 27.The open-loop frequency response shown in Figure P10.8 was experimentally obtained from aunity feedback system. Estimate the percent overshootand steady-state error of the closed-loop system. [Sections: 10.10, 10.11]Problems 601WEBC10 10/28/2014 18:17:0 20 0 ‚Äì20 ‚Äì90 ‚Äì135 ‚Äì180‚Äì225 ‚Äì270‚Äì40 ‚Äì60 ‚Äì80 ‚Äì100 10 ‚Äì1100 Frequency (rad/s) Frequency (rad/s)20 log M Phase (degrees)101102 10‚Äì1100101102 FIGURE P10.7 60 40 20 0 ‚Äì100 ‚Äì100 ‚Äì120 ‚Äì140 ‚Äì160 ‚Äì180 ‚Äì200 ‚Äì220 ‚Äì240 ‚Äì260‚Äì80 ‚Äì280‚Äì800.1 1 Frequency (rad/s)10 0.01 100‚Äì60‚Äì40‚Äì2020 log M 0.1 1 Frequency (rad/s)10 0.01 100Phase (degrees) FIGURE P10.8602 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:17:0 28.Consider the system in Figure P10.9. [Section: 10.12] R(s) + C(s)Delay50 (s + 2)(s + 5)E(s) ‚Äì FIGURE P10.9 a.Find the phase margin if the system is stable for time delays of 0, 0.1, 0.2, 0.5, and 1 second. b.Find the gain margin if the system is stable for each ofthe time delays given in Part a. c.For what time delays mentioned in Part ais the system stable? d.For each time delay that makes the system unstable, how much reduction in gain is required for the system to be stable? 29.Given a unity feedback system with the forward-pathtransfer function G s¬Ü¬à K s¬á1¬Ü s¬á3¬Ü s¬á6¬Üand a delay of 0.5 second, Ô¨Ånd the range of gain, K,t o yield stability. Use Bode plots and frequency responsetechniques. [Section: 10.12] 30.Given a unity feedback system with the forward-pathtransfer function G s¬Ü¬à K s s¬á1¬Ü s¬á15¬Ü and a delay of 0.2 second, make a second-orderapproximation and estimate the percent overshoot ifK¬à30. Use Bode plots and frequency response techniques. [Section: 10.12] Use the MATLAB function pade(T,n)to model the delay in Problem 30.Obtain the unit step response and eval-uate your second-order approximationin Problem 30. 32.For the Bode plots shown in Figure P10.10, determinethe transfer function by hand or via MATLAB.[Section: 10.13] 4020 log M Phase (degrees)20 ‚Äì20 ‚Äì90 ‚Äì135 ‚Äì180‚Äì40 ‚Äì60 ‚Äì80 10‚Äì1100101102103 10‚Äì1100101102103Frequency (rad/s) Frequency (rad/s)0 FIGURE P10.10Problems 603WEBC10 10/28/2014 18:17:1 33.Repeat Problem 32 for the Bode plots shown in Figure P10.11. [Section: 10.13] 34.An overhead crane consists of a horizontally movingtrolley of mass m Tdragging a load of mass mL,w h i c h dangles from its bottom surface at the end of a ropeofÔ¨Åxed length, L. The position of the trolley is controlled in the feedback con Ô¨Åguration shown in Figure 10.20. Here, G s¬Ü¬àKP s¬Ü;H¬à1, and P s¬Ü¬àXT s¬Ü FT s¬Ü¬à1 mTs2¬áœâ2 0 s2 s2¬áaœâ2 0¬Ü The input is fT(t), the input force applied to the trolley. The output is xT(t), the trolley displacement. Also, œâ0¬àÔ¨ÉÔ¨ÉÔ¨Ég Lr anda¬à mL¬ámT¬Ü=mT(Marttinen ,1990 ) Make a qualitative Bode plot of the system assuming a>1. 35.A room ‚Äôs temperature can be controlled by varying the radiator power. In a speci Ô¨Åc room, the transfer function from indoor radiator power, _Q, to room temperature, Tin ¬∞Ci s( Thomas ,2005 ) P s¬Ü¬àT s¬Ü _Q s¬Ü ¬à 110 6¬Üs2¬á 1:31410 9¬Üs¬á 2:6610 13¬Ü s3¬á0:00163 s2¬á 5:27210 7¬Üs¬á 3:53810 11¬ÜThe system is controlled in the closed-loop con Ô¨Åguration shown in Figure 10.20 with G s¬Ü¬àKP s¬Ü;H¬à1. a.Draw the corresponding Nyquist diagram for K¬à1. b.Obtain the gain and phase margins. c.Find the range of Kfor the closed-loop stability. Compare your result with that of Problem 58, Chapter 6. 36.The open-loop dynamics from dc voltage armature to angular position of a robotic manipulator joint is given byP s¬Ü¬à48500 s2¬á2:89s(Low, 2005 ). a.Draw by hand a Bode plot using asymptotic approximations for magnitude and phase. b.Use MATLAB to plot the exactBode plot and compare with yoursketch from Part a. 37.Problem 47, Chapter 8 discusses a magnetic levitation system with a plant transfer function P s¬Ü¬à  1300 s2 8602 (Galv√£o ,2003 ). Assume that the plant is in cascade with an M(s) and that the system will be controlled by the loop shown in Figure 10.20, where G s¬Ü¬àM s¬ÜP s¬Ü andH¬à1. For each M(s) that follows, draw the Nyquist diagram when K¬à1, and Ô¨Ånd the range of closed-loop stability for K>0. a.M s¬Ü¬à  K b.M s¬Ü¬à K s¬á200¬Ü s¬á1000 (problem continues )15 10 5 0 ‚Äì10 ‚Äì2020 log M Frequency (rad/s) 50 0 ‚Äì50 ‚Äì100 ‚Äì150Phase (degrees) 11 0 100 0.1 Frequenc y (rad/s)‚Äì5 ‚Äì15 ‚Äì20011 0 100 0.1 FIGURE P10.11604 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:17:1 (Continued ) c.Compare your results with those obtained in Problem 47, Chapter 8. 38.A simple modi Ô¨Åed and linearized model for the transfer function of a certain bicycle from steer angle ( Œ¥) to roll angle ( œÜ) is given by ( √Östrom ,2005 ) P s¬Ü¬àœÜ s¬Ü Œ¥ s¬Ü¬à12 s¬á20¬Ü s2¬á25 Assume the rider can be represented by a gain K, and that the closed-loop system is shown in Figure 10.20 with G s¬Ü¬àKP s¬ÜandH¬à1. Use MATLAB and the Nyquist stability criterion to Ô¨Ånd the range of Kfor closed-loop stability. 39.The control of the radial pickup position of a digitalversatile disk (DVD) was discussed in Problem 48,Chapter 9. There, the open-loop transfer function fromcoil input voltage to radial pickup position was given as(Bittanti ,2002 ) P s¬Ü¬à 0:63 1¬á0:36 305:4s¬ás2 305:42/C18/C19 1¬á0:04 248:2s¬ás2 248:22/C18/C19 Assume the plant is in cascade with a controller, M s¬Ü¬à0:5 s¬á1:63¬Ü s s¬á0:27¬Ü and in the closed-loop con Ô¨Åguration shown in Fig- ure 10.20, where G s¬Ü¬àM s¬ÜP s¬ÜandH¬à1. Do the following: a.Draw the open-loop frequency response in a Nicholschart. b.Predict the system ‚Äôs response to a unit step input. Calculate the % OS,c Ô¨Ånal, and Ts. c.Verify the results of Part b using MATLAB simulations. 40.A ship ‚Äôs roll can be stabilized with a control system. A voltage applied to the Ô¨Åns‚Äôactuators creates a roll torque that is applied to the ship. The ship, in response to the rolltorque, yields a roll angle. Assuming the block diagramfor the roll control system shown in Figure P10.12,determine the gain and phase margins for the system.41.The linearized model of a particular network link working under TCP/IP and controlled using a random early detection (RED) algorithm can be describedby Figure 10.20 where G s¬Ü¬àM s¬ÜP s¬Ü;H¬à1, and (Hollot ,2001 ) M s¬Ü¬à 0:005L s¬á0:005;P s¬Ü¬à140625 e 0:1s s¬á2:67¬Ü s¬á10¬Ü a.Plot the Nichols chart for L¬à1. Is the system closed-loop stable? b.Find the range of Lfor closed-loop stability. c.Use the Nichols chart to predict % OSandTsfor L¬à0:95. Make a hand sketch of the expected unit step response. d.Verify Part cwith a Simulink unit step response simulation. 42.In the TCP/IP network link of Problem 41, let L¬à0:8, but assume that the amount of delay is an unknown variable. a.Plot the Nyquist diagram of the system for zero delay,and obtain the phase margin. b.Find the maximum delay allowed for closed-loopstability. 43.An experimental holographic media storage systemuses a Ô¨Çexible photopolymer disk. During rotation, the disk tilts, making information retrieval difÔ¨Å cult. A system that compensates for the tilt has beendeveloped. For this, a laser beam is focused on the disk surface and disk varia tions are measured through reÔ¨Çection. A mirror is in turn adjusted to align with the disk and makes information retrieval possible. The system can be represented by a unity feedback systemin which a controller with transfer function G C s¬Ü¬à78:575 s¬á436¬Ü2 s¬á132¬Ü s¬á8030 ¬Ü and a plant P s¬Ü¬à1:163108 s3¬á962:5s2¬á5:958105s¬á1:16108 form an open loop transmission L s¬Ü¬àGc s¬ÜP s¬Ü (Kim,2009 ). +5TransducerFin actuator 0.5 s + 5Ship roll dynamics 9 s2 + 1.2s + 9Desired roll angle, Œ∏d(s) Voltage Torque ‚ÄìRoll angle error, Œ∏e(s) Actual roll angle, Œ∏ a(s) FIGURE P10.12 Block diagram of a ship ‚Äôs roll-stabilizing systemProblems 605WEBC10 10/28/2014 18:17:2 a.Use MATLAB to obtain the system ‚Äôs Nyquist diagram. Find out if the system is stable. b.Find the system ‚Äôs phase margin. c.Use the value of phase margin obtained inb. to calculate the expected sys- tem‚Äôs overshoot to a step input. d.Simulate the system‚Äô s response to a unit step input and verify the %OScalculated in c. 44.The design of cruise control systems in heavy vehicles,such as big rigs, is especially challenging due to theextreme variations in payload. Assume that the fre-quency response for the transfer function from fuelmass Ô¨Çow to vehicle speed is shown in Figure P10.13. 0 ‚Äì10 ‚Äì20‚Äì30‚Äì40Magnitude (dB) Phase (deg)‚Äì50‚Äì60 90 45 0 ‚Äì45‚Äì90 Frequenc y (rad/s)10‚Äì610‚Äì510‚Äì410‚Äì310‚Äì210‚Äì1100101102103104 FIGURE P10.13 This response includes the dynamics of the engine, the gear box, the propulsion shaft, the differen- tial, the drive shafts, the chassis, the payload, and tire dynamics. Assume that the system is controlled in a closed-loop, unity-feedback loop using a proportionalcompensator ( van der Zalm ,2008 ). a.MakeaplotoftheNyquistdiagramthatcorrespondstothe Bode plot of Figure P10.13. b.Assuming there are no open-loop poles in the righthalf-plane, Ô¨Ånd out if the system is closed-loop stable when the proportional gain K=1. c.Find the range of positive Kfor which the system is closed-loop stable. 45.Use LabVIEW with the ControlDesign and Simulation Module and MathScript RT Module to dothe following: Modify the CDEx Nyquist Analysis.vi to obtainthe range of Kfor stability using theNyquist plot for any system you enter. In addition, design a LabVIEW VI that will accept as an input the polynomialnumerator and polynomial denominatorof an open-loop transfer function andobtain a Nyquist plot for a value ofK=10,000. Your VI will also display the following as generated from theNyquist plot: (1) gain margin, (2) phase margin, (3) zero dB frequency, and (4) 180 degrees frequency. Use the system andresults of Skill-Assessment Exercise10.6 to test your VIs. 46.Use LabVIEW with the Control Design and Simulation Module, and MathScript RT Module to build a VI that will accept an open-loop transferfunction, plot the Bode diagram, and plotthe closed-loop step response. Your VIwill also use the CD Parametric TimeResponse VI to display (1) rise time, (2) peak time, (3) settling time, (4) percent overshoot, (5) steady-state value, and(6) peak value. Use the system in Skill-Assessment Exercise 10.9 to test your VI.Compare the results obtained from your VIwith those obtained in Skill-AssessmentExercise 10.9. The block diagram of a cascadesystem used to control waterlevel in a steam generator of anuclear power plant (Wang, 2009 ) was pre- sentedinFigureP6.14.Inthat system, the level controller, G LC(s), is the master controller and the feed-water Ô¨Çow con- troller, GFC(s), is the slave controller. Consider that the inner feedback loopis replaced by its equivalent transferfunction, G WX(s). Using numerical values in (Wang, 2009 ) and ( Bhambhani, 2008 ) the transfer functions with a 1 second pure delay are: Gfw s¬Ü¬à2e œÑs s T1s¬á1¬Ü¬à2e s s 25s¬á1¬Ü; GWX s¬Ü¬à 4s¬á1¬Ü 3 3:333s¬á1¬Ü; GLC s¬Ü¬àKPLC¬áKDLCs¬à1:5 10s¬á1¬Ü606 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:17:2 Use MATLAB or any other program to: a.Obtain Bode magnitude and phase plots for this system using a Ô¨Åfth-order Pad√© approximation (available in MATLAB). Note on these plots, if applicable, thegain and phase margins. b.Plot the response of the system, c(t), to a unit step input, r(t)=u(t). Note on the c(t) curve the rise time, T r, the settling time, Ts, the Ô¨Ånal value of the output, and, if applicable, the percent overshoot, %OS, and mid peak time, Tp. c.Repeat the above two steps for a pure delay of 1.5 seconds. 48.Fruit Ô¨Çies‚ÄôÔ¨Çight dynamics are interesting to study because they provide a proof-of-concept frameworkand inspiration for the invention of man-made machines.In an experiment ( Roth,2012 ),Ô¨Çies are stimulated to follow, in Ô¨Çight, an oscillating vertical bar. Through frequency response measurements, the obtained open-loop transfer function from stimulus stripe position to avoltage proportional to wingbeat amplitudes is G s¬Ü¬àe  0:032s0:181s2¬á1:23s¬á8:68 s3¬á20:6s2¬á277s¬á1098 Assume a unit feedback system. a.Make a Bode plot of the open-loop transfer function. b.Find the gain and phase margins. c.Use a computer program to make a plot of thecorresponding Nyquist diagram. d.Use the result in Part btoÔ¨Ånd the range of Kfor closed-loop stability if the open-loop transfer functionbecomes KG(s). 49.In order to self-balance a bicycle, its open-loop transferfunction is found to be ( Lam,2011 ): G s¬Ü¬à Œ∏ s¬Ü U s¬Ü ¬à334019 s4¬á5126 :16s3¬á2470 :7s2¬á428419 s 34040 where Œ∏(s) is the angle of the bicycle with respect to the vertical, and U(s) is the voltage applied to the motor that drives a Ô¨Çywheel used to stabilize the bicycle. Note that the bicycle is open-loop unstablewith one open-loop pole in the right half-plane. a.Draw the Nyquist diagram of the system. b.Find the system ‚Äôs gain and phase margins. c.Assuming a unit feedback system, Ô¨Ånd the range of K for closed-loop stability if the forward path transferfunction is KG(s).d.Assuming a second-order approximation, what is the expected % OSifK=0.141? e.Use a computer program to simulate your system for a unit-step response using the valueofKin Part d. Modify the MATLAB program youdeveloped in Problem 10.20 to dothe following: a.Display the closed-loop magnitude and phase frequency response plots for the drivesystem( Thomsen,2011 )presented in Problem 56, Chapter 8. Using thegraph properties, specify the valueofKin the Bode plot title. b.Calculate and display the closed-looptransfer function, T(s), the peak magnitude, frequency of the peak magni-tude, and bandwidth for the closed-loop frequency response at the following two values of the proportional controller ‚Äôs gain, K=K P=3.2 and 10. 51.Al i n e a rm o d e lo ft h e Œ±-subsystem of a grid- connected voltage-source converter (VSC) with aY-Y transformer (Mahmood ,2012) was presented in Problem 69, Chapter 8. In Figure P8.20( b), G C(s)=KandGP(s)i sg i v e ni nap o l ez e r of o r m (with a unity gain and slightly modiÔ¨Å ed parameters) as follows: GP s¬Ü¬àVŒ± s¬Ü MŒ± s¬Ü¬à s¬á2200 ¬Ü s¬á220¬Ü s2¬á120s¬á16106¬Ü Use MATLAB and frequency response techniques to obtainthe Bode plots for this systemandÔ¨Ånd the following: a.The range of Kfor system stability b.The gain margin, phase margin, zero dB frequency, and 180¬∞ frequency, if K= 5√ó10 52.A new measurement-based technique to design Ô¨Åxed- structure controllers for unknown SISO systems, which does not require system identi Ô¨Åcation, has been proposed. The fourth -order transfer function s h o w nb e l o wa n dm o d i Ô¨Åed to have a unity steady- s t a t eg a i ni su s e da sa ne x a m p l e( Khadraoui ,2013 ). G s¬Ü¬à0:1111 4s2¬á5s¬á1¬Ü s4¬á3:1s3¬á0:85s2¬á0:87s¬á0:1111 The interested reader is referred to the reference to explore this new technique. In this problem and itsProblems 607WEBC10 10/28/2014 18:17:3 companion design problem in Chapter 11, however, we take a standard approach as covered in Chapters 10 and 11. Assuming that a cascade- connected proportionalcontroller, G C(s)=K, is used, utilize MATLAB and frequency responsetechniques to obtain the Bode plots forthis system and Ô¨Ånd: a.The range of Kfor system stability b.The gain margin, phase margin, zero dBfrequency, and 180 ¬∞frequency, if K=0.3. PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 53.Control of HIV/AIDS. The linearized model for an HIV/AIDS patient treated with RTIs was obtained in Chapter 6 as ( Craig ,2004 ); P s¬Ü¬à Y s¬Ü U1 s¬Ü¬à 520 s 10:3844 s3¬á2:6817 s2¬á0:11s¬á0:0126 a.Consider this plant in the feedback con Ô¨Åguration in Figure 10.20 with G s¬Ü¬àP s¬ÜandH s¬Ü¬à1. Obtain the Nyquist diagram. Evaluate the system for closed-loop stability. b.Consider this plant in the feedback con Ô¨Åguration in Figure 10.20 with G s¬Ü¬à  P s¬ÜandH s¬Ü¬à1. Obtain the Nyquist diagram. Evaluate the systemfor closed-loop stability. Obtain the gain and phase margins. Hybrid vehicle. In Problem 71, Chapter 8, we used MATLAB to plotthe root locus for the speed control of an HEV rearranged as a unity-feedbacksystem, as shown in Figure P7.31 ( Preitl , 2007 ). The plant and compensator were given by G s¬Ü¬à K s¬á0:6¬Ü s¬á0:5858 ¬Ü s¬á0:0163 ¬Ü and we found that K=0.78, resulted in a critically damped system. a.Use MATLAB or any other program toplot the following:i.The Bode magnitude and phase plots for that system, and ii.The response of the system, c(t), to a step input, r(t)=4u(t). Note on thec(t) curve the rise time, T r, and settling time, Ts,a sw e l la st h e Ô¨Ånal value of the output. b.Now add an integral gain to the control- ler,suchthattheplantandcompensatortransfer function becomes G s¬Ü¬àK1 s¬áZc¬Ü s¬á0:6¬Ü s s¬á0:5858 ¬Ü s¬á0:0163 ¬Ü where K1=0.78 and Zc¬àK2 K1¬à0:4. Use MATLAB or any other program to do thefollowing: i.Plot the Bode magnitude and phaseplots for this case. ii.Obtain the response of the systemto a step input, r(t)=4u(t). Plot c(t) and note on it the rise time, T r, percent overshoot, % OS, peak time, Tp, and settling time, Ts. c.Does the response obtained in Parts a orbresembleasecond-orderoverdamped, critically damped, or underdampedresponse? Explain. 55.Parabolic trough collector. As discussed in Section 10.12, the Nyquist stability criterion can be applied tosystems with pure time delay without the need forrational approximations as required in Problems 8.72 and 9.59. You will verify this by applying the Nyquist stability criterion to the parabolic trough collector byassuming a unity-feedback system and a forward-pathtransfer function ( Camacho ,2012), G s¬Ü¬à 137:210 6K s2¬á0:0224 s¬á19610 6e 39s a.Draw the corresponding Nyquist diagram for K=1. b.Use the Nyquist diagram to Ô¨Ånd the range of Kfor which the system is closed-loop stable. c.Find the value of Kthat will make the system marginally stable and the associated frequency ofoscillation.608 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:17:3 Cyber Exploration Laboratory Experiment 10.1 Objectives To examine the relationships between open-loop frequency response and stability, open-loop frequency response and closed-loop transient response, and the effect of additional closed-loop poles and zeros upon the ability to predict closed-loop transientresponse Minimum Required Software Packages MATLAB, and the Control System Toolbox Prelab 1.Sketch the Nyquist diagram for a unity negative feedback system with a forward transfer function of G s¬Ü¬àK s s¬á2¬Ü s¬á10¬Ü. From your Nyquist plot, determine the range of gain, K, for stability. 2.Find the phase margins required for second-order closed-loop step responses with the following percent overshoots: 5%, 10%, 20%, 30%. Lab 1.Using the SISO Design Tool, produce the f ollowing plots simultaneously for the system of Prelab 1: root locus, Nyquist diagram, and step response. Make plots for thefollowing values of K: 50, 100, the value for marginal stability found in Prelab 1, and a value above that found for marginal stability. Use the zoom tools when required toproduce an illustrative plot. Finally, change the gain by grabbing and moving theclosed-loop poles along the root locus and note the changes in the Nyquist diagramand step response. 2.Using the SISO Design Tool, produce Bode plots and closed-loop step responses for a unity negative feedback system with a forward transfer function of G s¬Ü¬à K s s¬á10¬Ü2. Produce these plots for each value of phase margin found in Prelab 2. Adjust the gain to arrive at the desired phase margin by grabbing the Bode magnitude curve and moving itup or down. Observe the effects, if any, upon the Bode phase plot. For each case, recordthe value of gain and the location of the closed-loop poles. 3.Repeat Lab 2 for G s¬Ü¬à K s s¬á10¬Ü. Postlab 1.Make a table showing calculated and actual values for the range of gain for stability asfound in Prelab 1 and Lab 1. 2.Make a table from the data obtained in Lab 2 itemizing phase margin, percent overshoot,and the location of the closed-loop poles. 3.Make a table from the data obtained in Lab 3 itemizing phase margin, percent overshoot,and the location of the closed-loop poles. 4.For each Postlab task 1 to 3, explain any discrepancies between the actual valuesobtained and those expected. Experiment 10.2 Objectives To use LabVIEW and Nichols charts to determine the closed-loop time response performanceCyber Exploration Laboratory 609WEBC10 10/28/2014 18:17:4 Bibliography √Östrom, K., Klein, R. E., and Lennartsson, A. Bicycle Dynamics and Control. IEEE Control System , August 2005, pp. 26 ‚Äì47. Bhambhani, V., and Chen, YQ. Experimental Study of Fractional Order Proportional Integral (FOPI) Controller for Water Level Control. 47th IEEE Conference on Decision and Control , 2008, pp. 1791 ‚Äì1796. Bittanti, S., Dell‚Äô Orto, F., DiCarlo, A., and Savaresi, S. M. Notch Filtering and Multirate Control for Radial Tracking in High Speed DVD-Players. IEEE Transactions on Consumer Electronics, vol. 48. 2002, pp. 56 ‚Äì62. Bode, H. W. Network Analysis and Feedback Ampli Ô¨Åer Design . Van Nostrand, Princeton, NJ, 1945. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. Dorf, R. C. Modern Control Systems , 5th ed. Addison-Wesley, Reading, MA, 1989. Franklin, G., Powell, J. D., and Emami-Naeini, A. Feedback Control of Dynamic Systems , 2d ed. Addison-Wesley, Reading, MA, 1991. Galv√£o, R. K. H., Yoneyama, T., and de Ara√∫jo, F. M. U. A Simple Technique for Identifying a Linearized Model for a Didactic Magnetic Levitation System. IEEE Transactions on Education , vol. 46, no. 1, February 2003, pp. 22 ‚Äì25. Hollot, C. V., Misra, V., Towsley, D., and Gong, W. A Control Theoretic Analysis of RED. Proceedings of IEEE INFOCOM, 2001, pp. 1510 ‚Äì1519. Hostetter, G. H., Savant, C. J., Jr., and Stefani, R. T. Design of Feedback Control Systems , 2d ed. Saunders College Publishing, New York, 1989. Khadraoui, S., Nounou, H., Nounou, M., Datta, A., and Bhattacharyya, S. P. A measurement-based approach for tuning of reduced-order controllers. American Control Conference (ACC), June 2013, pp. 3876 ‚Äì3881. Kim, S.-H., Kim, J. H., Yang, J., Yang, H., Park, J.-Y., and Park, Y.-P. Tilt Detection and Servo Control Method for the Holographic Data Storage System. Microsyst Technol , vol. 15, 2009. pp. 1695 ‚Äì1700.Minimum Required Software Packages LabVIEW, Control Design and Simulation Module, MathScript RT Module, and MATLAB Prelab 1.Assume a unity-feedback system with a forward-path transfer function, G s¬Ü¬à100 s s¬á5¬Ü. Use MATLAB or any method to determine gain and phase margins. In addition, Ô¨Ånd the percent overshoot, settling time, and peak time of the closed-loop step response. 2.Design a LabVIEW VI that will create a Nic hols chart. Adjust the Nichols chart‚Äô s scale to estimate gain and phase margins. Then, prompt the user to enter the values of gain and phase margins found from the N ichols chart. In response, your VI will produce the percent o vershoot, settling time, and peak time of the closed-loop step response. Lab Run your VI for the system given in the Prelab. Test your VI with other systems of your choice. Postlab Compare the closed-loop performance calculated in the Prelab with those produced by your VI.610 Chapter 10 Frequency Response TechniquesWEBC10 10/28/2014 18:17:4 Kuo, B. C. Automatic Control Systems , 5th ed. Prentice Hall, Upper Saddle River, NJ, 1987. Kuo, F. F. Network Analysis and Synthesis . Wiley, New York, 1966. Lam, P. Y. Gyroscopic Stabilization of a Kid-Size Bicycle. IEEE 5th International Conference on Cybernetics and Intelligent Systems , 2011, pp. 247 ‚Äì252. Low, K. H., Wang, H., Liew, K. M., and Cai, Y. Modeling and Motion Control of Robotic Hand for Telemanipulation Application. International Journal of Software Engineering and Knowledge Engineering , vol. 15, 2005, pp. 147 ‚Äì152. Mahmood, H., and Jiang, J. Modeling and Control System Design of a Grid Connected VSC Considering the Effect of the Interface Transformer Type. IEEE Transactions on Smart Grid , vol. 3, no. 1, March 2012, pp. 122 ‚Äì134. Marttinen, A., Virkkunen, J., and Salminen, R. T. Control Study with Pilot Crane. IEEE Transactions on Education , vol. 33, no. 3, August 1990, pp. 298 ‚Äì305. Nilsson, J. W. Electric Circuits , 3d ed. Addison-Wesley, Reading, MA, 1990. Nyquist, H. Regeneration Theory. Bell Systems Technical Journal, January 1932, pp. 126 ‚Äì147. Ogata, K. Modern Control Engineering , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1990. Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Intelligence and Informatics. IEEE, 2007, pp. 157 ‚Äì162. Roth, E., Reiser, M. B., Dickinson, M. H., Noah, J., and Cowan, N. J. A Task-level Model for Optomotor Yaw Regulation in Drosophila Melanogaster: A Frequency-Domain System Identi Ô¨Åcation Approach. 51st IEEE Conference on Decision and Control , December 10‚Äì13, 2012, pp. 3721 ‚Äì3726. Thomas, B., Soleimani-Mosheni, M., and Fahl√©n, P. Feed-forward in Temperature Control of Buildings. Energy and Buildings , vol. 37, 2005, pp. 755 ‚Äì761. Thomsen, S., Hoffmann, N., and Fuchs, F. W. PI Control, PI-based State Space Control, and Model-Based Predictive Control for Drive Systems With Elastically Coupled Loads ‚ÄîA Comparative Study. IEEE Transactions on Industrial Electronics , vol. 58, no. 8, August 2011, pp. 3647 ‚Äì3657. Van der Zalm, G., Huisman, R., Steinbuch, M., and Veldpaus, F. Frequency Domain Approach for the Design of Heavy-Duty Vehicle Speed Controllers. Int. J. Heavy Vehicle Systems , vol. 15, no. 1, pp. 107 ‚Äì123. Wang, X.-K., Yang, X.-H., Liu, G., and Qian, H. Adaptive Neuro-Fuzzy Inference System PID Controller for Steam Generator Water Level of Nuclear Power Plant, Proceedings of the Eighth International Conference on Machine Learning and Cybernetics , 2009, pp. 567 ‚Äì572.Bibliography 611WEBC10 10/28/2014 18:17:4 Page 612WEBC11 10/28/2014 18:21:5 Design via Frequency Response Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅUse frequency response techniques to adjust the gain to meet a transient response speci Ô¨Åcation (Sections 11.1 ‚Äì11.2) ¬ÅUse frequency response techniques to design cascade compensators to improve the steady-state error (Section 11.3) ¬ÅUse frequency response techniques to design cascade compensators to improve the transient response (Section 11.4) ¬ÅUse frequency response techniques to design cascade compensators to improve both the steady-state error and the transient response (Section 11.5) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with casestudies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to use frequency response techniques to design thegain to meet a transient response speci Ô¨Åcation. ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to use frequency response techniques to design acascade compensator to meet both transient and steady-state error speci Ô¨Åcations.11 613WEBC11 10/28/2014 18:21:5 11.1 Introduction In Chapter 8, we designed the transient response of a control system by adjusting the gain along the root locus. The design process consisted of Ô¨Ånding the transient response speci Ô¨Åcation on the root locus, setting the gain accordingly, and settling for the resulting steady-state error. The disadvantage of design by gain adjustment is that only thetransient response and steady-state error re presented by points along the root locus are available. In order to meet transient response speci Ô¨Åcations represented by points not on the root locus and, independently, steady-state error requirements, we designed cascade compensatorsin Chapter 9. In this chapter, we use Bode plots to parallel the root locus design process fromChapters 8 and 9. Let us begin by drawing some general comparisons between root locus and frequency response design. Stability and transient response design via gain adjustment . Frequency response design methods, unlike root locus methods, can be implemented conveniently without acomputer or other tool except for testing the design. We can easily draw Bode plots using asymptotic approximations and read the gain from the plots. Root locus requires repeated trials to Ô¨Ånd the desired design point from which the gain can be obtained. For example, in designing gain to meet a percent overshoot requirement, root locus requires the search of aradial line for the point where the open-loop transfer function yields an angle of 180 ¬∞.T o evaluate the range of gain for stability, root locus requires a search of the jœâ-axis for 180 ¬∞.O f course, if one uses a computer program, such as MATLAB, the computational disadvantageof root locus vanishes. Transient response design via cascade compensation. Frequency response methods are not as intuitive as the root locus, and it is something of an art to design cascadecompensation with the methods of this chapter. With root locus, we can identify a speci Ô¨Åc point as having a desired transient response characteristic. We can then design cascadecompensation to operate at that point and meet the transient response speci Ô¨Åcations. In Chapter 10, we learned that phase margin is related to percent overshoot (Eq. (10.73)) andbandwidth is related to both damping ratio and settling time or peak time (Eqs. (10.55) and(10.56)). These equations are rather complicated. When we design cascade compensationusing frequency response methods to improve the transient response, we strive to reshape the open-loop transfer function ‚Äôs frequency response to meet both the phase-margin requirement (percent overshoot) and the bandwidth requirement (settling or peak time). There is no easy way to relate all the requirements prior to the reshaping task. Thus, thereshaping of the open-loop transfer function ‚Äôs frequency response can lead to several trials until all transient response requirements are met. Steady-state error design via cascade compensation . An advantage of using frequency design techniques is the ability to design derivative compensation, such as lead compensation,to speed up the system and at the same time build in a desired steady-state error requirement that can be met by the lead compensator alone. Recall that in using root locus there are an inÔ¨Ånite number of possible solutions to the design of a lead compensator. One of the differences between these solutions is the steady-state error. We must make numerous triesto arrive at the solution that yields the required steady-state error performance. With frequencyresponse techniques, we build the steady-state error requirement right into the design of thelead compensator. You are encouraged to re Ô¨Çect on the advantages and disadvantages of root locus and frequency response techniques as you progress through this chapter. Let us take a closer look at frequency response design. When designing via frequency response methods, we use the concepts of stability, transient response, and steady-state error that we learned in Chapter 10. First, the Nyquist criterion tells us how to determine if a system is stable. Typically, an open-loop stable614 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:5 system is stable in closed-loop if the open-loop magnitude frequency response has a gain of less than 0 dB at the frequency where the phase frequency response is 180¬∞ . Second, percent overshoot is reduced by increasing the phase margin, and the speed of the response is increased by increasing the bandwidth. Finally, steady-state error is improved by increasingthe low-frequency magnitude responses, even if the high-frequency magnitude response isattenuated. These, then, are the basic facts underlying our design for stability, transient response, and steady-state error using frequency response methods, where the Nyquist criterion andthe Nyquist diagram compose the underlying theory behind the design process. Thus, even though we use the Bode plots for ease in obtaining the frequency response, the design process can be veri Ô¨Åed with the Nyquist diagram when questions arise about interpreting the Bode plots. In particular, when the structure of the system is changed withadditional compensator poles and zeros, t he Nyquist diagram can offer a valuable perspective. The emphasis in this chapter is on the design of lag, lead, and lag-lead compensation. General design concepts are presented Ô¨Årst, followed by step-by-step procedures. These procedures are only suggestions, and you are encouraged to develop other procedures to arrive at the same goals. Although the concepts in general apply to the design of PI, PD, and PID controllers, in the interest of brevity, detailed procedures and examples will not bepresented. You are encouraged to extrapolate the concepts and designs covered and applythem to problems involving PI, PD, and PID compensation presented at the end of thischapter. Finally, the compensators developed in this chapter can be implemented with therealizations discussed in Section 9.6. 11.2 Transient Response via Gain Adjustment Let us begin our discussion of design via frequency response methods by discussing the linkbetween phase margin, transient response, and gain. In Section 10.10, the relationshipbetween damping ratio (equivalently percent overshoot) and phase margin was derived forG s¬Ü¬àœâ 2 n=s s¬á2Œ∂œân¬Ü. Thus, if we can vary the phase margin, we can vary the percent overshoot. Looking at Figure 11.1, we see that if we desire a phase margin, Œ¶M, represented byCD, we would have to raise the magnitude curve by AB. Thus, a simple gain adjustment can be used to design phase margin and, hence, percent overshoot. M (dB) A BRequired increase in gain Phase (degrees) Clog œâ ‚Äì180log œâ D0 Œ¶MœâŒ¶M FIGURE 11.1 Bode plots showing gain adjustment for a desired phase margin11.2 Transient Response via Gain Adjustment 615WEBC11 10/28/2014 18:21:5 We now outline a procedure by which we can determine the gain to meet a percent overshoot requirement using the open-loop frequency response and assuming dominant second-order closed-loop poles. Design Procedure 1.Draw the Bode magnitude and phase plots for a convenient value of gain. 2.Using Eqs. (4.39) and (10.73), determine the required phase margin from the percent overshoot. 3.Find the frequency, œâŒ¶M, on the Bode phase diagram that yields the desired phase margin, CD, as shown on Figure 11.1. 4.Change the gain by an amount ABto force the magnitude curve to go through 0 dB at œâŒ¶M. The amount of gain adjustment is the additional gain needed to produce the required phase margin. We now look at an example of designing the gain of a third-order system for percent overshoot. Example 11.1 Transient Response Design via Gain AdjustmentTransient Response Design via Gain Adjustment PROBLEM: For the position control system shown in Figure 11.2, Ô¨Ånd the value of preampli Ô¨Åer gain, K, to yield a 9.5% overshoot in the transient response for a step input. Use only frequency response methods. SOLUTION: We will now follow the previously described gain adjustment design procedure. 1.Choose K¬à3:6 to start the magnitude plot at 0 dB at œâ¬à0:1 in Figure 11.3. 2.Using Eq. (4.39), a 9.5% overshoot implies Œ∂¬à0:6 for the closed-loop dominant poles. Equation (10.73) yields a 59.2 ¬∞phase margin for a damping ratio of 0.6. 3.Locate on the phase plot the frequency that yields a 59.2 ¬∞phase margin. This frequency is found where the phase angle is the difference between  180 ¬∞and 59.2 ¬∞,o r 120:8¬∞. The value of the phase-margin frequency is 14.8 rad/s. 4.At a frequency of 14.8 rad/s on the magnitude plot, the gain is found to be  44.2 dB. This magnitude has to be raised to 0 dB to yield the required phase margin. Since the log-magnitude plot was drawn for K¬à3:6, a 44.2 dB increase, or K¬à 3:6162:2¬à583:9, would yield the required phase margin for 9.48% overshoot.+ ‚ÄìShaft position K1 s1 (s + 36)100 (s + 100)Desired position R(s) C(s)Shaft velocity PreamplifierPower amplifierMotor and load FIGURE 11.2 System for Example 11.1616 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:7 The gain-adjusted open-loop transfer function is G s¬Ü¬à58;390 s s¬á36¬Ü s¬á100¬Ü(11.1) Table 11.1 summarizes a computer simulation of the gain-compensated system. Students who are using MATLAB should now run ch11p1 in Appendix B. You will learn how to use MATLAB to design a gain to meet a percentovershoot speci Ô¨Åcation using Bode plots. This exercise solves Example 11.1 using MATLAB.0 ‚Äì10 ‚Äì20 ‚Äì30 ‚Äì40 ‚Äì50 ‚Äì60 ‚Äì70‚Äì800.1 1 10 100 Frequency (rad/s)20 log MMagnitude after gain adjustment Magnitude before gain adjustmentPhase (degrees)‚Äì80 ‚Äì100 ‚Äì120 ‚Äì140 ‚Äì160‚Äì180 ‚Äì200 ‚Äì2200.1 1 10 100 Fre quenc y (rad/s) FIGURE 11.3 Bode magnitude and phase plots for Example 11.1 TABLE 11.1 Characteristic of gain-compensated system of Example 11.1 Parameter Proposed speci Ô¨Åcation Actual value Kv ‚Äî 16.22 Phase margin 59.2 ¬∞ 59.2 ¬∞ Phase-margin frequency ‚Äî 14.8 rad/s Percent overshoot 9.5 10 Peak time ‚Äî 0.18 second11.2 Transient Response via Gain Adjustment 617WEBC11 10/28/2014 18:21:7 In this section, we paralleled our work in Chapter 8 with a discussion of transient response design through gain adjustment. In the next three sections, we parallel the root locus compensator design in Chapter 9 and discuss the design of lag, lead, and lag-leadcompensation via Bode diagrams. 11.3 Lag Compensation In Chapter 9, we used the root locus to design lag networks and PI controllers. Recall thatthese compensators permitted us to design for steady-state error without appreciablyaffecting the transient response. In this section, we provide a parallel development usingthe Bode diagrams. Visualizing Lag Compensation The function of the lag compensator as seen on Bode diagrams is to (1) improve the staticerror constant by increasing only the low-frequency gain without any resulting instability,and (2) increase the phase margin of the system to yield the desired transient response. Theseconcepts are illustrated in Figure 11.4. The uncompensated system is unstable, since the gain at 180 ¬∞is greater than 0 dB. The lag compensator, while not changing the low-frequency gain, does reduce the high-frequency gain. 1Thus, the low-frequency gain of the system can be made high to yieldSkill-Assessment Exercise 11.1 PROBLEM: For a unity feedback system with a forward transfer function G s¬Ü¬àK s s¬á50¬Ü s¬á120¬Ü use frequency response techniques to Ô¨Ånd the value of gain, K, to yield a closed-loop step response with 20% overshoot. ANSWER: K¬à194;200 The complete solution is located at www.wiley.com/college/nise . In the SISOTOOL Window for TryIt 11.1 : 1.Select Import . . . in the File menu. 2.Click on Gin the System Data Window and click Browse ... 3.In the Model Import Window select radio button Workspace and select Gin Available Models . Click Import, then Close. 4.Click Ok in the System Data Window. 5.Right-click in the Bode graph area and be sure all selections under Show are checked. 6.Grab the stability margin point in the magnitude diagram and raise the magnitude curve until the phase curve shows the phase margin calculated by the program andshown in the MATLAB Command Window as Pm. 7.Right-click in the Bode plot area, select Edit Compensator . . . and read the gain under Compensator in the resulting window. 1The name lag compensator comes from the fact that the typical phase angle response for the compensator, as shown in Figure 11.4, is always negative, or lagging in phase angle.TryIt 11.1 Use MATLAB, the Control System Toolbox, and thefollowing statements to solveSkill-Assessment Exercise 11.1. pos=20 z=(-log(pos/100) ) / ... (sqrt(pi^2 +... log(pos/100) ^2) ) Pm=atan(2*z/ ... (sqrt(-2*z^2 +... sqrt(1 +4*z^4) ) ) ) *... (180/pi) G=zpk ( [] ,... [0,-50,-120] ,1) sisotool618 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:8 a large Kvwithout creating instability. This stabilizing effect of the lag network comes about because the gain at 180 ¬∞of phase is reduced below 0 dB. Through judicious design, the magnitude curve can be reshaped, as shown in Figure 11.4, to go through 0 dB at the desired phase margin. Thus, both Kvand the desired transient response can be obtained. We now enumerate a design procedure. Design Procedure 1.Set the gain, K, to the value that satis Ô¨Åes the steady-state error speci Ô¨Åcation and plot the Bode magnitude and phase diagrams for this value of gain. 2.Find the frequency where the phase margin is 5 ¬∞to 12 ¬∞greater than the phase margin that yields the desired transient response ( Ogata ,1990 ). This step compensates for the fact that the phase of the lag compensator may still contribute anywhere from  5¬∞to 12¬∞of phase at the phase-margin frequency. 3.Select a lag compensator whose magnitude response yields a composite Bode magnitudediagram that goes through 0 dB at the frequency found in Step 2 as follows: Draw thecompensator ‚Äôs high-frequency asymptote to yield 0 dB for the compensated system at the frequency found in Step 2. Thus, if the gain at the frequency found in Step 2 is 20 log K PM, then the compensator ‚Äôs high-frequency asymptote will be set at  20 log KPM. Select the upper break frequency to be 1 decade below the frequency found in Step 2;2select the low-frequency asymptote to be at 0 dB. Connect the compensator ‚Äôs high- and low-frequency asymptotes with a  20 dB/decade line to locate the lower break frequency. 4.Reset the system gain, K, to compensate for any attenuation in the lag network in order to keep the static error constant the same as that found in Step 1. From these steps, you see that we are relying upon the initial gain setting to meet the steady-state requirements. Then, we rely upon the lag compensator ‚Äôs 20 dB/decade slope to meet the transient response requirement by setting the 0 dB crossing of themagnitude plot.log œâ Desired phasePhase (degrees) ‚Äì180log œâKvM (dB) Compensated systemUncompensated system Lag compensator Uncompensated system Compensated systemPhase-margin frequency Lag compensator FIGURE 11.4 Visualizing lag compensation 2This value of break frequency ensures that there will be only  5¬∞to 12¬∞phase contribution from the compensator at the frequency found in Step 2.11.3 Lag Compensation 619WEBC11 10/28/2014 18:21:9 The transfer function of the lag compensator is Gc s¬Ü¬às¬á1 T s¬á1 Œ±T(11.2) where Œ±>1. Figure 11.5 shows the frequency response curves for the lag compensator. The range of high frequencies shown in the phase plot is where we will design our phase margin. This region is after the second break frequency of the lag compensator, where we can rely on the attenuation characteristics of the lag network to reduce the total open-loop gain to unity at the phase-margin frequency. Further, in this region the phase response of the compensatorwill have minimal effect on our design of the phase margin. Since there is still some effect,approximately 5 ¬∞to 12 ¬∞, we will add this amount to our phase margin to compensate for the phase response of the lag compensator (see Step 2).20 ‚Äì 20‚Äì 10 ‚Äì 30 ‚Äì 40 ‚Äì 50 ‚Äì 6018 16 1412 10 86 4 2 0 00.00120 log MPhase (degrees)0.01 0.1 Frequency (rad/s) Frequency (rad/s)11 01 00 0.001 0.01 0.1 11 01 00Range of frequencies for the design of the phase margin FIGURE 11.5 Frequency response plots of a lag compensator, Gc s¬Ü¬à s¬á0:1¬Ü= s ¬á0:01¬Ü Example 11.2 Lag Compensation DesignLag Compensation Design PROBLEM: Given the system of Figure 11.2, use Bode diagrams to design a lag compensator to yield a tenfold improvement in steady-state error over the gain-compensated system while keeping the percent overshoot at 9.5%. SOLUTION: We will follow the previously described lag compensation design procedure. 1.From Example 11.1 a gain, K, of 583.9 yields a 9.5% overshoot. Thus, for this system, Kv¬à16:22. For a tenfold improvement in steady-state error, Kvmust increase by a factor of 10, or Kv¬à162:2. Therefore, the value of Kin Figure 11.2 equals 5839, and620 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:9 the open-loop transfer function is G s¬Ü¬à583;900 s s¬á36¬Ü s¬á100¬Ü(11.3) The Bode plots for K¬à5839 are shown in Figure 11.6. 2.The phase margin required for a 9.5% overshoot Œ∂¬à0:6¬Üis found from Eq. (10.73) to be 59.2 ¬∞. We increase this value of phase margin by 10¬∞ to 69.2 ¬∞in order to compensate for the phase angle contribution of the lag compensator. Now Ô¨Ånd the frequency where the phase margin is 69.2 ¬∞. This frequency occurs at a phase angle of  180 ¬∞¬á69:2¬∞¬à 110:8¬∞and is 9.8 rad/s. At this frequency, the magnitude plot must go through 0 dB. The magnitude at 9.8 rad/s is now +24 dB (exact, that is, nonasymptotic). Thus, the lag compensator must provide  24 dB attenuation at 9.8 rad/s. 3.&4. We now design the compensator. First draw the high-frequency asymptote at  24 dB. Arbitrarily select the higher break frequency to be about one decade below the phase-margin frequency, or 0.98 rad/s. Starting at the intersection of this frequency with the lag compensator ‚Äôs high-frequency asymptote, draw a  20 dB/decade line until 0 dB is reached. The compensator must have a dc gain of unity to retain the value of Kv that we have already designed by setting K¬à5839. The lower break frequency is found to be 0.062 rad/s. Hence, the lag compensator ‚Äôs transfer function is Gc s¬Ü¬à0:063 s¬á0:98¬Ü s¬á0:062¬Ü(11.4) where the gain of the compensator is 0.063 to yield a dc gain of unity.0.01 0.1 1 10 100 Frequenc y (rad/s)0 ‚Äì50 ‚Äì100 ‚Äì150 ‚Äì200‚Äì250Phase (degrees)Lag compensator Uncompensated system Lag-compensated system84 726048362412 0 ‚Äì12‚Äì24‚Äì36‚Äì48‚Äì60 0.01 0.1 1 10 100 Frequency (rad/s)20 log M Lag compensatorUncompensated system Compensated system FIGURE 11.6 Bode plots for Example 11.211.3 Lag Compensation 621WEBC11 10/28/2014 18:21:11 The compensated system ‚Äôs forward transfer function is thus G s¬ÜGc s¬Ü¬à36;786 s¬á0:98¬Ü s s¬á36¬Ü s¬á100¬Ü s¬á0:062¬Ü(11.5) The characteristics of the compensated system, found from a simulation and exact frequency response plots, are summarized in Table 11.2. Students who are using MATLAB should now run ch11p2 in Appendix B.You will learn how to use MATLAB to design a lag compensator. Youwill enter the value of gain to meet the steady-state errorrequirement as well as the desired percent overshoot. MATLABthen designs a lag compensator using Bode plots, evaluates K v, and generates a closed-loop step response. This exercise solves Example 11.2 using MATLAB.TABLE 11.2 Characteristics of the lag-compensated system of Example 11.2 Parameter Proposed speci Ô¨Åcation Actual value Kv 162.2 161.5 Phase margin 59.2 ¬∞ 62¬∞ Phase-margin frequency ‚Äî 11 rad/s Percent overshoot 9.5 10 Peak time ‚Äî 0.25 second Skill-Assessment Exercise 11.2 PROBLEM: Design a lag compensator for the system in Skill-Assessment Exercise 11.1 that will improve the steady-state error tenfold, while still operating with 20% overshoot. ANSWER: Glag s¬Ü¬à0:0691 s¬á2:04¬Ü s¬á0:141¬Ü;G s¬Ü¬à1;942;000 s s¬á50¬Ü s¬á120¬Ü The complete solution is at www.wiley.com/college/nise . TryIt 11.2 Use MATLAB, the Control System Toolbox, and the following statements to solve Skill-Assessment Exercise 11.2. pos=20 Ts=0.2 z=( log(pos/100) ) / (sqrt(pi^2 +log(pos/100) ^2) ) Pm=atan(2*z/ (sqrt(  2*z^2 +sqrt(1 +4*z^4) ) ) ) * (180/pi) Wbw=(4/ (Ts*z) ) *sqrt( (1  2*z^2) +sqrt(4*z^4-4*z^2 +2) ) K=1942000 G=zpk( [] , [0,  50, 120],K ) sisotool(G,1) (TryIt continues)622 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:11 In this section, we showed how to design a lag compensator to improve the steady-state error while keeping the transient response relatively unaffected. We next discuss how to improve the transient response using frequency response methods. 11.4 Lead Compensation For second-order systems, we derived the relationship between phase margin and percent overshoot as well as the relationship between closed-loop bandwidth and other time-domainspeciÔ¨Åcations, such as settling time, peak time, and rise time. When we designed the lag network to improve the steady-state error, we wanted a minimal effect on the phase diagramin order to yield an imperceptible change in the transient response. However, in designinglead compensators via Bode plots, we want to change the phase diagram. We want toincrease the phase margin to reduce the percent overshoot, and increase the gain crossoverto realize a faster transient response. Visualizing Lead Compensation The lead compensator increases the bandwidth by increasing the gain crossover frequency.At the same time, the phase diagram is raised at higher frequencies. The result is a largerphase margin and a higher phase-margin frequency. In the time domain, lower percentovershoots (larger phase margins) with smaller peak times (higher phase-margin frequencies) is the result. The concepts are shown in Figure 11.7. The uncompensated system has a small phase margin ( B) and a low phase-margin frequency ( A). Using a phase lead compensator, the phase angle plot (compensated system) is raised for higher frequencies. 3At the same time, the gain crossover frequency in the magnitude plot is increased from Arad/s to Crad/s. These effects yield a larger phase margin (D), a higher phase-margin frequency ( C), and a larger bandwidth. One advantage of the frequency response technique over the root locus is that we can implement a steady-state error requirement and then design a transient response. ThisspeciÔ¨Åcation of transient response with the constraint of a steady-state error is easier to implement with the frequency response technique than with the root locus. Notice that the initial slope, which determines the steady-state error, is not affected by the design for thetransient response. 3The name lead compensator comes from the fact that the typical phase angle response shown in Figure 11.7 is always positive, or leading in phase angle.(TryIt continued ) When the SISO Design for SISO Design Task Window appears: Right-click on the Bode plot area and select Grid. Note the phase margin shown in the MATLAB Command Window. Using the Bode phase plot, estimate the frequency at which the phase margin from Step 2 occurs. On the SISO Design for SISO Design Task Window toolbar , click on the red zero. Place the zero of the compensator by clicking on the gain plot at a frequency that is 1/10 that found in Step 3. On the SISO Design for SISO Design Task Window toolbar , click on the red pole. Place the pole of the compensator by clicking on the gain plot to the left of the compensator zero. Grab the pole with the mouse and move it until the phase plot shows a P.M. equal to that found in Step 2. Right-click in the Bode plot area and select Edit Compensator . . . Read the lag compensator in the Control and Estimation Tools Manager Window.11.4 Lead Compensation 623WEBC11 10/28/2014 18:21:11 Lead Compensator Frequency Response Let us Ô¨Årst look at the frequency response characteristics of a lead network and derive some valuable relationships that will help us in the design process. Figure 11.8 shows plots of the lead network Gc s¬Ü¬à1 Œ≤s¬á1 T s¬á1 Œ≤T(11.6) for various values of Œ≤,w h e r e Œ≤<1. Notice that the peaks of the phase curve vary in maximum angle and in the frequency at which the maximum occurs. The dc gain of the compensator is set to unity with the coef Ô¨Åcient 1 =Œ≤, in order not to change the dc gain designed for the static error constant when the compensator is inserted into the system. In order to design a lead compensator and change both the phase margin and phase-margin frequency, it is helpful to have an analytical expression for the maximumvalue of phase and the frequency at which the maximum value of phase occurs, asshown in Figure 11.8. From Eq. (11.6) the phase angle of the lead compensator, œï c,i s œïc¬àtan 1œâT tan 1œâŒ≤T (11.7) Differentiating with respect to œâ, we obtain dœïc dœâ¬àT 1¬á œâT¬Ü2 Œ≤T 1¬á œâŒ≤T¬Ü2(11.8)M (dB) log œâ Phase (degrees)Uncompensated systemACompensated systemCompensator C Compensator Compensated system BD ‚Äì180 ‚Äì270Uncompensated systemlog œâ 00 FIGURE 11.7 Visualizing lead compensation624 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:11 Setting Eq. (11.8) equal to zero, we Ô¨Ånd that the frequency, œâmax, at which the maximum phase angle, œïmax, occurs is œâmax¬à1 TÔ¨ÉÔ¨ÉÔ¨É Œ≤p (11.9) Substituting Eq. (11.9) into Eq. (11.6) with s¬àjœâmax, Gc jœâmax¬Ü¬à1 Œ≤jœâmax¬á1 T jœâmax¬á1 Œ≤T¬àj1Ô¨ÉÔ¨ÉÔ¨É Œ≤p¬á1 jÔ¨ÉÔ¨ÉÔ¨ÉŒ≤p ¬á1(11.10) Making use of tan œï 1 œï2¬Ü¬à tanœï1 tanœï2¬Ü= 1¬átanœï1tanœï2¬Ü, the maximum phase shift of the compensator, œïmax,i s œïmax¬àtan 11 Œ≤ 2Ô¨ÉÔ¨ÉÔ¨É Œ≤p¬àsin 11 Œ≤ 1¬áŒ≤(11.11) and the compensator ‚Äôs magnitude at œâmaxis jGc jœâmax¬Üj¬à1Ô¨ÉÔ¨ÉÔ¨ÉŒ≤p (11.12) We are now ready to enumerate a design procedure.20 log M Phase (degrees)0.1 0.111 0Œ≤ = 0.2 œâTœâT20 20 1030405060 018 16 14 12 10 86 4 2 0 100 11 0 100Œ≤ = 0.2Œ≤ = 0.1 Œ≤ = 0.3 Œ≤ = 0.4 Œ≤ = 0.5Œ≤ = 0.1 Œ≤ = 0.3 Œ≤ = 0.4 Œ≤ = 0.5 FIGURE 11.8 Frequency response of a lead compensator, Gc s¬Ü¬à¬â1=Œ≤¬ä¬â s¬á1=T¬Ü= s¬á1=Œ≤T¬Ü¬ä11.4 Lead Compensation 625WEBC11 10/28/2014 18:21:13 Design Procedure 1.Find the closed-loop bandwidth required to meet the settling time, peak time, or rise time requirement (see Eqs. (10.54) through (10.56)). 2.Since the lead compensator has negligible effect at low frequencies, set the gain, K,o f the uncompensated system to the value that satis Ô¨Åes the steady-state error requirement. 3.Plot the Bode magnitude and phase diagrams for this value of gain and determine theuncompensated system ‚Äôs phase margin. 4.Find the phase margin to meet the damping ratio or percent overshoot requirement. Then evaluate the additional phase contribution required from the compensator. 4 5.Determine the value of Œ≤(see Eqs. (11.6) and (11.11)) from the lead compensator ‚Äôs required phase contribution. 6.Determine the compensator ‚Äôs magnitude at the peak of the phase curve (Eq. (11.12)). 7.Determine the new phase-margin frequency by Ô¨Ånding where the uncompensated system ‚Äôs magnitude curve is the negative of the lead compensator ‚Äôs magnitude at the peak of the compensator ‚Äôs phase curve. 8.Design the lead compensator ‚Äôs break frequencies, using Eqs. (11.6) and (11.9) to Ô¨Ånd Tand the break frequencies. 9.Reset the system gain to compensate for the lead compensator ‚Äôs gain. 10.Check the bandwidth to be sure the speed requirement in Step 1 has been met. 11.Simulate to be sure all requirements are met. 12.Redesign, if necessary, to meet requirements. From these steps, we see that we are increasing both the amount of phase margin (improving percent overshoot) and the gain crossover frequency (increasing the speed).Now that we have enumerated a procedure with which we can design a lead compensator to improve the transient response, let us demonstrate. Example 11.3 Lead Compensation DesignLead Compensation Design PROBLEM: Given the system of Figure 11.2, design a lead compensator to yield a 20% overshoot and Kv¬à40, with a peak time of 0.1 second. SOLUTION: The uncompensated system is G s¬Ü¬à100K=¬âs s¬á36¬Ü s¬á100¬Ü¬ä. We will follow the outlined procedure. 1.WeÔ¨Årst look at the closed-loop bandwidth needed to meet the speed requirement imposed by Tp¬à0:1 second. From Eq. (10.56), with Tp¬à0:1 second and Œ∂¬à0:456 (i.e., 20% overshoot), a closed-loop bandwidth of 46.6 rad/s is required. 2.In order to meet the speci Ô¨Åcation of Kv¬à40,Kmust be set at 1440, yielding G s¬Ü¬à144;000=¬âs s¬á36¬Ü s¬á100¬Ü¬ä. 4We know that the phase-margin frequency will be increased after the insertion of the compensator. At this new phase-margin frequency, the system ‚Äôs phase will be smaller than originally estimated, as seen by comparing points BandDin Figure 11.7. Hence, an additional phase should be added to that provided by the lead compensator to correct for the phase reduction caused by the original system.626 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:13 3.The uncompensated system ‚Äôs frequency response plots for K¬à1440 are shown in Figure 11.9. 4.A 20% overshoot implies a phase margin of 48.1 ¬∞. The uncompensated system with K¬à1440 has a phase margin of 34 ¬∞at a phase-margin frequency of 29.6. To increase the phase margin, we insert a lead network that adds enough phase to yield a4 8 . 1 ¬∞phase margin. Since we know that the lead network will also increase the phase-margin frequency, we add a correction factor to compensate for the loweruncompensated system ‚Äôs phase angle at this higher phase-margin frequency. Since we do not know the higher phase-margin frequency, we assume a correction factorof 10 ¬∞. Thus, the total phase contribution required from the compensator is 48:1¬∞ 34¬∞¬á10¬∞¬à24:1¬∞. In summary, our compensated system should have a phase margin of 48.1 ¬∞with a bandwidth of 46.6 rad/s. If the system ‚Äôs characteristics are not acceptable after the design, then a redesign with a different correction factormay be necessary. 5.Using Eq. (11.11), Œ≤¬à0:42 for œï max¬à24:1¬∞. 6.From Eq. (11.12), the lead compensator ‚Äôs magnitude is 3.76 dB at œâmax. 7.If we select œâmaxto be the new phase-margin frequency, the uncompensated system ‚Äôs magnitude at this frequency must be  3.76 dB to yield a 0 dB crossover at œâmaxfor the compensated system. The uncompensated system passes through  3.76 dB at œâmax¬à39 rad/s. This frequency is thus the new phase-margin frequency. 8.We now Ô¨Ånd the lead compensator ‚Äôs break frequencies. From Eq. (11.9), 1 =T¬à25:3 and 1 =Œ≤T¬à60:2.100020 log MPhase (degrees) 100100 0 Frequency (rad/sec)11 101036 24 12 ‚Äì12 ‚Äì24 ‚Äì360 ‚Äì 45 45 ‚Äì90 ‚Äì135 ‚Äì180 ‚Äì225 ‚Äì270 1000Frequency (rad/sec)Lead compensator Compensated system Uncompensated system Lead compensator Compensated systemUncompensated system FIGURE 11.9 Bode plots for lead compensation in Example 11.311.4 Lead Compensation 627WEBC11 10/28/2014 18:21:15 9.Hence, the compensator is given by Gc s¬Ü¬à1 Œ≤s¬á1 T s¬á1 Œ≤T¬à2:38s¬á25:3 s¬á60:2(11.13) where 2.38 is the gain required to keep the dc gain of the compensator at unity so that Kv¬à40 after the compensator is inserted. TheÔ¨Ånal, compensated open-loop transfer function is then Gc s¬ÜG s¬Ü¬à342;600 s¬á25:3¬Ü s s¬á36¬Ü s¬á100¬Ü s¬á60:2¬Ü(11.14) 10.From Figure 11.9, the lead-compensated open-loop magnitude response is  7d B at approximately 68.8 rad/s. Thus, we estimate the closed-loop bandwidth to be68.8 rad/s. Since this bandwidth exceeds t he requirement of 46.6 rad/s, we assume t h ep e a kt i m es p e c i Ô¨Åcation is met. This conclusio n about the peak time is based upon a second-order and asymptotic appr oximation that will be checked via simulation. 11.Figure 11.9 summarizes the design and shows the effect of the compensation. Finalresults, obtained from a simulation and the actual (nonasymptotic) frequencyresponse, are shown in Table 11.3. Notice the increase in phase margin, phase-margin frequency, and closed-loop bandwidth after the lead compensator was addedto the gain-adjusted system. The peak time and the steady-state error requirementshave been met, although the phase margin is less than that proposed and thepercent overshoot is 2.6% larger than proposed. Finally, if the performance is notacceptable, a redesign is necessary. Students who are using MATLAB should now run ch11p3 in Appendix B. You will learn how to use MATLAB to design a lead compensator. Youwill enter the desired percent overshoot, peak time, and K v. MATLAB then designs a lead compensator using Bode plots, evaluates Kv, and generates a closed-loop step response. This exercise solves Example 11.3 using MATLAB.TABLE 11.3 Characteristic of the lead-compensated system of Example 11.3 ParameterProposed speci Ô¨ÅcationActual gain- compensated valueActual lead- compensated value Kv 40 40 40 Phase margin 48.1 ¬∞ 34¬∞ 45.5 ¬∞ Phase-margin frequency ‚Äî 29.6 rad/s 39 rad/s Closed-loop bandwidth 46.6 rad/s 50 rad/s 68.8 rad/s Percent overshoot 20 37 22.6 Peak time 0.1 second 0.1 second 0.075 second628 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:16 Keep in mind that the previous examples were designs for third-order systems and must be simulated to ensure the desired transient results. In the next section, we look at lag-lead compensation to improve steady-state error and transient response. 11.5 Lag-Lead Compensation In Section 9.4, using root locus, we designed lag-lead compensation to improve the transientresponse and steady-state error. Figure 11.10 is an example of a system to which lag-leadcompensation can be applied. In this section we repeat the design, using frequency responsetechniques. One method is to design the lag compensation to lower the high-frequency gain,Skill-Assessment Exercise 11.3 PROBLEM: Design a lead compensator for the system in Skill-Assessment Exercise 11.1 to meet the following speciÔ¨Å cations: %OS¬à20%;Ts¬à0:2sa n d Kv¬à50. ANSWER: Glead s¬Ü¬à2:27 s¬á33:2¬Ü s¬á75:4¬Ü;G s¬Ü¬à300;000 s s¬á50¬Ü s¬á120¬Ü The complete solution is at www.wiley.com/college/nise . TryIt 11.3 Use MATLAB, the Control System Toolbox, and the following statements to solve Skill-Assessment Exercise 11.3. pos=20 Ts=0.2 z=(-log(pos/100) ) / (sqrt(pi^2 +log(pos/100) ^2) ) Pm=atan(2*z/ (sqrt(-2*z^2 +sqrt(1 +4*z^4) ) ) )*(180/pi) Wbw=(4/ (Ts*z) ) *sqrt( (1-2*z^2) +sqrt(4*z^4-4*z^2 +2) ) K=50*50*120 G=zpk( [] , [0,-50,-120] ,K) sisotool(G,1) When the SISO Design for SISO Design Task Window appears: Right-click on the Bode plot area and select Grid. Note the phase margin and bandwidth shown in the MATLAB Command Window. On the SISO Design for SISO Design Task Window toolbar, click on the red pole. Place the pole of the compensator by clicking on the gain plot at a frequency that is to the right of the desired bandwidth found in Step 2. On the SISO Design for SISO Design Task Window toolbar, click on the red zero. Place the zero of the compensator by clicking on the gain plot to the left of the desired bandwidth. Reshape the Bode plots: alternately grab the pole and the zero with the mouse and alternately move them along the phase plot until the phase plot shows a P.M. equal to that found in Step 2 and a phase- margin frequency close to the bandwidth found in Step 2. Right-click in the Bode plot area and select Edit Compensator ... Read the lead compensator in the Control and Estimation Tools Manager Window.11.5 Lag-Lead Compensation 629WEBC11 10/28/2014 18:21:16 stabilize the system, and improve the steady-state error and then design a lead compensator to meet the phase-margin requirements. Let us look at another method. Section 9.6 describes a passive lag-lead network that can be used in place of separate lag and lead networks. It may be more economical to use a single, passive network thatperforms both tasks, since the buffer ampli Ô¨Åer that separates the lag network from the lead network may be eliminated. In this section, we emphasize lag-lead design, using a single,passive lag-lead network. The transfer function of a single, passive lag-lead network is G c s¬Ü¬àGLead s¬ÜGLag s¬Ü¬às¬á1 T1 s¬áŒ≥ T10 BB@1 CCAs¬á1 T2 s¬á1 Œ≥T20 BB@1 CCA(11.15) where Œ≥>1. The Ô¨Årst term in parentheses produces the lead compensation, and the second term in parentheses produces the lag compensation. The constraint that we must follow here is that the single value Œ≥replaces the quantity Œ±for the lag network in Eq. (11.2) and the quantity Œ≤for the lead network in Eq. (11.6). For our design, Œ±andŒ≤must be reciprocals of each other. An example of the frequency response of the passive lag-lead is shown inFigure 11.11. We are now ready to enumerate a design procedure. Design Procedure 1.Using a second-order approximation, Ô¨Ånd the closed-loop bandwidth required to meet the settling time, peak time, or rise time requirement (see Eqs. (10.55) and (10.56)). 2.Set the gain, K, to the value required by the steady-state error speci Ô¨Åcation. 3.Plot the Bode magnitude and phase diagrams for this value of gain. (a) Katharina Bosse/laif/Redux Pictures. (b) Katharina Bosse/laif/Redux Pictures. FIGURE 11.10 a.The National Advanced Driving Simulator at the University of Iowa; b.test driving the simulator with its realistic graphics630 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:16 4.Using a second-order approximation, calculate the phase margin to meet the damping ratio or percent overshoot requirement, using Eq. (10.73). 5.Select a new phase-margin frequency near œâBW. 6.At the new phase-margin frequency, determine the additional amount of phase leadrequired to meet the phase-margin requirement. Add a small contribution that will berequired after the addition of the lag compensator. 7.Design the lag compensator by selecting the higher break frequency one decade belowthe new phase-margin frequency. The design of the lag compensator is not critical, andany design for the proper phase margin will be relegated to the lead compensator. Thelag compensator simply provides stabilization of the system with the gain required forthe steady-state error speci Ô¨Åcation. Find the value of Œ≥from the lead compensator ‚Äôs requirements. Using the phase required from the lead compensator, the phase responsecurve of Figure 11.8 can be used to Ô¨Ånd the value of Œ≥¬à1=Œ≤. This value, along with the previously found lag ‚Äôs upper break frequency, allows us to Ô¨Ånd the lag ‚Äôs lower break frequency. 8.Design the lead compensator. Using the value of Œ≥from the lag compensator design and the value assumed for the new phase-margin frequency, Ô¨Ånd the lower and upper break frequencies for the lead compensator, using Eq. (11.9) and solvingforT. 9.Check the bandwidth to be sure the speed requirement in Step 1 has been met. 10.Redesign if phase-margin or transient speci Ô¨Åcations are not met, as shown by analysis or simulation.20 log M Phase (degrees) Frequency (rad/s)100 10 1 0.1 0.01 0.001100 10 1 0.1 0.01 0.001‚Äì 35‚Äì 30‚Äì 25‚Äì 20‚Äì 15‚Äì 10‚Äì 50 ‚Äì 80‚Äì 60‚Äì 40‚Äì 20020406080Frequency (rad/s)20 30 5040Asymptotes for 20 30 40 5050 40 30 20 10 FIGURE 11.11 Sample frequency response curves for a lag-lead compensator, Gc s¬Ü¬à¬â s¬á1¬Ü s¬á0:1¬Ü¬ä= s¬áŒ≥¬Üs¬á0:1 Œ≥/C18/C19 /C20/C2111.5 Lag-Lead Compensation 631WEBC11 10/28/2014 18:21:18 Let us demonstrate the procedure with an example. Example 11.4 Lag-Lead Compensation DesignLag-Lead Compensation Design PROBLEM: Given a unity feedback system where G s¬Ü¬àK=¬âs s¬á1¬Ü s¬á4¬Ü¬ä, design a passive lag-lead compensator using Bode diagrams to yield a 13.25% overshoot, a peak time of 2 seconds, and Kv¬à12. SOLUTION: We will follow the steps previously mentioned in this section for lag-lead design. 1.The bandwidth required for a 2-seconds peak time is 2.29 rad/s. 2.In order to meet the steady-state error requirement, Kv¬à12, the value of Kis 48. 3.The Bode plots for the uncompensated system with K¬à48 are shown in Figure 11.12. We can see that the system is unstable. 4.The required phase margin to yield a 13.25% overshoot is 55 ¬∞. 5.Let us select œâ¬à1:8 rad/s as the new phase-margin frequency. 6.At this frequency, the uncompensated phase is  176 ¬∞and would require, if we add a  5¬∞contribution from the lag compensator, a 56 ¬∞contribution from the lead portion of the compensator. 7.The design of the lag compensator is next. The lag compensator allows us to keep the gain of 48 required for Kv¬à12 and not have to lower the gain to stabilize the system. As long as the lag compensator stabilizes the system, the design parameters are notcritical, since the phase margin will be designed with the lead compensator. Thus, choose the lag compensator so that its phase response will have minimal effect at the new phase-margin frequency. Let us choose the lag compensator ‚Äôs higher break frequency to be 1 decade below the new phase-margin frequency, at 0.18 rad/s. Sincewe need to add 56 ¬∞of phase shift with the lead compensator at œâ¬à1:8r a d / s ,w ee s t i m a t e from Figure 11.8 that, if Œ≥¬à10:6( s i n c e Œ≥¬à1=Œ≤;Œ≤¬à0:094), we can obtain about 56 ¬∞of phase shift from the lead compensator. Thus with Œ≥¬à10:6 and a new phase-margin frequency of œâ¬à1:8 rad/s, the transfer function of the lag compensator is G lag s¬Ü¬à1 Œ≥s¬á1 T2/C18/C19 s¬á1 Œ≥T2/C18/C19 ¬à1 10:6 s¬á0:183¬Ü s¬á0:0172 ¬Ü(11.16) where the gain term, 1 =Œ≥, keeps the dc gain of the lag compensator at 0 dB. The lag-compensated system ‚Äôs open-loop transfer function is Glag-comp s¬Ü¬à4:53 s¬á0:183¬Ü s s¬á1¬Ü s¬á4¬Ü s¬á0:0172 ¬Ü(11.17) 8.Now we design the lead compensator. At œâ¬à1:8, the lag-compensated system has a phase angle of 180 ¬∞. Using the values of œâmax¬à1:8 and Œ≤¬à0:094, Eq. (11.9) yields the lower break, 1= T1¬à0:56 rad/s. The higher break is then 1 =Œ≤T1¬à5:96 rad/s. The lead compensator is Glead s¬Ü¬àŒ≥s¬á1 T1/C18/C19 s¬áŒ≥ T1/C18/C19 ¬à10:6 s¬á0:56¬Ü s¬á5:96¬Ü(11.18)632 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:19 The lag-lead-compensated system ‚Äôs open-loop transfer function is Glag-lead-comp s¬Ü¬à48 s¬á0:183¬Ü s¬á0:56¬Ü s s¬á1¬Ü s¬á4¬Ü s¬á0:0172 ¬Ü s¬á5:96¬Ü(11.19) 9.Now check the bandwidth. The closed-loop bandwidth is equal to that frequency where the open-loop magnitude response is approximately  7 dB. From Figure 11.12, the magnitude is  7 dB at approximately 3 rad/s. This bandwidth exceeds that required to meet the peak time requirement. The design is now checked with a simulation to obtain actual performance values. Table 11.4 summarizes the system ‚Äôs characteristics. The peak time requirement is also met. Again, if the requirements were not met, a redesign would be necessary. Students who are using MATLAB should now run ch11p4 in Appendix B. You will learn how to use MATLAB to design a lag-lead compensator. You will enter the desired percent overshoot, peak time, and Kv. MATLAB then designs a lag-lead compensator using Bode plots,evaluates K v, and generates a closed-loop step response. This exercise solves Example 11.4 using MATLAB..01 0.1 1 10 10084 726048362412 0 ‚Äì12 ‚Äì24 ‚Äì36 ‚Äì48 ‚Äì60 Frequency (rad/s)20 log M 0.01 0.1 1 10 100‚Äì250100 Frequenc y (rad/s)Phase (degrees) ‚Äì300‚Äì200‚Äì150‚Äì100‚Äì50050 Lag-lead-compensated systemLag-compensated systemLag-lead compensator Uncompensated systemUncompensated system Lag-lead compensatorLag-lead-compensated systemLag-compensated system FIGURE 11.12 Bode plots for lag-lead compensation in Example 11.4 TABLE 11.4 Characteristics of gain-compensated system of Example 11.4 Parameter Proposed speci Ô¨Åcation Actual value Kv 12 12 Phase margin 55¬∞ 59.3 ¬∞ Phase-margin frequency ‚Äî 1.63 rad/s Closed-loop bandwidth 2.29 rad/s 3 rad/s Percent overshoot 13.25 10.2 Peak time 2.0 seconds 1.61 seconds11.5 Lag-Lead Compensation 633WEBC11 10/28/2014 18:21:19 For a Ô¨Ånal example, we include the design of a lag-lead compensator using a Nichols chart. Recall from Chapter 10 that the Nichols chart contains a presentation of both the open-loop frequency response and the closed-loop frequency response. The axes of theNichols chart are the open-loop magnitude and phase ( yandxaxis, respectively). The open- loop frequency response is plotted using the coordinates of the Nichols chart at eachfrequency. The open-loop plot is overlaying a grid that yields the closed-loop magnitudeand phase. Thus, we have a presentation of both the open- and closed-loop responses.Thus, a design can be implemented that reshapes the Nichols plot to meet both open-andclosed-loop frequency speci Ô¨Åcations. From a Nichols chart, we can see simultaneously the following frequency response speciÔ¨Åcations that are used to design a desired time response: (1) phase margin, (2) gain margin, (3) closed-loop bandwidth, and (4) closed-loop peak amplitude. In the following example, we Ô¨Årst specify the following: (1) maximum allowable percent overshoot, (2) maximum allowable peak time, and (3) minimum allowable staticerror constant. We Ô¨Årst design the lead compensator to meet the transient requirements followed by the lag compensator design to meet the steady-state error requirement.Although calculations could be made by hand, we will use MATLAB and SISOTOOL to make and shape the Nichols plot. Let us Ô¨Årst outline the steps that we will take in the example: 1.Calculate the damping ratio from the percent overshoot requirement using Eq. (4.39) 2.Calculate the peak amplitude, M p, of the closed-loop response using Eq. (10.52) and the damping ratio found in (1). 3.Calculate the minimum closed-loop bandwidth to meet the peak time requirement usingEq. (10.56), with peak time and the damping ratio from (1). 4.Plot the open-loop response on the Nichols chart. 5.Raise the open-loop gain until the open-loop plot is tangent to the required closed-loopmagnitude curve, yielding the proper M p. 6.Place the lead zero at this point of tangency and the lead pole at a higher frequency. Zeros and poles are added in SISOTOOL by clicking either one on the tool bar and then clicking the position on the open-loop frequency response curve where you desire toadd the zero or pole. 7.Adjust the positions of the lead zero and pole until the open-loop frequency responseplot is tangent to the same M pcurve, but at the approximate frequency found in (3). This yields the proper closed-loop peak and proper bandwidth to yield the desired percentovershoot and peak time, respectively. 8.Evaluate the open-loop transfer function, which is the product of the plant and the leadcompensator, and determine the static error constant. 9.If the static error constant is lower than required, a lag compensator must now be designed. Determine how much improvement in the static error constant isrequired. 10.Recalling that the lag pole is at a frequency below that of the lag zero, place alag pole and zero at frequencies below the lead compensator and adjust to yieldthe desired improvement in static erro r constant. As an example, recall from Eq. (9.5) that the improvement in static error constant for a Type 1 system isequal to the ratio of the lag zero value divided by the lag pole value. Readjust thegain if necessary.634 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:20 Example 11.5 Lag-Lead Design Using the Nichols Chart, MATLAB, andSISO TOOLLag-Lead Design Using the Nichols Chart, MATLAB,and SISOTOOL PROBLEM: Design a lag-lead compensator for the plant, G s¬Ü¬àK s s¬á5¬Ü s¬á10¬Ü,t o meet the following requirements: (1) a maximum of 20% overshoot, (2) a peak time of no more than 0.5 seconds, (3) a static error constant of no less than 6. SOLUTION: We follow the steps enumerated immediately above, 1.Using Eq. (4.39), Œ∂¬à0:456 for 20% overshoot. 2.Using Eq. (10.52), Mp¬à1:23¬à1:81 dB for Œ∂¬à0:456. 3.Using Eq. (10.56), œâBW¬à9:3 r/s for Œ∂¬à0:456 and Tp¬à0:5. 4.Plot the open-loop frequency response curve on the Nichols chart for K=1. 5.Raise the open-loop frequency response curve until it is tangent to the closed-loop peak of 1.81 dB curve as shown in Figure 11.13. The frequency at the tangent point isapproximately 3 r/s, which can be found by letting your mouse rest on the point oftangency. On the menu bar, select Designs/Edit Compensator . . . and Ô¨Ånd the gain added to the plant. Thus, the plant is now G s¬Ü¬à 150 s s¬á5¬Ü s¬á10¬Ü. The gain-adjusted closed-loop step response is shown in Figure 11.14. Notice that the peak time is about1 second and must be decreased. 6.Place the lead zero at this point of tangency and the lead pole at a higher frequency. 7.Adjust the positions of the lead zero and pole until the open-loop frequency responseplot is tangent to the same M pcurve, but at the approximate frequency found in 3. FIGURE 11.13 Nichols chart after gain adjustment11.5 Lag-Lead Compensation 635WEBC11 10/28/2014 18:21:21 FIGURE 11.14 Gain- adjusted closed-loop step response FIGURE 11.15 Nichols chart after lag-lead compensation636 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:22 8.Checking Designs/Edit Compensator . . . shows G s¬ÜGlead s¬Ü¬à1286 s¬á1:4¬Ü s s¬á5¬Ü s¬á10¬Ü s¬á12¬Ü, which yields a Kv¬à3. 9.We now add lag compensation to improve the static error constant by at least 2. 10.Now add a lag pole at  0.004 and a lag zero at  0.008. Readjust the gain to yield the same tangency as after the insertion of the lead. The Ô¨Ånal forward path is found to be G s¬ÜGlead s¬ÜGlag s¬Ü¬à1381 s¬á1:4¬Ü s¬á0:008¬Ü s s¬á5¬Ü s¬á10¬Ü s¬á12¬Ü s¬á0:004¬Ü. The Ô¨Ånal Nichols chart is shown in Figure 11.15, and the compensated time response is shown in Figure 11.16. Notice that the time response has the expected slow climb to the Ô¨Ånal value that is typical of lag compensation. If your design requirements require a faster climb to the Ô¨Ånal response, then redesign the system with a larger bandwidth or attempt a designonly with lead compensation. A problem at the end of the chapter provides theopportunity for practice. FIGURE 11.16 Lag-lead compensated closed-loop step response Skill-Assessment Exercise 11.4 PROBLEM: Design a lag-lead compensator for a unity feedback system with the forward-path transfer function G s¬Ü¬àK s s¬á8¬Ü s¬á30¬Ü to meet the following speci Ô¨Åcations: %OS¬à10%;Tp¬à0:6s , a n d Kv¬à10. Use frequency response techniques. ANSWER: Glag s¬Ü¬à0:456 s¬á0:602¬Ü s¬á0:275¬Ü;Glead s¬Ü¬à2:19 s¬á4:07¬Ü s¬á8:93¬Ü;K¬à2400 : The complete solution is at www.wiley.com/college/nise .11.5 Lag-Lead Compensation 637WEBC11 10/28/2014 18:21:24 Case Studies Our ongoing antenna azimuth position control system serves now as an example to summarize the major objectives of the chapter. The following cases demonstrate the use offrequency response methods to (1) design a value of gain to meet a percent overshootrequirement for the closed-loop step response and (2) design cascade compensation tomeet both transient and steady-state error requirements. Antenna Control: Gain DesignAntenna Control: Gain Design PROBLEM: Given the antenna azimuth position control system shown on the front end- papers, Con Ô¨Åguration 1, use frequency response techniques to do the following: a.Find the preampli Ô¨Åer gain required for a closed-loop response of 20% overshoot for a step input. b.Estimate the settling time. SOLUTION: The block diagram for the control system is shown on the inside front cover (ConÔ¨Åguration 1). The loop gain, after block diagram reduction, is G s¬Ü¬à6:63K s s¬á1:71¬Ü s¬á100¬Ü¬à0:0388 K ss 1:71¬á1/C16/C17s 100¬á1/C16/C17 (11.20) Letting K¬à1, the magnitude and phase frequency response plots are shown in Figure 10.61. a.ToÔ¨ÅndKto yield a 20% overshoot, we Ô¨Årst make a second-order approximation and assume that the second-order transient response equations relating percent overshoot,damping ratio, and phase margin are true for this system. Thus, a 20% overshoot implies adamping ratio of 0.456. Using Eq. (10.73), this damping ratio implies a phase margin of48.1 ¬∞. The phase angle should therefore be  180 ¬∞¬á48:1¬∞¬Ü¬à  131:9¬∞. The phase angle is 131 :9¬∞atœâ¬à1:49 rad/s, where the gain is  34.1 dB. Thus K¬à34:1d B ¬à50:7 for a 20% overshoot. Since the system is third-order, the second-order approximation should be checked. A computer simulation shows a 20% overshoot for the step response. b.Adjusting the magnitude plot of Figure 10.61 for K¬à50:7, we Ô¨Ånd 7d Ba t œâ¬à2:5 rad/s, which yields a closed-loop bandwidth of 2.5 rad/s. Using Eq. (10.55) with Œ∂¬à0:456 and œâ BW¬à2:5, we Ô¨ÅndTs¬à4:63 seconds. A computer simulation shows a settling time of approximately 5 seconds. CHALLENGE: We now give you a problem to test your knowledge of this chapter ‚Äôs objectives. You are given the antenna azimuth position control system shown on the inside front cover (Con Ô¨Åguration 3). Using frequency response methods, do the following: a.Find the value of Kto yield 25% overshoot for a step input. b.Repeat Part ausing MATLAB. Antenna Control: Cascade Compensation DesignAntenna Control: Cascade Compensation Design PROBLEM: Given the antenna azimuth position control system block diagram shown on the front endpapers, Con Ô¨Åguration 1, use frequency response techniques and design cascade compensation for a closed-loop response of 20% overshoot for a step input, a Ô¨Åvefold improvement in steady-state error over the gain-compensated system operating at 20% overshoot, and a settling time of 3.5 seconds.638 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:24 SOLUTION: Following the lag-lead design procedure, we Ô¨Årst determine the value of gain, K, required to meet the steady-state error requirement. 1.Using Eq. (10.55) with Œ∂¬à0:456, and Ts¬à3:5 seconds, the required bandwidth is 3.3 rad/s. 2.From the preceding case study, the gain-compensated system ‚Äôs open-loop transfer function was, for K¬à50:7, G s¬ÜH s¬Ü¬à6:63K s s¬á1:71¬Ü s¬á100¬Ü¬à336:14 s s¬á1:71¬Ü s¬á100¬Ü(11.21) This function yields Kv¬à1:97. If K¬à254, then Kv¬à9:85, a Ô¨Åvefold improvement. 3.The frequency response curves of Figure 10.61, which are plotted for K¬à1, will be used for the solution. 4.Using a second-order approximation, a 20% overshoot requires a phase margin of 48.1¬∞ . 5.Select œâ¬à3 rad/s to be the new phase-margin frequency. 6.The phase angle at the selected phase-margin frequency is  152 ¬∞. This is a phase margin of 28 ¬∞. Allowing for a 5 ¬∞contribution from the lag compensator, the lead compensator must contribute 48:1¬∞ 28¬∞¬á5¬∞¬Ü¬à25:1¬∞. 7.The design of the lag compensator now follows. Choose the lag compensator upperbreak one decade below the new phase-margin frequency, or 0.3 rad/s. Figure 11.8says that we can obtain 25.1 ¬∞phase shift from the lead if Œ≤¬à0:4o rŒ≥¬à1=Œ≤¬à2:5. Thus, the lower break for the lag is at 1 = Œ≥T¬Ü¬à0:3=2:5¬à0:12 rad/s. Hence, G lag s¬Ü¬à0:4 s¬á0:3¬Ü s¬á0:12¬Ü(11.22) 8.Finally, design the lead compensator. Using Eq. (11.9), we have T¬à1 œâmaxÔ¨ÉÔ¨ÉÔ¨É Œ≤p¬à1 3Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Ô¨É 0:4p ¬à0:527 (11.23) Therefore, the lead compensator lower break frequency is 1 =T¬à1:9r a d / s ,a n dt h e upper break frequency is 1 = Œ≤T¬Ü¬à4:75 rad/s. Thus, the lag-lead-compensated forward path is Glag-lead-comp s¬Ü¬à 6:63¬Ü 254¬Ü s¬á0:3¬Ü s¬á1:9¬Ü s s¬á1:71¬Ü s¬á100¬Ü s¬á0:12¬Ü s¬á4:75¬Ü(11.24) 9.A plot of the open-loop frequency response for the lag-lead-compensated system shows  7 dB at 5.3 rad/s. Thus, the bandwidth meets the design requirements for settling time. A simulation of the compen sated system shows a 20% overshoot and a settling time of approximately 3.2 secon ds, compared to a 20% overshoot for the uncompensated system and a settling time of approximately 5 seconds. Kvfor the c o m p e n s a t e ds y s t e mi s9 . 8 5c o m p a r e dt ot h eu n c o m p e n s a t e ds y s t e mv a l u eo f1 . 9 7 . CHALLENGE: We now give you a problem to test your knowledge of this chapter ‚Äôs objectives. You are given the antenna azimuth position control system shown onCase Studies 639WEBC11 10/28/2014 18:21:25 Summary This chapter covered the design of feedback control systems using frequency response techniques. We learned how to design by gain adjustment as well as cascaded lag, lead, andlag-lead compensation. Time response characteristics were related to the phase margin,phase-margin frequency, and bandwidth. Design by gain adjustment consisted of adjusting the gain to meet a phase-margin speciÔ¨Åcation. We located the phase-margin frequency and adjusted the gain to 0 dB. A lag compensator is basically a low-pass Ô¨Ålter. The low-frequency gain can be raised to improve the steady-state error, and the high-frequency gain is reduced to yield stability.Lag compensation consists of setting the gain to meet the steady-state error requirement andthen reducing the high-frequency gain to create stability and meet the phase-marginrequirement for the transient response. A lead compensator is basically a high-pass Ô¨Ålter. The lead compensator increases the high-frequency gain while keeping the low-frequency gain the same. Thus, the steady-state error can be designed Ô¨Årst. At the same time, the lead compensator increases the phase angle at high frequencies. The effect is to produce a faster, stable system, since the uncompensated phase margin now occurs at a higher frequency. A lag-lead compensator combines the advantages of both the lag and the lead compensator. First, the lag compensator is designed to yield the proper steady-state errorwith improved stability. Next, the lead compensator is designed to speed up the transientresponse. If a single network is used as the lag-lead, additional design considerations areapplied so that the ratio of the lag zero to the lag pole is the same as the ratio of the lead pole to the lead zero. In the next chapter, we return to state space and develop methods to design desired transient and steady-state error characteristics. Review Questions 1.What major advantage does compensator design by frequency response have over root locus design? 2.How is gain adjustment related to the transient response on the Bode diagrams? 3.BrieÔ¨Çy explain how a lag network allows the low-frequency gain to be increased to improve steady-state error without having the system become unstable. 4.From the Bode plot perspective, brie Ô¨Çy explain how the lag network does not appreciably affect the speed of the transient response. 5.Why is the phase margin increased above that desired when designing a lag compensator? 6.Compare the following for uncompensated and lag-compensated systems designed to yield the same transient response: low-frequency gain, phase-margin frequency, gain curve value around the phase-margin frequency, and phase curve values aroundthe phase-margin frequency.the front endpapers (Con Ô¨Åguration 3). Using frequency response methods, do the following: a.Design a lag-lead compensator to yield a 15% overshoot and Kv¬à20. In order to speed up the system, the compensated system ‚Äôs phase-margin frequency will be set to 4.6 times the phase-margin frequency of the uncompensated system. b.Repeat Part ausing MATLAB.640 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:25 7.From the Bode diagram viewpoint, brie Ô¨Çy explain how a lead network increases the speed of the transient response. 8.Based upon your answer to Question 7, explain why lead networks do not cause instability. 9.Why is a correction factor added to the phase margin required to meet the transientresponse? 10.When designing a lag-lead network, what difference is there in the design of the lagportion as compared to a separate lag compensator? Problems 1.Design the value of gain, K, for a gain margin of 10 dB in the unity feedback system of Figure P11.1 if[Section: 11.2] a.G s¬Ü¬àK s¬á4¬Ü s¬á10¬Ü s¬á15¬Ü b.G s¬Ü¬àK s s¬á4¬Ü s¬á10¬Ü c.G s¬Ü¬àK s¬á2¬Ü s s¬á4¬Ü s¬á6¬Ü s¬á10¬Ü R(s) C(s) + _G(s) FIGURE P11.1 2.For each of the systems in Problem 1, design the gain, K, for a phase margin of 40 ¬∞. [Section: 11.2] 3.Given the unity feedback system of Figure P11.1, use frequency response methods to determine the value of gain, K, to yield a step response with a 20% overshoot if [Section: 11.2] a.G s¬Ü¬àK s s¬á8¬Ü s¬á15¬Ü b.G s¬Ü¬àK s¬á4¬Ü s s¬á8¬Ü s¬á10¬Ü s¬á15¬Ü c.G s¬Ü¬àK s¬á2¬Ü s¬á7¬Ü s s¬á6¬Ü s¬á8¬Ü s¬á10¬Ü s¬á15¬Ü 4.Given the unity feedback system of Figure P11.1 with G s¬Ü¬àK s¬á10¬Ü s¬á15¬Ü s s¬á2¬Ü s¬á5¬Ü s¬á20¬Ü do the following: [Section: 11.2]a.Use frequency response methods to determine the value of gain, K, to yield a step response with a 20% overshoot. Make any required second-order approximations. b.Use MATLAB or any other computer program to test your second-order approximation by simulating thesystem for your designed value of K. 5.The unity feedback system of Figure P11.1 with G s¬Ü¬à K s s¬á7¬Ü is operating with 15% overshoot. Using frequencyresponse techniques, design a compensator to yield K v¬à 50 with the phase-margin frequency and phase marginremaining approximately the same as in the uncompensated system. [Section: 11.3] 6.Given the unity feedback system of Figure P11.1 with G s¬Ü¬àK s¬á10¬Ü s¬á11¬Ü s s¬á3¬Ü s¬á6¬Ü s¬á9¬Ü do the following: [Section: 11.3] a.Use frequency response methods to design a lag compensator to yield Kv¬à1000 and 15% overshoot for the step response. Make any required second-orderapproximations. b. Use MATLAB or any other computerprogram to test your second- order approximation by simulating the system for your designed value of Kand lag compensator. 7.The unity feedback system shown in Figure P11.1 with G s¬Ü¬àK s¬á1¬Ü s¬á5¬Ü s¬á10¬Ü is operating with 15% overshoot. Using frequencyresponse methods, design a compensator to yield aProblems 641WEBC11 10/28/2014 18:21:26 Ô¨Åvefold improvement in steady-state error without appreciably changing the transient response. [Section: 11.3] 8.Design a lag compensator so that the system of FigureP11.1 where G s¬Ü¬àK s¬á4¬Ü s¬á2¬Ü s¬á6¬Ü s¬á8¬Ü operates with a 45 ¬∞phase margin and a static error constant of 100. [Section: 11.3] 9.Design a PI controller for the system of Figure 11.2 that will yield zero steady-state error for a ramp input and a 9.48% overshoot for a step input. [Section: 11.3] 10.For the system of Problem 6, do the following:[Section: 11.3] a.Use frequency response methods to Ô¨Ånd the gain, K, required to yield about 15% overshoot. Make anyrequired second-order approximations. b.Use frequency response methods to design a PI compensator to yield zero steady-state error for a ramp input without appreciably changing thetransient response characteristics designed inParta. c. Use MATLAB or any other computerprogram to test your second-order approximation by simulating thesystem for your designed value of Kand PI compensator. Write a MATLAB program that willdesign a PI controller assuming asecond-order approximation as follows: a.Allow the user to input from the key-board the desired percent overshoot b.Design a PI controller and gain to yieldzero steady-state error for a closed-loop step response as well as meet the percent overshoot speciÔ¨Å cation c.Display the compensated closed-loopstep response Test your program on G s¬Ü¬à K s¬á5¬Ü s¬á10¬Ü and 25% overshoot. 12.Design a compensator for the unity feedback system of Figure P11.1 with G s¬Ü¬àK s s¬á2¬Ü s¬á10¬Ü s¬á25¬Ü to yield a Kv¬à4 and a phase margin of 45 ¬∞. [Section: 11.4]13.Consider the unity feedback system of Figure P11.1 with G s¬Ü¬àK s s¬á5¬Ü s¬á20¬Ü The uncompensated system has about 55% overshootand a peak time of 0.5 second when K v¬à10. Do the following: [Section: 11.4] a.Use frequency response methods to design a lead compensator to reduce the percent overshoot to 10%, while keeping the peak time and steady-stateerror about the same or less. Make any requiredsecond-order approximations. b. Use MATLAB or any other computerprogram to test your second-order approximation by simulating thesystem for your designed value of K. 14.The unity feedback system of Figure P11.1 with G s¬Ü¬à K s¬á4¬Ü s¬á2¬Ü s¬á5¬Ü s¬á12¬Ü is operating with 20% overshoot. [Section: 11.4] a.Find the settling time. b.Find Kp. c.Find the phase margin and the phase-marginfrequency. d.Using frequency response techniques, design acompensator that will yield a threefold improvementinK pand a twofold reduction in settling time while keeping the overshoot at 20%. 15.Repeat the design of Example 11.3 in the text using a PD controller. [Section: 11.4] 16.RepeatProblem13usingaPDcompensator.[Section:11.4] 17.Write a MATLAB program that willdesign a lead compensator assuming second-order approximationsas follows: a.Allow the user to input from the key-board the desired percent overshoot,peak time, and gain required to meet asteady-state error speci Ô¨Åcation b.Display the gain-compensated Bodeplot c.Calculate the required phase marginand bandwidth d.Display the pole, zero, and gain of thelead compensator e.Display the compensated Bode plot f.Output the step response of the lead- compensatedsystemtotestyoursecond- order approximation642 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:27 Test your program on a unity feedback system where G s¬Ü¬àK s¬á1¬Ü s s¬á2¬Ü s¬á6¬Ü and the following speci Ô¨Åcations are to be met: percent overshoot =10%, peak time =0.1 second, and Kv¬à30. 18.Repeat Problem 17 for a PD controller. 19.Use frequency response methods to design a lag-leadcompensator for a unity feedback system where G s¬Ü¬àK s¬á5¬Ü s s¬á2¬Ü s¬á10¬Ü and the following speci Ô¨Åcations are to be met: percent overshoot =10%, settling time =0.2 second, and Kv¬à1000. [Section: 11.4] 20.Write a MATLAB program that willdesign a lag-lead compensator assuming second-order approximations as follows: [Section: 11.5] a.Allow the user to input from the key-board the desired percent overshoot,settling time, and gain required tomeetasteady-stateerrorspeci Ô¨Åcation b.Displaythegain-compensatedBodeplot c.Calculate the required phase marginand bandwidth d.Display the poles, zeros, and the gainof the lag-lead compensator e.Display the lag-lead-compensated Bodeplot f.Display the step response of the lag-lead compensated system to test your second-order approximation Use your program to do Problem 19. 21.Given a unity feedback system with G s¬Ü¬à K s s¬á1:75¬Ü s¬á6¬Ü design a PID controller to yield zero steady-state error for a ramp input, as well as a 20% overshoot, and a peak timeless than 1.8 seconds for a step input. Use only frequency response methods. [Section: 11.5] A unity feedback system has G s¬Ü¬àK s s¬á3¬Ü s¬á6¬ÜIf this system has an associated 0.5 seconddelay, use MATLAB to design the value of Kfor 20% overshoot. Make any necessary second-order approximations, but testyour assumptions by simulating yourdesign. The delay can be represented bycascading the MATLAB function pad√© (T ,n) with G(s), where Tis the delay in seconds andnistheorderofthePadeapproximation (use 5). Write the program to do thefollowing: a.Accept your value of percent overshootfrom the keyboard b.Display the Bode plot for K=1 c.Calculate the required phase marginand Ô¨Ånd the phase-margin frequency and the magnitude at the phase-marginfrequency d.Calculate and display the value of K DESIGN PROBLEMSDESIGN PROBLEMS The model for a speci Ô¨Åc linearized TCP/IP computer network queue, working under a random early detection (RED) algorith m, has been modeled using the block diagram of Figure P11.1, whereG s¬Ü¬àM s¬ÜP s¬Ü,w i t h M s¬Ü¬à 0:005L s¬á0:005 and P s¬Ü¬à140;625e 0:1s s¬á2:67¬Ü s¬á10¬Ü Also, Lis a parameter to be varied ( Hollot ,2001 ). a.Adjust Lto obtain a 15% overshoot in the transient response for step inputs. b.Verify Part awith a Simulink unit step response simulation. An electric ventricular assist device (EVAD) that helpspump blood concurrently to a defective natural heart insick patients can be shown to have a transfer function G s¬Ü¬à Pao s¬Ü Em s¬Ü¬à1361 s2¬á69s¬á70:85 The input, Em(s), is the motor ‚Äôs armature voltage, and the output is Pao(s), the aortic blood pressure ( Tasch ,1990 ). The EVAD will be controlled in the closed-loopconÔ¨Åguration shown in Figure P11.1. a.Design a phase lag compensator to achieve a tenfoldimprovement in the steady-state error to step inputswithoutappreciablyaffectingthetransientresponseofthe uncompensated system. (problem continues )Problems 643WEBC11 10/28/2014 18:21:27 (Continued ) b.Use MATLAB to simulate the uncompensated and compensated systems for a unit step input. A Tower Trainer 60 Unmanned Aerial Vehicle has atransfer function P s¬Ü¬àh s¬Ü Œ¥e s¬Ü ¬à 34:16s3 144:4s2¬á7047 s¬á557:2 s5¬á13:18s4¬á95:93s3¬á14:61s2¬á31:94s where Œ¥e s¬Üis the elevator angle and h(s) is the change in altitude ( Barkana ,2005 ). a.Assuming the airplane is controlled in the closed- loop conÔ¨Å guration of Figure P11.1 with G s¬Ü¬àKP s¬Ü,Ô¨Ånd the value of Kthat will result in a 30 ¬∞phase margin. b.For the value of Kcalculated in Part a, obtain the corresponding gain margin. c.Obtain estimates for the system ‚Äôs%OS and settling times Tsfor step inputs. d.Simulate the step response of the system using MATLAB. e.Explain the simulation results and discuss anyinaccuracies in the estimates obtained in Part c. The transfer function from applied force to armdisplacement for the arm of a hard disk drive hasbeen identiÔ¨Å ed as G s¬Ü¬à X s¬Ü F s¬Ü¬à3:3333 104 s2 The position of the arm will be controlled using the feedback loop shown in Figure P11.1 ( Yan,2003 ). a.Design a lead compensator to achieve closed-loop stability with a transient response of 16% over-shoot and a settling time of 2 msec for a step input.b. Verify your design through MATLAB simulations. For the heat exchange system described in Problem 39, Chapter 9 ( Smith ,2002 ): a.Design a passive lag-lead compensator to achieve5% steady-state error with a transient response of10% overshoot and a settling time of 60 seconds forstep inputs. b. Use MATLAB to simulate and verify your design. Active front steering is used in front-steering four- wheel cars to control the yaw rate of the vehicle as afunction of changes in wheel-steering commands. Fora certain car, and under certain conditions, it has beenshown that the transfer function from steering wheel angle to yaw rate is given by ( Zhang ,2008 ): P s¬Ü¬à 28:4s¬á119:7 s2¬á7:15s¬á14:7 The system is controlle di nau n i t y - f e e d b a c kc o n Ô¨Åguration. a.Use the Nichols chart and follow the procedure of Example 11.5 to design a lag-lead compensator such that the system has zero steady-state error for a step input. The bandwidth of the closed-loop system mustbeœâ B¬à10 rad/sec. Let the open-loop magnitude response peak be less than 1 dB and the steady-stateerror constant K v¬à20. b.Relax the bandwidth requirement to œâB10 rad/sec. Design the system for a steady-state error of zero for astep input. Let the open-loop magnitude responsepeak be less than 1 dB and K v¬à20 using only a lead compensator. c.Simulate the step responseof both designs using MATLAB. Figure P11.2 illustrates a set of booms used for thedelivery of chemicals in agriculture ( Sun,2011 ). Each Controller Infrared distance sensorInfrared distance sensorHydraulic cylinder driving singal Connected to the vehicle Four-rod suspension FIGURE P11.25 5Sun, J., and Miao, Y. Modeling and simulation of the agricultural sprayer boom leveling system. IEEE Third International Conf. on Measuring Tech. and Mechatronics Automation, 2011 , pp. 613 ‚Äì618. Figure 2, p. 613. 2011 Third International Conference on Measuring Technology and Mechatronics Automation by IEEE. Reproduced with permission of IEEE in the format Republish in a book via Copyright Clearance Center.644 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:28 of the booms has equally spaced nozzles, the purpose of which is to maintain a constant gap between the nozzles and the soil despite car movements due toroad unevenness. The booms are tethered to a vehicle(not shown in Ô¨Ågure), and the gap is measured using an infrared sensor. This measurement is fed to a controllerthat drives two hydraulic cylinders to adjust the boom ‚Äôs positions. Under certain operating conditions, it wasfound that the system can be described by the unity- feedback con Ô¨Åguration of Figure P11.1 where G s¬Ü¬à K s2:7810 4 s2 602¬ás 60¬á1/C18/C19509:3 s2 2132¬á3s 213¬á1/C18/C19 a.Design a lag compensator to achieve Kv¬à30, and %OS=10%. b.Use a computer program to obtain the step responseof the closed-loop system and verify its performance. The amount of leftover moisture in a grain drying conveyor process can be controlled by varying theconveyor ‚Äôs motor speed ( Mansor ,2011). Although the process is highly variable, the transfer function atone of the operating points has been found to be G s¬Ü¬à 0:0169 s¬á0:03558 3:368s3¬á3:762s2¬á32:19s¬á1e 27s A unity feedback system will be built around this plant such as the one shown in Figure P11.1 to maintain grain moisture at speci Ô¨Åed levels. The speci Ô¨Åcations are:ess¬à0 for a unit-step input; essis half that of the uncompensated system for a ramp input; settling time=500 seconds, and % OS=13%. Since the system is Type 0, it must be augmented to a Type 1 using an integrator in order to achieve ess¬à0 for a step input. In addition, a phase lead-lag compensa-tor will be required to achieve the speci Ô¨Åcations. Simulate your design using a computer program. Problem 52 in Chapter 10 mentioned a measurement-based technique to design Ô¨Åxed-structure controllers, which does not require system identi Ô¨Åcation. In that problem, we assumed a plant transfer functionof (Khadraoui ,2013) G s¬Ü¬à 0:1111 4s2¬á5s¬á1¬Ü s4¬á3:1s3¬á0:85s2¬á0:87s¬á0:1111 Again, the interested reader is directed to the reference for further study. In this problem, however,we use the design and analysis techniques developed inthis and the previous chapters.Use MATLAB and Bode plots to design a PID controller, Gc(s), to yield zero steady-state error for astep input, an overshoot of 10 to 20%,and a settling time of 20 to 50 seconds.Start your design assuming an overshootof 10% and a settling time of 50 seconds.Consider the design acceptable if thePID-controlled response satis Ô¨Åes the above requirements. PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS 32.Control of HIV/AIDS. In Chapter 6, the model for an HIV/AIDS patient treated with RTIs was linearized and shown to be P s¬Ü¬à Y s¬Ü U1 s¬Ü¬à 520 s 10:3844 s3¬á2:6817 s2¬á0:11s¬á0:0126 ¬à 520 s¬á0:02¬Ü s¬á2:2644 ¬Ü s2¬á0:04s¬á0:0048 ¬Ü It is assumed here that the patient will be treated and monitored using the closed-loop con Ô¨Åguration shown in Figure P11.1 Since the plant has a negative dc gain,assume for simplicity that G s¬Ü¬àG c s¬ÜP s¬Üand Gc 0¬Ü<0. Assume also that the speci Ô¨Åcations for the design are (1) zero steady-state error for step inputs,(2) overdamped time-domain response, and (3) settlingtime T s‚âà100 days ( Craig ,2004 ). a.The overdamped speci Ô¨Åcation requires a Œ¶M‚âà90¬∞. Find the corresponding bandwidth required to satisfythe settling time requirement. b.The zero steady-state error speci Ô¨Åcation implies that the open-loop transfer function must be augmentedto Type 1. The  0.02 zero of the plant adds too much phase lead at low frequencies, and the complexconjugate poles, if left uncompensated within the loop, result in undesired oscillations in the time domain. Thus, as an initial approach to compensation for thissystem we can try G c s¬Ü¬à K s2¬á0:04s¬á0:0048 ¬Ü s s¬á0:02¬Ü ForK¬à1, make a Bode plot of the resulting system. Obtain the value of Knecessary to achieve the design demands. Check for closed-loop stability. c.Simulate the unit step responseof the system using MATLAB. Adjust Kto achieve the desired response.Problems 645WEBC11 10/28/2014 18:21:29 33.Hybrid vehicle. In Part bof Problem 54 in Chapter 10, we used a proportional-plus-integral (PI) speed controller that resulted in an overshoot of 20% anda settling time, T s¬à3:92 seconds ( Preitl, 2007). a.Now assume that the system speci Ô¨Åcations require a s t e a d y - s t a t ee r r o ro fz e r of o ras t e pi n p u t ,ar a m pinput steady-state error 2%, a %OS 4.32%, and a settling time 4 seconds. One way to achieve these requirements is to cancel the PI-controller ‚Äôs zero, Z I, with the real pole of the uncompensated system closest to the origin (located at  0.0163). Assuming exact cancellation is possible, the plant and controller transfer function becomes G s¬Ü¬àK s¬á0:6¬Ü s s¬á0:5858 ¬Ü Design the system to meet the requirements. You mayuse the following steps: i.Set the gain, K, to the value required by the steady- state error speci Ô¨Åcations. Plot the Bode magnitude and phase diagrams. ii.Calculate the required phase margin to meet thedamping ratio or equivalently the %OS requirement, using Eq. (10.73). If the phase margin found fromthe Bode plot obtained in Step iis greater than the required value, simulate the system to check whetherthe settling time is less than 4 seconds and whetherthe requirement of a % OS4.32% has been met. Redesign if the simulation shows that the %OS and/or the steady-state error requirements have notbeen met. If all requirements are met, you have completed the design. b.In most cases, perfect pole-zero cancellation is not possible. Assume that you want to check whathappens if the PI-controller ‚Äôs zero changes by ¬±20%, e.g., if Z Imoves to:Case 1 : 0:01304 or to Case 2 : 0:01956 : The plant and controller transfer function in these cases will be, respectively: Case 1 :G s¬Ü¬àK s¬á0:6¬Ü s¬á0:01304 ¬Ü s s¬á0:0163 ¬Ü s¬á0:5858 ¬Ü Case 2 :G s¬Ü¬àK s¬á0:6¬Ü s¬á0:01956 ¬Ü s s¬á0:0163 ¬Ü s¬á0:5858 ¬Ü SetKin each case to the value required by the steady-state error speci Ô¨Åcations and plot the Bode magnitude and phase diagrams. Simulate the closed-loop step response for each of the three locations ofZ I: pole/zero cancellation, Case 1, and Case 2, given in the problem. Do the responses obtained resemble a second- order overdamped, critically damped, or underdamped response? Is there a need to add a derivative mode? 34.Parabolic trough collector. In order to reduce the steady-state error of the parabolic trough collector sys- tem, a PI controller is added to the open-loop transferfunction so that ( Camacho ,2012 ) G s¬Ü¬à137:210 6K s¬á0:01¬Ü s s2¬á0:0224 s¬á19610 6¬Üe 39s a.Draw the new resulting Nyquist diagram when K=1. b.Find the range of Kfor closed-loop stability. c.Use a phase margin argument to Ô¨Ånd the value of K that will yield Œ∂¬à0:5 damping factor. d.Using the value found in Part a, simulate the system for a unit-step response using a computer program. Cyber Exploration Laboratory Experiment 11.1 Objectives To design a PID controller using MATLAB ‚Äôs SISO Design Tool; To observe the effect of a PI and a PD controller on the magnitude and phase responses at each step of the design of a PID controller Minimum Required Software Packages MATLAB, and the Control System Toolbox Prelab 1.What is the phase margin required for 12% overshoot? 2.What is the bandwidth required for 12% overshoot and a peak time of 2 seconds?646 Chapter 11 Design via Frequency ResponseWEBC11 10/28/2014 18:21:29 Bibliography Barkana, I. Classical and Simple Adaptive Control of Nonminimum Phase Autopilot Design. Journal of Guidance, Control, and Dynamics , vol. 28, 2005, pp. 631 ‚Äì638. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. D‚ÄôAzzo, J. J., and Houpis, C. H. Feedback Control System Analysis and Synthesis , 2d ed. McGraw-Hill, New York, 1966.3.Given a unity feedback system with G s¬Ü¬àK s s¬á1¬Ü s¬á4¬Ü, what is the gain, K, required to yield the phase margin found in Prelab 1? What is the phase-margin frequency? 4.Design a PI controller to yield a phase margin 5 ¬∞more than that found in Prelab 1. 5.Complete the design of a PID controller for the system of Prelab 3. Lab 1.Using MATLAB ‚Äôs SISO Design Tool, set up the system of Prelab 3 and display the open-loop Bode plots and the closed-loop step response. 2.Drag the Bode magnitude plot in a vertical direction until the phase margin found in Prelab 1 is obtained. Record the gain K, the phase margin, the phase-margin frequency, the percent overshoot, and the peak time. Move the magnitude curve up and down andnote the effect upon the phase curve, the phase margin, and the phase-margin frequency. 3.Design the PI controller by adding a pole at the origin and a zero one decade below thephase-margin frequency found in Lab 2. Readjust the gain to yield a phase margin 5 ¬∞ higher than that found in Prelab 1. Record the gain K, the phase margin, the phase- margin frequency, the percent overshoot, and the peak time. Move the zero back andforth in the vicinity of its current location and note the effect on the magnitude and phasecurve. Move the magnitude curve up and down and note its effect on the phase curve, thephase margin, and the phase-margin frequency. 4.Design the PD portion of the PID controller by Ô¨Årst adjusting the magnitude curve to yield a phase-margin frequency slightly below the bandwidth calculated in Prelab 2.Add a zero to the system and move it until you obtain the phase margin calculated inPrelab 1. Move the zero and note its effect. Move the magnitude curve and note its effect. Postlab 1.Compare the Prelab PID design with that obtained via the SISO Design Tool. Inparticular, compare the gain K, the phase margin, the phase-margin frequency, the percent overshoot, and the peak time. 2.For the uncompensated system, describe the effect of changing gain on the phase curve,the phase margin, and the phase-margin frequency. 3.For the PI-compensated system, describe the effect of changing gain on the phase curve, the phase margin, and the phase-margin frequency. Repeat for changes in the zero location. 4.For the PID-compensated system, describe the effect of changing gain on the phasecurve, the phase margin, and the phase-margin frequency. Repeat for changes in the PDzero location.Bibliography 647WEBC11 10/28/2014 18:21:29 Dorf, R. C. Modern Control Systems , 5th ed. Addison-Wesley, Reading, MA, 1989. Flower, T. L., and Son, M. Motor Drive Mechanics and Control Electronics for a High Performance Plotter. HP Journal, November 1981, pp. 12 ‚Äì15. Hollot, C. V., Misra, V., Towsley, D., and Gong, W. A Control Theoretic Analysis of RED. Proceedings of IEEE INFOCOM, 2001, pp. 1510 ‚Äì1519. Hostetter, G. H., Savant, C. J., and Stefani, R. T. Design of Feedback Control Systems , 2d ed. Saunders College Publishing, New York, 1989. Khadraoui, S., Nounou, H., Nounou, M., Datta, A., and Bhattacharyya, S. P. A Measurement-based approach for tuning of reduced-order controllers. American Control Conference (ACC ), June 2013, pp. 3876 ‚Äì3881. Kuo, B. C. Automatic Control Systems , 5th ed. Prentice Hall, Upper Saddle River, NJ, 1987. Mansor, H., Noor, S. B. M., Ahmad, R. K. R., and Taip, F. S. Online Quantitative feedback theory (QFT)-based self-tuning controller for grain drying process. Scienti Ô¨Åc Research and Essays , vol. 6, no. 31, December 16, 2011, pp. 6520 ‚Äì6534. Ogata, K. Modern Control Engineering , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1990. Phillips, C. L., and Harbor, R. D. Feedback Control Systems . Prentice Hall, Upper Saddle River, NJ, Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Inteligence and Informatics . IEEE, 2007, pp. 157 ‚Äì162. Raven, F. H. Automatic Control Engineering , 4th ed. McGraw-Hill, New York, 1987. Smith, C. A. Automated Continuous Process Control. Wiley, New York, 2002. Sun, J., and Miao, Y. Modeling and simulation of the agricultural sprayer boom leveling system. IEEE Third International Conf. on Measuring Tech. and Mechatronics Automation , 2011, pp. 613 ‚Äì618. Tasch, U., Koontz, J. W., Ignatoski, M. A., and Geselowitz, D. B. An Adaptive Aortic Pressure Observer for the Penn State Electric Ventricular Assist Device. IEEE Transactions on Biomedical Engineering , vol. 37, 1990, pp. 374 ‚Äì383. Yan, T., and Lin, R. Experimental Modeling and Compensation of Pivot Nonlinearity in Hard Disk Drives. IEEE Transactions on Magnetics , vol. 39, 2003, pp. 1064 ‚Äì1069. Zhang, J.-Y., Kim, J.-W., Lee, K.-B., and Kim, Y.-B. Development of an Active Front Steering (AFS) System With QFT Control. International Journal of Automotive Technology , vol. 9, no. 6, 2008, pp. 695 ‚Äì702.648 Chapter 11 Design via Frequency ResponseWEBC12 10/29/2014 8:56:15 Design via State Space This chapter covers only state-space methods. Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅDesign a state-feedback controller using pole placement for systems represented in phase-variable form to meet transient response speci Ô¨Åcations (Sections 12.1 ‚Äì12.2) ¬ÅDetermine if a system is controllable (Section 12.3) ¬ÅDesign a state-feedback controller using pole placement for systems not represented in phase-variable form to meet transient response speci Ô¨Åcations (Section 12.4) ¬ÅDesign a state-feedback observer using pole placement for systems representedin observer canonical form (Section 12.5) ¬ÅDetermine if a system is observable (Section 12.6) ¬ÅDesign a state-feedback observer using pole placement for systems notrepresented in observer canonical form (Section 12.7) ¬ÅDesign steady-state error characteristics for systems represented in state space (Section 12.8)12 649WEBC12 10/29/2014 8:56:16 Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with case studies as follows: ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to specify all closed-loop poles and then designa state-feedback controller to meet transient response speci Ô¨Åcations. ¬ÅGiven the antenna azimuth position control system shown on the fronte n d p a p e r s ,y o uw i l lb ea b l et od e s i g na no b s e r v e rt oe s t i m a t et h es t a t e s . ¬ÅGiven the antenna azimuth position control system shown on the frontendpapers, you will be able to combine the controller and observerdesigns into a viable compensator for the system. 12.1 Introduction Chapter 3 introduced the concepts of state-space analysis and system modeling. We showed that state-space methods, like transform methods, are simply tools for analyzing and designing feedback control systems. However, state-space techniques can be applied to a wider class ofsystems than transform methods. Systems with nonlinearities, such as that shown in Figure 12.1,and multiple-input, multiple-output systems are just two of the candidates for the state-spaceapproach. In this book, however, we apply the approach only to linear systems. In Chapters 9 and 11, we applied frequency domain methods to system design. The basic design technique is to create a compensator in cascade with the plant or in the feedbackpath that has the correct additional poles and zeros to yield a desired transient response and steady-state error. One of the drawbacks of frequency domain methods of design, using either root locus or frequency response techniques, is that after designing the location of the dominant Robin Nelson/Zuma PressFIGURE 12.1 A robot in a hospital pharmacy selects medications by bar code1 1Tadeo F., Perez, Loepez O., and Alvarez T. Control of Neutralization Processes by Robust Loopsharing. IEEE Trans. on Cont. Syst. Tech. , vol. 8, no. 2, 2000. Fig. 2, p. 239. IEEE Transactions on Control Systems Technology by Institute of Electrical and Electronics Engineers; IEEE Control Systems Society Reproduced with permission of Institute of Electrical and Electronics Engineers, in the format Republish in a book via Copyright Clearance Center.650 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:16 second-order pair of poles, we keep our Ô¨Ångers crossed, hoping that the higher-order poles do not affect the second-order approximation. What we would like to be able to do is specify allclosed-loop poles of the higher-order system. Frequency domain methods of design do not allow us to specify all poles in systems of order higher than 2 because they do not allowfor a suf Ô¨Åcient number of unknown parameters to place all of the closed-loop poles uniquely. One gain to adjust, or compensator pole and zero to select, does not yield asufÔ¨Åcient number of parameters to place all the closed-loop poles at desired locations. Remember, to place nunknown quantities, you need nadjustable parameters. State-space methods solve this problem by introducing into the system (1) other adjustable parameters and (2) the technique for Ô¨Ånding these parameter values, so that we can properly place all poles of the closed-loop system. 2 On the other hand, state-space methods do not allow the speci Ô¨Åcation of closed-loop zero locations, which frequency domain methods do allow through placement of the lead compensator zero. This is a disadvantage of state-space methods, since the location of thezero does affect the transient response. Also, a state-space design may prove to be verysensitive to parameter changes. Finally, there is a wide range of computational support for state-space methods; many software packages support the matrix algebra required by the design process. However, asmentioned before, the advantages of computer support are balanced by the loss of graphicinsight into a design problem that the frequency domain methods yield. This chapter should be considered only an introduction to state-space design; we introduce one state-space design technique and apply it only to linear systems. Advancedstudy is required to apply state-space techniques to the design of systems beyond the scopeof this textbook. 12.2 Controller Design This section shows how to introduce additional parameters into a system so that we cancontrol the location of all closed-loop poles. An nth-order feedback control system has an nth-order closed-loop characteristic equation of the form s n¬áan 1sn 1¬á‚àô‚àô‚àô¬áa1s¬áa0¬à0 12.1¬Ü Since the coef Ô¨Åcient of the highest power of sis unity, there are ncoefÔ¨Åcients whose values determine the system ‚Äôs closed-loop pole locations. Thus, if we can introduce nadjustable parameters into the system and relate them to the coefÔ¨Å cients in Eq. (12.1), all of the poles of the closed-loop system can be set to any desired location. Topology for Pole Placement In order to lay the groundwork for the approach, consider a plant represented in statespace by _x¬àAx¬áBu (12.2a) y¬àCx (12.2b) and shown pictorially in Figure 12.2( a), where light lines are scalars and the heavy lines are vectors. 2This is an advantage as long as we know where to place the higher-order poles, which is not always the case. One course of action is to place the higher-order poles far from the dominant second-order poles or near a closed-loop zero to keep the second-order system design valid. Another approach is to use optimal control concepts, which are beyond the scope of this text.12.2 Controller Design 651WEBC12 10/29/2014 8:56:16 In a typical feedback control system, the output, y, is fed back to the summing junction. It is now that the topology of the design changes. Instead of feeding back y, what if we feed back all of the state variables? If each state variable is fed back to the control, u, through a gain, ki, there would be ngains, ki, that could be adjusted to yield the required closed-loop pole values. The feedback through the gains, ki, is represented in Figure 12.2( b) by the feedback vector  K. The state equations for the closed-loop system of Figure 12.2( a) can be written by inspection as _x¬àAx¬áBu¬àAx¬áB  Kx¬ár¬Ü¬à A BK¬Üx¬áBr (12.3a) y¬àCx (12.3b) Before continuing, you should have a good idea of how the feedback system of Figure 12.2( b) is actually implemented. As an example, assume a plant signal-Ô¨Çow graph in phase-variable form, as shown in Figure 12.3( a). Each state variable is then fed back to the plant‚Äôs input, u, through a gain, ki, as shown in Figure 12.3( b). Although we will cover other representations later in the chapter, the phase-variable form, with its typical lower companion system matrix, or the controller canonical form, with its typical upper companion system matrix, yields the simplest evaluation of the feedback gains. In the ensuing discussion, we use the phase-variable form to develop and demonstrate the concepts.End-of-chapter problems will give you an opportunity to develop and test the concepts for thecontroller canonical form. The design of state-variable feedback for closed-loop pole placement consists of equating the characteristic equation of a closed-loop system, such as that shown inFigure 12.3( b), to a desired characteristic equation and then Ô¨Ånding the values of the feedback gains, k i. If a plant like that shown in Figure 12.3( a) is of high order and not represented in phase-variable or controller can onical form, the solution for the ki‚Äôs can be intricate. Thus, it is advisable to transfor m the system to either of these forms, design theki‚Äôs, and then transform the system back to its original represen tation. We performu B+ +Cx y A u B+ +Cx y A+ r + ‚ÄìK(a) (b)xx ‚à´ ‚à´ FIGURE 12.2 a.State-space representation of a plant; b.plant with state-variable feedback652 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:16 this conversion in Section 12.4, where we develop a method for performing the transformations. Until then, let us direct our attention to plants represented inphase-variable form. Pole Placement for Plants in Phase-Variable Form To apply pole-placement methodology to plants represented in phase-variable form, we takethe following steps: 1.Represent the plant in phase-variable form. 2.Feed back each phase variable to the input of the plant through a gain, k i. 3.Find the characteristic equation for the closed-loop system represented in Step 2. 4.Decide upon all closed-loop pole locations and determine an equivalent characteristic equation. 5.Equate like coefÔ¨Å cients of the characteristic equ ations from Steps 3 and 4 and solve forki.x1u1 x3 x2 x1yc1c3 ‚Äìa0‚Äìa1‚Äìa2 (a) u1 x3 x2yc1c2c3 ‚Äìa0‚Äìa1‚Äìa2 (b)r1 ‚Äìk3 ‚Äìk2 ‚Äìk1c2 1 s1 s1 s 1 s1 s1 s FIGURE 12.3 a.Phase- variable representation for plant; b.plant with state-variable feedback12.2 Controller Design 653WEBC12 10/29/2014 8:56:17 Following these steps, the phase-variable representation of the plant is given by Eq. (12.2), with A¬à010 ‚àô‚àô‚àô 0 001 ‚àô‚àô‚àô 0 ...............  a0 a1 a2‚àô‚àô‚àô  an 12 66666643 7777775;B¬à0 0 ... 12 66666643 7777775; C¬à¬âc 1c2‚àô‚àô‚àô cn¬ä 12.4¬Ü The characteristic equation of the plant is thus sn¬áan 1sn 1¬á‚àô‚àô‚àô¬áa1s¬áa0¬à0 12.5¬Ü Now form the closed-loop system by feeding back each state variable to u, forming u¬à Kx 12.6¬Ü where K¬à¬âk1k2‚àô‚àô‚àô kn¬ä 12.7¬Ü The ki‚Äôs are the phase variables‚Äô feedback gains. Using Eq. (12.3 a) with Eqs. (12.4) and (12.7), the system matrix, A BK, for the closed-loop system is A BK¬à010 ‚àô‚àô‚àô 0 001 ‚àô‚àô‚àô 0 ...............   a0¬ák1¬Ü  a1¬ák2¬Ü  a2¬ák3¬Ü‚àô‚àô‚àô   an 1¬ákn¬Ü2 6666643 777775 12.8¬Ü Since Eq. (12.8) is in phase-variable form, the characteristic equation of the closed-loop system can be written by inspection as det sI  A BK¬Ü¬Ü ¬à s n¬á an 1¬ákn¬Üsn 1¬á an 2¬ákn 1¬Üsn 2 ¬á‚àô‚àô‚àô a1¬ák2¬Üs¬á a0¬ák1¬Ü¬à0 12.9¬Ü Notice the relationship between Eqs. (12.5) and (12.9). For plants represented in phase-variable form, we can write by inspection the closed-loop characteristic equation from theopen-loop characteristic equation by adding the appropriate k ito each coef Ô¨Åcient. Now assume that the desired characteristic equation for proper pole placement is sn¬ádn 1sn 1¬ádn 2sn 2¬á‚àô‚àô‚àô¬ád2s2¬ád1s¬ád0¬à0 12.10 ¬Ü where the di‚Äôs are the desired coef Ô¨Åcients. Equating Eqs. (12.9) and (12.10), we obtain di¬àai¬áki¬á1i¬à0;1;2;...; n 1 12.11 ¬Ü654 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:18 from which ki¬á1¬àdi ai 12.12 ¬Ü Now that we have found the denominator of the closed-loop transfer function, let us Ô¨Ånd the numerator. For systems represented in phase-variable form, we learned that the numerator polynomial is formed from the coef Ô¨Åcients of the output coupling matrix, C. Since Figures 12.3( a) and ( b) are both in phase-variable form and have the same output coupling matrix, we conclude that the numerators of their transfer functions are the same. Let us look at a design example. Example 12.1 Controller Design for Phase-Variable FormController Design for Phase-Variable Form PROBLEM: Given the plant G s¬Ü¬à20 s¬á5¬Ü s s¬á1¬Ü s¬á4¬Ü 12.13 ¬Ü design the phase-variable feedback gains to yield 9.5% overshoot and a settling time of 0.74 second. SOLUTION: We begin by calculating the desired closed-loop characteristic equation. Using the transient response requirements, the closed-loop poles are  5:4j7:2. Since the system is third-order, we must select an other closed-loop pole. The closed-loop s y s t e mw i l lh a v eaz e r oa t  5, the same as the open-loop system. We could select the third closed-loop pole to cancel the closed-loop zero. However, to demonstrate the effect of the third pole and the design proces s, including the need for simulation, let us choose  5.1 as the location of the third closed-loop pole. Now draw the signal- Ô¨Çow diagram for the plant . The result is shown in Figure 12.4(a ). Next feed back all state variables to the control, u, through gains ki, as shown in Figure 12.4( b). Writing the closed-loop system ‚Äôs state equations from Figure 12.4(b ), we have _x¬à01 0 00 1  k1  4¬ák2¬Ü  5¬ák3¬Ü2 643 75x¬á0 0 12 643 75r (12.14a) y¬à¬â100 20 0 ¬äx (12.14b) Comparing Eqs. (12.14) to Eqs. (12.3), we identify the closed-loop system matrix as A BK¬à01 0 00 1  k1  4¬ák2¬Ü  5¬ák3¬Ü2 643 75 12.15 ¬Ü ToÔ¨Ånd the closed-loop system ‚Äôs characteristic equation, form det sI  A BK¬Ü¬Ü ¬à s3¬á 5¬ák3¬Üs2¬á 4¬ák2¬Üs¬ák1¬à0 12.16 ¬Ü This equation must match the desired characteristic equation s3¬á15:9s2¬á136 :08s¬á413 :1¬à0 12.17 ¬Ü12.2 Controller Design 655WEBC12 10/29/2014 8:56:18 formed from the poles  5:4¬áj7:2; 5:4 j7:2, and  5.1, which were previously determined. Equating the coef Ô¨Åcients of Eqs. (12.16) and (12.17), we obtain k1¬à413 :1;k2¬à132 :08;k3¬à10:9 12.18 ¬Ü Finally, the zero term of the closed-loop transfer function is the same as the zero term of the open-loop system, or s¬á5¬Ü. Using Eqs. (12.14), we obtain the following state-space representation of the closed- loop system: _x¬à01 0 00 1  413 :1 136 :08  15 :92 435x¬á0 012 435r (12.19a) y¬à¬â100 20 0 ¬äx (12.19b) The transfer function is T s¬Ü¬à 20 s¬á5¬Ü s3¬á15:9s2¬á136 :08s¬á413 :1 12.20 ¬Ü Figure 12.5, a simulation of the closed-loop system, shows 11.5% overshoot and a settling time of 0.8 second. A redesign with the third pole canceling the zero at  5 will yield performance equal to the requirements. Since the steady-state response approaches 0.24 instead of unity, there is a large steady-state error. Design techniques to reduce this error are discussed in Section 12.8.x1u1 x3 x2 x1100 y20 ‚Äì4 x31 u1 rx2y ‚Äì5 ‚Äìk3‚Äì4 ‚Äìk2 ‚Äìk1(a) (b)‚Äì51 s1 s1 s 1 s1 s1 s20 100 FIGURE 12.4 a.Phase- variable representation for plant of Example 12.1; b.plant with state-variable feedback656 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:19 In this section, we showed how to design feedback gains for plants represented in phase-variable form in order to place all of the closed-loop system ‚Äôs poles at desired locations on the s-plane. On the surface, it appears that the method should always work forStudents who are using MATLAB should now run ch12 p1 in Appendix B. You will learn how to use MATLAB to design a controller for phase variables using pole placement. MATLAB will plot the step response of the designed system. This exercise solves Example 12.1 using MATLAB. 0 00.30 2.0 Time (seconds)c(t)0.25 0.200.15 0.100.05 1.5 1.0 0.5FIGURE 12.5 Simulation of closed-loop system of Example 12.1 Skill-Assessment Exercise 12.1 PROBLEMS: For the plant G s¬Ü¬à100 s¬á10¬Ü s s¬á3¬Ü s¬á12¬Ü represented in the state space in phase-variable form by _x¬àAx¬áBu¬à010 0010 36  152 6643 775x¬á0 012 6643 775u y¬àCx¬à1000 100 0/C2/C3 x design the phase-variable feedback gains to yield 5% overshoot and a peak time of 0.3 second. ANSWER: K¬à¬â2094 373 :11 4 :97¬ä The complete solution is located at www.wiley.com/college/nise .TryIt 12.1 Use MATLAB, the Control System Toolbox, and the following statements to solvefor the phase-variablefeedback gains to place the poles of the system in Skill- Assessment Exercise 12.1 at 3¬áj5; 3 j5, and  10. A=[0 1 0 001 0 36 15] B=[0;0;1] poles =[ 3+5j , ...  3 5j, 10] K=acker(A,B,poles)12.2 Controller Design 657WEBC12 10/29/2014 8:56:19 any system. However, this is not the case. The conditions that must exist in order to uniquely place the closed-loop poles where we want them is the topic of the next section. 12.3 Controllability Consider the parallel form shown in Figure 12.6( a). To control the pole location of the closed-loop system, we are saying implicitly that the control signal, u, can control the behavior of each state variable in x. If any one of the state variables cannot be controlled by the control u, then we cannot place the poles of the system where we desire. For example, in Figure 12.6( b), ifx1were not controllable by the control signal and if x1also exhibited an unstable response due to a nonzero initial condition, there would be no way to effect a state-feedback design to stabilize x1. State variable x1would perform in its own way regardless of the control signal, u. Thus, in some systems, a state-feedback design is not possible. We now make the following de Ô¨Ånition based upon the previous discussion: If an input to a system can be found that takes every state variable from a desired initial state to a desired Ô¨Ånal state, the system is said to be controllable ; otherwise, the system is uncontrollable . Pole placement is a viable design technique only for systems that are controllable. This section shows how to determine, a priori, whether pole placement is a viable design technique for a controller. Controllability by Inspection We can explore controllability from another viewpoint: that of the state equation itself. When the system matrix is diagonal, as it is for the parallel form, it is apparent whetheror not the system is controllable. For example, the state equation for Figure 12.6( a)i s _x¬à a 1 00 0  a2 0 00  a32 643 75x¬á1 112 643 75u 12.21 ¬Ü or _x 1¬à a1x1 ¬áu (12.22a) _x2¬à  a2x2 ¬áu (12.22b) _x3¬à  a3x3¬áu (12.22c) Since each of Eqs. (12.22) is independent and decoupled from the rest, the control u affects each of the state variables. This is controllability from another perspective. Now let us look at the state equations for the system of Figure 12.6( b): _x¬à a4 00 0  a5 0 00  a62 435x¬á0 112 435u 12.23 ¬Ü or _x 1¬à a4x1 (12.24a) _x2¬à  a5x2 ¬áu (12.24b) _x3¬à  a6x3¬áu (12.24c)u x1 y11 1 (a)‚Äìa3x3‚Äìa2‚Äìa1 K2 u x1 y1 1 (b)‚Äìa6x3 x2 ‚Äìa5‚Äìa4K3 K5K4 K6K1 x21 s 1 s 1 s 1 s 1 s 1 s FIGURE 12.6 Comparison of a.controllable and b.uncontrollable systems658 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:20 From the state equations in (12.23) or (12.24), we see that state variable x1is not controlled by the control u. Thus, the system is said to be uncontrollable. In summary, a system with distinct eigenvalues and a diagonal system matrix is controllable if the input coupling matrix Bdoes not have any rows that are zero. The Controllability Matrix Tests for controllability that we have so far explored cannot be used for representations of the system other than the diagonal or parallel form with distinct eigenvalues. The problemof visualizing controllability gets more complicated if the system has multiple poles, eventhough it is represented in parallel form. Further, one cannot always determine controllabilityby inspection for systems that are not represented in parallel form. In other forms, the existenceof paths from the input to the state variables is not a criterion for controllability since theequations are not decoupled. In order to be able to determine controllability or, alternatively, to design state feedback for a plant under any representation or choice of state variables, a matrix can be derived thatmust have a particular property if all state variables are to be controlled by the plant input, u. We now state the requirement for controllability, including the form, property, and name ofthis matrix. 3 Annth-order plant whose state equation is _x¬àAx¬áBu 12.25 ¬Ü is completely controllable4if the matrix CM¬à¬âBA BA2B‚àô‚àô‚àô An 1B¬ä 12.26 ¬Ü is of rank n, where CMis called the controllability matrix.5As an example, let us choose a system represented in parallel form with multiple roots. Example 12.2 Controllability via the Controllability MatrixControllability via the Controllability Matrix PROBLEM: Given the system of Figure 12.7, represented by a signal-Ô¨Çow diagram, determine its controllability. ‚Äì1 ‚Äì1 ‚Äì10 10 ‚Äì21u11 10 y x3x1 x21 s1 s 1 s FIGURE 12.7 System for Example 12.2 3See the work listed in the Bibliography by Ogata (1990 :699‚Äì702) for the derivation. 4Completely controllable means that all state variables are controllable. This textbook uses controllable to mean completely controllable . 5See Appendix G at www.wiley.com/college/nise for the de Ô¨Ånition of rank. For single-input systems, instead of specifying rank n, we can say that CMmust be nonsingular, possess an inverse, or have linearly independent rows and columns.12.3 Controllability 659WEBC12 10/29/2014 8:56:20 In the previous example, we found that even though an element of the input coupling matrix was zero, the system was controllable. If we look at Figure 12.7, we can see why. In thisÔ¨Ågure, all of the state variables are driven by the input u. On the other hand, if we disconnect the input at either dx1=dt;dx2=dt,o rdx3=dt,a t least one state variable would not be controllable. To see the effect, let us disconnect theinput at dx 2=dt. This causes the Bmatrix to become B¬à0 012 643 75 12.29 ¬Ü We can see that the system is now uncontrollable, since x 1andx2are no longer controlled by the input. This conclusion is borne out by the controllability matrix, which is now CM¬àBA BA2B/C2/C3 ¬à00 0 00 0 1 242 643 75 12.30 ¬Ü Not only is the determinant of this matrix equal to zero, but so is the determinant of any 2 2 submatrix. Thus, the rank of Eq. (12.30) is 1. The system is uncontrollable because the rank ofCMis 1, which is less than the order, 3, of the system.SOLUTION: The state equation for the system written from the signal-Ô¨Çow diagram is _x¬àAx¬áBu¬à 110 0 10 00  22 643 75x¬á0 1 12 643 75u 12.27 ¬Ü AtÔ¨Årst, it would appear that the system is not controllable because of the zero in the Bmatrix. Remember, though, that this con Ô¨Åguration leads to uncontrollability only if the poles are real and distinct. In this case, we have multiple poles at  1. The controllability matrix is CM¬àBA BA2B/C2/C3 ¬à01  2 1 11 1 242 643 75 12.28 ¬Ü The rank of CMequals the number of linearly independent rows or columns. The rank can be found by Ô¨Ånding the highest-order square submatrix that is nonsingular. The determinant of CM¬à 1. Since the determinant is not zero, the 3 3 matrix is nonsingular, and the rank of CMis 3. We conclude that the system is controllable since the rank of CMequals the system order. Thus, the poles of the system can be placed using state-variable feedback design. Students who are using MATLAB should now run ch12p2 in Appendix B. You will learn how to use MATLAB to test a system for controlla-bility. This exercise solves Example 12.2 using MATLAB.660 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:21 In summary, then, pole-placement design through state-variable feedback is simpli Ô¨Åed by using the phase-variable form for the plant ‚Äôs state equations. However, controllability, the ability for pole-placement design to succeed, can be visualized best in the parallel form, where the system matrix is diagonal with distinct roots. In any event, the controllability matrix willalways tell the designer whether the implementation is viable for state-feedback design. The next section shows how to design state-variable feedback for systems not represented in phase-variable form. We use the controllability matrix as a tool for trans-forming a system to phase-variable form for the design of state-variable feedback. 12.4 Alternative Approaches to Controller Design Section 12.2 showed how to design state-variable feedback to yield desired closed-loop poles. We demonstrated this method using systems represented in phase-variable form and saw how simple it was to calculate the feedback gains. Many times the physics of theproblem requires feedback from state variables that are not phase variables. For thesesystems we have some choices for a design methodology. TheÔ¨Årst method consists of matching the coef Ô¨Åcients of det sI  A BK¬Ü¬Üwith the coefÔ¨Åcients of the desired characteristic equation, which is the same method we used for systems represented in phase variables. This technique, in general, leads to dif Ô¨Åcult calculations of the feedback gains, especially for higher-order systems not represented with phase variables. Let us illustrate this technique with an example.Skill-Assessment Exercise 12.2 PROBLEM: Determine whether the system _x¬àAx¬áBu¬à 112 0 15 03  42 643 75x¬á2 112 643 75u is controllable. ANSWER: Controllable The complete solution is located at www.wiley.com/college/nise .TryIt 12.2 U s eM A T L A B ,t h eC o n t r o l System Toolbox, and thefollowing statements to solve Skill-Assessment Exercise 12.2. A=[ 112 0 15 03  4] B=[2;1;1] Cm=ctrb (A,B) Rank=rank (Cm) Example 12.3 Controller Design by Matching CoefficientsController Design by Matching Coefficients PROBLEM: Given a plant, Y s¬Ü=U s¬Ü¬à10=¬â s¬á1¬Ü s¬á2¬Ü¬ä, design state feedback for the plant represented in cascade form to yield a 15% overshoot with a settling time of 0.5 second. SOLUTION: The signal- Ô¨Çow diagram for the plant in cascade form is shown in Figure 12.8( a). Figure 12.8( b) shows the system with state feedback added. Writing the state equations from Figure 12.8( b), we have _x¬à 21  k1  k2¬á1¬Ü/C20/C21 x¬á0 1/C20/C21 r (12.31a) y¬à¬â10 0 ¬äx (12.31b)12.4 Alternative Approaches to Controller Design 661WEBC12 10/29/2014 8:56:21 The second method consists of transforming the system to phase variables, designing the feedback gains, and transforming the designed system back to its original state-variable representation.6This method requires that we Ô¨Årst develop the transformation between a system and its representation in phase-variable form. Assume a plant not represented in phase-variable form _z¬àAz¬áBu (12.34a) y¬àCz (12.34b) whose controllability matrix is CMz¬à¬âBA BA2B‚àô‚àô‚àôAn 1B¬ä 12.35 ¬Üwhere the characteristic equation is s2¬á k2¬á3¬Üs¬á 2k2¬ák1¬á2¬Ü¬à0 12.32 ¬Ü Using the transient response requirements stated in the problem, we obtain the desiredcharacteristic equation s 2¬á16s¬á239 :5¬à0 12.33 ¬Ü Equating the middle coef Ô¨Åcients of Eqs. (12.32) and (12.33), we Ô¨Åndk2¬à13. Equating the last coef Ô¨Åcients of these equations along with the result for k2yields k1¬à211 :5.u1 x21 x110 y ‚Äì1 x21 1 u1 r x110 y ‚Äì1 ‚Äì2 ‚Äìk2 ‚Äìk1(a) (b)‚Äì21 s1 s 1 s1 s FIGURE 12.8 a.Signal- Ô¨Çow graph in cascade form for G s¬Ü¬à10=¬â s¬á1¬Ü s¬á2¬Ü¬ä; b.system with state feedback added 6See the discussions of Ackermann ‚Äôs formula in ( Franklin ,1994 ) and ( Ogata ,1990 ), listed in the Bibliography.662 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:22 Assume that the system can be transformed into the phase-variable ( x) representation with the transformation z¬àPx 12.36 ¬Ü Substituting this transformation into Eqs. (12.34), we get _x¬àP 1APx ¬áP 1Bu (12.37a) y¬àCPx (12.37b) whose controllability matrix is CMx¬à¬âP 1B P 1AP¬Ü P 1B¬Ü P 1AP¬Ü2 P 1B¬Ü‚àô‚àô‚àô P 1AP¬Ün 1 P 1B¬Ü¬ä ¬à¬âP 1B P 1AP¬Ü P 1B¬Ü P 1AP¬Ü P 1AP¬Ü P 1B¬Ü ‚àô‚àô‚àô P 1AP¬Ü P 1AP¬Ü P 1AP¬Ü‚àô‚àô‚àô P 1AP¬Ü P 1B¬Ü¬ä ¬àP 1¬âBA BA2B‚àô‚àô‚àô An 1B¬ä 12.38 ¬Ü Substituting Eq. (12.35) into (12.38) and solving for P, we obtain P¬àCMzC 1 Mx 12.39 ¬Ü Thus, the transformation matrix, P, can be found from the two controllability matrices. After transforming the system to phase variables, we design the feedback gains as in Section 12.2. Hence, including both feedback and input, u¬à Kxx¬ár, Eqs. (12.37) becomes _x¬àP 1APx  P 1BK xx¬áP 1Br ¬à P 1AP P 1BK x¬Üx¬áP 1Br(12.40a) y¬àCPx (12.40b) Since this equation is in phase-variable form, the zeros of this closed-loop system are determined from the polynomial formed from the elements of CP, as explained in Section 12.2. Using x¬àP 1z, we transform Eqs. (12.40) from phase variables back to the original representation and get _z¬àAz BK xP 1z¬áBr¬à A BK xP 1¬Üz¬áBr (12.41a) y¬àCz (12.41b) Comparing Eqs. (12.41) with (12.3), the state variable feedback gain, Kz, for the original system is Kz¬àKxP 1 12.42 ¬Ü The transfer function of this closed-loop system is the same as the transfer function forEqs. (12.40), since Eqs. (12.40) and (12.41) represent the same system. Thus, the zeros ofthe closed-loop transfer function are the same as the zeros of the uncompensated plant,based upon the development in Section 12.2. Let us demonstrate with a design example.12.4 Alternative Approaches to Controller Design 663WEBC12 10/29/2014 8:56:25 Example 12.4 Controller Design by TransformationController Design by Transformation PROBLEM: Design a state-variable feedback controller to yield a 20.8% overshoot and a settling time of 4 seconds for a plant, G s¬Ü¬à s¬á4¬Ü s¬á1¬Ü s¬á2¬Ü s¬á5¬Ü 12.43 ¬Ü that is represented in cascade form as shown in Figure 12.9. SOLUTION: First Ô¨Ånd the state equations and the controllability matrix. The state equations written from Figure 12.9 are _z¬àAzz¬áBzu¬à 510 0 21 00  12 643 75z¬á0 012 643 75u (12.44a) y¬àC zz¬à¬â  110 ¬äz (12.44b) from which the controllability matrix is evaluated as CMz¬àBzAzBzA2 zBz/C2/C3 ¬à001 01  3 1 112 643 75 12.45 ¬Ü Since the determinant of CMzis 1, the system is controllable. We now convert the system to phase variables by Ô¨ÅrstÔ¨Ånding the characteristic equation and using this equation to write the phase-variable form. The characteristic equation, det sI Az¬Ü,i s det sI Az¬Ü¬às3¬á8s2¬á17s¬á10¬à0 12.46 ¬Ü Using the coef Ô¨Åcients of Eq. (12.46) and our knowledge of the phase-variable form, we write the phase-variable representation of the system as _x¬àAxx¬áBxu¬à01 0 00 1  10  17  82 643 75x¬á0 0 12 643 75u (12.47a) y¬à¬â410 ¬äx (12.47b)u z31 z21 z14 ‚Äì1 ‚Äì2 ‚Äì5y1 11 s1 s1 s FIGURE 12.9 Signal- Ô¨Çow graph for plant of Example 12.4664 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:26 The output equation was written using the coef Ô¨Åcients of the numerator of Eq. (12.43), since the transfer function must be the same for the two representations. The controllability matrix, CMx, for the phase-variable system is CMx¬àBxAxBxA2 xBx/C2/C3 ¬à001 01  8 1 84 72 643 75 12.48 ¬Ü Using Eq. (12.39), we can now calculate the transformation matrix between the two systems as P¬àCMzC 1 Mx¬à100 510 10 7 12 643 75 12.49 ¬Ü We now design the controller using the phase-variable representation and then use Eq. (12.49) to transform the design back to the original representation. For a 20.8% overshoot and a settling time of 4 seconds, a factor of the characteristic equation of thedesigned closed-loop system is s 2¬á2s¬á5. Since the closed-loop zero will be at s¬à 4, we choose the third closed-loop pole to cancel the closed-loop zero. Hence, the totalcharacteristic equation of the desired closed-loop system is D s¬Ü¬à s¬á4¬Ü s 2¬á2s¬á5¬Ü¬às3¬á6s2¬á13s¬á20¬à0 12.50 ¬Ü The state equations for the phase-variable form with state-variable feedback are _x¬à Ax BxKx¬Üx¬à01 0 00 1   10¬ák1x¬Ü  17¬ák2x¬Ü  8¬ák3x¬Ü2 643 75x (12.51a) y¬à¬â410 ¬äx (12.51b) The characteristic equation for Eqs. (12.51) is det sI  Ax BxKx¬Ü¬Ü ¬à s3¬á 8¬ák3x¬Üs2¬á 17¬ák2x¬Üs¬á 10¬ák1x¬Ü ¬à0 12.52 ¬Ü Comparing Eq. (12.50) with (12.52), we see that Kx¬à¬âk1xk2xk3x¬ä¬à¬â 10  4  2¬ä 12.53 ¬Ü Using Eqs. (12.42) and (12.49), we can transform the controller back to the original system as Kz¬àKxP 1¬à¬â  20 10  2¬ä 12.54 ¬Ü TheÔ¨Ånal closed-loop system with state-variable feedback is shown in Figure 12.10, with the input applied as shown.12.4 Alternative Approaches to Controller Design 665WEBC12 10/29/2014 8:56:27 Let us now verify our design. The state equations for the designed system shown in Figure 12.10 with input rare _z¬à Az BzKz¬Üz¬áBzr¬à 51 0 0  21 20  10 12 643 75z¬á0 0 12 643 75r (12.55a) y¬àCzz¬à¬â  110 ¬äz (12.55b) Using Eq. (3.73) to Ô¨Ånd the closed-loop transfer function, we obtain T s¬Ü¬à s¬á4¬Ü s3¬á6s2¬á13s¬á20¬à1 s2¬á2s¬á5 12.56 ¬Ü The requirements for our design have been met. Students who are using MATLAB should now run ch12p3 in Appendix B. You will learn how to use MATLAB to design a controller for a plant not represented in phase-variable form. You will see that MATLABdoes not require transformation to phase-variable form. This exercise solves Example 12.4 using MATLAB.‚Äì1 ‚Äì2 20‚Äì10‚Äì5r1 u11 z31 z24 z1y1 21 s1 s1 s FIGURE 12.10 Designed system with state-variable feedback for Example 12.4 Skill-Assessment Exercise 12.3 PROBLEM: Design a linear state-feedback contro ller to yield 20% overshoot and a settling time of 2 seconds for a plant G s¬Ü¬à s¬á6¬Ü s¬á9¬Ü s¬á8¬Ü s¬á7¬Ü that is represented in state space in cascade form by _z¬àAz¬áBu¬à 710 0 81 00  92 6643 775z¬á0 012 6643 775u y¬àCz¬à  110/C2/C3 z ANSWER: K z¬à¬â  40:23 62 :24  14¬ä The complete solution is located at www.wiley.com/college/nise .666 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:27 In this section, we saw how to design state-variable feedback for plants not represented in phase-variable form. Using controllability matrices, we were able to transform a plant to phase-variable form, design the controller, and Ô¨Ånally transform the controller design back to the plant ‚Äôs original representation. The design of the controller relies on the availability of the states for feedback. In the next section, we discuss the designof state-variable feedback when some or all of the states are not available. 12.5 Observer Design Controller design relies upon access to the state variables for feedback through adjustablegains. This access can be provided by hardware. For example, gyros can measure positionand velocity on a space vehicle. Sometimes it is impractical to use this hardware for reasonsof cost, accuracy, or availability. For example, in powered Ô¨Çight of space vehicles, inertial measuring units can be used to calculate the acceleration. However, their alignmentdeteriorates with time; thus, other means of measuring acceleration may be desirable(Rockwell International ,1984 ). In other applications, some of the state variables may not be available at all, or it is too costly to measure them or send them to the controller. If thestate variables are not available because of system con Ô¨Åguration or cost, it is possible to estimate the states. Estimated states, rather than actual states, are then fed to the controller.One scheme is shown in Figure 12.11( a). An observer , sometimes called an estimator ,i s used to calculate state variables that are not accessible from the plant. Here the observer is amodel of the plant. Plant ObserverPlant output, y Estimated output, y+ Controlleru +r = 0 (a)Plant Observer+ Controlleru +r = 0 Estimated states, (b) LAB+ ++ ‚Äì To controlleru (c)+Estimated output, yCx x.Plant output, y xEstimated states, x Plant output, yÀÜÀÜ ÀÜ ÀÜ ÀÜ ÀÜ Estimated error output‚à´ FIGURE 12.11 State- feedback design using an observer to estimate unavailable state variables: a.open-loop observer; b.closed-loop observer; c.exploded view of a closed-loop observer, showing feedback arrangement to reducestate-variable estimation error12.5 Observer Design 667WEBC12 10/29/2014 8:56:27 Let us look at the disadvantages of such a con Ô¨Åguration. Assume a plant, _x¬àAx¬áBu (12.57a) y¬àCx (12.57b) and an observer, _^x¬àA^x¬áBu (12.58a) ^y¬àC^x (12.58b) Subtracting Eqs. (12.58) from (12.57), we obtain _x _^x¬àA x ^x¬Ü (12.59a) y ^y¬àC x ^x¬Ü (12.59b) Thus, the dynamics of the difference between the actual and estimated states is unforced, and if the plant is stable, this difference, due to differences in initial state vectors, approaches zero. However, the speed of convergence between the actual state and the estimated state is the same as the transient response of the plant since the characteristicequation for Eq. (12.59a) is the same as that for Eq. (12.57a). Since the convergence is tooslow, we seek a way to speed up the observer and make its response time much faster thanthat of the controlled closed-loop system, so t hat, effectively, the controller will receive the estimated states instantaneously. To increase the speed of convergence between the actual and estimated states, we use feedback, shown conceptually in Figure 12.11( b) and in more detail in Figure 12.11( c). The error between the outputs of the plant and the observer is fed back to the derivatives of theobserver ‚Äôs states. The system corrects to drive this error to zero. With feedback we can design a desired transient response into the observer that is much quicker than that of theplant or controlled closed-loop system. When we implemented the controller, we found that the phase-variable or controller canonical form yielded an easy solution for the controller gains. In designing an observer, itis the observer canonical form that yields the easy solution for the observer gains.Figure 12.12( a) shows an example of a third-order plant represented in observer canonical form. In Figure 12.12( b), the plant is con Ô¨Ågured as an observer with the addition of feedback, as previously described. The design of the observer is separate from the design of the controller. Similar to the design of the controller vector, K, the design of the observer consists of evaluating the constant vector, L, so that the transient response of the observer is faster than the response of the controlled loop in order to yield a rapidly updated estimate of the state vector. We nowderive the design methodology. We will Ô¨ÅrstÔ¨Åndthe state equations for the error between the actual state vector and the estimated state vector, x ^x¬Ü.T h e nw ew i l l Ô¨Ånd the characteristic equation for the error system and evaluate the required Lto meet a rapid transient response for the observer. Writing the state equations of the observer from Figure 12.11( c), we have _^x¬àA^x¬áBu¬áL y ^y¬Ü (12.60a) ^y¬àC^x (12.60b)668 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:28 But the state equations for the plant are _x¬àAx¬áBu (12.61a) y¬àCx (12.61b) Subtracting Eqs. (12.60) from (12.61), we obtain _x _^x¬Ü¬àA x ^x¬Ü L y ^y¬Ü (12.62a) y ^y¬Ü¬àC x ^x¬Ü (12.62b) where x ^xis the error between the actual state vector and the estimated state vector, and y ^yis the error between the actual output and the estimated output. Substituting the output equation into the state equation, we obtain the state equation for the error between the estimated state vector and the actual state vector: _x _^x¬Ü¬à A LC¬Ü x ^x¬Ü (12.63a) y ^y¬Ü¬àC x ^x¬Ü (12.63b)ub1 x3ÀÜ1 x2ÀÜ1 x1ÀÜ1 yÀÜ ‚Äìa2 ‚Äìa1 ‚Äìa0b2b3 (a) b3 b2 ub1 x3ÀÜ1 x2ÀÜ1 x1ÀÜ1 yÀÜ‚Äì11 y ‚Äìa2 ‚Äìa1 ‚Äìa0 l3l2l1 (b)1 s1 s1 s 1 s1 s1 s FIGURE 12.12 Third-order observer in observer canonical form: a.before the addition of feedback; b.after the addition of feedback12.5 Observer Design 669WEBC12 10/29/2014 8:56:28 Letting ex¬à x ^x¬Ü, we have _ex¬à A LC¬Üex (12.64a) y ^y¬àCex (12.64b) Equation (12.64a) is unforced. If the eigenvalues are all negative, the estimated state vector error, ex, will decay to zero. The design then consists of solving for the values of Lto yield a desired characteristic equation or response for Eqs. (12.64). The characteristic equation is found from Eqs. (12.64) to be det¬âŒªI  A LC¬Ü¬ä ¬à0 12.65 ¬Ü Now we select the eigenvalues of the observer to yield stability and a desired transient response that is faster than the controlled closed-loop response. These eigenvalues deter-mine a characteristic equation that we set equal to Eq. (12.65) to solve for L. Let us demonstrate the procedure for an nth-order plant represented in observer canonical form. We Ô¨Årst evaluate A LC. The form of A,L, and Ccan be derived by extrapolating the form of these matrices from a third-order plant, which you can derive fromFigure 12.12. Thus, A LC¬à a n 1100 ‚àô‚àô‚àô 0  an 2010 ‚àô‚àô‚àô 0 ..................  a1000 ‚àô‚àô‚àô 1  a0000 ‚àô‚àô‚àô 02 6666666666643 777777777775 l 1 l2 ... ln 1 ln2 6666666666643 7777777777751000 ‚àô‚àô‚àô 0/C2/C3 ¬à  an 1¬ál1¬Ü100 ‚àô‚àô‚àô 0   an 2¬ál2¬Ü010 ‚àô‚àô‚àô 0 ..................   a1¬áln 1¬Ü000 ‚àô‚àô‚àô 1   a0¬áln¬Ü000 ‚àô‚àô‚àô 02 6666666666643 777777777775 12.66 ¬Ü The characteristic equation for A LCis s n¬á an 1¬ál1¬Üsn 1¬á an 2¬ál2¬Üsn 2¬á‚àô‚àô‚àô¬á a1¬áln 1¬Üs¬á a0¬áln¬Ü¬à0 12.67 ¬Ü Notice the relationship between Eq. (12.67) and the characteristic equation, det sI A¬Ü¬à0, for the plant, which is sn¬áan 1sn 1¬áan 2sn 2¬á‚àô‚àô‚àô¬áa1s¬áa0¬à0 12.68 ¬Ü670 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:29 Thus, if desired, Eq. (12.67) can be written by inspection if the plant is represented in observer canonical form. We now equate Eq. (12.67) with the desired closed-loop observer characteristic equation, which is chosen on the basis of a desired transient response.Assume the desired characteristic equation is s n¬ádn 1sn 1¬ádn 2sn 2¬á‚àô‚àô‚àô¬ád1s¬ád0¬à0 12.69 ¬Ü We can now solve for the li‚Äôs by equating the coef Ô¨Åcients of Eqs. (12.67) and (12.69): li¬àdn i an ii¬à1;2;...; n 12.70 ¬Ü Let us demonstrate the design of an observer using the observer canonical form. Insubsequent sections we will show how to design the observer for other than observercanonical form. Example 12.5 Observer Design for Observer Canonical FormObserver Design for Observer Canonical Form PROBLEM: Design an observer for the plant G s¬Ü¬à s¬á4¬Ü s¬á1¬Ü s¬á2¬Ü s¬á5¬Ü¬às¬á4 s3¬á8s2¬á17s¬á10 12.71 ¬Ü which is represented in observer canonical form. The observer will respond 10 times faster than the controlled loop designed in Example 12.4. SOLUTION: 1.First represent the estimated plant in observer canonical form. The result is shown in Figure 12.13( a). 2.Now form the difference between the plant ‚Äôs actual output, y, and the observer ‚Äôs estimated output, ^y, and add the feedback paths from this difference to the derivative of each state variable. The result is shown in Figure 12.13( b). 3.Next Ô¨Ånd the characteristic polynomial. The state equations for the estimated plant shown in Figure 12.13(a ) are _^x¬àA^x¬áBu¬à 810  17 0 1  10 0 02 643 75^x¬á0 142 643 75u (12.72a) ^y¬àC^x¬à¬â100 ¬ä^x (12.72b) From Eqs. (12.64) and (12.66), the observer error is _e x¬à A LC¬Üex¬à  8¬ál1¬Ü10   17¬ál2¬Ü01   10¬ál3¬Ü002 643 75ex 12.73 ¬Ü12.5 Observer Design 671WEBC12 10/29/2014 8:56:29 Using Eq. (12.65), we obtain the characteristic polynomial s3¬á 8¬ál1¬Üs2¬á 17¬ál2¬Üs¬á 10¬ál3¬Ü 12.74 ¬Ü 4.Now evaluate the desired polynomial, set the coef Ô¨Åcients equal to those of Eq. (12.74), and solve for the gains, li. From Eq. (12.50), the closed-loop controlled system has dominant second-order poles at  1j2. To make our observer 10 times faster, we design the observer poles to be at  10j20. We select the third pole to be 10 times the real part of the dominant second-order poles, or  100. Hence, the desired characteristic polynomial is s¬á100¬Ü s2¬á20s¬á500¬Ü¬às3¬á120s2¬á2500 s¬á50;000 12.75 ¬Ü Equating Eqs. (12.74) and (12.75), we Ô¨Ånd l1¬à112 ;l2¬à2483, and l3¬à49;990. A simulation of the observer with an input of r t¬Ü¬à100tis shown in Figure 12.14. The initial conditions of the plant were all zero, and the initial condition of ^x1was 0.5. Since the dominant pole of the observer is  10j20, the expected settling time should be about 0.4 second. It is interesting to note the slower response in Figure 12.14( b),1 1u4 xÀÜ311 1 yÀÜ ‚Äì8 ‚Äì17 ‚Äì10 u4 x3ÀÜ11 x1ÀÜ1 ‚Äì 11 y ‚Äì8 ‚Äì17 ‚Äì10 l3l2l1(a) (b)ÀÜx1ÀÜx2 ÀÜx2 yÀÜ1 s1 s1 s 1 s1 s1 s FIGURE 12.13 a.Signal- Ô¨Çow graph of a system using observer canonical form variables; b.additional feedback to create observer672 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:30 where the observer gains are disconnected, and the observer is simply a copy of the plant with a different initial condition. Students who are using MATLAB should now run ch12p4 in Appendix B. You will learn how to use MATLAB to design an observer using poleplacement. This exercise solves Example 12.5 using MATLAB.0.5 0.40.30.20.1 0 ‚Äì0.1 ‚Äì0.2 ‚Äì0.3 ‚Äì0.4 ‚Äì0.5y, y 0 0.1 0.2 0.3 Time (seconds)y 0.50.40.30.20.1 0 ‚Äì0.1 ‚Äì0.2 ‚Äì0.3 ‚Äì0.4 ‚Äì0.5y, y 0 0.1 0.2 0.3yy(a) Time (seconds) (b)ÀÜÀÜÀÜ yÀÜ FIGURE 12.14 Simulation showing response of observer: a.closed-loop; b.open-loop with observer gains disconnected Skill-Assessment Exercise 12.4 PROBLEM: Design an observer for the plant G s¬Ü¬à s¬á6¬Ü s¬á7¬Ü s¬á8¬Ü s¬á9¬Ü whose estimated plant is represented in state space in observer canonical form as _^x¬àA^x¬áBu¬à 24 1 0  191 0 1  504 0 02 6643 775^x¬á0 162 6643 775u ^y¬àC^x¬à100/C2/C3^x The observer will respond 10 times faster than the controlled loop designed in Skill-Assessment Exercise 12.3. ANSWER: L¬à¬â216 9730 383 ;696¬ä T, where T signi Ô¨Åes vector transpose The complete solution is located at www.wiley.com/college/nise .TryIt 12.3 Use MATLAB, the Control System Toolbox, and the following statements to solve Skill-Assessment Exercise 12.4. A=[ 24 1 0  191 0 1  504 0 0] C=[1 0 0] pos=20 Ts=2 z=( log(pos/100) ) /... (sqrt(pi^2 +... log(pos/100) ^2) ) ; wn=4/ (z*Ts) ; r=roots( [1,2*z*wn, ... wn^2] ) ; poles =10* [r' 10*... real(r(1) ) ] l=acker(A',C',poles) '12.5 Observer Design 673WEBC12 10/29/2014 8:56:30 In this section, we designed an observer in observer canonical form that uses the output of a system to estimate the state variables. In the next section, we examine the conditions under which an observer cannot be designed. 12.6 Observability Recall that the ability to control all of the state variables is a requirement for the design of a controller. State-variable feedback gains cannot be designed if any state variable is uncontrollable. Uncontrollability can be viewed best withdiagonalized systems. The signal-Ô¨Ç ow graph showed clearly that the uncontrollable state variable was not connected to the control signal of thesystem. A similar concept governs our ability to create a design for an observer. Speci Ô¨Åcally, we are using the output of a system to deduce the state variables. If any state variable has no effect upon the output, then we cannot evaluate this state variable by observing the output. The ability to observe a state variable from the output is best seen from the diagonalized system. Figure 12.15( a) shows a system where each state variable can be observed at the output since each is connected to the output. Figure 12.15( b) is an example of a system where all state variables cannot be observed at the output. Here x 1is not connected to the output and could not be estimated from a measurement of the output. We now make the followingdeÔ¨Ånition based upon the previous discussion: If the initial-state vector, x(t 0), can be found from u(t) and y(t) measured over a Ô¨Ånite interval of time from t0, the system is said to be observable ; otherwise the system is said to be unobservable . Simply stated, observability is the ability to deduce the state variables from a knowledge of the input, u(t), and the output, y(t). Pole placement for an observer is a viable design technique only for systems that are observable. This section shows how to determine, a priori, whether or not pole placement is a viabledesign technique for an observer. Observability by Inspection We can also explore observability from the output equation of a diagonalizedsystem. The output equation for the diagonalized system of Figure 12.15( a)i s y¬àCx¬à¬â111 ¬äx 12.76 ¬Ü On the other hand, the output equation for the unobservable system ofFigure 12.15( b)i s y¬àCx¬à¬â011 ¬äx 12.77 ¬Ü Notice that the Ô¨Årst column of Eq. (12.77) is zero. For systems represented in parallel form with distinct eigenvalues, if any column of the output coupling matrix is zero, the diagonalsystem is not observable. The Observability Matrix Again, as for controllability, systems represented in other than diagonalized form cannot bereliably evaluated for observability by inspection. In order to determine observability forsystems under any representation or choice of state variables, a matrix can be derived thatmust have a particular property if all state variables are to be observed at the output. We now state the requirements for observability, including the form, property, and name of this matrix.x1 ‚Äìa4K4 1 x2 1 x3uy (b)‚Äìa5 ‚Äìa6K5 K6x1 1 ‚Äìa1K1 1 x2 1 x3uy (a)‚Äìa2 ‚Äìa3K2 K31 s 1 s 1 s 1 s 1 s 1 s FIGURE 12.15 Comparison of a.observable, and b.unobservable systems674 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:31 Annth-order plant whose state and output equations are, respectively, _x¬àAx¬áBu (12.78a) y¬àCx (12.78b) is completely observable7if the matrix OM¬àC CA ... CAn 12 66666643 7777775 12.79 ¬Ü is of rank n, where O Mis called the observability matrix .8 The following two examples illustrate the use of the observability matrix. Example 12.6 Observability via the Observability MatrixObservability via the Observability Matrix PROBLEM: Determine if the system of Figure 12.16 is observable. SOLUTION: The state and output equations for the system are _x¬àAx¬áBu¬à010 001  4 3  22 643 75x¬á0 012 643 75u (12.80a) y¬àCx¬à¬â051 ¬äx (12.80b)x31 u x1y ‚Äì2 ‚Äì3 ‚Äì4x251 1 s1 s1 s FIGURE 12.16 System of Example 12.6 7Completely observable means that all state variables are observable. This textbook uses observable to mean completely observable . 8SeeOgata (1990 :706‚Äì708) for a derivation.12.6 Observability 675WEBC12 10/29/2014 8:56:31 Thus, the observability matrix, OM,i s OM¬àC CA CA22 643 75¬à05 1  4  33  12  13  92 643 75 12.81 ¬Ü Since the determinant of OMequals  344, OMis of full rank equal to 3. The system is thus observable. You might have been misled and concluded by inspection that the system is unobservable because the state variable x1is not fed directly to the output. Remember that conclusions about observability by in spection are valid only for diagonalized systems that have distinct eigenvalues. Students who are using MATLAB should now run ch12p5 in Appendix B. You will learn how to use MATLAB to test a system for observability. This exercise solves Example 12.6 using MATLAB. Example 12.7 Unobservability via the Observability MatrixUnobservability via the Observability Matrix PROBLEM: Determine whether the system of Figure 12.17 is observable. SOLUTION: The state and output equations for the system are _x¬àAx¬áBu¬à01  5  21 =4"# x¬á0 1"# u (12.82a) y¬àCx¬à¬â54 ¬äx (12.82b) The observability matrix, OM, for this system is OM¬àC CA"# ¬à54  20  16"# 12.83 ¬Ü1 x2u x14 y ‚Äì5‚Äì21 451 s1 s FIGURE 12.17 System of Example 12.7676 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:32 Now that we have discussed observability and the observability matrix, we are ready to talk about the design of an observer for a plant not represented in observer canonical form. 12.7 Alternative Approaches to Observer Design Earlier in the chapter, we discussed how to design controllers for systems notrepresented in phase-variable form. One method is to match the coef Ô¨Åcients of det¬âsI  A BK¬Ü¬äwith the coef Ô¨Åcients of the desired char acteristic polynomial. This method can yield dif Ô¨Åcult calculations for higher-order systems. Another method is to transform the plant to phase-variable form, design the controller, and transfer thedesign back to its original representation. The transformations were derived from thecontrollability matrix. In this section, we use a similar idea for the design of observers not represented in observer canonical form. One method is to match the coef Ô¨Åcients of det ¬âsI  A LC¬Ü¬ä with the coef Ô¨Åcients of the desired characteristic polynomial. Again, this method can yield difÔ¨Åcult calculations for higher-order systems. Another method is Ô¨Årst to transform the plant to observer canonical form so that the design equations are simple, then perform the design in observer canonical form, and Ô¨Ånally transform the design back to the original representation. Let us pursue this second method. First we will derive the transformation between a system representation and its representation in observer canonical form. Assume a plant not represented in observer canonical form, _z¬àAz¬áBu (12.84a) y¬àCz (12.84b)The determinant for this observability matrix equals 0. Thus, the observability matrix doesnot have full rank, and the system is not observable. Again, you might conclude by inspection that the system is observable because all states feed the output. Remember that observability by inspection is valid only for adiagonalized representation of a system with distinct eigenvalues. Skill-Assessment Exercise 12.5 PROBLEM: Determine whether the system _x¬àAx¬áBu¬à 2  1  3 0 21  7  8  92 643 75x¬á2 122 643 75u y¬àCx¬à¬â468 ¬äx is observable. ANSWER: Observable The complete solution is located at www.wiley.com/college/nise .TryIt 12.4 Use MATLAB, the Control System Toolbox, and the following statements to solve Skill-Assessment Exercise 12.5. A=[ 21 3 0 21  7 8 9] C=[4 6 8] Om=obsv (A,C) Rank=rank (Om)12.7 Alternative Approaches to Observer Design 677WEBC12 10/29/2014 8:56:32 whose observability matrix is OMz¬àC CA CA2 ... CAn 2 CAn 12 666666666643 77777777775 12.85 ¬Ü Now assume that the system can be transformed to the observer canonical form, x, with the transformation z¬àPx 12.86 ¬Ü Substituting Eq. (12.86) into Eqs. (12.84) and premultiplying the state equation by P  1,w e Ô¨Ånd that the state equations in observer canonical form are _x¬àP 1APx ¬áP 1Bu (12.87a) y¬àCPx (12.87b) whose observability matrix, OMx,i s OMx¬àCP CP P 1AP¬Ü CP P 1AP¬Ü P 1AP¬Ü ... CP P 1AP¬Ü P 1AP¬Ü‚àô‚àô‚àô P 1AP¬Ü2 6666666643 777777775¬àC CA CA 2 ... CAn 12 6666666643 777777775P 12.88 ¬Ü Substituting Eq. (12.85) into (12.88) and solving for P, we obtain P¬àO  1 MzOMx 12.89 ¬Ü Thus, the transformation, P, can be found from the two observability matrices. After transforming the plant to observer canonical form, we design the feedback gains, Lx, as in Section 12.5. Using the matrices from Eqs. (12.87) and the form suggested by Eqs. (12.64), we have _ex¬à P 1AP LxCP¬Üex (12.90a) y ^y¬àCPe x (12.90b) Since x¬àP 1z, and ^x¬àP 1^z, then ex¬àx ^x¬àP 1ez. Substituting ex¬àP 1ezinto Eqs. (12.90) transforms Eqs. (12.90) back to the original representation. The result is _ez¬à A PLxC¬Üez (12.91a) y ^y¬àCez (12.91b)678 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:34 Comparing Eq. (12.91a) to (12.64a), we see that the observer gain vector is Lz¬àLPx 12.92 ¬Ü We now demonstrate the design of an observer for a plant not represented in observer canonical form. The Ô¨Årst example uses transformations to and from observer canonical form. The second example matches coef Ô¨Åcients without the transformation. This method, however, can become difÔ¨Å cult if the system order is high. Example 12.8 Observer Design by TransformationObserver Design by Transformation PROBLEM: Design an observer for the plant G s¬Ü¬à1 s¬á1¬Ü s¬á2¬Ü s¬á5¬Ü 12.93 ¬Ü represented in cascade form. The closed-loop performance of the observer is governed by the characteristic polynomial used in Example 12.5: s3¬á120s2¬á2500 s¬á50;000. SOLUTION: First represent the plant in its original cascade form. _z¬àAz¬áBu¬à 510 0 21 00  12 643 75z¬á0 012 643 75u (12.94a) y¬àCz¬à¬â100 ¬äz (12.94b) The observability matrix, O Mz,i s OMz¬àC CA CA22 643 75¬à10 0  51 0 25  712 643 75 12.95 ¬Ü whose determinant equals 1. Hence, the plant is observable. The characteristic equation for the plant is det sI A¬Ü¬às3¬á8s2¬á17s¬á10¬à0 12.96 ¬Ü We can use the coef Ô¨Åcients of this characteristic polynomial to form the observer canonical form _x¬àAxx¬áBxu (12.97a) y¬àCxx (12.97b) where Ax¬à 810  17 0 1  10 0 02 6643 775;C x¬à100/C2/C3 12.98 ¬Ü12.7 Alternative Approaches to Observer Design 679WEBC12 10/29/2014 8:56:35 The observability matrix for the observer canonical form is OMx¬àCx CxAx CxA2 x2 643 75¬à10 0  81 0 47  812 643 75 12.99 ¬Ü We now design the observer for the observer canonical form. First form Ax LxCx¬Ü, Ax LxCx¬à 810  17 0 1  10 0 02 643 75 l1 l2 l32 643 75100/C2/C3 ¬à  8¬ál1¬Ü10   17¬ál2¬Ü01   10¬ál3¬Ü002 643 75 12.100 ¬Ü whose characteristic polynomial is det¬âsI  Ax LxCx¬Ü¬ä ¬à s3¬á 8¬ál1¬Üs2¬á 17¬ál2¬Üs¬á 10¬ál3¬Ü 12.101 ¬Ü Equating this polynomial to the desired closed-loop observer characteristic equation, s3¬á120s2¬á2500 s¬á50;000, we Ô¨Ånd Lx¬à112 2483 49;9902 643 75 12.102 ¬Ü Now transform the design back to the original representation. Using Eq. (12.89), the transformation matrix is P¬àO 1 MzOMx¬à10 0  31 0 1 112 643 75 12.103 ¬Ü 1 s1 ‚Äì1u1 s1 1 s1 1 y 1‚Äì2 ‚Äì5 1 1 s1 1 ‚Äì1 ‚Äì2 ‚Äì5s1 s1 11 47,6192,147112‚Äì1 yÀÜ ez ObserverPlant z3 z2 z1 z3 z2 z1 ÀÜ ÀÜ ÀÜ FIGURE 12.18 Observer design680 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:36 Transforming Lxto the original representation, we obtain Lz¬àPLx¬à112 2147 47;6192 643 75 12.104 ¬Ü TheÔ¨Ånal con Ô¨Åguration is shown in Figure 12.18. A simulation of the observer is shown in Figure 12.19( a). To demonstrate the effect of the observer design, Figure 12.19( b) shows the reduced speed if the observer is simply a copy of the plant and all observer feedback paths are disconnected. Students who are using MATLAB should now run ch12p6 in Appendix B. You will learn how to use MATLAB to design an observer for a plant not represented in observer canonical form. You will see that MATLAB does not require transformation to observer canonicalform. This exercise solves Example 12.8 using MATLAB. 01 23 Time (seconds) y (a) y yyy, y 01 23 Time (seconds) (b)00.6 0.4 0.2 ‚Äì0.6‚Äì0.4‚Äì0.200.6 0.4 0.2 ‚Äì0.6‚Äì0.4‚Äì0.2ÀÜÀÜy, yÀÜ ÀÜ FIGURE 12.19 Observer design step response simulation: a.closed-loop observer; b.open-loop observer with observer gains disconnected Example 12.9 Observer Design by Matching CoefficientsObserver Design by Matching Coefficients PROBLEM: A time-scaled model for the body ‚Äôs blood glucose level is shown in Eq. (12.105). The output is the deviation in glucose concentration from its mean value in mg/100 ml, and the input is the intravenous glucose injection rate in g/kg/hr(Milhorn ,1966 ). G s¬Ü¬à407 s¬á0:916¬Ü s¬á1:27¬Ü s¬á2:69¬Ü 12.105 ¬Ü12.7 Alternative Approaches to Observer Design 681WEBC12 10/29/2014 8:56:36 Design an observer for the phase variables with a transient response described by Œ∂¬à0:7a n d œân¬à100. SOLUTION: We can Ô¨Årst model the plant in phase-variable form. The result is shown in Figure 12.20(a ). For the plant, A¬à01  3:42  3:96"# ;C¬à372 :81 407/C2/C3 12.106 ¬Ü Calculation of the observability matrix, OM¬à¬âCC A ¬äT, shows that the plant is observable and we can proceed with the design. Next Ô¨Ånd the characteristic equation of the observer. First we have A LC¬à01  3:42  3:96"#  l1 l2"# 372 :81 407/C2/C3 ¬à 372 :81l1 1 407l1¬Ü   3:42¬á372 :81l2¬Ü  3:96¬á407l2¬Ü"# 12.107 ¬Üu1 x2 x1372.81 y ‚Äì3.96 ‚Äì3.42407 ( )a u1 x21 372.81 yÀÜ‚Äì11 y407 ‚Äì38.397 35.506‚Äì3.42‚Äì3.96 ( )bÀÜx1ÀÜ1 s1 s1 s 1 s FIGURE 12.20 a.Plant; b.designed observer for Example 12.9682 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:37 Now evaluate det ¬âŒªI  A LC¬Ü¬ä ¬à0 in order to obtain the characteristic equation: detŒªI  A LC¬Ü ¬â¬ä ¬àdet Œª¬á372 :81l1¬Ü  1 407l1¬Ü 3:42¬á372 :81l2¬Ü Œª¬á3:96¬á407l2¬Ü"# ¬àŒª2¬á 3:96¬á372 :81l1¬á407l2¬ÜŒª¬á 3:42¬á84:39l1¬á372 :81l2¬Ü ¬à0 12.108 ¬Ü From the problem statement, we want Œ∂¬à0:7 and œân¬à100. Thus, Œª2¬á140Œª¬á10;000¬à0 12.109 ¬Ü Comparing the coef Ô¨Åcients of Eqs. (12.108) and (12.109), we Ô¨Ånd the values l1andl2to be  38.397 and 35.506, respectively. Using Eq. (12.60), where A¬à01  3:42  3:96"# ;B¬à0 1"# ;C¬à372 :81 407/C2/C3 ; L¬à 38 :397 35:506"# 12.110 ¬Ü the observer is implemented and shown in Figure 12.20( b). Skill-Assessment Exercise 12.6 PROBLEM: Design an observer for the plant G s¬Ü¬à1 s¬á7¬Ü s¬á8¬Ü s¬á9¬Ü whose estimated plant is represented in state space in cascade form as _^z¬àA^z¬áBu¬à 710 0 81 00  92 6643 775^z¬á0 012 6643 775u ^y¬àC^x¬à100/C2/C3^z The closed-loop step response of the observer is to have 10% overshoot with a 0.1 second settling time. ANSWER: L z¬à456 28;640 1:541062 643 75 The complete solution is located at www.wiley.com/college/nise .12.7 Alternative Approaches to Observer Design 683WEBC12 10/29/2014 8:56:37 Now that we have explored transient response design using state-space techniques, let us turn to the design of steady-state error characteristics. 12.8 Steady-State Error Design via Integral Control In Section 7.8, we discussed how to analyze systems represented in state space for steady-state error. In this section, we discuss how to design systems represented in state space for steady-state error. Consider Figure 12.21. The previously designed controller discussed in Section 12.2 is shown inside the dashed box. A feedback path from the output has been added to form the error, e, which is fed forward to the controlled plant via an integrator. The integrator increases the system type and reduces the previous Ô¨Ånite error to zero. We will now derive the form of the state equations for the system of Figure 12.21 and then use that form todesign a controller. Thus, we will be able to design a system for zero steady-state error for astep input as well as design the desired transient response. An additional state variable, x N, has been added at the output of the leftmost integrator. The error is the derivative of this variable. Now, from Figure 12.21, _xN¬àr Cx 12.111 ¬Ü Writing the state equations from Figure 12.21, we have _x¬àAx¬áBu (12.112a) _xN¬à Cx¬ár (12.112b) y¬àCx (12.112c) Equations (12.112) can be written as augmented vectors and matrices. Hence, _x _xN"# ¬àA0  C0"# x xN"# ¬áB 0"# u¬á0 1"# r (12.113a) y¬àC0/C2/C3 x xN/C20/C21 (12.113b) But u¬à Kx¬áKexN¬à  K K e/C2/C3 x xN/C20/C21 12.114 ¬Ü reBC Ke A ‚ÄìKxN + ++ +u xx y + ‚Äì‚à´‚à´ FIGURE 12.21 Integral control for steady-state error design684 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:39 Substituting Eq. (12.114) into (12.113a) and simplifying, we obtain _x _xN"# ¬à A BK¬ÜBK e  C 0"#x xN"# ¬á0 1"# r (12.115a) y¬àC0/C2/C3 x xN"# (12.115b) Thus, the system type has been increased, and we can use the characteristic equation associated with Eq. (12.115a) to design KandKeto yield the desired transient response. Realize, we now have an additional pole to place. The effect on the transient response of anyclosed-loop zeros in the Ô¨Ånal design must also be taken into consideration. One possible assumption is that the closed-loop zeros will be the same as those of the open-loop plant.This assumption, which of course must be checked, suggests placing higher-order poles atthe closed-loop zero locations. Let us demonstrate with an example. Example 12.10 Design of Integral ControlDesign of Integral Control PROBLEM: Consider the plant of Eqs. (12.116): _x¬à01  3  5/C20/C21 x¬á0 1/C20/C21 u (12.116a) y¬à¬â10 ¬äx (12.116b) a.Design a controller without integral control to yield a 10% overshoot and a settling time of 0.5 second. Evaluate the steady-state error for a unit step input. b.Repeat the design of Part ausing integral control. Evaluate the steady-state error for a unit step input. SOLUTION: a.Using the requirements for settling time and percent overshoot, we Ô¨Ånd that the desired characteristic polynomial is s2¬á16s¬á183 :1 12.117 ¬Ü Since the plant is represented in phase-variable form, the characteristic polynomial for thecontrolled plant with state-variable feedback is s 2¬á 5¬ák2¬Üs¬á 3¬ák1¬Ü 12.118 ¬Ü Equating the coef Ô¨Åcients of Eqs. (12.117) and (12.118), we have K¬à¬âk1k2¬ä¬à¬â 180 :11 1 ¬ä 12.119 ¬Ü12.8 Steady-State Error Design via Integral Control 685WEBC12 10/29/2014 8:56:40 From Eqs. (12.3), the controlled plant with state-variable feedback represented in phase- variable form is _x¬à A BK¬Üx¬áBr¬à01  183 :1 16/C20/C21 x¬á0 1/C20/C21 r (12.120a) y¬àCx¬à¬â10 ¬äx (12.120b) Using Eq. (7.96), we Ô¨Ånd that the steady-state error for a step input is e ‚àû¬Ü¬à1¬áC A BK¬Ü 1B ¬à1¬á10/C2/C3 01  183 :1 16"# 10 1"# ¬à0:995 12.121 ¬Ü b.We now use Eqs. (12.115) to represent the integral-controlled plant as follows: _x1 _x2 _xN2 6643 775¬à01  3  5"#  0 1"# k1k2/C2/C3 !01"# K e  10/C2/C3 02 6643 775x1 x2 xN2 6643 775¬á0 012 6643 775r ¬à01 0   3¬ák 1¬Ü  5¬ák2¬ÜKe  10 02 6643 775x 1 x2 xN2 6643 775¬á0 012 6643 775r (12.122a) y¬à100/C2/C3x 1 x2 xN2 435 (12.122b) Using Eq. (3.73) and the plant of Eqs. (12.116), we Ô¨Ånd that the transfer function of the plant is G s¬Ü¬à1= s 2¬á5s¬á3¬Ü. The desired characteristic polynomial for the closed- loop integral-controlled system is shown in Eq. (12.117). Since the plant has no zeros, we assume no zeros for the closed-loop system and augment Eq. (12.117) with a third pole, s¬á100¬Ü, which has a real part greater than Ô¨Åve times that of the desired dominant second- order poles. The desired third-order closed-loop system characteristic polynomial is s¬á100¬Ü s 2¬á16s¬á183 :1¬Ü¬às3¬á116s2¬á1783 :1s¬á18;310 12.123 ¬Ü The characteristic polynomial for the system of Eqs. (12.112) is s3¬á 5¬ák2¬Üs2¬á 3¬ák1¬Üs¬áKe 12.124 ¬Ü Matching coef Ô¨Åcients from Eqs. (12.123) and (12.124), we obtain k1¬à1780 :1 (12.125a) k2¬à111 (12.125b) ke¬à18;310 (12.125c)686 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:41 Now that we have designed controllers and observers for transient response and steady-state error, we summarize the chapter with a case study demonstrating the design process.Substituting these values into Eqs. (12.122) yields this closed-loop integral-controlledsystem: _x 1 _x2 _xN2 643 75¬à01 0  1783 :1 116 18 ;310  1002 435x 1 x2 xN2435¬á0 012 435r (12.126a) y¬à100/C2/C3x 1 x2 xN2435 (12.126b) In order to check our assumption for the zero, we now apply Eq. (3.73) to Eqs. (12.126) and Ô¨Ånd the closed-loop transfer function to be T s¬Ü¬à 18;310 s3¬á116s2¬á1783 :1s¬á18;310 12.127 ¬Ü Since the transfer function matches our design, we have the desired transient response. Now let us Ô¨Ånd the steady-state error for a unit step input. Applying Eq. (7.96) to Eqs. (12.126), we obtain e ‚àû¬Ü¬à1¬á100/C2/C301 0  1783 :1 116 18 ;310  1002643 75 10 0 12 643 75¬à0 12.128 ¬Ü Thus, the system behaves like a Type 1 system. Skill-Assessment Exercise 12.7 PROBLEM: Design an integral controller for the plant _x¬à01  7  9"# x¬á0 1"# u y¬à41/C2/C3 x to yield a step response with 10% overshoot, a peak time of 2 seconds, and zero steady-state error. ANSWER: K¬à¬â2:21  2:7¬ä;Ke¬à3:79 The complete solution is located at www.wiley.com/college/nise .12.8 Steady-State Error Design via Integral Control 687WEBC12 10/29/2014 8:56:43 Case Study Antenna Control: Design of Controller and ObserverAntenna Control: Design of Controller and Observer In this case study, we use our ongoing antenna azimuth position control system to demonstrate the combined design of a controller and an observer. We will assume that the states are not available and must be estimated from the output. The block diagram ofthe original system is shown on the front endpapers, Con Ô¨Åguration 1. Arbitrarily setting the preampli Ô¨Åer gain to 200 and removing the existing feedback, the forward transfer function is simpli Ô¨Åed to that shown in Figure 12.22. The case study will specify a transient response for the system and a faster transient response for the observer. The Ô¨Ånal design con Ô¨Åguration will consist of the plant, the observer, and the controller, as shown conceptually in Figure 12.23. The design of theobserver and the controller will be separate. PROBLEM: Using the simpli Ô¨Åed block diagram of the plant for the antenna azimuth position control system shown in Figure 12.22 , design a controller to yield a 10% overshoot and a settling time of 1 second. Place the third pole 10 times as far from the imaginary axis as the second-order dominant pair. Assume that the state variables of the plant are not accessible and design an observer to estimate the states. The desired transient response for the observer is a 10% overshoot1325 s(s + 1.71)(s + 100)U(s) = E(s) Y(s) = o(s)Œ∏ FIGURE 12.22 Simpli Ô¨Åed block diagram of antenna control system shown on the front endpapers (Con Ô¨Åguration 1) with K¬à200 C Axx r = 0 + +B +u BPlant AxxObserver ++ ‚ÄìKCy + ye Controller++ ‚Äì ÀÜ u y ÀÜ LÀÜ‚à´ ‚à´ FIGURE 12.23 Conceptual state-space design con Ô¨Åguration, showing plant, observer, and controller688 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:44 and a natural frequency 10 times as great as the system response above. As in the case of the controller, place the third pole 10 times as far from the imaginary axis as the observer ‚Äôs dominant second-order pair. SOLUTION: Controller Design: WeÔ¨Årst design the controller by Ô¨Ånding the desired characteristic equation. A 10% overshoot and a settling time of 1 second yield Œ∂¬à0:591 and œân¬à6:77. Thus, the characteristic equation for the dominant poles is s2¬á8s¬á45:8¬à0, where the dominant poles are located at  4j5:46. The third pole will be 10 times as far from the imaginary axis, or at  40. Hence, the desired characteristic equation for the closed-loop system is s2¬á8s¬á45:8¬Ü s¬á40¬Ü¬às3¬á48s2¬á365 :8s¬á1832 ¬à0 12.129 ¬Ü Next we Ô¨Ånd the actual characteristic equation of the closed-loop system. The Ô¨Årst step is to model the closed-loop system in state space and then Ô¨Ånd its characteristic equation. From Figure 12.22, the transfer function of the plant is G s¬Ü¬à1325 s s¬á1:71¬Ü s¬á100¬Ü¬à1325 s s2¬á101 :71s¬á171¬Ü 12.130 ¬Ü Using phase variables, this transfer function is converted to the signal- Ô¨Çow graph shown in Figure 12.24, and the state equations are written as follows: _x¬à010 001 0 171  101 :712 643 75x¬á0 0 12 643 75u¬àAx¬áBu (12.131a) y¬à¬â1325 0 0 ¬äx¬àCx (12.131b) We now pause in our design to evaluate the controllability of the system. The controllability matrix, CM,i s CM¬àBA BA2B/C2/C300 1 01  101 :71 1 101 :71 10 ;173 :922 643 75 12.132 ¬Ü The determinant of CMis 1; thus, the system is controllable. Continuing with the design of the controller, we show the controller ‚Äôs conÔ¨Åguration with the feedback from all state variables in Figure 12.25. We now Ô¨Ånd the characteristicu1 x3 x2 x11325 y ‚Äì101.71 ‚Äì1711 s1 s1 s FIGURE 12.24 Signal- Ô¨Çow graph for G s¬Ü¬à1325 =¬âs s2¬á101 :71s¬á171¬Ü¬äCase Study 689WEBC12 10/29/2014 8:56:44 equation of the system of Figure 12.25. From Eq. (12.7) and Eq. (12.131a), the system matrix, A BK,i s A BK¬à01 0 00 1  k1  171¬ák2¬Ü  101 :71¬ák3¬Ü2 643 75 12.133 ¬Ü Thus, the closed-loop system ‚Äôs characteristic equation is det¬âsI  A BK¬Ü¬ä ¬à s3¬á 101 :71¬ák3¬Üs2¬á 171¬ák2¬Üs¬ák1¬à0 12.134 ¬Ü Matching the coef Ô¨Åcients of Eq. (12.129) with those of Eq. (12.134), we evaluate the ki‚Äôs as follows: k1¬à1832 (12.135a) k2¬à194 :8 (12.135b) k3¬à 53:71 (12.135c) Observer Design: Before designing the observer, we test the system for observability. Using the AandCmatrices from Eqs. (12.131), the observability matrix, OM,i s OM¬àC CA CA22 6643 775¬à1325 0 0 0 1325 0 0 0 13252 6643 775 12.136 ¬Ü The determinant of O Mis 13253. Thus, OMis of rank 3, and the system is observable. We now proceed to design the observer. Since the order of the system is not high, we will design the observer directly without Ô¨Årst converting to observer canonical form. From Eq. (12.64a) we need Ô¨Årst to Ô¨ÅndA LC.AandCfrom Eqs. (12.131) along with L¬àl1 l2 l32 643 75 12.137 ¬Üu1 x3 x2 x11325 y ‚Äì101.71 ‚Äì171 ‚Äìk1‚Äìk2‚Äìk31 s1 s1 s FIGURE 12.25 Plant with state-variable feedback for controller design690 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:45 are used to evaluate A LCas follows: A LC¬à 1325 l1 10  1325 l2 01  1325 l3 171  101 :712 643 75 12.138 ¬Ü The characteristic equation for the observer is now evaluated as det¬âŒªI  A LC¬Ü¬ä ¬àŒª3¬á 1325 l1¬á101 :71¬ÜŒª2 ¬á 134 ;800l1¬á1325 l2¬á171¬ÜŒª ¬á 226 ;600l1¬á134 ;800l2¬á1325 l3¬Ü ¬à0 12.139 ¬Ü From the problem statement, the poles of the observer are to be placed to yield a 10% overshoot and a natural frequency 10 times that of the system ‚Äôs dominant pair of poles. Thus, the observer ‚Äôs dominant poles yield ¬âs2¬á 20:59167:7¬Üs¬á67:72¬ä¬à s2¬á80s¬á4583 ¬Ü. The real part of the roots of this polynomial is  40. The third pole is then placed 10 times farther from the imaginary axis at  400. The composite characteristic equation for the observer is s2¬á80s¬á4583 ¬Ü s¬á400¬Ü¬às3¬á480s2¬á36;580s¬á1;833 ;000¬à0 12.140 ¬Ü Matching coef Ô¨Åcients from Eqs. (12.139) and (12.140), we solve for the observer gains: l1¬à0:286 (12.141a) l2¬à 1:57 (12.141b) l3¬à1494 (12.141c) Figure 12.26, which follows the general con Ô¨Åguration of Figure 12.23, shows the completed design, including the controller and the observer. The results of the design are shown in Figure 12.27. Figure 12.27( a) shows the impulse response of the closed-loop system without any difference between the plant and its modeling as an observer. The undershoot and settling time approximately meet therequirements set forth in the problem statement of 10% and 1 second, respectively. InFigure 12.27( b), we see the response designed into the observer. An initial condition of 0.006 was given to x 1in the plant to make the modeling of the plant and observer different. Notice that the observer ‚Äôs response follows the plant ‚Äôs response by the time 0.06 second is reached. CHALLENGE: You are now given a case study to test your knowledge of this chapter ‚Äôs objectives: You are given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 3. If the preampli Ô¨Åer gain K¬à20, do the following: a.Design a controller to yield 15% overshoot and a settling time of 2 seconds. Place the third pole 10 times as far from the imaginary axis as the second-order dominant pole pair. Use physical variables as follows: power ampli Ô¨Åer output, motor angular velocity, and motor displacement. b.Redraw the schematic shown on the front endpapers, showing a tachometer that yields rate feedback along with any added gains or attenuators required to implement thestate-variable feedback gains.Case Study 691WEBC12 10/29/2014 8:56:45 1.0 ‚Äì1.0 0 1.0 1.6 2.00.5‚Äì00.51.52.02.5 0.4 0.6 0.8 1.2 1.4 1.8 0.2 Time (seconds) (a)y,yÀÜ Time (seconds) (b)y,yÀÜ 0.05 0.06 0.07 0.08 0.09 0.1 0y yÀÜ 0.04 0.03 0.02 0.01024681012141618FIGURE 12.27 Designed response of antenna azimuth position control system: a.impulse response ‚Äîplant and observer with the same initialconditions, x 1 0¬Ü¬à ^x1 0¬Ü¬à 0; b.portion of impulse response ‚Äîplant and observer with different initial conditions, ^x1 0¬Ü¬à 0:006 for the plant, ^x1 0¬Ü¬à 0 for the observer1 u11 yÀÜ1325 ‚Äì1 x3ÀÜ x2ÀÜ x1ÀÜ ‚Äì101.71 ‚Äì171 l2= ‚Äì1.57l1= 0.286 3l= 1494Observer‚Äìk1 = ‚Äì1832 ControllerPlanty 1 1 ‚Äìk2 = ‚Äì194.8 ‚Äìk3 = 53.71 1 s1 s1 s FIGURE 12.26 Completed state-space design for the antenna azimuth position control system, showingcontroller and observer692 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:45 Summary This chapter has followed the path established by Chapters 9 and 11 ‚Äîcontrol system design. Chapter 9 used root locus techniques to design a control system with a desired transient response. Sinusoidal frequency response techniques for design were covered inChapter 11, and in this chapter we used state-space design techniques. State-space design consists of specifying the system ‚Äôs desired pole locations and then designing a controller consisting of state-variable feedback gains to meet these requirements.If the state variables are not available, an observer is designed to emulate the plant and provideestimated state variables. Controller design consists of feeding back the state variables to the input, u, of the system through speci Ô¨Åed gains. The values of these gains are found by matching the coefÔ¨Åcients of the system ‚Äôs characteristic equation with the coef Ô¨Åcients of the desired characteristic equation. In some cases, the control signal, u, cannot affect one or more state variables. We call such a system uncontrollable. For this system, a total design is not possible. Using the controllability matrix, a designer can tell whether or not a system iscontrollable prior to the design. Observer design consists of feeding back the error between the actual output and the estimated output. This error is fed back through speci Ô¨Åed gains to the derivatives of the estimated state variables. The values of these gains are also found by matching thecoefÔ¨Åcients of the observer ‚Äôs characteristic equation with the coef Ô¨Åcients of the desired characteristic equation. The response of the observer is designed to be faster than that ofthe controller, so the estimated state variables effectively appear instantaneously at thecontroller. For some systems, the state variables cannot be deduced from the output ofthe system, as is required by the observer. We call such systems unobservable . Using the observability matrix, the designer can tell whether or not a system is observable. Observerscan be designed only for observable systems. Finally, we discussed ways of improving the steady-state error performance of systems represented in state space. The addition of an integration before the controlledplant yields improvement in the steady-state error. In this chapter, this additional integrationwas incorporated into the controller design. Three advantages of state-space design are apparent. First, in contrast to the root locus method, all pole locations can be speci Ô¨Åed to ensure a negligible effect of the nondominant poles upon the transient response. With the root locus, we were forced to justify an assumptionthat the nondominant poles did not appreciably affect the transient response. We were not always able to do so. Second, with the use of an observer, we are no longer forced to acquire the actual system variables for feedback. The advantage here is that sometimes the variablescannot be physically accessed, or it may be too expensive to provide that access. Finally, themethods shown lend themselves to design automation using the digital computer.c.Assume that the tachometer is not available to provide rate feedback. Design anobserver to estimate the physical variables' states. The observer will respond with 10% overshoot and a natural frequency 10 times as great as the system response. Place the observer ‚Äôs third pole 10 times as far from the imaginary axis as the observer ‚Äôs dominant second-order pole pair. d.Redraw the schematic on the front endpapers, showing the implementation of thecontroller and the observer. e. Repeat Parts aandcusing MATLAB.Summary 693WEBC12 10/29/2014 8:56:45 A disadvantage of the design methods covered in this chapter is the designer ‚Äôs inability to design the location of open- or closed-loop zeros that may affect the transient response. In root locus or frequency response design, the zeros of the lag or leadcompensator can be speci Ô¨Åed. Another disadvantage of state-space methods concerns the designer ‚Äôs ability to relate all pole locations to the desired response; this relationship is not always apparent. Also, once the de sign is completed, we may not be satisÔ¨Å ed with the sensitivity to parameter changes. Finally, as previously discussed, state-space techniques do not satisfy our intuition as much as root locus techniques, where the effect of parameter changes can be immediately seen as changes in closed-loop pole locations. In the next chapter we return to the frequency domain and design digital systems using gain adjustment and cascade compensation. Review Questions 1.BrieÔ¨Çy describe an advantage that state-space techniques have over root locus techniques in the placement of closed-loop poles for transient response design. 2.BrieÔ¨Çy describe the design procedure for a controller. 3.Different signal- Ô¨Çow graphs can represent the same system. Which form facilitates the calculation of the variable gains during controller design? 4.In order to effect a complete controller design, a system must be controllable. Describe the physical meaning of controllability. 5.Under what conditions can inspection of the signal-Ô¨Ç ow graph of a system yield immediate determination of controllability? 6.In order to determine controllability mathem atically, the controllability matrix is formed, and its rank evaluated. What is the Ô¨Ånal step in determining controllability if the controllability ma trix is a square matrix? 7.What is an observer? 8.Under what conditions would you use an observer in your state-space design of acontrol system? 9.BrieÔ¨Çy describe the con Ô¨Åguration of an observer. 10.What plant representation lends itself to easier design of an observer? 11.BrieÔ¨Çy describe the design technique for an observer, given the con Ô¨Åguration you described in Question 9. 12.Compare the major difference in the tran sient response of an observer to that of a controller. Why does this difference exist? 13.From what equation do we Ô¨Ånd the characteristic equation of the controller- compensated system? 14.From what equation do we Ô¨Ånd the characteristic equation of the observer? 15.In order to effect a complete observer desig n, a system must be observable. Describe the physical meaning of observability. 16.Under what conditions can inspection of the signal-Ô¨Ç ow graph of a system yield immediate determination of observability? 17.In order to determine observability mathematically, the observability matrix isformed and its rank evaluated. What is the Ô¨Ånal step in determining observability if the observability matrix is a square matrix?694 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:46 Problems 1.Consider the following open-loop transfer functions, where G s¬Ü¬àY s¬Ü=U s¬Ü.Y(s) is the Laplace transform of the output, and U(s) is the Laplace transform of the input control signal: i.G s¬Ü¬à s¬á3¬Ü s¬á4¬Ü2 ii.G s¬Ü¬às s¬á5¬Ü s¬á7¬Ü iii.G s¬Ü¬à20s s¬á7¬Ü s¬á3¬Ü s¬á7¬Ü s¬á9¬Ü iv.G s¬Ü¬à30 s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü s¬á5¬Ü s¬á6¬Ü v.G s¬Ü¬às2¬á8s¬á15 s2¬á4s¬á10¬Ü s2¬á3s¬á12¬Ü For each of these transfer functions, do the following: [Section: 12.2] a.Draw the signal- Ô¨Çow graph in phase-variable form. b.Add state-variable feedback to the signal- Ô¨Çow graph. c.For each closed-loop signal- Ô¨Çow graph, write the state equations. d.Write, by inspection , the closed-loop transfer function, T(s), for your closed-loop signal-Ô¨Ç ow graphs. e.Verify your answers for T(s)b yÔ¨Ånding the closed- loop transfer functions from the state equations and Eq. (3.73). 2.The following open-loop transfer functions can be represented by signal- Ô¨Çow graphs in cascade form. i.G s¬Ü¬à30 s¬á2¬Ü s¬á7¬Ü s s¬á3¬Ü s¬á5¬Ü ii.G s¬Ü¬à5 s2¬á3s¬á7¬Ü s¬á2¬Ü s2¬á2s¬á10¬Ü For each, do the following: [Section: 12.4] a.Draw the signal- Ô¨Çow graph and show the state-variable feedback. b.Find the closed-loop transfer function with state-variable feedback. 3.The following open-loop transfer functions can berepresented by signal- Ô¨Çow graphs in parallel form. i.G s¬Ü¬à 50 s2¬á7s¬á25¬Ü s s¬á10¬Ü s¬á20¬Ü ii.G s¬Ü¬à50 s¬á3¬Ü s¬á4¬Ü s¬á5¬Ü s¬á6¬Ü s¬á7¬ÜFor each, do the following: [Section: 12.4] a.Draw the signal- Ô¨Çow graph and show the state-variable feedback. b.Find the closed-loop transfer function with state-variable feedback. 4.Given the following open-loop plant, [Section: 12.2] G s¬Ü¬à50 s¬á1¬Ü s¬á3¬Ü s¬á10¬Ü design a controller to yield a 10% overshoot anda settling time of 0.5 second. Place the third pole10 times as far from the imaginary axis as the dominantpole pair. Use the phase variables for state-variablefeedback. 5.Section 12.2 showed that controller design is easier toimplement if the uncompensated system is represented inphase-variable form with its typical lower companionmatrix. We alluded to the fact that the design can just aseasily progress using the controller canonical form withits upper companion matrix. [Section: 12.2] a.Redo the general controller design covered inSection 12.2, assuming that the plant is represented in controller canonical form rather than phase- variable form. b.Apply your derivation to Example 12.1 if theuncompensated plant is represented in controllercanonical form. 6.Given the following open-loop plant: [Section: 12.2] G s¬Ü¬à 100 s¬á2¬Ü s¬á25¬Ü s¬á1¬Ü s¬á3¬Ü s¬á5¬Ü design a controller to yield 10% overshoot with a peaktime of 0.5 second. Use the controller canonical form forstate-variable feedback. 7.Given the following open-loop plant: [Section: 12.2] G s¬Ü¬à 20 s¬á2¬Ü s s¬á5¬Ü s¬á7¬Ü design a controller to yield a 10% overshoot and a settlingtime of 2 seconds. Place the third pole 10 times as farfrom the imaginary axis as the dominant pole pair. Usethe phase variables for state-variable feedback. 8.Repeat Problem 4 assuming that the plant is representedin the cascade form. Do not convert to phase-variableform. [Section: 12.4] 9.Repeat Problem 7 assuming that the plant is repre- sented in the parallel form. Do not convert tophase-variable form. [Section: 12.4]Problems 695WEBC12 10/29/2014 8:56:46 a. Given the plant shown in Figure P12.1, what relationship exists between b1andb2to make the system uncontrollable? b.What values of b2will make the system un- controllable if b1=1? [Section: 12.3] y u ‚Äì1x11 x2b2 1 ‚Äì5b1 ‚Äì31 s1 s FIGURE P12.111.For each of the plants represented by signal-Ô¨Çow graphsin Figure P12.2, determine the controllability. If the controllability can be determined by inspection, statethat it can and then verify your conclusions usingthe controllability matrix. [Section: 12.3] Use MATLAB to determine the controllability of the systems of Figure P12.2( d) and ( f). 13.In Section 12.4, we discussed how to design a con-troller for systems not represented in phase-variableform with its typical lower companion matrix. Wedescribed how to convert the system to phase-variable form, design the controller, and convert back to the original representation. This technique can be appliedjust as easily if the original representation is convertedto controller canonical form with its typical uppercompanion matrix. Redo Example 12.4 in the textby designing the controller after converting theuncompensated plant to controller canonicalform. [Section: 12.4] 5 5x1 x2y ‚Äì25 x31 ‚Äì2 ‚Äì31 u 1x21 x15y 5 x3 ‚Äì31‚Äì2 ‚Äì2u1 (a) (b) x3 ‚Äì61 111 1 y u x2x1 ‚Äì5‚Äì4 y u ‚Äì6‚Äì5x11 1 x2‚Äì211 x1y1 x21 x312 ‚Äì3u ‚Äì4 (c)1 ‚Äì5‚Äì3x3 x21 1 1 y u ‚Äì4x11 (d) (e) (f)1 s1 s 1 s1 s 1 s1 s 1 s1 s1 s1 s1 s1 s 1 s 1 s 1 s1 s1 s FIGURE P12.2696 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:46 14.Consider the following transfer function: G s¬Ü¬à s¬á6¬Ü s¬á3¬Ü s¬á8¬Ü s¬á10¬Ü If the system is represented in cascade form, as shown in Figure P12.3, design a controller to yield a closed- loop response of 10% overs hoot with a settling time of 1 second. Design the controller by Ô¨Årst transforming the plant to phase variables. [Section: 12.4] 15.Use MATLAB to design the controller gains for the system given in Problem 14. 16.Repeat Problem 14 assuming that the plant is represented in parallel form. [Section: 12.4] 17.The open-loop system of Problem 14 is represented as shown in Figure P12.4. If the output of each block is assigned to be a state variable, design the controllergains for feedback from these state variables.[Section: 12.4] 18.If an open-loop plant G s¬Ü¬à 100 s s¬á4¬Ü s¬á10¬Ü is represented in parallel form, design a controller toyield a closed-loop response of 20% overshoot and apeak time of 0.2 second. Design the controller by Ô¨Årst transforming the plant to controller canonical form.[Section: 12.4] For a speci Ô¨Åc individual, the linear time-invariant model ofthe hypothalamic-pituitary-adrenal axis of the endocrine system withÔ¨Åve state variables has been found to be (Kyrylov ,2005 )_x 1 _x2 _x3 _x4 _x52 66666666643 7777777775¬à 0:014 0  1:40 0 0:023  0:023  0:023 0 0 0:134 0 :67  0:67 0 :38 0 :003264 00 0 :06  0:06 0 00 0 :0017 0  0:0012 66666666643 7777777775 x 1 x2 x3 x4 x52 66666666643 7777777775¬á1 0 0 0 02 66666666643 7777777775d 0 Thestate-variablede Ô¨Ånitionsweregiven in Problem 23, Chapter 3. a.Use MATLAB to determine if the system is controllable. b.Use MATLAB to express the matrices A and B in phase-variable form. 20.Consider the plant G s¬Ü¬à1 s s¬á2¬Ü s¬á5¬Ü whose state variables are not available. Design an observer for the observer canonical variables to yield a transient response described by Œ∂¬à0:6 and œân¬à50. Place the third pole 10 times farther from the imaginary axis than the dominant poles. [Section: 12.5] 21.Design an observer for the plant G s¬Ü¬à10 s¬á3¬Ü s¬á7¬Ü s¬á15¬Ü 1 s+1 01 s+8 s+3s+6U(s) Y(s) Z3(s) Z2(s) FIGURE P12.3 1 s+31 s+8 s+1 0s+6U(s) Y(s)=Z 1(s) Z3(s) Z2(s) FIGURE P12.4Problems 697WEBC12 10/29/2014 8:56:47 operating with 10% overshoot and 2 seconds peak time. Design the observer to respond 10 times as fast as the plant. Place the observer third pole 20 times as far fromthe imaginary axis as the observer dominant poles.Assume the plant is represented in observer canonicalform. [Section: 12.5] 22.Repeat Problem 20 assuming that the plant is representedin phase-variable form. Do not convert to observercanonical form. [Section: 12.7] 23.Consider the plant G s¬Ü¬à s¬á2¬Ü s¬á5¬Ü s¬á9¬Ü whose phase variables are not available. Design anobserver for the phase variables with a transient responsedescribed by Œ∂¬à0:6 and œâ n¬à120. Do not convert to observer canonical form. [Section: 12.7] 24.Determine whether or not each of the systems shown inFigure P12.2 is observable. [Section: 12.6] Use MATLAB to determine theobservability of the systemsof Figure P12.2( a) and ( f). a. Given the plant of Figure P12.5, what relationshipmust exist between c 1andc2in order for the system to be unobservable? b.What values of c1will make the system uncontrollable if c2=1? [Section: 12.6] y u ‚Äì1‚Äì21 x2c1c2 x11 s1 s FIGURE P12.5 27.Design an observer for the plant G s¬Ü¬à1 s¬á5¬Ü s¬á13¬Ü s¬á20¬Ü represented in cascade form. Transform the plantto observer canonical form for the design. Thentransform the design back to cascade form. Thecharacteristic po lynomial for the observer is to be s 3¬á600s2¬á40;000s¬á1;500 ;000.28.Use MATLAB to design the observer gains for the system given in Problem 27. 29.Repeat Problem 27 assuming that the plant is representedin parallel form. [Section: 12.7] 30.Design an observer for G s¬Ü¬à45 s¬á3¬Ü s¬á5¬Ü s¬á10¬Ü represented in phase-variable form with a desiredperformance of 10% overshoot and a settling time of0.5 second. The observer will be 10 times as fast as theplant, and the observer ‚Äôs nondominant pole will be 10 times as far from the imaginary axis as the observer ‚Äôs dominant poles. Design the observer by Ô¨Årst converting to observer canonical form. [Section: 12.7] 31.Observability and controllability properties depend onthe state-space representation chosen for a givensystem. In general, observa bility and controllability are affected when pole-zero cancellations are presentin the transfer function. Consider the following twosystems with representations: _x i¬àAixi¬àBir y¬àCixi; A1¬à01  2 3"# ;B1¬à0 1"# ;C1¬à20/C2/C3 A2¬à01 000 1  6  11  62 6643 775;B 2¬à0 012 6643 775;C 2¬à620/C2/C3 a.Show that both systems have the same transfer function Gi s¬Ü¬àY s¬Ü R s¬Üafter pole-zero cancellations. b.Evaluate the observability of both systems. 32.Given the plant _x¬à 11 02"# x¬á0 1"# u;y¬à11/C2/C3 x design an integral controller to yield a 15% overshoot, 0.6-second settling time, and zero steady-state error for a step input. [Section: 12.8] 33.Repeat Problem 32 for the following plant: [Section: 12.8] _x¬à 21 0 5"# x¬á0 1"# u;y¬à11/C2/C3 x698 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:48 DESIGN PROBLEMSDESIGN PROBLEMS 34.Problem 22 in Chapter 3 introduced the model for patients treated under a regimen of a single day ofGlargine insulin ( Tar√≠n ,2005 ). The model to Ô¨Ånd the response for a speci Ô¨Åc patient to medication can be expressed in phase-variable form with A¬à01 0 00 1  501 :610  6 128 :810 3 854 10 32 643 75; B¬à1 002 643 75;C¬à0:7810  441:410 40:01/C2/C3 ; D¬à0 The state variables will take on a different signi Ô¨Åcance in this expression, but the input and the output remain the same. Recall that u=external insulin Ô¨Çow, and y=plasma insulin concentration. a.Obtain a state-feedback gain matrix so that theclosed-loop system will have two of its poles placedat 1=15 and the third pole at  1=2. b. Use MATLAB to verify that thepoles appear at the positionsspeci Ô¨Åed in Part a. 35.Figure P12.6 shows a continuous stirred tank reactorin which an aqueous solution of sodium acetate(CH 3COONa) is neutralized in the mixing tank with hydrochloric acid (HCl) to maintain a particular pH inthe mixing tank. The amount of acid in the mix is controlled by varying the rotational speed of a feeding peristalticpump. A nominal linearized transfer function fromHClÔ¨Çowrate to pH has been shown to be ( Tadeo ,2000 ) G s¬Ü¬à  0:9580 10 4s 0:01197 10 4 s3¬á0:5250 s2¬á0:01265 s¬á0:000078 a.Write the system in state-space phase-variable form. b.Use state-feedback methods to design a matrix K that will yield an overdamped output pH responsewith a settling time of T s‚âà5 min for a step input change in pH. c.Simulate the step response ofthe resulting closed-loop system using MATLAB. 36.In the dc-dc converter of Problem 67, Chapter 4 ( Van Dijk , 1995), with L¬à6m H , C¬à1m F , R¬à100Œ©, a 50% PWM duty cycle, and assuming the system ‚Äôs output is the voltage across the capacitor, the model can be expressed as _i L _uC"# ¬à0  83 :33 500  10"# iL uC"# ¬á166 :67 0"# Es y¬à01/C2/C3 iL uC"# Inlet streampH measurementControlsignal Control acid stream Peristaltic pump Acid tank Mixin g tank Liquid pumpLiquid tank FIGURE P12.69 9Tadeo F., Perez, Loepez O., and Alvarez T. Control of Neutralization Processes by Robust Loopsharing. IEEE Trans. on Cont. Syst. Tech. , vol. 8, no. 2, Fig. 2, p. 239. IEEE Transactions on Control Systems Technology by Institute of Electrical and Electronics Engineers; IEEE Control Systems Society. Reproduced with permission of Institute of Electrical and Electronics Engineers, in the format Republish in a book via Copyright Clearance Center.Problems 699WEBC12 10/29/2014 8:56:48 a.Find the system ‚Äôs transfer function. b.Express the system‚Äô s state equations in phase- variable form. c.Find a set of state-feedback gains to obtain 20% overshoot and a settling time of 0.5 second in thephase-variable system. d.Obtain the corresponding set of state-feedbackgains in the original system. e.Verify that the set of gains in Part dplaces the closed-loop poles at the desired positions. f. Simulate the unit stepresponse of the system usingMATLAB. a. Design an observer for the dc-dc converter ofProblem 36. The observer should have time con-stants 10 times smaller than those of the originalsystem. b. Simulate your system andobserver for a unit step inputusing Simulink. Assume that theinitial conditions for the original system are x 0¬Ü¬à2 1/C20/C21 .The observer should have initial conditions ^x 0¬Ü¬à0 0/C20/C21 . a. Design an observer for the neutralization system using the continuous stirred tank reactor of Prob- lem 35. The observer should have time constants 10 times smaller than those of the original system.Assume that the original state variables are thoseobtained in the phase-variable representation. b. Simulate your system andobserver for a unit step inputusing Simulink. Assume that theinitial conditions for the original system are x 0¬Ü¬à 1  10 32 The observer should have initial conditions ^x 0¬Ü¬à0 002 39. a. Redesign the dc-dc converter system of Problem 36 to include integral control. b. Simulate your system for a stepinput using Simulink and verifythat the speci Ô¨Åcations are met. In particular, verify that the system has zero steady-state error.40.The use of feedback control to vary the pitch angle inthe blades of a variable speed wind turbine allows power generation optimization under variable windconditions (Liu ,2008). At a speci Ô¨Åc operating point, it is possible to linearize tur bine models. For example, the model of a three-blade turbine with a 15 m radiusworking in 12 m/s wind-speed and generating 220 Vcan be expressed as _x¬à 5 000 0 0 010 0  10 :5229  1066 :67 3:38028 23 :5107 0 09 9 3 :804 3 :125  23 :5107 0 00 0 1 0  102 66666666643 7777777775x ¬á5 0 0 0 02 66666666643 7777777775u y¬à0001 :223x10 50/C2/C3 x where the state variable vector is given by x¬àŒ≤Œæ _Œæœâ gœâgm/C2/C3 Here, Œ≤=pitch angle of the wind turbine blades, Œæ= relative angle of the secondary shaft, œâg=generator speed, and œâgm=generator measurement speed. The system input is u, the pitch angle reference, and the output is y, the active power generated. a.Find a state feedback vector gain such that the system responds with a 10% overshoot and a settling time of 2 seconds for a step input. b.Use MATLAB to verify the operation of the system understate feedback. 41.The study of the Ô¨Çexible links, such as the one shown in Figure P12.7, is important because of their appli-cation to the control of Ô¨Çexible lightweight robots (Saini ,2012 ). The Ô¨Çexible link angle is de Ô¨Çected by a servomotor. It is assumed that the base angle,Œ∏ t¬Ü, and the tip angular de Ô¨Çection relative to the undeformed link, Œ± t¬Ü, can be measured. For a speci Ô¨Åc setup, a state-space model of the system was700 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:49 developed. The state vector is x¬àŒ∏Œ±œâ _Œ±/C2/C3T, where œâ t¬Ü¬à _Œ∏ t¬Üand input u t¬Üis the voltage applied to the servomotor. Thus the system is represented as _x¬àAx¬áBu,y¬àCxwhere A¬à00 10 00 0106 7 3 :07  35 :1667 0 0 1023 :07 35 :1667 02 666643 77775 B¬à0 0 61:7325  61 :73252 666643 77775 C¬à1100/C2/C3 It is desired to build state-feedback compensation around this system so that the system ‚Äôs characteristic equation becomes D s¬Ü¬à s¬á10¬Ü In order to do this: a.Find the system ‚Äôs controllability matrix CMOand show that the system is controllable. b.Find the original system ‚Äôs characteristic equation and use it to Ô¨Ånd a phase-variable representation of the system. c.Find the phase-variable system ‚Äôs controllability matrix CMPand then Ô¨Ånd the transformation matrix P¬àCMOC 1 MP. d.Use the phase-variable representation to Ô¨Ånd a feedback gain matrix KP¬àk1pk2pk3pk4p/C2/C3 that will place the closed-loop poles in the desired positions. e.Find the corresponding feedback gain matrix KO¬àKPP 1. L TtŒ∏, œâ Œ∏Œ∏ + Œ±Œ± FIGURE P12.710 42.We want to use an observer in a textile machine to estimate the state variables. The 2-input, 1-output system‚Äô s model is _x¬àAx¬áBu;y¬àCx,w h e r e( Cardona ,2010)A¬à01 0  52 :6532  4:9353  2768 :1557  0:001213 0  0:061062 643 75 B¬à00 00 0:001613  0:0018122 643 75 C¬à100/C2/C3 a.Find the system ‚Äôs observability matrix OMzand show that the system is observable. b.Find the original system ‚Äôs characteristic equation and use it to Ô¨Ånd an observable canonical represen- tation of the system. c.Find the observable canonical system ‚Äôs observabil- ity matrix OMxand then Ô¨Ånd the transformation matrix P¬àO 1 MzOMx. d.Use the observable canonical representation to Ô¨Ånd an observer gain matrix Lx¬àl1xl2xl3xl4x/C2/C3Tso that the observer characteristic polynomial is D s¬Ü¬às3¬á30s2¬á316s¬á1160. e.Find the corresponding observer gain matrix Lz¬àPLx. 43.An inverted pendulum mounted on a motor-driven cartwas presented in Problem 30, Chapter 3. Its state-space model was linearized (Prasad ,2012) around a stationary point, x 0¬à0¬Ü, corresponding to the pendulum point-mass, m, being in the upright position att=0 .I t sm o d e lw a st h e nm o d i Ô¨Åed in Problem 55, Chapter 6, to have two output variables: the pendulum angle relative to the y-axis, Œ∏ t¬Ü, and the horizontal position of the cart, x(t). Noting that the unit requires stabilization, you were asked in Problem 33, Chapter 9, to develop Simulink models for two feed-back systems: one to control the cart position, x(t),a n d the second to control the pendulum angle, Œ∏ t¬Ü. Modify the second model, using state-feedback ampli Ô¨Åers with appropriate gains (in addition to the rate feedback ampli Ô¨Åer and the PD controller), to improve the unit-impulse response of the angle control loop.Compare the response you get here with that obtainedfor Problem 33, Chapter 9. 44.Let the plant in the drive system with an elasticallycoupled load ( Thomsen ,2011 ) shown in Figure P8.15 be G p s¬Ü¬àY s¬Ü M s¬Ü¬à250 s2¬á1:2s¬á12500 ¬Ü s3¬á8:1s2¬á62003 s¬á31250 where Y s¬Ü¬àŒ©L s¬Ü, the load speed. Represent Gp s¬Üin observer canonical form. Then design an observer for it,such that it responds 10 times faster than the output, y(t), ifG C s¬Ü¬àKP. [Section: 12.5]10Saini, S. C., Sharma , Y., Bhandari, M ., and Satija, U. Comparison of Pole Placement and LQR Applied to Single Link Flexible Manipulator, International Conference on Communication Systems and Network Technologies ,I E E E Computer Society, 2012, pp. 843 ‚Äì847, Figure 3, p. 844.Problems 701WEBC12 10/29/2014 8:56:50 PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS Control of HIV/AIDS. The linearized model of HIV infection when RTIs are used for treatment was intro- duced in Chapter 4 and repeated here for convenience(Craig ,2004 ): _T _T * _v2 643 75¬à 0:04167 0  0:0058 0:0217  0:24 0 :0058 0 100  2:42 643 75T T* v2 643 75 ¬á5:2  5:2 02 643 75u1 y¬à001/C2/C3T T* v2 643 75 Trepresents the number of healthy T-cells, T*the number of infected cells, and vthe number of free viruses. a.Design a state-feedback scheme to obtain (1)zero steady-state error for step inputs (2)10% overshoot (3)a settling time of approximately 100 days (Hint: the system ‚Äôs transfer function has an open-loop zero at approximately  0.02. Use one of the poles in the desired closed-loop-pole polynomial to eliminate this zero. Place the higher-order pole 6.25 times fartherthan the dominant pair.) b. Simulate the unit step responseof your design using Simulink. Hybrid vehicle . In Problem 32, Chapter 3, we introduced the idea that when an electric motor is the sole motive forceprovider for a hybrid electric vehicle (HEV), the forward paths of all HEV topologies are similar. It was noted that, in general, the forward path of an HEV cruise control system can be represented by a block diagram similarto that of Figure P3.18 ( Preitl, 2007 ). The diagram is shown in Figure P12.8, with t he parameters substitutedby their numerical values from Problem 69, Chapter 6; the motor armature represented as a Ô¨Årst-order system with a unity steady-state gain and a time constant of 50 ms; and the power ampliÔ¨Å er gain set to 50. Whereas the state variables remain as the motor angular speed, œât ¬Ü,a n d armature current, I at ¬Ü, we assume now that we have only one input variable, uct ¬Ü, the command voltage from the electronic control unit, and one output variable, car speed,v¬àrœâ=i tot¬à0:06154 œâ. The change in the load torque, Tct ¬Ü, is represented as an internal feedback proportional toœât ¬Ü. Looking at the diagram, the state equations may be written as _Ia _œâ"# ¬à 20  40 0:2491  0:0191"# Ia œâ"# ¬á0 1000"# uc t¬Ü y t¬Ü¬àv t¬Ü¬à¬â00 :05154 ¬äIa œâ"# a.Design an integral controller for % OS4.32%, a settling time, Ts4.4 sec, and a zero steady-state error for a step input (Hint: To account for the effectof the integral controller on the transient response, useT s=4 seconds in your calculation of the value of the naturalfrequency, œân,oftherequireddominantpoles). b.Use MATLAB to verify that the design requirements are met. Parabolic trough collector. A parabolic trough collector can be designed using state-space tech- niques. For simplicity, pure time delay will be ignoredhere, although it could be handled in several differentways. Consider the open-loop transfer function (Camacho, 2012): G s¬Ü¬à 137 :210 6K s2¬á0:0224 s¬á19610 6 Design a state feedback controller with integral control to yield zero steady-state error, such that the system transient response results in a damping factor ofŒ∂¬à0:5 with a settling time T s¬à200 sec. Simulate the step response of your designed system using a com-puter program. 2 0.03787 2050 1.8++‚Äì‚Äì ‚Äì 0.10.06154s + 20 ua(t)Ia(t) Ia(t)Tf (t)Tc (t) œâ (t)T(t) uc(t)eb(t) 1 7.226 sœâ (t)ŒΩ (t) FIGURE P12.8702 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:50 Cyber Exploration Laboratory Experiment 12.1 Objective To simulate a system that has been designed for transient response via a state-space controller and observer. Minimum Required Software Packages MATLAB, Simulink, and the Control System Toolbox Prelab 1.This experiment is based upon your design of a controller and observer as speci Ô¨Åed in the Case Study Challenge problem in Chapter 12. Once you have completed the controller and observer design in that problem, go on to Prelab 2. 2.What is the controller gain vector for your design of the system speci Ô¨Åed in the Case Study Challenge problem in Chapter 12? 3.What is the observer gain vector for your design of the system speci Ô¨Åed in the Case Study Challenge problem in Chapter 12? 4.Draw a Simulink diagram to simulate the system. Show the system, the controller, andthe observer using the physical variables speci Ô¨Åed in the Case Study Challenge problem in Chapter 12. Lab 1.Using Simulink and your diagram from Prelab 4, produce the Simulink diagram fromwhich you can simulate the response. 2.Produce response plots of the system and the observer for a step input. 3.Measure the percent overshoot and the settling time for both plots. Postlab 1.Make a table showing the design speci Ô¨Åcations and the simulation results for percent overshoot and settling time. 2.Compare the design speci Ô¨Åcations with the simulation results for both the system response and the observer response. Explain any discrepancies. 3.Describe any problems you had implementing your design. Experiment 12.2 Objective To use LabVIEW to design a controller and observer Minimum Required Software Packages LabVIEW, the Control Design and Simulation Module, and the MathScript RT Module. Prelab Create a LabVIEW VI that will design the controller and observer for the Antenna Control Case Study in this chapter. Your VI will have the following inputs: phase- variable form of the plant, the controller poles, and the observer poles to meet therequirements. Your indicators will display the following: the phase-variable equation ofthe plant, whether or not the system is controllable, the observer canonical equation of the observer, whether or not the system is observable, the gains for the controller, and the gains for the observer. Also provide the impulse response and initial response curves shown inFigure 12.27. In addition, provide similar response curves for the state variables. Lab Run your VI and collect the data from which to compare the results of the case study with those found from your VI.Cyber Exploration Laboratory 703WEBC12 10/29/2014 8:56:50 Bibliography Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Cardona, J. E., and C√°rdenas, M. O. Design and implementation of a state observer for a textile machine, IEEE ANDESCON , 2010, pp. 1 ‚Äì6. Craig, I. K, Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. D‚ÄôAzzo, J. J., and Houpis, C. H. Linear Control System Analysis and Design: Conventional and Modern , 3d ed. McGraw-Hill, New York, 1988. Franklin, G. F, Powell, J. D, and Emami-Naeini, A. Feedback Control of Dynamic Systems , 3d ed. Addison-Wesley, Reading, MA, 1994. Hostetter, G. H, Savant, C. J. Jr., and Stefani, R. T. Design of Feedback Control Systems , 2d ed. Saunders College Publishing, New York, 1989. Kailath, T. Linear Systems . Prentice Hall, Upper Saddle River, NJ, 1980. Kyrylov, V., Severyanova, L. A., and Vieira, A. Modeling Robust Oscillatory Behavior of the Hypothalamic-Pitui tary-Adrenal Axis. IEEE Transactions on Biomedical Engineering ,v o l . 52, no. 12, 2005, pp. 1977 ‚Äì1983. Liu, J.-H., Xu, D.-P., and Yang, X.-Y. Multi-Objective Power Control of a Variable Speed Wind Turbine Based on Theory. Proceedings of the Seventh International Conference on Machine Learning and Cybernetics , July 2008, pp. 2036 ‚Äì2041. Luenberger, D. G. Observing the State of a Linear System. IEEE Transactions on Military Electronics , vol. MIL-8, April 1964, pp. 74 ‚Äì80. Milhorn, H. T. Jr., The Application of Control Theory to Physiological Systems . W. B. Saunders, Philadelphia, 1966. Ogata, K. Modern Control Engineering , 2d ed. Prentice Hall, Upper Saddle River, NJ, 1990. Ogata, K. State Space Analysis of Control Systems . Prentice Hall, Upper Saddle River, NJ, 1967. Prasad, L., Tyagi, B., and Gupta, H. Modeling & Simulation for Optimal Control of Nonlinear Inverted Pendulum Dynamical System using PID Controller & LQR. IEEE Computer Society Sixth Asia Modeling Symposium , 2012, pp.138‚Äì143. Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. Fourth International Symposium on Applied Computational Intelligence and Informatics . IEEE, 2007, pp. 157 ‚Äì162. Rockwell International. Space Shuttle Transportation System . 1984 (press information). Saini, S. C., Sharma, Y., Bhandari, M., and Satija, U. Comparison of Pole Placement and LQR Applied to Single Link Flexible Manipulator. International Conference on Communication Systems and Network Technologies , IEEE Computer Society, 2012, pp. 843 ‚Äì847. Shinners, S. M. Modern Control System Theory and Design . Wiley, New York, 1992. Sinha, N. K. Control Systems . Holt, Rinehart & Winston, New York, 1986. Tadeo, F., P√©rez L√≥pez, O., and Alvarez, T. Control of Neutralization Processes by Robust Loop-shaping. IEEE Transactions on Control Systems Technology , vol. 8, no. 2, 2000, pp. 236 ‚Äì246. Tar√≠n, C., Teufel, E., Pic√≥, J., Bondia, J., and P Ô¨Çeiderer, H. J. Comprehensive Pharmacokinetic Model of Insulin Glargine and Other Insulin Formulations. IEEE Transactions on Biomedical Engineering , vol. 52, no. 12, 2005, pp. 1994 ‚Äì2005.Postlab Compare and summarize the results found from your VI with those of the Chapter 12 Antenna Control Case Study.704 Chapter 12 Design via State SpaceWEBC12 10/29/2014 8:56:50 Thomsen, S., Hoffmann, N., and Fuchs, F. W. PI Control, PI-Based State Space Control, and Model-Based Predictive Control for Drive Systems With Elastically Coupled Loads‚Äî A Comparative Study. IEEE Transactions on Industrial Electronics , vol. 58, no. 8, August 2011, pp. 3647 ‚Äì3657. Timothy, L. K, and Bona, B. E. State Space Analysis: An Introduction . McGraw-Hill, New York, Van Dijk, E., Spruijt, J. N., O ‚ÄôSullivan, D. M., and Klaasens, J. B. PWM-Switch Modeling of DC-DC Converters. IEEE Transactions on Power Electronics , vol. 10, 1995, pp. 659 ‚Äì665.Bibliography 705WEBC12 10/29/2014 8:56:50 Page 706WEBC13 10/28/2014 20:49:39 Digital Control Systems Chapter Learning Outcomes After completing this chapter the student will be able to: ¬ÅModel the digital computer in a feedback system (Sections 13.1 ‚Äì13.2) ¬ÅFind z- and inverse z-transforms of time and Laplace functions (Section 13.3) ¬ÅFind sampled-data transfer functions (Section 13.4) ¬ÅReduce an interconnection of sampled-data transfer functions to a single sampled-data transfer function (Section 13.5) ¬ÅDetermine whether a sampled-data system is stable and determine samplingrates for stability (Section 13.6) ¬ÅDesign digital systems to meet steady-state error speci Ô¨Åcation (Section 13.7) ¬ÅDesign digital systems to meet transient response speci Ô¨Åcations using gain adjustment (Sections 13.8 ‚Äì13.9) ¬ÅDesign cascade compensation for digital systems (Sections 13.10 ‚Äì13.11) Case Study Learning Outcomes You will be able to demonstrate your knowledge of the chapter objectives with acase study as follows: ¬ÅGiven the analog antenna azimuth position control system shown on the frontendpapers and in Figure 13.1( a), you will be able to convert the system to a digital system as shown in Figure 13.1( b) and then design the gain to meet a transient response speci Ô¨Åcation.13 707WEBC13 10/28/2014 20:49:39 ¬ÅGiven the digital antenna azimuth position control system shown in Figure 13.1( b), y o uw i l lb ea b l et od e s i g nad i g i t a lc a s c a d ec o m p e n s a t o rt oi m p r o v et h et r a n s i e n t response. 13.1 Introduction This chapter is an introduction to digital control systems and will cover only frequency-domain analysis and design. You are encouraged to pursue the study of state-spacetechniques in an advanced course in sampled-data control systems. In this chapter, weintroduce analysis and design of stability, steady-state error, and transient response forcomputer-controlled systems. With the development of the minicomputer in the mid-1960s and the microcomputer in the mid-1970s, physical systems need no longer be controlled by expensive mainframecomputers. For example, milling operations that required mainframe computers in the pastcan now be controlled by a personal computer. The digital computer can perform two functions: (1) supervisory ‚Äîexternal to the feedback loop; and (2) control ‚Äîinternal to the feedback loop. Examples of supervisory functions consist of scheduling tasks, monitoring parameters and variables for out-of-rangeCableA/D D/A (b)ComputerDesired azimuth angle inputPotentiometer Azimuth angle output(a)Azimuth angle outputAntenna Antenn aŒ∏o(t) Œ∏o(t)Œ∏i(t) FIGURE 13.1 Conversion of antenna azimuth position control system from a.analog control to b.digital control708 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:39 values, or initiating safety shutdown. Control functions are of primary interest to us, since a computer that performs within the feedback loop replaces the methods of compensation heretofore discussed. Examples of control functions are lead and lag compensation. Transfer functions, representing compensators built with analog components, are now replaced with a digital computer that performs calculations that emulate the physicalcompensator. What advantages are there to replacing analog components with a digitalcomputer? Advantages of Digital Computers The use of digital computers in the loop yields the following advantages over analogsystems: (1) reduced cost, (2) Ô¨Çexibility in response to design changes, and (3) noise immunity. Modern control systems require control of numerous loops at the same time‚Äîpressure, position, velocity, and tension, for example. In the steel industry, a single digital computer can replace numerous analog controllers with a subsequent reduction in cost. Where analog controllers implied numerous adjustments and resulting hardware,digital systems are now installed. Banks of equipment, meters, and knobs are replaced withcomputer terminals, where information about settings and performance is obtained throughmenus and screen displays. Digital computers in the loop can yield a degree of Ô¨Çexibility in response to changes in design. Any changes or modi Ô¨Åcations that are required in the future can be implemented with simple software changes rather than expensive hardware modiÔ¨Åcations. Finally, digital systems exhibit more noise immunity than analog systems by virtue of the methods of implementation. Where then is the computer placed in the loop? Remember that the digital computer is controlling numerous loops; thus, its position in the loop depends upon the function it performs. Typically, the computer replaces the cascade compensator and is thus positionedat the place shown in Figure 13.2( a). The signals r,e,f,a n dc shown in Figure 13.2( a) can take on two forms: digital or analog. Up to this point we have used analog sig nals exclusively. Digital signals, which consist of a sequence of binary numbers, can be found in loops containing digitalcomputers. Loops containing both analog and digital signals must provide a means for conversion from one form to the other as required by each subsystem. A device that converts analogsignals to digital signals is called an analog-to-digital (A/D)converter . Conversely, a device that converts digital signals to analog signals is called a digital-to-analog (D/A)converter . r ‚Äì+r c ‚Äì+ Digital computerPlantf e A/DDigital computerD/A Plantc(a) (b) FIGURE 13.2 a.Placement of the digital computer within the loop; b.detailed block diagram showing placement of A/D and D/A converters13.1 Introduction 709WEBC13 10/28/2014 20:49:40 For example, in Figure 13.2( b), if the plant output, c, and the system input, r, are analog signals, then an analog-to-digital converter must be provided at the input to the digital computer. Also, if the plant input, f, is an analog signal, then a digital-to-analog converter must be provided at the output of the digital computer. Digital-to-Analog Conversion Digital-to-analog conversion is simple and effectively instan-taneous. Properly weighted voltages are summed together toyield the analog output. For example, in Figure 13.3, threeweighted voltages are summed. The three-bit binary code isrepresented by the switches. Thus, if the binary number is110 2, the center and bottom switches are on, and the analog output is 6 volts. In actual use, the switches are electronic andare set by the input binary code. Analog-to-Digital Conversion Analog-to-digital conversion, on the other hand, is a two-stepprocess and is not instantaneous. There is a delay between the input analog voltage and the output digital word. In an analog- to-digital converter, the analog signal is Ô¨Årst converted to a sampled signal and then converted to a sequence of binary numbers, the digital signal. The sampling rate must be at least twice the bandwidth of the signal, or else there will be distortion. This minimum sampling frequency is called the Nyquist sampling rate . 1 In Figure 13.4( a), we start with the analog signal. In Figure 13.4( b), we see the analog signal sampled at periodic intervals and held over the sampling interval by a device called a zero-order sample-and-hold (z.o.h .) that yields a staircase approximation to the analog signal. Higher-order holds, such as a Ô¨Årst-order hold, generate more complex and more accurate waveshapes between samples. For example, a Ô¨Årst-order hold generates a ramp between the samples. Samples are held before being digitized because the analog-to-digitalconverter converts the voltage to a digital number via a digital counter, which takes time toreach the correct digital number. Hence, the constant analog voltage must be present duringthe conversion process. After sampling and holding, the analog-to-digital converter converts the sample to a digital number (as shown in Figure 13.4( c)), which is arrived at in the following manner. The dynamic range of the analog signal ‚Äôs voltage is divided into discrete levels, and each level is assigned a digital number. For example, in Figure 13.4( b), the analog signal is divided into eight levels. A three-bit digital number can represent each of the eight levels asshown in the Ô¨Ågure. Thus, the difference between quantization levels is M=8 volts, where M is the maximum analog voltage. In general, for any system, this difference is M=2 nvolts, where nis the number of binary bits used for the analog-to-digital conversion. Looking at Figure 13.4( b), we can see that there will be an associated error for each digitized analog value except the voltages at the boundaries such as M=8 and 2 M=8. We call this error the quantization error . Assuming that the quantization process rounds off the analog voltage to the next higher or lower level, the maximum value of the quantizationerror is 1 =2 the difference between quantization levels in the range of analog voltages from 0t o1 5 M=16. In general, for any system using roundoff, the quantization error will be 1=2¬Ü M=2 n¬Ü¬àM=2n¬á1. We have now covered the basic concepts of digital systems. We found out why they are used, where the digital computer is placed in the loop, and how to convert between1 2 4 1 voltMost significant bitLeast significant bitAnalog output +++ FIGURE 13.3 Digital-to-analog converter 1SeeOgata (1987: 170 ‚Äì177) for a detailed discussion.710 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:40 analog and digital signals. Since the computer can replace the compensator, we have to realize that the computer is working with a quantized amplitude re presentation of the analog signal, formed from values of the an alog signal, at discrete intervals of time. Ignoring the quantization error, we see that the computer performs just as thecompensator does, except that signals pass through the computer only at the sampledintervals of time. We will Ô¨Ånd that the sampling of data has an unusual effect upon the performance of a closed-loop feedback system, since stability and transient response are now dependent upon the sampling rate. If the sampling rate is too slow, the system can be unstable, since the values are not being updated rapidly enough. If we are to analyze and design feedback control systems with digital computers in the loop, we must be able to modelthe digital computer and associated digital-to-analog and analog-to-digital converters.The modeling of the digital computer along with associated converters is covered in thenext section. 13.2 Modeling the Digital Computer If we think about it, the form of the signals in a loop is not as important as what happensto them. For example, if analog-to-digital c onversion could happen instantaneously, and time samples occurred at intervals of time that approached zero, there would be no needto differentiate between the digital sign als and the analog signals. Thus, previous analysis and design techniques would be valid regardless of the presence of the digitalcomputer. The fact that signals are sampled at speci Ô¨Åed intervals and held causes the system performance to change with changes in sampling rate. Basically, then, the computer ‚Äôs effect upon the signal comes from this sampling and holding. Thus, in order to model digitalcontrol systems, we must come up with a mathematical representation of this sample-and-hold process.12345Digital number 000 011100101101110110110110110123 4 Time (seconds)5000 2345 Time (seconds) (b) (a) Time (seconds) (c)1M/82M/83M/84M/85M/86M/87M/8 f (t) 01M/82M/83M/84M/85M/86M/87M/8 000001010011101110111 1001 Digital numberf (t) FIGURE 13.4 Steps in analog-to-digital conversion: a.analog signal; b.analog signal after sample-and-hold; c.conversion of samples to digital numbers13.2 Modeling the Digital Computer 711WEBC13 10/28/2014 20:49:40 Modeling the Sampler Our objective at this point is to derive a mathematical model for the digital computer as represented by a sampler and zero-order hold. Our goal is to represent the computer as a transfer function similar to that for any subs ystem. When signals are sampled, however, the Laplace transform that we have dealt with becomes a bit unwieldy. The Laplacetransform can be replaced by another related transform called the z-transform .T h e z-transform will arise naturally from our deve lopment of the mathematical representation of the computer. Consider the models for sampling shown in Figure 13.5. The model in Figure 13.5( a) is a switch turning on and off at a uniform sampling rate. In Figure 13.5( b), sampling can also be considered to be the product of the time waveform to be sampled, f(t), and a sampling function, s(t). If s(t) is a sequence of pulses of width T W, constant amplitude, and uniform rate as shown, the sampled output, f* TW t¬Ü, will consist of a sequence of sections of f(t) at regular intervals. This view is equivalent to the switch model of Figure 13.5( a). We can now write the time equation of the sampled waveform, f* TW t¬Ü. Using the model shown in Figure 13.5( b), we have f*T W t¬Ü¬àf t¬Üs t¬Ü¬àf t¬ÜX‚àû k¬à ‚àûu t kT¬Ü u t kT Tw¬Ü 13.1¬Ü where kis an integer between  ‚àûand¬á‚àû,Tis the period of the pulse train, and TWis the pulse width. Since Eq. (13.1) is the product of two time functions, taking the Laplace transform in order to Ô¨Ånd a transfer function is not simple. A simpli Ô¨Åcation can be made if we assume that the pulse width, TW, is small in comparison to the period, T,s u c ht h a t f(t) can f(t)* Pulse width = TW T2T3T T2T3T T2T3Tf(t) tt f(t) t t ts(t)f(t)(a) (b)fTW(t) *fTW(t) *fTW(t)*fTW(t) Pulse width = TW Pulse width = TWs(t) FIGURE 13.5 Two views of uniform-rate sampling: a.switch opening and closing; b.product of time waveform and sampling waveform712 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:41 be considered constant during the sampling interval. Over the sampling interval, then, f t¬Ü¬àf kT¬Ü. Hence, f* TW t¬Ü¬àX‚àû k¬à ‚àûf kT¬Ü¬âu t kT¬Ü u t kT TW¬Ü¬ä 13.2¬Ü for small TW. Equation (13.2) can be further simpli Ô¨Åed through insight provided by the Laplace transform. Taking the Laplace transform of Eq. (13.2), we have F* TW s¬Ü¬àX‚àû k¬à ‚àûf kT¬Üe kTs s e kTs TWs s/C20/C21 ¬àX‚àû k¬à ‚àûf kT¬Ü1 e TWs s/C20/C21 e kTs 13.3¬Ü Replacing e TWswith its series expansion, we obtain F* TW s¬Ü¬àX‚àû k¬à ‚àûf kT¬Ü1 1 TWs¬á TWs¬Ü2 2! ‚àô‚àô‚àô/C26/C27 s2 66643 7775e kTs 13.4¬Ü For small TW, Eq. (13.4) becomes F* TW s¬Ü¬àX‚àû k¬à ‚àûf kT¬ÜTWs s/C20/C21 e kTs¬àX‚àû k¬à ‚àûf kT¬ÜTWe kTs 13.5¬Ü Finally, converting back to the time domain, we have f* TW t¬Ü¬àTWX‚àû k¬à ‚àûf kT¬ÜŒ¥ t kT¬Ü 13.6¬Ü where Œ¥ t kT¬Üare Dirac delta functions. Thus, the result of sampling with rectangular pulses can be thought of as a series of delta functions whose area is the product of the rectangular pulse width and the amplitude of the sampled waveform, or TWf kT¬Ü. Equation (13.6) is portrayed in Figure 13.6. The sampler is divided into two parts: (1) an ideal sampler described by the portion of Eq. (13.6) that is not dependent upon thesampling waveform characteristics, f* t¬ÜX‚àû k¬à ‚àûf kT¬ÜŒ¥ t kT¬Ü 13.7¬Ü and (2) the portion dependent upon the sampling waveform ‚Äôs characteristics, TW. f *(t)Ideal sampler f(t)TW Œ£‚Äì‚àû‚àû Œ£‚Äì‚àû‚àû = f(kT) Œ¥(t ‚Äì kT) = TW f(kT) Œ¥(t ‚Äì kT)*fTW(t)FIGURE 13.6 Model of sampling with a uniform rectangular pulse train13.2 Modeling the Digital Computer 713WEBC13 10/28/2014 20:49:41 Modeling the Zero-Order Hold TheÔ¨Ånal step in modeling the digital computer is modeling the zero-order hold that follows the sampler. Figure 13.7 summarizes the function of the zero-order hold, which is to hold the last sampled value of f(t). If we assume an ideal sampler (equivalent to setting TW¬à1), then f* t¬Üis represented by a sequence of delta functions. The zero-order hold yields a staircase approximation to f(t). Hence, the output from the hold is a sequence of step functions whose amplitude is f(t) at the sampling instant, or f(kT). We have previously seen that the transfer function of any linear system is identical to the Laplace transform of the impulse response,since the Laplace transform of a unit impulse or delta function input is unity. Since a singleimpulse from the sampler yields a step over the sampling interval, the Laplace transform ofthis step, G h(s), which is the impulse response of the zero-order hold, is the transfer function of the zero-order hold. Using an impulse at zero time, the transform of the resulting step thatstarts at t¬à0 and ends at t¬àTis Gh s¬Ü¬à1 e Ts s 13.8¬Ü In a physical system, samples of the input time waveform, f(kT), are held over the sampling interval. We can see from Eq. (13.8) that the hold circuit integrates the input andholds its value over the sampling interval. Since the area under the delta functions comingfrom the ideal sampler is f(kT), we can then integrate the ideal sampled waveform and obtain the same result as for the physical system. In other words, if the ideal sampled signal, f * t¬Ü, is followed by a hold, we can use the ideal sampled waveform as the input, rather than f* TW t¬Ü. In this section, we modeled the digital computer by cascading two elements: (1) an ideal sampler and (2) a zero-order hold. Together, the model is known as a zero-order sample-and-hold . The ideal sampler is modeled by Eq. (13.7), and the zero-order hold is modeled by Eq. (13.8). In the next section, we start to create a transform approach to digital systems by introducing the z-transform. 13.3 The z-Transform The effect of sampling within a system is pronounced. Whereas the stability and transientresponse of analog systems depend upon gain and component values, sampled-data systemstability and transient response also depend upon sampling rate. Our goal is to develop atransform that contains the information of sampling from which sampled-data systems can bemodeled with transfer functions, analyzed, and designed with the ease and insight we enjoyed with the Laplace transform. We now develop such a transform and use the information from the last section to obtain sampled-data transfer functions for physical systems.Ideal sampler f *(t) f(t) Holdfh(t) t t tf(t) f *(t) f(kT) Œ¥(t kT ) ‚Äìfh(t) FIGURE 13.7 Ideal sampling and the zero-order hold714 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:42 Equation (13.7) is the ideal sampled waveform. Taking the Laplace transform of this sampled time waveform, we obtain F* s¬Ü¬àX‚àû k¬à0f kT¬Üe kTs 13.9¬Ü Now, letting z¬àeTs, Eq. (13.9) can be written as F z¬Ü¬àX‚àû k¬à0f kT¬Üz k 13.10 ¬Ü Equation (13.10) de Ô¨Ånes the z-transform . That is, an F(z) can be transformed to f(kT), or an f(kT) can be transformed to F(z). Alternately, we can write f kT¬Ü‚áÜ F z¬Ü 13.11 ¬Ü Paralleling the development of the Laplace transform, we can form a table relating f(kT), the value of the sampled time function at the sampling instants, to F(z). Let us look at an example. Example 13.1 z-Transform of a Time Functionz-Transform of a Time Function PROBLEM: Find the z-transform of a sampled unit ramp. SOLUTION: For a unit ramp, f kT¬Ü¬àkT. Hence the ideal sampled step can be written from Eq. (13.7) as f* t¬Ü¬àX‚àû k¬à0ktŒ¥ t kT¬Ü 13.12 ¬Ü Taking the Laplace transform, we obtain F* s¬Ü¬àX‚àû k¬à0kTe kTs 13.13 ¬Ü Converting to the z-transform by letting e kTs¬àz k, we have F z¬Ü¬àX‚àû k¬à0kTz k¬àTX‚àû k¬à0kz k¬àT z 1¬á2z 2¬á3z 3¬á‚àô‚àô‚àô¬Ü 13.14 ¬Ü Equation (13.14) can be converted to a closed form by forming the series for zF(z) and subtracting F(z). Multiplying Eq. (13.14) by z, we get zF z¬Ü¬àT 1¬á2z 1¬á3z 2¬á‚àô‚àô‚àô¬Ü 13.15 ¬Ü Subtracting Eq. (13.14) from Eq. (13.15), we obtain zF z¬Ü F z¬Ü¬à z 1¬ÜF z¬Ü¬àT 1¬áz 1¬áz 2¬á‚àô‚àô‚àô¬Ü 13.16 ¬Ü But 1 1 z 1¬à1¬áz 1¬áz 2¬áz 3¬á‚àô‚àô‚àô 13.17 ¬Ü13.3 The z-Transform 715WEBC13 10/28/2014 20:49:47 The example demonstrates that any function of s,F* s¬Ü, that represents a sampled time waveform can be transformed into a function of z,F(z). The Ô¨Ånal result, F z¬Ü¬àTz= z 1¬Ü2, is in a closed form, unlike F* s¬Ü. If this is the case for numerous other sampled time waveforms, then we have the convenient transform that we were looking for. In a similar way, z-transforms for other waveforms can be obtained that parallel the table of Laplace transforms in Chapter 2. A partial table of z-transforms is shown in Table 13.1, and a partial table of z-transform theorems is shown in Table 13.2. For functions not in the table, we must perform an inverse z-transform calculation similar towhich can be veri Ô¨Åed by performing the indicated division. Substituting Eq. (13.17) into (13.16) and solving for F(z) yields F z¬Ü¬àTz z 1¬Ü2 13.18 ¬Ü as the z-transform of f kT¬Ü¬àkT. Students who are performing the MATLAB exercises and want toexplore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch13sp1 in Appendix F located at www.wiley.com/ college/nise . You will learn how to Ô¨Ånd the z-transform of time functions. Example 13.1 will be solved using MATLAB and theSymbolic Math Toolbox. TABLE 13.1 Partial table of z- and s-transforms f(t) F(s) F(z) f(kT) u(t) 1 sz z 1u(kT) t 1 s2Tz z 1¬Ü2kT tn n! sn¬á1lim a¬Æ0  1¬Ündn danz z e aT/C20/C21 kT¬Ün e at 1 s¬áaz z e aTe akT tne at n! s¬áa¬Ün¬á1  1¬Ündn danz z e aT/C20/C21 kT¬Üne akT sin œâtœâ s2¬áœâ2zsinœâT z2 2zcosœâT¬á1sinœâkT cos œâts s2¬áœâ2z z cosœâT¬Ü z2 2zcosœâT¬á1cosœâkT e atsinœâtœâ s¬áa¬Ü2¬áœâ2ze aTsinœâT z2 2ze aTcosœâT¬áe 2aTe akTsinœâkT e atcosœât s¬áa s¬áa¬Ü2¬áœâ2z2 ze aTcosœâT z2 2ze aTcosœâT¬áe 2aTe akTcosœâkT716 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:50 the inverse Laplace transform by partial-fraction expansion. Let us now see how we can work in the reverse direction and Ô¨Ånd the time function from its z-transform. The Inverse z-Transform Two methods for Ô¨Ånding the inverse z-transform (the sampled time function from its z-transform) will be described: (1) partial-fraction expansion and (2) the power series method. Regardless of the method used, remember that, since the z-transform came from the sampled waveform, the inverse z-transform will yield only the values of the time function at the sampling instants. Keep this in mind as we proceed, because even as we obtain closed-form time functions as results, they are valid only at sampling instants. Inverse z-Transforms via Partial-Fraction Expansion Recall that the Laplace transform consists of a partial fraction that yields a sum of terms leading to exponentials, that is,A= s¬áa¬Ü. Taking this lead and looking at Table 13.1, we Ô¨Ånd that sampled exponential time functions are related to their z-transforms as follows: e akT‚áÜz z eaT 13.19 ¬Ü We thus predict that a partial-fraction expansion should be of the following form: F z¬Ü¬àAz z z1¬áBz z z2¬á‚àô‚àô‚àô 13.20 ¬Ü Since our partial-fraction expansion of F(s) did not contain terms with sin the numerator of the partial fractions, we Ô¨Årst form F z¬Ü=zto eliminate the zterms in the numerator, perform a partial-fraction expansion of F z¬Ü=z,a n dÔ¨Å nally multiply the result by zto replace the z‚Äôs in the numerator. An example follows.TABLE 13.2 z-transform theorems Theorem Name zfaf t¬Üg ¬à aF z¬Ü Linearity theorem zff1 t¬Ü¬áf2 t¬Üg ¬à F1 z¬Ü¬áF2 z¬Ü Linearity theorem zfe aTf t¬Üg ¬à F eaTz¬Ü Complex differentiation zff t nT¬Üg ¬à z nF z¬Ü Real translation zftf t¬Üg ¬à  TzdF z¬Ü dzComplex differentiation 6.f 0¬Ü¬à lim z¬Æ‚àûF z¬Ü Initial value theorem 7.f ‚àû¬Ü¬àlim z¬Æ1 1 z 1¬ÜF z¬Ü Final value theorem Note: kTmay be substituted for tin the table. Example 13.2 Inverse z-Transform via Partial-Fraction Expansion Inverse z-Transform via Partial-Fraction Expansion PROBLEM: Given the function in Eq. (13.21), Ô¨Ånd the sampled time function. F z¬Ü¬à0:5z z 0:5¬Ü z 0:7¬Ü 13.21 ¬Ü13.3 The z-Transform 717WEBC13 10/28/2014 20:49:51 Inverse z-Transform via the Power Series Method The values of the sampled time waveform can also be found directly from F(z). Although this method does not yield closed-form expressions for f(kT), it can be used for plotting. The method consists of performing the indicated division, which yields a power series for F(z). The power series can then be easily transformed into F* s¬Üandf* t¬Ü.SOLUTION: B e g i nb yd i v i d i n gE q .( 1 3 . 2 1 )b yz and performing a partial-fraction expansion. F z¬Ü z¬à0:5 z 0:5¬Ü z 0:7¬Ü¬àA z 0:5¬áB z 0:7¬à 2:5 z 0:5¬á2:5 z 0:7 13.22 ¬Ü Next, multiply through by z. F z¬Ü¬à0:5z z 0:5¬Ü z 0:7¬Ü¬à 2:5z z 0:5¬á2:5z z 0:7 13.23 ¬Ü Using Table 13.1, we Ô¨Ånd the inverse z-transform of each partial fraction. Hence, the value of the time function at the sampling instants is f kT¬Ü¬à  2:5 0:5¬Ük¬á2:5 0:7¬Ük 13.24 ¬Ü Also, from Eqs. (13.7) and (13.24), the ideal sampled time function is f* t¬Ü¬àX‚àû k¬à ‚àûf kT¬ÜŒ¥ t kT¬Ü¬àX‚àû k¬à ‚àû¬â 2:5 0:5¬Ük¬á2:5 0:7¬Ük¬äŒ¥ t kT¬Ü 13.25 ¬Ü If we substitute k¬à0;1;2, and 3, we can Ô¨Ånd the Ô¨Årst four samples of the ideal sampled time waveform. Hence, f* t¬Ü¬à0Œ¥ t¬Ü¬á0:5Œ¥ t T¬Ü¬á0:6Œ¥ t 2T¬Ü¬á0:545Œ¥ t 3T¬Ü 13.26 ¬Ü Students who are performing the MATLAB exercises and want to explore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch13sp2 in Appendix F located at www.wiley.com/ college/nise . You will learn how to Ô¨Ånd the inverse z-transform of sampled time functions. Example 13.2 will be solved using MATLAB and the Symbolic Math Toolbox. Example 13.3 Inverse z-Transform via Power Series Inverse z-Transform via Power Series PROBLEM: Given the function in Eq. (13.21), Ô¨Ånd the sampled time function. SOLUTION: Begin by converting the numerator and denominator of F(z)t o polynomials in z. F z¬Ü¬à0:5z z 0:5¬Ü z 0:7¬Ü¬à0:5z z2 1:2z¬á0:35 13.27 ¬Ü718 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:52 13.4 Transfer Functions N o wt h a tw eh a v ee s t a b l i s h e dt h ez -transform, let us apply it to physical systems by Ô¨Ånding transfer functions of sampled-data systems. Consider the continuous system shown in Figure 13.8( a). If the input is sampled as shown in Figure 13.8( b), the output is still a continuous signal. If, however, we are satis Ô¨Åed with Ô¨Ånding the output at the sampling instants and not in between, the representation of the sampled-data system can be greatly simpli Ô¨Åed. Our assumption is visually described in Figure 13.8( c), where the output is conceptually sampled in synchronization with the input by a phantom sampler.Now perform the indicated division. z2 1:2z¬á0:35/C1 0:5z0:5z 1¬á0:6z 2¬á0:545z 3 0:5z 0:6¬á0:175z 1 0:6 0:175z 1 0:6 0:720z 1¬á0:21 0:545z 1 0:21 13:28¬Ü Using the numerator and the de Ô¨Ånition of z, we obtain F* s¬Ü¬à0:5e Ts¬á0:6e 2Ts¬á0:545e 3Ts¬á‚àô‚àô‚àô 13.29 ¬Ü from which f* t¬Ü¬à0:5Œ¥ t T¬Ü¬á0:6Œ¥ t 2T¬Ü¬á0:545Œ¥ t 3T¬Ü¬á ‚àô‚àô‚àô 13.30 ¬Ü You should compare Eq. (13.30) with Eq. (13.26), the result obtained via partial expansion. Skill-Assessment Exercise 13.1 PROBLEM: Derive the z-transform for f t¬Ü¬àsinœâtu t¬Ü. ANSWER: F z¬Ü¬àz 1sin œâT¬Ü 1 2z 1cos œâT¬Ü¬áz 2 The complete solution is located at www.wiley.com/college/nise . Skill-Assessment Exercise 13.2 PROBLEM: Find f kT¬ÜifF z¬Ü¬àz z¬á1¬Ü z¬á2¬Ü z 0:5¬Ü z 0:7¬Ü z 0:9¬Ü: ANSWER: f kT¬Ü¬à46:875 0:5¬Ük 114:75 0:7¬Ük¬á68:875 0:9¬Ük The complete solution is located at www.wiley.com/college/nise .13.4 Transfer Functions 719WEBC13 10/28/2014 20:49:52 Using the concept described in Figure 13.8( c), we derive the pulse transfer function ofG(s). Derivation of the Pulse Transfer Function Using Eq. (13.7), we Ô¨Ånd that the sampled input, r*(t), to the system of Figure 13.8( c)i s r* t¬Ü¬àX‚àû n¬à0r nT¬ÜŒ¥ t nT¬Ü 13.31 ¬Ü which is a sum of impulses. Since the impulse response of a system, G(s), isg(t), we can write the time output of G(s) as the sum of impulse responses generated by the input, Eq. (13.31). Thus, c t¬Ü¬àX‚àû n¬à0r nT¬Üg t nT¬Ü 13.32 ¬Ü From Eq. (13.10), C z¬Ü¬àX‚àû k¬à0c kT¬Üz k 13.33 ¬Ü Using Eq. (13.32) with t¬àkT, we obtain c kT¬Ü¬àX‚àû n¬à0r nT¬Üg kT nT¬Ü 13.34 ¬Ü Substituting Eq. (13.34) into Eq. (13.33), we obtain C z¬Ü¬àX‚àû k¬à0X‚àû n¬à0r nT¬Üg¬â k n¬ÜT¬äz k 13.35 ¬ÜG(s)C(s) R(s) G(s)C(s) R(s)(a) (b) G(s)C(s) R(s) (c)R (s) R (s) C (s) Note: Phantom sam pler is shown in color.** * FIGURE 13.8 Sampled-data systems: a.continuous; b.sampled input; c.sampled input and output720 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:54 Letting m¬àk n,w e Ô¨Ånd C z¬Ü¬àX‚àû m¬án¬à0X‚àû n¬à0r nT¬Üg mT¬Üz  m¬án¬Ü ¬àX‚àû m¬à0g mT¬Üz m()X‚àû n¬à0r nT¬Üz n() 13.36 ¬Ü where the lower limit, m¬án, was changed to m. The reasoning is that m¬án¬à0 yields negative values of mfor all n>0. But, since g mT¬Ü¬à0 for all m<0,mis not less than zero. Alternately, g t¬Ü¬à0 for t<0. Thus, n¬à0 in the Ô¨Årst sum ‚Äôs lower limit. Using the de Ô¨Ånition of the z-transform, Eq. (13.36) becomes C z¬Ü¬àX‚àû m¬à0g mT¬Üz mX‚àû n¬à0r nT¬Üz n¬àG z¬ÜR z¬Ü 13.37 ¬Ü Equation (13.37) is a very important result, since it shows that the transform of the sampled output is the product of the transforms of the sampled input and the pulse transfer function of the system. Remember that although the output of the system is a continuous function, we had to make an assumption of a sampled output (phantom sampler) in order to arrive at thecompact result of Eq. (13.37). One way of Ô¨Ånding the pulse transfer function, G(z), is to start with G(s),Ô¨Åndg(t), and then use Table 13.1 to Ô¨ÅndG(z). Let us look at an example. Example 13.4 Converting G1(s) in Cascade with z.o.h. to G(z) Converting G1(s) in Cascade with z.o.h. to G(z) PROBLEM: Given a z.o.h. in cascade with G1 s¬Ü¬à s¬á2¬Ü= s¬á1¬Üor G s¬Ü¬à1 e Ts s s¬á2¬Ü s¬á1¬Ü 13.38 ¬Ü Ô¨Ånd the sampled-data transfer function, G(z), if the sampling time, T, is 0.5 second. SOLUTION: Equation (13.38) represents a common occurrence in digital control systems, namely a transfer function in cascade with a zero-order hold. Speci Ô¨Åcally, G1 s¬Ü¬à s¬á2¬Ü= s¬á1¬Üis in cascade with a zero-order hold, 1 e Ts¬Ü=s. We can formulate ageneralsolutiontothistypeofproblembymovingthe sinthedenominatorofthezero-order hold to G1 s¬Ü, yielding G s¬Ü¬à 1 e Ts¬ÜG1 s¬Ü s 13.39 ¬Ü from which G z¬Ü¬à 1 z 1¬ÜzG1 s¬Ü s/C26/C27 ¬àz 1 zzG1 s¬Ü s/C26/C27 13.40 ¬Ü Thus, begin the solution by Ô¨Ånding the impulse response (inverse Laplace transform) of G1 s¬Ü=s. Hence, G2 s¬Ü¬àG1 s¬Ü s¬às¬á2 s s¬á1¬Ü¬àA s¬áB s¬á1¬à2 s 1 s¬á1 13.41 ¬Ü13.4 Transfer Functions 721WEBC13 10/28/2014 20:49:54 Students who are using MATLAB should now run ch13p2 in Appendix B. You will learn how to use MATLAB to convert G(s)t oG (z) when G(s)i s not in cascade with a zero-order hold. This is the same as Ô¨Ånding thez-transform of G(s). Students who are using MATLAB should now run ch13p3 in Appendix B. You will learn how to create digital transfer functions directly. Students who are using MATLAB should now run ch13p4 in Appendix B. You will learn how to use MATLAB to convert G(z)t oG (s) when G(s)i s not in cascade with a zero-order hold. This is the same as Ô¨Ånding the Laplace transform of G(z).Taking the inverse Laplace transform, we get g2 t¬Ü¬à2 e t 13.42 ¬Ü from which g2 kT¬Ü¬à2 e kt 13.43 ¬Ü Using Table 13.1, we Ô¨Ånd G2 z¬Ü¬à2z z 1 z z e T 13.44 ¬Ü Substituting T¬à0:5 yields G2 z¬Ü¬àzG1 s¬Ü s/C26/C27 ¬à2z z 1 z z 0:607¬àz2 0:213z z 1¬Ü z 0:607¬Ü 13.45 ¬Ü From Eq. (13.40), G z¬Ü¬àz 1 zG2 z¬Ü¬àz 0:213 z 0:607 13.46 ¬Ü Students who are using MATLAB should now run ch13p1 in Appendix B.You will learn how to use MATLAB to convert G 1(s)in cascade with a zero-order hold to G(z). This exercise solves Example 13.4 using MATLAB. Students who are performing the MATLAB exercises and want toexplore the added capability of MATLAB ‚Äôs Symbolic Math Toolbox should now run ch13sp3 in Appendix F located at www.wiley.com/ college/nise . MATLAB ‚Äôs Symbolic Math Toolbox yields an alterna- tive method of Ô¨Ånding the z-transform of a transfer function in cascade with a zero-order hold. Example 13.4 will be solved usingMATLAB and the Symbolic Math Toolbox with a method that followsclosely the hand calculation shown in that example.TryIt 13.1 Use MATLAB, the Control System Toolbox, and thefollowing statements to Ô¨Ånd G 1 s¬Üin Example 13.4 given G(z) in Eq. (13.46) num=0.213 ; den=0.607 ; K=1; T=0.5 ; Gz=zpk(num,den,K,T) Gs=d2c(Gz, 'zoh' ) Skill-Assessment Exercise 13.3 PROBLEM: Find G(z) for G s¬Ü¬à8= s¬á4¬Üin cascade with a zero-order sample and hold. The sampling period is 0.25 second. ANSWER: G z¬Ü¬à1:264= z 0:3679 ¬Ü The complete solution is located at www.wiley.com/college/nise .TryIt 13.2 Use MATLAB, the Control System Toolbox, and the following statements to solve Skill-Assessment Exercise 13.3. Gs=zpk( [] ,  4,8) Gz=c2d(Gs,0.25, 'zoh' )722 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:55 The major discovery in this section is that once the pulse transfer function, G(z), of a system is obtained, the transform of the sampled output response, C(z), for a given sampled input can be evaluated using the relationship C z¬Ü¬àR z¬ÜG z¬Ü. Finally, the time function can be found by taking the inverse z-transform, as covered in Section 13.3. In the next section, we look at block diagram reduction for digital systems. 13.5 Block Diagram Reduction Up to this point, we have de Ô¨Åned the z-transform and the sampled-data system transfer function and have shown how to obtain the sampled response. Basically, we are paralleling our discussions of the Laplace transform in Chapters 2 and 4. We now draw a parallel withsome of the objectives of Chapter 5, namely block diagram reduction. Our objective here isto be able to Ô¨Ånd the closed-loop sampled-data transfer function of an arrangement of subsystems that have a computer in the loop. When manipulating block diagrams for sampled-data systems, you must be careful to remember the de Ô¨Ånition of the sampled-data system transfer function (derived in the last section) to avoid mistakes. For example, zfG 1 s¬ÜG2 s¬Üg6¬àG1 z¬ÜG2 z¬Ü, where zfG1 s¬ÜG2 s¬Üg denotes the z-transform. The s-domain functions have to be multiplied together before taking the z-transform. In the ensuing discussion, we use the notation G1G2 s¬Üto denote a single function that is G1 s¬ÜG2 s¬Üafter evaluating the product. Hence, zfG1 s¬ÜG2 s¬Üg ¬à zfG1G2 s¬Üg ¬à G1G2 z¬Ü6¬àG1 z¬ÜG2 z¬Ü. Let us look at the sampled-data systems shown in Figure 13.9. The sampled-data systems are shown under the column marked s. Their z-transforms are shown under the column marked z. The standard system that we derived earlier is shown in Figure 13.9( a), where the transform of the output, C(z), is equal to R(z)G(z). This system forms the basis for the other entries in Figure 13.9. In Figure 13.9( b), there is no sampler between G1 s¬ÜandG2 s¬Ü. Thus, we can think of a single function, G1 s¬ÜG2 s¬Ü, denoted G1G2 s¬Ü, existing between the two samplers and yielding a single transfer function, as shown in Figure 13.9( a). Hence, the pulse transfer function is zfG1G2 s¬Üg ¬à G1G2 z¬Ü. The transform of the output, C z¬Ü¬àR z¬ÜG1G2 z¬Ü. In Figure 13.9( c), we have the cascaded two subsystems of the type shown in Figure 13.9( a). For this case, then, the z-transform is the product of the two z-transforms, or G2 z¬ÜG1 z¬Ü. Hence the transform of the output C z¬Ü¬àR z¬ÜG2 z¬ÜG1 z¬Ü. R(s) R*(s)G(s)C(s) C*(s) (a) (b) (c) (d)R(s) R*(s) C(s) C*(s) R(s) R*(s)G2(s)C(s) C*(s)G1(s) R(s)G2(s)C(s) C*(s)G1(s)R(s)G1(s) [R(s)G1(s)]*G(z) G2(z)G1(z) G2(z)R(z) R(z) R(z) RG1(z)C(z) C(z) C(z) C(z)G2G1(z) G2(s) G1(s)sz FIGURE 13.9 Sampled-data systems and their z-transforms13.5 Block Diagram Reduction 723WEBC13 10/28/2014 20:49:55 Finally, in Figure 13.9( d), we see that the continuous signal entering the sampler is R s¬ÜG1 s¬Ü. Thus, the model is the same as Figure 13.9( a) with R(s) replaced by R s¬ÜG1 s¬Ü, andG2 s¬Üin Figure 13.9( d) replacing G(s) in Figure 13.9( a). The z-transform of the input to G2 s¬ÜiszfR s¬ÜG1 s¬Üg ¬à zfRG 1 s¬Üg ¬à RG1 z¬Ü. The pulse transfer function for the system G2 s¬ÜisG2 z¬Ü. Hence, the output C z¬Ü¬àRG 1 z¬ÜG2 z¬Ü. Using the basic forms shown in Figure 13.9, we can now Ô¨Ånd the z-transform of feedback control systems. We have shown that any system, G(s), with sampled input and sampled output, such as that shown in Figure 13.9( a), can be represented as a sampled-data transfer function, G(z). Thus, we want to perform block diagram manipulations that result in subsystems, as well as the entire feedback system, that have sampled inputs and sampled outputs. Then we can make the transformation to sampled-data transfer functions. Anexample follows. Example 13.5 Pulse Transfer Function of a Feedback SystemPulse Transfer Function of a Feedback System PROBLEM: Find the z-transform of the system shown in Figure 13.10( a). SOLUTION: The objective of the problem is to proceed in an orderly fashion, starting with the block diagram of Figure 13.10( a) and reducing it to the one shown in Figure 13.10( f). One operation we can always perform is to place a phantom sampler at the output of any subsystem that has a sampled input, provided that the nature of the signal sent to any FIGURE 13.10 Steps in block diagram reduction of a sampled-data system(Ô¨Ågure continues )(b) C(s) R*(s) + ‚Äì S1R(s) S2G(s)C*(s) S4 S1 S3G(s)H(s) (c)C(s) R*(s) + ‚Äì S1R(s) S2G(s)C*(s) S4 S3H(s)(a)C(s) + ‚Äì S1R(s)G(s) H(s) Note: Phantom sam plers are shown in color.724 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:56 other subsystem is not changed. For example in Figure 13.10( b), phantom sampler S4 can be added. The justi Ô¨Åcation for this, of course, is that the output of a sampled-data system can only be found at the sampling instants anyway, and the signal is not an input to any other block. Another operation that can be performed is to add phantom samplers S2 and S3 at the input to a summing junction whose output is sampled. The justi Ô¨Åcation for this operation is that the sampled sum is equivalent to the sum of the sampled inputs, provided, of course,that all samplers are synchronized. Next, move sampler S1 and G(s) to the right past the pickoff point, as shown in Figure 13.10( c). The motivation for this move is to yield a sampler at the input of G(s)H(s) to match Figure 13.9( b). Also, G(s) with sampler S1 at the input and sampler S4 at the output matches Figure 13.9( a). The closed-loop system now has a sampled input and a sampled output. G(s)H(s) with samplers S1 and S3 becomes GH(z), and G(s) with samplers S1 and S4 becomes G(z), as shown in Figure 13.10( d). Also, converting R *(s)t oR(z) and C*(s)t o C(z), we now have the system represented totally in the z-domain. The equations derived in Chapter 5 for transfer functions represented with the Laplace transform can be used for sampled-data transfer functions with only a change invariables from stoz. Thus, using the feedback formula, we obtain the Ô¨Årst block of Figure 13.10( e). Finally, multiplication of the cascaded sampled-data systems yields the Ô¨Ånal result shown in Figure 13.10( f).C(z) R(z) + ‚ÄìG(z) GH(z) (d) C(z) G(z) 1 + GH(z) ( f )R(z) C(z) 1 1 + GH(z) (e)R(z)G(z) FIGURE 13.10 (Continued ) Skill-Assessment Exercise 13.4 PROBLEM: Find T z¬Ü¬àC z¬Ü=R z¬Üfor the system shown in Figure 13.11. ANSWER: T z¬Ü¬àG1G2 z¬Ü 1¬áHG 1G2 z¬Ü The complete solution is located at www.wiley.com/college/nise .R(s)G1(s)+ ‚ÄìG2(s)C(s) H(s)FIGURE 13.11 Digital system for Skill-Assessment Exercise 13.413.5 Block Diagram Reduction 725WEBC13 10/28/2014 20:49:56 This section paralleled Chapter 5 by showing how to obtain the closed-loop, sampled- data transfer function for a collection of subsystems. The next section parallels the discussion of stability in Chapter 6. 13.6 Stability The glaring difference between analog feedback control systems and digital feedback control systems, such as the one shown in Figure 13.12, is the effect that the sampling rate has on the transient response. Changes in sampling rate not only change the nature of theresponse from overdamped to underdamped, but also can turn a stable system into anunstable one. As we proceed with our discussion, these effects will become apparent. Youare encouraged to be on the lookout. We now discuss the stability of digital systems from two perspectives: (1) z-plane and (2)s-plane. We will see that the Routh-Hurwitz criterion can be used only if we perform our analysis and design on the s-plane. Digital System Stability via the z-Plane In the s-plane, the region of stability is the left half-plane. If the transfer function, G(s), is transformed into a sampled-data transfer function, G(z), the region of stability on the z-plane can be evaluated from the de Ô¨Ånition, z¬àeTs. Letting s¬àŒ±¬ájœâ, we obtain z¬àeTs¬àeT Œ±¬ájœâ¬Ü¬àeŒ±TejœâT ¬àeŒ±T cosœâT¬ájsinœâT¬Ü ¬àeŒ±T¬ÄœâT 13.47 ¬Ü since cosœâT¬ájsinœâT¬Ü¬à1¬ÄœâT. Each region of the s-plane can be mapped into a corresponding region on the z-plane (see Figure 13.13). Points that have positive values of Œ±are in the right half of the s-plane, FIGURE 13.12 A lathe using digital numerical control726 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:58 region C. From Eq. (13.47), the magnitudes of the mapped points are eŒ±T>1. Thus points in the right half of the s-plane map into points outside the unit circle on the z-plane. Points on the jœâ-axis, region B, have zero values of Œ±and yield points on the z-plane with magnitude =1, the unit circle. Hence, points on the jœâ-axis in the s-plane map into points on the unit circle on the z-plane. Finally, points on the s-plane that yield negative values of Œ±(left‚Äìhalf-plane roots, region A) map into the inside of the unit circle on the z-plane. Thus, a digital control system is (1) stable if all poles of the closed-loop transfer function, T(z), are inside the unit circle on the z-plane; (2) unstable if any pole is outside the unit circle and/or there are poles of multiplicity greater than one on the unit circle; and (3) marginally stable if poles of multiplicity 1 are on the unit circle and all other poles are inside the unit circle. Let us look at an example.CIm s-plane ReIm z-plane Re CAAB B FIGURE 13.13 Mapping regions of the s-plane onto thez-plane Example 13.6 Modeling and StabilityModeling and Stability PROBLEM: The missile shown in Figure 13.14( a) can be aerodynamically controlled by torques created by the de Ô¨Çection of control surfaces on the missile ‚Äôs body. The commands to de Ô¨Çect these control surfaces come from a computer that uses tracking data along with programmed guidance equations to determine whether the missile is on track. The information from the guidance equations is used to develop Ô¨Çight-control commands for the missile. A simpli Ô¨Åed model is shown in Figure 13.14( b). Here the computer performs the function of controller by using tracking information to develop inputcommands to the missile. An accelerometer in the missile detects the actual acceleration,which is fed back to the computer. Find the closed-loop digital transfer function for this system and determine if the system is stable for K¬à20 and K¬à100 with a sampling interval of T¬à0:1 second. SOLUTION: The input to the control system is an acceleration command developed by the computer. The computer can be modeled by a sample-and-hold. The s-plane model is shown in Figure 13.14( c). The Ô¨Årst step in Ô¨Ånding the z-plane model is to Ô¨ÅndG(z), the forward-path transfer function. From Figure 13.14( c)o r( d), G s¬Ü¬à 1 e Ts sKa s s¬áa¬Ü 13.48 ¬Ü13.6 Stability 727WEBC13 10/28/2014 20:49:58 where a¬à27. The z-transform, G(z), is 1 z 1¬ÜzfKa=¬âs2 s¬áa¬Ü¬äg. The term Ka=¬âs2 s¬áa¬Ü¬äisÔ¨Årst expanded by partial fractions, after which we Ô¨Ånd the z-transform of each term from Table 13.1. Hence, zKa s2 s¬áa¬Ü/C26/C27 ¬àKza s2 s¬áa¬Ü/C26/C27 ¬àKz1 s2 1=a s¬á1=a s¬áa/C26/C27 ¬àKTz z 1¬Ü2 z=a z 1¬áz=a z e aT/C26/C27 ¬àKTz z 1¬Ü2  1 e aT¬Üz a z 1¬Ü z e aT¬Ü/C26/C27 13.49 ¬Ü Thus, G z¬Ü¬àKT z e aT¬Ü  z 1¬Ü1 e aT a/C18/C19 z 1¬Ü z e aT¬Ü8 >>< >>:9 >>= >>; 13.50 ¬ÜControl surfaces A/D Computer D/AAmplifier KAirframe dynamics A/DTracking dataMissile acceleration K1 ‚Äì e ‚Äì Ts s27 s(s + 27)+ ‚ÄìAcceleration commandSampleHold AmplifierAirframe dynamicsMissile acceleration Ks27 s(s + 27)+ ‚ÄìAcceleration commandSample AmplifierAirframe dynamicsMissile acceleration(b) (c) (d)(a) 1 ‚Äì e‚Äì TsSample Hold FIGURE 13.14 Finding stability of a missile control system: a.missile; b.conceptual block diagram; c.block diagram; d.block diagram with equivalent single sampler728 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:49:59 In the case of continuous systems, the determination of stability hinges upon our ability to determine whether the roots of t he denominator of the closed-loop transfer function are in the stable region of the s-plane. The problem for high-order systems is complicated by the fact that the closed-loop tr ansfer function denominator is in polyno- mial form, not factored form. The same problem surfaces with closed-loop sampled-data transfer functions. Tabular methods for determining stability, such as the Routh-Hurwitz method used for higher-order continuous systems, exist for sampled-data systems. These methods, whichare not covered in this introductory chapter to digital control systems, can be used todetermine stability in higher-order digital systems. If you wish to go further into the area of digital system stability, you are encouraged to look at Raible ‚Äôs tabular method or Jury ‚Äôs stability test for determining the number of a sampled-data system ‚Äôs closed-loop poles that exist outside the unit circle and thus indicate instability. 2 The following example demonstrates the effect of sampling rate on the stability of a closed-loop feedback control system. All parameters are constant except for the sampling interval, T. We will see that varying Twill lead us through regions of stability and instability just as though we were varying the forward-path gain, K.Letting T¬à0:1 and a¬à27, we have G z¬Ü¬àK 0:0655 z¬á0:02783 ¬Ü z 1¬Ü z 0:0672 ¬Ü 13.51 ¬Ü Finally, we Ô¨Ånd the closed-loop transfer function, T(z), for a unity feedback system: T z¬Ü¬àG z¬Ü 1¬áG z¬Ü¬àK 0:0655 z¬á0:02783 ¬Ü z2¬á 0:0655 K 1:0672 ¬Üz¬á 0:02783 K¬á0:0672 ¬Ü 13.52 ¬Ü The stability of the system is found by Ô¨Ånding the roots of the denominator. For K¬à20, the roots of the denominator are 0 :12j0:78. The system is thus stable for K¬à20, since the poles are inside the unit circle. For K¬à100, the poles are at  0.58 and  4.9. Since one of the poles is outside the unit circle, the system is unstable for K¬à100. Students who are using MATLAB should now run ch13p5 in Appendix B.You will learn how to use MATLAB to determine the range of Kfor stability in a digital system. This exercise solves Example 13.6using MATLAB. Example 13.7 Range of Tfor Stability Range of Tfor Stability PROBLEM: Determine the range of sampling interval, T, that will make the system shown in Figure 13.15 stable, and the range that will make it unstable. SOLUTION: Since H s¬Ü¬à1, the z-transform of the closed-loop system, T(z), is found from Figure 13.10 to be T z¬Ü¬àG z¬Ü 1¬áG z¬Ü 13.53 ¬Ü 2A discussion of Raible ‚Äôs tabular method and Jury‚Äô s stability test can be found in Kuo (1980: 278 ‚Äì286).13.6 Stability 729WEBC13 10/28/2014 20:50:0 We now have found, via the z-plane, that sampled systems are stable if their poles are inside the unit circle. Unfortunately, this stability criterion precludes the use of the Routh- Hurwitz criterion, which detects roots in the right half-plane rather than outside the unitcircle. However, another method exists that allows us to use the familiar s-plane and the Routh-Hurwitz criterion to determine the stability of a sampled system. Let usintroduce this topic. Bilinear Transformations Bilinear transformations give us the ability to apply our s-plane analysis and design techniques to digital systems. We can analyze and design on the s-plane as we have done in Chapters 8 and 9 and then, using these transformations, convert the results to a digitalsystem that contains the same properties. Let us look further into this topic. We can consider z¬àe Tsand its inverse, s¬à 1=T¬Ülnz, as the exact transformations between zands. Thus, if we have G(z) and substitute z¬àeTs, we obtain G eTs¬Üas the result of converting to s. Similarly, if we have G(s) and substitute s¬à 1=T¬Ülnz, we obtain G((1/T)l nz) as the result of converting to z. Unfortunately, both transformations yield transcendental functions, which we of course take care of through the rather complicated z-transform. What we would like is a simple transformation that would yield linear arguments when transforming in both directions (bilinear) through direct substitution and without thecomplicated z-transform. Bilinear transformations of the form z¬àas¬áb cs¬ád 13.57 ¬ÜToÔ¨ÅndG(z),Ô¨ÅrstÔ¨Ånd the partial-fraction expansion of G(s). G s¬Ü¬à101 e Ts s s¬á1¬Ü¬à10 1 e Ts¬Ü1 s 1 s¬á1/C18/C19 13.54 ¬Ü Taking the z-transform, we obtain G z¬Ü¬à10 z 1¬Ü zz z 1 z z e T/C20/C21 ¬à10 1 e T¬Ü z e T¬Ü 13.55 ¬Ü Substituting Eq. (13.55) into (13.53) yields T z¬Ü¬à10 1 e T¬Ü z  11e T 10¬Ü 13.56 ¬Ü The pole of Eq. (13.56), 11e T 10¬Ü, monotonically decreases from +1t o  1 for 0<T<0:2. For 0 :2<T<‚àû; 11e T 10¬Ümonotonically decreases from  1t o  10. Thus, the pole of T(z) will be inside the unit circle, and the system will be stable if 0<T<0:2. In terms of frequency, where f¬à1=T, the system will be stable as long as the sampling frequency is 1 =0:2¬à5 hertz or greater.C(s) R(s) + ‚ÄìPlant Hold T1‚Äì e‚ÄìTs s10 s + 1 FIGURE 13.15 Digital system for Example 13.7730 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:0 and its inverse, s¬à dz¬áb cz a 13.58 ¬Ü have been derived to yield linear variables in sandz. Different values of a,b,c, and dhave been derived for particular applications and yield various degrees of accuracy when comparing properties of the continuous and sampled functions. For example, in the next subsection we will see that a particular choice of coef Ô¨Åcients will take points on the unit circle and map them into points on the jœâ-axis. Points outside the unit circle will be mapped into the right half-plane, and points inside the unit circle will bemapped into the left half-plane. Thus, we will be able to make a simple transformation fromthez-plane to the s-plane and obtain stability information about the digital system by working in the s-plane. Since the transformations are not exact, only the property for which they are designed can be relied upon. For the stability transformation just discussed, we cannot expect theresulting G(s) to have the same transient response as G(z). Another transformation will be covered that will retain that property. Digital System Stability via the s-Plane In this subsection, we look at a bilinear transformation that maps jœâ-axis points on the s-plane to unit-circle points on the z-plane. Further, the transformation maps right ‚Äìhalf- plane points on the s-plane to points outside the unit circle on the z-plane. Finally, the transformation maps left ‚Äìhalf-plane points on the s-plane to points inside the unit circle on thez-plane. Thus, we are able to transform the denominator of the pulsed transfer function, D(z), to the denominator of a continuous transfer function, D(s), and use the Routh-Hurwitz criterion to determine stability. The bilinear transformation s¬àz¬á1 z 1 13.59 ¬Ü and its inverse z¬às¬á1 s 1 13.60 ¬Ü perform the required transformation ( Kuo,1995 ). We can show this fact as follows: Letting s¬àŒ±¬ájœâand substituting into Eq. (13.60), z¬à Œ±¬á1¬Ü¬ájœâ Œ± 1¬Ü¬ájœâ 13.61 ¬Ü from which jzj¬àÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Œ±¬á1¬Ü2¬áœâ2q Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Œ± 1¬Ü2¬áœâ2q 13.62 ¬Ü Thus, jzj<1 when Œ±<0 (13.63a) jzj>1 when Œ±>0 (13.63b)13.6 Stability 731WEBC13 10/28/2014 20:50:1 and jzj¬à1 when Œ±¬à0 (13.63c) Let us look at an example that shows how the stability of sampled systems can be found using this bilinear transformation and the Routh-Hurwitz criterion. Example 13.8 Stability via Routh-HurwitzStability via Routh-Hurwitz PROBLEM: Given T z¬Ü¬àN z¬Ü=D z¬Ü,w h e r e D z¬Ü¬àz3 z2 0:2z¬á0:1, use the Routh-Hurwitz criterion to Ô¨Ånd the number of z-plane poles of T(z) inside, outside, and on the unit circle. Is the system stable? SOLUTION: Substitute Eq. (13.60) into D z¬Ü¬à0 and obtain3 s3 19s2 45s 17¬à0 13.64 ¬Ü The Routh table for Eq. (13.64), Table 13.3, shows one root in the right ‚Äìhalf-plane and two roots in the left ‚Äìhalf-plane. Hence, T(z) has one pole outside the unit circle, no poles on the unit circle, and two poles inside the unit circle. The system is unstable because of the pole outside the unit circle. TABLE 13.3 Routh table for Example 13.8 s31  45 s219  17 s1 45.89 0 s0 17 0 Skill-Assessment Exercise 13.5 PROBLEM: Determine the range of sampling interval, T, that will make the system shown in Figure 13.16 stable. ANSWER: 0<T<0:1022 second The complete solution is located at www.wiley.com/college/nise .C(s) R(s) + ‚ÄìPlant Hold T1‚Äìe‚ÄìTs s20 s + 5FIGURE 13.16 Digital system for Skill-Assessment Exercise 13.5 3Symbolic math software, such as MATLAB ‚Äôs Symbolic Math Toolbox, is recommended to reduce the labor required to perform the transformation.732 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:2 In this section, we covered the concepts of stability for digital systems. Both z- and s-plane perspectives were discussed. Using a bilinear transformation, we are able to use the Routh-Hurwitz criterion to determine stability. The highlight of the section is that sampling rate (along with system parameters, such as gain and component values) helps to determine or destroy the stability of a digital system. In general, if the sampling rate is too slow, the closed-loop digital system will be unstable.We now move from stability to steady-state errors, paralleling our previous discussion ofsteady-state errors in analog systems. 13.7 Steady-State Errors We now examine the effect of sampling upon the steady-state error for digital systems. Anygeneral conclusion about the steady-state error is dif Ô¨Åcult because of the dependence of those conclusions upon the placement of the sampler in the loop. Remember that theposition of the sampler could change the open-loop transfer function. In the discussion ofanalog systems, there was only one open-loop transfer function, G(s), upon which the general theory of steady-state error was based and from which came the standard de Ô¨Ånitions of static error constants. For digital systems, however, the placement of the sampler changes the open-loop transfer function and thus precludes any general conclusions. In this section, we assume the typical placement of the sampler after the error and in the position of thecascade controller, and we derive our conclusions accordingly about the steady-state error ofdigital systems. Consider the digital system in Figure 13.17( a), where the digital computer is represented by the sampler and zero-order hold. The transfer function of the plant isrepresented by G 1(s) and the transfer function of the z.o.h. by 1 e Ts¬Ü=s. Letting G(s) equal the product of the z.o.h. and G1(s), and using the block diagram reduction techniques for sampled-data systems, we can Ô¨Ånd the sampled error, E* s¬Ü¬àE z¬Ü. Adding synchronous samplers at the input and the feedback, we obtain Figure 13.17( b). Pushing G(s) and its input sampler to the right past the pickoff point yields Figure 13.17( c). Using Figure 13.9( a), we can convert each block to its z-transform, resulting in Figure 13.17( d). From this Ô¨Ågure, E z¬Ü¬àR z¬Ü E z¬ÜG z¬Ü,o r E z¬Ü¬àR z¬Ü 1¬áG z¬Ü 13.65 ¬Ü TheÔ¨Ånal value theorem for discrete signals states that e* ‚àû¬Ü¬àlim z¬Æ1 1 z 1¬ÜE z¬Ü 13.66 ¬ÜSkill-Assessment Exercise 13.6 PROBLEM: Given T z¬Ü¬àN z¬Ü=D z¬Ü, where D z¬Ü¬àz3 z2 0:5z¬á0:3, use the Routh-Hurwitz criterion to Ô¨Ånd the number of z-plane poles of T(z) inside, outside, and on the unit circle. Is the system stable? ANSWER: T(z) has one pole outside the unit circle, no poles on the unit circle, and two poles inside the unit circle. The system is unstable. The complete solution is located at www.wiley.com/college/nise .13.7 Steady-State Errors 733WEBC13 10/28/2014 20:50:2 where e* ‚àû¬Üis the Ô¨Ånal sampled value of e(t), or (alternatively) the Ô¨Ånal value of e(kT).4 Using the Ô¨Ånal value theorem on Eq. (13.65), we Ô¨Ånd that the sampled steady-state error, e* ‚àû¬Ü, for unity negative-feedback systems is e* ‚àû¬Ü¬àlim z¬Æ1 1 z 1¬ÜE z¬Ü¬àlim z¬Æ1 1 z 1¬ÜR z¬Ü 1¬áG z¬Ü 13.67 ¬Ü Equation (13.67) must now be evaluated for each input: step, ramp, and parabola. Unit Step Input For a unit step input, R s¬Ü¬à1=s. From Table 13.1, R z¬Ü¬àz z 1 13.68 ¬Ü Substituting Eq. (13.68) into Eq. (13.67), we have e* ‚àû¬Ü¬à1 1¬álim z¬Æ1G z¬Ü 13.69 ¬Ü(b) C(s) R*(s)+ ‚Äì TR(s) TG(s)C*(s) T T TG(s) (c) C(z) R(z) + ‚ÄìG(z) G(z) (d)C(s) R*(s)+ ‚Äì TR(s) TG(s) T T(a)C(s) + ‚Äì TR(s)G1(s)E*(s) E*(s) E*(s)1 ‚Äì e‚ÄìTs s E*(s) E*(s) E(z) Note: Phantom sam plers are shown in color.C*(s) FIGURE 13.17 a.Digital feedback control system for evaluation of steady-state errors; b.phantom samplers added; c.pushing G(s) and its samplers to the right past the pickoff point; d.z-transform equivalent system 4SeeOgata (1987: 59 ) for a derivation.734 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:2 DeÔ¨Åning the static error constant, Kp,a s Kp¬àlim z¬Æ1G z¬Ü 13.70 ¬Ü we rewrite Eq. (13.69) as e* ‚àû¬Ü¬à1 1¬áKp 13.71 ¬Ü Unit Ramp Input For a unit ramp input, R z¬Ü¬àTz= z 1¬Ü2. Following the procedure for the step input, you can derive the fact that e* ‚àû¬Ü¬à1 Kv 13.72 ¬Ü where Kv¬à1 Tlim z¬Æ1 z 1¬ÜG z¬Ü 13.73 ¬Ü Unit Parabolic Input For a unit parabolic input, R z¬Ü¬àT2z= z¬á1¬Ü=¬â2 z 1¬Ü3¬ä. Similarly, e* ‚àû¬Ü¬à1 Ka 13.74 ¬Ü where Ka¬à1 T2lim z¬Æ1 z 1¬Ü2G z¬Ü 13.75 ¬Ü Summary of Steady-State Errors The equations developed above for e* ‚àû¬Ü,Kp,Kv, and Kaare similar to the equations developed for analog systems. Whereas multiple pole placement at the origin of the s-plane reduced steady-state errors to zero in the analog case, we can see that multiple pole placement at z¬à1 reduces the steady-state error to zero for digital systems of the type discussed in this section. This conclusion makes sense when one considers that s¬à0 maps intoz¬à1 under z¬àeTs. For example, for a step input, we see that if G(z) in Eq. (13.69) has one pole at z¬à1, the limit will become in Ô¨Ånite, and the steady-state error will reduce to zero. For a ramp input, if G(z) in Eq. (13.73) has two poles at z¬à1, the limit will become inÔ¨Ånite, and the error will reduce to zero. Similar conclusions can be drawn for the parabolic input and Eq. (13.75). Here, G(z) needs three poles at z¬à1 in order for the steady-state error to be zero. Let us look at an example.13.7 Steady-State Errors 735WEBC13 10/28/2014 20:50:3 Example 13.9 Finding Steady-State ErrorFinding Steady-State Error PROBLEM: For step, ramp, and parabolic inputs, Ô¨Ånd the steady-state error for the feedback control system shown in Figure 13.17( a)i f G1 s¬Ü¬à10 s s¬á1¬Ü 13.76 ¬Ü SOLUTION: FirstÔ¨ÅndG(s), the product of the z.o.h. and the plant. G s¬Ü¬à10 1 e Ts¬Ü s2 s¬á1¬Ü¬à10 1 e Ts¬Ü1 s2 1 s¬á1 s¬á1/C20/C21 13.77 ¬Ü Thez-transform is then G z¬Ü¬à10 1 z 1¬ÜTz z 1¬Ü2 z z 1¬áz z e T/C20/C21 ¬à10T z 1 1¬áz 1 z e T/C20/C21 13.78 ¬Ü For a step input, Kp¬àlim z¬Æ1G z¬Ü¬à‚àû;e* ‚àû¬Ü¬à1 1¬áKp¬à0 13.79 ¬Ü For a ramp input, Kv¬à1 Tlim z¬Æ1 z 1¬ÜG z¬Ü¬à10;e* ‚àû¬Ü¬à1 Kv¬à0:1 13.80 ¬Ü For a parabolic input, Ka¬à1 T2lim z¬Æ1 z 1¬Ü2G z¬Ü¬à0;e* ‚àû¬Ü¬à1 Ka¬à‚àû 13.81 ¬Ü You will notice that the answers obtained are the same as the results obtained for the analog system. However, since stability depends upon the sampling interval, be sure to check the stability of the system after a sampling interval is established before makingsteady-state error calculations. Students who are using MATLAB should now run ch13p6 in Appendix B.You will learn how to use MATLAB to determine K p,Kv, and Kain a digital system as well as check the stability. This exercise sol-ves Example 13.9 using MATLAB. Skill-Assessment Exercise 13.7 PROBLEM: For step, ramp, and parabolic inputs, Ô¨Ånd the steady-state error for the feedback control system shown in Figure 13.17( a)i f G1 s¬Ü¬à20 s¬á3¬Ü s¬á4¬Ü s¬á5¬Ü LetT¬à0:1 second. Repeat for T¬à0:5 second. ANSWER: ForT¬à0:1 second, Kp¬à3;Kv¬à0, and Ka¬à0; for T¬à0:5 second, the system is unstable. The complete solution is located at www.wiley.com/college/nise .736 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:4 In this section, we discussed and evaluated the steady-state error of digital systems for step, ramp, and parabolic inputs. The equations for steady-state error parallel those for analog systems. Even the de Ô¨Ånitions of the static error constants were similar. Poles at the origin of the s-plane for analog systems were replaced with poles at +1 on the z-plane to improve the steady-state error. We continue our parallel discussion by moving into adiscussion of transient response and the root locus for digital systems. 13.8 Transient Response on the z-Plane Recall that for analog systems a transient response requirement was speci Ô¨Åed by selecting a closed-loop, s-plane pole. In Chapter 8, the closed-loop pole was on the existing root locus, and the design consisted of a simple gain adjustment. If the closed-loop pole was not on the existing root locus, then a cascade compensator was designed to reshape the original root locus to go through the desired closed-loop pole. A gain adjustment then completedthe design. In the next two sections, we want to parallel the described analog methods and apply similar techniques to digital systems. For this introductory chapter, we will parallel thediscussion through design via gain adjustment. The design of compensation is left to you topursue in an advanced course. Chapter 4 established the relationships between transient response and the s-plane. We saw that vertical lines on the s-plane were lines of constant settling time, horizontal lines were lines of constant peak time, and radial lines were lines of constant percent overshoot.In order to draw equivalent conclusions on the z-plane, we now map those lines through z¬àe sT. The vertical lines on the s-plane are lines of constant settling time and are character- ized by the equation s¬àœÉ1¬ájœâ, where the real part, œÉ1¬à 4=Ts, is constant and is in the left‚Äìhalf-plane for stability. Substituting this into z¬àesT, we obtain z¬àeœÉ1TejœâT¬àr1ejœâT 13.82 ¬Ü Equation (13.82) denotes concentric circles of radius r1.I fœÉ1is positive, the circle has a larger radius than the unit circle. On the other hand, if œÉ1is negative, the circle has a smaller radius than the unit circle. The circles of constant settling time, normalized to the sampling interval, are shown in Figure 13.18 with radius eœÉ1T¬àe 4= Ts=T¬Ü. Also, Ts=T¬à 4=ln r¬Ü, where ris the radius of the circle of constant settling time. The horizontal lines are lines of constant peak time. The lines are characterized by the equation s¬àœÉ¬ájœâ1, where the imaginary part, œâ1¬àœÄ=Tp, is constant. Substituting this intoz¬àesT, we obtain z¬àeœÉTejœâ1T¬àeœÉTejŒ∏1 13.83 ¬Ü Equation (13.83) represents radial lines at an angle of Œ∏1.I fœÉis negative, that section of the radial line lies inside the unit circle. If œÉis positive, that section of the radial line lies outside the unit circle. The lines of constant peak time normalized to the sampling interval are shown in Figure 13.18. The angle of each radial line is œâ1T¬àŒ∏1¬àœÄ= Tp=T¬Ü, from which Tp=T¬àœÄ=Œ∏1. Finally, we map the radial lines of the s-plane onto the z-plane. Remember, these radial lines are lines of constant percent overshoot on the s-plane. From Figure 13.19, these radial lines are represented by œÉ œâ¬à tan sin 1Œ∂¬Ü¬à Œ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p 13.84 ¬Ü13.8 Transient Response on the z-Plane 737WEBC13 10/28/2014 20:50:4 Hence, s¬àœÉ¬ájœâ¬à œâŒ∂Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬ájœâ 13.85 ¬Ü Transforming Eq. (13.85) to the z-plane yields z¬àesT¬àe œâTŒ∂/Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É Ô¨É 1 Œ∂2p/C0/C1 ejœâT¬àe œâTŒ∂/Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p/C0/C1 ¬ÄœâT 13.86 ¬Ü = 0.3 ‚Äì0.4Im ReTp/T = 20Tp/T = 10Tp/T = 5 Tp/T = 7Tp/T = 4Tp/T = 3 z = 0 ‚Äì1‚Äì1 Ts/T = 3 Ts/T = 5‚Äì0.2 ‚Äì0.4 ‚Äì0.6 ‚Äì0.8Ts/T = 10 Ts/T = 201 0.8 0.6 0.4 0 0.2 ‚Äì0.8 ‚Äì0.2 = 0.5 = 0.7 = 0.1 ‚Äì0.6 = 0.91 0.8 0.6 = 0.2 0.4 0.2 Ts/T = 2Œ∂ Œ∂Œ∂Œ∂ Œ∂ Œ∂ Œ∂ FIGURE 13.18 Constant damping ratio, normalized settling time, and normalized peak time plots on the z-plane Constant percent overshoot linej s-plane œÉsin‚Äì1 cos‚Äì1œâ s = œÉ + jœâ Œ∂ Œ∂ FIGURE 13.19 Thes-plane sketch of constant percentovershoot line738 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:4 Thus, given a desired damping ratio, Œ∂, Eq. (13.86) can be plotted on the z-plane through a range of œâTas shown in Figure 13.18. These curves can then be used as constant percent overshoot curves on the z-plane. This section has set the stage for the analysis and design of transient response for digital systems. In the next section, we apply the results to digital systems using the root locus. 13.9 Gain Design on the z-Plane In this section, we plot root loci and determine the gain required for stability aswell as the gain required to meet a transient response requirement. Since the open-loop and closed-loop transfer functions for the generic digital system shown inFigure 13.20 are identical to the continuous system except for a change invariables from stoz, we can use the same rules for plotting a root locus. However, from our previous discussion, the region of stability on the z-plane is within the unit circle and not the left half-plane. Thus, in order to determinestability, we must search for the intersection of the root locus with the unit circlerather than the imaginary axis. In the last section, we derived the curves of constant settling time, peak time, and damping ratio. In order to design a digital system for transient response, weÔ¨Ånd the intersection of the root locus with the appropriate curves as they appear on thez-plane in Figure 13.18. Let us look at the following example.R(z) ‚ÄìG(z) H(z)C(z) + FIGURE 13.20 Generic digital feedback control system Example 13.10 Stability Design via Root LocusStability Design via Root Locus PROBLEM: Sketch the root locus for the system shown in Figure 13.21. Also, determine the range of gain, K, for stability from the root locus plot. SOLUTION: Treat the system as if zwere s, and sketch the root locus. The result is shown in Figure 13.22. Using the root locus program discussed in Appendix H.2 at www.wiley.com/college/nise, search along the unit circle for 180 ¬∞.I d e n t i Ô¨Åcation of the gain, K, at this point yields the range of gain for stability. Using the program, we Ô¨Ånd that the intersection of the root locus with the unit circle is 1 ¬Ä60 ¬∞. The gain at this point is 0.5. Hence, the range of gain for stability is 0 <K<0:5. Students who are using MATLAB should now run ch13p7 in Appendix B. You will learn how to use MATLAB to plot a root locus on the z-plane as well as superimpose the unit circle. You will learn how to select interactively the intersection of the root locusand the unit circle to obtain the value of gain for stability.This exercise solves Example 13.10 using MATLAB.K(z + 1) (z ‚Äì 1)(z ‚Äì 0.5)+ ‚ÄìR(z) C(z) FIGURE 13.21 Digital feedback control for Example 13.1013.9 Gain Design on the z-Plane 739WEBC13 10/28/2014 20:50:5 In the next example, we design the value of gain, K, in Figure 13.21 to meet a transient response speci Ô¨Åcation. The problem is handled similarly to the analog system design, where we found the gain at the point where the root locus crossed the speci Ô¨Åed damping ratio, settling time, or peak time curve. In digital systems, these curves are as shown in Figure 13.18. In summary, then, draw the root locus of the digital system and superimposethe curves of Figure 13.18. Then Ô¨Ånd out where the root locus intersects the desired damping ratio, settling time, or peak time curve and evaluate the gain at that point. In order to simplifythe calculations and obtain more accurate results, draw a radial line through the point where the root locus intersects the appropriate curve. Measure the angle of this line and use the root locus program in Appendix H.2 at www.wiley.com/college/nise to search along this radial line for the point of intersection with the root locus.‚Äì3.00 ‚Äì1.50 0 1.50 3.00 ‚Äì3.00‚Äì2.252.253.00 z-plane Unit circle Root locusReIm ‚Äì0.750.75 ‚Äì1.501.50 FIGURE 13.22 Root locus for the system of Figure 13.21 Example 13.11 Transient Response Design via Gain AdjustmentTransient Response Design via Gain Adjustment PROBLEM: For the system of Figure 13.21, Ô¨Ånd the value of gain, K, to yield a damping ratio of 0.7. SOLUTION: Figure 13.23 shows the constant damping ratio curves superimposed over the root locus for the system as determined from the last example. Draw a radial line from the origin to the intersection of the root locus with the 0.7 damping ratio curve (a 16.62 ¬∞ line). The root locus program discussed in Appendix H.2 at www.wiley.com/college/nise can now be used to obtain the gain by searching along a 16.62 ¬∞line for 180 ¬∞, the intersection with the root locus. The results of the program show that the gain, K, is 0.0627 at 0:719¬áj0:215, the point where the 0.7 damping ratio curve intersects the root locus.740 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:5 We can now check our design by Ô¨Ånding the unit sampled step response of the system of Figure 13.21. Using our design, K¬à0:0627, along with R z¬Ü¬àz= z 1¬Ü,a sampled step input, we Ô¨Ånd the sampled output to be C z¬Ü¬àR z¬ÜG z¬Ü 1¬áG z¬Ü¬à0:0627 z2¬á0:0627 z z3 2:4373 z2¬á2z 0:5627 13.87 ¬Ü Performing the indicated division, we obtain the output valid at the sampling instants, as shown in Figure 13.24. Since the overshoot is approximately 5%, the requirement of a 0.7damping ratio has been met. You should remember, however, that the plot is valid only atinteger values of the sampling instants. Students who are using MATLAB should now run ch13p8 in Appendix B.You will learn how to use MATLAB to plot a root locus on the z-plane as well as superimpose a grid of damping ratio curves. You willlearn how to obtain the gain and a closed-loop step response of adigital system after interactively selecting the operating pointon the root locus. This exercise solves Example 13.11 using MATLAB.z-plane= 0.7Root locus 16.62¬∞ 0.1 0.3 0.5 0.9 1.1Im Re0.5 0.40.30.20.1 0 0.2 0.4 0.6 0.8 1.0 1.2 ‚Äì0.1 ‚Äì0.2 ‚Äì0.3 ‚Äì0.4 ‚Äì0.51.3 0.7Œ∂ FIGURE 13.23 Root locus for the system of Figure 13.21 with constant 0.7 damping ratio curve 0.1 00.20.30.40.50.60.70.80.9 1.01.1 0 2 4 6 8 1 01 21 41 61 82 0 Sampling instantc*(t) Note: Valid onl y at inte ger values of sam pling instantFIGURE 13.24 Sampled step response of the system of Figure 13.21 with K¬à0:062713.9 Gain Design on the z-Plane 741WEBC13 10/28/2014 20:50:6 Simulink provides an alternative method of simulating digital systems to obtain the time response. Students who are performingthe MATLAB exercises and want to explore the added capability ofSimulink should now consult Appendix C, Simulink Tutorial. Exam-ple C.4 in the tutorial shows how to use Simulink to simulatedigital systems. MATLAB ‚Äôs LTI Viewer provides another method of simulating digital systems to obtain the time response. Students who are performingthe MATLAB exercises and want to explore the added capability ofMATLAB ‚Äôs LTI Viewer should now consult Appendix E at www.wiley .com/college/nise , which contains a tutorial on the LTI Viewer as well as some examples. One of the illustrative examples, ExampleE.5, Ô¨Ånds the closed-loop step response of a digital system using the LTI Viewer. In this section, we used the root locus and gain adjustment to design the transient response of a digital system. This method suffers the same drawbacks as when it was appliedto analog systems; namely, if the root locus does not intersect a desired design point, then asimple gain adjustment will not accomplish the design objective. Techniques to designcompensation for digital systems can then be applied. 13.10 Cascade Compensation via the s-Plane In previous sections of this chapter, we anal yzed and designed digital systems directly in the z- d o m a i nu pt oa n di n c l u d i n gd e s i g nv i a gain adjustment. We are now ready to design digital compensators, such as those covered in Chapters 9 and 11. Rather thancontinuing on this path of design directly in the z-domain, we depart by covering analysis and design techniques that allow us to make use of previous chapters byd e s i g n i n go nt h e s-plane and then transforming our s-plane design to a digital implementation. We covered one aspect of s-plane analysis in Section 13.6, whereSkill-Assessment Exercise 13.8 PROBLEM: For the system of Figure 13.20 where H z¬Ü¬à1 and G z¬Ü¬àK z¬á0:5¬Ü z 0:25¬Ü z 0:75¬Ü Ô¨Ånd the value of gain, K, to yield a damping ratio of 0.5. ANSWER: K¬à0:31 The complete solution is at www.wiley.com/college/nise .TryIt 13.3 Use MATLAB, the Control System Toolbox, and the following statements tosolve Skill-Assessment Exercise 13.8. Gz=zpk(  0.5, [0.25,0.75] ,... 1 ,[] ) rlocus(Gz) zgrid(0.5, [] ) [K,p] =rloc Ô¨Ånd(Gz) Note: When the root locus appears, click on the intersection of the 0.5 dampingratio curve and the root locus to calculate the gain.742 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:6 we used a bilinear transformation to ana lyze stability. We now continue with s-plane analysis and design by applying i t to cascade compensator design. Direct design of compensators on the z-plane is left for a dedicate d course in digital control systems. Cascade Compensation In order to perform design in the s-plane and then convert the continuous compensator to a digital compensator, we need a bilinear transformation that will preserve, at the sampling instants, the response of the continuous compensator. The bilinear transformation coveredin Section 13.6 will not meet that requirement. A bilinear transformation that can beperformed with hand calculations and yields a digital transfer function whose outputresponse at the sampling instants is approximately the same as the equivalent analog transfer function is called the Tustin transformation . This transformation is used to transform the continuous compensator, G c(s), to the digital compensator, Gc(z). The Tustin transformation is given by5 s¬à2 z 1¬Ü T z¬á1¬Ü 13.88 ¬Ü and its inverse by z¬à s¬á2 T/C18/C19 s 2 T/C18/C19 ¬à1¬áT 2s 1 T 2s 13.89 ¬Ü As the sampling interval, T, gets smaller (higher sampling rate), the designed digital compensator ‚Äôs output yields a closer match to the analog compensator. If the sampling rate is not high enough, there is a discrepancy at higher frequencies between the digital and analog Ô¨Ålters‚Äôfrequency responses. Methods are available to correct the discrepancy, but they are beyond the scope of our discussion. The interested reader should investigate the topic of prewarping , covered in books dedicated to digital control and listed in the Bibliography at the end of this chapter. Astrom and Wittenmark (1984 ) have developed a guideline for selecting the sampling interval, T. Their conclusion is that the value of Tin seconds should be in the range 0:15=œâŒ¶Mto 0: 5=œâŒ¶M, where œâŒ¶Mis the zero dB frequency (rad/s) of the magnitude frequency response curve for the cascaded analog compensator and plant. In the following example, we will design a compensator, Gc(s), to meet the required performance speci Ô¨Åcations. We will then use the Tustin transformation to obtain the model for an equivalent digital controller. In the next section, we will show how to implement the digital controller. 5SeeOgata (1987: 315 ‚Äì318) for a derivation.13.10 Cascade Compensation via the s-Plane 743WEBC13 10/28/2014 20:50:7 Example 13.12 Digital Cascade Compensator DesignDigital Cascade Compensator Design PROBLEM: For the digital control system of Figure 13.25(a ), where Gp s¬Ü¬à1 s s¬á6¬Ü s¬á10¬Ü 13.90 ¬Ü design a digital lead compensator, Gc(z), as shown in Figure 13.25( c), so that the system will operate with 20% overshoot and a settling time of 1.1 seconds. Create your design in the s-domain and transform the compensator to the z-domain. SOLUTION: Using Figure 13.25( b), design a lead compensator using the techniques described in Chapter 9 or 11. The design was created as part of Example 9.6, where we found that the lead compensator was Gc s¬Ü¬à1977 s¬á6¬Ü s¬á29:1¬Ü 13.91 ¬ÜGc(z)Digital lead compensator (c)Gp(z)Plant with sample-and-hold + ‚ÄìR(z) E(z) C(z)Gc(s)Lead compensator (b)Gp(s)Plant + ‚ÄìR(s) E(s) C(s)D/A A/DDigital computerDigital controller (a)Gp(s)Plant + ‚ÄìR(s) E(s) C(s) FIGURE 13.25 a.Digital control system showing the digital computer performing compensation; b.continuous system used for design; c.transformed digital system744 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:7 Using Eqs. (13.90) and (13.91), we Ô¨Ånd that the zero dB frequency, œâŒ¶M, forGp(s)Gc(s)i s 5.8 rad/s. Using the guideline described by Astrom and Wittenmark (1984 ), the lowest value ofTshould be in the range 0 :15=œâŒ¶M¬à0:026 to 0 :5=œâŒ¶M¬à0:086 second. Let us use T¬à0:01 second. Substituting Eq. (13.88) into Eq. (13.91) with T¬à0:01 second yields Gc z¬Ü¬à1778 z 1674 z 0:746 13.92 ¬Ü The z-transform of the plant and zero-order hold, found by the method discussed in Section 13.4 with T¬à0:01 second, is Gp z¬Ü¬à 1:60210 7z2¬Ü¬á 6:15610 7z¬Ü¬á 1:47810 7¬Ü z3 2:847z2¬á2:699z 0:8521 13.93 ¬Ü The time response in Figure 13.26 ( T¬à0:01 s) shows that the compensated closed-loop system meets the transi ent response requirements. The Ô¨Ågure also shows the response for a compensator designed wi th sampling times at the extremes of Astrom and Wittenmark‚Äô s guideline. Students who are using MATLAB should now run ch13p9 in Appendix B. You will learn how to use MATLAB to design a digital lead compen- sator using the Tustin transformation. This exercise solves Example 13.12 using MATLAB. 1.4T = 0.086 s T = 0.026 s T = 0.01 s1.2 1 0.8c*(t) 0.6 0.40.2 0 0 0.5 1 Time (seconds) Note: Valid onl y at inte ger values of sam pling instant1.5 2 FIGURE 13.26 Closed-loop response for the compensated system of Example 13.12 showing effect of three different sampling frequencies13.10 Cascade Compensation via the s-Plane 745WEBC13 10/28/2014 20:50:8 Now that we have learned how to design a digital cascade compensator, Gc(z), the next section will teach us how to use the digital computer to implement it. 13.11 Implementing the Digital Compensator The controller, Gc(z), can be implemented directly via calculations within the digital computer in the forward path as shown in Figure 13.27. Let us now derive a numerical algorithm that the computer can use to emulate the compensator. We will Ô¨Ånd an expression for the computer ‚Äôs sampled output, x* t¬Ü, whose transforms are shown in Figure 13.27 as X(z). We will see that this expression can be used to program the digital computer to emulate the compensator. Consider a second-order compensator, Gc(z), Gc z¬Ü¬àX z¬Ü E z¬Ü¬àa3z3¬áa2z2¬áa1z¬áa0 b2z2¬áb1z¬áb0 13.94 ¬Ü Cross-multiplying, b2z2¬áb1z¬áb0¬ÜX z¬Ü¬à a3z3¬áa2z2¬áa1z¬áa0¬ÜE z¬Ü 13.95 ¬Ü Solving for the term with the highest power of zoperating on the output, X(z), b2z2X z¬Ü¬à a3z3¬áa2z2¬áa1z¬áa0¬ÜE z¬Ü  b1z¬áb0¬ÜX z¬Ü 13.96 ¬ÜSkill-Assessment Exercise 13.9 PROBLEM: In Example 11.3, a lead compensator was designed for a unity feedback system whose plant was G s¬Ü¬à100K s s¬á36¬Ü s¬á100¬Ü Thedesignspeci Ô¨Åcationswereasfollows:percent overshoot =20%,peaktime =0.1second, andKv¬à40. In order to meet the requirements, the design yielded K¬à1440 and a lead compensator, Gc s¬Ü¬à2:38s¬á25:3 s¬á60:2 If the system is to be computer controlled, Ô¨Ånd the digital controller, Gc(z). ANSWER: Gc z¬Ü¬à2:34z 0:975 z 0:9416;T¬à0:001 second The complete solution is at www.wiley.com/college/nise . Gc(z) G(z)Plant with sample-and-holdComputer emulating compensator E(z) X(z) C(z)FIGURE 13.27 Block diagram showing computer emulation of a digital compensator746 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:8 Dividing by the coef Ô¨Åcient of X(z) on the left-hand side of Eq. (13.96) yields X z¬Ü¬àa3 b2z¬áa2 b2¬áa1 b2z 1¬áa0 b2z 2/C18/C19 E z¬Ü b1 b2z 1¬áb0 b2z 2/C18/C19 X z¬Ü 13.97 ¬Ü Finally, taking the inverse z-transform, x* t¬Ü¬àa3 b2e* t¬áT¬Ü¬áa2 b2e* t¬Ü¬áa1 b2e* t T¬Ü¬áa0 b2e* t 2T¬Ü  b1 b2x* t T¬Ü b0 b2x* t 2T¬Ü 13.98 ¬Ü We can see from this equation that the present sample of the compensator output, x* t¬Ü,i sa function of future e* t¬áT¬Ü¬Ü, present e* t¬Ü¬Ü,p a s t e* t T¬Ü¬Ü, and e* t 2T¬Ü¬Üsamples of e(t), along with past values of the output, x* t T¬Üandx* t 2T¬Ü. Obviously, if we are to physically realize this compensator, the output sample cannot be dependent upon future values of the input. Hence, to be physically realizable, a3must equal zero for the future value ofe(t) to be zero. We conclude that the numerator of the compensator ‚Äôs transfer function must be of equal or lower order than the denominator in order that the compensator bephysically realizable. Now assume that a 3does indeed equal zero. Equation (13.98) now becomes x* t¬Ü¬àa2 b2e* t¬Ü¬áa1 b2e* t T¬Ü¬áa0 b2e* t 2T¬Ü b1 b2x* t T¬Ü b0 b2x* t 2T¬Ü 13.99 ¬Ü Hence, the output sample is a function of current and past input samples of the input as wellas past samples of the output. Figure 13.28 shows the Ô¨Çowchart of the compensator from which a program can be written for the digital computer. 7TheÔ¨Ågure shows that the compensator can be implemented by storing several successive values of the input andoutput. The output is then formed by a weighted linear combination of these storedvariables. Let us now look at a numerical example.Delay T secondse*(t) e*(t‚ÄìT) Delay T seconds e*(t‚Äì2T)+ + ++ a0 b2a1 b2a2 b2 Delay T secondsx*(t) x*(t‚ÄìT) Delay T seconds x*(t‚Äì2T)‚Äì ‚Äì b0 b2b1 b2 FIGURE 13.28 Flowchart for a second-order digital compensator6 6Adapted from Chassing, R. Digital Signal Processing (New York: John Wiley & Sons, Inc., 1999), p. 137. ÓÄÇ1999 John Wiley & Sons, Inc. 7For an excellent discussion on basic Ô¨Çowcharts to represent digital compensators, including the representation shown in Figure 13.28 and alternative Ô¨Çowcharts with half as many delays, see Chassaing (1999, pp. 135 ‚Äì143).13.11 Implementing the Digital Compensator 747WEBC13 10/28/2014 20:50:9 Example 13.13 Digital Cascade Compensator ImplementationDigital Cascade Compensator Implementation PROBLEM: Develop a Ô¨Çowchart for the digital compensator de Ô¨Åned by Eq. (13.100). Gc z¬Ü¬àX z¬Ü E z¬Ü¬àz¬á0:5 z2 0:5z¬á0:7 13.100 ¬Ü SOLUTION: Cross-multiply and obtain z2 0:5z¬á0:7¬ÜX z¬Ü¬à z¬á0:5¬ÜE z¬Ü 13.101 ¬Ü Solve for the highest power of zoperating on the output, X(z), z2X z¬Ü¬à z¬á0:5¬ÜE z¬Ü    0:5z¬á0:7¬ÜX z¬Ü 13.102 ¬Ü Solving for X(z) on the left-hand side, X z¬Ü¬à z 1¬á0:5z 2¬ÜE z¬Ü    0:5z 1¬á0:7z 2¬ÜX z¬Ü 13.103 ¬Ü Implementing Eq. (13.103) with the Ô¨Çowchart of Figure 13.29 completes the design. + ++ ‚Äì‚Äì Delay T secondsDelay T secondsDelay T seconds Delay T secondse*(t) e*(t‚ÄìT) x*(t‚ÄìT) x*(t‚Äì2T )x*(t) e*(t‚Äì2T )1 0.5 0.7‚Äì0.5 FIGURE 13.29 Flowchart to implement8 Gc z¬Ü¬àz¬á0:5 z2 0:5z¬á0:7 Skill-Assessment Exercise 13.10 PROBLEM: Draw a Ô¨Çowchart from which the compensator Gc z¬Ü¬à1899 z2 3761 z¬á1861 z2 1:908z¬á0:9075 can be programmed if the sampling interval is 0.1 second. ANSWER: The complete solution is at www.wiley.com/college/nise . 8Adapted from Chassing, R. Digital Signal Processing (New York: John Wiley & Sons, Inc., 1999), p. 137. ÓÄÇ1999 John Wiley & Sons, Inc.748 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:11 In this section, we learned how to implement a digital compensator. The resulting Ô¨Çowchart can serve as the design of a digital computer program for the computer in the loop. The design consists of delays that can be thought of as storage for each sampled value of input and output. The stored values are weighted and added. The engineer then canimplement the design with a computer program. In the next section, we will put together the concepts of this chapter as we apply the principles of digital control system design to our antenna azimuth control system. Case Studies Antenna Control: Transient Design via GainAntenna Control: Transient Design via Gain We now demonstrate the objectives of this chapter by turning to our ongoing antenna azimuth position control system. We will show where the computer is inserted in the loop,model the system, and design the gain to meet a transient response requirement. Later, we will design a digital cascade compensator. The computer will perform two functions in the loop. First, the computer will be used as the input device. It will receive digital signals from the keyboard in the form of commands, and digital signals from the output for closed-loop control. The keyboard willreplace the input potentiometer, and an analog-to-digital (A/D) converter along with aunity gain feedback transducer will replace the output potentiometer. Figure 13.30( a) shows the original analog system, and Figure 13.30( b) shows the system with the computer in the loop. Here the computer is receiving digital signals from two sources: (1) the input via the keyboard or other tracking commands and (2) the output via an A/D converter. The plant is receiving signals from the digital computer via a digital-to-analog (D/A) converter and the sample-and-hold. Figure 13.30( b) shows some simplifying assumptions we have made. The power ampli Ô¨Åer‚Äôs pole is assumed to be far enough away from the motor ‚Äôs pole that we can represent the power ampli Ô¨Åer as a pure gain equal to its dc gain of unity. Also, we have absorbed any preampli Ô¨Åer and potentiometer gain in the computer and its associated D/A converter. PROBLEM: Design the gain for the antenna azimuth position control system shown in Figure 13.30( b) to yield a closed-loop damping ratio of 0.5. Assume a sampling interval ofT¬à0:1 second. 0.64 K100 s + 1002.083 s(s + 1.71)0.1iPot PreampPower amp Motor & load Gears o Sample-and- hold0.1Power amp Motor & load Gears oA/Di12.083 s(s + 1.71) A/D(a) (b)+ ‚Äì + ‚ÄìComputer & D/AŒ∏Œ∏ Œ∏ Œ∏ FIGURE 13.30 Antenna control system: a.analog implementation; b.digital implementationCase Studies 749WEBC13 10/28/2014 20:50:13 SOLUTION: Modeling the System: OurÔ¨Årst objective is to model the system in the z-domain. The forward transfer function, G(s), which includes the sample-and-hold, power ampli Ô¨Åer, motor and load, and the gears, is G s¬Ü¬à1 e Ts s0:2083 s s¬áa¬Ü¬à0:2083 a 1 eTs¬Üa s2 s¬áa¬Ü 13.104 ¬Ü where a¬à1:71, and T¬à0:1. Since the z-transform of 1 e Ts¬Üis 1 z 1¬Üand, from Example 13.6, the z-transform of a=¬âs2 s¬áa¬Ü¬äis za s2 s¬áa¬Ü/C26/C27 ¬àTz z 1¬Ü2  1 e aT¬Üz a z 1¬Ü z e aT¬Ü/C20/C21 13.105 ¬Ü thez-transform of the plant, G(z), is G z¬Ü¬à0:2083 a 1 z 1¬Üza s2 s¬áa¬Ü/C26/C27 ¬à0:2083 a2¬âaT  1 e aT¬Ü¬äz¬á¬â 1 e aT¬Ü aTe aT¬ä z 1¬Ü z e aT¬Ü/C20/C21 13.106 ¬Ü Substituting the values for aandT, we obtain G z¬Ü¬à9:84610 4 z¬á0:945¬Ü z 1¬Ü z 0:843¬Ü 13.107 ¬Ü Figure 13.31 shows the computer and plant as part of the digital feedback control system. Designing for Transient Response: Now that the modeling in the z-domain is complete, we can begin to design the system for the required transient response. We superimpose the root locus over the constant damping ratio curves in the z-plane, as shown in Figure13.32.Alinedrawnfromtheorigintotheintersectionformsan8.58 ¬∞angle.Searching along this line for 180 ¬∞,w eÔ¨Ånd the intersection to be 0:915¬áj0:138¬Ü, with a loop gain, 9:84610 4K, of 0.0135. Hence, K¬à13:71. Checking the design by Ô¨Ånding the unit sampled step response of the closed-loop system yields the plot of Figure 13.33, which exhibits 20% overshoot Œ∂¬à0:456¬Ü. CHALLENGE: We now give you a case study to test your knowledge of this chapter ‚Äôs objectives: You are given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 2. Do the following: a.Convert the system into a digital system with T¬à0:1 second. For the purposes of the conversion, assume that the potentiometers are replaced with unity gain transducers.Neglect power ampli Ô¨Åer dynamics. b.Design the gain, K, for 16.3% overshoot. c.For your designed value of gain, Ô¨Ånd the steady-state error for a unit ramp input. d. Repeat Part busing MATLAB. 9.846 √ó 10‚Äì4(z + 0.945) (z ‚Äì 1)(z ‚Äì 0.843)KComputer Plant = G(z) R(z) + ‚ÄìC(z) FIGURE 13.31 Analog antenna azimuth position control system converted to adigital system750 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:13 Antenna Control: Digital Cascade Compensator DesignAntenna Control: Digital Cascade Compensator Design PROBLEM: Design a digital lead compensator to reduce the settling time by a factor of 2.5 from that obtained for the antenna azimuth control system in the previous Case Study problem in this chapter. SOLUTION: Figure 13.34 shows a simpli Ô¨Åed block diagram of the continuous system, neglecting power ampli Ô¨Åer dynamics and assuming that the potentiometers are replaced with unity gain trans ducers as previously explained. We begin with an s-plane design. From Figure 13.33, the settling time is about 5 seconds. Thus, our design requirements are a settling time of 2 seconds and a damping ratio of 0.5. The natural frequency is œân¬à4= Œ∂Ts¬Ü¬à4 rad/s. The compensated dominant poles are located at  Œ∂œâ njœânÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 1 Œ∂2p ¬à 2j3:464. Designing a lead compensator zero to cancel the plant pole on the s-plane at  1.71 yields a lead compensator pole at  4. Hence the lead compensator is given by Gc s¬Ü¬às¬á1:71 s¬á4 13.108 ¬Ü0.2 0.4 0.6 0.8 1 ‚Äì0.6‚Äì0.4‚Äì0.20.2z-plane Root locus = 0.5 8.58Im Re0.40.6 0 0Œ∂ FIGURE 13.32 Root locus superimposed over constant damping ratio curve c*(t) 01 23 4 5 6 7800.20.40.60.811.2 Time (seconds) Note: Valid onl y at inte ger values of sam pling instant FIGURE 13.33 Sampled step response of the antenna azimuth position control system KGc(s)0.2083 s(s + 1.71)iLead compensator Plant o + ‚Äì(s) (s)Œ∏ Œ∏ FIGURE 13.34 Simpli Ô¨Åed block diagram of antenna azimuth control systemCase Studies 751WEBC13 10/28/2014 20:50:14 Using root locus to evaluate the gain, K, at the design point yields 0 :2083K¬à16, or K¬à76:81. We now select an appropriate sampling frequency as described in Section 13.10. Using the cascaded compensator, KG c s¬Ü¬à76:81 s¬á1:71¬Ü s¬á4¬Ü 13.109 ¬Ü and plant, Gp s¬Ü¬à0:2083 s s¬á1:71¬Ü 13.110 ¬Ü the equivalent forward-path transfer function, Ge s¬Ü¬àKG c s¬ÜGp s¬Ü,i s Ge s¬Ü¬à16 s s¬á4¬Ü 13.111 ¬Ü The magnitude frequency response of Eq. (13.111) is 0 dB at 3.1 rad/s. Thus, from Section 13.10, the value of the sampling interval, T, should be in the range 0 :15=œâŒ¶M¬à 0:05 to 0 :5=œâŒ¶M¬à0:16 second. Let us choose a smaller value, say T¬à0:025 second. Substituting Eq. (13.89) into Eq. (13.111), where T¬à0:025, yields the digital compensator KG c z¬Ü¬à74:72z 71:59 z 0:9048 13.112 ¬Ü In order to simulate the digital system, we calculate the z-transform of the plant in Figure 13.34 in cascade with a zero-order sample-and-hold. The z-transform of the sampled plant is evaluated by the method discussed in Section 13.4 using T¬à0:025. The result is Gp z¬Ü¬à6:41810 5z¬á6:32710 5 z2 1:958z¬á0:9582 13.113 ¬Ü The step response in Figure 13.35 shows approximately 20% overshoot and a settling time of 2.1 seconds for the closed-loop digital system. 0 0.5 1 1.5 Note: Valid onl y at inte ger values of sam pling instant 2 2.5 300.20.40.60.811.2 Time (seconds)*(t)Œ∏ FIGURE 13.35 Closed-loop digital step response for antenna control system with a leadcompensator752 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:14 Summary In this chapter, we covered the design of digital systems using classical methods. State-space techniques were not covered. However, you are encouraged to pursue this topic in a coursededicated to sampled-data control systems. We looked at the advantages of digital control systems. These systems can control numerous loops at reduced cost. System modi Ô¨Åcations can be implemented with software changes rather than hardware changes. Typically, the digital computer is placed in the forward path preceding the plant. Digital-to-analog and analog-to-digital conversion is required within the system to ensurecompatibility of the analog and digital signals throughout the system. The digital computerin the loop is modeled as a sample-and-hold network along with any compensation thatit performs. Throughout the chapter, we saw direct parallels to the methods used for s-plane analysis of transients, steady-state errors, and the stability of analog systems. The parallel isWe conclude the design by obtaining a Ô¨Çowchart for the digital compensator. Using Eq. (13.112), where we de Ô¨ÅneKG c z¬Ü¬àX z¬Ü=E z¬Ü, and cross-multiplying yields z 0:9048 ¬ÜX z¬Ü¬à 74:72z 71:59¬ÜE z¬Ü 13.114 ¬Ü Solving for the highest power of zoperating on X(z), zX z¬Ü¬à 74:72z 71:59¬ÜE z¬Ü¬á0:9048 X z¬Ü 13.115 ¬Ü Solving for X(z), X z¬Ü¬à 74:72 71:59z 1¬ÜE z¬Ü¬á0:9048 z 1X z¬Ü 13.116 ¬Ü Implementing Eq. (13.116) as a Ô¨Çowchart yields Figure 13.36. CHALLENGE: You are now given a case study to test your knowledge of this chapter‚Äô s objectives. You are given the antenna azimuth position control system shown on the front endpapers, Con Ô¨Åguration 2. Replace the potentiometers with unity gain transducers, neglect power ampli Ô¨Åer dynamics, and do the following: a.Design a digital lead compensator to yield 10% overshoot with a 1-second peak time.Design in the s-plane and use the Tustin transformation to specify and implement a digital compensator. Choose an appropriate sampling interval. b.Draw a Ô¨Çowchart for your digital lead compensator. c. Repeat Part ausing MATLAB.+ ++ ‚Äìe*(t‚Äì0.025) x*(t‚Äì0.025)e*(t) x*(t) Delay 0.025 second74.72 ‚Äì71.59Delay 0.025 second ‚Äì0.9048 FIGURE 13.36 Flowchart for digital lead compensator9 9Adapted from Chassing, R. Digital Signal Processing (New York: John Wiley & Sons, Inc., 1999), p. 137. ÓÄÇ1999 John Wiley & Sons, Inc.Summary 753WEBC13 10/28/2014 20:50:15 made possible by the z-transform, which replaces the Laplace transform as the transform of choice for analyzing sampled-data systems. The z-transform allows us to represent sampled waveforms at the sampling instants. We can handle sampled systems as easily as continuous systems, including block diagram reduction, sinceboth signals and systems can be represented in the z-domain and manipulated algebraically. Complex systems can be re duced to a single block through techniques that parallel those used with the s-plane. Time responses can be obtained through division of the numerator by the denominat or without the partial -fraction expansion required in the s-domain. Digital systems analysis parallels the s-plane techniques in the area of stability. The unit circle becomes the boundary of stability, replacing the imaginary axis. We also found that the concepts of root locus and transient response are easily carried into the z-plane. The rules for sketching the root locus do not change. We can map points on thes-plane into points on the z-plane and attach transient response characteristics to the points. Evaluating a sampled-data system shows that the sampling rate, in addition to gainand load, determines the transient response. Cascade compensators also can be designed for digital systems. One method is to Ô¨Årst design the compensator on the s-plane or via frequency response techniques described in Chapters 9 and 11, respectively. Then the resulting design is transformed to a digitalcompensator using the Tustin transformation. Designing cascade compensation directly onthez-plane is an alternative method that can be used. However, these techniques are beyond the scope of this book. This introductory control systems course is now complete. You have learned how to analyze and design linear control systems using frequency-domain and state-spacetechniques. This course is only a beginning. You may consider furthering your study of control systems by taking advanced courses in digital, nonlinear, and optimal control, where you will learn new techniques for analyzing and designing classes of systems not covered inthis book. We hope we have whetted your appetite to continue your education in controlsystems engineering. Review Questions 1.Name two functions that the digital computer can perform when used with feedbackcontrol systems. 2.Name three advantages of using digital computers in the loop. 3.Name two important considerations in analog-to-digital conversion that yield errors. 4.Of what does the block diagram model for a computer consist? 5.What is the z-transform? 6.What does the inverse z-transform of a time waveform actually yield? 7.Name two methods of Ô¨Ånding the inverse z-transform. 8.What method for Ô¨Ånding the inverse z-transform yields a closed-form expression for the time function? 9.What method for Ô¨Ånding the inverse z-transform immediately yields the values of the time waveform at the sampling instants? 10.In order to Ô¨Ånd the z-transform of a G(s), what must be true of the input and the output? 11.If input R(z) to system G(z) yields output C(z), what is the nature of c(t)?754 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:15 12.I fat i m ew a v e f o r m , c(t), at the output of system G(z) is plotted using the inverse z-transform, and a typical second-order response with damping ratio =0.5 results, can we say that the system is stable? 13.What must exist in order for cascaded sampled-data systems to be represented by the product of their pulse transfer functions, G(z)? 14.Where is the region for stability on the z-plane? 15.What methods for Ô¨Ånding the stability of digital systems can replace the Routh-Hurwitz criterion for analog systems? 16.To drive steady-state errors in analog systems to zero, a pole can be placed at the originof the s-plane. Where on the z-plane should a pole be placed to drive the steady-state error of a sampled system to zero? 17.How do the rules for sketching the root locus on the z-plane differ from those for sketching the root locus on the s-plane? 18.Given a point on the z-plane, how can one determine the associated percent overshoot, settling time, and peak time? 19.Given a desired percent overshoot and settling time, how can one tell which point on thez-plane is the design point? 20.Describe how digital compensators can be designed on the s-plane. 21.What characteristic is common between a cascade compensator designed on the s-plane and the digital compensator to which it is converted? Problems 1.Derive the z-transforms for the time functions listed below. Do not use any z-transform tables. Use the plan f t¬Ü¬Æf* t¬Ü¬ÆF* s¬Ü¬ÆF z¬Ü, followed by converting F(z) into closed form making use of the fact that 1= 1 z 1¬Ü¬à1¬áz 1¬áz 2¬áz 3¬á‚àô‚àô‚àô. Assume ideal sampling. [Section: 13.3] a.e atu t¬Ü b.u(t) c.t2e atu t¬Ü d.cosœâtu t¬Ü 2.Repeat all parts of Problem 1using MATLAB and MATLAB ‚Äôs Symbolic Math Toolbox. 3.For each F(z),Ô¨Ånd f(kT) using partial-fraction expansion. [Section: 13.3] a.F z¬Ü¬àz z¬á3¬Ü z¬á5¬Ü z 0:4¬Ü z 0:6¬Ü z 0:8¬Ü b.F z¬Ü¬à z¬á0:2¬Ü z¬á0:4¬Ü z 0:1¬Ü z 0:5¬Ü z 0:9¬Ü c.F z¬Ü¬à z¬á1¬Ü z¬á0:3¬Ü z¬á0:4¬Ü z z 0:2¬Ü z 0:5¬Ü z 0:7¬Ü4.Repeat all parts of Problem 3using MATLAB and MATLAB ‚Äôs Symbolic Math Toolbox. 5.For each F(z) in Problem 3, do the following: [Section: 13.3] a.Find f(kT) using the power series expansion. b.Check your results against your answers fromProblem 3. 6.Using partial-fraction expansion and Table 13.1, Ô¨Ånd the z-transform for each G(s) shown below if T¬à0:5 second. [Section: 13.3] a.G s¬Ü¬à s¬á4¬Ü s¬á2¬Ü s¬á5¬Ü b.G s¬Ü¬à s¬á1¬Ü s¬á2¬Ü s s¬á3¬Ü s¬á4¬Ü c.G s¬Ü¬à20 s¬á3¬Ü s2¬á6s¬á25¬Ü d.G s¬Ü¬à15 s s¬á1¬Ü s2¬á10s¬á81¬ÜProblems 755WEBC13 10/28/2014 20:50:16 7.Repeat all parts of Problem 6 using MATLAB and MATLAB ‚Äôs Symbolic Math Toolbox. 8.Find G z¬Ü¬àC z¬Ü=R z¬Üf o re a c ho ft h eb l o c k diagrams shown in Figure P13.1 if T¬à0:3 second. [Section: 13.4] 9.Find T z¬Ü¬àC z¬Ü=R z¬Üfor each of the systems shown in Figure P13.2. [Section: 13.5]10.Find C(z) in general terms for the digital system shown in Figure P13.3. [Section: 13.5] 11.Find the closed-loop transfer function, T z¬Ü¬àC z¬Ü=R z¬Ü, for the system shown in Figure P13.4. [Section: 13.5] 12.Write a MATLAB program that can be used to Ô¨Ånd the range of sampling time, T, for stability. The program will be used for systems of the 20 s(s + 5)Hold (a) 20 s(s + 5)Hold (b)1 (s + 3) 20 s(s + 5)Hold (c)1 (s + 3)HoldR(s) C(s) C(s) R(s) R(s) C(s) FIGURE P13.1 R(s)G1(s)+ ‚ÄìG2(s)C(s) (a)H(s)+ ‚ÄìR(s)G1(s)+ ‚ÄìG2(s)C(s) (b)H(s) FIGURE P13.2 G1(s)C(s) T H1(s) H2(s)T ‚Äì+ ‚Äì+ R(s) TG2(s) G3(s) G4(s)+ ‚Äì H2(s) FIGURE P13.3 R(s) T5 Hold 3C(s) + ‚Äì+ ‚Äì1 s(s + 2)1 s FIGURE P13.4756 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:16 type represented in Figure P13.5 and should meet the following requirements: a.MATLAB will convert G1(s) cascaded with a sample-and-hold to G(z) . b.The program will calculate the z-plane roots of the closed-loop system for a range of Tand determine the value of T, if any, below which the system will be stable. MATLAB will display thisvalue of Talong with the z-plane poles of the closed-loop transfer function. Test the program on G 1 s¬Ü¬à20 s¬á6¬Ü s¬á1¬Ü s¬á3¬Ü s¬á4¬Ü s¬á8¬Ü R(s) + ‚Äì Sample- and-holdG1(s)C(s) FIGURE P13.5 13.Given the system in Figure P13.6, Ô¨Ånd the range of sampling interval, T, that will keep the system stable. [Section: 13.6] R(s) + ‚Äì THold1 s(s + 10)C(s) FIGURE P13.6 14.Find the range of gain, K, to make the system shown in Figure P13.7 stable. [Section: 13.6] R(s) + ‚Äì T = 0.2Hold3K s(s + 4)C(s) FIGURE P13.7 15.Find the static error constants and the steady-state errorfor each of the digital systems shown in Figure P13.8 ifthe inputs are [Section: 13.7] a.u(t) b.tu(t) c. 1 2t2u t¬ÜR(s) + ‚Äì T = 0.5Hold1 s + 2C(s) System 1 R(s) + ‚Äì T = 0.1Hold20 s(s + 2)C(s) System 2 R(z) + ‚ÄìT = 0.5C(z) System 3 R(z) + ‚ÄìT = 0.10.13(z + 1) (z ‚Äì 1)(z ‚Äì 0.74)C(z) System 41.28 z ‚Äì 0.37 FIGURE P13.8 16.Write a MATLAB program that can be used to Ô¨ÅndKp,Kv, and Kafor digital systems. The program will beused for systems of the type representedin Figure P13.5. Test your program for G z¬Ü¬à0:04406 z3 0:03624 z2 0:03284 z¬á0:02857 z4 3:394z3¬á4:29z2 2:393z¬á0:4966 where G(z) is the pulse transfer func- tion for G1 s¬Üin cascade with the z.o.h. and T¬à0:1 second. 17.For the digital system shown in Figure P13.5, whereG 1 s¬Ü¬àK=¬â s¬á1¬Ü s¬á5¬Ü¬ä,Ô¨Ånd the value of Kto yield a 15% overshoot. Also Ô¨Ånd the range of Kfor stability. Let T¬à0:1 second. [Section: 13.9] 18.Use Simulink to simulate thestep response for the system ofProblem 17. Set the value of gain,K, to that designed in Problem 17 for 15% overshoot. Use MATLAB ‚Äôs LTI Viewer to deter mine the peak time andsettling time of the closed-loop stepresponse for System 4 in Figure P13.8.Problems 757WEBC13 10/28/2014 20:50:17 20.Write a MATLAB program that can be used to design the gain of a digital control system to meet a percentovershoot requirement. The programwill be used for systems of the typerepresented in Figure P13.5 and meet thefollowing requirements: a.The user will input the desired per-cent overshoot. b.MATLAB will convert G 1(s) cascaded with the sample-and-hold to G(z) . c.MATLAB will display the root locus on the z-plane along with an overlay of the percent overshoot curve. d.The user will click with the mouse at the intersection of the root locusand percent overshoot overlay andMATLAB will respond with the value ofgain followed by a display of the stepresponse of the closed-loop system. Apply your program to Problem 17 andcompare results. 21.For the digital system shown in Figure P13.5, where G 1 s¬Ü¬àK=¬âs s¬á1¬Ü¬ä,Ô¨Ånd the value of Kto yield a peak time of 2 seconds if the sampling interval, T, is 0.2 second. Also, Ô¨Ånd the range of Kfor stability. [Section: 13.9] 22.For the digital system shown in Figure P13.5, whereG 1 s¬Ü¬àK=¬âs s¬á1¬Ü s¬á3¬Ü¬ä,Ô¨Ånd the value of Kto yield a 20% overshoot if the sampling interval, T, is 0.1 second. Also, Ô¨Ånd the range of Kfor stability. [Section: 13.9] 23.For the digital system shown in Figure P13.5, where G1 s¬Ü¬àK s¬á2¬Ü¬âs s¬á1¬Ü s¬á3¬Ü¬ä,Ô¨Ånd the value of Kto yield a settling time of 15 seconds if the sampling interval, T, is 1 second. Also, Ô¨Ånd the range of Kfor stability. [Section: 13.9] 24.A PID controller was designed in Example 9.5 for acontinuous system with unity feedback. The system ‚Äôs plant was G s¬Ü¬à s¬á8¬Ü s¬á3¬Ü s¬á6¬Ü s¬á10¬Ü The designed PID controller was Gc s¬Ü¬à4:6 s¬á55:92¬Ü s¬á0:5¬Ü sFind the digital transfer function, Gc(z), of the PID controller in order for the system to be computercontrolled if the sampling interval, T, is 0.005 second. [Section: 13.10] 25.A continuous unity feedback system has a forwardtransfer function of G s¬Ü¬à 1 s s¬á5¬Ü s¬á8¬Ü The system is to be computer controlled with thefollowing speci Ô¨Åcations: Percent overshoot: 10%Settling time: 2 secondsSampling interval: 0 :01 second Design a lead compensator for the digital system tomeet the speci Ô¨Åcations. [Section: 13.10] Repeat Problem 25 using MATLAB. 27.An inverted pendulum mounted on amotor-driven cart ( Prasad ,2012 ) was the subject of Problem 33, Chapter 9. In thatproblem you were asked to develop Simulink models fortwofeedbacksystems,oneofwhichwastocontrolthecartposition, x(t). At the recommended settings, the step response of that system was expected to satisfy thefollowing requirements: a steady-state error, e( ‚àû) <2%, a peak time, TP<1.2 seconds, and a percent overshoot, % OS<20.5%. Having concluded that the steady-state error was unacceptable, you designed a PIDcontroller and found its recommended settings. Digitize the Simulink model developed for PID control of the cart position in Part dof Problem 33, Chapter 9, by adding azero-order-holdsetto0.01second.Then, run a simulation to evaluate performance. DESIGN PROBLEMSDESIGN PROBLEMS a. Convert the heading control for the UFSS vehicle shown on the back endpapers ( Johnson ,1980 ) into a digitally controlled system. b.Find the closed-loop pulse transfer function, T(z), if T¬à0:1 second. c.Find the range of heading gain to keep the digitalsystem stable. 29.The analog system of a disk drive is shown in Figure P13.9. Do the following: a.Convert the disk drive to a digital system. Use a sampling time of 0.01 second. b.Find the range of digital controller gain to keep thesystem stable.758 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:17 c.Find the value of digital controller gain to yield 15% overshoot for a digital step response. d.Repeat all previous parts andobtain the step response forPart cusing MATLAB. 30.In Problem 49, Chapter 9, and Problem 39, Chapter 10,we considered the radial pickup position control of a DVD player. A controller was designed and placed in cascade with the plant in a unit feedback con Ô¨Åguration to stabilize the system. The controller was given by M s¬Ü¬à 0:5 s¬á1:63¬Ü s s¬á0:27¬Ü and the plant by ( Bittanti ,2002 ) P s¬Ü¬à0:63 1¬á0:36 305:4s¬ás2 305:42/C18/C19 1¬á0:04 248:2s¬ás2 248:22/C18/C19 It is desired to replace the continuous system by anequivalent discrete system without appreciably affectingthe system performance. a.Find an appropriate sampling frequency for thediscretization. b.Using the chosen sampling frequency, translate thecontinuous compensator into a discrete compensator. c. Use Simulink to simulatethe continuous and discretesystems on the same graph. Assume a unit step input. Are theresigniÔ¨Å cant differences in the system ‚Äôs performance? 31.In Problem 24, Chapter 11, we discussed an EVAD, adevice that works in parallel with the human heart to helppump blood in patients with cardiac conditions. Thedevice has a transfer function G s¬Ü¬à Pao s¬Ü Em s¬Ü¬à1361 s2¬á69s¬á70:85 where Em(s)i st h em o t o r ‚Äôs armature voltage, and Pao(s) is the aortic blood pressure ( Tasch ,1990). Using continuous techniques, a cascaded compensator isdesigned in a unity feedback conÔ¨Å g u r a t i o nw i t ha transfer function Gc s¬Ü¬à0:5 s¬á1¬Ü s¬á0:05 Selecting to control the device using a microcontroller, a discrete equivalent has to be found for Gc(s). Do the following: a.Find an appropriate sampling frequency for the discretization. b.Translate the continuous compensator into a discretecompensator using the sampling frequency foundin Part a. c. Use Simulink to simulatethe continuous and discretesystems on the same graph for a unitstep input. There should be little difference between the compensated continuous and discrete systems. 32.In Problem 47, Chapter 9, a steam-driven turbine-governor system was implemented by a unityfeedback system with a forward-path transfer function(Khodabakhshian ,2005 ) G s¬Ü¬à K s¬á0:08¬Ü s¬á2¬Ü s¬á5¬Ü a.Use a sampling period of T¬à0:5 s and Ô¨Ånd a discrete equivalent for this system. b.Use MATLAB to draw the rootlocus. c.Find the value of Kthat will result in a stable system with a damping factor of Œ∂¬à0:7. d.Use the root locus found in Part ato predict the step-response settling time, T s, and peak time, Tp. e.Calculatethe Ô¨Ånalvalueoftheclosed-loopsystemunit step response. f.Obtain the step response of the system using Simulink. Verify the predictions you made in Parts c andd. 33.Discrete time controlled systems can exhibit uniquecharacteristics not available in continuous control-lers. For example, assuming a speci Ô¨Åc input and some conditions, it is possible to design a system to achievesteady state within one single time sample withoutovershoot. This scheme is well known and referredto as deadbeat control . We illustrate deadbeat control design with a simple example. For a morecomprehensive treatment see ( Ogata ,1987 ).s(s + 100)‚ÄìXD(s) + YA(s)20,000Desired positionMotor and loadActualposition FIGURE P13.9 Simpli Ô¨Åed block diagram of a Ô¨Çoppy disk driveProblems 759WEBC13 10/28/2014 20:50:18 Assume in Figure 13.25( a) that Gp s¬Ü¬à1 s¬á1. The purpose of the design will be to Ô¨Ånd a compensator, Gc z¬Ü, such that for a step input the system achieves steady state within one sample. We start by translating the system into the discrete domain to obtain theequivalent of Figure 13.25( c). The pulse transfer func- tion, G p z¬Ü¬à 1 e T¬Üz 1 1 e Tz 1, is found using Eq. (13.40), since it is assumed that the compensator will befollowed by a zero-order hold. In Figure 13.25( c), the closed-loop transfer function is given by C z¬Ü R z¬Ü¬àT z¬Ü¬àGc z¬ÜGp z¬Ü 1¬áGc z¬ÜGp z¬Ü, or, solving for the com- pensator, we get Gc z¬Ü¬à1 Gp z¬ÜT z¬Ü 1 T z¬Ü. The desired system output is a unit step delayed by one unit sample. Thus, C z¬Ü¬àz z 1z 1¬à1 z 1. Since the input is a unit step, R z¬Ü¬àz z 1; the desired closed-loop transfer function isC z¬Ü R z¬Ü¬àT z¬Ü¬àz 1, and the resulting compensator, found by direct substitution, is given by Gc z¬Ü¬à1 1 e T z e T¬Ü z 1. Assume now that the plant is given by Gp s¬Ü¬à1 s, and a sampling period of T=0.05 second is used. a.Design a deadbeat compensator to reach steady state within one time sample for a step input. b.Calculate the resulting steady-state error for a unit-slope ramp input. c.Simulate your system usingSIMULINK. (Hint: FollowingFigure 13.25, the forward path willconsist of the cascading of G C(z), a zero-order hold, and Gp(s).) Show that the system reaches steady stateafter one sample. Also verify yoursteady-state error ramp result. Given G s¬Ü¬à8 s¬á4 Use the LabVIEW Control Design andSimulation Module to (1) convert G(s) to a digital transfer function usinga sampling rate of 0.25 second; and(2) plot the step responses of thediscrete and the continuous transferfunctions.35. Given G z¬Ü¬àK z¬á0:5¬Ü z 0:25¬Ü z 0:75¬Ü Use the LabVIEW Control Designand Simulation Module and theMathScript RT Module to (1) obtain thevalue of Kthat will yield a damping ratio of 0.5 for the closed-loop systemin Figure 13.20, where H(z)=1; and (2) display the step response of theclosed-loop system in Figure 13.20 where H(z)=1. Compare your results with those of Skill-Assessment Exercise 13.8. 36.Obtaining an exact shape in metalforming can be tricky because of material springback. A feedback system hasbeen devised in which critical deviations from speci Ô¨Åca- tions are measured as soon as a part is formed and automatic incremental corrections to the forming tools are made before the next part is formed. Eventually thesystem compensates for material springback and resultsin parts compliant with speci Ô¨Åcations. A unity-feedback digital system with a forward path G z¬Ü¬à k z 1 can be used as a simpli Ô¨Åed representation of the system (Fu,2013 ). a.Make a sketch of the system ‚Äôs root locus. b.Find the range of kfor which the system is closed- loop stable. c.Find the system ‚Äôs steady-state error for a step input. d.Find the value of kthat will result in the fastest possible response. 37.The purpose of an arti Ô¨Åcial pacemaker is to regulate heart rate in those patients in which the natural feedbacksystem malfunctions. Assume a unity-feedback systemwith a forward path, G s¬Ü¬à 1352 k s s¬á8¬Ü s¬á20¬Ü as a simpli Ô¨Åed model of a pacemaker ( Neogi ,2010 ). a.Convert the pacemaker model to a discrete systemwith a sampling rate of 0.01 second. b.Draw the root locus of the system using a computerprogram. c.Use the root locus in Part btoÔ¨Ånd the range of k for which the system is closed-loop stable. d.Use the root locus from Part btoÔ¨Ånd the value of k that will yield a 5% overshoot for a step input. e.Simulatetheunit-stepinputofyourdiscretizedsystem to verify your design.760 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:19 38.A linear model of the Œ±-subsystem of a grid-connected voltage-source converter with a Y-Y transformer (Mahmood ,2012 ) was presented in Problem 69, Chapter 8, and Problem 51, Chapter 10. The systemwas represented with unity-feedback and a forwardpath consisting of the cascading of a compensator anda plant. The plant is given by G P s¬Ü¬àVŒ± s¬Ü MŒ± s¬Ü¬à s¬á2200 ¬Ü s¬á220¬Ü s2¬á120s¬á16106¬Ü This system is now to be digitally controlled with the following speci Ô¨Åcations: percent overshoot, %OS=10%; settling time, TS=0.1 second; and sampling interval, T=0.001 second. Design a lead compensator for that system to meet these speci Ô¨Åca- tions. [Section: 13.10] PROGRESSIVE ANALYSIS AND DESIGN PROBLEMSPROGRESSIVE ANALYSIS AND DESIGN PROBLEMS Control of HIV/AIDS. In Chapter 11, a continuous cascaded compensator for a unity feedback system was designed for the treatment of the HIV-infected patient treated with RTIs ( Craig ,2004 ). The transfer function of the designed compensator was Gc s¬Ü¬à 210 4 s2¬á0:04s¬á0:0048 ¬Ü s s¬á0:02¬Ü The linearized plant was given by P s¬Ü¬àY s¬Ü U1 s¬Ü¬à 520s 10:3844 s3¬á2:6817 s2¬á0:11s¬á0:0126 The compensated system is overdamped with an approx-imate settling time of 100 seconds. This system must bediscretized for practical reasons: (1) HIV patient cannotbe monitored continuously and (2) medicine dosage cannot be adjusted continuously. a.Show that a reasonable sampling period for thissystem is T¬à8 days (medicine dosage will be updated on a weekly basis). b.Use Tustin ‚Äôs method and T¬à8 days to Ô¨Ånd a discrete equivalent to G c(s). c.Use Simulink to simulate the continuous and discretecompensated systems for a unit stepinput. Plot both responses on the samegraph. Hybrid vehicle. In Problem 67, Chapter 7 (Figure P7.31), the block diagram of acascade scheme for the speed control of anHEV ( Preitl, 2007 ) was represented as a unity feedback system. In that diagram the output of the system is thespeed transducer ‚Äôs output voltage, C s¬Ü¬àK ssV s¬Ü.I n Partbof Problem 33, Chapter 11, where a compensator was designed for this problem, we discussed thefeasibility of achieving full pole-zero cancellationwhen we place a PI speed controller ‚Äôs zero, Z I, on top of the uncompensated system‚Äô s real pole, closest to the origin(locatedat  0.0163).Notingthatperfectpole-zero cancellation may not be maintained, we studied a casewhere the PI-controller ‚Äôs zero changed by +20%, moving to  0.01304. In that case, the transfer function of the plant with a PI speed controller, which has aproportional gain =K, was given by G s¬Ü¬à K s¬á0:6¬Ü s¬á0:01304 ¬Ü s s¬á0:0163 ¬Ü s¬á0:5858 ¬Ü Assuming that G1 s¬Üin Figure P13.5 equals the transfer function, G(s), given above for the vehicle with the speed controller: a.Develop a MATLAB M- Ô¨Åle that would allow you to do the following: (Hint:Refer to the M- Ô¨Åles you developed for Problems 12 and 20 of this chapter) (1) Convert G 1(s) cascaded with a sample-and-hold to G(z) ; (2) Search over the range 0 <T<5 sec- onds for the largest sampling periodT maxbelow which the system is sta- ble. Calculate the z-plane roots of the closed-loop system for the wholerange of the sampling time, T. Sub- sequently set T¬à0:75T max; (3) Design the gain of a digital con- trol system to meet a percent over-shoot requirement, % OS, allowing the user to input the value of thedesired % OSand the value of the PI speed controller ‚Äôs proportional gain, K; (4) Plot the step response of that dig- ital system (in per unit, p. u., vs.time in seconds) . b.Run the M- Ô¨Åle you developed in Part a and enter the values of the desiredpercent overshoot, % OS=0, and the PI speed controller ‚Äôs proportional gain, K=61; c.Select a point in the graphics windowdisplaying the root locus, such thatProblems 761WEBC13 10/28/2014 20:50:19 Cyber Exploration Laboratory Experiment 13.1 Objectives To design the gain of a digital control system to meet a transient response requirement; to simulate a digital control system to test a design; to see the effect of sampling rate upon the time response of a digital system Minimum Required Software Packages MATLAB, Simulink, and the Control System Toolbox Prelab 1.Given the antenna azimuth control system shown on the front endpapers, useConÔ¨Åguration 2 to Ô¨Ånd the discrete transfer function of the plant. Neglect the dynamics of the power ampli Ô¨Åer and include the preampli Ô¨Åer, motor, gears, and load. Assume a zero-order hold and a sampling interval of 0.01 second. 2.Using the digital plant found in Prelab 1, Ô¨Ånd the preampli Ô¨Åer gain required for a closed- loop digital system response with 10% overshoot and a sampling interval of 0.01 second. What is the peak time? 3.Given the antenna azimuth control system shown on the front endpapers, use ConÔ¨Å g u r a t i o n2t oÔ¨Å nd the preampli Ô¨Åer gain required for the continuous system to yield a closed-loop step response with 10% overshoot. Consider the open-loop systemto be the preampliÔ¨Å er, motor, gears, and load. Neglect the dynamics of the power ampli Ô¨Åer. Lab 1.Verify your value of preampli Ô¨Åe rg a i nf o u n di nP r e l a b2u s i n gt h eS I S OD e s i g n Tool to generate the root locus for the digital open-loop transfer function found inPrelab 1. Use the Design Constraints capab ility to generate the 10% overshoot curve and place your closed-loop poles at this boundary. Obtain a plot of the root locus andthe design boundary. Record the value of gain for 10% overshoot. Also, obtain a plotall poles of the closed-loop transfer function, T z, are inside the unit circle. d.Write the sampled-data transfer functions obtained, Gzand Tz, indi- cating the corresponding value ofthe sampling time, T, and all poles, r, of the closed-loop transfer func- tion, T z; e.Plot the step response of that digitalsystem (in per unit, p. u., vs. time in seconds) noting the following charac- teristics: Ô¨Ånal value, rise time, and settling time. Parabolic trough collector. In Problem 34, Chapter 11, a zero steady-state error for a unit-step input wasachieved through the design of a lag compensator with integral control. In that problem, the open-loop trans- mission can be written as L s¬Ü¬àG c s¬ÜG s¬Ü, where theparabolic trough plant is given by ( Camacho, 2012 ) G s¬Ü¬à137:210 6 s2¬á0:0224 s¬á19610 6e 39s and the lag compensator is given by Gc s¬Ü¬à1:12 s¬á0:01¬Ü s We want to substitute for the continuous com- pensator with a digital one. a.Find a suitable sampling period for the system. b.Find the equivalent compensator ‚Äôs transfer function inz-domain. c.Use Simulink to simulate thedigital compensator with thecontinuous plant. Compare the result-ing response with that of the originalsystem using the continuous compensa-tor on the same graph.762 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:19 of the closed-loop step response using the LTI Viewer and record the values of percent overshoot and peak time. Use the same tool to Ô¨Ånd the range of gain for stability. 2.Using Simulink, set up the closed-loop digital system whose plant was found in Prelab 1. Make two diagrams: one with the digital transfer function for the plant and another usingthe continuous transfer function for the plant preceded by a zero-order sample-and-hold. Use the same step input for both diagrams and obtain the step response of each. Measure the percent overshoot and peak time. 3.Using Simulink, set up both the digital and continuous systems calculated in Prelab 2and Prelab 3, respectively, to yield 10% overshoot. Build the digital system with asample-and-hold rather than the z-transform function. Plot the step response of each system and record the percent overshoot and the peak time. 4.For one of the digital systems built in Lab 2, vary the sampling interval and record theresponses for a few values of sampling interval above 0.01 second. Record samplinginterval, percent overshoot, and peak time. Also, Ô¨Ånd the value of sampling interval that makes the system unstable. Postlab 1.Make a table containing the percent overshoot, peak time, and gain for each of thefollowing closed-loop responses: the digital system using the SISO Design Tool; thedigital system using Simulink and the digital transfer functions; the digital system usingSimulink and the continuous transfer functions with the zero-order sample-and-hold;and the continuous system using Simulink. 2.Using the data from Lab 4, make a table containing sampling interval, percent overshoot,and peak time. Also, state the sampling interval that makes the system unstable. 3.Compare the responses of all of the digital systems with a sampling interval of 0.01second and the continuous system. Explain any discrepancies. 4.Compare the responses of the digital system at different sampling intervals with thecontinuous system. Explain the differences. 5.Draw some conclusions about the effect of sampling. Experiment 13.2 Objective To use the various functions from the LabVIEW Control Design and Simulation Module for the analysis of digital control systems. Minimum Required Software Packages LabVIEW with the Control Design and Simulation Module and the MathScript RT Module; MATLAB with the Control Systems Toolbox. Prelab You are given Figure P8.22 and the parameters listed in the Prelab of Cyber Exploration Laboratory Experiment 8.2 for the open-loop NASA eight-axis ARMII(Advanced Research Manipulator II) electromechanical shoulder joint/link, actuated byan armature-controlled dc servomotor. 1.Obtain the open-loop transfer function of the shoulder joint/link, G s¬Ü¬à Œ∏L s¬Ü Vref s¬Ü, or use your calculation from Cyber Exploration Laboratory Experiment 8.2. 2.Use MATLAB and design a digital compensator to yield a closed-loop response with zero steady-state error and a damping ratio of 0.7. If you already have performed Cyber Exploration Laboratory Experiment 8.2, modify your M- Ô¨Åle from that experiment. Test your design using MATLAB.Cyber Exploration Laboratory 763WEBC13 10/28/2014 20:50:19 Bibliography Astrom, K. J., and Wittenmark, B. Computer Controlled Systems . Prentice Hall, Upper Saddle River, NJ, 1984. Bittanti, S., Dell ‚ÄôOrto, F., Di Carlo, A., and Savaresi, S. M. Notch Filtering and Multirate Control for Radial Tracking in High Speed DVD-Players. IEEE Transactions on Consumer Electronics, vol. 48, 2002, pp. 56 ‚Äì62. Boyd, M., and Yingst, J. C. PC-Based Operator Control Station Simpli Ô¨Åes Process, Saves Time. Chilton ‚ÄôsI&C S , September 1988, pp. 99 ‚Äì101. Camacho, E. F., Berenguel, M., Rubio, F. R., and Martinez, D. Control of Solar Energy Systems . Springer-Verlag, London, 2012. Chassaing, R. Digital Signal Processing . Wiley, New York, 1999. Craig, I. K., Xia, X., and Venter, J. W. Introducing HIV/AIDS Education into the Electrical Engineering Curriculum at the University of Pretoria. IEEE Transactions on Education , vol. 47, no. 1, February 2004, pp. 65 ‚Äì73. Craig, J. J. Introduction to Robotics .Mechanics and Control , 3d ed. Prentice Hall, Upper Saddle River, NJ, 2005. Fu, Z., Mo, J., Han, F., and Gong, P. Tool path correction algorithm for single-point incremental forming of sheet metal. Int. J. Adv. Manuf. Technol. , vol. 64, 2013, Springer, pp. 1239 ‚Äì1248. Hostetter, G. H. Digital Control System Design . Holt, Rinehart & Winston, New York, 1988. Johnson, H. et al. Unmanned Free-Swimming Submersible (UFSS) System Description. NRL Memorandum Report 4393. Naval Research Laboratory, Washington, D.C., 1980. Katz, P. Digital Control Using Microprocessors . Prentice Hall, Upper Saddle River, NJ, 1981. Khodabakhshian, A., and Golbon, N. Design of a New Load Frequency PID Controller Using QFT. Proceedings of the 13th Mediterranean Conference on Control and Automation , 2005, pp. 970‚Äì 975. Kuo, B. C. Automatic Control Systems , 7th ed. Prentice Hall, Upper Saddle River, NJ, 1995. Kuo, B. C. Digital Control Systems . Holt, Rinehart & Winston, New York, 1980. Mahmood, H., and Jiang, J. Modeling and Control System Design of a Grid Connected VSC Considering the Effect of the Interface Transformer Type. IEEE Transactions on Smart Grid, vol. 3, no. 1, March 2012, pp. 122 ‚Äì134. Neogi, B., Ghosh, R., Tarafdar, U., and Das, A. Simulation Aspect of an ArtiÔ¨Å cial Pacemaker. International Journal of Information Technology and Knowledge Management , vol. 3, no. 2, 2010, pp. 723 ‚Äì727. Nyzen, R. J. Analysis and Control of an Eight-Degree-of-Freedom Manipulator , Ohio University Masters Thesis, Mechanical Engineering, Dr. Robert L. Williams II, Advisor, August 1999. Ogata, K. Discrete-Time Control Systems . Prentice Hall, Upper Saddle River, NJ, 1987. Phillips, C. L., and Nagle, H. T. Jr. Digital Control System Analysis and Design . Prentice Hall, Upper Saddle River, NJ, 1984. Prasad, L., Tyagi, B., and Gupta, H. Modeling & Simulation for Optimal Control of Nonlinear Inverted Pendulum Dynamical System using PID Controller and LQR. IEEE Computer Society Sixth Asia Modeling Symposium , 2012, pp. 138 ‚Äì143.Lab Simulate your Prelab design using a Simulation Loop from the LabVIEW Control Design and Simulation Module. Plot the step response of two loops as follows: (1) a unity feedback with the forward path consisting of the continuous system transfer functionpreceded by a zero-order hold, and (2) a unity feedback with the forward path consisting ofthe equivalent discrete transfer function of your compensator in cascade with the open-loopplant. Postlab Compare the results obtained with those from your prelab MATLAB program. Comment on time-performance speci Ô¨Åcations.764 Chapter 13 Digital Control SystemsWEBC13 10/28/2014 20:50:19 Preitl, Z., Bauer, P., and Bokor, J. A Simple Control Solution for Traction Motor Used in Hybrid Vehicles. 4th International Symposium on Applied Computational Intelligence and Informatics . IEEE, 2007, pp. 157 ‚Äì162. Smith, C. L. Digital Computer Process Control . Intext Educational Publishers, NY, 1972. Tasch, U., Koontz, J. W., Ignatoski, M. A., and Geselowitz, D. B. An Adaptive Aortic Pressure Observer for the Penn State Electric Ventricular Assist Device. IEEE Transactions on Biomedical Engineering , vol. 37, 1990, pp. 374 ‚Äì383. Tou, J. Digital and Sampled-Data Control Systems . McGraw-Hill, New York, 1959. Williams, R. L. II. Local Performance Optimization for a Class of Redundant Eight-Degree-of- Freedom Manipulators. NASA Technical Paper 3417 , NASA Langley Research Center, Hampton VA, March 1994.Bibliography 765WEBC13 10/28/2014 20:50:19 Page 766WEBBAPPA 10/29/2014 10:13:13 Appendix A: List of Symbols %OS Percent overshoot A Ampere ‚Äîunit of electrical current A System matrix for state-space representation am Motor time constant B Mechanical rotational coef Ô¨Åcient of viscous friction in N-m-s/rad B Input matrix for state-space representation C Electrical capacitance in farads C Output matrix for state-space representation C(s) Laplace transform of the output of a system c(t) Output of a system CM Controllability matrix D Mechanical rotational coef Ô¨Åcient of viscous friction in N-m-s/rad D Feedforward matrix for state-space representation Da Motor armature coef Ô¨Åcient of viscous damping in N-m-s/rad Dm Total coef Ô¨Åcient of viscous friction at the armature of a motor, including armature coefÔ¨Åcient of viscous friction and reÔ¨Ç ected load coef Ô¨Åcient of viscous friction in N-m-s/rad E Energy E(s) Laplace transform of the error e(t) Error; electrical voltage Ea s¬Ü Laplace transform of the motor armature input voltage; Laplace transform of the actuating signal ea t¬Ü Motor armature input voltage; actuating signal F Farad ‚Äîunit of electrical capacitance F(s) Laplace transform of f(t) f(t) Mechanical force in newtons; general time function fv Mechanical translational coef Ô¨Åcient of viscous friction g Acceleration due to gravity G Electrical conductance in mhos G(s) Forward-path transfer function Gc s¬Ü Compensator transfer function Gc z¬Ü Sampled transfer function for a compensator 767WEBBAPPA 10/29/2014 10:13:13 GM Gain margin Gp z¬Ü Sampled transfer function for a plant H Henry‚Äîunit of electrical inductance H(s) Feedback-path transfer function I Identity matrix i(t) Electrical current in amperes J Moment of inertia in kg-m2 Ja Motor armature moment of inertia in kg-m2 Jm Total moment of inertia at the armature of a motor, including armature moment of inertia and reÔ¨Ç ected load moment of inertia in kg-m2 K Controller gain matrix K Mechanical translational spr ing constant in N/m or rotational spring constant in N-m/rad; ampli Ô¨Åer gain; residue k Controller feedback gain; running index Ka Acceleration constant Kb Back emf constant in V/rad/s Kf Feedback gain kg Kilogram ¬ànewton seconds2=meter‚Äîunit of mass kg-m2Kilogram meters2¬ànewton-meters seconds2/radian‚Äîunit of moment of inertia Km Motor gain Kp Position constant Kt Motor torque constant relating developed torque to armature current in N-m/A Kv Velocity constant L Electrical inductance in henries L Observer gain matrix l Observer feedback gain M Mass in kilograms; slope of the root locus asymptotes m Meter‚Äîunit of mechanical translational displacement M œâ¬Ü Magnitude of a sinusoidal response m/s Meters/second ‚Äîunit of mechanical translational velocity MP Peak magnitude of the sinusoidal magnitude response N Newton ‚Äîunit of mechanical translational force in kilogram meters/second2 N-s/m Newton-seconds/meter ‚Äîunit of mechanical translational coef Ô¨Åcient of viscous friction n System type N/m Newton/meter ‚Äîunit of mechanical translational spring constant N-m Newton-meter ‚Äîunit of mechanical torque N-m-s/ radNewton-meter-seconds/radian‚Äî unit of mechanical rotational coef Ô¨Åcient of viscous friction N-m/A Newton-meter/ampere ‚Äîunit of motor torque constant N-m/rad Newton-meter/radian ‚Äîunit of mechanical rotational spring constant OM Observability matrix P Similarity transformation matrix pc Compensator pole Q Coulomb ‚Äîunit of electrical charge q(t) Electrical charge in coulombs R Electrical resistance in ohms768 Appendix A: List of SymbolsWEBBAPPA 10/29/2014 10:13:13 R(s) Laplace transform of the input to a system r Nonlinear electrical resistance r(t) Input to a system Ra Motor armature resistance in ohms rad Radian ‚Äîunit of angular displacement rad/s Radian/second ‚Äîunit of angular velocity s Second ‚Äîunit of time s Complex variable for the Laplace transform SF:P Sensitivity of Fto a fractional change in P T Time constant; sampling interval for digital signals T(s) Closed-loop transfer function; Laplace transform of mechanical torque T(t) Mechanical torque in N-m Tm(t) Torque at the armature developed by a motor in N-m Tm(s) Laplace transform of the torque at the armature developed by a motor Tp Peak time in seconds Tr Rise time in seconds Ts Settling time in seconds Tw Pulse width in seconds u Input or control vector for state-space representation u Input control signal for state-space representation u(t) Unit step input V-s/rad Volt-seconds/radian ‚Äîunit of motor back emf constant v(t) Mechanical translation velocity in m/s; electrical voltage vb(t) Motor back emf in volts ve(t) Error voltage vp(t) Power ampli Ô¨Åer input in volts x State vector for state-space representation x(t) Mechanical translation displacement in meters; a state variable _x Time derivative of a state variable _x Time derivative of the state vector y Output vector for state-space representation y(t) Output scalar for state-space representation z Complex variable for the z-transform zc Compensator zero Œ± Pole-scaling factor for a lag compensator, where Œ±>1; angle of attack Œ≤ Pole-scaling factor for a lead compensator, where Œ≤<1 Œ≥ Pole-scaling factor for a lag-lead compensator, where Œ≥>1 Œ¥ Thrust angle Œ∂ Damping ratio Œ∏ Angle of a vector with the positive extension of the real axis Œ∏ t¬Ü Angular displacement Œ∏a Angle of a root locus asymptote with the positive extension of the real axis Œ∏c Angular contribution of a compensator on the s-plane Œ∏m t¬Ü Angular displacement of the armature of a motor Œª Eigenvalue of a square matrixAppendix A: List of Symbols 769WEBBAPPA 10/29/2014 10:13:13 œÉ Real part of the Laplace transform variable, s œÉa Real-axis intercept of the root locus asymptotes Œ¶M Phase margin Œ¶ t¬Ü State transition matrix œï Sinusoidal phase angle; body angle œïc Sinusoidal phase angle of a compensator œïmax Maximum sinusoidal phase angle Œ© Ohm‚Äîunit of electrical resistance ‚Ñß Mho‚Äîunit of electrical conductance œâ Imaginary part of the Laplace transform variable, s œâ t¬Ü Angular velocity in rad/s œâBW Bandwidth in rad/s œâd Damped frequency of oscillation in rad/s œâŒ¶M Phase-margin frequency in radians œâGM Gain-margin frequency in radians œân Natural frequency in rad/s œâp Peak-magnitude frequency of the magnitude frequency response in rad/s770 Appendix A: List of SymbolsWEBBAPPB 10/29/2014 9:25:0 Appendix B: MATLAB Tutorial B.1 Introduction MATLAB is a high-level technical computing environment suitable for solving scienti Ô¨Åc and engineering problems. When used with routines from its companion software, the Control System Toolbox, MATLAB can be used to analyze and design control systemsproblems such as those covered in this textbook. MATLAB and the Control SystemToolbox are commercial software products available from MathWorks, Inc., 3 Apple HillDrive, Natick, MA 01760-2098. Phone: (508) 647-7000. Email: info@mathworks.com. URL: www.mathworks.com . The MATLAB examples in this tutorial consist of solved problems that demonstrate the application of MATLAB to the analysis and design of control systems. Many problemswere taken from examples in the text (identi Ô¨Åed with a MATLAB icon) that were solved without MATLAB. A Command Summary at the end of this appendix lists key MATLABstatements and their descriptions. The code in this tutorial is also available in the Control Systems Engineering Toolbox folder at www.wiley.com/college/nise and at www.mathworks.co m/matlabcentral/ Ô¨Åleexchange . You should have MATLAB Version 8.3 (R2014a) and the Control System Toolbox Version 9.7installed on your machine to execute this appendix ‚Äôs code in the Control Systems Engineering Toolbox Version 7. To run the M- Ô¨Åles, Ô¨Årst be sure the Ô¨Åles are either added to the search path in Set Path under the HOME tab in the ENVIRONMENT section or appear in the Current Folder window, which is part of the MATLAB window. To see the computer responses after installing the M- Ô¨Åles, run each problem by typing the M-Ô¨Å le name, such as ch2p1, after the prompt >>¬Üin the Command Window. You may also run the Ô¨Åles by right-clicking the Ô¨Åle name, if it appears in the Current Folder window, and select Run. To view all or part of the M- Ô¨Åle in the Command Window, enter ‚Äútype<Ô¨Åle name >‚Äù or‚Äúhelp<Ô¨Åle name >,‚Äùrespectively, after the prompt. You may also view and make changes to the M- Ô¨Åle by double-clicking the Ô¨Åle in the Current Folder window. This action brings up the editor. After editing, be sure to save the revised Ô¨Åle before executing. If you do not have the Control Systems Engineering Toolbox M- Ô¨Åles, you can create your own M- Ô¨Åles by typing the code for each problem in this appendix into a separate M- Ô¨Åle (thereis no need to type the Ô¨Ånal pause statement or comments), and naming each M- Ô¨Åle with a .m extension, as in ch2p1.m. You can also type the code for more than one probleminto an M-Ô¨Å le, including the pause command, and name the M-Ô¨Å le with the .m extension. You can then call the Ô¨Åle from the Command Window, and continue past the pause statements to the next problem by pressing any key. 771WEBBAPPB 10/29/2014 9:25:1 By its nature, this appendix cannot cover all the background and details necessary for a complete understanding of MATLAB. For further details, you are referred to other sources, including MATLAB reference manuals and instructions speci Ô¨Åc to your particular computer. The bibliography at the end of this appendix provides a partial listing ofreferences. This appendix should give you enough information to be able to applyMATLAB to the analysis and design problems covered in this book. The code will also run on workstations that support MATLAB. Consult the MATLAB Installation Guide for your platform for minimum system hardware requirements. B.2 MATLAB Examples Chapter 2: Modeling in the Frequency Domain ch2p1 Bit strings will be used to identify parts of this tutorial on the computer output. Bit strings are represented by the text enclosed in apostrophes, such as 'ab' . Comments begin with%and are ignored by MATLAB. Numbers are entered without any other characters. Arithmetic can be performed using the proper arithmetic operator. Numbers can be assignedusing a left-hand argument and an equals sign. Finally, we can Ô¨Ånd the magnitude and angle of a complex number, Qusing abs (Q) and angle (Q), respectively. '(ch2p1) ' % Display label. ' How are you? ' % Display string. -3.96 % Display scalar number -3.96. -4 + 7i % Display complex number -4+7i. -5-6j % Display complex number -5-6 j. (-4+7i)+(-5-6i) % Add two complex numbers and % display sum. (-4+7j) * (-5-6j) % Multiply two complex numbers and % display product. M=5 % Assign 5 to M and display. N=6 % Assign 6 to N and display. P=M+N % Assign M+N to P and display. Q=3+4j % Define complex number, Q. MagQ=abs(Q) % Find magnitude of Q. ThetaQ= (180/pi) *angle(Q) % Find the angle of Q in degrees. pause ch2p2 Polynomials in scan be represented as row vectors containing the coef Ô¨Åcients. Thus P1¬às3¬á7s2 3s¬á23 can be represented by the vector shown below with elements separated by a space or comma. Bit strings can be used to identify each section of this tutorial. '(ch2p2) ' % Display label. P1= [1 7 -3 23] % Store polynomial s^3 + 7s^2 -3s+ % 23 as P1 and display. pause ch2p3 Running the previous statements ca uses MATLAB to display the results. Ending the command with a semicolon suppresses the display. Typing an expression without a left-hand assignment and withou t a semicolon causes the expression to be evaluated and the result displayed. Enter P2in the MATLAB Command Window after execution.772 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:1 '(ch2p3) ' % Display label. P2= [3 5 7 8] ; % Assign 3s^3 + 5s^2 +7s + 8 to P2 % without displaying. 3*5 % Evaluate 3*5 and display result. pause ch2p4 AnF(s) in factored form can be represented in polynomial form. Thus P3¬à s¬á2¬Ü s¬á5¬Ü s¬á6¬Ücan be transformed into a polynomial using poly (V) , where Vis a row vector containing the roots of the polynomial and poly(V) forms the coef Ô¨Åcients of the polynomial. '(ch2p4) ' % Display label. P3=poly( [-2 -5 -6] ) % Store polynomial% (s+2) (s+5) (s+6)as P3 and % display the coefficients. pause ch2p5 We can Ô¨Ånd roots of polynomials using the roots (V) command. The roots are returned as a column vector. For example, Ô¨Ånd the roots of 5 s4¬á7s3¬á9s2 3s¬á2¬à0. '(ch2p5) ' % Display label. P4= [5 7 9 -3 2] % Form 5s^4+7s^3+9s^2-3s+2 and% display. rootsP4=roots(P4) % Find roots of 5s^4+7s^3+9s^2%-3s+2,% assign to rootsP4, and display. pause ch2p6 Polynomials can be multiplied together using the conv(a,b) command (stand- ing for convolve). Thus, P5¬à s3¬á7s2¬á10s¬á9¬Ü s4 3s3¬á6s2¬á2s¬á1¬Üis generated as follows: '(ch2p6) ' % Display label. P5=conv( [1 7 10 9],[1 -3 6 2 1] ) % Form (s^3+7s^2+10s+9) (s^4- % 3s^3+6s^2+2s+1) , assign to P5,% and display. pause ch2p7 The partial-fraction expansion for F s¬Ü¬àb s¬Ü=a s¬Ücan be found using the [K, p, k ]= residue (b, a) command ( K= residue; p= roots of denominator; k= direct quotient, which is found by dividing polynomials prior to performing a partial- fraction expansion). We expand F s¬Ü¬à 7s2¬á9s¬á12¬Ü=¬âs s ¬á7¬Ü s2¬á10s¬á100¬Ü¬äas an example. Using the results from MATLAB yields: F s¬Ü¬à¬â 0:2554  0:3382 i¬Ü= s¬á 5:0000 8:6603i¬Ü¬ä¬á¬â 0:2554¬á0:3382i¬Ü= s¬á5:0000¬á8:6603i¬Ü¬ä ¬â0:5280 = s¬á7¬Ü¬ä¬á¬â0:0171 =s¬ä: '(ch2p7) ' % Display label. numf= [7 9 12]; % Define numerator of F(s). denf=conv(poly( [0 -7] ),[1 10 100] ); % Define denominator of F(s).[K,p,k] =residue(numf,denf) % Find residues and assign to K; % find roots of denominator and% assign to p; find% constant and assign to k. pauseB.2 MATLAB Examples 773WEBBAPPB 10/29/2014 9:25:1 ch2p8 (Example 2.3) Let us do Example 2.3 in the book using MATLAB. '(ch2p8) Example 2.3' % Display label. numy=32; % Define numerator. deny=poly( [0 -4 -8] ); % Define denominator. [r,p,k] =residue(numy,deny) % Calculate residues, poles, and % direct quotient. pause ch2p9 Creating Transfer Functions Vector Method, Polynomial Form A transfer function can be expressed as a numerator polynomial divided by a denominator polynomial, that is, F s¬Ü¬àN s¬Ü=D s¬Ü. The numerator, N(s), is represented by a row vector, numf , that contains the coef Ô¨Åcients of N(s). Similarly, the denominator, D(s), is represented by a row vector, denf , that contains the coef Ô¨Åcients of D(s). We form F(s) with the command, F=tf(numf,denf) .Fis called a linear time-invariant (LTI) object. This object, or transfer function, can be used as an entity in other operations, such as addition or multiplication. We demonstrate with F s¬Ü¬à150 s2¬á2s¬á7¬Ü=¬âs s2¬á5s¬á4¬Ü¬ä. Notice after executing the tfcommand, MATLAB prints the transfer function. Vector Method, Factored Form We also can create LTI transfer functions if the numerator and denominator are expressed in factored form. We do this by using rowvectors containing the roots of the numerator and denominator. Thus G s¬Ü¬àK *N s¬Ü=D s¬Ücan be expressed as an LTI object using the command, G=zpk(numg,deng,K) , where numg is a row vector containing the roots of N(s) anddeng is a row vector containing the roots of D(s). The expression zpk stands for zeros (roots of the numerator), poles (roots of the denominator), and gain, K. We demonstrate with G s¬Ü¬à20 s¬á2¬Ü s¬á4¬Ü=¬â s¬á7¬Ü s¬á8¬Ü s¬á9¬Ü¬ä. Notice after executing the zpk command, MATLAB prints the transfer function. Rational Expression in s Method, Polynomial Form (Requires Control SystemToolbox 8.4) This method allows you to type the transfer function as you normally would write it. The statement s=tf( 's ' ) must precede the transfer function if you wish to create an LTI transfer function in polynomial form equivalent to using F=tf(numf, denf) . Rational Expression in s Method, Factored Form (Requires Control SystemToolbox 8.4) This method allows you to type the transfer function as you normally would write it. The statement s=zpk( 's ' ) must precede the transfer function if you wish to create an LTI transfer function in factored form equivalent to using G=zpk(numg,deng,K) . For both rational expression methods the transfer function can be typed in any form regardless of whether s=tf( 's ' ) ors=zpk( 's ' ) is used. The difference is in the created LTI transfer function. We use the same examples above to demonstrate the rationalexpression in smethods. '(ch2p9) ' % Display label. ' Vector Method, Polynomial Form ' % Display label. numf=150* [1 2 7] % Store 150(s^2+2s+7) in numf and % display. denf= [1 5 4 0] % Store s(s+1) (s+4) in denf and% display. ' F(s) ' % Display label. F=tf(numf,denf) % Form F(s) and display. clear % Clear previous variables from% workspace.774 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:2 ' Vector Method, Factored Form' % Display label. numg= [-2 -4] % Store (s+2) (s+4) in numg and % display. deng= [-7 -8 -9] % Store (s+7) (s+8) (s+9) in deng % and display. K=20 % Define K. ' G(s) ' % Display label. G=zpk(numg,deng,K) % Form G(s) and display. clear % Clear previous variables from % workspace. ' Rational Expression Method, Polynomial Form' % Display label. s=tf( 's' ) % Define's'as an LTI object in % polynomial form. F=150* (s^2+2*s+7) / [s* (s^2+... % Form F (s) as an LTI transfer 5*s+4) ] % function in polynomial form. G=20* (s+2) * (s+4) / [ (s+7)*... % Form G(s) as an LTI transfer(s+8) * (s+9) ] % function in polynomial form. clear % Clear previous variables from % workspace. ' Rational Expression Method, Factored Form' % Display label. s=zpk( 's ' ) % Define's 'as an LTI object in % factored form. F=150* (s^2+2 * s+7) / [s * (s^2+5*s+4) ] % Form F(s) as an LTI transfer% function in factored form. G=20* (s+2) * (s+4) / [ (s+7) * (s+8) * (s+9) ] % Form G(s) as an LTI transfer % function in factored form. pause ch2p10 Transfer function numerator and denominator vectors can be converted between polynomial form containing the coef Ô¨Åcients and factored form containing the roots. The MATLAB function, tf2zp(numtf,dentf) , converts the numerator and denominator from coef Ô¨Åcients to roots. The results are in the form of column vectors. We demonstrate this with F s¬Ü¬à 10s2¬á40s¬á60¬Ü= s3¬á4s2¬á5s¬á7¬Ü. The MATLAB function, zp2tf(numzp,denzp,K) , converts the numerator and denominator from roots to coef Ô¨Åcients. The arguments numzp anddenzp must be column vectors. In the demonstration that follows, apostrophes signify transpose. We demonstrate the conver- sion from roots to coef Ô¨Åcients with G s¬Ü¬à10 s¬á2¬Ü s¬á4¬Ü=¬âs s¬á3¬Ü s¬á5¬Ü¬ä. '(ch2p10) ' % Display label. ' Coefficients for F(s) ' % Display label. numftf= [10 40 60] % Form numerator of F(s)= % (10s^2+40s+60)/(s^3+4s^2+5s% +7). denftf= [1 4 5 7] % Form denominator of F(s)=% (10s^2+40s+60)/(s^3+4s^2+5s% +7). ' Roots for F(s) ' % Display label. [numfzp,denfzp] =tf2zp(numftf,denftf) % Convert F(s) to factored form. ' Roots for G(s) ' % Display label. numgzp= [-2 -4] % Form numerator ofB.2 MATLAB Examples 775WEBBAPPB 10/29/2014 9:25:2 K=10 % G(s)=10(s+2)(s+4) / [s(s + 3) % (s+5) ] . dengzp= [0 -3 -5] % Form denominator of% G(s)=10(s+2)(s+4) / [s(s+3)(s+5) ]. ' Coefficients for G(s) ' % Display label. [numgtf,dengtf] =zp2tf(numgzp ' ,dengzp ' ,K) % Convert G(s) to polynomial form. pause ch2p11 LTI models can also be converted between polynomial and factored forms. MATLAB commands tfandzpk are also used for the conversion between LTI models. If a transfer function, Fzpk(s), is expressed as factors in the numerator and denominator, then tf (Fzpk) converts Fzpk( s) to a transfer function expressed as coef Ô¨Åcients in the numerator and denominator. Similarly, if a transfer function, Ftf(s), is expressed as coef Ô¨Åcients in the numerator and denominator, then zpk(Ftf) converts Ftf(s) to a transfer function expressed as factors in the numerator and denominator. The following example demonstrates the concepts. ' (ch2p11) ' % Display label. 'Fzpk1(s) ' % Display label. Fzpk1=zpk( [-2 -4] , [0 -3 -5] ,10) % Form Fzpk1(s)= % 10(s+2) (s+4) / [s(s+3) (s+5) ] . 'Ftf1 ' % Display label. Ftf1=tf(Fzpk1) % Convert Fzpk1(s) to% coefficients form. 'Ftf2 ' % Display label. Ftf2=tf( [10 40 60] ,[1 4 5 7] ) % Form Ftf2(s)=% (10s^2+40s+60) / (s^3+4s^2+5s% +7) . 'Fzpk2 ' % Display label. Fzpk2=zpk(Ftf2) % Convert Ftf2(s) to% factored form. pause ch2p12 Functions of time can be easily plotted using MATLAB‚Äô splot(X,Y,S) , where Xis the independent variable, Yis the dependent variable, and Sis a character string describing the plot ‚Äôs color, marker, and line characteristic. Type HELP PLOT in the Command Window to see a list of choices for S. Multiple plots also can be obtained using plot (X1,Y1,S1,X2,Y2,S2,X3,Y3,S3, . . . ). In the following example we plot on the same graph sin(5 t) in red and cos(5 t) in green for t¬à0 to 10 seconds in 0.01 second increments. Time is speci Ô¨Åed as t=start: increment: Ô¨Ånal. ' (ch2p12) ' % Display label. t=0:0.01:10; % Specify time range and increment. f1=cos(5*t); % Specify f1 to be cos(5t). f2=sin(5*t); % Specify f2 to be sin (5t). plot(t,f1, ' r ' ,t,f2, ' g ' ) % Plot f1 in red and f2 in green. pause Chapter 3: Modeling in the Time Domain ch3p1 The square system matrix, A¬à010 001  9 8 72 435is written with a space or comma776 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:2 separating the elements of each row. The next row is indicated with a semicolon or carriage return. The entire matrix is then enclosed in a pair of square brackets. '(ch3p1) ' % Display label. A= [0 1 0;0 0 1; -9 -8 -7] % Represent A. 'o r ' A= [0 1 0 % Represent A. 001 -9 -8 -7]pause ch3p2 A row vector, such as the output matrix C, can be represented with elements separated by spaces or commas and enclosed in square brackets. A column vector, such as input matrix B, can be written as elements separated by semicolons or carriage returns, or as the transpose ( ‚Äô) of a row vector. '(ch3p2) ' % Display label. C= [2 3 4] % Represent row vector C. B= [7;8;9] % Represent column vector B. 'o r ' B= [7 % Represent column vector B. 8 9] 'o r ' B= [7 8 9]' % Represent column vector B. pause ch3p3 The state-space representation consists of specifying the A,B,C,a n dD matrices followed by the creation of an LTI state-space object using the MATLAB command, ss(A,B,C,D) . Hence, for the matrices in (ch3p1) and (ch3p2), the state-space representation would be: ' (ch3p3) ' % Display label. A= [0 1 0;0 0 1;-9 -8 -7]; % Represent A. B= [7;8;9] ; % Represent column vector B. C= [2 3 4] ; % Represent row vector C. D=0; % Represent D. F=ss(A,B,C,D) % Create an LTI object and display. ch3p4 (Example 3.4) Transfer functions represented either by numerator and denominator or an LTI object can be converted to state space. For numerator and denominator representa-tion, the conversion can be implemented using [A, B, C, D] =tf2ss(num,den) .T h e A matrix is returned in a form called the controller canonical form, which will be explained inChapter 5 in the text. To obtain the phase-variable form, [Ap,Bp,Cp,Dp] , we perform the following operations: Ap=inv (P) *A*P;Bp=inv (P) *B;Cp=C*P,Dp=D ,w h e r eP is a matrix with 1 ‚Äôs along the anti-diagonal and 0 ‚Äôs elsewhere. These transformations will be explained in Chapter 5. The command inv (X) Ô¨Ånds the inverse of a square matrix. The symbol * signi Ô¨Åes multiplication. For systems represented as LTI objects, the command ss(F) ,w h e r e Fis an LTI transfer-function object, can be used to convert Fto a state-space object. Let us look at Example 3.4 in the text. For the numerator-denominator representation,notice that the MATLAB response associates the gain, 24, with the vector Crather than the vector Bas in the example in the text. Both representations are equivalent. For the LTI transfer- function object, the conversion to state space does not yield the phase-variable form. The resultB.2 MATLAB Examples 777WEBBAPPB 10/29/2014 9:25:3 is a balanced model that improves the accuracy of calculating eigenvalues, which are covered in Chapter 4. Since ss(F) does not yield familiar forms of the state equations (nor is it possible to easily convert to familiar forms), we will have limited use for that transformation at this time. '(ch3p4) Example 3.4' % Display label. ' Numerator-denominator representation conversion' % Display label. ' Controller canonical form' % Display label. num=24; % Define numerator of % G(s) =C(s)/R(s). den= [1 9 26 24]; % Define denominator of G(s). [A,B,C,D] =tf2ss(num,den) % Convert G(s) to controller % canonical form, store matrices % A, B, C, D, and display. ' Phase-variable form' % Display label. P= [0 0 1;0 1 0;1 0 0]; % Form transformation matrix. Ap=inv(P) *A*P % Form A matrix, phase-variable% form. Bp=inv(P) *B % Form B vector, phase-variable% form. Cp=C*P % Form C vector, phase-variable % form. Dp=D % Form D phase-variable form. ' LTI object representation ' % Display label. T=tf(num,den) % Represent T(s) =24/(s^3+9s^2 +% 26s+24) as an LTI transfer- % function object. Tss=ss(T) % Convert T(s) to state space. pause ch3p5 State-space representations can be converted to transfer functions represented by a numerator and a denominator using [num,den] =ss2tf(A,B,C,D,iu) , where iu is the input number for multiple-input systems. For single-input, single-output systems iu=1 . For an LTI state-space system, Tss, the conversion can be implemented using Ttf=tf(Tss) to yield the transfer function in polynomial form or Tzpk=zpk(Tss) to yield the transfer function in factored form. For example, the transfer function representedby the matrices described in (ch3p3) can be found as follows: ' (ch3p5) ' % Display label. ' Non LTI' % Display label. A= [0 1 0;0 0 1;-9 -8 -7]; % Represent A. B= [7;8;9]; % Represent B. C= [2 3 4]; % Represent C. D=0; % Represent D. ' Ttf(s) ' % Display label. [num,den] =ss2tf(A,B,C,D,1) % Convert state-space % representation to a % transfer function represented as % a numerator and denominator in% polynomial form, G(s) =num/den, % and display num and den. ' LTI ' % Display label. Tss=ss(A,B,C,D) % Form LTI state-space model. ' Polynomial form, Ttf(s) ' % Display label.778 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:3 Ttf=tf(Tss) % Transform from state space to % transfer function in polynomial % form. ' Factored form, Tzpk(s) ' % Display label. Tzpk=zpk(Tss) % Transform from state space to % transfer function in factored % form. pause Chapter 4: Time Response ch4p1 (Example 4.6) We can use MATLAB to calculate characteristics of a second-order system, such as damping ratio, Œ∂; natural frequency, œân; percent overshoot, %OS (pos); settling time, Ts; and peak time, Tp. Let us look at Example 4.6 in the text. '(ch4p1) Example 4.6' % Display label. p1= [1 3+7*i]; % Define polynomial containing % first pole. p2= [1 3-7*i]; % Define polynomial containing% second pole. deng=conv(p1,p2); % Multiply the two polynomials to% find the 2nd order polynomial, % as^2+bs+c. omegan=sqrt(deng(3)/deng(1) ) % Calculate the natural frequency, % sqrt(c/a). zeta= (deng(2)/deng(1) )/ (2*omegan) % Calculate damping ratio, % ( (b/a)/2*wn). Ts=4/(zeta*omegan) % Calculate settling time,% (4/z*wn). Tp=pi/ (omegan*sqrt(1 -zeta^2) ) % Calculate peak time, % pi/wn*sqrt(1 -z^2). pos=100*exp(-zeta* pi/sqrt(1 -zeta^2) ) % Calculate percent overshoot% (100*e^(-z*pi/sqrt(1-z^2) ). pause ch4p2 (Example 4.8) We can use MATLAB to obtain system step responses. These responses are particularly valuable when the system is not a pure two-pole system and has additional poles or zeros. We can obtain a plot of the step response of a transfer function, T(s)=num/den , using the command step(T) , where Tis an LTI transfer-function object. Multiple plots also can be obtained using step(T1,T2,...). Information about the plots obtained with step(T) can be found by left-clicking the mouse on the curve. You can Ô¨Ånd the curve ‚Äôs label as well as the coordinates of the point on which you clicked. Right-clicking away from a curve brings up a menu. From this menu youcan select (1) system responses to be displayed and (2) response characteristics to bedisplayed, such as peak response. When selected, a dot appears on the curve at the appropriate point. Let your mouse rest on the point to read the value of the characteristic. You may also select (3) choice for grid on or off, (4) choice to normalize the curve, and(5) properties, such as labels, limits, units, style, and characteristics. If we add the left-hand side, [y,t] =step(T) , we create vectors containing the plot ‚Äôs points, where yis the output vector and tis the time vector. For this case, a plot is not made until the plot(t,y) command is given, where we assume we want to plot the output (y) versus time (t). We can label the plot, the x-axis, and the y-axis with title( 'ab ' ) , xlabel( 'ab ' ) , and ylabel( 'ab ' ) , respectively. The command clf clears the graphB.2 MATLAB Examples 779WEBBAPPB 10/29/2014 9:25:3 prior to plotting. Finally, text can be placed anywhere on the graph using the command text(X,Y, 'text ' ) , where (X,Y) are the graph coordinates where 'text ' will be displayed. Let us look at Example 4.8 in the text. '(ch4p2) Example 4.8 ' % Display label. ' Test Run ' % Display label. clf % Clear graph. numt1= [24.542]; % Define numerator of T1. dent1= [1 4 24.542]; % Define denominator of T1. ' T1(s) ' % Display label. T1=tf(numt1,dent1) % Create and display T1(s). step(T1) % Run a demonstration step response % plot title ( ' Test Run of T1(s) ' ) % Add title to graph. pause ' Complete Run ' % Display label. [y1,t1] =step(T1) ; % Run step response of T1 and% collect points. numt2= [245.42]; % Define numerator of T2. p1= [1 10]; % Define (s+10) in denominator% of T2. p2= [1 4 24.542]; % Define (s^2+4s+24.542) in% denominator of T2. dent2=conv(p1,p2); % Multiply (s + 10)(s^2+4s+24.542) % for denominator of T2. ' T2(s) ' % Display label. T2=tf(numt2,dent2) % Create and display T2. [y2,t2] =step(T2); % Run step response of T2 and% collect points. numt3= [73.626]; % Define numerator of T3. p3= [1 3]; % Define (s+3) in denominator% of T3. dent3=conv(p3,p2); % Multiply (s+3) (s^2+4s+24.542) % for denominator of T3. ' T3(s) ' % Display label. T3=tf(numt3,dent3) % Create and display T3. [y3,t3] =step(T3); % Run step response of T3 and % collect points. clf % Clear graph. plot(t1,y1,t2,y2,t3,y3) % Plot acquired points with all % three plots on one graph. title ( ' Step Responses of T1(s),T2 (s), and T3(s) ' ) % Add title to graph. xlabel( ' Time(seconds) ' ) % Add time axis label. ylabel ( ' Normalized Response ' ) % Add response axis label.text(0.7,0.7, ' c3(t) ' ) % Label step response of T1. text(0.7,1.1, ' c2(t) ' ) % Label step response of T2. text(0.5,1.3, ' c1(t) ' ) % Label step response of T3. pausestep(T1,T2,T3) % Use alternate method of plotting% step responses. title ( ' Step Responses of T1 (s), T2(s), and T3(s) ') % Add title to graph. pause ch4p3 We also can plot the step response of systems represented in state space using the step(T,t) command. Here Tis any LTI object and t=a:b:c is the range for the time axis,780 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:4 where ais the initial time, bis the time step size, and cis the Ô¨Ånal time. For example, t=0:1:10 means time from 0 to 10 seconds in steps of 1 second. The tÔ¨Åeld is optional. Finally, in this example we introduce the command grid on, which superimposes a grid over the step response. Place the grid on command after the step(T,t) command. ' (ch4p3) ' % Display label. clf % Clear graph. A= [0 1 0;0 0 1;-24 -26 -9]; % Generate A matrix. B= [0;0;1]; % Generate B vector. C= [2 7 1]; % Generate C vector. D=0; % Generate D. T=ss(A,B,C,D) % Generate LTI object, T, in state % space and display. t=0:0.1:10; % Define range of time for plot. step(T,t) % Plot step response for given% range of time. grid on % Turn grid on for plot. pause ch4p4 (Antenna Control Case Study) We now use MATLAB to plot the step response requested in the Antenna Control Case Study. ' (ch4p4) Antenna Control Case Study' % Display label. clf % Clear graph.numg=20.83; % Define numerator of G(s). deng= [1 101.71 171]; % Define denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Form and display transfer% Function G(s). step(G); % Generate step response. title( ' Angular Velocity Response ' ) % Add title. pause ch4p5 (UFSS Case Study) As aÔ¨Ånal example, let us use MATLAB to do the UFSS Case Study in the text ( Johnson ,1980 ). We introduce table lookup to Ô¨Ånd the rise time. Using the interp1(y,t,y1) command, we set up a table of values of amplitude, y, and time, t, from the step response and look for the value of time for which the amplitude is y1=0.1 and 0.9. We also generate time response data over a de Ô¨Åned range of time using t=a:b:c followed by [y,t] =step(G,t) . Here Gis an LTI transfer-function object and tis the range for the time axis, where ais the initial time, bis the time step size, and cis the Ô¨Ånal time; yis the output. ' (ch4p5) UFSS Case Study' % Display label. clf % Clear graph. ' (a) ' % Display label. numg=0.0169; % Define numerator of 2nd order % approximation of G(s). deng= [1 0.226 0.0169]; % Define 2nd order term of % denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). omegan=sqrt(deng(3) ) % Find natural frequency. zeta=deng(2)/ (2*omegan) % Find damping ratio. Ts=4/ (zeta*omegan) % Find settling time. Tp=pi/ (omegan*sqrt(1-zeta^2) ) % Find peak time.B.2 MATLAB Examples 781WEBBAPPB 10/29/2014 9:25:4 pos=exp (-zeta*pi/sqrt(1-zeta^2) ) *100 % Find percent overshoot. t=0:0.1:35; % Limit time to find rise time. t=0 % to 35 in steps of 0.1. [y,t] =step(G,t); % Generate and save points of step % response over defined range of t. Tlow=interp1(y,t,0.1); % Search table for time when % y=0.1*finalvalue. Thi=interp1(y,t,0.9); % Search table for % time=0.9*finalvalue. Tr=Thi-Tlow % Calculate rise time. ' (b) ' % Display label. numc=0.125* [1 0.435]; % Define numerator of C(s). denc=conv(poly( [0 -1.23] ),[1 0.226 0.0169] ); % Define denominator of C(s). [K,p,k] =residue(numc,denc) % Find partial-fraction expansion. ' (d) ' % Display label. numg=0.125* [1 0.435]; % Define numerator of G(s). deng=conv( [1 1.23],[1 0.226 0.0169] ); % Define denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). [y,t] =step(G); % Generate complete step response % and collect points. plot(t,y) % Plot points. title ( ' Pitch Angle Response' ) % Add title.xlabel( ' Time(seconds) ' ) % label time axis. ylabel ( ' Pitch Angle (radians) ' ) % Label y-axis.pause Chapter 5: Reduction of Multiple Subsystems ch5p1 (UFSS Pitch Control System) MATLAB can be used for block diagram reduction. Three methods are available: (1) Solution via Series, Parallel, & Feedback Commands, (2) Solution via Algebraic Operations, and (3) Solution via Append & ConnectCommands. Let us look at each of these methods. Solution via Series, Parallel, & Feedback Commands The closed-loop transfer function is obtained using the following commands succes-sively, where the arguments are LTI objects: series(G1,G2) for a cascade connec- tion of G 1(s); and G2(s);parallel(G1,G2) for a parallel connection of G1(s) and G2(s);feedback(G,H,sign)for a closed-loop connection with G(s) as the forward path, H(s) as the feedback, and sign is‚Äì1 for negative-feedback systems or +1 for positive-feedback systems. The sign is optional for negative-feedback systems. Solution via Algebraic Operations Another approach is to use arithmetic operations successively on LTI transfer functionsas follows: G2*G1 for a cascade connection of G 1(s) and G2(s);G1+G2 for a parallel connection of G1(s) and G2(s);G/(1+G*H) for a closed-loop negative-feedback connection with G(s) as the forward path and H(s) as the feedback; G/ (1-G *H)for positive-feedback systems. When using division we follow with the function minreal (sys) to cancel common terms in the numerator and denominator. Solution via Append & Connect Commands The last method, which de Ô¨Ånes the topology of the system, may be used effectively for complicated systems. First, the subsystems are de Ô¨Åned. Second, the subsystems are782 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:4 appended, or gathered, into a multiple-input/multiple-output system. Think of this system as a single system with an input for each of the subsystems and an output for each of the subsystems. Next, the external inputs and outputs are speci Ô¨Åed. Finally, the subsystems are interconnected. Let us elaborate on each of these steps. The subsystems are de Ô¨Åned by creating LTI transfer functions for each. The subsystems are appended using the command G=append(G1,G2,G3,G4, . . . . .Gn) ,w h e r e theGiare the LTI transfer functions of the subsystems and Gis the appended system. Each subsystem is now identi Ô¨Åed by a number based upon its position in the append argument. For example, G3is 3, based on the fact that it is the third subsystem in the append argument (not the fact that we write it as G3). Now that we have created an appended system, we form the arguments required to interconnect their inputs and outputs to form our system. The Ô¨Årst step identi Ô¨Åes which subsystems have the external input signal and which subsystems have the external outputsignal. For example, we use inputs= [1 5 6] andoutputs= [3 4] to de Ô¨Åne the external inputs to be the inputs of subsystems 1,5, and 6 and the external outputs to be theoutputs of subsystems 3 and 4. For single-input/single-output systems, these de Ô¨Ånitions use scalar quantities. Thus inputs=5,outputs=8 deÔ¨Åne the input to subsystem 5 as the external input and the output of subsystem 8 as the external output. At this point we tell the program how all of the subsystems are interconnected. We form a Qmatrix that has a row for each subsystem whose input comes from another subsystem ‚Äôs output. The Ô¨Årst column contains the subsystem ‚Äôs number. Subsequent columns contain the numbers of the subsystems from which the inputs come. Thus, atypical row might be as follows: [3 6  7], or subsystem 3 ‚Äôs input is formed from the sum of the output of subsystem 6 and the negative of the output of subsystem 7. Finally, all of the interconnection arguments are used in the connect(G Q inputs, outputs) command, where all of the arguments have been previously de Ô¨Åned. Let us demonstrate the three methods for Ô¨Ånding the total transfer function by looking at the back endpapers and Ô¨Ånding the closed-loop transfer function of the pitch control loop for the UFSS with K 1¬àK2¬à1(Johnson, 1980 ). The last method using append and connect requires that all subsystems be proper (the order of the numerator cannot begreater than the order of the denominator). The pitch rate sensor violates this require-ment. Thus, for the third method, we perform some block diagram maneuvers by pushingthe pitch rate sensor to the left past the summing junction and combining the resulting blocks with the pitch gain and the elevator actuator. These changes are re Ô¨Çected in the program. You should verify all computer results with hand calculations. ' (ch5p1) UFSS Pitch Control System' ' Solution via Series, Parallel, & Feedback Commands' % Display labels. numg1= [-1]; % Define numerator of G1(s). deng1= [1]; % Define denominator of G1(s). numg2= [0 2]; % Define numerator of G2(s). deng2= [1 2]; % Define denominator of G2 (s). numg3=-0.125* [1 0.435]; % Define numerator of G3(s). deng3=conv( [1 1.23],[1 0.226 0.0169] ); % Define denominator of G3(s). numh1= [-1 0]; % Define numerator of H1(s). denh1= [0 1]; % Define denominator of H1(s). G1=tf(numg1,deng1); % Create LTI transfer function, % G1(s). G2=tf(numg2,deng2); % Create LTI transfer function,% G2(s). G3=tf(numg3,deng3); % Create LTI transfer function, % G3(s).B.2 MATLAB Examples 783WEBBAPPB 10/29/2014 9:25:4 H1=tf (numh1,denh1); % Create LTI transfer function, % H1(s). G4=series(G2,G3); % Calculate product of elevator% and vehicle dynamics. G5=feedback(G4,H1); % Calculate closed-loop transfer% function of inner loop. Ge=series(G1,G5); % Multiply inner-loop transfer% function and pitch gain. ' T(s) via Series, Parallel, & Feedback Commands ' % Display label. T=feedback(Ge,1) % Find closed-loop transfer% function. ' Solution via Algebraic Operations ' % Display label. clear % Clear session. numg1= [-1]; % Define numerator of G1(s). deng1= [1]; % Define denominator of G1(s). numg2= [0 2]; % Define numerator of G2(s). deng2= [1 2]; % Define denominator of G2(s). numg3=-0.125* [1 0.435]; % Define numerator of G3(s). deng3=conv( [1 1.23],[1 0.226 0.0169] ); % Define denominator of G3(s). numh1= [-1 0]; % Define numerator of H1(s). denh1= [0 1]; % Define denominator of H1(s). G1=tf (numg1,deng1); %Create LTI transfer function, G1(s) . G2=tf (numg2,deng2); %Create LTI transfer function, G2(s) . G3=tf (numg3,deng3); %Create LTI transfer function, G3(s) . H1=tf (numh1,denh1); %Create LTI transfer function, H1(s) . G4=G3*G2; % Calculate product of elevator and % vehicle dynamics. G5=G4/ (1+G4*H1); % Calculate closed-loop transfer % function of inner loop. G5=minreal(G5); % Cancel common terms. Ge=G5*G1; % Multiply inner-loop transfer% functions. ' T(s) via Algebraic Operations' % Display label. T=Ge/ (1+Ge); %Find closed-loop transfer function. T=minreal(T) % Cancel common terms. 'Solution via Append & Connect Commands' % Display label. ' G1(s) = (-K1) * (1/ (-K2s) )=1/s' % Display label. numg1= [1]; % Define numerator of G1(s). deng1= [1 0]; % Define denominator of G1(s). G1=tf(numg1,deng1) % Create LTI transfer function,% G1(s) =pitch gain* % 1 (1/Pitch rate sensor). ' G2(s) = (-K2s) * (2/ (s+2) ' % Display label. numg2= [-2 0]; % Define numerator of G2(s). deng2= [1 2]; % Define denominator of G2(s). G2=tf(numg2,deng2) % Create LTI transfer function, % G2(s)=pitch rate sensor*vehicle % dynamics. ' G3(s)=-0.125(s +0.435) / ( (s+1.23)(s^2+0.226s+0.0169) ) ' % Display label. numg3=-0.125* [1 0.435]; % Define numerator of G3(s). deng3=conv( [1 1.23],[1 0.226 0.0169] ); % Define denominator of G3(s).784 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:5 G3=tf(numg3,deng3); % Create LTI transfer function, % G3(s) =vehicle dynamics. System=append(G1,G2,G3) % Gather all subsystems. input=1; % Input is at first subsystem,% G1(s). output=3; % Output is output of third % subsystem, G3(s). Q= [1 -3 0 % Subsystem 1, G1(s), gets its % input from the negative of the % output of subsystem 3, G3(s). 2 1 -3 % Subsystem 2, G2(s), gets its % input from subsystem 1, G1(s), % and the negative of the output % of subsystem 3, G3(s). 3 2 0]; % Subsystem 3, G3(s), gets its % input from subsystem 2, G2(s). T=connect(System,Q,input,output); % Connect the subsystems. ' T(s) via Append & Connect Commands' % Display label. T=tf(T); % Create LTI closed-loop transfer % function. T=minreal(T) % Cancel common terms. pause ch5p2 (Example 5.3) We can use MATLAB to calculate the closed-loop characteristics of a second-order system, such as damping ratio, Œ∂; natural frequency, œân; percent overshoot, %OS (pos); settling time, Ts; and peak time, Tp. The command [numt,dent] =tfdata(T, 'v' ) extracts the numerator and denominator of T(s) for a single-input/single-output system from which the calculations are based. The argument 'v'returns the numerator and denominator as simple row vectors. Omitting 'v' would return the numerator and denominator as cell arrays requiring more steps to obtain the row vectors. We end by generating a plot of the closed-loop step response. Let us look at Example 5.3 in the text. ' (ch5p2) Example 5.3 ' % Display label. numg= [25]; % Define numerator of G(s). deng=poly( [0 -5] ); % Define denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). ' T(s) ' % Display label. T=feedback(G,1) % Find T(s). [numt,dent]=tfdata(T, 'v' ); % Extract numerator & denominator % of T(s). wn=sqrt(dent(3) ) % Find natural frequency. z=dent(2)/(2*wn) % Find damping ratio. Ts=4/ (z*wn) % Find settling time. Tp=pi/ (wn*sqrt(1-z^2) ) % Find peak time. pos=exp(-z*pi/sqrt(1-z^2) ) *100 % Find percent overshoot. step(T) % Generate step response. pause ch5p3 MATLAB can be used to convert transfer functions to state space in a speci Ô¨Åed form. The command [Acc Bcc Ccc Dcc] =tf2ss(num,den) can be used to convert T(s)=num/den into controller canonical form with matrices and vectors Acc, Bcc, Ccc, andDcc. We can then form an LTI state-space object using Scc=ss (Acc,Bcc,Ccc,Dcc) . This object can then be converted into parallel formB.2 MATLAB Examples 785WEBBAPPB 10/29/2014 9:25:5 using Sp=canon(Scc, ' type ' ) , where type=modal yields the parallel form. Another choice, not used here, is type=companion , which yields a right companion system matrix. Transformation matrices can be used to convert to other representations. As an example, let us convert C s¬Ü=R s¬Ü¬à24=¬â s¬á2¬Ü s¬á3¬Ü s¬á4¬Ü¬äinto a parallel representation in state space, as is done in Section 5.7 ‚ÄîParallel Form. Notice that the product of values in theBandCvectors yields the same product as the results in Eqs. (5.49) and (5.50). Thus, the two solutions are the same, but the state variables are ordered differently, and the gains aresplit between the BandCvectors. We can also extract the system matrices from the LTI object using [A,B,C,D] =ssdata(S) ,w h e r e Sis a state-space LTI object and A, B, C, D, are its associated matrices and vectors. ' (ch5p3) ' % Display label. numt=24; % Define numerator of T(s). dent=poly( [-2 -3 -4] ); % Define denominator of T(s). ' T(s) ' % Display label. T=tf(numt,dent) % Create and display T(s). [Acc Bcc Ccc Dcc] =tf2ss(numt,dent); % Convert T(s) to controller % canonical form. Scc=ss(Acc,Bcc,Ccc,Dcc); % Create LTI controller canonical % state-space object. Sp=canon(Scc, 'modal ' ); % Convert controller canonical form% to parallel form. ' Controller Canonical Form ' % Display label. [Acc,Bcc,Ccc,Dcc] =ssdata(Scc) % Extract and display controller % canonical form matrices. ' Parallel Form ' % Display label. [Ap,Bp,Cp,Dp] =ssdata(Sp) % Extract and display parallel form % matrices. pause ch5p4 (Example 5.9) We can use MATLAB to perform similarity transformations to obtain other forms. Let us look at Example 5.9 in the text. ' (ch5p4) Example 5.9 ' % Display label. Pinv= [2 0 0; 3 2 0; 1 4 5]; % Define P inverse. P=inv(Pinv) % Calculate P. 'Original ' % Display label. Ax= [0 1 0;0 0 1;-2 -5 -7] % Define original A. Bx= [0 0 1] % Define original B. Cx= [1 0 0] % Define original C. 'Transformed' % Display label. Az=Pinv*Ax*P % Calculate new A. Bz=Pinv*Bx % Calculate new B. Cz=Cx*P % Calculate new C. pause ch5p5 Using MATLAB ‚Äôs[P,d]=eig(A) command, where the columns of Pare the eigenvectors of Aand the diagonal elements of dare the eigenvalues of A, we can Ô¨Ånd the eigenvectors of the system matrix and then proceed to diagonalize the system. We can also usecanon (S, ' modal ' ) to diagonalize an LTI object, S, represented in state space. ' (ch5p5) ' % Display label. A= [3 1 5;4 -2 7;2 3 1]; % Define original A. B= [1;2;3]; % Define original B.786 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:5 C= [2 4 6]; % Define original C. [P,d] =eig(A) % Generate transformation matrix, % P, and eigenvalues, d. ' Via Transformation ' % Display label. Adt=inv(P) *A*P % Calculate diagonal system A. Bdt=inv(P) *B % Calculate diagonal system B. Cdt=C*P % Calculate diagonal system C. ' Via Canon Command' % Display label. S=ss(A,B,C,0) % Create state-space LTI object% for original system. Sp=canon(S, 'modal ' ) % Calculate diagonal system via % canon command. pause Chapter 6: Stability ch6p1 (Example 6.7) MATLAB can solve for the poles of a transfer function in order to determine stability. To solve for the poles of T(s) use the pole(T) command. Let us look at Example 6.7 in the text. ' (ch6p1) Example 6.7 ' % Display label. numg=1; % Define numerator of G(s). deng=conv ( [1 0] , [2 3 2 3 2] ); % Define denominator of G(s).G=tf(numg,deng); % Create G(s) object. ' T(s) ' % Display label. T=feedback(G,1) % Calculate closed-loop T(s)% object. % Negative feedback is default % when there is no sign parameter. poles=pole(T) % Find poles of T(s). pause ch6p2 (Example 6.9) We can use MATLAB to Ô¨Ånd the range of gain for stability by generating a loop, changing gain, and Ô¨Ån d i n ga tw h a tg a i nw eo b t a i nr i g h t ‚Äìhalf-plane poles. ' (ch6p2) Example 6.9 ' % Display label. K= [1:1:2000]; % Define range of K from 1 to 2000% in steps of 1. for n=1:length(K); % Set up length of DO LOOP to equal% number of K values to be tested. dent= [1 18 77 K(n) ]; % Define the denominator of T(s) % for the nth value of K. poles=roots(dent); % Find the poles for the nth value %o fK . r=real(poles); % Form a vector containing the real% parts of the poles for K(n). if max(r) >=0, % Test poles found for the nth % value of K for a real value 0. poles % Display first pole values where% there is a real part 0. K=K(n) % Display corresponding value of K. break % Stop loop if rhp poles are found. end % End if. end % End for. pauseB.2 MATLAB Examples 787WEBBAPPB 10/29/2014 9:25:6 ch6p3 (Example 6.11) We can use MATLAB to determine the stability of a system represented in state space by using the command eig(A) toÔ¨Ånd the eigenvalues of the system matrix, A.Let us apply the concept to Example 6.11 in the text. ' (ch6p3) Example 6.11 ' % Display label. A= [0 3 1;2 8 1;-10 -5 -2] % Define system matrix, A. eigenvalues=eig(A) % Find eigenvalues. pause Chapter 7: Steady-State Errors ch7p1 (Example 7.4, sys. b) Static error constants are found using lim snG(s)a s s¬Æ0. Once the static error constant is found, w e can evaluate the steady-state error. To evaluate the static error constant we can use the command dcgain(G),w h i c h evaluates G(s)a ts¬à0. Let us look at Example 7.4, system (b), in the text. ' (ch7p1) Example 7.4, sys.b ' % Display label. numg=500*poly( [-2 -5 -6] ); % Define numerator of G(s). deng=poly( [0 -8 -10 -12] ); % Define denominator of G(s). G=tf(numg,deng); % Form G(s). ' Check Stability ' % Display label. T=feedback(G,1); % Form T(s). poles=pole(T) % Display closed-loop poles. ' Step Input ' % Display label. Kp=dcgain(G) % Evaluate Kp=numg/deng for s=0. ess=1/(1+Kp) % Evaluate ess for step input. ' Ramp Input ' % Display label. numsg=conv( [1 0],numg); % Define numerator of sG(s). densg=poly( [0 -8 -10 -12] ); % Define denominator of sG(s). sG=tf(numsg,densg); % Create sG(s). sG=minreal(sG); % Cancel common' s 'in % numerator(numsg) and % denominator(densg). Kv=dcgain(sG) % Evaluate Kv=sG(s) for s=0. ess=1/Kv % Evaluate steady-state error for % ramp input. ' Parabolic Input ' % Display label. nums2g=conv( [1 0 0],numg); % Define numerator of s^2G(s). dens2g=poly( [0 -8 -10-12] ); % Define denominator of s^2G(s). s2G=tf(nums2g,dens2g); % Create s^2G(s). s2G=minreal(s2G); % Cancel common' s 'in % numerator(nums2g) and % denominator(dens2g). Ka=dcgain(s2G) % Evaluate Ka=s^2G(s) for s=0. ess=1/Ka % Evaluate steady-state error for% parabolic input. pause ch7p2 (Example 7.6) We can use MATLAB to evaluate the gain, K, required to meet a steady-state error speci Ô¨Åcation. Let us look at Example 7.6 in the text. ' (ch7p2) Example 7.6' % Display label. numgdK= [1 5]; % Define numerator of G(s)/K. dengdK=poly( [0 -6 -7 -8] ); % Define denominator of G(s)/K. GdK=tf(numgdK,dengdK); % Create G(s)/K. numgkv=conv( [1 0],numgdK); % Define numerator of sG(s)/K.788 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:6 dengkv=dengdK; % Define denominator of sG(s) /K. GKv=tf(numgkv,dengkv); % Create sG(s)/K. GKv=minreal(GKv); % Cancel common' s 'in numerator % and denominator of sG(s) /K. KvdK=dcgain(GKv) % Evaluate (Kv/K)= (numgkv/dengkv)% for s=0. ess=0.1 % Enumerate steady-state error. K=1/ (ess*KvdK) % Solve for K. ' Check Stability' % Display label. T=feedback(K*GdK,1); % Form T(s). poles=pole(T) % Display closed-loop poles. pause Chapter 8: Root Locus Techniques ch8p1 (Example 8.7) MATLAB allows root loci to be plotted with the rlocus(GH) command, where G(s)H(s)=numgh/dengh andGHis an LTI transfer-function object. Points on the root locus can be selected interactively using the [K,p]=rlocÔ¨Å nd(GH) command. MATLAB then yields the gain (K) at that point as well as all other poles (p ) that have that gain. We can zoom in and out of the root locus by changing the range of axis values using the command axis( [xmin,xmax, ymin,ymax] ). The root locus can be drawn over a grid that shows constant damping ratio (z) and constant natural frequency (wn) curves using the sgrid (z,wn) command. To plot multiple Œ∂andœân curves, use z=zmin:zstep:zmax andwn=wnmin:wn-step:wnmax to specify ranges of values. ' (ch8p1) Example 8.7' % Display label. clf % Clear graph. numgh= [1 -4 20]; % Define numerator of G(s)H(s). dengh=poly( [-2 -4] ) ; % Define denominator of G(s)H(s). ' G(s)H(s) ' % Display label. GH=tf(numgh,dengh) % Create G(s)H(s) and display. rlocus(GH) % Draw root locus. z=0.2:0.05:0.5; % Define damping ratio values : 0.2 % to 0.5 in steps of 0.05. wn=0:1:10; % Define natural frequency values: % 0 to 10 in steps of 1. sgrid(z,wn) % Generate damping ratio and % natural frequency grid lines for % root locus. title ( ' Root Locus' ) % Define title for root locus. pauserlocus(GH) % Draw close-up root locus. axis( [-3 1 -4 4] ) % Define range on axes for root % locus close-up view. title( ' Close-up' ) % Define title for close-up root% locus. z=0.45; % Define damping ratio line for% overlay on close-up root locus. wn=0; % Suppress natural frequency% overlay curves. sgrid(z,wn) % Overlay damping ratio curve on % close-up root locus. for k=1: 3 % Loop allows 3 points to be % selected as per Example 8.7, %(z=0.45, jwcrossing,breakaway).B.2 MATLAB Examples 789WEBBAPPB 10/29/2014 9:25:6 [K,p] =rlocfind(GH) % Generate gain, K, and closed-loop % poles, p, for point selected % interactively on the root locus. end % End loop. pause ch8p2 (Example 8.8) We can couple the design of gain on the root locus with a step- response simulation for the gain selected. We introduce the command rlocus (G,K), which allows us to specify the range of gain, K, for plotting the root locus. This command will help us smooth the usual root locus plot by equivalently specifying more points via the argument, K. Notice that the Ô¨Årst root locus plotted without the argument Kis not smooth. We also introduce the command x=input( ' prompt ' ) , which allows keyboard entry of a value for xin response to a prompt. We apply this command to enter the desired percent overshoot. We also add a variable ‚Äôs value to the title of the root locus and step-response plots by inserting another Ô¨Åeld in the title command and use num2str(value) to convert value from a number to a character string for display. Let us apply the concepts to Example 8.8 in the text. ' (ch8p2) Example 8.8' % Display label. clear % Clear variables from workspace. clf % Clear graph. numg= [1 1.5]; % Define numerator of G(s). deng=poly( [0 -1 -10] ); % Define denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). rlocus(G) % Draw root locus (H(s) =1). title( ' Original Root Locus' ) % Add title. pauseK=0:0.005:50; % Specify range of gain to smooth % root locus. rlocus(G,K) % Draw smoothed root locus % (H(s)=1). title( ' Smoothed Root Locus' ) % Add title.pos=input( ' Type %OS ' ); % Input desired percent overshoot% from the keyboard. z=-log(pos/100) /sqrt(pi^2+[log(pos/100) ]^2) % Calculate damping ratio. sgrid(z,0) % Overlay desired damping ratio% line on root locus. title( [ ' Root Locus with' , num2str(pos), ' % overshoot line ' ] ) % Define title for root locus% showing percent overshoot used. [K,p] =rlocfind(G) % Generate gain, K, and closed-loop% poles, p, for point selected% interactively on the root locus. pause ' T(s) ' % Display label. T=feedback(K*G,1) % Find closed-loop transfer% function % with selected K and display. step(T) % Generate closed-loop step % response for point select on % root locus. title( [ ' Step Response for K=' ,num2str(K) ] ) % Give step response a title which% includes the value of K. pause790 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:7 Chapter 9: Design via Root Locus ch9p1 (Example 9.3) We can use MATLAB to design PD controllers. The program allows us to input a desired percent overshoot via the keyboard. MATLAB then produces a root locus for the uncompensated system with an overlay of the percent overshoot line. We interactivelyselect the intersection of the root locus and the desired percent overshoot line to set the gain.MATLAB outputs an estimate of the uncompensated system ‚Äôs performance speci Ô¨Åcations and a step response of the uncompensated system for us to determine the required settling time. Afterwe input the settling time through the keyboard, MATLAB designs the PD controller and produces a root locus of the PD compensated system from which we can interactively select the gain. Finally, MATLAB produces an estimate of the PD compensated system ‚Äôsp e r f o r m a n c e speciÔ¨Åcations and a step response of the PD compensated system. ' (ch9p1) Example 9.3' % Display label. clf % Clear graph. 'Uncompensated System' % Display label. numg=1; % Generate numerator of G(s). deng=poly( [0 -4 -6] ); % Generate denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). pos=input( 'Type desired percent overshoot ' ); % Input desired percent overshoot. z=log(pos/100)/sqrt(pi^2+[log(pos/100) ]^2); % Calculate damping ratio. rlocus(G) % Plot uncompensated root locus. sgrid(z,0) % Overlay desired percent % overshoot line. title ( [ 'Uncompensated Root Locus with ' , num2str(pos),... '% Overshoot Line ' ] ) % Title uncompensated root locus. [K,p] =rlocfind(G); % Generate gain, K, and closed-loop % poles, p, for point selected % interactively on the root locus. ' Closed-loop poles=' % Display label. p % Display closed-loop poles. f=input( 'Give pole number that is operating point ' ); % Choose uncompensated system% dominant pole. ' Summary of estimated specifications for selected point on'' uncompensated root locus' % Display label. operatingpoint=p(f) % Display uncompensated dominant % pole. gain=K % Display uncompensated gain. estimated_settling_time=4/abs(real(p(f) ) ) % Display uncompensated settling% time. estimated_peak_time=pi/abs(imag(p(f) ) ) % Display uncompensated peak time. estimated_percent_overshoot=pos % Display uncompensated percent % overshoot. estimated_damping_ratio=z % Display uncompensated damping % ratio. estimated_natural_frequency=sqrt(real(p(f) )^2+imag(p(f) )^2) % Display uncompensated natural% frequency. numkv=conv( [1 0],numg); % Set up numerator to evaluate Kv.B.2 MATLAB Examples 791WEBBAPPB 10/29/2014 9:25:7 denkv=deng; % Set up denominator to evaluate Kv. sG=tf(numkv,denkv); % Create sG(s). sG=minreal(sG); % Cancel common poles and zeros. Kv=dcgain(K*sG) % Display uncompensated Kv.ess=1/Kv % Display uncompensated % steady-state % error for unit ramp input. ' T(s) ' % Display label. T=feedback(K * G,1) % Find uncompensated T(s). step(T) % Plot step response of % uncompensated system. title( [ 'Uncompensated System Step Response with ' ,num2str(pos) ,... '% Overshoot' ] ) % Add title to uncompensated step% response. ' Press any key to go to PD compensation ' % Display label. pause ' Compensated system' % Display label. Ts=input( 'Type Desired Settling Time ' ); % Input desired settling time from% the keyboard. wn=4/ (Ts*z); % Calculate natural frequency. desired_pole= (-z*wn)+(wn*sqrt(1-z^2)*i); % Calculate desired dominant pole% location. angle_at_desired_pole= (180/pi) *...angle(polyval(numg,desired_pole)/polyval(deng,desired_pole) ); % Calculate angular contribution% to desired pole without PD % compensator. PD_angle=180-angle_at_desired_pole; % Calculate required angular% contribution from PD % compensator. zc= ( (imag(desired_pole)/tan(PD_angle*pi/180) )...  real (desired_pole) ); % Calculate PD zero location. ' PD Compensator' % Display label. numc= [1 zc]; % Calculate numerator of Gc(s). denc= [0 1]; % Calculate denominator of Gc(s). ' Gc(s)' % Display label. Gc=tf (numc,denc) % Create and display Gc(s). ' G(s)Gc(s) ' % Display label. Ge=G*Gc % Cascade G(s) and Gc(s). rlocus(Ge,0:0.005:100) % Plot root locus of PD compensated % system. sgrid(z,0) % Overlay desired percent% overshoot line. title ( [ 'PD Compensated Root Locus with ' , num2str(pos),... '% Overshoot Line' ] ) % Add title to PD compensated root% locus. [K,p] =rlocfind(Ge); % Generate gain, K, and closed-loop % poles, p, for point selected % interactively on the root locus. ' Closed-loop poles=' % Display label. p % Display PD compensated systems ' % closed-loop poles. f=input( 'Give pole number that is operating point ' ); % Choose PD compensated system% dominant pole.792 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:7 ' Summary of estimated specifications for selected point on PD' ' compensated root locus' % Display label. operatingpoint=p(f) % Display PD compensated dominant% pole. gain=K % Display PD compensated gain. estimated_settling_time=4/abs(real(p(f) ) ) % Display PD compensated settling% time. estimated_peak_time=pi/abs(imag(p(f) ) ) % Display PD compensated peak time. estimated_percent_overshoot=pos % Display PD compensated percent % overshoot. estimated_damping_ratio=z % Display PD compensated damping % ratio. estimated_natural_frequency=sqrt(real(p(f) )^2+imag(p(f) )^2) % Display PD compensated natural% frequency. s=tf( [1 0],1); % Create transfer function,' s ' .sGe=s*Ge; % Create sGe(s). sGe=minreal(sGe); % Cancel common poles and zeros. Kv=dcgain(K*sGe) % Display compensated Kv.ess=1/Kv % Display compensated % steady-state error for% unit ramp input. ' T(s) ' % Display label. T=feedback(K*Ge,1) % Create and display PD compensated%T(s). ' Press any key to continue and obtain the PD compensated step'' response' % Display label. pausestep(T) % Plot step response for PD% compensated system. title( [ 'PD Compensated System Step Response with ' ...num2str(pos),'% Overshoot ' ] ) % Add title to step response % of PD compensated system. pause ch9p2 (Example 9.4) We can use MATLAB to design a lead compensator. The program allows us to input a desired percent overshoot via the keyboard. MATLAB then produces a root locus for the uncompensated system with an overlay of the percent overshoot line. We interactively select the intersection of the root locus and the desired percent overshoot line to set the gain. MATLAB outputs an estimate of the uncompensated system ‚Äôs performance speciÔ¨Åcations and a step response of the uncompensated system for us to determine the required settling time. Next we input the settling time and the lead compensator zero throughthe keyboard. At this point we take a different approach from that of the previous example.Rather than letting MATLAB calculate the lead compensator pole directly, MATLABproduces a root locus for every interactive guess of a lead compensator pole. Each root locuscontains the desired damping ratio and natural frequency curves. When our guess is correct, the root locus, the damping ratio line, and the natural frequency curve will intersect. We then interactively select this point of intersection to input the gain. Finally, MATLAB producesan estimate of the lead-compensated system ‚Äôs performance speci Ô¨Åcations and a step response of the lead-compensated system. ' (ch9p2) Example 9.4' % Display label. clf % Clear graph.B.2 MATLAB Examples 793WEBBAPPB 10/29/2014 9:25:8 ' Uncompensated System' % Display label. numg=1; % Generate numerator of G(s). deng=poly( [0 -4 -6] ); % Generate denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). pos=input( 'Type desired percent overshoot ' ); % Input desired percent overshoot. z=-log(pos/100) /sqrt(pi^2+[log(pos/100) ]^2); % Calculate damping ratio. rlocus(G) % Plot uncompensated root locus. sgrid(z,0) % Overlay desired percent % overshoot line. title( [ 'Uncompensated Root Locus with ' , num2str(pos),... '% Overshoot Line' ] ) % Title uncompensated root locus. [K,p]=rlocfind(G); % Generate gain, K, and closed-loop % poles, p, for point selected % interactively on the root locus. ' Closed-loop poles= ' % Display label. p % Display closed-loop poles. f=input( 'Give pole number that is operating point ' ); % Choose uncompensated system% dominant pole. ' Summary of estimated specifications for selected point on'' uncompensated root locus' % Display label. operatingpoint=p(f) % Display uncompensated dominant % pole. gain=K % Display uncompensated gain. estimated_settling_time=4/abs(real(p(f) ) ) % Display uncompensated settling% time. estimated_peak_time=pi/abs(imag(p(f) ) ) % Display uncompensated peak time. estimated_percent_overshoot=pos % Display uncompensated percent % overshoot. estimated_damping_ratio=z % Display uncompensated damping % ratio. estimated_natural_frequency=sqrt(real(p(f) )^2+imag(p(f) )^2) % Display uncompensated natural% frequency. numkv=conv( [1 0],numg); % Set up numerator to evaluate Kv. denkv=deng; % Set up denominator to evaluate Kv. sG=tf(numkv,denkv); % Create sG(s). sG=minreal(sG); % Cancel common poles and zeros. Kv=dcgain(K*sG) % Display uncompensated Kv. ess=1/Kv % Display uncompensated% steady-state error for % unit ramp input. ' T(s) ' % Display label. T=feedback(K*G,1) % Create and display T(s). step(T) % Plot step response of% uncompensated system. title( [ 'Uncompensated System Step Response with ' ,...num2str(pos),'% Overshoot' ] ) % Add title to uncompensated step % response. ' Press any key to go to lead compensation' % Display label. pause794 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:8 Ts=input( 'Type Desired Settling Time' ); % Input desired settling time. b=input( 'Type Lead Compensator Zero, (s+b). b= ' ); % Input lead compensator zero. done=1; % Set loop flag. while done==1 % Start loop for trying lead % compensator pole. a=input ( 'Enter a Test Lead Compensator Pole, (s+a). a= ' ); % Enter test lead compensator pole. numge=conv(numg,[1 b] ); % Generate numerator of Gc(s)G(s).denge=conv( [1 a],deng); % Generate denominator % of Gc(s)G(s). Ge=tf(numge,denge); % Create Ge(s)= Gc(s)G(s).wn=4/ (Ts*z); % Evaluate desired natural % frequency. clf % Clear graph.rlocus(Ge) % Plot compensated root locus with % test lead compensator pole. axis( [-10,10,-10,10] ) % Change lead-compensated % root locus axes. sgrid(z,wn) % Overlay grid on lead-compensated % root locus. title ( [ 'Lead-Compensated Root Locus with ' , num2str(pos),... ' % Overshoot Line, Lead Pole at ' ,... num2str(-a) , ' and Required Wn' ] ) % Add title to lead-compensated % root locus. done=input ( ' Are you done? (y=0,n=1)' ); % Set loop flag. end % End loop for trying compensator % pole. [K,p]=rlocfind (Ge); % Generate gain, K, and closed-loop % poles, p, for point selected % interactively on the root locus. ' Gc(s) ' % Display label. Gc=tf ( [1 b] ,[1 a] ) % Display lead compensator. ' Gc(s)G(s) ' % Display label. Ge % Display Gc(s)G(s). ' Closed-loop poles=' % Display label. p % Display lead-compensated % system ' s% closed-loop poles. f=input( 'Give pole number that is operating point ' ); % Choose lead-compensated system% dominant pole. ' Summary of estimated specifications for selected point on lead ' ' compensated root locus' % Display label. operatingpoint=p(f) % Display lead-compensated % dominant pole. gain=K % Display lead-compensated gain. estimated_settling_time=4/abs(real(p(f) ) ) % Display lead-compensated % settling time. estimated_peak_time=pi/abs(imag(p(f) ) ) % Display lead-compensated % peak time. estimated_percent_overshoot=pos % Display lead-compensated % percent overshoot.B.2 MATLAB Examples 795WEBBAPPB 10/29/2014 9:25:8 estimated_damping_ratio=z % Display lead-compensated % damping ratio. estimated_natural_frequency=sqrt(real(p(f) )^2+imag(p(f) )^2) % Display lead-compensated % natural frequency. s=tf ( [1 0],1); % Create transfer Function,' s ' . sGe=s*Ge; % Create sGe(s) to evaluate Kv. sGe=minreal(sGe); % Cancel common poles and zeros.Kv=dcgain(K*sGe) % Display lead-compensated Kv. ess=1/Kv % Display lead-compensated steady- % state error for unit ramp input. ' T(s) ' % Display label. T=feedback(K*Ge,1) % Create and display lead- % compensated T(s). ' Press any key to continue and obtain the lead-compensated step' ' response' % Display label. pause step(T) % Plot step response for lead-% compensated system. title ( [ 'Lead-Compensated System Step Response with ' ,...num2str(pos),'% Overshoot' ] ) % Add title to step response % of lead-compensated system. pause Chapter 10: Frequency Response Techniques ch10p1 (Example 10.3) We can use MATLAB to make Bode plots using bode(G) , where G/ (s) =numg/deng andGis an LTI transfer-function object. Information about the plots obtained with bode(G) can be found by left-clicking the mouse on the curve. You can Ô¨Ånd the curve ‚Äôs label, as well as the coordinates of the point on which you clicked. Right- clicking away from a curve brings up a menu if the icons on the menu bar are deselected. From this menu you can select (1) system responses to be displayed and (2) characteristics, such aspeak response. When selected, a dot appears on the curve at the appropriate point. Let yourmouse rest on the point to read the value of the characteristic. You may also select (3) whichcurves to view, (4) choice for grid on or off, (5) returning to full view after zooming, and (6) properties, such as labels, limits, units, style, and characteristics. We can obtain points on the plot using [mag, phase, w] =bode(G) , where magnitude, phase, and frequency are stored in mag, phase, andw, respectively. Magnitude and phase are stored as 3-D arrays. We use mag(:,:) ' , phase(:,:) ' to convert the arrays to column vectors, where the apostrophe signi Ô¨Åes matrix transpose. Let us look at Example 10.3 in the text. ' (ch10p1) Example 10.3' % Display label. clf % Clear graph. numg= [1 3]; % Define numerator of G(s). deng=conv( [1 2],[1 2 25] ); % Define denominator of G(s). 'G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). bode(G) % Make a Bode plot. grid on % Turn on grid for Bode plot. title( 'Open-Loop Frequency Response' ) % Add a title to the Bode plot. [mag,phase,w]=bode(G); % Store points on the Bode plot. points= [20*log10(mag(:,:) ) ' ,phase(:,:) ' ,w] % List points on Bode plot with % magnitude in dB. pause796 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:9 ch10p2 (Example 10.5) We can use MATLAB to make Nyquist diagrams using nyquist(G) , where G(s)=numg/deng andGis an LTI transfer-function object. Information about the plots obtained with nyquist(G) can be found by left-clicking the mouse on the curve. You can Ô¨Ånd the curve ‚Äôs label, as well as the coordinates of the point on which you clicked and the frequency. Right-clicking away from a curve brings up a menu if the icons on the menu bar are deselected. From this menu you can select (1) systemresponses to be displayed and (2) characteristics, such as peak response. When selected, adot appears on the curve at the appropriate point. Let your mouse rest on the point to read thevalue of the characteristic. You may also select (3) whether or not to show negative frequencies, (4) choice for grid on or off, (5) choice for zooming to ( ‚Äì1,0), (6) returning to full view after zooming, and (7) properties, such as labels, limits, units, style, and characteristics. We can obtain points on the plot by using [re,im,w] =nyquist(G) , where the real part, imaginary part, and frequency are stored in re, im, andw, respectively, and reandimare 3-D arrays. We can specify a range of wby using [re,im] =nyquist(G,w). We use re(:,:) ' , andim(:,:) ' to convert the arrays to column vectors. Let us look at Example 10.5 in the text. ' (ch10p2) Example 10.5' % Display label. clf % Clear graph. numg= [1 2]; % Define numerator of G(s). deng= [1 0 0]; % Define denominator of G(s). 'G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). nyquist(G) % Make a Nyquist diagram. grid on % Turn on grid for Nyquist diagram. title( 'Open-Loop Frequency Response' ) % Add a title to the Nyquist % diagram. w=0:0.5:10; % Let 0 <w<10 in steps of 0.5. [re,im] =nyquist(G,w); % Get Nyquist diagram points for a % range of w. points= [re(:,:) ' ,im(:,:) ' ,w' ] % List specified range of points % in Nyquist diagram. pause ch10p3 (Example 10.8) We can use MATLAB to Ô¨Ånd gain margin ( Gm), phase margin (Pm), the gain-margin frequency, where the phase plot goes through 180 degrees ( Wcg), and the phase-margin frequency, where the magnitude plot goes through zero dB (Wcp) .T o Ô¨Ånd these quantities we use [Gm,Pm,Wcg,Wcp] =margin(G) , where G(s)=numg/deng andGis an LTI transfer-function object. Let us look at Example 10.8 in the text. ' (ch10p3) Example 10.8' % Display label. clf % Clear graph. numg=6; % Define numerator of G(s). deng=conv( [1 2] , [1 2 2] ); % Define denominator of G(s). 'G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). nyquist(G) % Make a Nyquist diagram. grid on % Turn on grid for the Nyquist% diagram. title ( 'Open-Loop Frequency Response' ) % Add a title to the Nyquist % diagram. [Gm,Pm,Wcg,Wcp] =margin(G); % Find margins and margin % frequencies.B.2 MATLAB Examples 797WEBBAPPB 10/29/2014 9:25:9 ' Gm(dB); Pm(deg.) ; 180 deg. freq.(r/s); 0 dB freq. (r/s) ' % Display label. margins= [20*log10(Gm) ,Pm,Wcg,Wcp] % Display margin data. pause ch10p4 (Example 10.9) We can use MATLAB to determine the range of Kfor stability using frequency response methods. Let us look at Example 10.9 in the text. ' (ch10p4) Example 10.9' % Display label. numg=1; % Define numerator of G(s). deng=poly( [-2 -4 -5] ); % Define denominator of G(s). 'G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). [Gm,Pm,Wcg,Wcp] =margin(G); % Find margins and margin % frequencies. K=Gm % Display K for stability. pause ch10p5 (Example 10.11) We can use MATLAB to Ô¨Ånd the closed-loop frequency response. Let us look at Example 10.11 in the text. ' (ch10p5) Example 10.11 ' % Display label. clf % Clear graph. numg=50; % Define numerator of G(s). deng=poly( [0 -3 -6] ); % Define denominator of G(s). 'G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). 'T(s) ' % Display label. T=feedback(G,1) % Find and display closed-loop % transfer function. bode(T) % Make a Bode plot. grid on % Turn on the grid for the plots. title( 'Closed-Loop Frequency Response' ) % Add a title to the Bode plot. pausenyquist(T) % Make a Nyquist diagram. title( 'Closed-Loop Frequency Response' ) % Add a title to the Nyquist% diagram. pause ch10p6 We can use MATLAB to plot Nichols charts using nichols(G) , where G(s) =numg/deng andGis an LTI transfer-function object. The Nichols grid can be added using the ngrid command after the nichols(G) command. Information about the plots obtained with nichols(G) can be found by left-clicking the mouse on the curve. You can Ô¨Ånd the curve ‚Äôs label, as well as the coordinates of the point on which you clicked and the frequency. Right-clicking away from a curve brings up a menu if the icons on the menu bar are deselected. From this menu you can select (1) system responses to bedisplayed and (2) characteristics, such as peak response. When selected, a dot appears onthe curve at the appropriate point. Let your mouse rest on the point to read the value of thecharacteristic. You may also select (3) choice for grid on or off, (4) returning to full view798 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:9 after zooming, and (5) properties, such as labels, limits, units, style, and characteristics. Let us make a Nichols chart of G s¬Ü¬à1=¬âs s¬á1¬Ü s¬á2¬Ü¬ä. ' (ch10p6) ' % Display label. clf % Clear graph. numg=1; % Define numerator of G(s). deng=poly( [0 -1 -2] ); % Define denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). nichols(G) % Make a Nichols plot. ngrid % Add Nichols grid. pause ch10p7 (Example 10.15) We can use MATLAB and frequency response methods to include time delay in the loop. Time delay is represented by [numd,dend] =pade (T, n), where Tis the delay time in seconds and nis the order. Larger values of ngive better approximations to the delay, G d(s)=numd/dend . Since we are plotting multiple plots, we Ô¨Årst collect the data for the Bode plots by using [mag,phase] =bode(G,w) , where wis speciÔ¨Åed as a range of frequencies. We then use the generic plotting command. Also notice the commands used to label the axes and the plots on the Bode plot (see the MATLAB instruction manual for details). Let us look at Example 10.15 in the text. ' (ch10p7) Example 10.15' % Display label. clf % Clear graph. hold off % Turn graph hold off. numg=1; % Define numerator of G(s). deng=poly( [0 -1 -10] ); % Define denominator of G(s). 'G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). w=0.01:0.1:10; % Let 0.01 <w<10 in steps of 0.1. [magg,phaseg] =bode (G,w); % Collect Bode data for G(s). [numd,dend] =pade(1,6); % Represent the delay. Gd=tf(numd,dend); % Create and display the delay, % Gd(s). [magd,phased] =bode(Gd,w); % Collect Bode data for Gd(s). Ge=Gd*G; % Form Gd(s)G(s). [mage,phasee] =bode(Ge,w); % Collect Bode data for Gd(s)G(s). subplot(2,1,1) % Subdivide plot area for plot 1. semilogx(w,20*log10(mage(:,:) ) ) % Plot magnitude response.grid on % Turn on grid for magnitude plot. axis( [0.01,10,-80,20] ); % Limit Bode plot axes. title ( 'Magnitude Response with Delay' ) % Add title to magnitude response. xlabel( 'Frequency (rad/s) ' ) % Label x-axis of magnitude % response. ylabel( ' 20log M ' ) % Label y-axis of magnitude% response. subplot(2,1,2) % Subdivide plot area for plot 2. phased=phased-1080; % Adjust phase offset to compensate% for modulo 360. phasee=phasee-1080; % Adjust phase offset to compensate% for modulo 360. semilogx(w,phaseg(:,:),w,phased(:,:),w,phasee(:,:) ) % Plot phase response for G(s),% Gd(s), and G(s)Gd(s) on one% graph.B.2 MATLAB Examples 799WEBBAPPB 10/29/2014 9:25:9 grid on % Turn on grid for phase plot. axis( [0.01,10,-900,0] ); % Limit Bode plot axes. title ( 'Phase Response with Delay ' ) % Add title to phase response. xlabel( 'Frequency (rad/s) ' ) % Label x-axis of phase response. ylabel( 'Phase (degrees) ' ) % Label y-axis of phase response. text(1.5,-50, 'Time Delay ' ) % Label time delay curve. text(4,-150, 'System ' ) % Label system curve. text(2.7,-300, ' Total ' ) % Label total curve. pause ch10p8 (Example 10.18) We can use MATLAB and frequency response methods to determine experimentally a transfer function from frequency response data. By determining simple component transfer functions and then successively subtracting their frequency response,we can approximate the complete transfer function. Let us look at Example 10.18 in the text anduse MATLAB for a portion of the problem. You can complete the program for practice. For thisproblem we generate the original frequency response plot via a transfer function. Normally, thedata for the original frequency response plot would be tabular, and the program would begin at the step [M0,P0] =bode(G0,w) where the tabular data is generated. In other words, in a real application, the data would consist of column vectors M0, P0, and w ' . ' (ch10p8) Example 10.18' % Display label. clf % Clear graph. hold off % Turn graph hold off. % Generate the experimental Bode plots for G0 (s) =numg0/deng0, that % is, M0,P0. numg0=70* [1 20]; % Define numerator of G0(s). deng0=conv( [1 7] ,[1 2 25] ); % Partially define denominator of % G0(s). deng0=conv(deng0 ,[1 70] ); % Complete the denominator of % G0(s). G0=tf(numg0,deng0); % Create G0(s). w=1:0.5:1000; % Let 1 <w<1000 in steps of 0.5. [M0, P0] =bode(G0 ,w); % Generate the tabular data. [20*log10(M0(:,:) ) ' ,P0(:,:) ' ,w ' ]; % Convert magnitude data to dB. bode(G0,w) % Generate a Bode plot. grid on % Turn on grid for Bode plot. title( 'Experimental ' ) % Add title. pauseclf % Clear graph. % Estimate a component part of the transfer function as% G1 (s) =25/ (s^2+2*0.22*5s+5^2) and subtract it from the experimental% frequency response numgl=5^2; % Define numerator of G1(s). deng1= [1 2*0.22*5 5^2]; % Define denominator of G1(s). 'First estimate ' % Display label. G1=tf(numg1,deng1) % Create and display G1(s). [M1,P1] =bode(G1,w); % Generate Bode data for G1(s). M2=20*log10(M0(:,:) )-20*log10(M1(:,:) ); % Subtract Bode magnitude data of% G1 from original magnitude data. P2=P0(:,:)-P1(:,:); % Subtract Bode phase data of G1 % from original phase data. subplot(2,1,1) % Divide plot area in two for% magnitude plot. semilogx(w(:,:),M2) % Plot magnitude response after% subtracting.800 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:10 grid on % Turn on grid for magnitude plot. xlabel( 'Frequency (rad/sec) ' ) % Add x-axis label. ylabel( 'Gain dB ' ) % Add y-axis label. subplot(2,1,2) % Divide plot area in two for phase % plot. semilogx(w,P2) % Plot the phase response after % subtracting. grid on % Turn on grid for phase plot. title( 'Experimental Minus 25/ (s^2+2*0.22*5s+5^2) ' ) % Add title. xlabel( 'Frequency (rad/sec) ' ) % Add x-axis label. ylabel( 'Phase deg ' ) % Add y-axis label. 'This completes a portion of Example 10.18. ''The student should continue the program for practice. ' pause Chapter 11: Design via Frequency Response ch11p1 (Example 11.1) We can design via gain adjustment on the Bode plot using MATLAB. You will input the desired percent overshoot from the keyboard. MATLAB will calculate the required phase margin and then search the Bode plot for that phase margin. Themagnitude at the phase-margin frequency is the reciprocal of the required gain. MATLABwill then plot a step response for that gain. Let us look at Example 11.1 in the text. ' (ch11p1) Example 11.1' % Display label. clf % Clear graph. numg= [100]; % Define numerator of G(s). deng=poly ( [0 -36 -100] ); % Define denominator of G(s). G=tf(numg,deng) % Create and display G(s). pos=input ( 'Type %OS ' ); % Input desired percent overshoot. z= (-log(pos/100) )/ (sqrt(pi^2+log(pos/100)^2) ); % Calculate required damping ratio. Pm=atan(2*z/ (sqrt(-2*z^2+sqrt(1+4*z^4) ) ) ) * (180/pi); % Calculate required phase margin. w=0.01:0.01:1000; % Set range of frequency from 0.01 % to 1000 in steps of 0.01. [M,P] =bode(G,w); % Get Bode data. Ph=-180+Pm; % Calculate required phase angle. for k=1: 1: length (P); % Search Bode data for required % phase angle. if P(k)-Ph <=0; % If required phase angle is found, % find the value of M=M(k); % magnitude at the same frequency. 'Required K ' % Display label. K=1/M % Calculate the required gain. break % Stop the loop. end % End if. end % End for. T=feedback(K*G,1); % Find T(s) using the calculated K. step(T) % Generate a step response. title ( [ 'Closed-Loop Step Response for K= ' ,num2str(K) ] ) % Add title to step response. pause ch11p2 (Example 11.2) Let us use MATLAB to design a lag compensator. The program solves Example 11.2 in the text and follows the same design techniqueB.2 MATLAB Examples 801WEBBAPPB 10/29/2014 9:25:10 demonstrated in that example. You will input the value of gain to meet the steady-state error requirement followed by the desired percent overshoot. MATLAB then designs a lag compensator, evaluates Kv,and generates a closed-loop step response. ' (ch11p2) Example 11.2' % Display label. clf % Clear graph. K=input( 'Type value of K to meet steady-state error requirement ' ); % Input K. pos=input ( 'Type %OS ' ); % Input desired percent overshoot. numg= [100*K]; % Define numerator of G(s). deng=poly( [0 -36 -100] ); % Define denominator of G(s). 'G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). z= (-log(pos/100) )/ (sqrt(pi^2+log(pos/100)^2) ); % Calculate required damping % ratio. Pm=atan(2*z/(sqrt(-2*z^2+sqrt(1+4*z^4) ) ) ) * (180/pi)+10; % Calculate required phase margin. w=0.01:0.01:100; % Set range of frequency from 0.01% to 1000 in steps of 0.01. [M,P] =bode(G,w); % Get Bode data. Ph=-180+Pm; % Calculate required phase angle. for k=1:1:length(P); % Search Bode data for required% phase angle. if P(k)-Ph <=0; % If required phase angle is found,% find the value of M=M(k); % magnitude at the same frequency. wf=w(k); % At this frequency the magnitude % plot must go through 0 dB. break % Stop the loop. end % End if. end % End for. wh=wf/10; % Calculate the high-frequency % break of the lag compensator. wl= (wh/M); % Calculate the low-frequency% break of the lag compensator;% found from lag compensator, % Gc(s) =Kc(s+wh)/ (s+wl) , high & low % frequency gain requirements.% At low w, gain=1. Thus,% Kc*wh/wl=1. At high w, gain=1/M. % Thus Kc=1/M. Hence % Kc=wl/wh=1/M, or wl=wh/M. numc= [1 wh]; % Generate numerator of lag % compensator, Gc(s). denc= [1 wl]; % Generate denominator of lag % compensator, Gc(s). Kc=wl/wh; % Generate K for Gc(s). 'Lag compensator' % Display label. Kc % Display lag compensator K. 'Gc(s) ' % Display label. Gc=tf(Kc*numc,denc) % Create and display Gc(s). ' Gc(s)G(s) ' % Display label. GcG=Gc*G % Create and display Gc(s)G(s). s=tf( [1 0],1); % Create transfer function, ' s ' . sGcG=s*GcG; % Create sGc(s)G(s). sGcG=minreal(sGcG); % Cancel common terms.802 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:10 Kv=dcgain(sGcG) % Evaluate Kv. T=feedback(GcG,1); % Create T(s). step(T) % Generate a closed-loop, lag- % compensated step response. title ( 'Closed-Loop Step Response for Lag-Compensated System ' ) % Add title to step response. pause ch11p3 (Example 11.3) Let us use MATLAB to design a lead compensator. The program solves Example 11.3 in the text and follows the same design technique demonstrated in that example. You will enter desired percent overshoot, peak time, and Kv.MATLAB then designs the lead compensator using Bode plots, calculates Kv,and plots a closed-loop step response. ' (ch11p3) Example 11.3' % Display label. clf % Clear graph. pos=input ( 'Type %OS ' ); % Input desired percent overshoot. Tp=input( ' Type peak time ' ); % Input desired peak time. Kv=input( ' Type value of Kv ' ); % Input Kv. numg= [100]; % Define numerator of G(s). deng=poly ( [0 -36 -100] ); % Define denominator of G(s). G=tf(numg,deng); % Create G(s). s=tf( [1 0],1); % Create transfer function, ' s' . sG=s*G; % Create sG(s). sG=minreal(sG); % Cancel common factors. K=dcgain(Kv/sG); % Solve for K. 'G(s) ' % Display label. G=zpk(K*G) % Put K into G (s), convert to % factored form, and display. z= (-log(pos/100) )/ (sqrt(pi^2+log(pos/100)^2) ); % Calculate required damping% ratio. Pm=atan(2*z/(sqrt(-2*z^2+sqrt(1+4*z^4) ) ) ) * (180/pi); % Calculate required phase margin. wn=pi/(Tp*sqrt(1-z^2) ); % Calculate required natural% frequency. wBW=wn*sqrt( (1-2*z^2)+sqrt(4*z^4-4*z^2+2) ); % Determine required bandwidth. w=0.01:0.5:1000; % Set range of frequency from 0.01 % to 1000 in steps of 0.5 [M,P]=bode(G,w); % Get Bode data. [Gm,Pm,Wcg,Wcp]=margin(G); % Find current phase margin.Pmreq=atan(2*z/(sqrt(-2*z^2+sqrt(1+4*z^4) ) ) ) * (180/pi); % Calculate required phase margin. Pmreqc=Pmreq+10; % Add a correction factor of 10 % degrees. Pc=Pmreqc-Pm; % Calculate phase contribution % required from lead compensator. % Design lead compensatorbeta= (1-sin(Pc*pi/180) )/(1+sin(Pc*pi/180) ); % Find compensator beta. magpc=1/sqrt(beta); % Find compensator peak magnitude. for k=1:1:length(M); % Find frequency at which% uncompensated system has a % magnitude of 1/magpc. % This frequency will be the new% phase margin frequency. if M(k)-(1/magpc) <=0; % Look for peak magnitude.B.2 MATLAB Examples 803WEBBAPPB 10/29/2014 9:25:11 wmax=w(k); % This is the frequency at the % peak magnitude. break % Stop the loop, end % End if. end % End for. % Calculate lead compensator zero, pole, and gain. zc=wmax*sqrt(beta); % Calculate the lead compensators ' % low break frequency. pc=zc/beta; % Calculate the lead compensators ' % high break frequency. Kc=1/beta; % Calculate the lead compensators ' % gain. 'Gc(s) ' % Display label. Gc=tf(Kc*[1 zc] ,[1 pc] ); % Create Gc(s). Gc=zpk(Gc) % Convert Gc (s) to factored form % and display. 'Ge(s) =G(s)Gc(s) ' % Display label. Ge=G*Gc % Form Ge(s)=Gc(s)G(s). sGe=s*Ge; % Create sGe(s). sGe=minreal(sGe); % Cancel common factors. Kv=dcgain(sGe) % Calculate Kv. T=feedback(Ge,1); % Find T(s). step(T) % Generate closed-loop, lead- % compensated step response. title( ' Lead-Compensated Step Response' ) % Add title to lead-compensated% step response. pause ch11p4 (Example 11.4) Let us use MATLAB to design a lag-lead compensator. The program solves Example 11.4 in the text and follows the same design technique demon- strated in that example. You will enter desired percent overshoot, peak time, and Kv. MATLAB then designs the lag-lead compensator using Bode plots, calculates Kv,and plots a closed-loop step response. ' (ch11p4) Example 11.4' % Display label. clf % Clear graph. pos=input( 'Type %OS ' ); % Input desired percent overshoot. Tp=input( 'Type peak time ' ); % Input desired peak time. Kv=input( 'Type value of Kv ' ); % Input desired Kv. numg= [1]; % Define numerator of G(s). deng=poly( [0 -1 -4] ); % Define denominator of G(s). G=tf(numg,deng); % Create G(s) without K. s=tf( [1 0],1); % Create transfer function, ' s ' . sG=s*G; % Create sG(s). sG=minreal(sG); % Cancel common factors. K=dcgain(Kv/sG); % Solve for K. 'G(s) ' % Display label. G=tf(K*numg,deng); % Put K into G(s). G=zpk(G) % Convert G(s) to factored form and% display. z= (-log(pos/100) )/ (sqrt(pi^2+log(pos/100)^2) ); % Calculate required damping ratio. Pmreq=atan(2*z/ (sqrt(-2*z^2+sqrt(1+4*z^4) ) ) ) * (180/pi); % Calculate required phase margin. wn=pi/ (Tp*sqrt(1-z^2) ); % Calculate required natural% frequency.804 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:11 wBW=wn*sqrt( (1-2*z^2)+sqrt(4*z^4-4*z^2+2) ); % Determine required bandwidth. wpm=0.8*wBW; % Choose new phase-margin % frequency. [M,P] =bode(G,wpm); % Get Bode data. Pmreqc=Pmreq-(180+P)+5; % Find phase contribution required % from lead compensator% with additional 5 degrees. beta= (1-sin(Pmreqc*pi/180) )/(1+sin(Pmreqc*pi/180) ); % Find beta.% Design lag compensator zero, pole,% and gain. zclag=wpm/10; % Calculate zero of lag compensator. pclag=zclag*beta; % Calculate pole of lag compensator. Kclag=beta; % Calculate gain of lag compensator. 'Lag compensator, Glag(s) ' % Display label. Glag=tf(Kclag* [1 zclag] ,[1 pclag] ); % Create lag compensator.Glag=zpk(Glag) % Convert Glag(s) to factored form% and display. % Design lead compensator zero, % pole, and gain. zclead=wpm*sqrt(beta); % Calculate zero of lead % compensator. pclead=zclead/beta; % Calculate pole of lead % compensator. Kclead=1/beta; % Calculate gain of lead% compensator. 'Lead compensator' % Display label. Glead=tf(Kclead* [1 zclead] ,[1 pclead] ); % Create lead compensator. Glead=zpk(Glead) % Convert Glead(s) to factored form% and display. 'Lag-Lead Compensated Ge(s) ' % Display label. Ge=G*Glag*Glead % Create compensated system,% Ge(s) =G(s) Glag(s) Glead(s). sGe=s*Ge; % Create sGe(s). sGe=minreal(sGe); % Cancel common factors. Kv=dcgain(sGe) % Calculate Kv. T=feedback(Ge,1); % Find T(s). step(T) % Generate closed-loop, lag-lead-% compensated step response. title( 'Lag-Lead-Compensated Step Response ' ) % Add title to lag-lead-% compensated% step response. pause Chapter 12: Design via State Space ch12p1 (Example 12.1) We can use MATLAB to design controller gains using pole placement. You will enter the desired percent overshoot and settling time. We introduce the following commands: [num,den] =ord2(wn,z) , which produces a second-order system, given the natural frequency (wn) and the damping ratio (z). Then we use the denominator (den)to specify the dominant poles; and K=acker (A,B,-poles) , which calculates controller gains from the system matrix (A), the input matrix(B),t h e desired poles (poles). Let us look at Example 12.1 in the text.B.2 MATLAB Examples 805WEBBAPPB 10/29/2014 9:25:11 ' (ch12p1) Example 12.1 ' % Display label. clf % Clear graph. numg=20* [1 5]; % Define numerator of G(s). deng=poly( [0 -1 -4] ); % Define denominator of G(s). 'Uncompensated G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). pos=input( 'Type desired %OS ' ); % Input desired percent overshoot. Ts=input( 'Type desired settling time ' ); % Input desired settling time. z= (-log(pos/100) )/ (sqrt(pi^2+log(pos/100)^2) ); % Calculate required damping ratio. wn=4/ (z*Ts); % Calculate required natural % frequency. [num,den] =ord2(wn,z); % Produce a second-order system % that meets the transient response % requirements. r=roots(den); % Use denominator to specify % dominant poles. poles= [r(1) r(2) -5.1]; % Specify pole placement for all % poles. characteristiceqdesired=poly(poles) % Form desired characteristic% polynomial for display. [Ac Bc Cc Dc] =tf2ss(numg,deng); % Find controller canonical form % of state-space representation% of G(s). P= [0 0 1;0 1 0;1 0 0]; % Transformation matrix for % controller canonical to phase-% variable form. Ap=inv(P)*Ac*P; % Transform Ac to phase-variable% form. Bp=inv(P) *Bc; % Transform Bc to phase-variable % form. Cp=Cc*P; % Transform Cc to phase-variable % form. Dp=Dc; % Transform Dc to phase-variable% form. Kp=acker(Ap,Bp,poles) % Calculate controller gains in % phase-variable form. Apnew=Ap-Bp*Kp; % Form compensated A matrix. Bpnew=Bp; % Form compensated B matrix. Cpnew=Cp; % Form compensated C matrix. Dpnew=Dp; % Form compensated D matrix. [numt,dent] =ss2tf(Apnew,Bpnew,Cpnew,Dpnew); % Form T(s) numerator and% denominator. 'T(s) ' % Display label. T=tf(numt,dent) % Create and display T(s). poles=roots(dent) % Display poles of T(s). Tss=ss(Apnew,Bpnew,Cpnew,Dpnew) % Create and display Tss, an LTI % state-space object. step(Tss) % Produce compensated step % response. title( 'Compensated Step Response' ) % Add title to compensated step % response. pause806 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:12 ch12p2 (Example 12.2) We can test controllability by using the MATLAB command Cm=ctrb(A,B) toÔ¨Ånd the controllability matrix given the system matrix (A)and the input matrix (B). This command is followed by rank(Cm) to test the rank of the controllability matrix (Cm) . Let us apply the commands to Example 12.2. ' (ch12p2) Example 12.2' % Display label. A= [-1 1 0;0 -1 0;0 0 -2] % Define compensated A matrix. B= [0;1;1] % Define compensated B matrix. Cm=ctrb(A,B) % Calculate controllability % matrix. Rank=rank(Cm) % Find rank of controllability % matrix. pause ch12p3 (Example 12.4) If we design controller gains using MATLAB, we do not have to convert to phase-variable form. MA TLAB will give us the controller gains for any state-space representation we input. Let us look at Example 12.4 in the text. ' (ch12p3) Example 12.4' % Display label. clf % Clear graph. A= [-5 1 0;0 -2 1;0 0 -1]; % Define system matrix A. B= [0;0;1]; % Define input matrix B. C= [-1 1 0]; % Define output matrix C. D=0; % Define matrix D. pos=input( 'Type desired %OS ' ); % Input desired percent overshoot.Ts=input( 'Type desired settling time ' ) % Input desired settling time. z= (-log(pos/100) )/ (sqrt(pi^2+log(pos/100)^2) ); % Calculate required damping ratio. wn=4/ (z*Ts); % Calculate required natural% frequency. [num,den] =ord2(wn,z); % Produce a second-order system% that meets the transient% requirements. r=roots(den); % Use denominator to specify% dominant poles. poles= [r(1) r(2) -4]; % Specify pole placement for all % poles. K=acker(A,B,poles) % Calculate controller gains. Anew=A-B*K; % Form compensated A matrix. Bnew=B; % Form compensated B matrix. Cnew=C; % Form compensated C matrix. Dnew=D; % Form compensated D matrix. Tss=ss(Anew,Bnew,Cnew,Dnew); % Form LTI state-space object. 'T(s) ' % Display label. T=tf(Tss); % Create T(s). T=minreal(T) % Cancel common terms and display% T(s). poles=pole(T) % Display poles of T(s). step(Tss) % Produce compensated step% response. title( 'Compensated Step Response' ) % Add title to compensated step % response. pauseB.2 MATLAB Examples 807WEBBAPPB 10/29/2014 9:25:12 ch12p4 (Example 12.5) We can design observer gains by using the command l=acker(A ' ,C ' ,poles) ' . Notice we use the transpose of the system matrix (A) and output matrix (C)along with the desired poles (poles). Let us look at Example 12.5 in the text. ' (ch12p4) Example 12.5' % Display label. numg= [1 4]; % Define numerator of G(s). deng=poly( [-1 -2 -5] ); % Define denominator of G(s). ' G(s) ' % Display label. G=tf(numg,deng) % Create and display G(s). [Ac,Bc,Cc,Dc] =tf2ss(numg,deng); % Transform G(s) to controller % canonical form in state space. Ao=Ac' ; % Transform Ac to observer % canonical form. Bo=Cc' ; % Transform Bc to observer % canonical form. Co=Bc' ; % Transform Cc to observer% canonical form. Do=Dc; % Transform Dc to observer % canonical form. r=roots( [1 2 5] ) % Find the controller-compensated % system poles. poles=10* [r ' 10*real(r(1) ) ] % Make observer poles 10x bigger.lp=acker(Ao ' ,Co ' ,poles) ' % Find the observer gains in% observer canonical form. pause ch12p5 (Example 12.6) We can test observability using the MATLAB command Om=obsv(A,C) toÔ¨Ånd the observability matrix given the system matrix (A)and the output matrix (C). This command is followed by rank(Om) to test the rank of the observability matrix (Om) . Let us apply the commands to Example 12.6. ' (ch12p5) Example 12.6 ' % Display label. A= [0 1 0;0 0 1;-4 -3 -2] % Define compensated A matrix. C= [0 5 1] % Define compensated C matrix. Om=obsv(A,C) % Form observability matrix. Rank=rank(Om) % Find rank of observability % matrix. pause ch12p6 (Example 12.8) We can design observer gains using the command l=acker (A ' ,C ' ,poles) ' without transforming to observer canonical form. Let us look at E x a m p l e1 2 . 8i nt h et e x t . ' (ch12p6) Example 12.8' % Display label. A= [-5 1 0;0 -2 1;0 0 -1]; % Define system matrix A. B= [0;0;1]; % Define input matrix B. C= [1 0 0]; % Define output matrix C. D=0; % Define matrix D. poles=roots( [1 120 2500 50000] ) % Specify pole placement for all % poles. l=acker(A ' ,C ' ,poles) ' % Calculate observer gains. pause808 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:13 Chapter 13: Digital Control Systems ch13p1 (Example 13.4) We can convert G1(s) in cascade with a zero-order hold (z.o.h.) to G(z)u s i n gM A T L A B ‚ÄôsG=c2d (G1,T, ' zoh' ) command, where G1is an LTI continuous-system object and Gis an LTI sampled-system object. Tis the sampling interval and 'zoh' is a method of transformation that assumes G1(s) in cascade with a z.o.h. We simply put G1(s) into the command (the z.o.h. is automatically taken care of) and the command returns G(z). Let us apply the concept to Example 13.4. You will enter Tthrough the keyboard. ' (ch13p1) Example 13.4' % Display label. T=input( 'Type T ' ); % Input sampling interval. numg1s= [1 2]; % Define numerator of G1(s). deng1s= [1 1]; % Define denominator of G1(s). 'G1(s) ' % Display label. G1=tf(numg1s,deng1s) % Create G1(s) and display. 'G(z) ' % Display label. G=c2d(G1,T, ' zoh' ) % Convert G1(s) in cascade with % z.o.h. to G(z) and display. pause ch13p2 We also can use MATLAB to convert G(s)t oG(z) when G(s) is not in cascade with a z.o.h. The command H=c2d(F,T, ' zoh ' )transforms F(s) in cascade with a z.o.h. to H(z),where H z¬Ü¬à z 1¬Ü=z¬Ü*zfF s¬Ü=sg. If we let F s¬Ü¬àsG s¬Ü, the command solves for H(z), where H z¬Ü¬à z 1¬Ü=z¬Ü*zfG s¬Üg. Hence, zfG s¬Üg ¬à z=¬âz 1¬ä¬Ü*H z¬Ü. In summary, input F s¬Ü¬àsG s¬Ü, and multiply the result of H=c2d(F,T, ' zoh ' )by z=¬âz 1¬ä¬Ü. This process is equivalent to Ô¨Ånding the z-transform. We convert G s¬Ü¬à s¬á3¬Ü= s2¬á6s¬á13¬Ü intoG(z). You will enter T, the sampling interval, through the keyboard. Tis used to form H(z). We use an unspeci Ô¨Åed sampling interval, T= [ ] , to form z= z 1¬Ü. ' (ch13p2) ' % Display label. T=input( 'Type T ' ); % Input sampling interval. numgs= [1 3]; % Define numerator of G(s). dengs= [1 6 13]; % Define denominator of G(s). 'G(s) ' % Display label. Gs=tf(numgs,dengs) % Create and display G(s). Fs=Gs*tf( [1 0] ,1); % Create F(s) =sG(s). Fs=minreal(Fs); % Cancel common poles and zeros. Hz=c2d(Fs,T, 'zoh' ); % Convert F(s) to H(z) assuming% z.o.h. Gz=Hz*tf( [1 0] ,[1 -1] ,[ ] ); % Form G(z) =H(z)*z/(z-1). 'G(z) ' % Display label. Gz=minreal(Gz) % Cancel common poles and zeros. pause ch13p3 Creating Digital Transfer Functions Directly Vector Method, Polynomial Form A digital transfer function can be expressed as a numerator polynomial divided by adenominator polynomial, that is, F z¬Ü¬àN z¬Ü=D z¬Ü. The numerator, N(z),is represented by a vector, numf , that contains the coef Ô¨Åcients of N(z). Similarly, the denominator, D(z), is represented by a vector, denf , that contains the coef Ô¨Åcients of D(z). We form F(z) with the command, F=tf(numf,denf,T) , where Tis the sampling interval. Fis called a linear time-invariant (LTI) object. This object, or transfer function, can be used as anentity in other operations, such as addition or multiplication. We demonstrate withB.2 MATLAB Examples 809WEBBAPPB 10/29/2014 9:25:13 F z¬Ü¬à150 z2¬á2z¬á7¬Ü= z2 0:3z¬á0:02¬Ü. We use an unspeci Ô¨Åed sampling interval, T=[] .Notice after executing the tfcommand, MATLAB prints the transfer function. Vector Method, Factored Form We also can create digital LTI transfer functions if the numerator and denominator areexpressed in factored form. We do this by using vectors containing the roots of thenumerator and denominator. Thus, G s¬Ü¬àK *N z¬Ü=D z¬Ücan be expressed as an LTI object using the command, G=zpk(numg,deng,K,T) , where numg is a vector containing the roots of N(z),deng is a vector containing the roots of D(z),Kis the gain, and Tis the sampling interval. The expression zpk stands for zeros (roots of the numerator), poles (roots of the denominator), and gain, K. We demonstrate with G z¬Ü¬à20 z¬á2¬Ü z¬á4¬Ü= ¬â z 0:5¬Ü z 0:7¬Ü z 0:8¬Ü¬äand an unspeci Ô¨Åed sampling interval. Notice after executing the zpk command, MATLAB prints the transfer function. Rational Expression in zMethod, Polynomial Form (Requires Control System Toolbox 9.7) This method allows you to type the transfer function as you normally would write it. The statement z=tf( 'z' ) must precede the transfer function if you wish to create a digital LTI transfer function in polynomial form equivalent to using G=tf(numg, deng,T) . Rational Expression in zMethod, Factored Form (Requires Control System Toolbox 9.7)This method allows you to type the transfer function as you normally would write it. Thestatement z=zpk( 'z' ) must precede the transfer function if you wish to create a digital LTI transfer function in factored form equivalent to using G=zpk(numg,  deng,K,T) . For both rational expression methods the transfer function can be typed in any form regardless of whether z=tf( 'z' ) or z=zpk( 'z' ) is used. The difference is in the created digital LTI transfer function. We use the same examples above to demonstrate therational expression in zmethods. ' (ch13p3) ' % Display label. 'Vector Method, Polynomial Form ' % Display label. numf=150* [1 2 7] % Store 150(z^2+2z+7) in numf and % display. denf= [1 -0.3 0.02] % Store(z^2-0.3z+0.02) in denf and% display. 'F(z) ' % Display label. F=tf(numf,denf,[ ] ) % Form F(z) and display. clear % Clear previous variables from % workspace. 'Vector Method, Factored Form ' % Display label. numg= [-2 -4] % Store (s+2)(s+4) in numg and% display. deng= [0.5 0.7 0.8] % Store (s-0.5) (s-0.7) (s-0.8) in % deng and display. K=20 % Define K. 'G(z) ' % Display label. G=zpk(numg,deng,K,[ ] ) % Form G(z) and display, clear % Clear previous variables from % workspace. 'Rational Expression Method, Polynomial Form ' % Display label. z=tf( 'z' ) % Define z as an LTI object in % polynomial form.810 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:13 F=150* (z^2+2*z+7) / (z^2-0.3*z+0.02) % Form F(z) as an LTI transfer % function in polynomial form. G=20* (z+2) * (z+4) / [ (z-0.5) * (z-0.7) * (z-0.8) ] % Form G(z) as an LTI transfer % function in polynomial form. clear % Clear previous variables from % workspace. 'Rational Expression Method, Factored Form ' % Display label. z=zpk( 'z' ) % Define z as an LTI object in % factored form. F=150* (z^2+2*z+7)/(z^2-0.3*z+0.02) % Form F(z) as an LTI transfer% function in factored form. G=20* (z+2) * (z+4)/ [ (z-0.5) * (z-0.7) * (z-0.8) ] % Form G(z) as an LTI transfer% function in factored form. pause ch13p4 We also can use MATLAB to convert G(z)t o G(s)w h e n G(s) is not in cascade with a z.o.h. First, we create a samp led LTI transfer function, as discussed in ch13p3. The command F=d2c(H, 'zoh ' ) transforms H(z)t oF(s) in cascade with a z. o.h., where H z¬Ü¬à z 1¬Ü=z¬ÜzfF s¬Ü=sg. If we consider F s¬Ü¬àsG s¬Ü, the command solves for sG(s)g i v e n H(z). Finally, sG s¬Ü=s¬àG s¬Üyields the Ô¨Ånal result. In summary, form H(z), where H z¬Ü¬à z 1¬Ü=z¬ÜG z¬Ü.U s e F=d2c (H, 'zoh ' ) toÔ¨ÅndF s¬Ü¬àsG s¬Ü. Divide the result by sand obtain G(s). We convert G z¬Ü¬àz= z 0:3¬Üinto G(s). You will enter T, the sampling interval, through the keyboard. ' (ch13p4) ' % Display label. T=input( 'Type T ' ); % Input sampling interval. numgz= [1 0]; % Define numerator of G(z). dengz= [1 -.3]; % Define denominator of G(z). 'G(z) ' % Display label. Gz=tf(numgz,dengz,T) % Create and display G(z). Hz=Gz*tf( [1 -1] ,[1 0] ,T); % Create H(z) = ( (z-1) /z)*G(z). Hz=minreal(Hz); % Cancel common poles and zeros. Fs=d2c(Hz, 'zoh' ); % Convert from H(z)to F(s) =sG(s). Gs=Fs*tf(1 ,[1 0] ); % Create G(s) =F(s)(1/s). 'G(s) ' % Display label. Gs=minreal(Gs) % Cancel common poles and zeros. pause ch13p5 (Example 13.6) We can use MATLAB to Ô¨Ånd the gain for stability. Let us look at Example 13.6 in the text. ' (ch13p5) Example 13.6' % Display label. numgas=27; % Define numerator of Ga(s). dengas= [1 27 0]; % Define denominator of Ga(s). 'Ga(s) ' % Display label. Ga=tf(numgas,dengas) % Create and display Ga(s). 'G(z) ' % Display label. Gz=c2d(Ga,0.1, 'zoh' ) % Find G(z) assuming Ga(s) in% cascade with z.o.h. and display.B.2 MATLAB Examples 811WEBBAPPB 10/29/2014 9:25:14 for K=1:0.1:50; % Set range of K to look for % stability. Tz=feedback(K*Gz,1); % Find T(z). r=pole(Tz); % Get poles for this value of K. rm=max(abs(r) ); % Find pole with maximum absolute% value for this value of K. if rm>=1, % See if pole is outside unit% circle. break; % Stop if pole is found outside % unit circle. end; % End if. end; % End for. K % Display K value. r % Display closed-loop poles for % this value of K. rm % Display absolute value of pole. pause ch13p6 (Example 13.9) We can use MATLAB ‚Äôsc o m m a n d dcgain(Gz) toÔ¨Ånd steady- state errors. The command evaluates the dc gain of Gz, a digital LTI transfer function object, by evaluating Gzatz¬à1. We use the dc gain to evaluate, Kp,Kv,a n dK a. Let us look at Example 13.9 in the text. You will input T, the sampling interval, through the keyboard to test stability. ' (ch13p6) Example 13.9' % Display label. T=input( 'Type T ' ); % Input sampling interval. numg1s= [10]; % Define numerator of G1(s). deng1s=poly( [0 -1] ); % Define denominator of G1(s). 'G1(s) ' % Display label. G1s=tf(numg1s,deng1s) % Create and display G1(s). 'G(z) ' % Display label. Gz=c2d(G1s,T, ' zoh' ) % Convert G1(s) and z.o.h. to G(z)% and display. 'T(z) ' % Display label. Tz=feedback(Gz,1) % Create and display T(z). 'Closed-Loop z-Plane Poles' % Display label. r=pole(Tz) % Check stability. M=abs(r) % Display magnitude of roots. pauseKp=dcgain(Gz) % Calculate Kp. GzKv=Gz* (1/T)*tf( [1 -1],[1 0],T); % Multiply G(z) by(1/T) * (z-1). % Also, divide G(z) by z , which% makes transfer function proper% and yields same Kv. GzKv=minreal(GzKv,0.00001); % Cancel common poles and zeros.Kv=dcgain(GzKv) % Calculate Kv. GzKa=Gz* (1/T^2) *tf ( [1 -2 1] , [1 0 0] ,T) ; % Multiply G(z) by (1/T^2) (z-1)^2. % Also, divide G(z)by z^2 , which% makes the transfer function% proper and yields the same Ka. GzKa=minreal(GzKa,0.00001); % Cancel common poles and zeros.Ka=dcgain(GzKa) % Calculate Ka. pause ch13p7 (Example 13.10) We now use the root locus to Ô¨Ånd the gain for stability. First, we create a digital LTI transfer-function object for G z¬Ü¬àN z¬Ü=D z¬Ü;with an unspeci Ô¨Åed sampling interval. The LTI object is created using tf(numgz,dengz, [] ) ,w h e r e numgz represents812 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:14 N(z),dengz represents D(z), and []indicates an unspeci Ô¨Åed sampling interval. MATLAB produces a z-plane root locus along with the unit circle superimposed using the command, zgrid ( [] , [] ) . We then interactively select the intersection of the root locus and the unit circle. MATLAB responds with the value of gain and the closed-loop poles. Let us look at Example 13.10. ' (ch13p7) Example 13.10' % Display label. clf % Clear graph. numgz= [1 1]; % Define numerator of G(z). dengz=poly( [1 0.5] ); % Define denominator of G(z). 'G(z) ' % Display label. Gz=tf(numgz,dengz,[] ) % Create and display G(z). rlocus(Gz) % Plot root locus. zgrid( [] , [] ) % Add unit circle to root locus. title ( [ 'z-Plane Root Locus' ] ) % Add title to root locus. [K,p] =rlocfind(Gz) % Allows input of K by selecting% point on graphic. pause ch13p8 (Example 13.11) We now use the root locus to Ô¨Ånd the gain to meet a transient response requirement. After MATLAB produces a z-plane root locus, along with damping ratio curves superimposed using the command zgrid, we interactively select the desired operating point at a damping ratio of 0.7, thus determining the gain. MATLAB responds with a gain value as well as the step response of the closed-loop sampled system using step(Tz) ,w h e r e Tzis a digital LTI transfer-function object. Let us look at Example 13.11. ' (ch13p8) Example 13.11' % Display label. clf % Clear graph. numgz= [1 1]; % Define numerator of G(z). dengz=poly( [1 0.5] ); % Define denominator of G(z). ' G(z) ' % Display label. Gz=tf(numgz,dengz,[] ) % Create and display G(z). rlocus(Gz) % Plot root locus. axis( [0,1,-1,1] ) % Create close-up view. zgrid % Add damping ratio curves to root % locus. title( [ 'z-Plane Root Locus' ] ) % Add title to root locus. [K,p] =rlocfind(Gz) % Allows input of K by selecting % point on graphic. ' T(z) ' % Display label. Tz=feedback(K*Gz,1) % Find T(z). step(Tz) % Find step response of gain-% compensated system. title ( [ 'Gain Compensated Step Response ' ] ) % Add title to step response of% gain-compensated system. pause ch13p9 (Example 13.12) Let us now use MATLAB to design a digital lead compensa- tor. The s-plane design was performed in Example 9.6. Here we convert the design to the z- plane and run a digital simulation of the step response. Conversion of the s-plane lead compensator, Gc(s)=numgcs/dengcs , to the z-plane compensator, Gc(z)=numgcz/ dengcz , is accomplished using the Gcz=c2d(numgcs,dengcs,T, ' tustin ' ) com- mand to perform a Tustin transformation, where T=sampling interval, which for this example is 1/300. This exercise solves Example 13.12 using MATLAB.B.2 MATLAB Examples 813WEBBAPPB 10/29/2014 9:25:15 ' (ch13p9) Example 13.12' % Display label. clf % Clear graph. T=0.01 % Define sampling interval. numgcs=1977* [1 6]; % Define numerator of Gc(s). dengcs= [1 29.1]; % Define denominator of Gc(s). 'Gc(s) in polynomial form' % Print label. Gcs=tf(numgcs,dengcs) % Create Gc(s) in polynomial form % and display. 'Gc(s) in polynomial form' % Display label. Gcszpk=zpk(Gcs) % Create Gc(s) in factored form% and display. 'Gc(z) in polynomial form via Tustin Transformation ' % Display label. Gcz=c2d(Gcs,T, 'tustin' ) % Form Gc(z) via Tustin% transformation. 'Gc(z) in factored form via Tustin Transformation' % Display label. Gczzpk=zpk(Gcz) % Show Gc(z) in factored form. numgps=1; % Define numerator of Gp(s). dengps=poly( [0 -6 -10] ); % Define denominator of Gp(s). 'Gp(s) in polynomial form' % Display label. Gps=tf(numgps,dengps) % Create Gp(s) in polynomial form % and display. 'Gp(s) in factored form' % Display label. Gpszpk=zpk(Gps) % Create Gp(s) in factored form% and display. 'Gp(z) in polynomial form' % Display label. Gpz=c2d(Gps,T, 'zoh' ) % Form Gp(z) via zoh transformation. 'Gp(z) in factored form' % Display label. Gpzzpk=zpk(Gpz) % Form Gp(z) in factored form. Gez=Gcz*Gpz; % Form Ge(z)= Gc(z)Gp(z). 'Ge(z) =Gc(z)Gp(z) in factored form ' % Display label. Gezzpk=zpk(Gez) % Form Ge(z) in factored form % and display. 'z-1 ' % Display label. zm1=tf( [1 -1],1,T) % Form z-1. zm1Gez=minreal(zm1*Gez,0.00001); % Cancel common factors. ' (z-1)Ge(z) for finding steady-state error' % Display label. zm1Gezzpk=zpk(zm1Gez) %Form & display(z-1)Ge(z) in% factored form. Kv= (1/T) *dcgain(zm1Gez) % Find Kv. 'T(z)=Ge(z)/(1+Ge(z) ) ' % Display label. Tz=feedback(Gez,1) % Find closed-loop% transfer function, T(z) step(Tz,0:T:2) % Find step reponse. title( 'Closed-Loop Digital Lead Compensated Step Response ' ) % Add title to step response. B.3 Command Summary abs(x) Obtain absolute value of x. acker(A,B,poles) Find gains for pole placement. angle(x) Compute the angle of xin radians. atan(x) Compute arctan(x ). axis( [xmin,xmax,ymin,ymax] ) DeÔ¨Åne range on axes of a plot.814 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:15 bode(G,w) Make a Bode plot of transfer function G(s) over a range of frequencies, œâ. Field œâis optional. break Exit loop. c2d(G,T, 'tustin' ) Convert G(s)t oG(z) using the Tustin transformation. Tis the sampling interval. c2d(G,T, 'zoh' ) Convert G(s) in cascade with a zero-order hold to G(z).Tis the sampling interval. canon(S, 'modal' ) Convert an LTI state-space object, S,to parallel form. clear Clear variables from workspace. clf Clear current Ô¨Ågure. conv( [a b c d] , [e f g h] ) Multiply as3¬ábs2¬ács¬ád¬Üby es3¬áfs2¬ágs¬áh¬Ü. ctrb(A,B) Find controllability matrix. d2c(G, 'zoh' ) Convert G(z)t oG(s) in cascade with a zero-order hold. dcgain(G) Find dc gain for G(s) (that is, s¬à0), or G(z) (that is,z¬à1). eig(A) Find eigenvalues of matrix A. end End the loop. exp(a) Obtain ea. feedback(G,H,sign) Find T s¬Ü¬àG s¬Ü=¬â1G s¬ÜH s¬Ü¬ä. Sign ¬à 1o ri s optional for negative feedback systems.Sign ¬à¬á1 for positive feedback systems. grid on Put grid lines on a graph. hold off Turn off graph hold; start new graph. imag(P) Form a matrix of the imaginary parts of the components of matrix P. input( 'str' ) Permit variable values to be entered from the keyboard with prompt str. interp1 (x,y,x1) Perform table lookup by Ô¨Ånding the value of yat the value of x¬àx inv(P) Find the inverse of matrix P. length(P) Obtain dimension of vector P. log(x) Compute natural log of x. log10(x) Compute log to the base 10 of x. margin(G) Find gain and phase margins, and gain and phasemargin frequencies of transfer function, G(s). Return [Gain margin, Phase margin, 180 ¬∞ frequency, 0 dB frequency]. max(P) Find the maximum component of P. minreal(G,tol) Cancel common factors from transfer function G (s) within tolerance, tol. If' tol ' Ô¨Åeld is blank, a default value is used. ngrid Superimpose grid over a Nichols plot. nichols(G,w) Make a Nichols plot of transfer function G(s) over a range of frequencies, œâ. Field œâis optional.B.3 Command Summary 815WEBBAPPB 10/29/2014 9:25:16 nyquist(G,w) Make a Nyquist diagram of transfer function G(s) over a range of frequencies, œâ. Field œâis optional. obsv(A,C) Find observability matrix. ord2(wn,z) Create a second-order system, G s¬Ü¬à1=¬âs2¬á2Œ∂œâns¬áœâ2 n¬ä. pade(T,n) Obtain nth order Pad√© approximation for delay, T. pause Pause program until any key is pressed. plot(t1,y1,t2,y2,t3,y3) Ploty1 versus t1,y2 versus t2, and y3 versus t3o n the same graph. pole(G) Find poles of LTI transfer function object, G(s). poly( [  a b c] ) Form polynomial s¬áa¬Ü s¬áb¬Ü s¬ác¬Ü. polyval(P,a) Find polynomial P(s) evaluated at a, that is, P(a). rank(A) Find rank of matrix A. real(P) Form a matrix of the real parts of the components of matrix P. residue(numf,denf) Find residues of F(s) = numf/denf. rloc Ô¨Ånd(GH) Allow interactive selection of points on a root locus plot for loop gain, G(s)H(s). Return value for Kand all closed-loop poles at thatK. rlocus(GH,K) Plot root locus for loop gain, G(s)H(s),over a range of gain, K.TheKÔ¨Åeld is optional. roots(P) Find roots of polynomial, P. semilogx(w,P1) Make a semilog plot of P1versus log10 œâ¬Ü. series(G1,G2) Find G1 s¬ÜG2 s¬Ü. sgrid(z,wn) Overlay z Œ∂¬Üandwn(œân) grid lines on a root locus. sin(x) Find sin( x). sqrt(a) ComputeÔ¨ÉÔ¨ÉÔ¨É ap . ss2tf(A,B,C,D,1) Convert a state-space representation to a transfer function. Return [num,den] . ss(A,B,C,D) Create an LTI state-space object, S. ss(G) Convert an LTI transfer function object, G(s),to an LTI state-space object. ssdata(S) Extract A,B,C, andDmatrices from LTI state- space object, S. step(G1,G2,.. Gn,t) Plot step responses of G1 s¬Üthrough Gn s¬Üon one graph over a range of time, t. Field tis optional as are Ô¨ÅeldsG2through Gn. subplot(xyz) Divide plotting area into an xbyygrid with zas the window number for the current plot. tan(x) Find tangent of xradians. text(a,b, 'str' ) Putstr on graph at graph coordinates, x¬àa,y¬àb. tf2ss(numg,deng) Convert G s¬Ü¬ànumg/deng to state space in controller canonical form. Return [A,B,C,D] . vpa(a,D) Calculate awith Ddigits and convert to a symbolic with Ddigits.816 Appendix B: MATLAB TutorialWEBBAPPB 10/29/2014 9:25:16 tf2zp(numg,deng) Convert G s¬Ü¬ànumg/deng in polynomial form to factored form. Return [zeros, poles, gains] . tf(numg,deng,T) Create an LTI transfer function, G s¬Ü¬ànumg/ deng, in polynomial form. Tis the sampling interval and should be used only if Gis a sampled transfer function. tf(G) Convert an LTI transfer function, G(s), to polynomial form. tfdata(G, 'v' ) Extract numerator and denominator of an LTItransfer function, G(s), and convert values to a vector. Return [num, den] . title( 'str' ) Put title str on graph. xlabel( 'str' ) Put label str onxaxis of graph. ylabel( 'str' ) Put label str onyaxis of graph. zgrid Superimpose z(Œ∂)andwn œâ n¬Ügrid curves on a z-plane root locus. zgrid( [ ] , [ ] ) Superimpose the unit circle on a z-plane root locus. zp2tf ( [  a b] ' , [  c d] ',K ) Convert F s¬Ü¬àK s¬áa¬Ü s¬áb¬Ü= s ¬ác¬Ü s¬ád¬Üto polynomial form.Return [num,den] . zpk(numg,deng,K,T) Create an LTI transfer function, G s¬Ü¬ànumg/ deng , in factored form. Tis the sampling interval and should be used only ifGis a sampled transfer function. zpk(G) Convert an LTI transfer function, G(s),to factored form. Bibliography Johnson, H. et al. Unmanned Free-Swimming Submersible (UFFS) System Description. NRL Memorandum Report 4393. Naval Research Laboratory, Washington, D.C., 1980. MathWorks. Control System ToolboxTMGetting Started Guide R2014a . MathWorks, Natick, MA, 2000‚Äì2014. MathWorks. Control System ToolboxTMUser ‚Äôs Guide R2014a . MathWorks, Natick, MA, 2001 ‚Äì2014. MathWorks. MATLABÓÄÑPrimer R2014a. MathWorks, Natick, MA, 1984 ‚Äì2014. MathWorks. MATLABÓÄÑGraphics R2014a . MathWorks, Natick, MA, 1984 ‚Äì2014. MathWorks. MATLABÓÄÑMathematics R2014a. MathWorks, Natick, MA, 1984 ‚Äì2014. MathWorks. MATLABÓÄÑProgramming Fundamentals R2014a . MathWorks, Natick, MA, 1984 ‚Äì2014. MathWorks. SimulinkÓÄÑGetting Started Guide R2014a. MathWorks, Natick, MA, 1990 ‚Äì2014. MathWorks. SimulinkÓÄÑUser ‚Äôs Guide R2014a . MathWorks, Natick, MA, 1990 ‚Äì2014. MathWorks MATLABÓÄÑ& SimulinkÓÄÑInstallation Guide R2014a. MathWorks, Natick, MA, 1996‚Äì2014.Bibliography 817WEBBAPPB 10/29/2014 9:25:16 Page 818WEBBAPPC 10/28/2014 21:33:37 Appendix C: Simulink Tutorial C.1 Introduction Readers who are studying MATLAB may want to explore the functionality and convenience of Simulink. Before proceeding, the reader should have studied Appendix B, the MATLAB Tutorial, including Section B.1, which is applicable to this appendix. Simulink Version 8.3 and MATLAB Version 8.3(R2014a) are required in order to use Simulink. In addition, if you wish to pursue the design of PID controllers discussed in Section C.4, you will need the Simulink Control Design Version 4(R2014a) add-on. The models described in this appendix are available at www.wiley.com/college/nise . The code will also run on workstations that support MATLAB. Consult the MATLABInstallation Guide for your platform for minimum system hardware requirements. Simulink is used to simulate systems. It uses a graphical user interface (GUI) for you to interact with blocks that represent subsystems. You can position the blocks, resize theblocks, label the blocks, specify block parameters, and interconnect blocks to form completesystems from which simulations can be run. Simulink has block libraries from which subsystems, sources (that is, function generators), and sinks (that is, scopes) can be copied. Subsystem blocks are availablefor representing linear, nonlinear, and discrete systems. LTI objects can be generated if theControl System Toolbox is installed. Help is available on the Quick Access Toolbar at the top of the MATLAB R2014a window. Click the circled question mark and select Simulink . Help is also available for each block in the block library and is accessed either by right-clicking a block ‚Äôs icon in the Simulink Library Browser and selecting Help for or by double-clicking the block ‚Äôs icon and then clicking the Help button. Finally, screen tips are available for some toolbar buttons. Let your mouse ‚Äôs pointer rest on the button for a few seconds to see the explanation. C.2 Using Simulink The following summarize the steps to take to use Simulink. Section C.3 will present fourexamples that demonstrate and clarify these steps. Access Simulink TheSimulink Library Browser , from where we begin Simulink, is accessed by typing simulink in the MATLAB Command Window or by clicking on the Simulink Library button on the toolstrip, shown circled in Figure C.1. In response, MATLAB displays the Simulink Library Browser shown in Figure C.2( a). We now create an untitled window, Figure C.2( b), by clicking on the New model button (shown circled in Figure C.2( a)) on the toolbar of the Simulink 819WEBBAPPC 10/28/2014 21:33:37 FIGURE C.1 MATLAB Window showing how to access Simulink. The Simulink Library Browser button is shown circled FIGURE C.2 a. Simulink Library Browser window showing the New model button encircled; (Ô¨Ågure continues )820 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:38 Library Browser . You will build your system in this window. Existing models may be opened by clicking on the Open model button on the Simulink Library Browser toolbar. This button is immediately to the right of the New model button. Existing models may also be opened from the Filesection of the Home tab on the Toolstrip or from the Searchbar below the Toolstrip on the MATLAB window. Select blocks Figure C.2( a) shows the Simulink Library Browser from which all blocks can be accessed. The left-hand side of the browser shows major libraries, such as Simulink , as well as underlying block libraries, such as Continuous . The right-hand side of Figure C.2( a) also shows the underlying block libraries. To reveal a block library ‚Äôs underlying blocks, select the block library on the left-hand side or double-click the blocklibrary on the right-hand side. As an example, the Continuous library blocks under the Simulink major library are shown exposed in Figure C.3( a). Figures C.3( b) and C.3( c) show some of the Sources andSinks library blocks, respectively. Another approach to revealing the Simulink block library is to type open_system (‚Äòsimulink ‚Äô)in the MATLAB Command Window . The window shown in Figure C.4 is the result. Double-clicking any of the libraries in Figure C.4 reveals an individual window containing that library ‚Äôs blocks, equivalent to the right-hand side of the Simulink Library Browser as shown in the examples of Figure C.3. Assemble and label subsystems Drag required subsystems (blocks) to your model window from the browser, such as those shown in Figure C.3. Also, you may access the blocks by double-clicking the libraries shown in Figure C.4. You can position, resize, andrename the blocks. To position, drag with th e mouse; to resize, click on the subsystem and drag the handles; to rename, click on the existi ng name, select the existing text, and type the new name. Interconnect subsystems and label signals Position the pointer on the small arrow on the side of a subsystem, press the mouse button, and drag the resulting cross-hair pointerto the small arrow of the next subsystem. A line will be drawn between the twosubsystems. Blocks may also be interconnected by single-clicking the Ô¨Årst block followed by single-clicking the second block while holding down the control key.You can move line segments by positioning the pointer on the line, pressing the mousebutton, and dragging. Branches to line segments can be drawn by positioning the pointerwhere you want to create a line segment, holding down the mouse ‚Äôs right button, and FIGURE C.2 (Continued )b.resulting untitled model windowC.2 Using Simulink 821WEBBAPPC 10/28/2014 21:33:38 FIGURE C.3 Simulink block libraries: a.Continuous systems; b.Sources (Ô¨Ågure continues )822 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:38 dragging the resulting cross hairs. A new line segment will form. Signals can be labeled by double-clicking the line and typing. Finally, labels can be placed anywhere by double-clicking and typing into the resulting box. Choose parameters for the subsystems Double-click a subsystem in your model window and type in the desired parameters. Some explanations are provided in the Block FIGURE C.3 (Continued )c.Sinks FIGURE C.4 Simulink Block Library windowC.2 Using Simulink 823WEBBAPPC 10/28/2014 21:33:39 Parameters window. Press the Help button in the Block Parameters window for more details. Explore other options by right-clicking on a block. Choose parameters for the simulation Select Model ConÔ¨Å guration Parameters under the Simulation menu in your model window to set additional parameters, such as simulation time. Press the Help button in the ConÔ¨Å guration Parameters window for more details. Start the simulation Make your model window the active window. Double-click the Scope block (typically, the scope is used to view the simulation results) to display the Scope window. Select Run under the Simulation menu in your model window or click on the Run icon on the toolbar of your model window as shown in Figure C.2( b). Clicking the Stop icon will stop the simulation before completion. Interact with the plot In the Scope window, using the toolbar buttons, you can zoom in and out, change axes ranges, save axis settings, and print the plot. Right-clicking on the Scope window brings up other choices. Save your model Saving your model, by choosing Save under the Filemenu, creates a Ô¨Åle with an .mdl extension, which is required. C.3 Examples This section will present four examples of the use of Simulink to simulate linear, nonlinear,and digital systems. Examples will show the Simulink block diagrams as well as explain thesettings of parameters for the blocks. Finally, the results of the simulations will be shown. Example C.1 Simulation of Linear SystemsSimulation of Linear Systems OurÔ¨Årst example develops a simulation of three linear systems to compare their step responses. In particular, we solve Example 4.8 and reproduce the responses shown in Figure 4.24. Figure C.5 shows a Simulink block diagram formed by following Steps 1through 5 in Section C.2 as follows: Access Simulink; select, assemble, and label subsystems The source is a 1-volt step input, obtained by dragging the Step block from the Simulink Library Browser under Sources to your model window. TheÔ¨Årst system, T1, consists of two blocks, Gain andTransfer Fcn. Gain is obtained by dragging the Gain block from the Simulink Library Browser under Math Operations to your model window. Transfer function, T1, is obtained by dragging the Transfer Fcn block from the Simulink Library Browser under Continuous to your model window. Systems T2 and T3 are created similarly. The three output signals, C1, C2, and C3, are multiplexed for display into the single input of a scope. The Mux (multiplexer) is obtained by dragging the Mux block from the Simulink Library Browser under Signal Routing to your model window. The sink is a scope, obtained by dragging the Scope block from the Simulink Library Browser under Sinks to your model window. Alternatively, all blocks can be dragged from the Library: simulink window shown in Figure C.4. The Mux can be found under Signal Routing in the Library: simulink window. The labels for the blocks can be changed to those shown in Figure C.5 by following Step 3 in Section C.2.824 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:39 Interconnect subsystems and label signals Follow Step 4 to interconnect the subsystems and label the signals. You must set the mux‚Äô s parameters before the wiring can be completed. See the next paragraph. Choose parameters for the subsystems Let us now set the parameters of each block using Step 5. The Block Parameters window for each block is accessed by double- clicking the block on your model window. Figure C.6 shows the Block Parameters windows for the 1-Volt step input, gain, transfer function 1, and mux. Set the parameters to the required values as shown. FIGURE C.5 Simulink block diagram for Example C.1 FIGURE C.6 Block parameters windows for a.1-Volt step source; (Ô¨Ågure continues )C.3 Examples 825WEBBAPPC 10/28/2014 21:33:40 FIGURE C.6 (Continued )b.gain; c.transfer function 1; d.mux826 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:40 The scope requires further explanation. Double-clicking the Scope block in your model window accesses the scope ‚Äôs display, Figure C.7( a). FIGURE C.7 Windows for the scope: a. Scope ;b.‚ÄòScope ‚Äôparameters, General tab;c.‚ÄòScope ‚Äôparameters, History tab; d.‚ÄòScope ‚Äôparameters, Style tab; (Ô¨Ågure continues )C.3 Examples 827WEBBAPPC 10/28/2014 21:33:40 Clicking the Parameters icon on the Scope window toolbar, shown in Figure C.7( a), accesses the ‚ÄòScope ‚Äôparameters window as shown in Figure C.7( b). The ‚ÄòScope ‚Äô parameters window contains three tabs, General, History, andStyle , as shown in Figure C.7( b),(c),and ( d), respectively. Finally, right-clicking in the plotting area in the Scope window and selecting Axis properties . . . reveals the ‚ÄòScope ‚Äôproperties: axis 1 window, Figure C.7( e). We now can set the display parameters, such as amplitude range. Choose parameters for the simulation Follow Step 6 to set simulation parameters. Figure C.8 shows the resulting ConÔ¨Å guration Parameters window. Among other parameters, the simulation start and stop times can be set. Start the simulation Now run the simulation by following Step 7. Figure C.9 shows the result in the Scope window. Plots are color coded in the order in which they appear at the mux input as follows: yellow, magenta, cyan, red, green, and dark blue. If the mux has more inputs, the colors recycle. Colors can be changed in the Style tab of the ‚ÄòScope ‚Äô parameters window. FIGURE C.7 (Continued )e.‚ÄòScope ‚Äôproperties axis 1 FIGURE C.8 ConÔ¨Å guration Parameters window for Solver tab828 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:41 Interact with the plot The toolbar of the Scope window shown in Figure C.9 has several buttons that can be used to interact with the plot. Let us summarize the function and operation of each, starting with the left-most button: Button 1 executes a plot print. Button 2 has already been explained and is used to set scope parameters. Button 3 permits zooming into the plot in both the xandydirections. Press the button and drag a rectangle over the portion of the curve you want to expand. Button 4 allows zooming in the xdirection only. Drag a horizontal line over the plot covering the extent of xyou want to expand. Button 5 allows zooming in the ydirection only. Drag a vertical line over the plot covering the range of yyou want to expand. Button 6 autoscales axis for use after zooming. Button 7 saves current axis settings. Button 8 restores saved axis settings. Button 9 toggles Ô¨Çoating scope. It must be turned off to use zooming. See documentation for use of Ô¨Çoating scopes. Button 10 toggles lock for current axis selection. Button 11 allows selection of signals to view when using Ô¨Çoating scope. FIGURE C.9 Scope window after Example C.1 simulation stopsC.3 Examples 829WEBBAPPC 10/28/2014 21:33:41 Example C.2 Effect of Ampli Ô¨ÅerSaturation on Motor's Load Angular VelocityEffect of Ampli Ô¨Åer Saturation on Motor's Load Angular Velocity This example, which generated Figure 4.29 in the text, shows the use of Simulink to simulate the effect of saturation nonlinearity on an open-loop system. Figure C.10 showsa Simulink block diagram formed by following Steps 1 through 5 in Section C.2 above. Saturation nonlinearity is an additional block that we have not used before. Saturation is obtained by dragging to your model window the Saturation block in the Simulink Library Browser window under Discontinuities as shown in Figure C.11( a) and setting its parameters to those shown in Figure C.11( b). FIGURE C.10 Simulink block diagram for Example C.2 FIGURE C.11 a.Simulink library for nonlinearities; (Ô¨Ågure continues ) 830 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:41 Now run the simulation by making your model window active and selecting Run under the Simulation menu of your model window or clicking on the Run button on your model window toolbar. Figure C.12 shows the result in the Scope window. FIGURE C.11 (Continued ) b.parameter settings for saturation FIGURE C.12 Scope window after simulation of Example C.2 stops. The lower curve is the output with saturationC.3 Examples 831WEBBAPPC 10/28/2014 21:33:42 Example C.3 Simulating Feedback SystemsSimulating Feedback Systems Simulink can be used for the simulation of feedback systems. Figure C.13( a)i sa n example of a feedback system with saturation. In this example, we have added a feedback path (see Step 4 in Section C.2) and a summing junction, which is obtained by dragging the Sum block from the Simulink Library Browser , contained in the Math Operations library, to your model window. TheFunction Block Parameters: Sum window, Figure C.13( b), shows the parameter settings for the summer. You can set the shape as well as set the plus and minus inputs. In FIGURE C.13 a.Simulation block diagram for a feedback system with saturation; b.block parameter window for the summer832 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:42 the list of signs, the ‚Äú|‚Äùsymbol signi Ô¨Åes a space. We place it at the beginning to start the signs at ‚Äúnine o'clock, ‚Äùconforming to our standard symbol, rather than at ‚Äú12 o‚Äô clock. ‚Äù The result of the simulation is shown in Figure C.14. Example C.4 Simulating Digital SystemsSimulating Digital Systems This example demonstrates two methods of generating digital systems via Simulink for the purpose of simulation, as shown in Figure C.15. FIGURE C.15 Simulink block diagram for simulating digital systems two ways FIGURE C.14 Simulation output for Example C.3C.3 Examples 833WEBBAPPC 10/28/2014 21:33:42 TheÔ¨Årst approach uses a linear transfer function cascaded with a Zero-Order Hold block obtained from the Simulink Library Browser under the Discrete block library, shown on the right-hand side of Figure C.16. The second method uses a discrete transfer function also obtained from the Simulink Library Browser under the Discrete block library. The remainder of the block diagram was obtained by methods previously described. The block parameters for the Zero-Order Hold andDiscrete Transfer Fcn blocks are set as shown in Figures C.17( a) and ( b), respectively. Select Model ConÔ¨Å guration Parameters under the Simulation menu in your model window and set the simulation stop time to 4 seconds, the type to Ô¨Åxed-step , and the solver to ode4 (Runge-Kutta). The result of the simulation is shown in Figure C.18. FIGURE C.16 Simulink library of discrete blocks FIGURE C.17 Function Block parameter windows for: a. Zero-Order Hold block; (Ô¨Ågure continues )834 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:43 FIGURE C.18 Outputs of the digital systems FIGURE C.17 (Continued )b. Discrete Transfer Fcn blockC.3 Examples 835WEBBAPPC 10/28/2014 21:33:43 C.4 Using Simulink for Control System Design In this section we show how to use Simulink to design control systems to meet speci Ô¨Åcations previously discussed in this book. We can make gain adjustments and design compensators using our Simulink system along with other windows that give us instant veri Ô¨Åcation of our design. Speci Ô¨Åcally, we will concentrate on the design of PID compensators. We will show that PID compensators can be designed automatically or by adjusting design tools, such as responsetime and transient behavior. As we make adjustments, we see the immediate result of our designin lists of speci Ô¨Åcations or time responses along with the automatic calculation of the PID gains. In order to perform control system design, you will need to add the Simulink ÓÄÑControl DesignTMmodule Version 4.0 (R2014a), which contains all the necessary tools. Simulink designs PID controllers using derivative control with a low-pass Ô¨Ålter to reduce noise. The design requires negative values of derivative gain, which you will notice in the designexamples. We Ô¨Årst cover the automated design of PID controllers. Next, we cover PID design using graphical methods. Automated Design of PID Controllers The automated design of PID gains generates reasonable robustness and response time. After the initial design, further adjustments are available, including response time, bandwidth, and phase margin. Let us Ô¨Årst enumerate the steps involved, followed by an example. Create a Simulink diagram Begin with a linear or nonlinear feedback control system containing a PID controller. Set initial values for the PID controller Double-click the PID controller and launch theFunction Block Parameters: PID Controller window. On the MAIN tab, input nominal values for the Controller parameters. Click Apply . Tune the PID controller Click Tune . . . in the Function Block Parameters: PID Controller window. The system is linearized and the PID Tuner window is launched showing the nominal values response ( Block response ) and the designed response (Tuned response ). Click the Show parameters button on the Toolstrip of the PID Tuner window to expose performance data, including the designed PID gains. If the response meets requirements, then click the Update Block button on the Toolstrip of the PID Tuner window to write the PID parameters to the controller. Modify the design via interactive tuning If required, change the performance by moving the Response Time andTransient Behavior sliders in the middle of the Toolstrip of the PID Tuner window. Click the Update Block to write the PID parameters to the controller. If the system is nonlinear, you should run the simulationto see the effect of the nonlinearity on the designed response. Example C.5 Automated Design of a PID ControllerAutomated Design of a PID Controller In this example we follow the previously enumerated steps to automate the design of a PID controller for the system of Figure C.19. The requirements are (1) less than 1 secondsettling time; and (2) less than 5% overshoot. Create a Simulink diagram We create the Simulink block diagram of Figure C.19 where the PID controller block is found in the Simulink Library Browser as shown in Figure C.3( a). Set initial values for the PID controller Double-clicking the PID controller results in Figure C.20. For initial values we have chosen unity and clicked Apply .836 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:43 FIGURE C.19 Simulink block diagram for automated design of a PID controller FIGURE C.20 Function Block Parameters window for the PID controllerC.4 Using Simulink for Control System Design 837WEBBAPPC 10/28/2014 21:33:44 Tune the PID controller Click Tune . . . in Figure C.20 to launch the PID Tuner window shown in Figure C.21( a). Click the Show Parameters button, shown encircled, on the Toolstrip of the PID Tuner window to display parameters and performance. Modify the design via interactive tuning Following the instructions in Step 4 on page 836, we continue tuning the controller using the Response Time andTransient Bahavior sliders. Finally, click the Update Block button to write the PID parameters to the controller. The Ô¨Ånal design is shown in Figure C.21( b). FIGURE C.21 PID Tuner window: a.before additional tuning; b.after additional tuning838 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:44 Automated Tuning of PID Controllers and Graphical Design In this subsection, we begin PID design with automated tuning followed by graphical design of our choice using Bode plots, root locus, etc. Let us Ô¨Årst enumerate the steps involved followed by an example. Create a Simulink diagram Begin with a linear or nonlinear feedback control system containing a PID controller. Begin compensator design From the menu bar of your Simulink block diagram select Analysis/Control Design/Control System Designer . . . launching the Control and Estimation Tools Manager window. Select block to tune In the Control and Estimation Tools Manager window, click Select Blocks ....I n t h e resulting Select Blocks to Tune window, choose PID Controller and click OK. Choose the closed-loop response for which response will be analyzed On the Simulink block diagram, choose the input and output for the closed-loop. Right-click at the input and choose Linear Analysis Points/Input Perturbation . Right-click at the output point and choose Linear Analysis Points/Output Measurement . Small vertical arrows result at these points to indicate your selection. Tune blocks andlaunch theDesign Con Ô¨Åguration Wizard Click Tune Blocks ...a n d launch the Design Con Ô¨Åguration Wizard. Click Next and select the graphical plots you want to use for design. Click Next and choose the Analysis Plots you want to use to analyze the design. Check the Contents of Plots boxes that correspond to the Responses you want your Analysis Plots to display. Click Finish and launch the LTI Viewer for SISO Design Task window that contains the Analysis Plots you selected. Also launched is the SISO Design for SISO Design Task window that contains the graphical design plots that you previously selected. Perform automatic tuning of the PID controller In the Control and Estimation Tools Manager window select the Automated Tuning tab at the top right. Select PID Tuning in the Design method: drop-down menu. Select Tuning method andControl- ler Type . Click Update Compensator , which selects compensator gains and updates the response and graphical design curves. Click Update Simulink Block Parameters . Evaluate performance Right-click the response curve and select Characteristics. Select each desired choice under Characteristics ,addin g a plot marker to the curve at the appropriate measurement point. Click on each marker to read the performancedata. Improve performance by interacting with the graphical design plots Change PID poles and gains until your response meets the requirements. You may add performanceboundaries by right-clicking the design graphic and selecting Design Requirements/ New. . . . From the pull-down menu select the desired requirements. Upon closing the window the performance boundary is placed on the graphical design plot. Example C.6 Automated Tuning of a PID Controller and Graphical DesignAutomated Tuning of a PID Controller and Graphical Design In this example we follow the previously enumerated steps to automatically design a PID controller for the system of Figure C.19 and follow with further improvement inperformance using root locus. The requirements are: (1) less than 1 second settlingtime; and (2) less than 4% overshoot.C.4 Using Simulink for Control System Design 839WEBBAPPC 10/28/2014 21:33:44 Create a Simulink diagram We create the Simulink block diagram of Figure C.19 where the PID controller block is found in the Simulink Browser Library as shown in Figure C.3( a). Begin Compensator design In Figure C.19, we select Analysis/Control Design/ Compensator Design . . . , launching the Control and Estimation Tools Manager window shown in Figure C.22( a). FIGURE C.22 a. Control and Estimation Tools Manager window before selecting block to tune; b. Select blocks to Tune window; (Ô¨Ågure continues )840 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:45 Select blocks to tune Click Select Blocks . . . in Figure C.22(a ) and launch the Select Blocks to Tune window shown in Figure C.22( b). Select PID Controller and click OK. The resulting Control and Estimation Tools Manager is shown in Figure C.22( c). C h o o s et h ec l o s e d - l o o pr e s p o n s ef o rw h i c hr e s p o n s ew i l lb ea n a l y z e d On the Simu- link block diagram, right-click the output of the step input and select Linear Analysis Points/Input Perturbation , placing a small down-arrow with a summing junction at that point, signifying the input of the closed-loop response. Similarly, the closed-loop output is chosen by right-clicking the output of the plant and selecting Linear Analysis Points/Output Measurement . A small up-arrow results, signifying the output of the closed-loop system. The resulting Simulink block diagram is shown in Figure C.23. Tune blocks and launch the Design Con Ô¨Åguration Wizard Click T u n eB l o c k s... in Figure C.22( c) and launch the Design Con Ô¨Åguration Wizard .C l i c k Next .T h e resulting window is shown in Figure C24( a). Select Root Locus in the Plot Type pull- down menu for Plot 1 . Click Next to select the plot to be used for analysis as shown in Figure C.24( b) .F o rt h i sc a s ew ec h o o s e Step forPlot 1 ,Plot Type . Also check the box for Plot 1 below to indicate the Responses as shown. FIGURE C.22 (Continued )c. Control and Estimation Tools Manager window after selecting block to tune FIGURE C.23 Simulink block diagram showing closed-loop input andoutput pointsC.4 Using Simulink for Control System Design 841WEBBAPPC 10/28/2014 21:33:45 Click Finish and launch the LTI Viewer for SISO Design Task window that contains the step response you selected for analysis. Also launched is the SISO Design for SISO Design Task window that contains the root locus plot that you previously selected for design. Before we discuss these two plots, we Ô¨Årst perform automatic PID tuning. Perform automated tuning of the PID controller TheControl and Estimation Tools Manager now looks like that shown in Figure C.25 after selecting the Automated Tuning tab at the top and making the selections shown in the Ô¨Ågure. Click Update Compensator andUpdate Simulink Block Parameters . You should notice a marked improvement in the step response as shown in Figure C.26. FIGURE C.24 Design Con Ô¨Åguration Wizard: a. with root locus selected as the design tool; b.with closed-loop step response selected as analysis tool842 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:45 Evaluate performance Right-click on the response curve shown in Figure C.26 and choose Characteristics . Select Peak Response andSettling Time . Blue dots are placed on the response curve at the appropriate points. Click on each dot to reveal the performance. In this case we see that automatic tuning yields 6.77% overshoot and 1.56settling time. The requirements are not met. FIGURE C.25 Control and Estimation Tools Manager prepared for automatic PID tuning FIGURE C.26 LTI Viewer for SISO Design Task window showing closed-loop step response after automatic PID tuningC.4 Using Simulink for Control System Design 843WEBBAPPC 10/28/2014 21:33:51 Improve performance by interacting with the graphical design plots We now reshape the root locus plot in order to improve performance and meet the require- ments. On the root locus shown in the SISO Design for SISO Design Task window, right-click and select Design Requirements/New. . . . In the pull-down menu select Settling time and type in 1 second. Click OK. Right-click again and choose Design Requirements/New. . . . In the pull-down menu select Percent overshoot a n dt y p ei n4 . C l i c k OK. In response, design boundaries are placed on the root locus. See Figure C.27. The white space represents responses faster than 1 second settling time and overshoot less than 4%. Now adjust root locus gain (red squares), PID zero (red zero), and/or PIDpole (red x). These are adjusted by letting your mouse rest on the selected red indicatoruntil it turns into a hand. Then move the indicator. Shape the root locus until an operatingpoint falls within the white area. After adjustments, we obtain the root locus shown inFigure C.28( a) and the time response shown in Figure C.28( b) . We conclude that the design requirements are met. FIGURE C.27 Root locus showing design boundaries of 4% overshoot (radial lines) and 1 second settling time (vertical line) with adjustable gain, PID zero, and PID poleshown in red844 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:54 FIGURE C.28 Final design as shown in a.root locus; b.step responseC.4 Using Simulink for Control System Design 845WEBBAPPC 10/28/2014 21:33:54 Summary This appendix explained Simulink, its advantages, and how to use it. Examples were taken from Chapters 4, 5, and 13 and demonstrated the use of Simulink for simulating linear, nonlinear, and digital systems. In addition, we showed how to use the Simulink Control Design add-on to automatically tune PID controllers and perform shaping of graphical design tools in orderto meet performance requirements. The objective of this appendix was to familiarize you with the subject and get you started using Simulink. There are many blocks, parameters, and preferences that could notbe covered in this short appendix. You are encouraged to explore and expand your use of Simulink by using the on-screen help that was explained earlier. The references in the Bibliography of this appendix also provide an opportunity to learn more about Simulink. Bibliography MathWorks. Control System ToolboxTMGetting Started Guide R2014a . MathWorks, Natick, MA, 2000 ‚Äì2014. MathWorks. Control System ToolboxTMUser ‚Äôs Guide R2014a . MathWorks, Natick, MA, 2001 ‚Äì2014. MathWorks. MATLABÓÄÑPrimer R2014a. MathWorks, Natick, MA, 1984 ‚Äì2014.The designed compensator is displayed in the Control and Estimation Tools Man- ager under the Compensator Editor tab. Be sure to click the Update Simulink Block Parameters button at the bottom to update your Simulink model. The result is shown in Figure C.29. FIGURE C.29 PID meeting design requirements846 Appendix C: Simulink TutorialWEBBAPPC 10/28/2014 21:33:54 MathWorks. MATLABÓÄÑGraphics R2014a . MathWorks, Natick, MA, 1984 ‚Äì2014. MathWorks. MATLABÓÄÑMathematics R2014a. MathWorks, Natick, MA, 1984 ‚Äì2014. MathWorks. MATLABÓÄÑProgramming Fundamentals R2014a . MathWorks, Natick, MA, 1984 ‚Äì2014. MathWorks. SimulinkÓÄÑGetting Started Guide R2014a. MathWorks, Natick, MA, 1990 ‚Äì2014. MathWorks. SimulinkÓÄÑUser ‚Äôs Guide R2014a . MathWorks, Natick, MA, 1990 ‚Äì2014. MathWorks. SimulinkÓÄÑControl DesignTMGetting Started Guide R2014a . MathWorks, Natick, MA, 2004 ‚Äì2014. MathWorks. SimulinkÓÄÑControl DesignTMUser ‚Äôs Guide R2014a . MathWorks, Natick, MA, 2004 ‚Äì2014. *All MATLAB and Simulink screenshots in this book are reprinted with permission from The MathWorks, Inc.Bibliography 847WEBBAPPC 10/28/2014 21:33:54 Page 848WEBBAPPD 10/28/2014 21:59:55 Appendix D: LabVIEW Tutorial D.1 Introduction LabVIEW is a programming environment that is presented here as an alternative to MATLAB. Although not necessary, the reader is encouraged to become acquainted with MATLAB before proceeding, since familiarity with MATLAB can enhance the understanding of the relationship between textual (MATLAB) and graphical (LabVIEW)programming languages and extend the functionality of LabVIEW. In this tutorial, we willshow how to use LabVIEW to (1)analyze and design control systems, and (2)simulate control systems. This appendix was developed using LabVIEW 2013. LabVIEW is a graphical programming environment that produces virtual instruments (VI ‚Äôs). A VI is a pictorial reproduction of a hardware instrument on your computer screen, such as an oscilloscope or waveform generator. The VI can consist of various controls and indicators, which become inputs and outputs, respectively, to your program. Underlying each control and indicator is an associated block of code that de Ô¨Ånes its operation. The LabVIEW model thus consists of two windows: (1)Front Panel , which is a replica of the hardware front panel showing the controls and indicators, and (2)Block Diagram , which contains the underlying code for the controls and indicators on the Front Panel . Associated with the Front Panel window is a Controls palette window containing numerous icons representing controls and indicators. The icons can be dragged onto a Front Panel window to create that control or indicator. Simultaneously, the associated code block is formed on the Block Diagram window. Alternately, the block diagram can be formed Ô¨Årst, and then the front panel is created from the block diagram. Associated with the Block Diagram window is a Functions palette window containing numerous icons representing a wide range of functions. Icons can bedragged onto a Block Diagram window to create that code block. For example, Figure D.1(a ) is the front panel of a signal generator. The generator consists of a control to select the signal typ e and a waveform graph that shows the output waveform. Figure D.1( b) shows the underlying code, which is contained in the code blocks. Here, the signal type selector is a control, while the waveform graph is anindicator. Later we will show how to make connections to other VI‚Äô s. The palette windows for the front panel and block diagram are shown respectively in Figures D.1( c) and ( d). 849WEBBAPPD 10/28/2014 21:59:55 D.2 Control Systems Analysis, Design, and Simulation LabVIEW can be used as an alternative to or in conjunction with MATLAB to analyze, design, simulate, build, and deploy control systems. In addition to LabVIEW, you will needthe LabVIEW Control Design and Simulation Module. Finally, as an option that will be explained later, you may want to install the MathScript RT Module. Analysis and design can be thought of as similar to writing MATLAB code, while simulation can be thought of as similar to Simulink. In LabVIEW, analysis and design, as opposed to simulation, are handled from different subpalettes of the Functions window ‚Äôs Control Design and Simulation palette. See Figure D.1( d). Analysis and design, and simulation will typically begin with the Block Diagram window, where icons representing code blocks will be interconnected. Parameters used by the code can be convenientlyselected, changed, and passed to the code through VI controls on the Front Panel window created from the code icons. Any results, such as time response, can be displayed through VIindicators on the Front Panel window created from the code icons. FIGURE D.1 A LabVIEW function generator VI: a. Front Panel window; b. Block Diagram window; (Ô¨Ågure continues )850 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 21:59:55 D.3 Using LabVIEW The following steps start you on your way to using LabVIEW for control systems analysis, design, and simulation. These steps will be illustrated in the examples that follow. Start LabVIEW LabVIEW starts with the window shown in Figure D.2, where you can select a New VI orOpen an existing VI from the Filemenu. Alternatively, existing FIGURE D.1 (Continued )c. Controls palette; d. Functions palette FIGURE D.2 LabVIEW windowD.3 Using LabVIEW 851WEBBAPPD 10/28/2014 21:59:56 VI‚Äôs can be opened from the Open Existing table on the right. Selecting a new or existing VI brings up the Front Panel andBlock Diagram windows shown in Figure D.1. If necessary, a window can be opened from the Window tab on the menu bar of the Front Panel andBlock Diagram . Right-click the Block Diagram window to bring up the Functions palette and click the thumb tack in the upper left-hand corner to dock the window. Repeat for the Front Panel window to access the Controls palette. Select blocks Make the Block Diagram window active, or access it from Window on the menu bar. Right-click the Block Diagram window or use the View menu to bring up theFunctions palette. Expand the palette window by clicking the double-up arrows at the bottom. At the top of the palette window click Customize , and select View This Palette As/Category (Icons and Text) to add a text description below each icon. For control systems analysis, design, and simulation, expand Control Design & Simulation in the Functions palette by clicking the arrow to the left of this category. If you are performing a simulation, click the subpalette Simulation . If you are performing control system analysis or design, click the subpalette Control Design .A na r r o wi nt h e upper-right corner of a subpalette indicates additional underlying palettes or blocks. If the name of the icon is incomplete, resting the mouse over the icon will bring up its complete identi Ô¨Åcation. To obtain detailed help about an icon, right-click the icon and select Help . Move blocks to the block diagram window To move the icon to the Block Diagram , left-click the mouse to attach the icon (some icons take a little time to complete this operation). When the pointer turns into a hand, click the spot on the Block Diagram where you want to place the icon. Obtain information about the block You will now want to obtain information about how to interconnect the block to other blocks and pass parameters to the block as well as other characteristics about the block. Select the yellow question mark at the right of the Block Diagram toolbar to turn on the Context Help window. This window will provide help about a particular icon if you rest your mouse over that icon. Additional help isavailable under the Help menu on the Block Diagram menu bar. Finally, right-click the icon to bring up a menu with additional choices, such as Properties , if any. In particular, you will use this menu to create the block ‚Äôs front panel ‚Äôs controls and indicators. This front panel will be your interface with the block to choose parameters and see responses. Interconnect and label blocks Once blocks are placed on the Block Diagram they can be moved about by clicking on them or dragging your mouse across several of themto establish a selection pattern. After the selection pattern has been established, depressthemouse left button and drag to a new location. To delete a block, select the block and press the Backspace button on your keyboard. The context help for the block includes a description of the block ‚Äôs terminals. Let your mouse rest on a terminal until the mouse pointer turns into a spool of wire. Click the terminal and then move the mouse to the next icon ‚Äôs terminal where you want to make the connection. Click the destination terminal to complete the wiring. Notice that the terminal in the Context Help window blinks when your mouse resides above that terminal on the block, ensuring that you are on the correct terminal. If you make anerror in wiring, click on the wire and press the Backspace button on your keyboard or right-click the wire and select Delete Wire Branch . Block labels can be displayed or hidden. Right-click on the block to bring up the pop-up menu and check or uncheck Visible Items/Label to display or hide, respectively, the label. Double-clicking on the label above some blocks will allow you to select andchange the text. One click of the mouse on the label will place a selection pattern aroundthe label and allow you to hold down the left key of the mouse and move the label to adifferent location.852 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 21:59:56 Create the interface to your block You will now want to create the interface to your block in order to control or select functions, specify parameters, or view responses. This interface will be accessed via the Front Panel window. Right-click a terminal on a block for which you want to create an interface. On the pop-up menu, choose Create/Control to be able to interact with the block or Create/Indicator to view a response or setting. Set the controls Switch to the Front Panel window and set your controls. For example, enter parameter values, select functions, etc. If you want to change values and at somefuture time return to the current values, click on Edit on the Block Diagram menu bar and select Make Current Values Default . To return to the default values in the future, click on Edit on the Block Diagram menu bar and select Reinitialize Values to Default . Run the program Click on the arrow at the left of the toolbar on either the Block Diagram orFront Panel window to run the program. The program can be run continuously by clicking the curved arrows button on the toolbar second from the left.Continuously running your program permits changing functions and parameter valuesduring execution. In order to identify the buttons, let your mouse rest on a button to bring up a context menu. Stop your simulation by pressing the red-dot button, third from the left. If you areperforming control systems analysis and design, another way to continuously run theprogram is to place a While Loop around your block diagram. The loop is available in theFunctions palette at Express/Execution Control/While Loop. This loop also places a Stop button on the Front Panel . The program executes until you press the stop button. In lieu of the Stop button, any true/false Boolean can be wired to the condition block (red dot) created inside the While Loop . If you are performing simulation, you can use a Simulation Loop available in the Functions palette at Control Design and Simulation/Simulation/Control & Simulation Loop . Place the Control & Simulation Loop around your simulation block diagram by dragging the mouse. Right-click on the Control & Simulation Loop outline and choose ConÔ¨Å gure Simulation Parameters . . . to determine the parameters for executing the simulation. The Front Panel indicators and controls are also con Ô¨Ågurable. Right-click on the indicator or control and select Properties . D.4 Analysis and Design Examples In this section, we will present some examples showing the use of LabVIEW for the analysisand design of control systems. In the next section, examples of the use of LabVIEW forsimulation will be presented. Analysis and design examples use icons selected from the Control Design subpalette under the Control Design and Simulation palette. In the next section showing examples of simulation, we will use icons taken from the Simulation subpalette under the Control Design and Simulation palette. Example D.1 Open-Loop Step ResponseOpen-Loop Step Response Analysis and design usually begins by selecting icons from the Control Design subpalette and dragging them to the Block Diagram window. The icons represent blocks of code and the cascading of code blocks can be thought of as a sequence of lines of code. Thus, an advantage of LabVIEW over MATLAB is that the programmerdoes not need to memorize coding language. For example, consider the MATLAB codeshown in TryIt D.1 that produces the step response of G(s)=100/( s 2+2s+100).TryIt D.1 numg=100; deng=[1 2 100] ; 'G(s) ' G=tf(numg,deng) step(G) ; title( 'Angular Velocity ' )D.4 Analysis and Design Examples 853WEBBAPPD 10/28/2014 21:59:56 This step response can be produced in LabVIEW without knowing any coding language. We now demonstrate by following each step of Section D.3: Start LabVIEW Start LabVIEW and select New VI from the Filemenu shown in Figure D.2. Select blocks From the Functions palette, select the blocks shown in Figure D.3( a) and ( b). Move/blocks to the Block Diagram window Drag your icons one at a time to the Block Diagram window, Figure D.4. Obtain information about the block Right-click each of the blocks and be sure the Ô¨Årst two items under Visible Items are checked. Look at the CD Construct Transfer Function Model.vi. APolymorphic VI Selector is shown at the bottom of the icon. FIGURE D.3 Selecting a. CD Construct ...a n d CD Draw ...; b. CD Step Response ...854 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 21:59:56 Click the selector to bring up the menu. Select SISO . This block effectively creates the transfer function shown in the Ô¨Årst four steps of the MATLAB code in TryIt D.1. Repeat for the CD Draw Transfer Function Equation.vi and select TFfrom thePolymorphic VI Selector. This block will write the transfer function symbolically in the display. Your selection from the polymorphic vi selector should match the format of the transfer function created by the CD Construct Transfer Function Model.vi . Repeat for the CD Step Response.vi. and select TFfrom the Polymorphic VI Selector . This block will collect the data for the step response and permit plotting the data. This block effectively creates the last two commands of the MATLAB codeshown in TryIt D.1. Interconnect and label blocks You should now have the Block Diagram window shown in Figure D.4. Interconnect the cod e blocks. Click on the question mark on the right side of the toolbar to bring up the context menu. As your mouse passes above an icon, its context menu appears, showing the terminals. See Figure D.5. Interconnect the terminals by letting the mouse rest on a terminal until it becomes aspool of wire. FIGURE D.4 Block Diagram window FIGURE D.5 Context Help forCD Construct Transfer Function Model.viD.4 Analysis and Design Examples 855WEBBAPPD 10/28/2014 21:59:57 Click on the terminal and then click on the destination terminal. The two terminals will appear as wired together. Continue wiring terminals until you have the Block Diagram window shown in Figure D.6. Mid-wire connections as shown can be made by letting your mouse rest at the connection point until it becomes a spool of wire. Create the interface to your block You will now want to create the interface to specify parameters and view responses. This step will create the interface that will be accessed on the Front Panel window. The interfaces we will create are: CD Construct Transfer Function Model.vi input parameter controls. Right-click on the numerator terminal shown in Figure D.5 and select Create/Control . Repeat for the denominator. CD Step Response.vi response plot indicator. Right-click on the Step Response Graph terminal and select Create/Indicator . CD Draw Transfer Function Equation.vi symbolic transfer function indicator. Right-click on the Equation terminal and select Create/Indicator . Your Block Diagram should now look similar to Figure D.7( a). As an option, you can create transfer functions using a MathScript block if the MathScript RT Module is installed. This option is generally compatible withMATLAB ‚ÄôsM - Ô¨Åle code statements for creating your transfer function. Interfaces are then created to pass parameters to and from the M- Ô¨Åle code. You should be familiar with MATLAB to use this option. The MathScript block is found in the Programming/ FIGURE D.7 Block Diagram window: a.with Control Design blocks and interfaces; (Ô¨Ågure continues ) FIGURE D.6 Interconnected blocks856 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 21:59:57 Structures/MathScript palette. You create M- Ô¨Åle code inside the MathScript block. Inputs, outputs, and controls are created as follows. Right-click on the left side of the MathScript Node and select Add Input . Name the input K. Right-click your terminal Kand select Create/Control . A control is formed on both the Block Diagram and Front Panel . Repeat the same process to create inputs and controls for parameters aand b. Now create the output to the MathScript Node . Right-click the right-hand side of the MathScript Node and select Add Output/G . After wiring your inputs and outputs, your Block Diagram will be that shown in Figure D.7( b). On the Block Diagram window menu bar, select Window/Show Front Panel . You will see the Front Panel shown in Figure D.8 created by your interfaces. You can double-click the labels above your interfaces either in the Front Panel window or the Block Diagram window to change the label to be more descriptive of your project. Set the controls Using the Front Panel window, enter polynomial coef Ô¨Åcients for the numerator and denominator in ascending order ‚Äîlowest to highest. The selector to the left of the numerator and denominator shows the power of sfor the left-most coefÔ¨Åcient. Increasing the counter allows entry of higher-order coef Ô¨Åcients not visible originally. To make all coef Ô¨Åcients of a polynomial visible, let the mouse move on the right-hand edge of the polynomial indicator until the pointer becomes a double arrow FIGURE D.7 (Continued )b.withMathScript block FIGURE D.8 Front Panel: a. forBlock Diagram shown in Figure D.7( a); (Ô¨Ågure continues )D.4 Analysis and Design Examples 857WEBBAPPD 10/28/2014 21:59:57 and blue dots appear at the left and right edges of the entire polynomial indicator. You can then drag the right blue dot to expose more cells. Familiarize yourself with the choices on the menu bar as well as those on the pop-up menus created when you right-click on any indicator or control. For example,under the Edit menu, among other choices, you can Make Current Values Default or Reinitialize Values to Default. Right-clicking the indicators or controls brings up a menu from which, among other choices, Properties can be selected to con Ô¨Ågure the indicator or control as desired. Run the program Figure D.9 shows Example D.1 after execution. The Ô¨Ågure shows the values entered, the equation, and the step response. Execution was initiated by clicking the arrow at the left of the toolbar. The program can run continuously by clicking the curved arrows on the toolbar. Now, change values; hit the Enter key and see the results immediately displayed. Stop the program execution by clicking on the red hexagon on the toolbar. Another way of FIGURE D.8 (Continued )b.forBlock Diagram shown in Figure D.7(b) FIGURE D.9 Front Panel after execution: a.for block diagram in Figure D.7(a); (Ô¨Ågure continues )858 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 21:59:58 continuously running the program is to place a While Loop around the block diagram as shown in Figure D.10( a). The loop is accessed from Functions/Express/Execution Control as shown in Figure D.10( b). After selecting the While Loop , drag the cursor across the block diagram to create the continuous loop. A stop button will appear on the block diagram as well as on the Front Panel . At the lower right is a Conditional Terminal icon, which can be used to control the While Loop. The reader should consult the on-line documentation for further information. FIGURE D.10 a.Block diagram with While Loop ;b. Functions palette showing While Loop location FIGURE D.9 (Continued )b.for block diagram in Figure D.7( b)D.4 Analysis and Design Examples 859WEBBAPPD 10/28/2014 21:59:58 Example D.2 Closed-Loop Step ResponseClosed-Loop Step Response In this example, we show how to display the step response of a unity-feedback system. For variety, we represent the open-loop system as a ratio of zeros over poleswith a multiplying gain, analogous to MATLAB ‚Äôszpk function. In the previous example, we represented the system as a ratio of polynomials, analogous to MATLAB ‚Äôs tffunction. Select blocks The zero-pole-gain transfer function is obtained from the Functions palette as shown in Figure D.11( a). We place this transfer function in the forward path FIGURE D.11 a.Obtaining zero-pole-gain transfer function from the Functions palette; b.Obtaining Feedback interconnection from Functions palette860 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 21:59:59 of a unity-feedback system by following its block with a Feedback block obtained from the Functions palette as shown in Figure D.11( b). If the Model 2 input to the Feedback block is left unconnected, then a unity-feedback interconnection is assumed. Other options for interconnection, such as parallel and series, are shown on the palette of Figure D.11( b). Interconnect and label blocks Producing the closed-loop step response is similar to Example D.1, except the step-response blocks are placed at the output of the Feedback block. The equation writer is wired to the system output as in Example D.1. All datatypes must be compatible and are shown selected with the pull-down menu at the base of the blocks. If you select Automatic in the pull-down menu, LabVIEW will select the correct form for you as you connect the blocks. TheÔ¨Ånal Block Diagram andFront Panel for this example are shown in Figure D.12 ( a) and ( b), respectively. Notice that you enter open-loop poles, zeros, and gain on the Front Panel in place of polynomial open-loop numerator and denominator coefÔ¨Åcients. FIGURE D.12 a. Block Diagram for Example D.2; b. Front Panel for Example D.2D.4 Analysis and Design Examples 861WEBBAPPD 10/28/2014 21:59:59 Example D.3 Root Locus Analysis and DesignRoot Locus Analysis and Design We can obtain root locus plots by adding the Root Locus block obtained from the Functions palette as shown in Figure D.13. The Root Locus block is connected to the output of the open-loop system and a Root Locus Graph indicator is formed at the output of the Root Locus block. The resultant Block Diagram andFront Panel are shown in Figure D.14( a) and ( b) respectively. Figure D.13 shows other characteristic blocks that can be added. For example, closed- loop poles and zeros, as well as damping ratio and natural frequency, can be displayed. FIGURE D.13 Functions palette showing location of Root Locus block FIGURE D.14 Windows showing root locus analysis: a. Block Diagram ; b. Front Panel Example D.4 Open- and Closed-Loop Sinusoidal Frequency Analysis andDesignOpen- and Closed-Loop Sinusoidal Frequency Analysisand Design We can obtain open- and closed-loop sinusoidal frequency response curves by replacing theRoot Locus block with the Bode block to yield the open-loop frequency response. A copy of the Bode block can be added at the output of the Feedback block to obtain the closed-loop frequency response. Figure D.15 shows where to obtain the Bode block.862 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 21:59:59 Figure D.16 shows the Block Diagram andFront Panel with open- and closed- loop Bode analysis. In order to display the plots, the indicators shown at the outputs of theBode blocks were created. FIGURE D.15 Functions window showing frequency response blocks, such as Bode ,Nyquist , Nichols , and Gain and Phase Margin blocks FIGURE D.16 Bode analysis via LabVIEW: a. Block Diagram ;(Ô¨Ågure continues )D.4 Analysis and Design Examples 863WEBBAPPD 10/28/2014 22:0:0 Figure D.15 shows other alternatives for frequency response analysis. For example, in addition to the Bode plots, yo u can create an indicator telling you the gain and phase margins by using the Gain and Phase Margin block. Figure D.17 shows that result. FIGURE D.16 (Continued )b. Front Panel FIGURE D.17 Bode analysis with gain and phase margin: a. Block Diagram ;(Ô¨Ågure continues )864 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:0 D.5 Simulation Examples Whereas the LabVIEW block sequence for design and analysis is analogous to following the code statement sequence in a MATLAB M- Ô¨Åle, the LabVIEW block sequence for simulation is analogous to following the block sequence of a Simulinkdiagram. In this section, we show examples of simulation using LabVIEW. For control system simulation, icons for the block diagram are taken from the Simulation subpalette under the Control Design and Simulation palette. Our examples will parallel the e x a m p l e ss h o w ni nA p p e n d i xCw h i c hu s e sS i m u l i n k .Finally, if you need to use Nyquist or Nichols charts, the associated blocks are shown in Figure D.15 and can replace the Bode blocks. FIGURE D.17 (Continued )b. Front PanelD.5 Simulation Examples 865WEBBAPPD 10/28/2014 22:0:1 Example D.5 Simulation of Linear SystemsSimulation of Linear Systems Create Block Diagram and Front Panel Figure D.18 shows the Block Diagram and Front Panel for simulating a linear system. The simulation reproduces Example C.1 in Appendix C, which uses Simulink. Blocks are selected from the Simulation subpalette under the Control Design and Simulation palette and must be placed within theSimulation Loop obtained from Functions/Control Design and Simulation/ Simulation/Control & Simulation Loop. We now enumerate the detailed steps required to create the Block Diagram andFront Panel: FIGURE D.18 Simulation of linear systems: a. Block Diagram ;b. Front Panel866 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:9 1.Transfer functions are obtained from Functions/Control Design and Simulation/ Simulation/Continuous Linear Systems/Transfer Function . Right-click on each transfer function and select ConÔ¨Åguration to enter the parameter values shown in Figure D.18( a) or equivalently in Figure C.5. 2.The gain block is obtained from Functions/Control Design and Simulation/ Simulation/Signal Arithmetic/Gain. Right-click on the gain block and select ConÔ¨Å guration to enter the parameter value. 3.The step-input block is obtained from Functions/Control Design and Simulation/ Simulation/Signal Generation/Step Signal . Right-click on the gain block and select ConÔ¨Å guration to enter the parameter value. 4.In order to display the three step-response curves simultaneously, we use a Build Array block obtained from Functions/Programming/Array/Build Array. Drag the bottom of the icon to expose the correct number of inputs (three for this case). 5.To create the display, we use the Simulation Time Waveform block obtained from Functions/Control Design and Simulati on/Simulation/Graph Utilities/Simtime Waveform . Right-click the output of the Simtime Waveform block and select Create/ Indicator to produce the Waveform Chart icon and the Front Panel display. ConÔ¨Å gure simulation loop Finally, set the simulation parameters by right-clicking theSimulation Loop and selecting ConÔ¨Ågure Simulation Parameters . . . . Set the parameters as shown in Figure D.19. FIGURE D.19 ConÔ¨Åguring the Simulation Loop parameters: a.Simulation parameters; b.Timing parametersD.5 Simulation Examples 867WEBBAPPD 10/28/2014 22:0:12 ConÔ¨Ågure graph parameters On the Front Panel , right-click the graph and select Properties to con Ô¨Ågure graph parameters if required. Select the legend and expand it vertically to expose all three plot identities. The titles in the legend can be changed to reÔ¨Çect meaningful labels for the plots. Run the simulation Perform the simulation by clicking the arrow at the extreme left of the toolbar on the Front Panel window. You can erase curves between trials by right-clicking the display and selecting Data Operations/Clear Chart . Example D.6 Effect of Ampli Ô¨ÅerSaturation on Motor ‚Äôs Load Angular VelocityEffect of Ampli Ô¨Åer Saturation on Motor ‚Äôs Load Angular Velocity Create Block Diagram and Front Panel TheBlock Diagram andFront Panel for simulating a dc motor with and without saturation are shown in Figure D.20. TheSaturation block is obtained from Control Design & Simulation/Simulation/ Nonlinear Systems/Saturation. ConÔ¨Ågure simulation loop ConÔ¨Ågure the simulation loop as shown in Ô¨Ågure D.19, except change the Final Time (s) in Figure D.19( a) to 10. ConÔ¨Ågure graph parameters On the Front Panel , right-click the graph and select Properties to con Ô¨Ågure graph parameters. Select the Scales tab and enter 10 in the Maximum box as shown in Figure D.21. Select the legend and expand it vertically to expose both plot identities. The titles in the legend can be changed to re Ô¨Çect meaningful labels for the plots. Run the simulation Perform the simulation by clicking the arrow at the extreme left of the toolbar on the Front Panel window. You can erase curves between trials by right-clicking the display and selecting Data Operations/Clear Chart . FIGURE D.20 Simulation of a dc motor with and without saturation: a. Block Diagram ;(Ô¨Ågure continues )868 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:13 FIGURE D.20 (Continued )b. Front Panel FIGURE D.21 Chart Properties: Waveform Chart WindowD.5 Simulation Examples 869WEBBAPPD 10/28/2014 22:0:13 Example D.7 Simulating Feedback SystemsSimulating Feedback Systems Create Block Diagram and Front Panel TheBlock Diagram andFront Panel for simulating feedback systems is shown in Figure D.22. The Summation block is obtained from Control Design & Simulation/Simulation/Signal Arithmetic/Summation . ConÔ¨Ågure Summation and other blocks Right-click the Summation block and select ConÔ¨Åguration . . . Repeat for other blocks. FIGURE D.22 Simulation of feedback systems: a. Block Diagram ;b. Front Panel870 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:14 Example D.8 Simulating Digital Systems with the Simulation PaletteSimulating Digital Systems with the Simulation Palette Digital systems, such as Example C.4 in Appendix C, can be simulated using LabVIEW. However, there are restrictions on the transfe r functions used in the simulation. LabVIEW requires that all inputs to the transfer functions be present at the beginning of the simula-tion or else a cycle error will result. Unfortunately, this requirement limits the use oftransfer functions to those with a denominator of higher order than the numerator. Under these conditions, the reader is a dvised to use either MATLAB or the Control Design palette rather than the Simulation palette of the Control Design & Simulation function. Our Ô¨Årst digital example will simulate a digital feedback system using the Simulation palette with proper transfer functions. The next example will simulate Example C.4 in Appendix C, which does not have proper transfer functions, using LabVIEW ‚ÄôsControl Design palette. Create Block Diagram and Front Panel TheBlock Diagram andFront Panel for simulating digital systems is shown in Figure D.23. The Discrete Zero-Order Hold block is obtained from Control Design & Simulation/Simulation/Discrete Linear Systems/ FIGURE D.23 Simulation of digital systems with Simulation palette: a. Block Diagram ;(Ô¨Ågure continues )ConÔ¨Å gure simulation loop ConÔ¨Ågure the simulation loop as shown in Figure D.19, except change the Final Time (s) in Figure D.19( a)t o1 0 . ConÔ¨Å gure graph parameters On the Front Panel , right-click the graph and select Properties to con Ô¨Ågure graph parameters. Select the Scales tab and enter 10 in the Maximum box as shown in Figure D.21. Run the simulation Perform the simulation by clicking the arrow at the extreme left of the toolbar on the Front Panel window. You can erase curves between trials by right-clicking the display and selecting Data Operations/Clear Chart .D.5 Simulation Examples 871WEBBAPPD 10/28/2014 22:0:14 Discrete Zero-Order Hold. The Discrete Transfer Function is obtained from Control Design & Simulation/Simulation/Discrete Linear Systems/Discrete Transfer Function . ConÔ¨Ågure Discrete Zero-Order Hold and other blocks Right click the Discrete Zero-Order Hold block and select ConÔ¨Åguration . . . Set the sample period to 0.5 second. ConÔ¨Ågure the transfer functions as shown on the Block Diagram .C o n Ô¨Ågure the Step Signal to be a unit step. ConÔ¨Ågure simulation loop ConÔ¨Ågure the simulation loop as shown in Figure D.19. ConÔ¨Ågure graph parameters On the Front Panel , right-click the graph and select Properties to con Ô¨Ågure graph parameters. Select the Scales tab and enter 3 in the Maximum box for the xaxis and 1 for the yaxis. Select the legend and expand it vertically to expose both plot identities. The titles in the legend can be changed to re Ô¨Çect meaningful labels for the plots. Run the simulation Perform the simulation by clicking the arrow at the extreme left of the toolbar on the Front Panel window. You can erase curves between trials by right-clicking the display and selecting Data Operations/Clear Chart . The simulation shows the difference in responses obtained by (1) modeling the digital system as a zero-o rder hold cascaded with a linear system (Plot 0), or (2) modeling the system with a dig ital transfer function (Plot 1). Example D.9 Simulating Digital Systems with the Control Design PaletteSimulating Digital Systems with the Control Design Palette In order to avoid cycle errors in LabVIEW, we use the Control Design palette when we have transfer functions for which the numerator and denominator are of the same order. This example reproduces Simulink Example C.4. FIGURE D.23 (Continued )b. Front Panel872 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:14 Create Block Diagram and Front Panel TheBlock Diagram andFront Panel for this example are shown in Figure D.24. Wire the blocks as shown. Most of the blocks were previously discussed in Examples D.1 and D.2. Digital transfer functions are created using the same blocks as continuous systems, but with a nonzero Sampling Time(s) input. The CD Convert Continuous to Discrete.vi , is obtained from Functions/ Control Design & Simulation/Control Design/Model Conversion/CD ConvertContinuous to Discrete.vi . FIGURE D.24 Simulation of digital systems with the Control Design palette: a. Block Diagram ; b. Front PanelD.5 Simulation Examples 873WEBBAPPD 10/28/2014 22:0:18 TheBuild Array is obtained from Functions/Programming/Array/Build Array . Expand the Build Array block to show two inputs. ConÔ¨Ågure parameters for Build Array Right-click on Build Array and select Concatenate Inputs . Right-click again on Build Array and select Create/Indicator . Select and then right-click the indicator on the front panel and choose Replace .1 Using the resulting palettes as shown in Figure D.25, select the XY Graph .2 On the front panel expand the legend to show two graphs. Title the legend components as shown. Change the x- and y-axes‚Äôstarting and ending points as desired by right-clicking the graph and selecting Properties . In the Properties window, select Scales and enter the desired information. Finally, select Plots and enter your choices. Right-click the graph on the front panel and select Data Operations and make your current values the default. Also, right-click again and choose to reinitialize to your default values. You may also choose to clear the current plot. ConÔ¨Ågure parameters for CD Convert Continuous to Discrete.vi Right-click and create a control for Sample Time(s), Numerator , and Denominator as described in Example D.1. Set the values as shown on the Front Panel . ConÔ¨Ågure parameters for CD Construct Transfer Function Model.vi as a discrete model Right-click and create a control for Sample Time(s) ,Numerator , and Denominator as described in Example D.1. Set the values as shown on the Front Panel . ConÔ¨Ågure parameters for all CD Draw Transfer Function Equation.vi Right-click and create a control for Equation as described in Example D.1. Set the values as shown on the Front Panel . Run simulation See Example D.1 for a description. The results are shown in Figure D.24( b). FIGURE D.25 Choosing XYGraph 1Be sure to select the entire indicator. Then place your mouse on the outer edge and be sure it is a pointer before selecting Replace . 2Right click the XY Graph on the front panel and open Properties . On the Appearance tab, select 2 for Plots shown .874 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:18 D.6 Interfacing with External Hardware This section provides an introduction to the use of LabVIEW virtual instruments to control external hardware with the NI myDAQ for students. Speci Ô¨Åcally, we concentrate on using theNI myDAQ to analyze and design an actual feedback system used in the Hardware Exploration Laboratory sections at the end of select chapters. Required Hardware NI myDAQ is a data acquisition module that is ideal for student experimentation, since it is port able and of low cost. In order to perform the experiments in this book, you will need a motor control chip and a gearmotor. Although other alternatives exist, we use the following: (1) ROHM motor controlchip, BA6886N; and (2) 9.7:1 metal gearmotor 25Dx48L mm HP with 48 CPRencoder, which can be obtained from www.pololu.com . Required Software The software required to support the experiments in this book are: (1) LabVIEW or the Student Version of LabVIEW and (2) NI ELVISmx Soft Front Panel (SFP) Instruments, which comes bundled with the NI myDAQ. NI ELVISmx provides virtual instruments that will generate input signals to and acquire output signals from your external control system. Basic Con Ô¨Åguration Figure D.26 shows the NI myDAQ and the basic con Ô¨Åguration that will be used to perform control system design and analysis. Detailed wiring diagramswill accompany speci Ô¨Åc experiments. Launching NI myDAQ TheNI myDAQ kit comes with the following cables and connectors: (1) USB cable; (2) 20-position screw terminal connector; (3) audio cable;and (4) DMM banana cable. The following steps will launch the NI myDAQ and NI ELVISmx , which provides convenient virtual instruments for control and data acquisition. FIGURE D.26 a. NI myDAQ;( Ô¨Ågure continues )D.6 Interfacing with External Hardware 875WEBBAPPD 10/28/2014 22:0:20 Step 1: Be sure LabVIEW is installed on your computer. Step 2: Install the NI myDAQ software. Step 3: Connect the NI myDAQ to your computer via the USB cable. Step 4: After NI myDAQ is recognized, NI ELVISmx should launch automatically. IfNI ELVISmx does not launch, then manually launch from the Start menu All Programs/National Instruments/NI ELVISmx for NI ELVIS & NI myDAQ/ NI ELVISmx Instrument Launcher . Figure D.27 shows the window containing the virtual instruments available from NI ELVISmx . Clicking on any instrument will bring up that VI. Simple Experiments Using the NI myDAQ Measuring battery voltage using the NI myDAQ Digital Multimeter (DMM) With myDAQ connected to your computer, launch the DMM shown in Figure D.27. Attach the DMM probes between the myDAQ and a battery as shown in Figure D.28( a). Press the green Run arrow.ROHM Motor Control Chip B6886N9.7:1 Metal Gearmotor 25Dx48L mm HP with 48 CPR Encoder (b) FIGURE D.26 (Continued )b.basic con Ô¨Åguration showing NI myDAQ interfaced with motor control chip and gearmotor; c.interconnected hardware876 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:20 FIGURE D.27 The NI ELVISmx Instrument Launcher window FIGURE D.28 Battery voltage measurement: a.Connections to myDAQ; (Ô¨Ågure continues )D.6 Interfacing with External Hardware 877WEBBAPPD 10/28/2014 22:0:20 The NI myDAQ audio equalizer With myDAQ connected to your computer, launch theAudio Equalizer in the Featured Instruments menu shown in Figure D.27. Attach an audio cable from your music source to AUDIO IN on your myDAQ. Similarly, attach speakers or an earphone to the AUDIO OUT . Press the blue Start arrow. You can now adjust volume, bass, midtone, and treble as well as watch the audio waveform in time or frequency. The Audio Equalizer is shown in Figure D.29.FIGURE D.28 (Continued )b. DMM reading FIGURE D.29 The NI myDAQ Audio Equalizer878 Appendix D: LabVIEW TutorialWEBBAPPD 10/28/2014 22:0:21 Summary This appendix presented LabVIEW as an alternative to MATLAB for analysis, design, and simulation. Our discussion was divided into analysis and design, and simulation. Analysis and design is performed by interconnecting code blocks, which is analogous to writing in-line code for MATLAB M- Ô¨Åles. Since the LabVIEW code blocks are represented by icons, an advantage of using LabVIEW is that you do not have to knowspeciÔ¨Åc code statements. Simulation is performed by interconnecting code blocks and is analogous to Simulink Ô¨Çow diagrams. LabVIEW has more extensive applications. You can create virtual instruments on your computer monitor that can operate external hardware and transmit and receivetelemetric data. We covered a few of these applications in this appendix using the NImyDAQ. It is left to the interested reader to pursue more of these applications. Bibliography National Instruments. Getting Started with LabVIEW . National Instruments, Austin, TX. 2003 ‚Äì2013. National Instruments. LabVIEW Fundamentals . National Instruments, Austin, TX. 2005. National Instruments. LabVIEWTMControl Design User Manual. National Instruments, Austin, TX. 2004‚Äì2009. National Instruments. Introduction to LabVIEW in 3 Hours for Control Design and Simulation . National Instruments Course Notes, Austin, TX. 2009. National Instruments. NI myDAQ User Guide and Speci Ô¨Åcations . National Instruments, Austin, TX. 2010‚Äì2011. *All LabVIEW screenshots and equipment in this book are reprinted with permission of National Instruments.Bibliography 879WEBBAPPD 10/28/2014 22:0:21 Page 880WEBBGLOSS 10/29/2014 0:12:44 Glossary Acceleration constant lim s¬Æ0s2G s¬Ü Actuating signal The signal that drives the controller. If this signal is the difference between the input and output, it is called the error . Analog-to-digital converter A device that converts analog signals to digital signals. Armature The rotating member of a dc motor through which a current Ô¨Çows. Back emf The voltage across the armature of a motor. Bandwidth The frequency at which the magnitude frequency response is  3 dB below the magnitude at zero frequency. Basis Linearly independent vectors that de Ô¨Åne a space. Bilinear transformation A mapping of the complex plane where one point, s, is mapped into another point, z, through z¬à as¬áb¬Ü/ cs¬ád¬Ü. Block diagram A representation of the interconnection of subsystems that form a system. In a linear system, the block diagram consists of blocks representing subsystems, arrows representing signals, summing junctions, and pickoff points. Bode diagram (plot) A sinusoidal frequency response plot where the magnitude response is plotted separately from the phase resp onse. The magnitude plot is dB versus log œâ,a n d the phase plot is phase versus log œâ. In control systems, the Bode plot is usually made for the open-loop transfer function. Bode plots can also be drawn as straight-line approximations. Branches Lines that represent subsystems in a signal-Ô¨Çow graph. Break frequency A frequency where the Bode magnitude plot changes slope. Breakaway point A point on the real axis of the s-plane where the root locus leaves the real axis and enters the complex plane.Break-in point A point on the real axis of the s-plane where the root locus enters the real axis from the complex plane.Characteristic equation The equation formed by setting the characteristic polynomial to zero. Characteristic polynomial The denominator of a transfer function. Equivalently, the unforced differential equation, where the differential operators are replaced by sorŒª. 881WEBBGLOSS 10/29/2014 0:12:44 Classical approach to control systems Seefrequency domain techniques . Closed-loop system A system that monitors its output and corrects for disturbances. It is characterized by feedback paths from the output. Closed-loop transfer function For a generic feedback system with G s¬Üin the forward path and H s¬Üin the feedback path, the closed-loop transfer function, T s¬Ü,i s G s¬Ü/¬â1G s¬ÜH s¬Ü¬ä, where the +is for negative feedback, and the ‚Äìis for positive feedback. Compensation The addition of a transfer function in the forward path or feedback path for the purpose of improving the transient or steady-state performance of a control system. Compensator A subsystem inserted into the forward or feedback path for the purpose of improving the transient response or steady-state error.Constant Mcircles The locus of constant, closed-loop magnitude frequency response for unity feedback systems. It allows the closed-loop magnitude frequency response to be determined from the open-loop magnitude frequency response. Constant Ncircles The locus of constant, closed-loop phase frequency response for unity feedback systems. It allows the closed-loop phase frequency response to be determined from the open-loop phase frequency response. Controllability A property of a system by which an input can be found that takes every state variable from a desired initial state to a desired Ô¨Ånal state in Ô¨Ånite time. Controlled variable The output of a plant or process that the system is controlling for the purpose of desired transient response, stability, and steady-state error characteristics.Controller The subsystem that generates the input to the plant or process. Critically damped response The step response of a second-order system with a given natural frequency that is characterized by no overshoot and a rise time that is faster than any possible overdamped response with the same natural frequency. Damped frequency of oscillation The sinusoidal frequency of oscillation of an underdamped response.Damping ratio The ratio of the exponential decay frequency to the natural frequency. Decade Frequencies that are separated by a factor of 10. Decibel (dB) The decibel is de Ô¨Åned as 10 log P G, where PGis the power gain of a signal. Equivalently, the decibel is also 20 log VG, where VGis the voltage gain of a signal. Decoupled system A state-space representation in which each state equation is a function of only one state variable. Hence, each differential equation can be solved independently of the other equations. Digital compensator A sampled transfer function use dt oi m p r o v et h er e s p o n s eo f computer-controlled feedback systems. T he transfer function can be emulated by a digital computer in the loop.Digital-to-analog converter A device that converts digital signals to analog signals. Disturbance An unwanted signal that corrupts the input or output of a plant or process. Dominant poles The poles that predominantly generate the transient response. Eigenvalues Any value, Œª i, that satis Ô¨ÅesAXi¬àŒªixiforxi6¬à0. Hence, any value, Œªi, that makes xian eigenvector under the transformation A.882 GlossaryWEBBGLOSS 10/29/2014 0:12:44 Eigenvector Any vector that is collinear with a new basis vector after a similarity transformation to a diagonal system. Electric circuit analog An electrical network whose variables and parameters are analogous to another physical system. The electric circuit analog can be used to solve for variables of the other physical system. Electrical admittance The inverse of electrical impedance. The ratio of the Laplace transform of the current to the Laplace transform of the voltage. Electrical impedance The ratio of the Laplace transform of the voltage to the Laplace transform of the current.Equilibrium The steady-state solution characterized by a constant position or oscillation. Error The difference between the input and the output of a system. Euler ‚Äôs approximation A method of integration where the area to be integrated is approximated as a sequence of rectangles.Feedback A path through which a signal Ô¨Çows back to a previous signal in the forward path in order to be added or subtracted.Feedback compensator A subsystem placed in a feedback path for the purpose of improving the performance of a closed-loop system.Forced response For linear systems, that part of the total response function due to the input. It is typically of the same form as the input and its derivatives. Forward-path gain The product of gains found by traversing a path that follows the direction of signal Ô¨Çow from the input node to the output node of a signal- Ô¨Çow graph. Frequency domain techniques A method of analyzing and designing linear control systems by using transfer functions and the Laplace transform as well as frequency response techniques. Frequency response techniques A method of analyzing and designing control systems by using the sinusoidal frequency response characteristics of a system. Gain The ratio of output to input; usually used to describe the ampli Ô¨Åcation in the steady state of the magnitude of sinusoidal inputs, including dc.Gain margin The amount of additional open-loop gain, expressed in decibels (dB), required at 180 ¬∞of phase shift to make the closed-loop system unstable. Gain-margin frequency The frequency at which the phase frequency response plot equals 180 ¬∞. It is the frequency at which the gain margin is measured. Homogeneous solution Seenatural response. Ideal derivative compensator Seeproportional-plus-derivative controller . Ideal integral compensator Seeproportional-plus-integral controller . Instability The characteristic of a system de Ô¨Åned by a natural response that grows without bounds as time approaches in Ô¨Ånity. Kirchhoff ‚Äôs law The sum of voltages around a closed loop equals zero. Also, the sum of currents at a node equals zero.Lag compensator A transfer function, characterized by a pole on the negative real axis close to the origin and a zero close and to the left of the pole, that is used for the purpose of improving the steady-state error of a closed-loop system.Glossary 883WEBBGLOSS 10/29/2014 0:12:45 Lag-lead compensator A transfer function, characterized by a pole-zero con Ô¨Åguration that is the combination of a lag and a lead compensator, that is used for the purpose of improving both the transient response and the steady-state error of a closed-loop system. Laplace transformation A transformation that transforms linear differential equations into algebraic expressions. The transformation is especially useful for modeling, analyzing, and designing control systems as well as solving linear differential equations. Lead compensator A transfer function, characterized by a zero on the negative real axis and a pole to the left of the zero, that is used for the purpose of improving the transient response of a closed-loop system. Linear combination A linear combination of nvariables, xi, for i¬à1t o n, given by the following sum, S: S¬àKnXn¬áKn 1Xn 1¬á¬á K1X1 where each Kiis a constant. Linear independence The variables xi, fori¬à1t on, are said to be linearly independent if their linear combination, S, equals zero only if every Ki¬à0 and no x i¬à0. Alternatively, if thexi‚Äôs are linearly independent, then Knxn¬áKn 1xn 1¬á ‚àô‚àô‚àô¬áK1x1¬à0 cannot be solved for any xk. Thus, no xkcan be expressed as a linear combination of the other xi‚Äôs. Linear system A system possessing the properties of superposition and homogeneity. Linearization The process of approximating a nonlinear differential equation with a linear differential equation valid for small excursions about equilibrium. Loop gain For a signal-Ô¨Ç ow graph, the product of branch gains found by traversing a path that starts at a node and ends at the same node without passing through any other node more than once, and following the direction of the signal Ô¨Çow. Major-loop compensation A method of feedback compensation that adds a compensating zero to the open-loop transfer function for the purpose of improving the transient response ofthe closed-loop system. Marginal stability The characteristic of a system de Ô¨Åned by a natural response that neither decays nor grows, but remains constant or oscillates as time approaches in Ô¨Ånity as long as the input is not of the same form as the system‚Äô s natural response. Mason ‚Äôsr u l e A formula from which the transfer function of a system consisting of the interconnection of multiple subsystems can be found. Mechanical rotational impedance The ratio of the Laplace transform of the torque to the Laplace transform of the angular displacement. Mechanical translational impedance The ratio of the Laplace transform of the force to the Laplace transform of the linear displacement.Minor-loop compensation A method of feedback compensation that changes the poles of a forward-path transfer function for the purpose of improving the transient response of the closed-loop system. Modern approach to control systems Seestate-space representation. Natural frequency The frequency of oscillation of a system if all the damping is removed. Natural response That part of the total response function due to the system and the way the system acquires or dissipates energy.884 GlossaryWEBBGLOSS 10/29/2014 0:12:45 Negative feedback The case where a feedback signal is subtracted from a previous signal in the forward path. Newton ‚Äôs law The sum of forces equals zero. Alternatively, after bringing the maforce to the other side of the equality, the sum of forces equals the product of mass and acceleration. Nichols chart The locus of constant closed-loop magnitude and closed-loop phase frequency responses for unity feedback systems plotted on the open-loop dB versus phase-angle plane. It allows the closed-loop frequency response to be determined from the open-loop frequencyresponse. Nodes Points in a signal- Ô¨Çow diagram that represent signals. No-load speed The speed produced by a motor with constant input voltage when the torque at the armature is reduced to zero.Nonminimum-phase system A system whose transfer function has zeros in the right half-plane. The step response is characterized by an initial reversal in direction. Nontouching-loop gain The product of loop gains from nontouching loops taken two, three, four, and so on at a time.Nontouching loops Loops that do not have any nodes in common. Notch Ô¨Ålter AÔ¨Ålter whose magnitude frequency response dips at a particular sinusoidal frequency. On the s-plane, it is characterized by a pair of complex zeros near the imaginary axis. Nyquist criterion If a contour, A, that encircles the entire right half-plane is mapped through G s¬ÜH s¬Ü, then the number of closed-loop poles, Z, in the right half-plane equals the number of open-loop poles, P, that are in the right half-plane minus the number of counterclockwise revolutions, N, around  1, of the mapping; that is, Z¬àP N. The mapping is called the Nyquist diagram ofG s¬ÜH s¬Ü. Nyquist diagram (plot) A polar frequency response plot made for the open-loop transfer function.Nyquist sampling rate The minimum frequency at which an analog signal should be sampled for correct reconstruction. This frequency is twice the bandwidth of the analog signal.Observability A property of a system by which an initial state vector, x t 0¬Ü, can be found from u(t) and y(t) measured over a Ô¨Ånite interval of time from t0. Simply stated, observability is the property by which the state variables can be estimated from a knowledge of the input, u(t), and output, y(t). Observer A system con Ô¨Åguration from which inaccessible states can be estimated. Octave Frequencies that are separated by a factor of two. Ohm ‚Äôs law For dc circuits the ratio of voltage to current is a constant called resistance. Open-loop system A system that does not monitor its output nor correct for disturbances. Open-loop transfer function For a generic feedback system with G(s) in the forward path andH(s) in the feedback path, the open-loop transfer function is the product of the forward- path transfer function and the feedback transfer function, or G s¬ÜH s¬Ü. Operational ampli Ô¨ÅerAn ampli Ô¨Åer‚Äîcharacterized by a very high input impedance, a very low output impedance, and a high gain ‚Äîthat can be used to implement the transfer function of a compensator. Output equation For linear systems, the equation that expresses the output variables of a system as linear combinations of the state variables.Glossary 885WEBBGLOSS 10/29/2014 0:12:45 Overdamped response A step response of a second-order system that is characterized by no overshoot. Partial-fraction expansion A mathematical equation where a fraction with nfactors in its denominator is represented as the sum of simpler fractions. Particular solution Seeforced response. Passive network A physical network that only stores or dissipates energy. No energy is produced by the network.Peak time, T pThe time required for the underdamped step response to reach the Ô¨Årst, or maximum, peak. Percent overshoot, %OS The amount that the underdamped step response overshoots the steady-state, or Ô¨Ånal, value at the peak time, expressed as a percentage of the steady-state value. Phase margin The amount of additional open-loop phase shift required at unity gain to make the closed-loop system unstable. Phase-margin frequency The frequency at which the magnitude frequency response plot equals zero dB. It is the frequency at which the phase margin is measured.Phase variables State variables such that each subsequent state variable is the derivative of the previous state variable.Phasor A rotating vector that represents a sinusoid of the form Acos œât¬áœï¬Ü. Pickoff point A block diagram symbol that shows the distribution of one signal to multiple subsystems.Plant or process The subsystem whose output is being controlled by the system. Poles (1) The values of the Laplace transform variable, s, that cause the transfer function to become in Ô¨Ånite; and (2) any roots of factors of the characteristic equation in the denominator that are common to the numerator of the transfer function.Position constant lim s¬Æ0G s¬Ü Positive feedback The case where a feedback signal is added to a previous signal in the forward path. Proportional-plus-derivative (PD) controller A controller that feeds forward to the plant a proportion of the actuating signal plus its derivative for the purpose of improving the transient response of a closed-loop system. Proportional-plus-integral (PI) controller A controller that feeds forward to the plant a proportion of the actuating signal plus its integral for the purpose of improving the steady- state error of a closed-loop system. Proportional-plus-integral-plus-derivative (PID) controller A controller that feeds forward to the plant a proportion of the actuating signal plus its integral plus its derivative for the purpose of improving the transient response and steady-state error of a closed-loopsystem. Quantization error For linear systems, the error associated with the digitizing of signals as a result of the Ô¨Ånite difference between quantization levels. Raible ‚Äôs tabular method A tabular method for determining the stability of digital systems that parallels the Routh-Hurwitz method for analog signals.Rate gyro A device that responds to an angular position input with an output voltage proportional to angular velocity.886 GlossaryWEBBGLOSS 10/29/2014 0:12:45 Residue The constants in the numerators of the terms in a partial-fraction expansion. Rise time ,TrThe time required for the step response to go from 0.1 of the Ô¨Ånal value to 0.9 of the Ô¨Ånal value. Root locus The locus of closed-loop poles as a system parameter is varied. Typically, the parameter is gain. The locus is obtained from the open-loop poles and zeros. Routh-Hurwitz criterion A method for determining how many roots of a polynomial in s are in the right half of the s-plane, the left half of the s-plane, and on the imaginary axis. Except in some special cases, the Routh-Hurwitz criterion does not yield the coordinates of the roots. Sensitivity The fractional change in a system characteristic for a fractional change in a system parameter.Settling time ,T sThe amount of time required for the step response to reach and stay within 2%of the steady-state value. Strictly speaking, this is the de Ô¨Ånition of the 2% settling time. Other percentages, for example 5%, also can be used. This book uses the 2% settling time.Signal-Ô¨Çow graph A representation of the interconnection of subsystems that form a system. It consists of nodes representing signals and lines representing subsystems. Similarity transformation A transformation from one state-space representation to another state-space representation. Although the state variables are different, each representation is a valid description of the same system and the relationship between the input and the output. Stability That characteristic of a system de Ô¨Åned by a natural response that decays to zero as time approaches in Ô¨Ånity. Stall torque The torque produced at the armature when a motor ‚Äôs speed is reduced to zero under a condition of constant input voltage. State equations A set of nsimultaneous, Ô¨Årst-order differential equations with nvariables, where the nvariables to be solved are the state variables. State space Then-dimensional space whose axes are the state variables. State-space representation A mathematical model for a system that consists of simultaneous, Ô¨Årst-order differential equations and an output equation. State-transition matrix The matrix that performs a transformation on x(0), taking xfrom the initial state, x(0), to the state x(t) at any time, t0. State variables The smallest set of linearly independent system variables such that the values of the members of the set at time t 0along with known forcing functions completely determine the value of all system variables for all tt0. State vector A vector whose elements are the state variables. Static error constants The collection of position constant, velocity constant, and acceleration constant. Steady-state error The difference between the input and the output of a system after the natural response has decayed to zero.Steady-state response Seeforced response . Subsystem A system that is a portion of a larger system. Summing junction A block diagram symbol that shows the algebraic summation of two or more signals.Glossary 887WEBBGLOSS 10/29/2014 0:12:45 System type The number of pure integrations in the forward path of a unity feedback system. System variables Any variable that responds to an input or initial conditions in a system. Tachometer A voltage generator that yields a voltage output proportional to rotational input speed. Time constant The time for e atto decay to 37% of its original value at t¬à0. Time-domain representation Seestate-space representation . Torque-speed curve The plot that relates a motor ‚Äôs torque to its speed at a constant input voltage.Transducer A device that converts a signal from one form to another, for example from a mechanical displacement to an electrical voltage.Transfer function The ratio of the Laplace transform of the output of a system to the Laplace transform of the input.Transient response That part of the response curve due to the system and the way the system acquires or dissipates energy. In stable systems it is the part of the response plot prior to the steady-state response. Tustin transformation A bilinear transformation that converts transfer functions from continuous to sampled and vice versa. The important characteristic of the Tustin transformation is that both transfer functions yield the same output response at the sampling instants. Type Seesystem type . Undamped response The step response of a second-order system that is characterized by a pure oscillation. Underdamped response The step response of a second-order system that is characterized by overshoot.Velocity constant lim s¬Æ0sG s¬Ü z-transformation A transformation related to the Laplace transformation that is used for the representation, analysis, and design of sampled signals and systems. Zero-input response That part of the response that depends upon only the initial state vector and not the input. Zero-order sample-and-hold (z.o.h.) A device that yields a staircase approximation to the analog signal.Zeros (1) Those values of the Laplace transform variable, s, that cause the transfer function to become zero; and (2) any roots of factors of the numerator that are common to the characteristic equation in the denominator of the transfer function. Zero-state response That part of the response that depends upon only the input and not the initial state vector.888 GlossaryWEBBANS 10/28/2014 16:7:53 Answers to Selected Problems Chapter 1 c. x t¬Ü¬à2 5 e 4t25cos 3 t¬á8 15sin 3t/C18/C19 b. x t¬Ü¬à  e t¬á9te t¬á5e 2t¬át 2 Chapter 2 b. x t¬Ü¬à15 26e 2t 3 10e 4t 1865cos 3 t 1 65sin 3t 8.Y s¬Ü X s¬Ü¬às3¬á4s2¬á6s¬á8 s3¬á3s2¬á5s¬á1 c.d3x dt3¬á11d2x dt2¬á12dx dt¬á18x¬àdf dt¬á3f t¬Ü a.Vo s¬Ü Vi s¬Ü¬à1 s¬á2 b.Vo s¬Ü Vi s¬Ü¬às2¬á2s¬á2 s4¬á2s3¬á3s2¬á3s¬á2 36.Œ∏2 s¬Ü T s¬Ü¬à3 20s2¬á13s¬á4 37.Œ∏2s ¬Ü Ts ¬Ü¬à0:011 s¬á0:29 ¬Ü s¬á2:26 ¬Ü 46.Œ∏2s ¬Ü Eas ¬Ü¬à0:08 ss¬á0:8 ¬Ü 889WEBBANS 10/28/2014 16:7:54 Chapter 3 di2 dt di4 dt dvo dt2 66666643 7777775¬à  2 5 1 101 10  15 45 45  25 85 252 66666643 7777775i 2 i4 vo2 643 75¬á2 5 15 252 66666643 7777775v o y¬àvo¬à¬â001 ¬äi2 i4 vo2 6643 775 Note: L1is left-most inductor in Figure P3.1 in the text. a. _x¬à0100 00100001  13  5 1 52 666643 77775x¬á0 0012 666643 77775r t¬Ü c t¬Ü¬à¬â 1 0800 ¬äx a. Y s¬Ü R s¬Ü¬à10 s3¬á5s2¬á2s¬á3 _x¬à Deq Jeq0Kt JeqN1 N2 10 0  Kb LaN2 N10 Ra La2 666643 77775œâ L Œ∏L ia2 435¬á0 0 1 La2 643 75ea y¬à0N2 N10/C20/C21 œâL Œ∏L ia2 435 Chapter 4 14.xt ¬Ü¬à1 6 16e  0:5tcosÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 11p 2t¬á1Ô¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É11p sinÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É11p 2t ! ¬à1 61 1:091e 0:5tcosÔ¨ÉÔ¨ÉÔ¨ÉÔ¨ÉÔ¨É 11p 2t 16:78o ! "# : a. Œ∂¬à0:375; œân¬à4 rad/s; Ts¬à2:67 s; Tp¬à0:847 s; %OS ¬à28:06 a. s¬à 6:67j9:88 38.s¬à 1:5j3:428 a. s3 8s2 11s¬á8¬à0b.s¬à9:11;0:534; 1:64 43.y t¬Ü¬à2 5 25e  5t890 Answers to Selected ProblemsWEBBANS 10/28/2014 16:7:54 46.Œ¶ t¬Ü¬à" 1:0455 e 0:20871 t 0:045545 e 4:7913t0:21822 e 0:20871 t 0:21822 e 4:7913t  0:21822 e 0:20871 t¬á0:21822 e 4:7913 t 0:045545 e 0:20871 t¬á1:0455 e 4:7913t# x t¬Ü¬à1:0455 e 0:20871 t 0:045545 e 4:7913 t  0:21822 e 0:20871 t¬á0:21822 e 4:7913t/C20/C21 y t¬Ü¬à0:60911 e 0:20871 t¬á0:39089 e 4:7913t 77.D¬à0:143 N-m-s/rad 80.R¬à912Œ© Chapter 5 2.C s¬Ü R s¬Ü¬àG3 G1G2¬á1¬Ü 1¬áG1H1 4.C s¬Ü R s¬Ü¬àG1G2¬áG3 1¬áG3H¬áG1G2H¬áG2G4 6.C s¬Ü R s¬Ü¬àG1G5 1¬áG1G2¬áG1G3G4G5¬áG1G3G5G6G7¬áG1G5G8 9.C s¬Ü R s¬Ü¬àG4G6¬áG2G5G6¬áG3G5G6 1¬áG6¬áG1G2¬áG1G3¬áG1G2G6¬á G1G3G6¬áG4G6G7¬áG2G5G6G7¬áG3G5G6G7 26.C s¬Ü R s¬Ü¬àG1G2G3G4 2¬áG2G3G4¬á2G3G4¬á2G4 27.C s¬Ü R s¬Ü¬àG1G6G7 G2¬áG3¬Ü G4¬áG5¬Ü 1 G6G7H3 G2¬áG3¬Ü G4¬áG5¬Ü G6H1 G7H2¬áG6G7H1H2 28.C s¬Ü R s¬Ü¬às3¬á1 2s4¬ás2¬á2s c. _x¬à 2100 0 200 00  50 000  62 666643 77775x¬á0 1 112 666643 77775r y¬à 1 6 1 72 1918/C20/C21 x _x¬à01 0 0  20 1 0 00 0 1 5 1002 666643 77775x¬á0 00 12 666643 77775r y¬àc¬à¬â  5100 ¬äx 65.D L¬à3560 N-m-s/radAnswers to Selected Problems 891WEBBANS 10/28/2014 16:7:55 Chapter 6 1.2 rhp, 3 lhp, 0 jœâ 3.3 rhp, 2 lhp, 0 jœâ 4.1 rhp, 0 lhp, 4 jœâ 5.0 rhp, 2 lhp, 2 jœâ 9.Unstable 17.1 rhp, 2 lhp, 4 jœâ 23.K>3 4;K< 1 a.  4<K<20:41; b.1:36 rad/s a. 0<K<22:22; b.K¬à22:22; c.s¬àj1:1547 ; 6:393; 2:607 42. 23<K<0 Chapter 7 4.estep ‚àû¬Ü¬à0;eramp ‚àû¬Ü¬à93:33;eparabola ‚àû¬Ü¬à‚àû _e ‚àû¬Ü¬à0:9 a. %OS ¬à14:01; b.Ts¬à0:107 sec; c.estep ‚àû¬Ü¬à0; d.eramp ‚àû¬Ü¬à0:075; e.eparabola ‚àû¬Ü¬à‚àû a. Kp¬à13;K ŒΩ¬à0;Ka¬à0;b.e 1¬Ü ¬à 37:5;1;1;respectively ; c.Type 0 20.K¬à70000 27.Œ≤¬à1;K¬à1:16;Œ±¬à7:76;orŒ≤¬à 1;K¬à5:16;Œ±¬à1:74 a. K¬à831;744;a¬à831:744 36.K1¬à156:8;Kf¬à7:44 a. Step: e ‚àû¬Ü¬à0:1622; ramp: e ‚àû¬Ü¬à‚àû Chapter 8 16.Breakaway point ¬à 2; asymptotes: œÉa¬à 13/3; jœâ-axis crossing ¬àj6:3 b. Asymptotes: œÉa¬à 73;c.K¬à60:2;d.K¬à1:88 20.K¬à9997 ;Œ±¬à7 a. œÉ a¬à 52;b.s¬à 1:38; 3:62; c.0<K<126; d.K¬à10:3 b. K¬à9:4;c.T s¬à4:62 s;Tp¬à1:86 s; d.s¬à 4:27; e.0<K<60 30.Œ±¬à4 a. 0<K<4;b.K¬à1090; c.K¬à690 a. K¬à170:1;b.K¬à16:95 Chapter 9 1.Gc s¬Ü¬às¬á0:7 s;K'13:8 for both cases; KpO¬à1:38;KpN¬à‚àû; %OS O¬à%OS N¬à9:48;TsO¬àTsN¬à4:36 s892 Answers to Selected ProblemsWEBBANS 10/28/2014 16:7:56 a. s¬à 3:33j5:519; b.Angle ¬à 73:309 ¬∞;c.s¬à 4:985 d.K¬à187; e.s¬à 1:66; 11:7 a. s¬à 2:4j4:16; b.s¬à 6:06; c.K¬à29:12; d.s¬à 1:263; f.Ka¬à4:8 a. Gc s¬Ü¬às¬á7 s¬á37:42;K¬à5452 ;dominant poles ¬à 4:13j10:78 a. Kuc¬à10;Kc¬à9:95; b.Kpuc¬à1:25;Kpc¬à6:22; c.%OS uc¬à%OS c¬à4:32; d.Uncompensated: exact second-order system, approximation OK; compensated: closed-loop pole at  0:3, closed-loop zero at  0:5, simulate e.Approach to Ô¨Ånal value longer than settling time of uncompensated system f.GLLC s¬Ü¬à404:1 s¬á0:5¬Ü s¬á4¬Ü s¬á2¬Ü s¬á4¬Ü s¬á0:1¬Ü s¬á28:36¬Üyields approximately a 5 times improvement in speed. 25.Gc s¬Ü¬à s¬á7:71¬Ü s¬á0:1¬Ü s;K¬à1:683 29.Poles ¬à 0:758j1:48; 2:54; zeros‚Äînone Chapter 10 10.System 1: 0 <K<490:2; System 2: 0 <K<1:4; System 3: 1 <K<‚àû (Answers are from exact frequency response) a. System 1: GM¬à 6:38 dB;Œ¶M¬à 20:3¬∞ (Answers are from exact frequency response) c. œâBW¬à2:29 rad/s 23.System 2: Ts¬à2:23 sec, Tp¬à0:476 s, %OS ¬à42:62 (Answers are from exact frequency response) 40.GM¬à6:59 dB,Œ¶M¬à46:9¬∞(Answers are from exact frequency response) Chapter 11 a. K¬à2113 (Answer is from exact frequency response) a. K¬à2365 (Answer is from exact frequency response) a. K¬à575 (Answer is from exact frequency response) 12.Gcs ¬Ü¬à4:611 s¬á1:8¬Ü s¬á8:3¬Ü;K¬à2000 (Answer is from exact frequency response) 21.Gc s¬Ü¬à s¬á0:092¬Ü s¬á2:392¬Ü s;K¬à27:01 (Answer is from exact frequency response) Chapter 12 d. For function i:T s¬Ü¬às¬á3 s2¬á k2¬á8¬Üs¬á k1¬á16¬ÜAnswers to Selected Problems 893WEBBANS 10/28/2014 16:7:57 b. For function i:G s¬Ü¬à6:25 s 27:5 s¬á10¬á71:25 s¬á20;T s¬Ü¬à200 s2¬á7s¬á25¬Ü 4s3¬áas2¬ábs¬ác where a¬à 25k3 110k2¬á285k1¬á120¬Ü b¬à 750k3 2200 k2¬á2850 k1¬á800¬Ü c¬à5000 k3 andC¬à¬â111 ¬ä;B¬à¬â71:25 27:56 :25¬äTwas used a. Uncontrollable; b.Controllable; c.Controllable K ¬à¬â92:35 36 :78 7¬äfor a characteristic polynomial of s¬á6¬Ü s2¬á8s¬á45:78¬Ü¬às3¬á14s2¬á93:78s¬á274:7 L ¬à¬â  671:19 1472 :4¬äTfor a characteristic polynomial of s2¬á144s¬á14;400 Chapter 13 a. f kT¬Ü¬à229:5 0:4¬Ük 504 0:6¬Ük¬á275:5 0:8¬Ük c. G z¬Ü¬à0:395 z¬á0:2231¬Ü z 0:2231¬Ü z2¬á0:1857 z¬á0:04979 ¬Ü b. G z¬Ü¬à0:0517z2¬á2:2699 z¬á0:2995 z 1¬Ü z 0:2231¬Ü z 0:4065¬Ü a. T z¬Ü¬àG1 z¬ÜG2 z¬Ü 1¬áG1 z¬ÜG2H z¬Ü 14.0<K<15:76 a. Kp¬à1 2;e ‚àû¬Ü¬à23;K ŒΩ¬à0;e ‚àû¬Ü¬à‚àû;Ka¬à0;e ‚àû¬Ü¬à‚àû 17.K¬à18:42 for 15 %of overshoot; 0 <K<134:76 for stability894 Answers to Selected Problems3GBINDEX 10/14/2014 11:56:16 Index A Abscissa of convergence, 35nAbsorption, 143 ‚Äì145 Acceleration constant, 345, 584Ac/dc conversion and power distribution system, 517Ackerman ‚Äôs formula, 662n Active-circuit realization, of compensation, 495 ‚Äì497 Active front steering, 644 Active queue management (AQM) algorithm, 376 Active suspension system, 286 ‚Äì287, 373 Actuating signal, 8Actuator block diagram, 286A/D, SeeAnalog-to-digital converter Adenosine triphosphate (ATP) level, 374Admittance, 53AGC, SeeAutomatic generation control Agee, J. T., 104, 112, 151, 155Aggarwal, J. K., 112Agricultural delivery booms, 644 ‚Äì645 Ahmad, R. K. R., 648AIDS, SeeHIV/AIDS Aircraft: attitude of, 23hypersonic Ô¨Çight testing, 517 STOL Ô¨Åghter aircraft, 327 Akesson, M., 113Alertness monitoring, 24Œ±-subsystem, of grid-connected converter, 517, 607, 761 Alternative Drivetrains, 28n, 30Alvarez, T., 650n, 699n, 704Alvin ,2 7 1 Ampli Ô¨Åers: operational, 57 ‚Äì61, 188 ‚Äì189 power, 93, 141preampli Ô¨Åers, 93 transfer functions and, 93Ampli Ô¨Åer saturation, 87 load angular velocity response and, 192simulation with LabVIEW program, 868 ‚Äì869 Amplitudes, 160Anagnost, J. J., 334Analogs: explanation of, 83parallel, 85 ‚Äì86 series, 83 ‚Äì85 Analog system, disk drive, 758 ‚Äì759 Analog-to-digital control conversion, 710 ‚Äì711 antenna azimuth for, 708steps to, 711 Analog-to-digital (A/D) converter, 709, 710Analysis. See also Control systems analysis deÔ¨Ånition of, 9 feedback ampli Ô¨Åer, 5 mesh, 48 ‚Äì53 nodal, 50, 53 ‚Äì55 open-loop/closed-loop sinusoidal frequency, 862 ‚Äì865 qualitative design and, 158sensitivity, 18sinusoidal frequency, 5via input substitution, 360 ‚Äì362 Analytical expressions for frequency response, 528‚Äì529 Anderson, C. G., 433, 434n, 447Anderson, S., 28, 30Anesthesia regulation, 23Angles of departure and arrival: from complex pole, 401 ‚Äì402 in root locus sketching, 400 ‚Äì402 Angu lar displacement: load, 193, 194in lossless gears, 74torque-, 69 8953GBINDEX 10/14/2014 11:56:17 Angular velocity, 81 load angular velocity response, 192 torque-, 69 Ansermino, J. M., 447Antenna azimuth, 11 ‚Äì14, 25 analog- to-digital control conversion for, 708block diagram for, 17position control system, 203, 285, 691 ‚Äì692 Antenna control system, 11 ‚Äì14 cascade compensation and, 638 ‚Äì640 closed-loop response design for, 272 ‚Äì275 controller/observer design and, 688 ‚Äì693 digital cascade compensator design and, 751 ‚Äì753 gain design and, 638lag-lead compensation and, 500 ‚Äì503 open-loop response and, 202 ‚Äì205 root locus for, 417 ‚Äì419 stability design/transient performance and, 595 ‚Äì596 stability design via gain for, 321 ‚Äì323 state-space representation and, 141 ‚Äì143 steady-state errors and, 362 ‚Äì363 transfer functions for, 92 ‚Äì94 transient design via gain and, 417 ‚Äì419, 749 ‚Äì751 Anthonis, J., 448AQM algorithm, SeeActive queue management algorithm Aquifers, 144 ‚Äì145 Aquifer system model, 144Aranda, J., 25n, 31Armature, 78 ‚Äì79 Armature circuit, 15, 78 ‚Äì79 Armature resistance, 80Armature voltage, 78 ‚Äì79, 81 Arndt, D., 25, 30 Arrival angle, SeeAngles of departure and arrival Arterial blood pressure, 217, 437 ArtiÔ¨Åcial heart, open-loop transfer function, 217 ArtiÔ¨Åcial pacemakers, 760 Ashkenas, I., 232Asparagus-picking robots, 212Assembly-line robots, steady-state errors and, 349√Östr√∂m, K., 290, 296, 430, 447, 605, 610, 743, 764 Asymptotes: approximations of, 531 ‚Äì550 break frequency, 533high-frequency, 533low-frequency, 533root locus sketching with, 393 ‚Äì395 ATP level, SeeAdenosine triphosphate level Attitude, aircraft, 23Automatic Ô¨Åeld current regulator, 436 ‚Äì437 Automatic generation control (AGC), 515Automatic Voltage Regulator, 212, 290, 330B Back electromotive force, 79 Backlash: on load angular displacement response, 193, 194 as nonlinearilty, 87insystems of gears, 73 Bahill, A. T., 30Baker, M. W., 447Ballard, R. D., 271, 296, 333 Ball-drop experiment, 150 Bandwidth, 571Baratta, R. V., 233Barb√©, L., 288n, 297Barkana, I., 371, 379, 644, 647Bauer, P., 153n, 156, 297, 334, 380, 448, 524, 611, 648, 704, 765 Bayle, B., 288n, 297 Bechhoefer, J., 24, 30 Behavior at in Ô¨Ånity, root locus sketching and, 392 ‚Äì395 Bell Telephone Laboratories, 5Bennett, S., 4n, 30Berenguel, M., 112, 155, 232, 296, 333, 379, 447, 523, 610, 647, 704, 764 Bersak, D. R., 334Bessemer, Henry, 5 Bhambhani, V., 606, 610 Bhandari, M., 701n, 704Bhattacharyya, S. P., 610, 648BIBO, SeeBounded-input bounded-output Bicycle: dynamics, 289 ‚Äì290 self-balancing, 607steer and roll angle of, 605 steering and tilt angle of, 430 Bilinear transformations, in digital control systems, 730‚Äì731 Binu, L. S., 524 Biological system, 94 ‚Äì95 Bittanti, S., 516, 523, 605, 610, 759, 764Block diagram(s), 16 ‚Äì17 converting signal- Ô¨Çow graphs to, 249 ‚Äì250 functional, 12, 13, 15of multiple subsystems, 236 ‚Äì245 of open-/closed-loop systems, 7of phase variables, 132of summing junctions, 241of transfer functions, 45 Block diagram reduction, 17 digital control systems and, 723 ‚Äì726 by moving blocks, 242 ‚Äì244 of sampled-data systems, 724 ‚Äì725 via familiar forms, 242 ‚Äì243 Block libraries, in MATLAB Simulink program, 822 ‚Äì823896 Index3GBINDEX 10/14/2014 11:56:17 Blocks, in MATLAB Simulink program, 821 Blood pressure, arterial, 217, 437 Bobrow, J. E., 30Bode, H. W., 5, 30, 610Bode plots: of (s+a), 533 approximations for, 531 ‚Äì532 determining stability via, 566 ‚Äì568 evaluating gain/phase margins via, 568 ‚Äì570 forG(s)=(s+a), 532 ‚Äì535 forG(s)=1/s, 537 forG(s)=1/(s 2+2Œ∂œâns+œân2), 543 ‚Äì547 forG(s)=1/(s+a), 536 for gain adjustment, 615 ‚Äì616 gain margin/phase margin from, 569forG(s)=s, 536 ‚Äì537 forG(s)=s 2+2Œ∂œâns+œân2, 540 ‚Äì541 for lead compensation, 627range of gain for stability via, 567 ‚Äì568 for ratio of Ô¨Årst-order factors, 537 ‚Äì540, 547 ‚Äì550 for ratio of second-order factors, 541 ‚Äì543, 547 ‚Äì550 static error constants from, 585 ‚Äì586 transfer function from, 591 ‚Äì594 Bokor, J., 153n, 156, 297, 334, 380, 448, 524, 611, 648, 704, 765 Bona, B. E., 156, 233, 297, 334, 705Bondia, J., 156, 704Boost converter, 291Borovic, B., 216, 231Bosch, R., 28, 30, 106, 112Bottom-up design, 21Bounded input, 300Bounded-input bounded-output (BIBO), 300 ‚Äì301 Boyd, M., 764Branches: root locus sketching and, 391of signal-Ô¨Ç ow graphs, 248 ‚Äì249 Breakaway points: explanation of, 395 ‚Äì397, 404 using differential calculus to Ô¨Ånd, 397 ‚Äì398 without differentiation, 398 ‚Äì399 Break frequency, 533Break frequency asymptotes, 533Break-in points: explanation of, 395 ‚Äì397, 404 using differential calculus to Ô¨Ånd, 397 ‚Äì398 without differentiation, 398 ‚Äì399 Breazeal, C., 30Bretholtz, √ò., 31 Budak, A., 523 Butler, H., 290, 291n, 296Butterworth polynomial, 328Buzi, G., 379C Cai, Y., 379, 447, 611 Camacho, E. F., 29, 30, 107, 112, 153, 155, 222, 232, 294, 332, 333, 377, 379, 438, 447, 519, 523, 608, 610, 646,647, 702, 704, 764 Campbell, T. J., 434n, 447Cancellation, pole-zero, 190 ‚Äì191 Cannon, R. H., Jr., 30, 47, 112Canonical form: controller, 260 ‚Äì261, 265 Jordan, 260observer, 261 ‚Äì265, 671 ‚Äì673 transformations to, 260 ‚Äì265 Capacitors, 127C√°rdenas, M. O., 704Cardona, J. E., 701, 704Carlson, L. E., 112, 155 Cascade compensation: antenna control and, 638 ‚Äì640 in digital control systems, 743 steady-state error design via, 614steady-state errors via, 453 ‚Äì462 transient response design via, 614transient response improvement via, 462 ‚Äì474 vias-plane, 742 ‚Äì746 Cascade compensators, 486, 744 ‚Äì745, 751‚Äì753 Cascade d interconnections, 34 Cascaded subsystems, 237 ‚Äì239, 264 Cascaded systems, load in, 238Cascade form: of multiple subsystems, 237 ‚Äì239 of state space, 256 ‚Äì258, 265 Cascade PI controller, robotic manipulator with, 433 Catheter, de Ô¨Çection response, 216 Cereijo, M. R., 155 Chan, W. L., 334Chandra, F. A., 374, 379Chaos, D., 25n, 31Characterizing response, from damping ratio, 172Chassaing, R., 747n, 764Chebyshev, P. L., 5 Chemical process control system, 329 Chen, J. M., 288n, 297Chen, N., 374n, 380Chen, S.-Y., 291, 296Chen, Y. D., 233Chen, Yq., 610Chignola, R., 104, 112Chiu, D. K., 149, 155 Circuits: armature, 15, 78 ‚Äì79 complex, 51 ‚Äì55 integrated, 290 ‚Äì291Index 8973GBINDEX 10/14/2014 11:56:18 Circuits: ( Continued ) inverting operational ampli Ô¨Åer, 58 ‚Äì59 nonminimum-phase electric, 188 simple, 50, 51solenoid coil, 285 ‚Äì286 transformed, 49 Classical technique, 116. See also Frequency-domain modeling Cleveland, J. P., 233 Clifford, William Kingdon, 5 Closed-loop feedback, in ventilators, 432Closed-loop frequency responses: closed-loop transient responses and, 570 ‚Äì573 relation between open-loop and, 573 ‚Äì578 Closed-loop polar plot, 576nClosed-loop poles, 301 ‚Äì303, 382 ‚Äì383, 386, 407, 410, 416, 455 Closed-loop response design, for antenna control, 272 ‚Äì275 Closed-loop sinusoidal frequency analysis and design, with LabVIEW program, 862 ‚Äì865 Closed-loop step response, with LabVIEW program, 860‚Äì861 Closed-loop system, 8, 158 block diagram of, 7error, 337 ‚Äì338 for ideal integral compensator, 455root sensitivity of, 416 ‚Äì417 Closed-loop transfer function, sensitivity of, 357Closed-loop transient responses: closed-loop frequency responses and, 570 ‚Äì573 open-loop frequency responses and, 578 ‚Äì582 Closed-loop vehicle response, for train stopping, 431CMM, SeeCoordinate measuring machine Cochin, I., 112, 155CoefÔ¨Åcient(s): matching, 661 ‚Äì662, 677, 681 ‚Äì683 reverse, 307of viscous friction, 61, 69 Companion matrices, 262Compensated system: of ideal derivative compensation, 466 ‚Äì467 root locus for, 456 Compensating zero, via rate feedback, 489 ‚Äì491 Compensation. See also speci Ô¨Åc types active-circuit realization of, 495 ‚Äì497 physical realization of, 495 ‚Äì499 for systems, 8techniques, 452 Compensators, 8, 452 ‚Äì453. See also speci Ô¨Åc types passive realization of, 498root locus with, 454root locus without, 454 Completely controllable, 659nCompletely observable, 675n Complex circuits: via mesh analysis, 51 ‚Äì53 vianodal analysis, 53 ‚Äì55 Complex numbers, vector representation of, 383 ‚Äì385 Complex pole, angle of departure/arrival from, 401 ‚Äì402 Component design, transient response through, 180 ‚Äì181 Component responses, of three-pole system, 183 ‚Äì184 Computer-aided design, 19 ‚Äì20 Computer-controlled systems, 8 Computer hard disk drive, 9, 433, 644Computers, SeeDigital computers Computer simulation, of step responses, 420Conductance, 54nConservation, Ô¨Çow for, 145 Constant-acceleration inputs, 337Constant command, 17 Constant Mcircles, 573 ‚Äì574, 576 Constant Ncircles, 573 ‚Äì576 Constant-velocity inputs, 336 Continuous casting, in steel production, 289Continuous stirred tank reactor, 699, 700Contours, 551 ‚Äì554 Control design palette, in LabVIEW program, 872 ‚Äì874 Controllability, 658 ‚Äì661 by inspection, 658 ‚Äì659 via controllability matrix, 659 ‚Äì660 Controllability matrix, 659 ‚Äì661 Controllable systems, 658Controlled variable, 7, 34Controller canonical form, of state space, 260 ‚Äì261, 265 Controller design, 651 ‚Äì658 alternative approaches to, 661 ‚Äì667 antenna control and, 688 ‚Äì693 by matching coef Ô¨Åcients, 661 ‚Äì662 for phase-variable form, 655 ‚Äì657 by transformation, 662 ‚Äì666 Controllers. See also Proportional-plus-integral-plus- derivative (PID) controllers cascade PI, 433master, 329 open-loop swivel, 376 in open-loop systems, 7proportional-plus-derivative, 463proportional-plus-integral, 453, 457slave, 329 Control system problem, for root locus, 382 ‚Äì383 Control systems. See also Feedback control systems; speci Ô¨Åc control systems advantages, 2 ‚Äì4 analysis of, 9 ‚Äì14, 17 ‚Äì18 compo nents, 2 computer-aided design of, 19 ‚Äì20898 Index3GBINDEX 10/14/2014 11:56:19 conÔ¨Ågurations of, 6 ‚Äì8 deÔ¨Ånition of, 2 derivative, 453 design objectives for, 9 ‚Äì14 design process, 14 ‚Äì18 digital computers in, 6engineering, 20 ‚Äì21 history of, 4 ‚Äì6 integral, 453 prevalence of, 21 proportional, 453schematic for, 15test waveforms, 18theory, 5twentieth-century developments, 5 Control systems analysis: in design process, 17 ‚Äì18 with LabVIEW program, 850 ‚Äì851 linear, 5objectives of, 9 ‚Äì14 Control System Toolbox, 439, 519, 520, 609Convolution integral, 198Cook, P. A., 112Coordinate measuring machine (CMM), 516Corke, P. I., 523 Coulomb friction, 65n Cowan, N. J. A., 611Craig, I. K., 27, 30, 105, 113, 152, 155, 222, 232, 293, 331, 333, 376, 379, 447, 518, 523, 608, 610, 645,647, 702, 704, 761, 764 Craig, J. J., 447, 523, 764Cramer ‚Äôs rule, 52 Crane loading, 103 Crawshaw, L. I., 30 Critically damped response, 167, 168Critical points, root locus sketching and, 405 ‚Äì406 Crosslapper, 218Cruise control systems, 606CT scans, 288Cubitt, William, 4Cutaneous rabbit, 24 ‚Äì25 DDa, R. E., 334D/A converter, SeeDigital-to-analog converter D‚ÄôAmbrosia, R. D., 233 Damped frequency of oscillation, 178Damper, mass and, 123Damping, 79 Damping frequency, exponential, 178 Damping ratio: characterizing response from, 172deÔ¨Ånition of, 170natural frequency and, 203 ‚Äì204 from phase margin, 579 ‚Äì580 second-order response as function of, 171of second-order system, 169 ‚Äì172 second-order underdamped responses for, 174v. percent overshoot, 176v. rise time, 177 Das, A., 764Datta, A., 610, 648 Davidson, C. M., 437, 447 Davis, S. A., 113D‚ÄôAzzo, J. J., 30, 333, 340n, 379, 523, 647, 704 DBS, SeeDeep Brain Stimulation Dc-dc converter, 219, 699 ‚Äì700 Dc motors, 78 driving rotational mechanical load, 80load and, 81 ‚Äì82 Dc servomotor, load and, 148Deadbeat control, 759 ‚Äì760 Dead zone, 87, 193de Ara√∫jo, F. M. U., 447, 610Deblander, J., 448Decay frequency, exponential, 169 ‚Äì170 Decoupled equations, 260, 268Decoupled variables, 123 Deep Brain Stimulation (DBS), 437 DeÔ¨Çection response, of Ô¨Çuid- Ô¨Ålled catheter, 216 Degr ees of freedom, 64 in rotational systems, 69 de Keyser, R., 232, 289n, 297Delivery booms, agricultural, 644 ‚Äì645 Dell ‚ÄôOrto, F., 523, 610, 764 de Mathelin, M, 288n, 297 Deng, H., 31 de Paor, A. M., 447Departure angle, SeeAngles of departure and arrival Dependent source, electrical network with, 125 ‚Äì127 Derivative compensation, SeeIdeal derivative compensation Derivative control systems, 453Design. See also Frequency response design methods; Root locus design methods; State-space design methods computer-aided, 19 ‚Äì20 deÔ¨Ånition of, 9 with LabVIEW program, 850 ‚Äì851 objectives, 9 ‚Äì14 theory, 5 Design process: Ô¨Çowchart of, 14 steps of, 14 ‚Äì18 Desired transient response, 9 Desoer, C. A., 334Destination shaft, 75Index 8993GBINDEX 10/14/2014 11:56:19 de Vlugt, E., 288, 296 Diagonalizing: system in state space, 269 ‚Äì270 system matrix, 267 Diaz, J. M., 25n, 31 DiBona, G. F., 217, 232Di Carlo, A., 523, 610, 764Dickinson, M. H., 611Differential calculus, 397 ‚Äì398 Differential equation(s): coefÔ¨Åcients, 5 fractional calculus, 218Laplace transform solution of, 39linearization of, 89 ‚Äì90 linear time-invariant, 16nth-order, 16, 117 single loop via, 48 transfer function for, 45 Digital cascade compensator design, 744 ‚Äì745 antenna control and, 751 ‚Äì753 Digital compensator, implementing, 746 ‚Äì749 Digital computers: advantages, 709 ‚Äì710 in control systems, 6 modeling, 711 ‚Äì714 placement within loop, 709 Digital control systems: advantages of digital computers, 709 ‚Äì710 analog-to-digital conversion, 710 ‚Äì711 antenna control with, 749 ‚Äì753 background, 708 ‚Äì709 bilinear transformations in, 730 ‚Äì731 block diagram reduction and, 723 ‚Äì726 cascade compensation in, 743cascade compensation via s-plane and, 742 ‚Äì746 digital system stability in, 726 ‚Äì733 digital-to-analog conversion, 710gain design on z-plane and, 739 ‚Äì742 implementing digital compensators, 746 ‚Äì749 with MATLAB program, 809 ‚Äì814 with MATLAB Simulink program, 833 ‚Äì835 modeling digital computers, 711 ‚Äì714 stability design via root locus in, 739 ‚Äì740 steady-state errors and, 733 ‚Äì737 transfer functions of, 719 ‚Äì723 transient response design via gain adjustment and, 740 ‚Äì741 transient response on z-plane, 737 ‚Äì739 z-transform and, 714 ‚Äì719 Di gital feedback control system: steady-state errors for, 734unit parabolic input for, 735unit ramp input for, 735unit step input for, 734 ‚Äì735Digital numerical control, lathe with, 726 Digital system simulation, with LabVIEW program, 871‚Äì874 Digital system stability: digital control systems in, 726 ‚Äì733 via Routh-Hurwitz, 732 vias-plane, 731 ‚Äì733 viaz-plane, 726 ‚Äì730 Digital-to-analog conversion, 710 Digital-to-analog (D/A) converter, 709, 710 Digital versatile disc (DVD) players, 515 ‚Äì516, 605, 759 Dirac delta functions, 713Disk drive, 9 analog system of, 758 ‚Äì759 arm, 433, 644 Displacement. See also Angular displacement force-, 62 mechanical, 61 ‚Äì62 read/write head, 328 Distributed parameter, 70n Disturbances: deÔ¨Ånition of, 7 steady-state errors for, 351 ‚Äì353 Doebelin, E. O., 30, 113Dollar, A. M., 334 Dominant-pole argument, 217 Dong, F., 212, 232Dorf, R. C., 30, 113, 188, 232, 333, 447, 523, 610, 648Doyle, J. C., 379Drebbel, Cornelis, 4Drive system, with elastically coupled load, 290, 331, 701Driving simulator, 630Drug absorption, 143 ‚Äì145 D‚ÄôSouza, A. F., 23, 30, 113 Duals, 262 ‚Äì263 Dubowsky, S., 30Dumont, G. A., 447DVD players, SeeDigital versatile disc players DVR, SeeDynamic voltage restorer Dynamic control systems, 9Dynamic subsystems, 141 Dynamic voltage restorer (DVR), 372, 431 Dynamometer, 23, 80 ‚Äì81 EEconomics, as design consideration, 10Economic system dynamics, 330 ‚Äì331 ECU, SeeElectronic control unit Edelson, J., 28, 30 Edelstein-Keshet, L., 103, 104, 113 Eigenvalues, 268 poles and, 195 ‚Äì198 transfer function poles and, 195 ‚Äì198900 Index3GBINDEX 10/14/2014 11:56:20 Eigenvector, 267 ‚Äì269 Ekeberg, √ñ., 155 Elara Ô¨Å, M. G. M. K., 218, 232 Electrical constants, of motor transfer function, 81Electrical network(s): branch currents in, 124with dependent source, 125 ‚Äì127 representation of, 124 ‚Äì125 state-space representations of, 116 ‚Äì120 transfer function, 47 ‚Äì61 Electrical to mechanical systems analogies, 61 ‚Äì62 Electric circuit analogs, 83 ‚Äì86 Electric vehicle, mechanical brake response of, 219 ‚Äì220 Electric ventricular assist device (EVAD), 287, 643‚Äì644, 759 Electromechanical system transfer functions, 77 ‚Äì83 Electronic control unit (ECU), 28 Elevators, 2, 3 Elevator surface angle, 206Elkins, J. A., 113, 155El-Samad, H., 447Elsley, G., 297, 333Emami-Naeini, A., 30, 113, 156, 232, 610, 704Energy storage elements, 123Enzyme breakdown, 102 ‚Äì103 Eppinger, S. D., 156, 232, 297, 334Epsilon method, stability via, 306Equations of motion, SeeMotion equations Equilibrium, 87Errors, 8. See also Steady-state errors quantization, 710ramp response, 483static error constants, 345 ‚Äì347, 458, 585 ‚Äì586 Estimator, 667EVAD, SeeElectric ventricular assist device Evans, W. R., 5, 382, 447Existing transient response, 9Exponential damping frequency, 178Exponential decay frequency, 169 ‚Äì170 Exponential frequency, 163Exponential response, 160 Exponential time constant, 169 ‚Äì170 External hardware, with LabVIEW program, 875 ‚Äì878 F Factoring, via Routh-Hurwitz, 317Fagergren, A., 150, 155Fahl√©n, P., 524, 611FANUC M-410iB robot, 321 Feedback ampli Ô¨Åer analysis, 5 Feedback compensation, 487 ‚Äì495 approach 1, 488 ‚Äì491 approach 2, 492 ‚Äì495generic control system, 487minor-loop, 492 ‚Äì494 in UFSS, 503 ‚Äì504 Feedback control systems, 8, 240 ‚Äì241. See also Control systems; speci Ô¨Åc control systems analysis/design of, 245 ‚Äì248 for ideal derivative compensation, 466 with MATLAB Simulink program, 832 ‚Äì833 simulat ion with LabVIEW program, 870 ‚Äì871 state-space representations of, 263 ‚Äì264 Feedback form, of multiple subsystems, 240 ‚Äì241 Feedback path, 8 Fenn ‚Äôs law, 287 Fertilizer applicator, 435Final value theorem, steady-state errors using, 359 ‚Äì360 Finances, of control systems, 10First-order systems, 162 ‚Äì164 poles of, 159 ‚Äì161 unit step and, 162zeros of, 159 ‚Äì161 First-order transfer functions via testing, 163 ‚Äì164 Fixed Ô¨Åeld, 78 Fixed structure controllers, SISO system, 607 ‚Äì608, 645 Flexible links, 700 ‚Äì701 Flight dynamics, fruit Ô¨Çy, 607 Floor vibration eliminator, 435Flower, T. L., 648Flow for conservation, 145Fluid- Ô¨Ålled catheter, de Ô¨Çection response, 216 Flyball speed governor, 4Force-displacement, 62Forced response, 10, 158, 160Force-velocity, 62 Foroni, R. I., 112 Forssberg, H., 155Forward-path gain, 251Forward transfer function, SeeOpen-loop transfer function Four-wheel drive vehicle, steering model for, 374Fractional calculus differential equations, 218Frankle, J. T., 30Franklin, G. F., 30, 113, 156, 191, 232, 447, 610, 662n, 704 Free-body diagram, 63 Free viruses, 105Frequency: break, 533damped frequency of oscillation, 178exponential, 163, 169 ‚Äì170 exponential damping, 178and gain at imaginary-axis crossing, 399 ‚Äì400 natural, 169, 171, 203 ‚Äì204 Frequency-domain modeling: antenna control system, 92 ‚Äì94 electrical networks, 47 ‚Äì61Index 9013GBINDEX 10/14/2014 11:56:20 Frequency-domain modeling: ( Continued ) electric circuit analogs, 83 ‚Äì86 electromechanical systems, 77 ‚Äì83 human leg, 94 ‚Äì95 Laplace transforms for, 35 ‚Äì44 with linearization, 87 ‚Äì92 with MATLAB program, 772 ‚Äì776 nonlinearities in, 86 ‚Äì87 representations of systems, 34 ‚Äì35 rotational mechanical systems, 69 ‚Äì73 for systems with gears, 73 ‚Äì77 transfer functions, 44 ‚Äì47 translational mechanical systems, 61 ‚Äì68 v. time-domain modeling, 116 Frequency response: analytical expressions for, 528 ‚Äì529 for antenna control, 595 ‚Äì596 asymptotic approximations of, 531 ‚Äì550 background on, 526 ‚Äì527 Bode plots of, 531 ‚Äì550 closed-loop, 570 ‚Äì578 closed-loop transient response and, 570 ‚Äì573, 578 ‚Äì582 concept of, 527 ‚Äì528 gain and phase margin via Nyquist diagram, 564 ‚Äì566 lead compensator, 624 ‚Äì625 with MATLAB program, 796 ‚Äì801 Nyquist criterion, 550 ‚Äì555 open-loop, 573 ‚Äì582 plotting, 529 ‚Äì531 sinusoidal, 527 sketching Nyquist diagrams, 555 ‚Äì560 stability, gain margin, and phase margin via Bode plots, 566‚Äì570 stability via Nyquist diagram, 560 ‚Äì564 steady-state errors from, 582 ‚Äì586 systems with time delay, 586 ‚Äì590 from transfer function, 530transfer functions from, 591 ‚Äì594 Frequency response design methods: antenna control and, 638 ‚Äì640 lag compensation and, 618 ‚Äì623 lag-lead compensation and, 629 ‚Äì637 lead compensation and, 623 ‚Äì629 with MATLAB program, 801 ‚Äì805 overview of, 614 ‚Äì615 root locus and, 614transient response via gain adjustment and, 615 ‚Äì618 Frequency response plots, 529. See also Bode plots of time delay systems, 587 ‚Äì588 Friction, 65nFriedman ‚Äôs model, 330, 331 Fruit Ô¨ÇyÔ¨Çight dynamics, 607 Fu, Z., 760, 764Fuchs, F. W., 220n, 233, 334, 448, 524, 611, 705 Fuel-cell power plants, 6 Function(s). See also Transfer function(s) Dirac delta, 713linearizing, 88time, 35 ‚Äì36, 715 ‚Äì716 Functional block diagrams, 12, 13 drawing of, 15 GG(s), steady-state error as, 340 ‚Äì344 Gaiceanu, M., 113Gain, 3. See also Range of gain for stability forward-path, 251at imaginary-axis crossing, 399 ‚Äì400 loop, 241, 251 ‚Äì252 pitch, 322 stability design via, 321 ‚Äì323 steady-state error design via, 363 ‚Äì365 unity, 8 Gain-adjusted antenna control system, step responses of, 418 Gain adjustment: bode plots for, 615 ‚Äì616 stability and, 614transient response via, 615 ‚Äì618 Gain design: antenna control and, 638 for meeting steady-state error speci Ô¨Åcation, 350 Third-order system, 408 ‚Äì411 for transient response, 247onz-plane, digital control systems and, 739 ‚Äì742 Gain margin: from Bode plots, 569evaluating, 568 via Nyquist diagram, 564 ‚Äì566 Galv√£o , R. K. H., 430, 447, 604, 610 Gamble, J. B., 31, 297Gauthier, M., 233Gear backlash, 87Gear driven rotational systems, 74 ‚Äì75 Gear systems, 73 ‚Äì77 with loss, 76 ‚Äì77 motion equation for, 75schematic, 73 Gear train, 76The General Problem of the Stability of Motion (Lyapunov), 5 Geselowitz, D. B., 297, 648, 765 Ghosh, R., 764 Gillard, D., 233Glantz, A. S., 216, 232Glargine insulin, 699902 Index3GBINDEX 10/14/2014 11:56:21 Global carbon cycle, schematic description of, 151 Glycolysis, 374 GNP, SeeGross National Product Godhaven, J., 31Golbon, N., 523, 764Gompertz growth model, 104Gong, P., 764Gong, W., 379, 610, 648Good, M. C., 232 Goodwin, G. C., 297, 333 Gozde, H., 212, 232, 290, 297, 330, 333Graebe, S. F., 289, 297, 332, 333Graham, D., 232Grain drying conveyor, 645Graovac, D., 104, 113, 291Graphical user interface (GUI), 19, 192Grid-connected converter, Œ±-subsystem, of, 517, 607, 761 Griggs, G. E., 112, 155Grinder system, 23Gross National Product (GNP), 330GUI, SeeGraphical user interface Gupta, H., 152n, 156, 233, 334, 524, 704, 764Gurkaynak, Y., 25, 26n, 30Guy, W., 433, 447 H Hacisalihzade, S. S., 31Hahn, J. O., 432, 447Hammel, H. T., 30Han, F., 764Han, Y. D., 379, 447Haptipog ÃÇlu, C., 334 Harbor, R. D., 648Hard disk drive (HDD) arm, 433, 644Harmonic drives, robotic manipulator with, 435 ‚Äì436 Hatopog ÃÜlu, C., 448 HDD arm, SeeHard disk drive arm Head, 144Heat-exchanger process, 513Heat exchange system, 644 Heinemann, W., 232 Hekman, K. A., 329, 333Heller, H. C., 30Her, M.-G., 288n, 297High-frequency asymptotes, 533High-speed proportional solenoid valve, 24Hisham, S. B., 232HIV/AIDS control system problem, 27, 105, 152, 222, 293, 331, 376 ‚Äì377, 438, 518, 608, 645, 702, 761 Hoffmann, N., 220n, 233, 334, 448, 524, 611, 705Hogan, B. J., 23, 30Hold: zero-order, 714zero-order sample-and-, 710, 714, 721 ‚Äì722 Hollot, C. V., 376, 379, 431, 447, 605, 610, 643, 648Holographic media storage, 605 ‚Äì606 Home entertainment systems, 6Homogeneity, 86Homogeneous solutions, 10, 162nHong, J., 149, 156 Hormonal regulation mechanisms, 430 Horn, M., 219n, 233Hospital pharmacy robot, 650Hostetter, G. H., 30, 297, 333, 360, 379, 523, 610, 648, 704, 764 Hot tail responses, 217Houpis, C. H., 30, 333, 340n, 379, 523, 647, 704Hsu, J. C., 113 Huisman, R., 611 Human growth population, 103Human leg, transfer function of, 94 ‚Äì95 Human postural dynamics, 103 ‚Äì104 Human pupil servomechanism, 432 ‚Äì433 Human response, to visual cues, 215Hutchinson, S., 380, 436n, 448Hybrid solar cell, diesel power distribution system and, 289 Hybrid vehicle control problem, 27 ‚Äì28, 105 ‚Äì106, 152 ‚Äì153, 222, 293 ‚Äì294, 331 ‚Äì332, 377, 438, 518 ‚Äì519, 608, 646, 702, 761 ‚Äì762 Hypersonic Ô¨Çight testing, 517 Hypothalamic-pituitary-adrenal axis, 149 ‚Äì150, 697 I Iagnemma, K., 30 ICE, SeeInternal combustion engine Ideal compensators, 452Ideal derivative compensation, 463 ‚Äì470 design, 466 ‚Äì469 feedback control system for, 466predicted characteristics for, 465root locus for, 466, 468 uncompensated/compensated system, 466 ‚Äì467 Ideal integral compensated system response, uncompensated system response and, 457 Ideal integral compensator, 453 ‚Äì457 close d-loop system for, 455 effect of, 455 ‚Äì457 implementing, 457 Ideal sampling, zero-order hold and, 714Identity matrix, 136 Ignatoski, M. A., 297, 648, 765Iizuka, Y., 448Imaginary-axis crossing, frequency/gain at, 399 ‚Äì400Index 9033GBINDEX 10/14/2014 11:56:22 Impedance(s): for mechanical components, 63 ‚Äì64 rotational mechanical, 75 summing, 55, 57 Impedance relationships, 47 rotational, 69translational, 61 ‚Äì62 Implantable medical devices, with in-body batteries, 435 Impulse, 17, 18In-body batteries, implantable medical devices with, 435 Inductors, 127Inertia, 15, 69, 80InÔ¨Ånity, sketching behavior at, 392 ‚Äì395 Inigo, R. M., 156Initial conditions, 45 Input, 2. See also speci Ô¨Åc types Input potentiometer, 92 ‚Äì93 Input signals: root locus and, 413 test of, 17 Input substitution: analysis via, 360 ‚Äì362 steady-state errors using, 361 ‚Äì362 Input transducer, 7Insect Ô¨Çight dynamics, 219, 607 Inspection, mesh equations via, 56 ‚Äì57 Instability, 10, 300, 301. See also Stability Insulin, 149, 699Integral control: design, 685 ‚Äì687 steady-state error design via, 684 ‚Äì687 systems, 453 Integrated circuits, 290 ‚Äì291 Interconnection of subsystems, block diagram of, 34Internal combustion engine (ICE), 28Inverse Laplace transform, 35, 36, 162Inverse z-transform, 717 ‚Äì719 via partial-fraction expansion, 717 ‚Äì718 via power series method, 718 ‚Äì719 Inverted pendulum cart system, 151 ‚Äì152, 220 ‚Äì221, 328, 511‚Äì512, 701, 758 Inverting operational ampli Ô¨Åer, 57 ‚Äì58, 286 circuit, 58 ‚Äì59 schematic, 58 Ionescu, C., 218, 232Ionic polymer-metal composite, 219Isailovic ÃÅ, J., 370, 379 JJarvis, A. J., 151n, 156Jason , 315Jason Junior , 271 Jenkins, H. E., 23, 30Jeon, C.-H., 297Jiang, J., 448, 523, 611, 764Jiayu, K., 218, 232Jimoh, A. A., 112, 155Johansson, R., 103, 113Johnson, H., 205, 232, 275, 277, 285, 297, 322, 333, 419, 421, 447, 503, 504, 523, 758, 764, 781, 783 Joint Ô¨Çexibility, model representing, 436 jœâ-axis crossings, root locus sketching and, 399 ‚Äì400 Jordan canonical form, 260 Jury ‚Äôs stability test, 729 KKailath, T., 35, 113, 156, 704Kandel, A., 145, 156 Kanellakopoulos, I., 286n, 297 Karkoub, M., 288, 297Karlsson, P., 432n, 442, 447, 517, 523Kasper, R., 232Katic ÃÅ, V., 113 Katz, P., 764Kermurjian, A., 113Khadraoui, S., 607, 610, 645, 648 Khaligh, A., 26n, 30 Khammash, M., 430, 447Kharitonov ‚Äôs theorem, 327, 328 Khodabakhshian, A., 515, 523, 759, 764Kidney function, arterial blood Ô¨Çow and, 217 Kim, J. H., 610Kim, J.-W., 648Kim, S.-H., 605, 610 Kim, Y.-B., 648 Kirchhoff ‚Äôs current law, 16, 47, 83 Kirchhoff ‚Äôs nodal equations, SeeNodal equations Kirchhoff ‚Äôs voltage law, 16 Klaasens, J. B., 233, 705Klapper, J., 30Klein, R. E., 296, 447, 610Knight, B., 233 Ko, S.-H., 297 Kong, F., 289, 297Koontz, J. W., 297, 648, 765Krieg, M., 104, 113Ktesibios ‚Äôwater clock, 4 Kuo, B. C., 218, 232, 447, 485, 523, 611, 648, 729n, 764 Kuo, C.-F. J., 232, 374, 379 Kuo, F. F., 113, 611 Kurfess, T. R., 30Kwon, O.-S., 297Kyrylov, V., 149, 156, 697, 704904 Index3GBINDEX 10/14/2014 11:56:22 L LabVIEW program, 20 ampli Ô¨Åer saturation simulation with, 868 ‚Äì869 analysis examples with, 853 ‚Äì865 closed-loop step response with, 860 ‚Äì861 control design palette in, 872 ‚Äì874 controlling external hardware with, 875 ‚Äì878 control systems analysis with, 850 ‚Äì851 design examples with, 853 ‚Äì865 design with, 850 ‚Äì851 digital system simulation with, 871 ‚Äì874 feedback system simulation with, 870 ‚Äì871 linear systems simulation with, 866 ‚Äì868 open-loop/closed-loop sinusoidal frequency analysis/ design with, 862 ‚Äì865 open-loop step response with, 853 ‚Äì859 root locus analysis/design with, 862simulation examples, 865 ‚Äì874 simulation palette in, 871 ‚Äì872 simulation with, 850 ‚Äì851 using, 851 ‚Äì853 Lag compensation, 457 ‚Äì462, 618 ‚Äì623 design procedure, 619 ‚Äì623 root locus and, 459 type 1 systems, 457 visualizing, 618 ‚Äì619 Lag compensator, 453, 618n design, 459 ‚Äì462 Lagging, 618n Lag-lead compensation, 629 ‚Äì637 antenna control and, 500 ‚Äì503 design procedure, 630 ‚Äì634 using Nichols chart, 635 ‚Äì637 Lag-lead compensator, 479 design, 479 ‚Äì484 ramp response error for, 483root locus for, 480 ‚Äì482 Lago, G., 113Lam, C. S., 372, 379, 447Lam, P. Y., 607, 611Landesberg, A., 297 Laplace transform, 16, 35 ‚Äì36 deÔ¨Ånition of, 35 of differential equation, 39 inverse, 35, 36review, 35 ‚Äì44 ofstat e-transition matrix, 198 ‚Äì199 state-transition matrix via, 201 ‚Äì202 table, 36 theorems, 37 of time function, 35 ‚Äì36 Laplace transformed circuit, 49Laplace transform solution, 196 ‚Äì198of state equations, 194 ‚Äì198 Lathe, with digital numerical control, 726Lead compensation, 470 ‚Äì474 Bode plots for, 627design, 471 ‚Äì474, 626 ‚Äì629 geometry of, 470possible solutions, 471in UFSS, 503 ‚Äì504 visualizing, 623 ‚Äì624 Lead compensator, 463, 623n frequency response, 624 ‚Äì625 realization, 499 Ledgerwood, B. K., 113Lee, Edmund, 4Lee, K.-B., 648Lee, S., 155Lee, S.-R., 289, 297 Leedal, D. T., 151n, 156 Lennartsson, A., 296, 447, 610Leo, D. J., 232Lessard, C. D., 104, 113Lewis, F. L., 216n, 231Li, P., 374n, 380Li, S., 151, 156Li, Z., 26n, 30 Liang, S. Y., 333 Library Browser, MATLAB Simulink program, 820 ‚Äì821 Liceaga-Castro, E., 150, 156Lieberman, J., 24, 30Liew, K. M., 379, 447, 611Lin, J.-S., 286n, 287, 297, 373, 379Lin, R., 334, 448, 648Linan, M., 232 Linear combination, 119, 120 Linear control systems analysis, 5Linear independence: explanation of, 120state variables and, 121 ‚Äì122 Linearity, 86Linearization, 87 ‚Äì92 about a point, 88 of differential equations, 89 ‚Äì90 of function, 88 longitudinal Ô¨Çight model, 218 state-space representation and, 138 ‚Äì140 Linearized magnetic levitation system block, 430Linearly dependent motions, 64Linearly increasing command, 17Linearly independent, 120 state variables, 121 ‚Äì122 Linear systems, 86 piecewise, 102simulation with LabVIEW program, 866 ‚Äì868Index 9053GBINDEX 10/14/2014 11:56:23 Linear systems ( Continued ) simulation with MATLAB Simulink program, 824 ‚Äì829 total response for, 10 Linear time-invariant differential equation, 16 Linear time-invariant model, of hypothalamic-pituitary- adrenal axis, 149 ‚Äì150 Linear voltage differential transformer (LVDT), 24Liquid-level control, 4Lithium-ion battery charger, 329 Liu, A. Q., 216n, 231 Liu, C.-H., 374n, 379Liu, G., 334, 611Liu, J.-H., 700, 704Load: in cascaded systems, 238dc servomotor and, 148elastically coupled, 290, 331, 701 motor and, 81 ‚Äì82, 93, 141 ‚Äì143 rotational mechanical, 80 Load angular displacement response: backlash effect on, 193, 194 dead zone effect on, 193 Load angular velocity response, ampli Ô¨Åer saturation and, 192 Log-magnitude plots, 533, 542 ‚Äì543, 566 ‚Äì567 Longitudinal Ô¨Çight model linearization, 218 Look-ahead offset, 330Loop analysis, SeeMesh analysis Looper, Mark, 28nLoop gain, 241, 251 ‚Äì252 Loops: major, 488minor, 487, 488multiple, 51 ‚Äì53 nontouching, 251 ‚Äì252 Lordi, N. G., 143, 156Lossless gears, 74 angular displacement in, 74system with, 75 ‚Äì76 Low, K. H., 376, 379, 447, 604, 611Low back pain, motor trunk patterns and, 217Lowery, M. M., 447 Low-frequency asymptotes, 533 LTI Viewer, 19, 566, 569Ludwick, S. J., 30Luenberger, D. G., 704Lumped parameter, 70nLusitania , 315 LVDT, SeeLinear voltage differential transformer Lyapunov, Alexandr Michailovich, 5 M Mablekos, V. E., 78, 113Magnetic levitation transportation system, 604 ‚Äì605Magnitude frequency response, 528 Magnitude plots, 529 Magnusson, M., 113Mahmood, H., 437, 448, 517, 523, 607, 611, 761, 764 Mahony, R. E., 523Maka, S., 448Mallavarapu, K., 219, 232Malthus, Thomas, 103 Manned submersible, 271 Mansor, H., 645, 648Mapping contour, 551 ‚Äì552 Mapping only positive jœâ-axis, stability via, 562 ‚Äì563 Margaris, N. I., 379Marginally stable systems, 301Marginal stability, 300Martin, R. H., Jr., 31 Martinez, D., 112, 155, 232, 296, 333, 379, 447, 523, 610, 647, 704, 764 Marttinen, A., 103, 113, 328, 333, 604, 611 Marumo, Y., 448Mason, S. J., 251, 297Mason ‚Äôs rule: multiple subsystems and, 251 ‚Äì253 transfer function via, 252 ‚Äì253 Mass, 61, 62, 64 damper and, 123 Master controller, 329Matching coef Ô¨Åcients: controller design by, 661 ‚Äì662 observer design by, 677, 681 ‚Äì683 Math ematical models, 16 ‚Äì17 from physical system schematics, 34 MathWorks Inc., 19MATLAB program, 19 ‚Äì20 command summary for, 814 ‚Äì817 design via frequency response with, 801 ‚Äì805 design via root locus with, 791 ‚Äì796 design via state space with, 805‚Äì 808 digital control systems with, 809 ‚Äì814 examples, 772 ‚Äì814 frequency domain modeling with, 772 ‚Äì776 frequency response techniques with, 796 ‚Äì801 M-Ô¨Åles with, 771 multiple subsystems with, 782 ‚Äì787 root locus with, 789 ‚Äì790 stability with, 787 ‚Äì788 steady-state errors with, 788 ‚Äì789 time domain modeling with, 776 ‚Äì779 time response with, 779 ‚Äì782 using, 771 ‚Äì772 MATLAB Simulink program, SeeSimulink program (MATLAB)906 Index3GBINDEX 10/14/2014 11:56:24 Matrices: companion, 262 controllability, 659 ‚Äì661 identity, 136observability, 674 ‚Äì677 state-transition, 198 ‚Äì199, 201 ‚Äì202 system, 267, 269 ‚Äì270 transformation, 266, 267, 269 ‚Äì271 vector-matrix form, 125 Maximum power point tracking (MPPT) system, 25, 26Maxwell, James Clerk, 5Mayr, O., 4n, 31McKerrow, P. J., 225, 232McRuer, D., 218, 232Mechanical brake response, electric vehicle, 219 ‚Äì220 Mechanical constants, 80Mechanical displacement, 61 ‚Äì62 Mechanical system: into parallel analog, 86into series analog, 84 ‚Äì85 Mechanical system transfer functions: rotational, 69 ‚Äì73 translational, 61 ‚Äì68 Meier, R., 23, 31MEMS, SeeMicro Electromechanical System Mengxiao, W., 232Mesh, 48Mesh analysis: complex circuits via, 51 ‚Äì53 single loop via, 48 ‚Äì50 Mesh equations, via inspection, 56 ‚Äì57 Metalforming, exact shapes in, 760Metering pumps, 517 Meyer, A. U., 113 M-Ô¨Åles, with MATLAB program, 771 Miao, Y., 648Michaelis-Menten equations, 102Micro Electromechanical System (MEMS), 216Micro Optical Electromechanical Systems (MOEMS), 216Milhorn, H. T., Jr., 681, 704Milsum, 1966, 94 Minnichelli, R. J., 328, 334 Minor loop, 487, 488Minor-loop feedback compensation, 492 ‚Äì494 root locus for, 493step response simulation for, 494 Minorsky, N., 5, 113Misra, V., 379, 447, 610, 648Missile control system: modeling of, 727 ‚Äì729 stability of, 727 ‚Äì729 Missile steering control, 148Mitchell, R. J., 374, 375n, 379Mo, J., 764 Models, in MATLAB Simulink program, 824 MOEMS, SeeMicro Optical Electromechanical Systems Mohseni, K., 113Moment of inertia, 69Moored Ô¨Çoating platforms, 25 Motion control, 375 ‚Äì376 Motion equations, 62 ‚Äì63, 70 ‚Äì71 for gear systems, 75 by inspection, 67 ‚Äì68, 71 ‚Äì72 Motor(s): dc, 78, 80 ‚Äì82 explanation of, 78 ‚Äì79 load and, 81 ‚Äì82,93, 141 ‚Äì143 transfer functions and, 93 Motorcycle radio volume, 23 Motor-driven inverted pendulum cart system, 151 ‚Äì152, 220‚Äì221, 328, 511 ‚Äì512, 701, 758 Motor drive system, 220Motor transfer function, electrical constants of, 81Motor trunk patterns, low back pain and, 217Mott, C., 24, 31MPPT system, SeeMaximum power point tracking system Multiple loops, 51 ‚Äì53 Multiple nodes, 54 with current sources, 55 Multiple root of multiplicity, 40Multiple subsystems. See also Subsystems analysis and design of feedback systems, 245 ‚Äì248 in antenna control system, 272 ‚Äì275 background on, 236block diagrams of, 236 ‚Äì245 cascade form of, 237 ‚Äì239, 264 feedback form of, 240 ‚Äì241 Mason ‚Äôs rule, 251 ‚Äì253 with MATLAB program, 782 ‚Äì787 moving blocks to create familiar forms, 241 ‚Äì245 parallel form of, 239signal-Ô¨Çow graphs of, 248 ‚Äì251 signal-Ô¨Çow graphs of state equations and, 254 ‚Äì256 similarity transformations, 265 ‚Äì271 in space shuttle, 237state-space representations of, 256 ‚Äì265 in UFSS vehicle, 275 ‚Äì277 Multiplicity, 40Mu√±oz-Mansilla, R., 25, 31Murakami, T., 375n, 379Muscle contraction, 104MyDAQ, 110 ‚Äì112, 226 ‚Äì230, 441, 443, 444 NNaÔ¨Åon sheet, 219 Nagle, H. T., 232, 764Index 9073GBINDEX 10/14/2014 11:56:24 Nakamura, M., 217, 232 Nano-positioning device, 217 NASA Ô¨Çight simulator robot arm, 78 Nashner, L. M., 216, 232National Instruments PXI, 526Natural frequency: damping ratio and, 203 ‚Äì204 of general second-order system, 169, 171 Natural period, 169 ‚Äì170 Natural response, 10 of general second-order system, 167, 168poles and, 158, 160 Naval Research Laboratory, 205n-channel enhancement-mode MOSFET Source Follower circuit, 286 Neamen, D. A., 286, 297Negative feedback, 240n Negative-feedback systems, 413, 414 Negative step response, of pitch control, 207Neogi, B., 760, 764Network theory, 124Neuroprostheses, 215Newbury, K., 232Newton ‚Äôs laws, 16, 62 Nichols charts, 577 ‚Äì578 lag-lead compensation design using, 635 ‚Äì637 Nieuwland, J., 31Nilsson, J. W., 35, 113, 528, 611NI myDAQ, 875 ‚Äì878 Noah, J., 611Nodal analysis: complex circuits via, 53 ‚Äì55 simple circuits via, 50 Nodal equations: form of, 56method to write, 53 ‚Äì55 Node(s): multiple, 54, 55of signal-Ô¨Ç ow graphs, 248 ‚Äì249 single, 50 No integration systems, steady-state error for, 343 No-load speed, 81 Noninverting operational ampli Ô¨Åer, 59 ‚Äì61, 286 circuit, 60schematic, 59 Nonlinear electrical network, 90 ‚Äì91 Nonlinearities, 86 ‚Äì87 physical, 87time response and, 192 ‚Äì194 Nonlinear systems, 86 ‚Äì87 representation of, 139 ‚Äì140 translational mechanical, 140 Nonminimum-phase electric circuit, 188Nonminimum-phase system: step responses of, 188, 190transfer function of, 188 ‚Äì190 Nontouching loop gain, 251 ‚Äì252 Nontouching loops, 251 ‚Äì252 Nonunity feedback systems: steady-state actuating signal for, 356 ‚Äì357 steady-state errors for, 353 ‚Äì356 Noor, S. B. M., 648 Norton ‚Äôs theorem, 54 Notch Ô¨Ålter, 484 ‚Äì486 Nounou, H., 610, 648 Nounou, M., 610, 648 Novo sad, J. P., 31 nsimultaneous, Ô¨Årst-order differential equations, 117 nth-order differential equations: converted to nsimultaneous Ô¨Årst-order differential equations, 117 explanation of, 16 Nyawako, D., 435, 448Nygaard, G., 31Nyquist, H., 5, 31, 611Nyquist criterion, 550 ‚Äì555 derivation of, 551 ‚Äì554 range of gain for stability via, 561 ‚Äì562 stability determination with, 554 ‚Äì555 Nyquist diagram: gain margin/phase margin via, 564 ‚Äì566 for open-loop function, 558 ‚Äì559 sketching, 555 ‚Äì560 stability via, 560 ‚Äì564 Nyquist sampling rate, 710Nyzen, R. J., 448, 764 O Observability, 674 ‚Äì677 by inspection, 674via observability matrix, 675 ‚Äì676 Observability matrix, 674 ‚Äì677 observability via, 675 ‚Äì676 unobservability via, 676 ‚Äì677 Observable systems, 674Observer, 667Observer canonical form: observer design for, 671 ‚Äì673 of state space, 261 ‚Äì265 Observer design, 667 ‚Äì674 alternative approaches, 677 ‚Äì684 antenna control and, 688 ‚Äì693 by matching coef Ô¨Åcients, 677, 681 ‚Äì683 for observer canonical form, 671 ‚Äì673 by transformation, 677 ‚Äì681 Octave, 533908 Index3GBINDEX 10/14/2014 11:56:25 Ogata, K., 31, 113, 232, 523, 611, 619, 648, 659n, 662n, 675n, 704, 710n, 734n, 743n, 759, 764 Ohnishi, K., 375n, 376, 379 Oil cylinder valve, 151Oil drilling rigs, 26 ‚Äì27 Okun ‚Äôs law, 330, 331 OMS, SeeOrbital maneuvering system One integration systems, steady-state error for, 344Open-loop frequency responses: closed-loop transient responses and, 578 ‚Äì582 relation between closed-loop and, 573 ‚Äì578 response speed from, 580 ‚Äì582 Open-loop function, Nyquist diagram for, 558 ‚Äì559 Open-loop pitch response, UFSS and, 205 ‚Äì207 Open-loop poles, 392 ‚Äì393, 430 Open-loop response, antenna control and, 202 ‚Äì205 Open-loop sinusoidal frequency analysis and design, with LabVIEW program, 862 ‚Äì865 Open-loop step response, with LabVIEW program, 853‚Äì859 Open-loop swivel controller, 376Open-loop systems, 7Open-loop transfer function, 217, 241Operational ampli Ô¨Åers, 57 ‚Äì61, 188 ‚Äì189, 286 Optical disk recording system, 6 Orbital maneuvering system (OMS), 6 Oscillations: damped, 13, 169damped frequency of, 166undamped sinusoidal, 208 O‚ÄôSullivan, D. M., 233, 705 Oustaloup ‚Äôs method, 218 Output, 2 Output engine fan speed, 327 Output equation, 117 ‚Äì121 Output potentiometer, 92 ‚Äì93 Output response, 158Output transducer, 8Overdamped behavior, 208Overdamped response, 165 ‚Äì167 Overhead crane system, 604 Overshoot, 174, 402, 408, 589 ‚Äì590. See also Percent overshoot √ñzel, T., 516, 523 √ñzg√ºner, √ú., 330, 334, 448 P Pacemakers, arti Ô¨Åcial, 760 Packet information Ô¨Çow, 376 Pad√© approximation, 330, 433Paint mixing, 105Palazoglu, A., 513n, 524Papadopoulos, K. G., 375, 379Papastefanaki, E. N., 379 Papin, Denis, 4 Parabolic inputs: in control system design, 17, 18steady-state error and, 336, 337, 342 ‚Äì343 unit, 735 Parabolic trough collector problem, 29, 106 ‚Äì107, 153, 222, 294, 332, 377, 438, 519, 608, 646, 702, 762 Parallel analog, 85 ‚Äì86 development of, 85 mechanical system converted into, 86param eters for, 85 Parallel form: of multiple subsystems, 239of state space, 258 ‚Äì260, 264 Parallel hybrid-electric vehicle, 28Parallel subsystems, 239 Park, J.-Y., 610 Park, Y.-P., 610Parkinson ‚Äôs disease, 437 Partial-fraction expansion, 37 ‚Äì44 inverse z-transform via, 717 ‚Äì718 Particular solutions, 10, 162nPassive-circuit realization, 497 ‚Äì499 PD controllers, SeeProportional-plus-derivative controllers Peak time, 173 evaluation of, 175lines of constant, 178from pole location, 178 ‚Äì180 from transfer function, 177 Pendulum: inverted pendulum cart system, 151 ‚Äì152, 220 ‚Äì221, 328, 511‚Äì512, 701, 758 simple, 139 Percent overshoot, 174 evaluation of, 175 ‚Äì176 lines of constant, 178from pole location, 178 ‚Äì180 for time delay systems, 589 ‚Äì590 from transfer function, 177v. damping ratio, 176 P√©rez L√≥pez, O., 650n, 699n, 704Performance, 2Peters, S., 30PÔ¨Çeiderer, H. J., 156, 704 Pharmaceutical drug absorption, 143 ‚Äì145 Pharmaceutical drug-level concentrations, 143Phase frequency response, 528Phase margin: from Bode plots, 569damping ratio from, 579 ‚Äì580 evaluating, 568via Nyquist diagram, 564 ‚Äì566Index 9093GBINDEX 10/14/2014 11:56:25 Phase shift oscillator, 333 Phase-variable form, state space in, 256, 264 Phase-variable representation: controller design for, 655 ‚Äì657 for plant, 652, 653 Phase variables, 133 block diagram of, 132choice, 133 Phasors, 527 Philco Technological Center, 156 Phillips, C. L., 232, 648, 764Philon of Byzantium, 4Photovoltaic system, 25 ‚Äì26, 104, 151 pH processes, modeling/control of, 218 ‚Äì219 Phugoid mode, 218Physical system: mathematical models from schematics of, 34 transform requirements into, 14 ‚Äì15 Piccin, O., 288, 297 Pickoff points, 236Pic√≥, J., 156, 704PI controllers, SeeProportional-plus-integral controllers PID control, 375PID controllers, SeeProportional-plus-integral-plus- derivative controllers Piecewise linear systems, 102Pinette, B., 149n, 156Pitch angle control representation, in UFSS, 275 ‚Äì277, 285 Pitch control loop: with rate feedback, 421root locus of, 419for UFSS vehicle, 205 without rate feedback, 420 Pitch control system, negative step response of, 207 Pitch gain, 322Planetary gear systems, 220Plant, 2, 7 phase-variable representation for, 652, 653pole placement for, 653 ‚Äì658 state-space representation of, 651 ‚Äì652 with state-variable feedback, 689 ‚Äì690 Plots, in MATLAB Simulink program, 824. See also speci Ô¨Åc types of plots Polar plot, 576nPole(s), 158 eigenvalues and, 195 ‚Äì198 evaluating response with, 161ofÔ¨Årst-order system, 159 ‚Äì161 of transfer function, 159underdamped response using, 166 Pole distribution, via Routh table with row of zeros, 309‚Äì310Pole location: peak time from, 178 ‚Äì180 percent overshoot from, 178 ‚Äì180 for plant, 653 ‚Äì658 for root locus, 387settling time from, 178 ‚Äì180 topology for, 651 ‚Äì653 Pole plot, for underdamped second-order system, 178 Pole sensitivity, root locus and, 415 ‚Äì417 Pole-zero plot, 160Popa, D., 216n, 231Position constant, 582 ‚Äì583 Position control system, 11, 34 antenna azimuth, 11 ‚Äì14, 203 response of, 13with speci Ô¨Åed overshoot and settling time, 514 ‚Äì515 tachometer as, 487 Position error constant, 345Posit ive feedback, 240n Positive-feedback systems, root locus for, 413 ‚Äì415 Postural arm re Ô¨Çexes, 287 ‚Äì288 Potentiometer, 8, 22 ‚Äì23 input, 92 ‚Äì93 output, 92 ‚Äì93 Pounds, P. E. I., 330, 334, 516, 523Powell, J. D., 30, 113, 156, 232, 610, 704Power ampli Ô¨Åer, 93, 141 Power series method, inverse z-transform via, 718 ‚Äì719 Prasad, L., 151, 152n, 156, 220, 233, 328, 334, 511, 524, 701, 704, 758, 764 Preampli Ô¨Åer, 93 Precision grip dynamics, 150 Preitl, Z., 153, 156, 293, 297, 334, 377, 380, 448, 518, 524, 608, 611, 646, 648, 702, 704, 761, 765 Prewarping, 743 Process control industry, 5Processes (plants), 2, 7Prochazka, A., 233Proportional control system, 453Proportional-plus-derivative (PD) controllers, 463 Proportional-plus-integral (PI) controllers, 453, 457 Proportional-plus-integral-plus-derivative (PID) controllers, 5 characteristics of, 476design, 475 ‚Äì479 implementing, 497root locus for, 476 Pulse transfer function: derivation of, 720 ‚Äì721 of feedback system, 724 ‚Äì725 Pupil dilation, 24Pythagorean theorem, 178910 Index3GBINDEX 10/14/2014 11:56:26 Q Qian, H., 334, 611 Qu, S.-G., 151, 156Qualitative analysis and design, 158Qualitative method, 158Quantization error, 710 R Radial pickup position control, of DVD player, 515 ‚Äì516, 605, 759 Radiator power control, 604Raible ‚Äôs tabular method, 729 RAM, SeeRandom-access memory Ramon, H., 448Ramp inputs: in control system design, 17, 18sensitivity of steady-state error with, 358 steady-state error and, 336 ‚Äì338, 342 unit, 735 Ramp response error, for lag-lead compensator, 483 Random-access memory (RAM), 349Random early detection (RED) algorithm, 431, 605, 643Range of gain for stability: for time delay systems, 588 ‚Äì589 via Bode plots, 567 ‚Äì568 via Nyquist criterion, 561 ‚Äì562 Range of sampling interval, for stability, 729 ‚Äì730 Rate feedback, compensating zero via, 489 ‚Äì491 Raven, F. H., 64, 113, 648Reaction control system (RCS), 6Read/write head displacement, 328Real-axis breakaway, root locus sketching and, 395 ‚Äì399 Real-axis break-in points, root locus sketching and, 395‚Äì399 Real-axis pole, transient response and, 160Real-axis segments, root locus sketching and, 391Realization: active-circuit, 495 ‚Äì497 of lag-lead compensator, 501 ‚Äì502 passive-circuit, 497 ‚Äì499 Reciprocal, of time constant, 163 RED algorithm, SeeRandom early detection algorithm Reference, 7 Reference input, 34Reidel, S. A., 113Reinoso, A. J., 25n, 31Reiser, M. B., 611Remote-controlled robot, 3Ren, Z., 220, 233 Residues, 190 ‚Äì191 Resistance(s), 49 armature, 80 running, 106Resistor, 49 Response speed, from open-loop frequency response, 580‚Äì582 Retinal light Ô¨Çux, 433 Reverse coefÔ¨Å cients, stability via, 307 Reynolds, P., 448 Richon, J.-B., 434n, 447Riegelman, S., 156Ringdorfer, M., 219, 233 Riseman, E. M., 149n Rise time, 163, 173 evaluation of, 176 ‚Äì178 from transfer function, 176 ‚Äì177 v. damping ratio, 177 Robotic manipulator, 376 with cascade PI controller, 433harmonic drives with, 435 ‚Äì436 target environment and, 149 Robots, 3 asparagus-picking, 212assembly-line, 349FANUC M-410iB, 321hospital pharmacy, 650input commands to, 183leg of, 139 ‚Äì140 remote-controlled, 3with television imaging systems, 148 ‚Äì149 walking, 139 Robust design, 10 ‚Äì11 Rockwell International, 6, 8, 10, 31, 667, 704Roll- stabilizing system, ship, 605 Romagnoli, J. A., 512, 513n, 524Room temperature control, 512 Root locus, 5 for antenna control, 417 ‚Äì419 for compensated system, 456 with compensator, 454control problem for, 382 ‚Äì383 deÔ¨Ånition of, 382, 386 ‚Äì388 frequency response design methods and, 614from general control system, 388 generalized, 411 ‚Äì412 for ideal derivative compensation, 466, 468 lag compensation and, 459for lag-lead compensator, 480 ‚Äì482 with MATLAB program, 789 ‚Äì790 for minor-loop feedback compensation, 493for notch Ô¨Ålter, 484 ‚Äì485 for PID controllers, 476 of pitch control loop, 419 plotting/calibrating, 402 ‚Äì403 pole location for, 387pole plot for, 387Index 9113GBINDEX 10/14/2014 11:56:27 Root locus ( Continued ) pole sensitivity and, 415 ‚Äì417 for positive-feedback systems, 413 ‚Äì415 properties of, 388 ‚Äì390 sample, 450 for security camera system, 386starting/ending points and, 391 ‚Äì392 UFSS and, 419 ‚Äì421 for uncompensated system, 456 vector representation of complex numbers and, 383 ‚Äì385 without compensator, 454 Root locus design methods: for antenna control system, 500 ‚Äì503 cascade compensation, 453 ‚Äì474 compensation con Ô¨Ågurations for, 452 with compensators, 452 ‚Äì453 with feedback compensation, 487 ‚Äì495 improving steady-state error with, 451‚Äì 462, 474 ‚Äì486 improving transient response with, 450 ‚Äì451, 462 ‚Äì486 with LabVIEW program, 862 lag-lead compensator design, 479 ‚Äì484 with MATLAB, 791 ‚Äì796 notch Ô¨Ålters, 484 ‚Äì486 physical realization of compensation, 495 ‚Äì499 PID controller design, 475 ‚Äì479 for UFSS vehicle, 503 ‚Äì504 Root locus sketching: angles of departure/arrival in, 400 ‚Äì402 with asymptotes, 393 ‚Äì395 behavior at in Ô¨Ånity, 392 ‚Äì395 branches and, 391critical points and, 405 ‚Äì406 example of, 404 ‚Äì407 jœâ-axis crossings and, 399 ‚Äì400 real-axis breakaway and, 395 ‚Äì399 real-axis break-in points and, 395 ‚Äì399 real-axis segments and, 391reÔ¨Åning, 395 ‚Äì403 rules for, 390‚Äì395, 404 symmetry and, 391transient response design via gain adjustment from, 407‚Äì411 Root sensitivity, of closed-loop system, 416 ‚Äì417 Roots of denominator of F(s): complex or imaginary, 41 ‚Äì44 real and distinct, 38 ‚Äì40 real and repeated, 40 ‚Äì41 Rotational mechanical impedances, 75Rotational mechanical load, DC motor driving, 80 Rotational mechanical system transfer functions, 69 ‚Äì73 Rotational systems: degrees of freedom in, 69 driven by gears, 74 ‚Äì75Roth, E., 607, 611 Rotor, 78 Routh, E. J., 5, 334Routh-Hurwitz criterion, 303 ‚Äì305 digital system stability via, 732examples of, 311 ‚Äì318 factoring via, 317special cases of, 305 ‚Äì311 stability via, 316 ‚Äì317 with zero in Ô¨Årst column, 312 ‚Äì313 Routh table: generating, 303 ‚Äì305 interpreting, 305pole distribution via, 309 ‚Äì310 with row of zeros, 309 ‚Äì310, 314 ‚Äì315 stability via, 308zero in, 305 ‚Äì311 Rover ,3 Rubio, F. R., 112, 155, 232, 296, 333, 379, 447, 523, 610, 647, 704, 764 Running resistances, 106 S Saeys, W., 435, 448Safety valve, 4 Saini, S. C., 700, 701n, 704 Salapaka, M. V., 233Salapaka, S., 217, 233Salminen, R. T., 103n, 113, 333, 611Sampled-data systems. See also Digital control systems block diagram reduction of, 724 ‚Äì725 transfer functions and, 719 ‚Äì723 z-transform and, 723 Sampler, modeling, 712 ‚Äì713 Sarcomere, 287Sarpeshkar, R., 447Satija, U., 701n, 704Saturation, ampli Ô¨Åer,SeeAmpli Ô¨Åer saturation Saturation nonlinearity, with MATLAB Simulink program, 830‚Äì831 Savant, C. J., Jr., 30, 297, 333, 379, 523, 610, 648, 704 Savaresi, S. M., 523, 610, 764 Sawusch, M. R., 233 Schema tics: contr ol system, 15 gear system, 73global carbon cycle, 151inverting operational ampli Ô¨Åer, 58 mathematical models from, 34 noninverting operational ampli Ô¨Åer, 59 Schierman, J. D., 327 Schiop, L., 105, 113Schneider, R. T., 376, 380912 Index3GBINDEX 10/14/2014 11:56:27 Schnell, 2004, 102 Schouten, A. C., 296 Sebastian, A., 233Second-order responses: damping ratio and, 171 Second-order step responses: approximation, 191components of, 166 Second-order systems, 164 ‚Äì172 damping ratio of, 169 ‚Äì172 natural frequency of, 169step responses for damping, 168 Second-order transfer functions via testing, 181 ‚Äì182 Second-order underdamped responses: for damping ratio values, 174speciÔ¨Åcations, 173 ‚Äì174 Second-order underdamped systems, step responses of, 178 ‚Äì179 Security camera system, root locus for, 386Seering, W. P., 156, 232, 297, 334Segway personal transporter, 24Self-balancing bicycle, 607Sensitivity: of closed-loop transfer function, 357steady-state errors and, 356 ‚Äì359 of steady-state error with ramp input, 358of steady-state error with step input, 358 Sensitivity analysis, 18Sensor, 8Serial hybrid-electric vehicle, 28Series analog, 83 ‚Äì85 Series RLC electrical network, 49Settling time, 163, 174 lines of constant, 178from pole location, 180from transfer function, 176, 177 Severyanova, L. A., 156, 704Shahin, M., 437, 448Shao, M., 156Sharma, Y., 701n, 704Shaw, D. A., 31 Shibata, M., 375n, 379 Shinners, S. M., 704Ship: roll axis, 207roll-stabilizing system of, 605stability, 5steering, 5 Shortening muscle velocity, 287 Short period mode, 218 Short takeoff and landing (STOL) Ô¨Åghter aircraft, 327 Signal- Ô¨Çow graphs: components of, 248 ‚Äì249converting block diagrams to, 249 ‚Äì250 development stages of, 254 ‚Äì255 of multiple subsystems, 248 ‚Äì251 of state equations, 254 ‚Äì256 Signals, in MATLAB Simulink program, 821, 823Similarity transformations: of multiple subsystems, 265 ‚Äì271 on state equations, 266 ‚Äì267 Similar systems, 265, 271 Simple circuits: via nodal analysis, 50 via voltage division, 51 Simple pendulum, 139Simulation palette, in LabVIEW program, 871 ‚Äì872 Simulation parameters, in MATLAB Simulink program, 824 Simulations: with LabVIEW program, 850 ‚Äì851 in MATLAB Simulink program, 824 Simulink program (MATLAB), 19, 186, 192 ‚Äì194, 219, 247, 742 accessing, 819 ‚Äì821 assembling and labeling subsystems in, 821block libraries, 822 ‚Äì823 digital control systems with, 833 ‚Äì835 examples, 824 ‚Äì835 feedback systems with, 832 ‚Äì833 interacti ng with plots, 824 interconnecting subsystems and labeling signals, 821, 823 linear system simulation with, 824 ‚Äì829 saturation nonlinearity with, 830 ‚Äì831 saving models in, 824 selecting blocks in, 821 simulation parameters in, 824starting simulations, 824subsystem parameters in, 823, 824using, 819 ‚Äì824 Single loop: via differential equation, 48via mesh analysis, 48 ‚Äì50 via transform methods, 50 Single node, 50Single-pole oil cylinder valve, 151Sinha, N. K., 704Sinusoidal frequency analysis, 5Sinusoidal inputs, 17, 18SISO Design Tool, 19SISO systems, Ô¨Åxed structure controllers for, 607 ‚Äì608, 645 Sivan, R., 297Skeletal muscle voltage potential, 218Slave controller, 329Smith, C. A., 513, 524, 644, 648Index 9133GBINDEX 10/14/2014 11:56:28 Smith, C. L., 765 Smoother, block diagram, 430 Soleimani-Mosheni, M., 524, 611Solenoid coil circuit, 285 ‚Äì286 Solomonow, M., 233Son, M., 648Source shaft, 77Space shuttle, 6 main engine controller, 8 multiple subsystems in, 237 Speed control, 4 Sperry Gyroscope Company, 5s-plane: cascade compensation via, 742 ‚Äì746 digital system stability via, 731 ‚Äì733 mapping of, onto z-plane, 727 Split-power hybrid-electric vehicle, 28 Spong, M., 380, 435, 436n, 448 Spring constant, 61, 69Springs, translational relationships for, 62Spruijt, J. N., 233, 705Squid jet locomotion, 104Stability, 10 for antenna control system, 321 ‚Äì322 closed-loop poles/response in, 301 ‚Äì303 deÔ¨Ånition of, 300 ‚Äì301 determining, 566 ‚Äì567 digital system, 726 ‚Äì733 evaluation of, 301 ‚Äì303 with MATLAB program, 787 ‚Äì788 Maxwell ‚Äôs criterion of, 5 of missile control system, 727 ‚Äì729 range of sampling interval for, 729 ‚Äì730 Routh-Hurwitz criterion of, 303 ‚Äì318 in state space, 318 ‚Äì321 transient response design via gain adjustment and, 614in UFSS vehicle, 322 ‚Äì323 via epsilon method, 306via mapping only positive jœâ-axis, 562 ‚Äì563 via Nyquist diagram, 560 ‚Äì564 via reverse coef Ô¨Åcients, 307 via Routh table, 308 Stability design: antenna control and, 595 ‚Äì596 via gain, 321 ‚Äì323 via root locus, 739 ‚Äì740 Stabilization, control systems for, 5Stable systems, steady-state error and, 337Stall torque, 81 Stapleton, C. A., 436, 448 State, 118State equations, 117, 120 ‚Äì122 Laplace transform solution of, 194 ‚Äì198signal-Ô¨Çow graphs of, 254 ‚Äì256 similarity transformations on, 266 ‚Äì267 time domai n solution of, 198 ‚Äì202 State-feedback design, 667State space, 121 alternative representations in, 256 ‚Äì265 cascade form of, 257 ‚Äì259, 265 controller canonical form of, 260 ‚Äì261, 265 diagonalizing system in, 269 ‚Äì270 graphic representation of, 121observer canonical form of, 261 ‚Äì265 parallel form of, 258 ‚Äì260, 264 phase-variable form of, 256, 264stability in, 318 ‚Äì321 from transfer function, 130 ‚Äì136 transfer function from, 136 ‚Äì138 State-space design methods: for antenna control, 688 ‚Äì693 controllability in, 658 ‚Äì661 controller design, 651 ‚Äì658, 661 ‚Äì667 with MATLAB program, 805 ‚Äì808 observability in, 674 ‚Äì677 observer design, 667 ‚Äì674, 677 ‚Äì684 steady-state error design via integral control, 684 ‚Äì687 v. domain design methods, 650 ‚Äì651 State-space representation, 16, 117 advantages of, 116antenna control and, 141 ‚Äì143 application of, 122 ‚Äì129 computer simulation and, 146of electrical networks, 116 ‚Äì120 of feedback systems, 263 ‚Äì264 general, 120 ‚Äì122 linearization and, 138 ‚Äì140 of plant, 651 ‚Äì652 to transfer function, 137 ‚Äì138 State-transition matrix, 198 ‚Äì199 Laplace transform of, 198 ‚Äì199 via Laplace transform, 201 ‚Äì202 State-variable feedback, plant with, 689 ‚Äì690 State variables, 117, 121 linearly independent, 121 ‚Äì122 minim um number of, 122 ‚Äì123 State vector, 121Static error constants, 345 ‚Äì347, 458 from Bode plots, 585 ‚Äì586 steady-state error via, 346 ‚Äì347 Steady-state actuating signal, for nonunity feedback systems, 356 ‚Äì357 Steady-state error design: via cascade compensation, 614via integral control, 684 ‚Äì687 Steady-state errors, 2, 13 ‚Äì14, 18. See also Errors914 Index3GBINDEX 10/14/2014 11:56:29 antenna control and, 362 ‚Äì363 assembly-line robots and, 349 deÔ¨Ånition of, 336 digital control systems and, 733 ‚Äì737 digital feedback control system for, 734for disturbances, 351 ‚Äì353 evaluating, 337 ‚Äì338 Ô¨Ånding, 736from frequency response, 582 ‚Äì586 improving, 451 ‚Äì452, 474 ‚Äì486 with MATLAB program, 788 ‚Äì789 for no integration systems, 343for nonunity feedback systems, 353 ‚Äì356 for one integration systems, 344parabola input and, 336, 337parabolic input and, 342 ‚Äì343 ramp input and, 336 ‚Äì338, 342 sensitivity of, 356 ‚Äì359 sources of, 338 ‚Äì339 speciÔ¨Åcations, 348 ‚Äì351 stable systems and, 337from step disturbances, 352step input and, 336 ‚Äì338, 341 ‚Äì342 for systems in state space, 359 ‚Äì362 system type and, 347 ‚Äì348 in terms of G(s), 340 ‚Äì344 in terms of T(s), 339 ‚Äì340 test inputs, 336 ‚Äì337 test waveforms for, 336transient response, 18, 474 ‚Äì486 for unity feedback systems, 339 ‚Äì344 using Ô¨Ånal value theorem, 359 ‚Äì360 using input substitution, 361 ‚Äì362 via cascade compensation, 453 ‚Äì462 via static error constants, 346 ‚Äì347 video laser disc recorder and, 363 ‚Äì365 Steady-state response, 9, 10n, 162nSteam-driven power generators, 329 ‚Äì330, 515, 606 ‚Äì607 Steam-driven turbine governor system, 759Steam press ure control, 4 Steel production, continuous casting in, 289 Steering: active front steering, 644 for four-wheel drive vehicle, 374history of control systems for, 5missile steering control, 148vehicle steering control model, 374, 430, 644 Steering angle, bicycle, 430Stefani, R. T., 30, 215, 233, 297, 333, 379, 523, 610, 648, 704 Steinbuch, M., 611Step disturbances, steady-state errors from, 352Step inputs:in control system design, 17, 18 sensitivity of steady-state error with, 358 steady-state error and, 336 ‚Äì338, 341 ‚Äì342 unit, 162, 734 ‚Äì735 Step responses: computer simulation of, 420of gain-adjusted antenna control system, 418for minor-loop feedback compensation, 494of nonminimum-phase network, 190 of nonminimum-phase system, 188 of pitch control loop without rate feedback, 420of pitch control loop with rate feedback, 421for second-order system damping cases, 168of second-order underdamped systems, 178 ‚Äì179 of three-pole systems, 185 ‚Äì186 for transfer functions, 185 ‚Äì186 STOL Ô¨Åghter aircraft, SeeShort takeoff and landing Ô¨Åghter aircraft s-transform, table of, 716 Strobel, K. L., 232Submarine autopilot, 150Subsystem parameters, in MATLAB Simulink program, 823, 824 Subsystems. See also Multiple subsystems deÔ¨Ånition of, 2 in MATLAB Simulink program, 821, 823 Summers, T. A., 233Summing: admittances, 55, 85impedances, 55, 57junctions, 7, 236, 241torques of pendulum, 139voltages, 57 Sun, J., 644, 648Sun, M., 219, 233Superposition, 86Susceptance, 54nSuspension, active, 286 ‚Äì287, 373 Svensson, J., 432n, 447, 523Sweet, L. M., 232Symbolic Math Toolbox, 19 Symbols list, 767 ‚Äì770 Symmetry, root locus sketching and, 391 System matrix, diagonalizing a, 267System representation, 34 ‚Äì35 System response, 158 with additional poles, 182 ‚Äì186 from transfer function, 46with zeros, 186 ‚Äì191 Systems in state space, steady-state errors for, 359 ‚Äì362 System step response test, laboratory results of, 164System type, steady-state errors and, 347 ‚Äì348 System variables, 121Index 9153GBINDEX 10/14/2014 11:56:29 T T(s), steady-state error as, 339 ‚Äì340 Tabular method (Raible), 729 Tachometer: as position control system, 487transfer function of, 488 Tactile feedback suit, 24 ‚Äì25 Tadeo, F., 650n, 699, 704Taip, F. S., 648 Tan, X., 149n, 156 Taplamacioglu, M. C., 232, 297, 333Tarafdar, U., 764Target environment, robotic manipulator and, 149Tar√≠n, C., 149, 156, 699, 704Tasch, U., 287, 297, 643, 648, 759, 765Taylor series, 89, 90, 138TCP/IP network model, 605, 643 Television imaging system, robot with, 148 ‚Äì149 Temperature control system, 4, 23 Testing: Ô¨Årst-order transfer functions via, 163 ‚Äì164 hypersonic Ô¨Çight, 517 second-order transfer functions via, 181 ‚Äì182 Test inputs, for steady-state error, 336 ‚Äì337 Test waveforms, 18 for steady-state error, 336 Teufel, E., 156, 704Textile cross-lapper machine, 374Textile machine, 701Thermistor, 8Thermostat, 6Third-order observer, 669Third-order system gain design, 408 ‚Äì411 Thomas, B., 329, 512, 524, 604, 611Thomsen, S., 220, 233, 290, 331, 334, 448, 518, 524, 607, 611, 701, 705 Three-loop electrical network, 56Three-mode controllers, SeeProportional-plus-integral- plus-derivative (PID) controllers Three-phase ac/dc converter, 104, 291Three-pole systems: comparing responses of, 185 ‚Äì186 component responses of, 183 ‚Äì184 step responses of, 185 ‚Äì186 Time constant, 162 ‚Äì163 exponential, 169 ‚Äì170 reciprocal of, 163 Time delay systems, 586 ‚Äì590 frequency response plots of, 587 ‚Äì588 percent overshoot for, 589 ‚Äì590 range of gain for stability for, 588 ‚Äì589 Time-domain modeling: antenna control system, 141 ‚Äì143applications of state-space representation, 122 ‚Äì129 converting state space to transfer functions, 136 ‚Äì138 converting transfer functions to state space, 130 ‚Äì136 general state-space representation, 120 ‚Äì122 with linearization, 138 ‚Äì140 with MATLAB program, 776 ‚Äì779 pharmaceutical drug absorption, 143 ‚Äì145 of state equations, 198 ‚Äì202 state-space representations of electrical networks, 116‚Äì120 v.freque ncy-domain modeling, 116 Time function: Laplace transform of, 35 ‚Äì36 z-transform of, 715 ‚Äì716 Time response: with additional poles, 182 ‚Äì186 for antenna control system, 202 ‚Äì205 inÔ¨Årst-order systems, 162 ‚Äì164 general second-order system, 169 ‚Äì172 Laplace transform solutions of state equations, 194 ‚Äì198 with MATLAB program, 779 ‚Äì782 nonlinearities and, 192 ‚Äì194 overview of, 158overview of second-order systems, 164 ‚Äì165 poles/zeros and, 158 ‚Äì161 second-order systems with zeros, 186 ‚Äì191 time domain solution of state equations, 198 ‚Äì202 for UFSS vehicle, 205 ‚Äì207 in underdamped second-order systems, 173 ‚Äì182 Time-varying systems, 116Timothy, L. K., 156, 233, 297, 334, 705Titanic , 271 Top-down design, 21 Torque, of motor, 79 Torque-angular displacement, 69Torque-angular velocity, 69Torque-controlled crane, 328Torque equivalent mechanical loading, 79Torque-speed curve, 81 ‚Äì82 Total response, 10Tou, J., 765 Tower Trainer 60 Unmanned Aerial Vehicle, 371, 644 Towsley, D., 379, 447, 610, 648Train stopping, closed-loop vehicle response for, 431Transducers: input, 7output, 8 Transfer function(s), 16, 44 ‚Äì47 for antenna control system, 92 ‚Äì94 block diagram of, 45from Bode plots, 591 ‚Äì594 with constant term in numerator, 131 ‚Äì133 decomposing, 133, 134916 Index3GBINDEX 10/14/2014 11:56:30 for differential equation, 45 of digital control systems, 719 ‚Äì723 electrical network, 47 ‚Äì61 electromechanical system, 77 ‚Äì83 experimentally obtaining, 591 ‚Äì594 Ô¨Årst-order transfer functions via testing, 163 ‚Äì164 frequency response from, 530 of human leg, 94 ‚Äì95 matrix, 136 ‚Äì137 nonminimum-phase system of, 188 ‚Äì190 peak time from, 177percent overshoot from, 177poles of, 159with polynomial in numerator, 134 ‚Äì135 rise time from, 176 ‚Äì177 rotational mechanical system, 69 ‚Äì73 sampled-data systems and, 719 ‚Äì723 second-order approximation, 186second-order transfer functions via testing, 181 ‚Äì182 settling time from, 176, 177from state space, 136 ‚Äì138 to state space, 130 ‚Äì136 state-space representation to, 137 ‚Äì138 step responses for, 185 ‚Äì186 system response from, 46 translational mechanical system, 61 ‚Äì68 via Mason ‚Äôs rule, 252 ‚Äì253 zeros of, 159 Transfer function poles, eigenvalues and, 195 ‚Äì198 Transfer pitch angle, of UFSS vehicle, 206 Transformation(s): bilinear, 730 ‚Äì731 to canonical form, 260 ‚Äì265 controller design by, 662 ‚Äì666 observer design by, 677 ‚Äì681 similarity, 265 ‚Äì271 Transformation matrix, 266, 267, 269 ‚Äì271 Transformed circuit, 49Transformed free-body diagram, 63Transform methods, single loop via, 50Transform of the response, 173 Transient performance, stability design and, 595 ‚Äì596 Transient response, 2, 9, 10n cascade compensation for improvement of, 462 ‚Äì474 desired and existing, 9 Ô¨Ånding, 246 ‚Äì247 gain design for, 247improving, 450 ‚Äì451 modeling, 18 model ing steady-state error, 18 real-axis pole and, 160 steady-state errors and, 18, 474 ‚Äì486 through component design, 180 ‚Äì181via gain adjustment, 615 ‚Äì618 onz-plane, 737 ‚Äì739 Transient response design via cascade compensation, 614Transient response design via gain adjustment, 407 ‚Äì411, 614 antenna control and, 417 ‚Äì419, 749 ‚Äì751 digital control systems and, 740 ‚Äì741 UFSS and, 419 ‚Äì421 Transition method, 303, 397 ‚Äì398 Translational mechanical system: representation of, 128transfer functions, 61 ‚Äì68 Transpose, 125A Treatise on the Stability of a Given State of Motion (Routh), 5 TryIt, 40 ‚Äì43, 46, 57, 71, 135, 138, 182, 186, 187, 191, 197, 245, 248, 261, 263, 271, 306, 314, 320, 348, 350, 354, 358, 360, 385, 390, 406, 461, 470, 550, 560, 566, 569, 578, 590, 618, 622 ‚Äì623, 629, 657, 661, 673, 677, 722, 742 Tsai, C.-C., 232Tsang, K. M., 329, 334Tsunashima, H., 448Tu, H.-M., 232, 374n, 379Tumor cell growth model, 104 Turnbull, G. A., 31 Tustin transformation, 743Two degrees of freedom translational mechanical system, 65‚Äì66 Two-loop electrical network, 51 ‚Äì53 Two-pole system, zeros and, 187Two-tank liquid control system, 512 ‚Äì513 Two-wheeled driving control system, 25 Tyagi, B., 152n, 156, 233, 334, 524, 704, 764 Tyberg, V. J., 232Type 3 feedback control systems, 375 U UAV helicopter, 330UFSS, SeeUnmanned Free-Swimming Submersible UNAIDS, 27, 31 Unbounded input, 300 Uncompensated system: of ideal derivative compensation, 465 ‚Äì467 root locus for, 456 Uncompensated system response, ideal integral compensated system response and, 457 Uncontrollable system, 658Undamped response, 167, 168 Undamped sinusoidal oscillations, 208 Underdamped curve, 169Underdamped response, 166 ‚Äì167 Underdamped second-order systems, 173 ‚Äì182Index 9173GBINDEX 10/14/2014 11:56:31 Underwater remote-controlled vehicle, 315 Uniform-rate sampling, 712 Uniform rectangular pulse train, 713United Technologies, 3Unit multiplicity, 310nUnit parabolic input, for digital feedback control system, 735 Unit ramp input, for digital feedback control system, 735Unit step input: for digital feedback control system, 734 ‚Äì735 Ô¨Årst-order system and, 162 Unity feedback systems: forming an equivalent, 353 ‚Äì354 steady-state error for, 339 ‚Äì344 Unity gain, 8Unmanned autonomous vehicle, 516 ‚Äì517 Unmanned Free-Swimming Submersible (UFSS), 158, 271 heading control, 758lead/feedback compensation in, 503 ‚Äì504 open-loop pitch response and, 205 ‚Äì207 pitch angle control representation, 275 ‚Äì277, 285 pitch control loop for, 205stability design via gain in, 322 ‚Äì323 transient design via gain and, 419 ‚Äì421 Unobservability, via observability matrix, 676 ‚Äì677 Unobservable systems, 674Unstable systems, 301. See also Stability √únyeliog ÃÜlu, K. A., 430, 448 ≈∞nyelioglu, K. A., 334 Vvan der Helm, F. C. T., 296 van der Molen, G. M., 150n, 156 Van de Vegte, J., 524van de Zalm, G., 606, 611Van Dijk, E., 219, 233, 699, 705Van Valkenburg, M. E., 113Varghese, J., 517, 524Variable speed wind turbine, feedback control, 700Variable valve timing (VVT), 220 Vaughan, N. D., 24, 31, 285, 297 Vector-matrix form, 125Vector representation, of complex numbers, 383 ‚Äì385 Vectors: evaluation of complex function via, 385Laplace transform of, 136nstate, 121 Vehicle steering control model, 374, 430, 644 Veldpaus, F., 611 Velocity: angular, 69, 81, 192constant-velocity inputs, 336force-, 62 shortening muscle, 287 Velocity constant, 345, 583 ‚Äì584 Venter, J. W., 30, 105n, 113, 152n, 155, 232, 296, 333, 379, 447, 523, 610, 647, 704, 764 Ventilators, closed-loop feedback in, 432 VerÔ¨Ång, E. H., 31 Vertical risers, 4Vertical spindle surface grinding, 329 Video laser disc recorders, 363 ‚Äì365 Vidyasagar, M., 113, 380, 436n, 448 Vieira, A., 156, 704Virkkunen, J., 103n, 113, 333, 611Virtual Experiment, 65, 81, 138, 162, 177, 247, 311, 352, 466, 493 Virtual reality simulator, 288Viruses, free, 105 Viscous damper, 62, 64, 123 Viscous damping, 15Visual cues, human response to, 215Voltage(s): armature, 78 ‚Äì79, 81 skeletal muscle voltage potential, 218summing, 57 Voltage-charge, 47 Voltage-current, 47 Voltage-dependent current source, 125 ‚Äì127 Voltage division, simple circuits via, 51Voltage droop control, 431Voltage-source converter (VSC), 437 ‚Äì438, 607 VVT, SeeVariable valve timing W Wang, F., 31 Wang, H., 379, 447, 611Wang, W., 31Wang, X.-K., 329, 334, 606, 611Water clock, 4Water level control, in steam generator, 329 ‚Äì330 Water-loading experiments, 437 Watt, James, 4 Wavefo rms , 18 Weiss, R., 149n Williams, R. L., II, 448, 765Windmill speed control, 4Wind turbines, 433 ‚Äì435 Wingrove, R. C., 330, 334Wittenmark, B., 743, 764Wolfson, P., 232 Wong, M. C., 379, 447 Woods Hole Oceanographic Institution, 315Wormly, D. N., 156, 232, 297, 334Wu, J., 524918 Index3GBINDEX 10/14/2014 11:56:33 X X-4 quadrotor, 516 ‚Äì517 Xia, W., 156 Xia, X., 30, 105n, 113, 152n, 155, 232, 296, 333, 379, 447, 523, 610, 647, 704, 764 Xiong, Y., 233Xu, D.-P., 704Xue, D., 218, 233 Y Yamazaki, H., 431, 448Yan, T., 328, 334, 433, 448, 644, 648Yang, H., 610Yang, J., 610Yang, X.-H., 334, 611Yang, X.-Y., 704Yaniv, Y., 287, 297 Ye, Z., 156 Yin, G., 374, 380Yingst, J. C., 764Yoneyama, T., 447, 610Yu, S., 517, 524 Z Zbinden, A. M., 31 Zedka, M., 217, 233 Zero(s), 158 entire row is, 308 ‚Äì311 inÔ¨Årst column, 306 ‚Äì307, 312 ‚Äì313ofÔ¨Årst-order system, 159 ‚Äì161 in Routh table, 305 ‚Äì311 system response with, 186 ‚Äì191 of transfer function, 159two-pole system and, 187 Zero-input response, 198Zero-order hold, 714Zero-order sample-and-hold (z.o.h.), 710, 714, 721 ‚Äì722 Zero-state response, 198, 209 Zhang, D., 524 Zhang, J.-Y., 644, 648Zhang, Y., 156Zhao, Q., 26, 31Zhongjun, X., 232Zhou, B. H., 215, 233Zhou, J., 31Zhu, G. G., 220n, 233 z.o.h., SeeZero-order sample-and-hold z-plane: digital system stability via, 726 ‚Äì730 gain design on, 739 ‚Äì742 s-plane mapping onto, 727 transient response on, 737 ‚Äì739 z-transform, 712 digital control systems and, 714 ‚Äì719 sampled-data systems and, 723 table of, 716theorems, 717of time function, 715 ‚Äì716Index 9193GBINDEX 10/14/2014 11:56:33 Page 920WEBBKEY 10/29/2014 0:39:40 Key Equations WEBBIBC 10/29/2014 0:17:50 Unmanned Free-Swimming Submersible Vehicle Pitch Control System Pitch gainPitch command Œ∏c(s)Commanded elevator deflection Œ¥ec(s)2 s + 2Elevator actuatorElevator deflection Œ¥e(s)Vehicle dynamics ‚Äì0.125(s +0.435) (s+1.23)( s2+0.226 s+0.0169)Pitch Œ∏(s) Pitch rate sensor ‚ÄìK2s+ ‚Äì+ ‚Äì‚ÄìK1 Heading Control System Heading gainHeading commandCommanded rudder deflectionRudder actuatorVehicle dynamics Yaw rate sensorHeadingHeading (yaw) rate ‚Äì2 s + 2+ ‚Äì‚Äì + 0.125(s + 0.437) (s + 1.29)(s + 0.193)œàc(s) Œ¥rc(s) Œ¥r(s) œà(s) œà(s)Rudder deflection 1 s ‚ÄìK2s‚ÄìK1WILEY END USER LICENSE AGREEMENT Go to www.wiley.com/go/eula to access Wiley's ebook EULA.